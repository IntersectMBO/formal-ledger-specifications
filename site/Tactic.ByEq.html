<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.ByEq</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Keyword">module</a> <a id="43" href="Tactic.ByEq.html" class="Module">Tactic.ByEq</a> <a id="55" class="Keyword">where</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Meta.Init.html" class="Module">Meta.Init</a> <a id="84" class="Keyword">hiding</a> <a id="91" class="Symbol">(</a><a id="92" href="Reflection.TCI.html#554" class="Function">TC</a><a id="94" class="Symbol">)</a>
<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="121" class="Keyword">open</a> <a id="126" class="Keyword">import</a> <a id="133" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="147" class="Keyword">open</a> <a id="152" class="Keyword">import</a> <a id="159" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="171" class="Keyword">open</a> <a id="176" class="Keyword">import</a> <a id="183" href="Reflection.html" class="Module">Reflection</a> <a id="194" class="Keyword">using</a> <a id="200" class="Symbol">(</a><a id="201" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a><a id="203" class="Symbol">;</a> <a id="205" href="Agda.Builtin.Reflection.html#10159" class="Postulate">withNormalisation</a><a id="222" class="Symbol">;</a> <a id="224" href="Agda.Builtin.Reflection.html#8893" class="Postulate">inferType</a><a id="233" class="Symbol">;</a> <a id="235" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a><a id="240" class="Symbol">)</a>
<a id="242" class="Keyword">open</a> <a id="247" class="Keyword">import</a> <a id="254" href="Reflection.Utils.html" class="Module">Reflection.Utils</a> <a id="271" class="Keyword">using</a> <a id="277" class="Symbol">(</a><a id="278" href="Reflection.Utils.Core.html#1072" class="Function">argTys</a><a id="284" class="Symbol">)</a>
<a id="286" class="Keyword">open</a> <a id="291" class="Keyword">import</a> <a id="298" href="Reflection.QuotedDefinitions.html" class="Module">Reflection.QuotedDefinitions</a>

<a id="328" class="Comment">-- Introduce as many arguments as possible and then:</a>
<a id="381" class="Comment">--   1. for those of type `_ ≡ _`, unify with  `refl`</a>
<a id="435" class="Comment">--   2. ignore the rest of the arguments (unify with `_`)</a>
<a id="493" class="Comment">--   3. unify the hole with `refl`</a>
<a id="by-eq"></a><a id="528" href="Tactic.ByEq.html#528" class="Function">by-eq</a> <a id="534" class="Symbol">:</a> <a id="536" href="Reflection.Syntax.html#3681" class="Function">Hole</a> <a id="541" class="Symbol">→</a> <a id="543" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="546" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="548" href="Tactic.ByEq.html#528" class="Function">by-eq</a> <a id="554" href="Tactic.ByEq.html#554" class="Bound">hole</a> <a id="559" class="Symbol">=</a> <a id="561" class="Keyword">do</a>
  <a id="566" href="Tactic.ByEq.html#566" class="Bound">ty</a> <a id="569" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="571" href="Agda.Builtin.Reflection.html#10159" class="Postulate">withNormalisation</a> <a id="589" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="594" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="596" href="Agda.Builtin.Reflection.html#8893" class="Postulate">inferType</a> <a id="606" href="Tactic.ByEq.html#554" class="Bound">hole</a>
  <a id="613" class="Keyword">let</a> <a id="617" href="Tactic.ByEq.html#617" class="Bound">ps</a> <a id="620" class="Symbol">:</a> <a id="622" href="Reflection.AST.Argument.html#1546" class="Function">Args</a> <a id="627" href="Agda.Builtin.Reflection.html#5031" class="Datatype">Pattern</a>
      <a id="641" href="Tactic.ByEq.html#617" class="Bound">ps</a> <a id="644" class="Symbol">=</a> <a id="646" href="Reflection.Utils.Core.html#1072" class="Function">argTys</a> <a id="653" href="Tactic.ByEq.html#566" class="Bound">ty</a> <a id="656" href="Class.Functor.Core.html#337" class="Function Operator">&lt;&amp;&gt;</a> <a id="660" href="Class.Functor.Core.html#272" class="Function">fmap</a> <a id="665" class="Symbol">λ</a> <a id="667" class="Symbol">{</a> <a id="669" class="Symbol">(_</a> <a id="672" href="Reflection.QuotedDefinitions.html#223" class="InductiveConstructor Operator">``≡</a> <a id="676" class="Symbol">_)</a> <a id="679" class="Symbol">→</a> <a id="681" href="Reflection.QuotedDefinitions.html#328" class="InductiveConstructor">``refl</a> <a id="688" class="Symbol">;</a> <a id="690" class="CatchallClause Symbol">_</a> <a id="692" class="Symbol">→</a> <a id="694" href="Agda.Builtin.Reflection.html#5872" class="InductiveConstructor">dot</a> <a id="698" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a> <a id="706" class="Symbol">}</a>
  <a id="710" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="716" href="Tactic.ByEq.html#554" class="Bound">hole</a> <a id="721" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="723" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="731" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="733" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="740" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="743" href="Tactic.ByEq.html#617" class="Bound">ps</a> <a id="746" href="Reflection.QuotedDefinitions.html#285" class="Function">`refl</a> <a id="752" href="Data.List.Base.html#4907" class="Function Operator">]</a> <a id="754" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="758" class="Keyword">macro</a> <a id="$by-eq"></a><a id="764" href="Tactic.ByEq.html#764" class="Function">$by-eq</a> <a id="771" class="Symbol">=</a> <a id="773" href="Tactic.ByEq.html#528" class="Function">by-eq</a>

<a id="780" class="Keyword">private</a>
  <a id="790" class="Comment">-- test that macro works</a>
  <a id="817" href="Tactic.ByEq.html#817" class="Function">_</a> <a id="819" class="Symbol">:</a> <a id="821" class="Symbol">∀</a> <a id="823" class="Symbol">{</a><a id="824" href="Tactic.ByEq.html#824" class="Bound">n</a> <a id="826" href="Tactic.ByEq.html#826" class="Bound">m</a> <a id="828" href="Tactic.ByEq.html#828" class="Bound">k</a> <a id="830" class="Symbol">:</a> <a id="832" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="833" class="Symbol">}</a> <a id="835" class="Symbol">→</a> <a id="837" href="Tactic.ByEq.html#824" class="Bound">n</a> <a id="839" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="841" href="Tactic.ByEq.html#826" class="Bound">m</a> <a id="843" class="Symbol">→</a> <a id="845" href="Tactic.ByEq.html#826" class="Bound">m</a> <a id="847" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="849" href="Tactic.ByEq.html#828" class="Bound">k</a> <a id="851" class="Symbol">→</a> <a id="853" href="Tactic.ByEq.html#824" class="Bound">n</a> <a id="855" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="857" href="Tactic.ByEq.html#828" class="Bound">k</a>
  <a id="861" class="Symbol">_</a> <a id="863" class="Symbol">=</a> <a id="865" href="Tactic.ByEq.html#764" class="Macro">$by-eq</a>

  <a id="875" href="Tactic.ByEq.html#875" class="Function">_</a> <a id="877" class="Symbol">:</a> <a id="879" class="Symbol">∀</a> <a id="881" class="Symbol">{</a><a id="882" href="Tactic.ByEq.html#882" class="Bound">n</a> <a id="884" href="Tactic.ByEq.html#884" class="Bound">m</a> <a id="886" href="Tactic.ByEq.html#886" class="Bound">k</a> <a id="888" href="Tactic.ByEq.html#888" class="Bound">x</a> <a id="890" href="Tactic.ByEq.html#890" class="Bound">y</a> <a id="892" class="Symbol">:</a> <a id="894" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="895" class="Symbol">}</a> <a id="897" class="Symbol">→</a> <a id="899" href="Tactic.ByEq.html#882" class="Bound">n</a> <a id="901" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="903" href="Tactic.ByEq.html#884" class="Bound">m</a> <a id="905" class="Symbol">→</a> <a id="907" href="Tactic.ByEq.html#888" class="Bound">x</a> <a id="909" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="911" href="Tactic.ByEq.html#890" class="Bound">y</a> <a id="913" class="Symbol">→</a> <a id="915" href="Tactic.ByEq.html#884" class="Bound">m</a> <a id="917" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="919" href="Tactic.ByEq.html#882" class="Bound">n</a>
  <a id="923" class="Symbol">_</a> <a id="925" class="Symbol">=</a> <a id="927" href="Tactic.ByEq.html#764" class="Macro">$by-eq</a>

  <a id="937" class="Comment">-- test that tactic arguments work</a>
  <a id="f"></a><a id="974" href="Tactic.ByEq.html#974" class="Function">f</a> <a id="976" class="Symbol">:</a> <a id="978" class="Symbol">{@(</a><a id="981" class="Keyword">tactic</a> <a id="988" href="Tactic.ByEq.html#528" class="Function">by-eq</a><a id="993" class="Symbol">)</a> <a id="995" href="Tactic.ByEq.html#995" class="Bound">_</a> <a id="997" class="Symbol">:</a> <a id="999" class="Symbol">∀</a> <a id="1001" class="Symbol">{</a><a id="1002" href="Tactic.ByEq.html#1002" class="Bound">n</a> <a id="1004" href="Tactic.ByEq.html#1004" class="Bound">m</a> <a id="1006" class="Symbol">:</a> <a id="1008" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1009" class="Symbol">}</a> <a id="1011" class="Symbol">→</a> <a id="1013" href="Tactic.ByEq.html#1002" class="Bound">n</a> <a id="1015" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1017" href="Tactic.ByEq.html#1004" class="Bound">m</a> <a id="1019" class="Symbol">→</a> <a id="1021" href="Tactic.ByEq.html#1004" class="Bound">m</a> <a id="1023" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1025" href="Tactic.ByEq.html#1002" class="Bound">n</a><a id="1026" class="Symbol">}</a> <a id="1028" class="Symbol">→</a> <a id="1030" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="1035" class="Symbol">→</a> <a id="1037" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="1044" href="Tactic.ByEq.html#974" class="Function">f</a> <a id="1046" class="Symbol">=</a> <a id="1048" href="Function.Base.html#704" class="Function">id</a>

  <a id="1054" href="Tactic.ByEq.html#1054" class="Function">_</a> <a id="1056" class="Symbol">:</a> <a id="1058" href="Tactic.ByEq.html#974" class="Function">f</a> <a id="1060" class="Symbol">{λ</a> <a id="1063" class="Keyword">where</a> <a id="1069" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1074" class="Symbol">→</a> <a id="1076" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1080" class="Symbol">}</a> <a id="1082" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="1087" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1089" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
  <a id="1096" class="Symbol">_</a> <a id="1098" class="Symbol">=</a> <a id="1100" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

  <a id="1108" href="Tactic.ByEq.html#1108" class="Function">_</a> <a id="1110" class="Symbol">:</a> <a id="1112" href="Tactic.ByEq.html#974" class="Function">f</a> <a id="1114" class="Symbol">{</a><a id="1115" href="Tactic.ByEq.html#764" class="Macro">$by-eq</a><a id="1121" class="Symbol">}</a> <a id="1123" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="1128" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1130" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
  <a id="1137" class="Symbol">_</a> <a id="1139" class="Symbol">=</a> <a id="1141" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

  <a id="1149" href="Tactic.ByEq.html#1149" class="Function">_</a> <a id="1151" class="Symbol">:</a> <a id="1153" href="Tactic.ByEq.html#974" class="Function">f</a> <a id="1155" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="1160" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1162" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
  <a id="1169" class="Symbol">_</a> <a id="1171" class="Symbol">=</a> <a id="1173" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

  <a id="1181" class="Comment">-- test that normalisation works</a>
  <a id="Sym"></a><a id="1216" href="Tactic.ByEq.html#1216" class="Function">Sym</a> <a id="1220" class="Symbol">=</a> <a id="1222" class="Symbol">∀</a> <a id="1224" class="Symbol">{</a><a id="1225" href="Tactic.ByEq.html#1225" class="Bound">n</a> <a id="1227" href="Tactic.ByEq.html#1227" class="Bound">m</a> <a id="1229" class="Symbol">:</a> <a id="1231" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1232" class="Symbol">}</a> <a id="1234" class="Symbol">→</a> <a id="1236" href="Tactic.ByEq.html#1225" class="Bound">n</a> <a id="1238" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1240" href="Tactic.ByEq.html#1227" class="Bound">m</a> <a id="1242" class="Symbol">→</a> <a id="1244" href="Tactic.ByEq.html#1227" class="Bound">m</a> <a id="1246" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1248" href="Tactic.ByEq.html#1225" class="Bound">n</a>

  <a id="g"></a><a id="1253" href="Tactic.ByEq.html#1253" class="Function">g</a> <a id="1255" class="Symbol">:</a> <a id="1257" class="Symbol">{@(</a><a id="1260" class="Keyword">tactic</a> <a id="1267" href="Tactic.ByEq.html#528" class="Function">by-eq</a><a id="1272" class="Symbol">)</a> <a id="1274" href="Tactic.ByEq.html#1274" class="Bound">_</a> <a id="1276" class="Symbol">:</a> <a id="1278" href="Tactic.ByEq.html#1216" class="Function">Sym</a><a id="1281" class="Symbol">}</a> <a id="1283" class="Symbol">→</a> <a id="1285" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="1290" class="Symbol">→</a> <a id="1292" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="1299" href="Tactic.ByEq.html#1253" class="Function">g</a> <a id="1301" class="Symbol">=</a> <a id="1303" href="Function.Base.html#704" class="Function">id</a>

  <a id="1309" href="Tactic.ByEq.html#1309" class="Function">_</a> <a id="1311" class="Symbol">:</a> <a id="1313" href="Tactic.ByEq.html#1253" class="Function">g</a> <a id="1315" class="Symbol">{λ</a> <a id="1318" class="Keyword">where</a> <a id="1324" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="1329" class="Symbol">→</a> <a id="1331" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1335" class="Symbol">}</a> <a id="1337" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="1342" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1344" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
  <a id="1351" class="Symbol">_</a> <a id="1353" class="Symbol">=</a> <a id="1355" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

  <a id="1363" href="Tactic.ByEq.html#1363" class="Function">_</a> <a id="1365" class="Symbol">:</a> <a id="1367" href="Tactic.ByEq.html#1253" class="Function">g</a> <a id="1369" class="Symbol">{</a><a id="1370" href="Tactic.ByEq.html#764" class="Macro">$by-eq</a><a id="1376" class="Symbol">}</a> <a id="1378" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="1383" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1385" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
  <a id="1392" class="Symbol">_</a> <a id="1394" class="Symbol">=</a> <a id="1396" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

  <a id="1404" href="Tactic.ByEq.html#1404" class="Function">_</a> <a id="1406" class="Symbol">:</a> <a id="1408" href="Tactic.ByEq.html#1253" class="Function">g</a> <a id="1410" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="1415" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1417" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
  <a id="1424" class="Symbol">_</a> <a id="1426" class="Symbol">=</a> <a id="1428" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
</pre></body></html>