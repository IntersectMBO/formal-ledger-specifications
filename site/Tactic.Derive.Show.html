<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.Show</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Comment">-- Deriving show.</a>

<a id="20" class="Symbol">{-#</a> <a id="24" class="Keyword">OPTIONS</a> <a id="32" class="Pragma">-v</a> <a id="35" class="Pragma">allTactics:100</a> <a id="50" class="Symbol">#-}</a>
<a id="54" class="Symbol">{-#</a> <a id="58" class="Keyword">OPTIONS</a> <a id="66" class="Pragma">--safe</a> <a id="73" class="Pragma">--with-K</a> <a id="82" class="Symbol">#-}</a>
<a id="86" class="Keyword">module</a> <a id="93" href="Tactic.Derive.Show.html" class="Module">Tactic.Derive.Show</a> <a id="112" class="Keyword">where</a>

<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="144" class="Keyword">open</a> <a id="149" class="Keyword">import</a> <a id="156" href="Meta.Init.html" class="Module">Meta.Init</a>

<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="203" class="Keyword">using</a> <a id="209" class="Symbol">(</a><a id="210" href="Agda.Builtin.Reflection.html#621" class="Primitive">primShowQName</a><a id="223" class="Symbol">)</a>

<a id="226" class="Keyword">import</a> <a id="233" href="Data.List.html" class="Module">Data.List</a> <a id="243" class="Symbol">as</a> <a id="246" class="Module">L</a>
<a id="248" class="Keyword">import</a> <a id="255" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="274" class="Symbol">as</a> <a id="277" class="Module">NE</a>
<a id="280" class="Keyword">import</a> <a id="287" href="Reflection.html" class="Module">Reflection</a> <a id="298" class="Symbol">as</a> <a id="301" class="Module">R</a>
<a id="303" class="Keyword">open</a> <a id="308" class="Keyword">import</a> <a id="315" href="Data.String.html" class="Module">Data.String</a> <a id="327" class="Keyword">using</a> <a id="333" class="Symbol">(</a><a id="334" href="Data.String.Base.html#1591" class="Primitive">fromList</a><a id="342" class="Symbol">;</a> <a id="344" href="Data.String.Base.html#1558" class="Primitive">toList</a><a id="350" class="Symbol">)</a> <a id="352" class="Keyword">renaming</a> <a id="361" class="Symbol">(</a><a id="362" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="367" class="Symbol">to</a> <a id="370" class="Function Operator">_++S_</a><a id="375" class="Symbol">)</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="485" class="Keyword">open</a> <a id="490" class="Keyword">import</a> <a id="497" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="535" class="Keyword">open</a> <a id="540" class="Keyword">import</a> <a id="547" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="571" class="Keyword">open</a> <a id="576" class="Keyword">import</a> <a id="583" href="Class.Show.Core.html" class="Module">Class.Show.Core</a>
<a id="599" class="Keyword">open</a> <a id="604" class="Keyword">import</a> <a id="611" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="630" class="Keyword">open</a> <a id="635" class="Keyword">import</a> <a id="642" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="663" class="Keyword">open</a> <a id="668" class="Keyword">import</a> <a id="675" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="689" class="Symbol">(</a><a id="690" class="Keyword">quote</a> <a id="696" href="Class.Show.Core.html#125" class="Record">Show</a><a id="700" class="Symbol">)</a> <a id="702" class="Symbol">(</a><a id="703" class="Keyword">quote</a> <a id="709" href="Class.Show.Core.html#187" class="Field">show</a><a id="713" class="Symbol">)</a>

<a id="716" class="Keyword">instance</a>
  <a id="727" href="Tactic.Derive.Show.html#727" class="Function">_</a> <a id="729" class="Symbol">=</a> <a id="731" href="Tactic.ClauseBuilder.html#10571" class="Function">ContextMonad-MonadTC</a>

<a id="753" class="Keyword">open</a> <a id="758" href="Tactic.ClauseBuilder.html#10815" class="Module">ClauseExprM</a>

<a id="sLit"></a><a id="771" href="Tactic.Derive.Show.html#771" class="Function">sLit</a> <a id="776" class="Symbol">=</a> <a id="778" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">Term.lit</a> <a id="787" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="789" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">Agda.Builtin.Reflection.Literal.string</a>

<a id="showName"></a><a id="829" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="838" class="Symbol">:</a> <a id="840" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="845" class="Symbol">→</a> <a id="847" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="854" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="863" href="Tactic.Derive.Show.html#863" class="Bound">n</a> <a id="865" class="Symbol">=</a> <a id="867" class="Keyword">let</a> <a id="871" href="Tactic.Derive.Show.html#871" class="Bound">n&#39;</a> <a id="874" class="Symbol">=</a> <a id="876" href="Reflection.AST.Show.html#1581" class="Primitive">R.showName</a> <a id="887" href="Tactic.Derive.Show.html#863" class="Bound">n</a> <a id="889" class="Keyword">in</a> <a id="892" href="Tactic.Derive.Show.html#924" class="Function">dropModulePrefix</a> <a id="909" href="Tactic.Derive.Show.html#871" class="Bound">n&#39;</a>
  <a id="914" class="Keyword">where</a>
    <a id="924" href="Tactic.Derive.Show.html#924" class="Function">dropModulePrefix</a> <a id="941" class="Symbol">:</a> <a id="943" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="950" class="Symbol">→</a> <a id="952" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="963" href="Tactic.Derive.Show.html#924" class="Function">dropModulePrefix</a> <a id="980" href="Tactic.Derive.Show.html#980" class="Bound">s</a> <a id="982" class="Symbol">=</a> <a id="984" href="Data.String.Base.html#1591" class="Primitive">fromList</a> <a id="993" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="995" href="Data.List.Base.html#6927" class="Function">reverse</a> <a id="1003" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1005" href="Data.List.Base.html#9877" class="Function">takeWhile</a> <a id="1015" class="Symbol">(</a><a id="1016" href="Relation.Nullary.Decidable.Core.html#3277" class="Function">¬?</a> <a id="1019" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1021" class="Symbol">(</a><a id="1022" class="String">&#39;.&#39;</a> <a id="1026" href="Class.DecEq.Core.html#168" class="Field Operator">≟_</a><a id="1028" class="Symbol">))</a> <a id="1031" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1033" href="Data.List.Base.html#6927" class="Function">reverse</a> <a id="1041" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1043" href="Data.String.Base.html#1558" class="Primitive">toList</a> <a id="1050" href="Tactic.Derive.Show.html#980" class="Bound">s</a>

<a id="wrapWithPars"></a><a id="1053" href="Tactic.Derive.Show.html#1053" class="Function">wrapWithPars</a> <a id="1066" class="Symbol">:</a> <a id="1068" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1075" class="Symbol">→</a> <a id="1077" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1084" href="Tactic.Derive.Show.html#1053" class="Function">wrapWithPars</a> <a id="1097" href="Tactic.Derive.Show.html#1097" class="Bound">s</a> <a id="1099" class="Symbol">=</a> <a id="1101" class="String">&quot;(&quot;</a> <a id="1105" href="Tactic.Derive.Show.html#370" class="Function Operator">++S</a> <a id="1109" href="Tactic.Derive.Show.html#1097" class="Bound">s</a> <a id="1111" href="Tactic.Derive.Show.html#370" class="Function Operator">++S</a> <a id="1115" class="String">&quot;)&quot;</a>

<a id="genPars"></a><a id="1120" href="Tactic.Derive.Show.html#1120" class="Function">genPars</a> <a id="1128" class="Symbol">:</a> <a id="1130" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1135" class="Symbol">→</a> <a id="1137" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="1142" href="Tactic.Derive.Show.html#1120" class="Function">genPars</a> <a id="1150" href="Tactic.Derive.Show.html#1150" class="Bound">t</a> <a id="1152" class="Symbol">=</a> <a id="1154" class="Keyword">quote</a> <a id="1160" href="Tactic.Derive.Show.html#1053" class="Function">wrapWithPars</a> <a id="1173" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="1176" href="Tactic.Derive.Show.html#1150" class="Bound">t</a> <a id="1178" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a>

<a id="1181" class="Keyword">module</a> <a id="1188" href="Tactic.Derive.Show.html#1188" class="Module">_</a> <a id="1190" class="Symbol">(</a><a id="1191" href="Tactic.Derive.Show.html#1191" class="Bound">transName</a> <a id="1201" class="Symbol">:</a> <a id="1203" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1208" class="Symbol">→</a> <a id="1210" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1216" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="1220" class="Symbol">)</a> <a id="1222" class="Keyword">where</a>
  <a id="1230" href="Tactic.Derive.Show.html#1230" class="Function">showFromTerm</a> <a id="1243" class="Symbol">:</a> <a id="1245" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1250" class="Symbol">→</a> <a id="1252" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1257" class="Symbol">→</a> <a id="1259" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="1266" href="Tactic.Derive.Show.html#1230" class="Function">showFromTerm</a> <a id="1279" class="Symbol">(</a><a id="1280" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1284" href="Tactic.Derive.Show.html#1284" class="Bound">n</a> <a id="1286" class="Symbol">_)</a> <a id="1289" href="Tactic.Derive.Show.html#1289" class="Bound">t</a> <a id="1291" class="Keyword">with</a> <a id="1296" href="Tactic.Derive.Show.html#1191" class="Bound">transName</a> <a id="1306" href="Tactic.Derive.Show.html#1284" class="Bound">n</a>
  <a id="1310" class="Symbol">...</a> <a id="1314" class="Symbol">|</a> <a id="1316" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1321" href="Tactic.Derive.Show.html#1321" class="Bound">n&#39;</a>    <a id="1327" class="Symbol">=</a> <a id="1329" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1333" class="Symbol">(</a><a id="1334" class="Keyword">quote</a> <a id="1340" href="Class.Show.Core.html#187" class="Field">show</a><a id="1344" class="Symbol">)</a> <a id="1346" class="Symbol">(</a><a id="1347" href="Reflection.AST.Argument.html#1395" class="InductiveConstructor">iArg</a> <a id="1352" class="Symbol">(</a><a id="1353" href="Tactic.Derive.Show.html#1321" class="Bound">n&#39;</a> <a id="1356" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a><a id="1357" class="Symbol">)</a> <a id="1359" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1361" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="1366" class="Bound">t</a> <a id="1368" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1370" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1372" class="Symbol">)</a>
  <a id="1376" class="Symbol">...</a> <a id="1380" class="Symbol">|</a> <a id="1382" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>    <a id="1393" class="Symbol">=</a> <a id="1395" class="Keyword">quote</a> <a id="1401" href="Class.Show.Core.html#187" class="Field">show</a> <a id="1406" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="1409" class="Bound">t</a> <a id="1411" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a>
  <a id="1415" href="Tactic.Derive.Show.html#1230" class="CatchallClause Function">showFromTerm</a><a id="1427" class="CatchallClause"> </a><a id="1428" class="CatchallClause Symbol">_</a><a id="1429" class="CatchallClause"> </a><a id="1430" href="Tactic.Derive.Show.html#1430" class="CatchallClause Bound">t</a> <a id="1432" class="Symbol">=</a> <a id="1434" class="Keyword">quote</a> <a id="1440" href="Class.Show.Core.html#187" class="Field">show</a> <a id="1445" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="1448" href="Tactic.Derive.Show.html#1430" class="Bound">t</a> <a id="1450" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a>

  <a id="1455" href="Tactic.Derive.Show.html#1455" class="Function">genShow</a> <a id="1463" class="Symbol">:</a> <a id="1465" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1477" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1482" class="Symbol">→</a> <a id="1484" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="1491" href="Tactic.Derive.Show.html#1455" class="Function">genShow</a> <a id="1499" href="Tactic.Derive.Show.html#1499" class="Bound">n</a> <a id="1501" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1504" class="Symbol">=</a> <a id="1506" href="Tactic.Derive.Show.html#771" class="Function">sLit</a> <a id="1511" class="Symbol">(</a><a id="1512" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="1521" href="Tactic.Derive.Show.html#1499" class="Bound">n</a><a id="1522" class="Symbol">)</a>
  <a id="1526" href="Tactic.Derive.Show.html#1455" class="Function">genShow</a> <a id="1534" href="Tactic.Derive.Show.html#1534" class="Bound">n</a> <a id="1536" class="Symbol">(</a><a id="1537" href="Tactic.Derive.Show.html#1537" class="Bound">x</a> <a id="1539" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1541" href="Tactic.Derive.Show.html#1541" class="Bound">l</a><a id="1542" class="Symbol">)</a> <a id="1544" class="Symbol">=</a> <a id="1546" class="Keyword">quote</a> <a id="1552" href="Data.String.Base.html#3151" class="Function Operator">_&lt;+&gt;_</a> <a id="1558" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∙⟦</a> <a id="1561" href="Tactic.Derive.Show.html#1455" class="Function">genShow</a> <a id="1569" href="Tactic.Derive.Show.html#1534" class="Bound">n</a> <a id="1571" href="Tactic.Derive.Show.html#1541" class="Bound">l</a> <a id="1573" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∣</a> <a id="1575" href="Tactic.Derive.Show.html#1120" class="Function">genPars</a> <a id="1583" href="Tactic.Derive.Show.html#1537" class="Bound">x</a> <a id="1585" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">⟧</a>

  <a id="1590" href="Tactic.Derive.Show.html#1590" class="Function">patternToClause</a> <a id="1606" class="Symbol">:</a> <a id="1608" href="Tactic.ClauseBuilder.html#1303" class="Function">SinglePattern</a> <a id="1622" class="Symbol">→</a> <a id="1624" href="Data.List.NonEmpty.Base.html#1285" class="Record">NE.List⁺</a> <a id="1633" href="Tactic.ClauseBuilder.html#1303" class="Function">SinglePattern</a> <a id="1647" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1649" href="Reflection.TCI.html#554" class="Function">TC</a> <a id="1652" class="Symbol">(</a><a id="1653" href="Tactic.ClauseBuilder.html#5761" class="Datatype">ClauseExpr</a> <a id="1664" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="1666" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1672" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="1676" class="Symbol">)</a>
  <a id="1680" href="Tactic.Derive.Show.html#1590" class="Function">patternToClause</a> <a id="1696" href="Tactic.Derive.Show.html#1696" class="Bound">p</a><a id="1697" class="Symbol">@(</a><a id="1699" href="Tactic.Derive.Show.html#1699" class="Bound">l</a> <a id="1701" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1703" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="1707" class="Symbol">_</a> <a id="1709" class="Symbol">(</a><a id="1710" href="Agda.Builtin.Reflection.html#5814" class="InductiveConstructor">Pattern.con</a> <a id="1722" href="Tactic.Derive.Show.html#1722" class="Bound">n</a> <a id="1724" class="Symbol">_))</a> <a id="1728" class="Symbol">=</a> <a id="1730" href="Data.List.NonEmpty.Base.html#1547" class="Function Operator">NE.[</a> <a id="1735" href="Tactic.Derive.Show.html#1696" class="Bound">p</a> <a id="1737" href="Data.List.NonEmpty.Base.html#1547" class="Function Operator">]</a> <a id="1739" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1741" href="Tactic.ClauseBuilder.html#12723" class="Function">finishMatch</a> <a id="1753" class="Keyword">do</a>
    <a id="1760" href="Tactic.Derive.Show.html#1760" class="Bound">typeList</a> <a id="1769" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1771" href="Class.Traversable.Core.html#587" class="Function">traverse</a> <a id="1780" class="Symbol">⦃</a> <a id="1782" href="Class.Functor.Instances.html#440" class="Function">Functor-List</a> <a id="1795" class="Symbol">⦄</a> <a id="1797" class="Symbol">(λ</a> <a id="1800" href="Tactic.Derive.Show.html#1800" class="Bound">t</a> <a id="1802" class="Symbol">→</a> <a id="1804" class="Keyword">do</a> <a id="1807" href="Tactic.Derive.Show.html#1807" class="Bound">T</a> <a id="1809" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1811" href="Class.MonadTC.html#1736" class="Field">inferType</a> <a id="1821" href="Tactic.Derive.Show.html#1800" class="Bound">t</a><a id="1822" class="Symbol">;</a> <a id="1824" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="1831" class="Symbol">(</a><a id="1832" href="Tactic.Derive.Show.html#1807" class="Bound">T</a> <a id="1834" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1836" href="Tactic.Derive.Show.html#1800" class="Bound">t</a><a id="1837" class="Symbol">))</a> <a id="1840" class="Symbol">(</a><a id="1841" href="Data.List.Base.html#6022" class="Function">applyDownFrom</a> <a id="1855" href="Reflection.Syntax.html#1576" class="InductiveConstructor">♯</a> <a id="1857" class="Symbol">(</a><a id="1858" href="Data.List.Base.html#4746" class="Function">length</a> <a id="1865" href="Tactic.Derive.Show.html#1699" class="Bound">l</a><a id="1866" class="Symbol">))</a>
    <a id="1873" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="1880" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1882" href="Tactic.Derive.Show.html#1455" class="Function">genShow</a> <a id="1890" href="Tactic.Derive.Show.html#1722" class="Bound">n</a> <a id="1892" class="Symbol">(</a><a id="1893" href="Data.List.Base.html#1612" class="Function">L.map</a> <a id="1899" class="Symbol">(</a><a id="1900" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="1908" href="Tactic.Derive.Show.html#1230" class="Function">showFromTerm</a><a id="1920" class="Symbol">)</a> <a id="1922" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1924" href="Data.List.Base.html#6927" class="Function">reverse</a> <a id="1932" href="Tactic.Derive.Show.html#1760" class="Bound">typeList</a><a id="1940" class="Symbol">)</a>
  <a id="1944" href="Tactic.Derive.Show.html#1590" class="CatchallClause Function">patternToClause</a><a id="1959" class="CatchallClause"> </a><a id="1960" href="Tactic.Derive.Show.html#1960" class="CatchallClause Bound">p</a> <a id="1962" class="Symbol">=</a> <a id="1964" href="Data.List.NonEmpty.Base.html#1547" class="Function Operator">NE.[</a> <a id="1969" href="Tactic.Derive.Show.html#1960" class="Bound">p</a> <a id="1971" href="Data.List.NonEmpty.Base.html#1547" class="Function Operator">]</a> <a id="1973" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1975" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="1982" class="String">&quot;Error: not a con!&quot;</a>

<a id="2003" class="Keyword">module</a> <a id="2010" href="Tactic.Derive.Show.html#2010" class="Module">_</a> <a id="2012" class="Symbol">⦃</a> <a id="2014" href="Tactic.Derive.Show.html#2014" class="Bound">_</a> <a id="2016" class="Symbol">:</a> <a id="2018" href="Class.MonadTC.html#620" class="Record">TCOptions</a> <a id="2028" class="Symbol">⦄</a> <a id="2030" class="Keyword">where</a>
  <a id="2038" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="2050" class="Symbol">:</a> <a id="2052" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2057" class="Symbol">(</a><a id="2058" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2063" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2065" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="2069" class="Symbol">)</a> <a id="2071" class="Symbol">→</a> <a id="2073" href="Reflection.Tactic.html#476" class="Function">UnquoteDecl</a>
  <a id="2087" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="2099" class="Symbol">=</a> <a id="2101" href="Tactic.Derive.html#5830" class="Function">derive-Class</a> <a id="2114" class="Number">0</a> <a id="2116" class="Symbol">(λ</a> <a id="2119" href="Tactic.Derive.Show.html#2119" class="Bound">transName</a> <a id="2129" class="Symbol">→</a> <a id="2131" href="Data.List.Base.html#1612" class="Function">L.map</a> <a id="2137" class="Symbol">(</a><a id="2138" href="Tactic.Derive.Show.html#1590" class="Function">patternToClause</a> <a id="2154" href="Tactic.Derive.Show.html#2119" class="Bound">transName</a><a id="2163" class="Symbol">))</a>

<a id="2167" class="Keyword">private</a>
  <a id="2177" class="Keyword">open</a> <a id="2182" class="Keyword">import</a> <a id="2189" href="Tactic.Derive.TestTypes.html" class="Module">Tactic.Derive.TestTypes</a>
  <a id="2215" class="Keyword">import</a> <a id="2222" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
  <a id="2238" class="Keyword">open</a> <a id="2243" class="Keyword">import</a> <a id="2250" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>
  <a id="2268" class="Keyword">open</a> <a id="2273" class="Keyword">import</a> <a id="2280" href="Data.List.Relation.Binary.Pointwise.Base.html" class="Module">Data.List.Relation.Binary.Pointwise.Base</a>

  <a id="2324" class="Keyword">unquoteDecl</a> <a id="Show-Bool"></a><a id="2336" href="Tactic.Derive.Show.html#2336" class="Function">Show-Bool</a> <a id="Show-ℤ"></a><a id="2346" href="Tactic.Derive.Show.html#2346" class="Function">Show-ℤ</a> <a id="Show-List"></a><a id="2353" href="Tactic.Derive.Show.html#2353" class="Function">Show-List</a> <a id="Show-Maybe"></a><a id="2363" href="Tactic.Derive.Show.html#2363" class="Function">Show-Maybe</a> <a id="Show-ℕ"></a><a id="2374" href="Tactic.Derive.Show.html#2374" class="Function">Show-ℕ</a> <a id="Show-Sign"></a><a id="2381" href="Tactic.Derive.Show.html#2381" class="Function">Show-Sign</a> <a id="Show-⊤"></a><a id="2391" href="Tactic.Derive.Show.html#2391" class="Function">Show-⊤</a> <a id="2398" class="Symbol">=</a> <a id="2400" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="2412" class="Symbol">((</a><a id="2414" class="Keyword">quote</a> <a id="2420" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="2425" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2427" href="Tactic.Derive.Show.html#2336" class="Function">Show-Bool</a><a id="2436" class="Symbol">)</a> <a id="2438" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2440" class="Symbol">(</a><a id="2441" class="Keyword">quote</a> <a id="2447" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a> <a id="2449" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2451" href="Tactic.Derive.Show.html#2346" class="Function">Show-ℤ</a><a id="2457" class="Symbol">)</a> <a id="2459" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2461" class="Symbol">(</a><a id="2462" class="Keyword">quote</a> <a id="2468" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2473" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2475" href="Tactic.Derive.Show.html#2353" class="Function">Show-List</a><a id="2484" class="Symbol">)</a> <a id="2486" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2488" class="Symbol">(</a><a id="2489" class="Keyword">quote</a> <a id="2495" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2501" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2503" href="Tactic.Derive.Show.html#2363" class="Function">Show-Maybe</a><a id="2513" class="Symbol">)</a> <a id="2515" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2517" class="Symbol">(</a><a id="2518" class="Keyword">quote</a> <a id="2524" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2526" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2528" href="Tactic.Derive.Show.html#2374" class="Function">Show-ℕ</a><a id="2534" class="Symbol">)</a> <a id="2536" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2538" class="Symbol">(</a><a id="2539" class="Keyword">quote</a> <a id="2545" href="Data.Sign.Base.html#523" class="Datatype">Sign</a> <a id="2550" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2552" href="Tactic.Derive.Show.html#2381" class="Function">Show-Sign</a><a id="2561" class="Symbol">)</a> <a id="2563" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2565" class="Symbol">(</a><a id="2566" class="Keyword">quote</a> <a id="2572" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="2574" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2576" href="Tactic.Derive.Show.html#2391" class="Function">Show-⊤</a><a id="2582" class="Symbol">)</a> <a id="2584" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2586" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2588" class="Symbol">)</a>

  <a id="2593" class="Keyword">unquoteDecl</a> <a id="Show-Fin"></a><a id="2605" href="Tactic.Derive.Show.html#2605" class="Function">Show-Fin</a> <a id="2614" class="Symbol">=</a> <a id="2616" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="2628" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="2630" class="Symbol">(</a><a id="2631" class="Keyword">quote</a> <a id="2637" href="Data.Fin.Base.html#1132" class="Datatype">Fin</a> <a id="2641" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2643" href="Tactic.Derive.Show.html#2605" class="Function">Show-Fin</a><a id="2651" class="Symbol">)</a> <a id="2653" href="Data.List.Base.html#4907" class="Function Operator">]</a>
  <a id="2657" class="Keyword">unquoteDecl</a> <a id="Show-Vec"></a><a id="2669" href="Tactic.Derive.Show.html#2669" class="Function">Show-Vec</a> <a id="2678" class="Symbol">=</a> <a id="2680" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="2692" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="2694" class="Symbol">(</a><a id="2695" class="Keyword">quote</a> <a id="2701" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="2705" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2707" href="Tactic.Derive.Show.html#2669" class="Function">Show-Vec</a><a id="2715" class="Symbol">)</a> <a id="2717" href="Data.List.Base.html#4907" class="Function Operator">]</a>

  <a id="2722" class="Keyword">unquoteDecl</a> <a id="Show-Pointwise"></a><a id="2734" href="Tactic.Derive.Show.html#2734" class="Function">Show-Pointwise</a> <a id="2749" class="Symbol">=</a> <a id="2751" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="2763" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="2765" class="Symbol">(</a><a id="2766" class="Keyword">quote</a> <a id="2772" href="Data.List.Relation.Binary.Pointwise.Base.html#884" class="Datatype">Pointwise</a> <a id="2782" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2784" href="Tactic.Derive.Show.html#2734" class="Function">Show-Pointwise</a><a id="2798" class="Symbol">)</a> <a id="2800" href="Data.List.Base.html#4907" class="Function Operator">]</a>

  <a id="2805" class="Keyword">unquoteDecl</a> <a id="Show-These"></a><a id="2817" href="Tactic.Derive.Show.html#2817" class="Function">Show-These</a> <a id="2828" class="Symbol">=</a> <a id="2830" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="2842" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="2844" class="Symbol">(</a><a id="2845" class="Keyword">quote</a> <a id="2851" href="Data.These.Base.html#573" class="Datatype">These</a> <a id="2857" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2859" href="Tactic.Derive.Show.html#2817" class="Function">Show-These</a><a id="2869" class="Symbol">)</a> <a id="2871" href="Data.List.Base.html#4907" class="Function Operator">]</a>
  <a id="2875" class="Keyword">unquoteDecl</a> <a id="Show-⊎"></a><a id="2887" href="Tactic.Derive.Show.html#2887" class="Function">Show-⊎</a> <a id="2894" class="Symbol">=</a> <a id="2896" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="2908" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="2910" class="Symbol">(</a><a id="2911" class="Keyword">quote</a> <a id="2917" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a> <a id="2921" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2923" href="Tactic.Derive.Show.html#2887" class="Function">Show-⊎</a><a id="2929" class="Symbol">)</a> <a id="2931" href="Data.List.Base.html#4907" class="Function Operator">]</a>

  <a id="2936" class="Keyword">unquoteDecl</a> <a id="Show-E1"></a><a id="2948" href="Tactic.Derive.Show.html#2948" class="Function">Show-E1</a> <a id="Show-E2"></a><a id="2956" href="Tactic.Derive.Show.html#2956" class="Function">Show-E2</a> <a id="Show-E3"></a><a id="2964" href="Tactic.Derive.Show.html#2964" class="Function">Show-E3</a> <a id="2972" class="Symbol">=</a> <a id="2974" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a>
    <a id="2990" class="Symbol">((</a><a id="2992" class="Keyword">quote</a> <a id="2998" href="Tactic.Derive.TestTypes.html#204" class="Datatype">E1</a> <a id="3001" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3003" href="Tactic.Derive.Show.html#2948" class="Function">Show-E1</a><a id="3010" class="Symbol">)</a> <a id="3012" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3014" class="Symbol">(</a><a id="3015" class="Keyword">quote</a> <a id="3021" href="Tactic.Derive.TestTypes.html#309" class="Datatype">E2</a> <a id="3024" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3026" href="Tactic.Derive.Show.html#2956" class="Function">Show-E2</a><a id="3033" class="Symbol">)</a> <a id="3035" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3037" class="Symbol">(</a><a id="3038" class="Keyword">quote</a> <a id="3044" href="Tactic.Derive.TestTypes.html#387" class="Datatype">E3</a> <a id="3047" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3049" href="Tactic.Derive.Show.html#2964" class="Function">Show-E3</a><a id="3056" class="Symbol">)</a> <a id="3058" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3060" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3062" class="Symbol">)</a>

  <a id="3067" class="Comment">-- unquoteDecl Show-E4 = derive-Show [ (quote E4 , Show-E4) ]</a>

  <a id="3132" class="Keyword">unquoteDecl</a> <a id="Show-R1"></a><a id="3144" href="Tactic.Derive.Show.html#3144" class="Function">Show-R1</a> <a id="Show-R2"></a><a id="3152" href="Tactic.Derive.Show.html#3152" class="Function">Show-R2</a> <a id="3160" class="Symbol">=</a> <a id="3162" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a>
    <a id="3178" class="Symbol">((</a><a id="3180" class="Keyword">quote</a> <a id="3186" href="Tactic.Derive.TestTypes.html#597" class="Record">R1</a> <a id="3189" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3191" href="Tactic.Derive.Show.html#3144" class="Function">Show-R1</a><a id="3198" class="Symbol">)</a> <a id="3200" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3202" class="Symbol">(</a><a id="3203" class="Keyword">quote</a> <a id="3209" href="Tactic.Derive.TestTypes.html#658" class="Record">R2</a> <a id="3212" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3214" href="Tactic.Derive.Show.html#3152" class="Function">Show-R2</a><a id="3221" class="Symbol">)</a> <a id="3223" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3225" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3227" class="Symbol">)</a>

  <a id="3232" class="Keyword">unquoteDecl</a> <a id="Show-M₁"></a><a id="3244" href="Tactic.Derive.Show.html#3244" class="Function">Show-M₁</a> <a id="Show-M₂"></a><a id="3252" href="Tactic.Derive.Show.html#3252" class="Function">Show-M₂</a> <a id="3260" class="Symbol">=</a> <a id="3262" href="Tactic.Derive.Show.html#2038" class="Function">derive-Show</a> <a id="3274" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3276" class="Symbol">(</a><a id="3277" class="Keyword">quote</a> <a id="3283" href="Tactic.Derive.TestTypes.html#914" class="Datatype">M₁</a> <a id="3286" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3288" href="Tactic.Derive.Show.html#3244" class="Function">Show-M₁</a><a id="3295" class="Symbol">)</a> <a id="3297" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3299" class="Symbol">(</a><a id="3300" class="Keyword">quote</a> <a id="3306" href="Tactic.Derive.TestTypes.html#928" class="Datatype">M₂</a> <a id="3309" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3311" href="Tactic.Derive.Show.html#3252" class="Function">Show-M₂</a><a id="3318" class="Symbol">)</a> <a id="3320" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3322" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="3328" class="Comment">-- Expected: Show-Product Show-Term</a>
</pre></body></html>