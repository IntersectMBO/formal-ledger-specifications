<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.Utils.Records</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Keyword">module</a> <a id="43" href="Reflection.Utils.Records.html" class="Module">Reflection.Utils.Records</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Meta.Init.html" class="Module">Meta.Init</a>

<a id="123" class="Keyword">open</a> <a id="128" class="Keyword">import</a> <a id="135" href="Data.List.html" class="Module">Data.List</a> <a id="145" class="Keyword">using</a> <a id="151" class="Symbol">(</a><a id="152" href="Data.List.Base.html#1612" class="Function">map</a><a id="155" class="Symbol">)</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Class.DecEq.html" class="Module">Class.DecEq</a> <a id="181" class="Keyword">using</a> <a id="187" class="Symbol">(</a><a id="188" href="Class.DecEq.Core.html#197" class="Function Operator">_==_</a><a id="192" class="Symbol">)</a>

<a id="mkRecord"></a><a id="195" href="Reflection.Utils.Records.html#195" class="Function">mkRecord</a> <a id="204" class="Symbol">:</a> <a id="206" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="211" class="Symbol">(</a><a id="212" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="217" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="219" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="223" class="Symbol">)</a> <a id="225" class="Symbol">→</a> <a id="227" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="232" href="Reflection.Utils.Records.html#195" class="Function">mkRecord</a> <a id="241" href="Reflection.Utils.Records.html#241" class="Bound">fs</a> <a id="244" class="Symbol">=</a> <a id="246" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="254" class="Symbol">(</a><a id="255" href="Data.List.Base.html#1612" class="Function">map</a> <a id="259" class="Symbol">(λ</a> <a id="262" class="Symbol">(</a><a id="263" href="Reflection.Utils.Records.html#263" class="Bound">fn</a> <a id="266" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="268" href="Reflection.Utils.Records.html#268" class="Bound">e</a><a id="269" class="Symbol">)</a> <a id="271" class="Symbol">→</a> <a id="273" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="280" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="283" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="285" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="290" class="Symbol">(</a><a id="291" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="296" href="Reflection.Utils.Records.html#263" class="Bound">fn</a><a id="298" class="Symbol">)</a> <a id="300" href="Data.List.Base.html#4907" class="Function Operator">]</a> <a id="302" href="Reflection.Utils.Records.html#268" class="Bound">e</a><a id="303" class="Symbol">)</a> <a id="305" href="Reflection.Utils.Records.html#241" class="Bound">fs</a><a id="307" class="Symbol">)</a> <a id="309" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="updateField"></a><a id="313" href="Reflection.Utils.Records.html#313" class="Function">updateField</a> <a id="325" class="Symbol">:</a> <a id="327" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="332" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="337" class="Symbol">→</a> <a id="339" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="344" class="Symbol">→</a> <a id="346" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="351" class="Symbol">→</a> <a id="353" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="358" class="Symbol">→</a> <a id="360" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="365" href="Reflection.Utils.Records.html#313" class="Function">updateField</a> <a id="377" href="Reflection.Utils.Records.html#377" class="Bound">fs</a> <a id="380" href="Reflection.Utils.Records.html#380" class="Bound">rexp</a> <a id="385" href="Reflection.Utils.Records.html#385" class="Bound">fn</a> <a id="388" href="Reflection.Utils.Records.html#388" class="Bound">fexp</a> <a id="393" class="Symbol">=</a>
  <a id="397" href="Function.Base.html#1657" class="Function">flip</a> <a id="402" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="410" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="413" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="415" href="Function.Base.html#1657" class="Function">flip</a> <a id="420" href="Data.List.Base.html#1612" class="Function">map</a> <a id="424" href="Reflection.Utils.Records.html#377" class="Bound">fs</a> <a id="427" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="429" class="Symbol">λ</a> <a id="431" href="Reflection.Utils.Records.html#431" class="Bound">f</a> <a id="433" class="Symbol">→</a>
    <a id="439" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="446" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="449" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="451" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="456" class="Symbol">(</a><a id="457" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="462" href="Reflection.Utils.Records.html#431" class="Bound">f</a><a id="463" class="Symbol">)</a> <a id="465" href="Data.List.Base.html#4907" class="Function Operator">]</a> <a id="467" href="Function.Base.html#1993" class="Function Operator">$</a>
      <a id="475" href="Data.Bool.Base.html#1515" class="Function Operator">if</a> <a id="478" href="Reflection.Utils.Records.html#431" class="Bound">f</a> <a id="480" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="483" href="Reflection.Utils.Records.html#385" class="Bound">fn</a> <a id="486" href="Data.Bool.Base.html#1515" class="Function Operator">then</a> <a id="491" href="Reflection.Utils.Records.html#388" class="Bound">fexp</a> <a id="496" href="Data.Bool.Base.html#1515" class="Function Operator">else</a> <a id="501" class="Symbol">(</a><a id="502" href="Reflection.Utils.Records.html#431" class="Bound">f</a> <a id="504" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="507" href="Reflection.Utils.Records.html#380" class="Bound">rexp</a> <a id="512" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="513" class="Symbol">)</a>
</pre></body></html>