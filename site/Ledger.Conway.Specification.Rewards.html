
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Formal ledger specification and documentation.">
      
      
        <meta name="author" content="Formal Methods Ledger Team">
      
      
        <link rel="canonical" href="https://intersectmbo.github.io/formal-ledger-specifications/Ledger.Conway.Specification.Rewards.html">
      
      
        <link rel="prev" href="Ledger.Conway.Specification.Ratify.Properties.html">
      
      
        <link rel="next" href="Ledger.Conway.Specification.Script.html">
      
      
      <link rel="icon" href="img/Cardano-RGB_Logo-Icon-White.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.17">
    
    
      
        <title>Rewards - Formal Ledger Specification</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
      <link rel="stylesheet" href="css/custom.css">
    
      <link rel="stylesheet" href="css/Agda.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sec:rewards" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Formal Ledger Specification" class="md-header__button md-logo" aria-label="Formal Ledger Specification" data-md-component="logo">
      
  <img src="img/Cardano-RGB_Logo-Icon-Blue.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Formal Ledger Specification
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Rewards
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/IntersectMBO/formal-ledger-specifications" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="index.html" class="md-tabs__link">
          
  
  
  Navigation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Formal Ledger Specification" class="md-nav__button md-logo" aria-label="Formal Ledger Specification" data-md-component="logo">
      
  <img src="img/Cardano-RGB_Logo-Icon-Blue.svg" alt="logo">

    </a>
    Formal Ledger Specification
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/IntersectMBO/formal-ledger-specifications" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Navigation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Navigation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="guide.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guide for Contributors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Preliminaries
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Preliminaries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Notation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Notation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ledger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" checked>
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Ledger/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            Ledger/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prelude
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_3" >
        
          
          <label class="md-nav__link" for="__nav_1_5_3" id="__nav_1_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Prelude/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_3">
            <span class="md-nav__icon md-icon"></span>
            Prelude/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.Base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_3_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_3_2" id="__nav_1_5_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foreign/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_3_2">
            <span class="md-nav__icon md-icon"></span>
            Foreign/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.Foreign.HSTypes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSTypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.Foreign.Util.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Util
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.HasCoin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HasCoin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.Instances.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instances
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.Numeric.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numeric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_3_6" >
        
          
          <label class="md-nav__link" for="__nav_1_5_3_6" id="__nav_1_5_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Numeric/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_3_6">
            <span class="md-nav__icon md-icon"></span>
            Numeric/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.Numeric.PositiveNat.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PositiveNat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Prelude.Numeric.UnitInterval.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UnitInterval
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_4" >
        
          
          <label class="md-nav__link" for="__nav_1_5_4" id="__nav_1_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_4">
            <span class="md-nav__icon md-icon"></span>
            Core/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_4_1" >
        
          
          <label class="md-nav__link" for="__nav_1_5_4_1" id="__nav_1_5_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Specification/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_4_1">
            <span class="md-nav__icon md-icon"></span>
            Specification/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Core.Specification.Address.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Address
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Core.Specification.Crypto.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Crypto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Core.Specification.Epoch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Epoch
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conway
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6" checked>
        
          
          <label class="md-nav__link" for="__nav_1_5_6" id="__nav_1_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Conway/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_5_6">
            <span class="md-nav__icon md-icon"></span>
            Conway/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Specification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2" checked>
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2" id="__nav_1_5_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Specification/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_6_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_5_6_2">
            <span class="md-nav__icon md-icon"></span>
            Specification/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Abstract.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Abstract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Certs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_3" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_3" id="__nav_1_5_6_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Certs/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_3">
            <span class="md-nav__icon md-icon"></span>
            Certs/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Certs.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_3_2" id="__nav_1_5_6_2_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Properties/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_5_6_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Properties/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Certs.Properties.PoV.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PoV
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Certs.Properties.PoVLemmas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PoVLemmas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Certs.Properties.VoteDelegsVDeleg.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VoteDelegsVDeleg
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Chain.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_5" id="__nav_1_5_6_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chain/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_5">
            <span class="md-nav__icon md-icon"></span>
            Chain/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Chain.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_5_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_5_2" id="__nav_1_5_6_2_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Properties/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_5_6_2_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_5_2">
            <span class="md-nav__icon md-icon"></span>
            Properties/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Chain.Properties.CredDepsEqualDomRwds.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CredDepsEqualDomRwds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Chain.Properties.EpochStep.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EpochStep
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Chain.Properties.GovDepsMatch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GovDepsMatch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Chain.Properties.PParamsWellFormed.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PParamsWellFormed
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Enact.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enact
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_7" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_7" id="__nav_1_5_6_2_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Enact/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_7">
            <span class="md-nav__icon md-icon"></span>
            Enact/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Enact.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Epoch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Epoch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_9" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_9" id="__nav_1_5_6_2_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Epoch/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_9">
            <span class="md-nav__icon md-icon"></span>
            Epoch/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Epoch.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_9_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_9_2" id="__nav_1_5_6_2_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Properties/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_5_6_2_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_9_2">
            <span class="md-nav__icon md-icon"></span>
            Properties/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Epoch.Properties.ConstRwds.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ConstRwds
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Epoch.Properties.GovDepsMatch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GovDepsMatch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Epoch.Properties.NoPropSameDReps.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NoPropSameDReps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Fees.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fees
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Gov.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gov
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_12" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_12" id="__nav_1_5_6_2_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Gov/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_12">
            <span class="md-nav__icon md-icon"></span>
            Gov/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Gov.Base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Gov.Actions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Gov.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_12_4" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_12_4" id="__nav_1_5_6_2_12_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Properties/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_5_6_2_12_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_12_4">
            <span class="md-nav__icon md-icon"></span>
            Properties/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Gov.Properties.ChangePPGroup.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ChangePPGroup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Ledger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ledger.Ledger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_14" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_14" id="__nav_1_5_6_2_14_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ledger.Ledger/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_14">
            <span class="md-nav__icon md-icon"></span>
            Ledger.Ledger/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Ledger.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_14_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_14_2" id="__nav_1_5_6_2_14_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Properties/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_5_6_2_14_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_14_2">
            <span class="md-nav__icon md-icon"></span>
            Properties/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Ledger.Properties.GovDepsMatch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GovDepsMatch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Ledger.Properties.PoV.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PoV
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.PoolReap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PoolReap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.PParams.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PParams
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Ratify.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ratify
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_19" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_19" id="__nav_1_5_6_2_19_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ratify/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_19">
            <span class="md-nav__icon md-icon"></span>
            Ratify/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Ratify.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Rewards
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Ledger.Conway.Specification.Rewards.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Rewards
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sec:rewards-motivation" class="md-nav__link">
    <span class="md-ellipsis">
      Rewards Motivation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sec:rewards-amount" class="md-nav__link">
    <span class="md-ellipsis">
      Amount of Rewards to be Paid Out
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amount of Rewards to be Paid Out">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sec:precision-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      Precision of Arithmetic Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sec:rewards-distribution-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Rewards Distribution Calculation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rewards Distribution Calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sec:maxpool" class="md-nav__link">
    <span class="md-ellipsis">
      Function maxPool used for computing a Reward Update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sec:mkApparentPerformance" class="md-nav__link">
    <span class="md-ellipsis">
      Function mkApparentPerformance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sec:rewardOwners-and-rewardMember" class="md-nav__link">
    <span class="md-ellipsis">
      Functions rewardOwners and rewardMember
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sec:rewardOnePool" class="md-nav__link">
    <span class="md-ellipsis">
      Function rewardOnePool for Computing a Reward Update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filtering-the-stake-distribution-to-one-stake-pool" class="md-nav__link">
    <span class="md-ellipsis">
      Filtering the Stake Distribution to One Stake Pool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sec:computing-a-reward-update" class="md-nav__link">
    <span class="md-ellipsis">
      Computing a Reward Update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sec:reward-update" class="md-nav__link">
    <span class="md-ellipsis">
      Reward Update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sec:diagram-rewards" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: preservation of funds and rewards
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sec:stake-distribution-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      Stake Distribution Calculation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stake Distribution Calculation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#definitions-of-the-snapshot-type" class="md-nav__link">
    <span class="md-ellipsis">
      Definitions of the Snapshot type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#functions-for-computing-stake-distributions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions for Computing Stake Distributions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sec:rewards-time" class="md-nav__link">
    <span class="md-ellipsis">
      Timing of Rewards Payout
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Timing of Rewards Payout">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sec:rewards-timeline" class="md-nav__link">
    <span class="md-ellipsis">
      Rewards Calculation Timeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sec:illustration-reward-cycle" class="md-nav__link">
    <span class="md-ellipsis">
      Example Illustration of the Reward Cycle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sec:stake-distribution-snapshots" class="md-nav__link">
    <span class="md-ellipsis">
      Stake Distribution Snapshots
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Script.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Script
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_22" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_22" id="__nav_1_5_6_2_22_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Script/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_22">
            <span class="md-nav__icon md-icon"></span>
            Script/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Script.Base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Script.Timelock.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Timelock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Script.Validation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Validation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_23" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_23" id="__nav_1_5_6_2_23_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    TokenAlgebra/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_23">
            <span class="md-nav__icon md-icon"></span>
            TokenAlgebra/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.TokenAlgebra.Base.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.TokenAlgebra.Coin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.TokenAlgebra.ValueSet.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ValueSet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ValueVector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Transaction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transaction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Utxo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utxo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_26" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_26" id="__nav_1_5_6_2_26_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utxo/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_26_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_26">
            <span class="md-nav__icon md-icon"></span>
            Utxo/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Utxo.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_26_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_26_2" id="__nav_1_5_6_2_26_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Properties/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_5_6_2_26_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_26_2">
            <span class="md-nav__icon md-icon"></span>
            Properties/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Utxo.Properties.MinSpend.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MinSpend
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Utxo.Properties.PoV.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PoV
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Utxow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utxow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_28" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_28" id="__nav_1_5_6_2_28_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utxow/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_28_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_28">
            <span class="md-nav__icon md-icon"></span>
            Utxow/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Utxow.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_29" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_29" id="__nav_1_5_6_2_29_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Test
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_29_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_29">
            <span class="md-nav__icon md-icon"></span>
            Test
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Test.Examples.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_29_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_29_2" id="__nav_1_5_6_2_29_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_5_6_2_29_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_29_2">
            <span class="md-nav__icon md-icon"></span>
            Examples/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Test.Examples.HelloWorld.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HelloWorld
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Test.Examples.SucceedIfNumber.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SucceedIfNumber
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Test.LedgerImplementation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LedgerImplementation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Test.Lib.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lib
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Test.Prelude.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prelude
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Test.StructuredContracts.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    StructuredContracts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_2_30" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_2_30" id="__nav_1_5_6_2_30_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Types/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_2_30_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_2_30">
            <span class="md-nav__icon md-icon"></span>
            Types/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Specification.Types.GovStructure.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GovStructure
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_3" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_3" id="__nav_1_5_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bootstrap/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_3">
            <span class="md-nav__icon md-icon"></span>
            Bootstrap/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ConwayBootstrap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ConwayBootstrap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ConwayBootstrapEnact.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ConwayBootstrapEnact
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_4" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_4" id="__nav_1_5_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Foreign/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_4">
            <span class="md-nav__icon md-icon"></span>
            Foreign/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.ExternalFunctions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ExternalFunctions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HSLedger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_4_3" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_4_3" id="__nav_1_5_6_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    HSLedger/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_4_3">
            <span class="md-nav__icon md-icon"></span>
            HSLedger/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Address.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Address
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BaseTypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Cert.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Certs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Chain.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Core.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enact
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Epoch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Epoch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ExternalStructures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Gov.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gov
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_4_3_11" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_4_3_11" id="__nav_1_5_6_4_3_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Gov/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_1_5_6_4_3_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_4_3_11">
            <span class="md-nav__icon md-icon"></span>
            Gov/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Gov.Core.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Ledger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ledger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NewEpoch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PParams
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Ratify.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ratify
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Rewards.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rewards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Transaction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transaction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Foreign.HSLedger.Utxo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utxo
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conformance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_6" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_6" id="__nav_1_5_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Conformance/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_6">
            <span class="md-nav__icon md-icon"></span>
            Conformance/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Certs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_6_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_6_2" id="__nav_1_5_6_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Certs/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_6_2">
            <span class="md-nav__icon md-icon"></span>
            Certs/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Certs.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Chain.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_6_4" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_6_4" id="__nav_1_5_6_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Chain/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_6_4">
            <span class="md-nav__icon md-icon"></span>
            Chain/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Chain.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Epoch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Epoch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_6_6" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_6_6" id="__nav_1_5_6_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Epoch/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_6_6">
            <span class="md-nav__icon md-icon"></span>
            Epoch/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Epoch.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Equivalence.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Equivalence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_6_8" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_6_8" id="__nav_1_5_6_6_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Equivalence/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_6_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_6_8">
            <span class="md-nav__icon md-icon"></span>
            Equivalence/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Equivalence.Bisimilarity.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bisimilarity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Equivalence.Certs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Equivalence.Convert.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Equivalence.Deposits.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deposits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Equivalence.Map.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Map
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Equivalence.Utxo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utxo
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Gov.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gov
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Ledger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ledger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_6_11" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_6_11" id="__nav_1_5_6_6_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Ledger/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_6_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_6_11">
            <span class="md-nav__icon md-icon"></span>
            Ledger/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Ledger.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Rewards.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rewards
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Script.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Script
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Utxo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utxo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_6_16" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_6_16" id="__nav_1_5_6_6_16_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utxo/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_6_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_6_16">
            <span class="md-nav__icon md-icon"></span>
            Utxo/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Utxo.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Utxow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utxow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_6_6_18" >
        
          
          <label class="md-nav__link" for="__nav_1_5_6_6_18" id="__nav_1_5_6_6_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utxow/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_6_6_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_6_6_18">
            <span class="md-nav__icon md-icon"></span>
            Utxow/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.Conway.Conformance.Utxow.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PreConway
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_8" >
        
          
          <label class="md-nav__link" for="__nav_1_5_8" id="__nav_1_5_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    PreConway/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_8">
            <span class="md-nav__icon md-icon"></span>
            PreConway/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_8_1" >
        
          
          <label class="md-nav__link" for="__nav_1_5_8_1" id="__nav_1_5_8_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Conformance
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_8_1">
            <span class="md-nav__icon md-icon"></span>
            Conformance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.Conformance.NewPP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NewPP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_8_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_8_1_2" id="__nav_1_5_8_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    NewPP/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_8_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_8_1_2">
            <span class="md-nav__icon md-icon"></span>
            NewPP/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.Conformance.NewPP.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.Conformance.PPUp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PPUp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_8_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_5_8_1_4" id="__nav_1_5_8_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    PPUp/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_5_8_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_8_1_4">
            <span class="md-nav__icon md-icon"></span>
            PPUp/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.Conformance.PPUp.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.NewPP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NewPP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_8_3" >
        
          
          <label class="md-nav__link" for="__nav_1_5_8_3" id="__nav_1_5_8_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    NewPP/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_8_3">
            <span class="md-nav__icon md-icon"></span>
            NewPP/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.NewPP.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.PPUp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PPUp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_8_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5_8_5" id="__nav_1_5_8_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    PPUp/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_5_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_8_5">
            <span class="md-nav__icon md-icon"></span>
            PPUp/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Ledger.PreConway.PPUp.Properties.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Properties
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Foreign/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            Foreign/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Foreign.Convertible.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Convertible
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2" >
        
          
          <label class="md-nav__link" for="__nav_1_6_2" id="__nav_1_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Convertible/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_2">
            <span class="md-nav__icon md-icon"></span>
            Convertible/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Foreign.Convertible.Deriving.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deriving
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Foreign.Convertible.DerivingTest.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DerivingTest
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Foreign.HaskellTypes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HaskellTypes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_4" >
        
          
          <label class="md-nav__link" for="__nav_1_6_4" id="__nav_1_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    HaskellTypes/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6_4">
            <span class="md-nav__icon md-icon"></span>
            HaskellTypes/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Foreign.HaskellTypes.Deriving.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deriving
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Appendix/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            Appendix/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Prelude.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Agda Prelude
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7_2" >
        
          
          <label class="md-nav__link" for="__nav_1_7_2" id="__nav_1_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Type Classes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7_2">
            <span class="md-nav__icon md-icon"></span>
            Type Classes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7_2_1" >
        
          
          <label class="md-nav__link" for="__nav_1_7_2_1" id="__nav_1_7_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Interface
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_7_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7_2_1">
            <span class="md-nav__icon md-icon"></span>
            Interface
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Interface.ComputationalRelation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ComputationalRelation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Interface.HasSubset.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HasSubset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Interface.HasSubtract.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HasSubtract
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7_2_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_7_2_1_4" id="__nav_1_7_2_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    HasSubtract/
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_1_7_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            HasSubtract/
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Interface.HasSubtract.Instances.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Interface.Hashable.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hashable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Interface.STS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    STS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="MyDebugOptions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MyDebugOptions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="sec:rewards">Rewards<a class="headerlink" href="#sec:rewards" title="Permanent link">&para;</a></h1>
<p>This section is part of the <a href="https://github.com/IntersectMBO/formal-ledger-specifications/blob/master/src/Ledger/Conway/Specification/Rewards.lagda.md">Ledger.Conway.Specification.Rewards</a> module of the
<a href="https://github.com/IntersectMBO/formal-ledger-specifications">formal ledger specification</a>, where we define how rewards for stake pools and
their delegators are calculated and paid out. This calculation has two main aspects.</p>
<ol>
<li>
<p>The <em>amount</em> of rewards to be paid out. This is defined in the section <a href="#sec:rewards-amount">Amount of Rewards to be Paid Out</a>.</p>
</li>
<li>
<p>The <em>time</em> when rewards are paid out. This is defined in the section <a href="#sec:rewards-time">Timing of Rewards Payout</a>.</p>
</li>
</ol>
<pre class="Agda hidden-source">
<a id="509" class="Symbol">{-#</a> <a id="513" class="Keyword">OPTIONS</a> <a id="521" class="Pragma">--safe</a> <a id="528" class="Symbol">#-}</a>

<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="558" class="Keyword">using</a> <a id="564" class="Symbol">()</a> <a id="567" class="Keyword">renaming</a> <a id="576" class="Symbol">(</a><a id="577" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a> <a id="580" class="Symbol">to</a> <a id="583" class="InductiveConstructor">pos</a><a id="586" class="Symbol">)</a>
<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="614" class="Keyword">using</a> <a id="620" class="Symbol">(</a><a id="621" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="622" class="Symbol">;</a> <a id="624" href="Data.Rational.Base.html#7195" class="Function">floor</a><a id="629" class="Symbol">;</a> <a id="631" href="Data.Rational.Base.html#6394" class="Function Operator">_*_</a><a id="634" class="Symbol">;</a> <a id="636" href="Data.Rational.Base.html#6787" class="Function Operator">_÷_</a><a id="639" class="Symbol">;</a> <a id="641" href="Data.Rational.Base.html#3963" class="Function Operator">_/_</a><a id="644" class="Symbol">;</a> <a id="646" href="Data.Rational.Base.html#6484" class="Function Operator">_-_</a><a id="649" class="Symbol">;</a> <a id="651" href="Data.Rational.Base.html#5293" class="Function">&gt;-nonZero</a><a id="660" class="Symbol">;</a> <a id="662" href="Data.Rational.Base.html#6933" class="Function Operator">_⊓_</a><a id="665" class="Symbol">)</a>
                          <a id="693" class="Keyword">renaming</a> <a id="702" class="Symbol">(</a><a id="703" href="Data.Rational.Base.html#6855" class="Function Operator">_⊔_</a> <a id="707" class="Symbol">to</a> <a id="710" class="Function Operator">_⊔ℚ_</a><a id="714" class="Symbol">;</a> <a id="716" href="Data.Rational.Base.html#4577" class="Function">NonZero</a> <a id="724" class="Symbol">to</a> <a id="727" class="Function">NonZeroℚ</a><a id="735" class="Symbol">)</a>
<a id="737" class="Keyword">open</a> <a id="742" class="Keyword">import</a> <a id="749" href="Data.Rational.Literals.html" class="Module">Data.Rational.Literals</a> <a id="772" class="Keyword">using</a> <a id="778" class="Symbol">(</a><a id="779" href="Data.Rational.Literals.html#740" class="Function">number</a><a id="785" class="Symbol">;</a> <a id="787" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a><a id="792" class="Symbol">)</a>
<a id="794" class="Keyword">open</a> <a id="799" class="Keyword">import</a> <a id="806" href="Data.Rational.Properties.html" class="Module">Data.Rational.Properties</a> <a id="831" class="Keyword">using</a> <a id="837" class="Symbol">(</a><a id="838" href="Data.Rational.Properties.html#7854" class="Function">pos⇒nonZero</a><a id="849" class="Symbol">;</a> <a id="851" href="Data.Rational.Properties.html#26962" class="Function">positive⁻¹</a><a id="861" class="Symbol">;</a> <a id="863" href="Data.Rational.Properties.html#36227" class="Function">+-mono-&lt;-≤</a><a id="873" class="Symbol">;</a> <a id="875" href="Data.Rational.Properties.html#11914" class="Function">normalize-pos</a><a id="888" class="Symbol">;</a> <a id="890" href="Data.Rational.Properties.html#58180" class="Function">p≤p⊔q</a><a id="895" class="Symbol">)</a>
<a id="897" class="Keyword">open</a> <a id="902" class="Keyword">import</a> <a id="909" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>
<a id="946" class="Keyword">open</a> <a id="951" class="Keyword">import</a> <a id="958" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="998" class="Keyword">open</a> <a id="1003" class="Keyword">import</a> <a id="1010" href="Ledger.Prelude.Numeric.UnitInterval.html" class="Module">Ledger.Prelude.Numeric.UnitInterval</a>

<a id="1047" class="Keyword">open</a> <a id="1052" class="Keyword">import</a> <a id="1059" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>
<a id="1080" class="Keyword">open</a>        <a id="1092" href="Agda.Builtin.FromNat.html#196" class="Module">Number</a> <a id="1099" href="Data.Rational.Literals.html#740" class="Function">number</a> <a id="1106" class="Keyword">renaming</a> <a id="1115" class="Symbol">(</a><a id="1116" href="Agda.Builtin.FromNat.html#281" class="Field">fromNat</a> <a id="1124" class="Symbol">to</a> <a id="1127" class="Field">fromℕ</a><a id="1132" class="Symbol">)</a>

<a id="1135" class="Keyword">module</a> <a id="1142" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a>
  <a id="1180" class="Symbol">(</a><a id="1181" href="Ledger.Conway.Specification.Rewards.html#1181" class="Bound">txs</a> <a id="1185" class="Symbol">:</a> <a id="1187" class="Symbol">_)</a> <a id="1190" class="Symbol">(</a><a id="1191" class="Keyword">open</a> <a id="1196" href="Ledger.Conway.Specification.Transaction.html#2762" class="Module">TransactionStructure</a> <a id="1217" href="Ledger.Conway.Specification.Rewards.html#1181" class="Bound">txs</a><a id="1220" class="Symbol">)</a>
  <a id="1224" class="Symbol">(</a><a id="1225" href="Ledger.Conway.Specification.Rewards.html#1225" class="Bound">abs</a> <a id="1229" class="Symbol">:</a> <a id="1231" href="Ledger.Conway.Specification.Abstract.html#649" class="Record">AbstractFunctions</a> <a id="1249" href="Ledger.Conway.Specification.Rewards.html#1181" class="Bound">txs</a><a id="1252" class="Symbol">)</a>
  <a id="1256" class="Keyword">where</a>

<a id="1263" class="Keyword">open</a> <a id="1268" class="Keyword">import</a> <a id="1275" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="1309" href="Ledger.Conway.Specification.Transaction.html#3892" class="Function">govStructure</a>
<a id="1322" class="Keyword">open</a> <a id="1327" class="Keyword">import</a> <a id="1334" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="1369" href="Ledger.Conway.Specification.Rewards.html#1181" class="Bound">txs</a> <a id="1373" href="Ledger.Conway.Specification.Rewards.html#1225" class="Bound">abs</a>
<a id="1377" class="Keyword">open</a> <a id="1382" class="Keyword">import</a> <a id="1389" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="1404" class="Keyword">hiding</a> <a id="1411" class="Symbol">(</a><a id="1412" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="1415" class="Symbol">;</a> <a id="1417" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="1420" class="Symbol">;</a> <a id="1422" href="Interface.HasSubtract.html#217" class="Field Operator">_-_</a><a id="1425" class="Symbol">;</a> <a id="1427" href="Data.Nat.Base.html#3537" class="Function">&gt;-nonZero</a><a id="1436" class="Symbol">;</a> <a id="1438" href="Data.Nat.Base.html#5851" class="Function Operator">_⊓_</a><a id="1441" class="Symbol">)</a>
<a id="1443" class="Keyword">open</a> <a id="1448" class="Keyword">import</a> <a id="1455" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="1488" href="Ledger.Conway.Specification.Rewards.html#1181" class="Bound">txs</a> <a id="1492" href="Ledger.Conway.Specification.Rewards.html#1225" class="Bound">abs</a>
</pre>

<h2 id="sec:rewards-motivation">Rewards Motivation<a class="headerlink" href="#sec:rewards-motivation" title="Permanent link">&para;</a></h2>
<p>In order to operate, any blockchain needs to attract parties that are
willing to spend computational and network resources on processing
transactions and producing new blocks. These parties, called <em>block producers</em>, are
incentivized by monetary <em>rewards</em>.</p>
<p>Cardano is a <em>proof-of-stake</em> (PoS) blockchain: through a random lottery,
one block producer is selected to produce one particular block. The
probability for being select depends on their <em>stake</em> of Ada, that is the
amount of Ada that they (and their delegators) own relative to the total
amount of Ada. (We will explain delegation below.) After successful
block production, the block producer is eligible for a share of the
rewards.</p>
<p>The rewards for block producers come from two sources: during an initial
period, rewards are paid out from the <em>reserve</em>, which is an initial
allocation of Ada created for this very purpose. Over time, the reserve
is depleted, and rewards are sourced from transaction fees.</p>
<p>Rewards are paid out epoch by epoch.</p>
<p>Rewards are collective, but depend on performance: after every epoch, a
fraction of the available reserve and the transaction fees accumulated
during that epoch are added together. This sum is paid out to the block
producers proportionally to how many blocks they have created each. In
order to avoid perverse incentives, block producers do not receive
individual rewards that depend on the content of their blocks.</p>
<p>Not all people can or want to set up and administer a dedicated computer
that produces blocks. However, these people still own Ada, and their
stake is relevant for block production. Specifically, these people have
the option to <em>delegate</em> their stake to a <em>stake pool</em>, which belongs to a
block producer. This stake counts towards the stake of the pool in the
block production lottery. In turn, the protocol distributes the rewards
for produced blocks to the stake pool owner and their delegators. The
owner receives a fixed fee (“cost”) and a share of the rewards
(“margin”). The remainder is distributed among delegators in proportion
to their stake. By design, delegation and ownership are separate---delegation counts
towards the stake of the pool, but delegators remain in full control of their Ada,
stake pools cannot spend delegated Ada.</p>
<p>Stake pools compete for delegators based on fees and performance. In
order to achieve stable blockchain operation, the rewards are chosen
such that they incentivize the system to evolve into a large, but fixed
number of stake pools that attract most of the stake. For more details
about the design and rationale of the rewards and delegation system, see
<a href="#shelley-delegation-design">Team18</a>.</p>
<h2 id="sec:rewards-amount">Amount of Rewards to be Paid Out<a class="headerlink" href="#sec:rewards-amount" title="Permanent link">&para;</a></h2>
<h3 id="sec:precision-rewards">Precision of Arithmetic Operations<a class="headerlink" href="#sec:precision-rewards" title="Permanent link">&para;</a></h3>
<p>When computing rewards, all intermediate results are computed using
rational numbers, <code class="AgdaDatatype">ℚ</code>, and converted to
<code class="AgdaFunction">Coin</code> using the <code class="AgdaFunction">floor</code> function at the
very end of the computation.</p>
<div class="admonition note">
<p class="admonition-title">Note for implementors</p>
<p>Values in <code class="AgdaDatatype">ℚ</code> can have arbitrarily
large nominators and denominators. Please use an appropriate type that
represents rational numbers as fractions of unbounded nominators and
denominators. Types such as <code class="AgdaFunction">Double</code>,
<code class="AgdaFunction">Float</code>, <code class="AgdaFunction">BigDecimal</code> (Java Platform), or
<code class="AgdaFunction">Fixed</code> (fixed-precision arithmetic) do <em>not</em> faithfully
represent the rational numbers, and are <em>not</em> suitable for computing
rewards according to this specification!</p>
</div>
<p>We use the following arithmetic operations besides basic arithmetic:</p>
<ul>
<li>
<p><code class="AgdaFunction">fromℕ</code>: Interpret a natural number as a rational
  number.</p>
</li>
<li>
<p><code class="AgdaFunction">floor</code>: Round a rational number to the next smaller
  integer.</p>
</li>
<li>
<p><code class="AgdaFunction">posPart</code>: Convert an integer to a natural number by
  mapping all negative numbers to zero.</p>
</li>
<li>
<p><code class="AgdaFunction">÷</code>: Division of rational numbers.</p>
</li>
<li>
<p><code class="AgdaFunction">÷₀</code>: Division operator that returns zero when the
  denominator is zero.</p>
</li>
<li>
<p><code class="AgdaFunction">/</code>: Division operator that maps integer arguments to a
  rational number.</p>
</li>
<li>
<p><code class="AgdaFunction">/₀</code>: Like <code class="AgdaFunction">÷₀</code>, but with integer
  arguments.</p>
</li>
</ul>
<h2 id="sec:rewards-distribution-calculation">Rewards Distribution Calculation<a class="headerlink" href="#sec:rewards-distribution-calculation" title="Permanent link">&para;</a></h2>
<p>This section defines the amount of rewards that are paid out to stake
pools and their delegators.</p>
<h3 id="sec:maxpool">Function <code class="AgdaFunction">maxPool</code> used for computing a Reward Update<a class="headerlink" href="#sec:maxpool" title="Permanent link">&para;</a></h3>
<p>This subsection defines the function <code class="AgdaFunction">maxPool</code> which gives the maximum
reward a stake pool can receive in an epoch. Relevant quantities are the following:</p>
<ul>
<li>
<p><code class="AgdaArgument">rewardPot</code>: Total rewards to be paid out after the
  epoch.</p>
</li>
<li>
<p><code class="AgdaArgument">stake</code>: Relative stake of the pool.</p>
</li>
<li>
<p><code class="AgdaArgument">pledge</code>: Relative stake that the pool owner has
  pledged themselves to the pool.</p>
</li>
<li>
<p><code class="AgdaFunction">z0</code>: Relative stake of a fully saturated pool.</p>
</li>
<li>
<p><code class="AgdaFunction">nopt</code>: Protocol parameter, planned number of block
  producers.</p>
</li>
<li>
<p><code class="AgdaFunction">a0</code>: Protocol parameter that incentivizes higher
  pledges.</p>
</li>
<li>
<p><code class="AgdaFunction">rewardℚ</code>: Pool rewards as a rational number.</p>
</li>
<li>
<p><code class="AgdaFunction">rewardℕ</code>: Pool rewards after rounding to a natural
  number of lovelace.</p>
</li>
</ul>
<pre class="Agda hidden-source"><a id="nonZero-max-1"></a><a id="7025" href="Ledger.Conway.Specification.Rewards.html#7025" class="Function">nonZero-max-1</a> <a id="7039" class="Symbol">:</a> <a id="7041" class="Symbol">∀</a> <a id="7043" class="Symbol">(</a><a id="7044" href="Ledger.Conway.Specification.Rewards.html#7044" class="Bound">n</a> <a id="7046" class="Symbol">:</a> <a id="7048" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="7049" class="Symbol">)</a> <a id="7051" class="Symbol">→</a> <a id="7053" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="7061" class="Symbol">(</a><a id="7062" class="Number">1</a> <a id="7064" href="Data.Nat.Base.html#5485" class="Function Operator">⊔</a> <a id="7066" href="Ledger.Conway.Specification.Rewards.html#7044" class="Bound">n</a><a id="7067" class="Symbol">)</a>
<a id="7069" href="Ledger.Conway.Specification.Rewards.html#7025" class="Function">nonZero-max-1</a> <a id="7083" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="7088" class="Symbol">=</a> <a id="7090" href="Data.Nat.Base.html#3359" class="Function">nonZero</a>
<a id="7098" href="Ledger.Conway.Specification.Rewards.html#7025" class="Function">nonZero-max-1</a> <a id="7112" class="Symbol">(</a><a id="7113" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="7117" href="Ledger.Conway.Specification.Rewards.html#7117" class="Bound">n</a><a id="7118" class="Symbol">)</a> <a id="7120" class="Symbol">=</a> <a id="7122" href="Data.Nat.Base.html#3359" class="Function">nonZero</a>

<a id="nonZero-1/n"></a><a id="7131" href="Ledger.Conway.Specification.Rewards.html#7131" class="Function">nonZero-1/n</a> <a id="7143" class="Symbol">:</a> <a id="7145" class="Symbol">∀</a> <a id="7147" class="Symbol">(</a><a id="7148" href="Ledger.Conway.Specification.Rewards.html#7148" class="Bound">n</a> <a id="7150" class="Symbol">:</a> <a id="7152" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="7153" class="Symbol">)</a> <a id="7155" class="Symbol">→</a> <a id="7157" class="Symbol">.{{</a><a id="7160" href="Ledger.Conway.Specification.Rewards.html#7160" class="Bound">_</a> <a id="7162" class="Symbol">:</a> <a id="7164" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="7172" href="Ledger.Conway.Specification.Rewards.html#7148" class="Bound">n</a><a id="7173" class="Symbol">}}</a> <a id="7176" class="Symbol">→</a> <a id="7178" href="Ledger.Conway.Specification.Rewards.html#727" class="Function">NonZeroℚ</a> <a id="7187" class="Symbol">(</a><a id="7188" class="Number">1</a> <a id="7190" href="Data.Rational.Base.html#3963" class="Function Operator">/</a> <a id="7192" href="Ledger.Conway.Specification.Rewards.html#7148" class="Bound">n</a><a id="7193" class="Symbol">)</a>
<a id="7195" href="Ledger.Conway.Specification.Rewards.html#7131" class="Function">nonZero-1/n</a> <a id="7207" href="Ledger.Conway.Specification.Rewards.html#7207" class="Bound">n</a> <a id="7209" class="Symbol">{{</a><a id="7211" href="Ledger.Conway.Specification.Rewards.html#7211" class="Bound">prf</a><a id="7214" class="Symbol">}}</a> <a id="7217" class="Symbol">=</a>
  <a id="7221" href="Data.Rational.Properties.html#7854" class="Function">pos⇒nonZero</a> <a id="7233" class="Symbol">(</a><a id="7234" class="Number">1</a> <a id="7236" href="Data.Rational.Base.html#3963" class="Function Operator">/</a> <a id="7238" href="Ledger.Conway.Specification.Rewards.html#7207" class="Bound">n</a><a id="7239" class="Symbol">)</a> <a id="7241" class="Symbol">{{</a><a id="7243" href="Data.Rational.Properties.html#11914" class="Function">normalize-pos</a> <a id="7257" class="Number">1</a> <a id="7259" href="Ledger.Conway.Specification.Rewards.html#7207" class="Bound">n</a> <a id="7261" class="Symbol">{{</a><a id="7263" href="Ledger.Conway.Specification.Rewards.html#7211" class="Bound">prf</a><a id="7266" class="Symbol">}}</a> <a id="7269" class="Symbol">{{_}}</a> <a id="7275" class="Symbol">}}</a>

<a id="nonZero-1+max0-x"></a><a id="7279" href="Ledger.Conway.Specification.Rewards.html#7279" class="Function">nonZero-1+max0-x</a> <a id="7296" class="Symbol">:</a> <a id="7298" class="Symbol">∀</a> <a id="7300" class="Symbol">(</a><a id="7301" href="Ledger.Conway.Specification.Rewards.html#7301" class="Bound">x</a> <a id="7303" class="Symbol">:</a> <a id="7305" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="7306" class="Symbol">)</a> <a id="7308" class="Symbol">→</a> <a id="7310" href="Ledger.Conway.Specification.Rewards.html#727" class="Function">NonZeroℚ</a> <a id="7319" class="Symbol">(</a><a id="7320" class="Number">1</a> <a id="7322" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="7324" class="Symbol">(</a><a id="7325" class="Number">0</a> <a id="7327" href="Ledger.Conway.Specification.Rewards.html#710" class="Function Operator">⊔ℚ</a> <a id="7330" href="Ledger.Conway.Specification.Rewards.html#7301" class="Bound">x</a><a id="7331" class="Symbol">))</a>
<a id="7334" href="Ledger.Conway.Specification.Rewards.html#7279" class="Function">nonZero-1+max0-x</a> <a id="7351" href="Ledger.Conway.Specification.Rewards.html#7351" class="Bound">x</a> <a id="7353" class="Symbol">=</a>
  <a id="7357" href="Data.Rational.Base.html#5293" class="Function">&gt;-nonZero</a> <a id="7367" class="Symbol">(</a><a id="7368" href="Data.Rational.Properties.html#36227" class="Function">+-mono-&lt;-≤</a> <a id="7379" class="Symbol">(</a><a id="7380" href="Data.Rational.Properties.html#26962" class="Function">positive⁻¹</a> <a id="7391" class="Number">1</a> <a id="7393" class="Symbol">{{_}})</a> <a id="7400" class="Symbol">(</a><a id="7401" href="Data.Rational.Properties.html#58180" class="Function">p≤p⊔q</a> <a id="7407" class="Number">0</a> <a id="7409" href="Ledger.Conway.Specification.Rewards.html#7351" class="Bound">x</a><a id="7410" class="Symbol">))</a>
</pre>

<pre class="Agda"><a id="maxPool"></a><a id="7430" href="Ledger.Conway.Specification.Rewards.html#7430" class="Function">maxPool</a> <a id="7438" class="Symbol">:</a> <a id="7440" href="Ledger.Conway.Specification.PParams.html#3050" class="Record">PParams</a> <a id="7448" class="Symbol">→</a> <a id="7450" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="7455" class="Symbol">→</a> <a id="7457" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="7470" class="Symbol">→</a> <a id="7472" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="7485" class="Symbol">→</a> <a id="7487" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
<a id="7492" href="Ledger.Conway.Specification.Rewards.html#7430" class="Function">maxPool</a> <a id="7500" href="Ledger.Conway.Specification.Rewards.html#7500" class="Bound">pparams</a> <a id="7508" href="Ledger.Conway.Specification.Rewards.html#7508" class="Bound">rewardPot</a> <a id="7518" href="Ledger.Conway.Specification.Rewards.html#7518" class="Bound">stake</a> <a id="7524" href="Ledger.Conway.Specification.Rewards.html#7524" class="Bound">pledge</a> <a id="7531" class="Symbol">=</a> <a id="7533" href="Ledger.Conway.Specification.Rewards.html#8300" class="Function">rewardℕ</a>
  <a id="7543" class="Keyword">where</a>
    <a id="7553" href="Ledger.Conway.Specification.Rewards.html#7553" class="Function">a0</a>    <a id="7559" class="Symbol">=</a> <a id="7561" class="Number">0</a> <a id="7563" href="Ledger.Conway.Specification.Rewards.html#710" class="Function Operator">⊔ℚ</a> <a id="7566" href="Ledger.Conway.Specification.Rewards.html#7500" class="Bound">pparams</a> <a id="7574" class="Symbol">.</a><a id="7575" href="Ledger.Conway.Specification.PParams.html#4385" class="Field">PParams.a0</a>
    <a id="7590" href="Ledger.Conway.Specification.Rewards.html#7590" class="Function">1+a0</a>  <a id="7596" class="Symbol">=</a> <a id="7598" class="Number">1</a> <a id="7600" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="7602" href="Ledger.Conway.Specification.Rewards.html#7553" class="Function">a0</a>
    <a id="7609" href="Ledger.Conway.Specification.Rewards.html#7609" class="Function">nopt</a>  <a id="7615" class="Symbol">=</a> <a id="7617" class="Number">1</a> <a id="7619" href="Data.Nat.Base.html#5485" class="Function Operator">⊔</a> <a id="7621" href="Ledger.Conway.Specification.Rewards.html#7500" class="Bound">pparams</a> <a id="7629" class="Symbol">.</a><a id="7630" href="Ledger.Conway.Specification.PParams.html#4343" class="Field">PParams.nopt</a>
</pre>
<pre class="Agda hidden-source">    <a id="7665" class="Keyword">instance</a>
      <a id="7680" href="Ledger.Conway.Specification.Rewards.html#7680" class="Function">nonZero-nopt</a> <a id="7693" class="Symbol">:</a> <a id="7695" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="7703" href="Ledger.Conway.Specification.Rewards.html#7609" class="Function">nopt</a>
      <a id="7714" href="Ledger.Conway.Specification.Rewards.html#7680" class="Function">nonZero-nopt</a> <a id="7727" class="Symbol">=</a> <a id="7729" href="Ledger.Conway.Specification.Rewards.html#7025" class="Function">nonZero-max-1</a> <a id="7743" class="Symbol">(</a><a id="7744" href="Ledger.Conway.Specification.Rewards.html#7500" class="Bound">pparams</a> <a id="7752" class="Symbol">.</a><a id="7753" href="Ledger.Conway.Specification.PParams.html#4343" class="Field">PParams.nopt</a><a id="7765" class="Symbol">)</a>
</pre>

<pre class="Agda">    <a id="7788" href="Ledger.Conway.Specification.Rewards.html#7788" class="Function">z0</a>       <a id="7797" class="Symbol">=</a> <a id="7799" class="Number">1</a> <a id="7801" href="Data.Rational.Base.html#3963" class="Function Operator">/</a> <a id="7803" href="Ledger.Conway.Specification.Rewards.html#7609" class="Function">nopt</a>
    <a id="7812" href="Ledger.Conway.Specification.Rewards.html#7812" class="Function">stake&#39;</a>   <a id="7821" class="Symbol">=</a> <a id="7823" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="7840" href="Ledger.Conway.Specification.Rewards.html#7518" class="Bound">stake</a> <a id="7846" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="7848" href="Ledger.Conway.Specification.Rewards.html#7788" class="Function">z0</a>
    <a id="7855" href="Ledger.Conway.Specification.Rewards.html#7855" class="Function">pledge&#39;</a>  <a id="7864" class="Symbol">=</a> <a id="7866" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="7883" href="Ledger.Conway.Specification.Rewards.html#7524" class="Bound">pledge</a> <a id="7890" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="7892" href="Ledger.Conway.Specification.Rewards.html#7788" class="Function">z0</a>
</pre>
<pre class="Agda hidden-source">    <a id="7917" class="Keyword">instance</a>
      <a id="7932" href="Ledger.Conway.Specification.Rewards.html#7932" class="Function">nonZeroz0</a> <a id="7942" class="Symbol">:</a> <a id="7944" href="Ledger.Conway.Specification.Rewards.html#727" class="Function">NonZeroℚ</a> <a id="7953" href="Ledger.Conway.Specification.Rewards.html#7788" class="Function">z0</a>
      <a id="7962" href="Ledger.Conway.Specification.Rewards.html#7932" class="Function">nonZeroz0</a> <a id="7972" class="Symbol">=</a> <a id="7974" href="Ledger.Conway.Specification.Rewards.html#7131" class="Function">nonZero-1/n</a> <a id="7986" href="Ledger.Conway.Specification.Rewards.html#7609" class="Function">nopt</a>

      <a id="7998" href="Ledger.Conway.Specification.Rewards.html#7998" class="Function">nonZero-1+a0</a> <a id="8011" class="Symbol">:</a> <a id="8013" href="Ledger.Conway.Specification.Rewards.html#727" class="Function">NonZeroℚ</a> <a id="8022" class="Symbol">(</a><a id="8023" href="Ledger.Conway.Specification.Rewards.html#7590" class="Function">1+a0</a><a id="8027" class="Symbol">)</a>
      <a id="8035" href="Ledger.Conway.Specification.Rewards.html#7998" class="Function">nonZero-1+a0</a> <a id="8048" class="Symbol">=</a> <a id="8050" href="Ledger.Conway.Specification.Rewards.html#7279" class="Function">nonZero-1+max0-x</a> <a id="8067" class="Symbol">(</a><a id="8068" href="Ledger.Conway.Specification.Rewards.html#7500" class="Bound">pparams</a> <a id="8076" class="Symbol">.</a><a id="8077" href="Ledger.Conway.Specification.PParams.html#4385" class="Field">PParams.a0</a><a id="8087" class="Symbol">)</a>
</pre>

<pre class="Agda">    <a id="8110" href="Ledger.Conway.Specification.Rewards.html#8110" class="Function">rewardℚ</a> <a id="8118" class="Symbol">=</a>  <a id="8121" href="Ledger.Conway.Specification.Rewards.html#1127" class="Function">fromℕ</a> <a id="8127" href="Ledger.Conway.Specification.Rewards.html#7508" class="Bound">rewardPot</a> <a id="8137" href="Data.Rational.Base.html#6787" class="Function Operator">÷</a> <a id="8139" href="Ledger.Conway.Specification.Rewards.html#7590" class="Function">1+a0</a>
               <a id="8159" href="Data.Rational.Base.html#6394" class="Function Operator">*</a>  <a id="8162" class="Symbol">(</a>  <a id="8165" href="Ledger.Conway.Specification.Rewards.html#7812" class="Function">stake&#39;</a> <a id="8172" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="8174" href="Ledger.Conway.Specification.Rewards.html#7855" class="Function">pledge&#39;</a> <a id="8182" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="8184" href="Ledger.Conway.Specification.Rewards.html#7553" class="Function">a0</a>
                    <a id="8207" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="8209" class="Symbol">(</a> <a id="8211" href="Ledger.Conway.Specification.Rewards.html#7812" class="Function">stake&#39;</a> <a id="8218" href="Data.Rational.Base.html#6484" class="Function Operator">-</a> <a id="8220" href="Ledger.Conway.Specification.Rewards.html#7855" class="Function">pledge&#39;</a> <a id="8228" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="8230" class="Symbol">(</a><a id="8231" href="Ledger.Conway.Specification.Rewards.html#7788" class="Function">z0</a> <a id="8234" href="Data.Rational.Base.html#6484" class="Function Operator">-</a> <a id="8236" href="Ledger.Conway.Specification.Rewards.html#7812" class="Function">stake&#39;</a><a id="8242" class="Symbol">)</a> <a id="8244" href="Data.Rational.Base.html#6787" class="Function Operator">÷</a> <a id="8246" href="Ledger.Conway.Specification.Rewards.html#7788" class="Function">z0</a> <a id="8249" class="Symbol">)</a>
                    <a id="8271" href="Data.Rational.Base.html#6787" class="Function Operator">÷</a> <a id="8273" href="Ledger.Conway.Specification.Rewards.html#7788" class="Function">z0</a>
                  <a id="8294" class="Symbol">)</a>
    <a id="8300" href="Ledger.Conway.Specification.Rewards.html#8300" class="Function">rewardℕ</a> <a id="8308" class="Symbol">=</a> <a id="8310" href="Prelude.html#3287" class="Function">posPart</a> <a id="8318" class="Symbol">(</a><a id="8319" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="8325" href="Ledger.Conway.Specification.Rewards.html#8110" class="Function">rewardℚ</a><a id="8332" class="Symbol">)</a>
</pre>
<h3 id="sec:mkApparentPerformance">Function <code class="AgdaFunction">mkApparentPerformance</code><a class="headerlink" href="#sec:mkApparentPerformance" title="Permanent link">&para;</a></h3>
<p>This section defines the function <code class="AgdaFunction">mkApparentPerformance</code> which is
used for computing a Reward Update; it computes the apparent performance of a stake
pool.  Relevant quantities are the following:</p>
<ul>
<li>
<p><code class="AgdaArgument">stake</code>: Relative active stake of the pool.</p>
</li>
<li>
<p><code class="AgdaArgument">poolBlocks</code>: Number of blocks that the pool added to
  the chain in the last epoch.</p>
</li>
<li>
<p><code class="AgdaArgument">totalBlocks</code>: Total number of blocks added in the last
  epoch.</p>
</li>
</ul>
<pre class="Agda"><a id="mkApparentPerformance"></a><a id="8890" href="Ledger.Conway.Specification.Rewards.html#8890" class="Function">mkApparentPerformance</a> <a id="8912" class="Symbol">:</a> <a id="8914" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="8927" class="Symbol">→</a> <a id="8929" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="8931" class="Symbol">→</a> <a id="8933" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="8935" class="Symbol">→</a> <a id="8937" href="Data.Rational.Base.html#1421" class="Record">ℚ</a>
<a id="8939" href="Ledger.Conway.Specification.Rewards.html#8890" class="Function">mkApparentPerformance</a> <a id="8961" href="Ledger.Conway.Specification.Rewards.html#8961" class="Bound">stake</a> <a id="8967" href="Ledger.Conway.Specification.Rewards.html#8967" class="Bound">poolBlocks</a> <a id="8978" href="Ledger.Conway.Specification.Rewards.html#8978" class="Bound">totalBlocks</a> <a id="8990" class="Symbol">=</a> <a id="8992" href="Ledger.Conway.Specification.Rewards.html#9218" class="Function">ratioBlocks</a> <a id="9004" href="Ledger.Prelude.html#2023" class="Function Operator">÷₀</a> <a id="9007" href="Ledger.Conway.Specification.Rewards.html#9026" class="Function">stake&#39;</a>
  <a id="9016" class="Keyword">where</a>
    <a id="9026" href="Ledger.Conway.Specification.Rewards.html#9026" class="Function">stake&#39;</a> <a id="9033" class="Symbol">=</a> <a id="9035" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="9052" href="Ledger.Conway.Specification.Rewards.html#8961" class="Bound">stake</a>
</pre>
<pre class="Agda hidden-source">    <a id="9080" class="Keyword">instance</a>
      <a id="9095" href="Ledger.Conway.Specification.Rewards.html#9095" class="Function">nonZero-totalBlocks</a> <a id="9115" class="Symbol">:</a> <a id="9117" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="9125" class="Symbol">(</a><a id="9126" class="Number">1</a> <a id="9128" href="Data.Nat.Base.html#5485" class="Function Operator">⊔</a> <a id="9130" href="Ledger.Conway.Specification.Rewards.html#8978" class="Bound">totalBlocks</a><a id="9141" class="Symbol">)</a>
      <a id="9149" href="Ledger.Conway.Specification.Rewards.html#9095" class="Function">nonZero-totalBlocks</a> <a id="9169" class="Symbol">=</a> <a id="9171" href="Ledger.Conway.Specification.Rewards.html#7025" class="Function">nonZero-max-1</a> <a id="9185" href="Ledger.Conway.Specification.Rewards.html#8978" class="Bound">totalBlocks</a>
</pre>

<pre class="Agda">    <a id="9218" href="Ledger.Conway.Specification.Rewards.html#9218" class="Function">ratioBlocks</a> <a id="9230" class="Symbol">=</a> <a id="9232" class="Symbol">(</a><a id="9233" href="Ledger.Conway.Specification.Rewards.html#583" class="InductiveConstructor">pos</a> <a id="9237" href="Ledger.Conway.Specification.Rewards.html#8967" class="Bound">poolBlocks</a><a id="9247" class="Symbol">)</a> <a id="9249" href="Data.Rational.Base.html#3963" class="Function Operator">/</a> <a id="9251" class="Symbol">(</a><a id="9252" class="Number">1</a> <a id="9254" href="Data.Nat.Base.html#5485" class="Function Operator">⊔</a> <a id="9256" href="Ledger.Conway.Specification.Rewards.html#8978" class="Bound">totalBlocks</a><a id="9267" class="Symbol">)</a>
</pre>
<h3 id="sec:rewardOwners-and-rewardMember">Functions <code class="AgdaFunction">rewardOwners</code> and <code class="AgdaFunction">rewardMember</code><a class="headerlink" href="#sec:rewardOwners-and-rewardMember" title="Permanent link">&para;</a></h3>
<p>This subsection defines the functions <code class="AgdaFunction">rewardOwners</code> and
<code class="AgdaFunction">rewardMember</code>.  Their purpose is to divide the reward for one pool
between pool owners and individual delegators by taking into account a fixed pool
cost, a relative pool margin, and the stake of each member.  The rewards will be
distributed as follows:</p>
<ul>
<li>
<p><code class="AgdaArgument">rewardOwners</code>: These funds will go to the
  <code class="AgdaField">rewardAccount</code> specified in the pool registration
  certificate.</p>
</li>
<li>
<p><code class="AgdaArgument">rewardMember</code>: These funds will go to the reward
  accounts of the individual delegators.</p>
</li>
</ul>
<p>Relevant quantities for these functions are the following:</p>
<ul>
<li>
<p><code class="AgdaArgument">rewards</code>: Rewards paid out to this pool.</p>
</li>
<li>
<p><code class="AgdaArgument">pool</code>: Pool parameters, such as cost and margin.</p>
</li>
<li>
<p><code class="AgdaArgument">ownerStake</code>: Stake of the pool owners relative to the
  total amount of Ada.</p>
</li>
<li>
<p><code class="AgdaArgument">memberStake</code>: Stake of the pool member relative to the
  total amount of Ada.</p>
</li>
<li>
<p><code class="AgdaArgument">stake</code>: Stake of the whole pool relative to the total
  amount of Ada.</p>
</li>
</ul>
<pre class="Agda"><a id="rewardOwners"></a><a id="10462" href="Ledger.Conway.Specification.Rewards.html#10462" class="Function">rewardOwners</a> <a id="10475" class="Symbol">:</a> <a id="10477" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="10482" class="Symbol">→</a> <a id="10484" href="Ledger.Conway.Specification.Certs.html#1620" class="Record">StakePoolParams</a> <a id="10500" class="Symbol">→</a> <a id="10502" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="10515" class="Symbol">→</a> <a id="10517" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="10530" class="Symbol">→</a> <a id="10532" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
<a id="10537" href="Ledger.Conway.Specification.Rewards.html#10462" class="Function">rewardOwners</a> <a id="10550" href="Ledger.Conway.Specification.Rewards.html#10550" class="Bound">rewards</a> <a id="10558" href="Ledger.Conway.Specification.Rewards.html#10558" class="Bound">pool</a> <a id="10563" href="Ledger.Conway.Specification.Rewards.html#10563" class="Bound">ownerStake</a> <a id="10574" href="Ledger.Conway.Specification.Rewards.html#10574" class="Bound">stake</a> <a id="10580" class="Symbol">=</a> <a id="10582" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="10585" href="Ledger.Conway.Specification.Rewards.html#10550" class="Bound">rewards</a> <a id="10593" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="10595" href="Ledger.Conway.Specification.Rewards.html#10808" class="Function">cost</a>
  <a id="10602" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="10607" href="Ledger.Conway.Specification.Rewards.html#10550" class="Bound">rewards</a>
  <a id="10617" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="10622" href="Ledger.Conway.Specification.Rewards.html#10808" class="Function">cost</a> <a id="10627" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="10629" href="Prelude.html#3287" class="Function">posPart</a> <a id="10637" class="Symbol">(</a><a id="10638" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="10644" class="Symbol">(</a>
        <a id="10654" class="Symbol">(</a><a id="10655" href="Ledger.Conway.Specification.Rewards.html#1127" class="Function">fromℕ</a> <a id="10661" href="Ledger.Conway.Specification.Rewards.html#10550" class="Bound">rewards</a> <a id="10669" href="Data.Rational.Base.html#6484" class="Function Operator">-</a> <a id="10671" href="Ledger.Conway.Specification.Rewards.html#1127" class="Function">fromℕ</a> <a id="10677" href="Ledger.Conway.Specification.Rewards.html#10808" class="Function">cost</a><a id="10681" class="Symbol">)</a> <a id="10683" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="10685" class="Symbol">(</a><a id="10686" href="Ledger.Conway.Specification.Rewards.html#10853" class="Function">margin</a> <a id="10693" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="10695" class="Symbol">(</a><a id="10696" class="Number">1</a> <a id="10698" href="Data.Rational.Base.html#6484" class="Function Operator">-</a> <a id="10700" href="Ledger.Conway.Specification.Rewards.html#10853" class="Function">margin</a><a id="10706" class="Symbol">)</a> <a id="10708" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="10710" href="Ledger.Conway.Specification.Rewards.html#10736" class="Function">ratioStake</a><a id="10720" class="Symbol">)))</a>
  <a id="10726" class="Keyword">where</a>
    <a id="10736" href="Ledger.Conway.Specification.Rewards.html#10736" class="Function">ratioStake</a>  <a id="10748" class="Symbol">=</a> <a id="10750" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="10767" href="Ledger.Conway.Specification.Rewards.html#10563" class="Bound">ownerStake</a> <a id="10778" href="Ledger.Prelude.html#2023" class="Function Operator">÷₀</a> <a id="10781" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="10798" href="Ledger.Conway.Specification.Rewards.html#10574" class="Bound">stake</a>
    <a id="10808" href="Ledger.Conway.Specification.Rewards.html#10808" class="Function">cost</a>        <a id="10820" class="Symbol">=</a> <a id="10822" href="Ledger.Conway.Specification.Rewards.html#10558" class="Bound">pool</a> <a id="10827" class="Symbol">.</a><a id="10828" href="Ledger.Conway.Specification.Certs.html#1693" class="Field">StakePoolParams.cost</a>
    <a id="10853" href="Ledger.Conway.Specification.Rewards.html#10853" class="Function">margin</a>      <a id="10865" class="Symbol">=</a> <a id="10867" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="10884" class="Symbol">(</a><a id="10885" href="Ledger.Conway.Specification.Rewards.html#10558" class="Bound">pool</a> <a id="10890" class="Symbol">.</a><a id="10891" href="Ledger.Conway.Specification.Certs.html#1720" class="Field">StakePoolParams.margin</a><a id="10913" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="rewardMember"></a><a id="10928" href="Ledger.Conway.Specification.Rewards.html#10928" class="Function">rewardMember</a> <a id="10941" class="Symbol">:</a> <a id="10943" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="10948" class="Symbol">→</a> <a id="10950" href="Ledger.Conway.Specification.Certs.html#1620" class="Record">StakePoolParams</a> <a id="10966" class="Symbol">→</a> <a id="10968" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="10981" class="Symbol">→</a> <a id="10983" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="10996" class="Symbol">→</a> <a id="10998" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
<a id="11003" href="Ledger.Conway.Specification.Rewards.html#10928" class="Function">rewardMember</a> <a id="11016" href="Ledger.Conway.Specification.Rewards.html#11016" class="Bound">rewards</a> <a id="11024" href="Ledger.Conway.Specification.Rewards.html#11024" class="Bound">pool</a> <a id="11029" href="Ledger.Conway.Specification.Rewards.html#11029" class="Bound">memberStake</a> <a id="11041" href="Ledger.Conway.Specification.Rewards.html#11041" class="Bound">stake</a> <a id="11047" class="Symbol">=</a> <a id="11049" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="11052" href="Ledger.Conway.Specification.Rewards.html#11016" class="Bound">rewards</a> <a id="11060" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="11062" href="Ledger.Conway.Specification.Rewards.html#11255" class="Function">cost</a>
  <a id="11069" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="11074" class="Number">0</a>
  <a id="11078" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="11083" href="Prelude.html#3287" class="Function">posPart</a> <a id="11091" class="Symbol">(</a><a id="11092" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="11098" class="Symbol">(</a>
         <a id="11109" class="Symbol">(</a><a id="11110" href="Ledger.Conway.Specification.Rewards.html#1127" class="Function">fromℕ</a> <a id="11116" href="Ledger.Conway.Specification.Rewards.html#11016" class="Bound">rewards</a> <a id="11124" href="Data.Rational.Base.html#6484" class="Function Operator">-</a> <a id="11126" href="Ledger.Conway.Specification.Rewards.html#1127" class="Function">fromℕ</a> <a id="11132" href="Ledger.Conway.Specification.Rewards.html#11255" class="Function">cost</a><a id="11136" class="Symbol">)</a> <a id="11138" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="11140" class="Symbol">((</a><a id="11142" class="Number">1</a> <a id="11144" href="Data.Rational.Base.html#6484" class="Function Operator">-</a> <a id="11146" href="Ledger.Conway.Specification.Rewards.html#11300" class="Function">margin</a><a id="11152" class="Symbol">)</a> <a id="11154" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="11156" href="Ledger.Conway.Specification.Rewards.html#11182" class="Function">ratioStake</a><a id="11166" class="Symbol">)))</a>
  <a id="11172" class="Keyword">where</a>
    <a id="11182" href="Ledger.Conway.Specification.Rewards.html#11182" class="Function">ratioStake</a>  <a id="11194" class="Symbol">=</a> <a id="11196" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="11213" href="Ledger.Conway.Specification.Rewards.html#11029" class="Bound">memberStake</a> <a id="11225" href="Ledger.Prelude.html#2023" class="Function Operator">÷₀</a> <a id="11228" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="11245" href="Ledger.Conway.Specification.Rewards.html#11041" class="Bound">stake</a>
    <a id="11255" href="Ledger.Conway.Specification.Rewards.html#11255" class="Function">cost</a>        <a id="11267" class="Symbol">=</a> <a id="11269" href="Ledger.Conway.Specification.Rewards.html#11024" class="Bound">pool</a> <a id="11274" class="Symbol">.</a><a id="11275" href="Ledger.Conway.Specification.Certs.html#1693" class="Field">StakePoolParams.cost</a>
    <a id="11300" href="Ledger.Conway.Specification.Rewards.html#11300" class="Function">margin</a>      <a id="11312" class="Symbol">=</a> <a id="11314" href="Ledger.Prelude.Numeric.UnitInterval.html#1996" class="Function">fromUnitInterval</a> <a id="11331" class="Symbol">(</a><a id="11332" href="Ledger.Conway.Specification.Rewards.html#11024" class="Bound">pool</a> <a id="11337" class="Symbol">.</a><a id="11338" href="Ledger.Conway.Specification.Certs.html#1720" class="Field">StakePoolParams.margin</a><a id="11360" class="Symbol">)</a>
</pre>
<h3 id="sec:rewardOnePool">Function <code class="AgdaFunction">rewardOnePool</code> for Computing a Reward Update<a class="headerlink" href="#sec:rewardOnePool" title="Permanent link">&para;</a></h3>
<p>This subsection defines the function <code class="AgdaFunction">rewardOnePool</code> which
calculates the rewards given out to each member of a given pool.
Relevant quantities are:</p>
<ul>
<li>
<p><code class="AgdaArgument">rewardPot</code>: Total rewards to be paid out for this
  epoch.</p>
</li>
<li>
<p><code class="AgdaArgument">n</code>: Number of blocks produced by the pool in the last
  epoch.</p>
</li>
<li>
<p><code class="AgdaArgument">N</code>: Expectation value of the number of blocks to be
  produced by the pool.</p>
</li>
<li>
<p><code class="AgdaArgument">stakeDistr</code>: Distribution of stake, as mapping from
  <code class="AgdaInductiveConstructor">Credential</code> to <code class="AgdaFunction">Coin</code>.</p>
</li>
<li>
<p><code class="AgdaArgument">σ</code>: Total relative stake controlled by the pool.</p>
</li>
<li>
<p><code class="AgdaArgument">σa</code>: Total active relative stake controlled by the
  pool, used for selecting block producers.</p>
</li>
<li>
<p><code class="AgdaArgument">tot</code>: Total amount of Ada in circulation, for
  computing the relative stake.</p>
</li>
<li>
<p><code class="AgdaFunction">mkRelativeStake</code>: Compute stake relative to the total
  amount in circulation.</p>
</li>
<li>
<p><code class="AgdaFunction">ownerStake</code>: Total amount of stake controlled by the
  stake pool operator and owners.</p>
</li>
<li>
<p><code class="AgdaFunction">maxP</code>: Maximum rewards the pool can claim if the
  pledge is met, and zero otherwise.</p>
</li>
<li>
<p><code class="AgdaFunction">poolReward</code>: Actual rewards to be paid out to this
  pool.</p>
</li>
</ul>
<pre class="Agda"><a id="Stake"></a><a id="12696" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a> <a id="12702" class="Symbol">:</a> <a id="12704" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="12709" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a> <a id="12715" class="Symbol">=</a> <a id="12717" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a> <a id="12728" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12730" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>

<a id="rewardOnePool"></a><a id="12736" href="Ledger.Conway.Specification.Rewards.html#12736" class="Function">rewardOnePool</a> <a id="12750" class="Symbol">:</a>  <a id="12753" href="Ledger.Conway.Specification.PParams.html#3050" class="Record">PParams</a> <a id="12761" class="Symbol">→</a> <a id="12763" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="12768" class="Symbol">→</a> <a id="12770" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="12772" class="Symbol">→</a> <a id="12774" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="12776" class="Symbol">→</a> <a id="12778" href="Ledger.Conway.Specification.Certs.html#1620" class="Record">StakePoolParams</a>
                 <a id="12811" class="Symbol">→</a> <a id="12813" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a> <a id="12819" class="Symbol">→</a> <a id="12821" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="12834" class="Symbol">→</a> <a id="12836" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="12849" class="Symbol">→</a> <a id="12851" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="12856" class="Symbol">→</a> <a id="12858" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a>

<a id="12865" href="Ledger.Conway.Specification.Rewards.html#12736" class="Function">rewardOnePool</a> <a id="12879" href="Ledger.Conway.Specification.Rewards.html#12879" class="Bound">pp</a> <a id="12882" href="Ledger.Conway.Specification.Rewards.html#12882" class="Bound">rewardPot</a> <a id="12892" href="Ledger.Conway.Specification.Rewards.html#12892" class="Bound">n</a> <a id="12894" href="Ledger.Conway.Specification.Rewards.html#12894" class="Bound">N</a> <a id="12896" href="Ledger.Conway.Specification.Rewards.html#12896" class="Bound">pool</a> <a id="12901" href="Ledger.Conway.Specification.Rewards.html#12901" class="Bound">stakeDistr</a> <a id="12912" href="Ledger.Conway.Specification.Rewards.html#12912" class="Bound">σ</a> <a id="12914" href="Ledger.Conway.Specification.Rewards.html#12914" class="Bound">σa</a> <a id="12917" href="Ledger.Conway.Specification.Rewards.html#12917" class="Bound">tot</a> <a id="12921" class="Symbol">=</a> <a id="12923" href="Ledger.Conway.Specification.Rewards.html#13667" class="Function">memberRewards</a> <a id="12937" href="Axiom.Set.Map.Dec.html#2046" class="Function Operator">∪⁺</a> <a id="12940" href="Ledger.Conway.Specification.Rewards.html#13815" class="Function">ownersRewards</a>
  <a id="12956" class="Keyword">where</a>
  <a id="12964" href="Ledger.Conway.Specification.Rewards.html#12964" class="Function">mkRelativeStake</a> <a id="12980" class="Symbol">:</a> <a id="12982" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="12987" class="Symbol">→</a> <a id="12989" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a>
  <a id="13004" href="Ledger.Conway.Specification.Rewards.html#12964" class="Function">mkRelativeStake</a> <a id="13020" class="Symbol">=</a> <a id="13022" class="Symbol">λ</a> <a id="13024" href="Ledger.Conway.Specification.Rewards.html#13024" class="Bound">coin</a> <a id="13029" class="Symbol">→</a> <a id="13031" href="Ledger.Prelude.Numeric.UnitInterval.html#2772" class="Function">clamp</a> <a id="13037" class="Symbol">(</a><a id="13038" href="Ledger.Conway.Specification.Rewards.html#13024" class="Bound">coin</a> <a id="13043" href="Ledger.Prelude.html#1904" class="Function Operator">/₀</a> <a id="13046" href="Ledger.Conway.Specification.Rewards.html#12917" class="Bound">tot</a><a id="13049" class="Symbol">)</a>

  <a id="13054" href="Ledger.Conway.Specification.Rewards.html#13054" class="Function">owners</a> <a id="13061" class="Symbol">:</a> <a id="13063" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="13065" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a>
  <a id="13078" href="Ledger.Conway.Specification.Rewards.html#13054" class="Function">owners</a> <a id="13085" class="Symbol">=</a> <a id="13087" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="13092" href="Ledger.Core.Specification.Address.html#1448" class="InductiveConstructor">KeyHashObj</a> <a id="13103" class="Symbol">(</a><a id="13104" href="Ledger.Conway.Specification.Rewards.html#12896" class="Bound">pool</a> <a id="13109" class="Symbol">.</a><a id="13110" href="Ledger.Conway.Specification.Certs.html#1661" class="Field">StakePoolParams.owners</a><a id="13132" class="Symbol">)</a>

  <a id="13137" href="Ledger.Conway.Specification.Rewards.html#13137" class="Function">ownerStake</a> <a id="13148" href="Ledger.Conway.Specification.Rewards.html#13148" class="Function">pledge</a> <a id="13155" href="Ledger.Conway.Specification.Rewards.html#13155" class="Function">maxP</a> <a id="13160" href="Ledger.Conway.Specification.Rewards.html#13160" class="Function">poolReward</a> <a id="13171" class="Symbol">:</a> <a id="13173" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
  <a id="13180" href="Ledger.Conway.Specification.Rewards.html#13137" class="Function">ownerStake</a>  <a id="13192" class="Symbol">=</a> <a id="13194" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="13197" href="Ledger.Conway.Specification.Rewards.html#13197" class="Bound">c</a> <a id="13199" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="13201" href="Ledger.Conway.Specification.Rewards.html#12901" class="Bound">stakeDistr</a> <a id="13212" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="13214" href="Ledger.Conway.Specification.Rewards.html#13054" class="Function">owners</a> <a id="13221" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="13223" href="Ledger.Conway.Specification.Rewards.html#13197" class="Bound">c</a>
  <a id="13227" href="Ledger.Conway.Specification.Rewards.html#13148" class="Function">pledge</a>      <a id="13239" class="Symbol">=</a> <a id="13241" href="Ledger.Conway.Specification.Rewards.html#12896" class="Bound">pool</a> <a id="13246" class="Symbol">.</a><a id="13247" href="Ledger.Conway.Specification.Certs.html#1755" class="Field">StakePoolParams.pledge</a>
  <a id="13272" href="Ledger.Conway.Specification.Rewards.html#13155" class="Function">maxP</a>        <a id="13284" class="Symbol">=</a>  <a id="13287" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="13290" href="Ledger.Conway.Specification.Rewards.html#13148" class="Function">pledge</a> <a id="13297" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="13299" href="Ledger.Conway.Specification.Rewards.html#13137" class="Function">ownerStake</a>
                 <a id="13327" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="13332" href="Ledger.Conway.Specification.Rewards.html#7430" class="Function">maxPool</a> <a id="13340" href="Ledger.Conway.Specification.Rewards.html#12879" class="Bound">pp</a> <a id="13343" href="Ledger.Conway.Specification.Rewards.html#12882" class="Bound">rewardPot</a> <a id="13353" href="Ledger.Conway.Specification.Rewards.html#12912" class="Bound">σ</a> <a id="13355" class="Symbol">(</a><a id="13356" href="Ledger.Conway.Specification.Rewards.html#12964" class="Function">mkRelativeStake</a> <a id="13372" href="Ledger.Conway.Specification.Rewards.html#13148" class="Function">pledge</a><a id="13378" class="Symbol">)</a>
                 <a id="13397" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="13402" class="Number">0</a>
  <a id="13406" href="Ledger.Conway.Specification.Rewards.html#13160" class="Function">poolReward</a>  <a id="13418" class="Symbol">=</a> <a id="13420" href="Prelude.html#3287" class="Function">posPart</a> <a id="13428" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="13430" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="13436" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="13438" class="Symbol">(</a><a id="13439" href="Ledger.Conway.Specification.Rewards.html#8890" class="Function">mkApparentPerformance</a> <a id="13461" href="Ledger.Conway.Specification.Rewards.html#12914" class="Bound">σa</a> <a id="13464" href="Ledger.Conway.Specification.Rewards.html#12892" class="Bound">n</a> <a id="13466" href="Ledger.Conway.Specification.Rewards.html#12894" class="Bound">N</a><a id="13467" class="Symbol">)</a> <a id="13469" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="13471" href="Ledger.Conway.Specification.Rewards.html#1127" class="Function">fromℕ</a> <a id="13477" href="Ledger.Conway.Specification.Rewards.html#13155" class="Function">maxP</a>

  <a id="13485" href="Ledger.Conway.Specification.Rewards.html#13485" class="Function Operator">stakeMap[_]</a> <a id="13497" class="Symbol">:</a>  <a id="13500" class="Symbol">(</a><a id="13501" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="13506" class="Symbol">→</a> <a id="13508" href="Ledger.Conway.Specification.Certs.html#1620" class="Record">StakePoolParams</a> <a id="13524" class="Symbol">→</a> <a id="13526" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="13539" class="Symbol">→</a> <a id="13541" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="13554" class="Symbol">→</a> <a id="13556" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a><a id="13560" class="Symbol">)</a>
                 <a id="13579" class="Symbol">→</a> <a id="13581" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="13586" class="Symbol">→</a> <a id="13588" href="Ledger.Prelude.Numeric.UnitInterval.html#1784" class="Function">UnitInterval</a> <a id="13601" class="Symbol">→</a> <a id="13603" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
  <a id="13610" href="Ledger.Conway.Specification.Rewards.html#13485" class="Function Operator">stakeMap[</a> <a id="13620" href="Ledger.Conway.Specification.Rewards.html#13620" class="Bound">f</a> <a id="13622" href="Ledger.Conway.Specification.Rewards.html#13485" class="Function Operator">]</a> <a id="13624" class="Symbol">=</a> <a id="13626" class="Symbol">(</a><a id="13627" href="Ledger.Conway.Specification.Rewards.html#13620" class="Bound">f</a> <a id="13629" href="Ledger.Conway.Specification.Rewards.html#13160" class="Function">poolReward</a> <a id="13640" href="Ledger.Conway.Specification.Rewards.html#12896" class="Bound">pool</a><a id="13644" class="Symbol">)</a> <a id="13646" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="13648" href="Ledger.Conway.Specification.Rewards.html#12964" class="Function">mkRelativeStake</a>

  <a id="13667" href="Ledger.Conway.Specification.Rewards.html#13667" class="Function">memberRewards</a> <a id="13681" class="Symbol">:</a> <a id="13683" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a>
  <a id="13691" href="Ledger.Conway.Specification.Rewards.html#13667" class="Function">memberRewards</a> <a id="13705" class="Symbol">=</a> <a id="13707" href="Axiom.Set.Map.html#6068" class="Function">mapValues</a> <a id="13717" class="Symbol">(λ</a> <a id="13720" href="Ledger.Conway.Specification.Rewards.html#13720" class="Bound">coin</a> <a id="13725" class="Symbol">→</a> <a id="13727" href="Ledger.Conway.Specification.Rewards.html#13485" class="Function Operator">stakeMap[</a> <a id="13737" href="Ledger.Conway.Specification.Rewards.html#10928" class="Function">rewardMember</a> <a id="13750" href="Ledger.Conway.Specification.Rewards.html#13485" class="Function Operator">]</a> <a id="13752" href="Ledger.Conway.Specification.Rewards.html#13720" class="Bound">coin</a> <a id="13757" href="Ledger.Conway.Specification.Rewards.html#12912" class="Bound">σ</a><a id="13758" class="Symbol">)</a>
                            <a id="13788" class="Symbol">(</a><a id="13789" href="Ledger.Conway.Specification.Rewards.html#12901" class="Bound">stakeDistr</a> <a id="13800" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="13802" href="Ledger.Conway.Specification.Rewards.html#13054" class="Function">owners</a> <a id="13809" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a><a id="13810" class="Symbol">)</a>

  <a id="13815" href="Ledger.Conway.Specification.Rewards.html#13815" class="Function">ownersRewards</a> <a id="13829" class="Symbol">:</a> <a id="13831" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a>
  <a id="13839" href="Ledger.Conway.Specification.Rewards.html#13815" class="Function">ownersRewards</a> <a id="13853" class="Symbol">=</a>  <a id="13856" href="Axiom.Set.Map.html#4588" class="Function Operator">❴</a> <a id="13858" href="Ledger.Conway.Specification.Rewards.html#12896" class="Bound">pool</a> <a id="13863" class="Symbol">.</a><a id="13864" href="Ledger.Conway.Specification.Certs.html#1782" class="Field">StakePoolParams.rewardAccount</a>
                   <a id="13913" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13915" href="Ledger.Conway.Specification.Rewards.html#13485" class="Function Operator">stakeMap[</a> <a id="13925" href="Ledger.Conway.Specification.Rewards.html#10462" class="Function">rewardOwners</a> <a id="13938" href="Ledger.Conway.Specification.Rewards.html#13485" class="Function Operator">]</a> <a id="13940" href="Ledger.Conway.Specification.Rewards.html#13137" class="Function">ownerStake</a> <a id="13951" href="Ledger.Conway.Specification.Rewards.html#12912" class="Bound">σ</a> <a id="13953" href="Axiom.Set.Map.html#4588" class="Function Operator">❵ᵐ</a>
</pre>
<h3 id="filtering-the-stake-distribution-to-one-stake-pool">Filtering the Stake Distribution to One Stake Pool<a class="headerlink" href="#filtering-the-stake-distribution-to-one-stake-pool" title="Permanent link">&para;</a></h3>
<p>This section defines the <code class="AgdaFunction">poolStake</code> function which filters the stake distribution
to one stake pool. Relevant quantities are:</p>
<ul>
<li>
<p><code class="AgdaArgument">hk</code>: <code class="AgdaDatatype">KeyHash</code> of the stake pool to be
  filtered by.</p>
</li>
<li>
<p><code class="AgdaArgument">delegs</code>: Mapping from <code class="AgdaDatatype">Credential</code>s to
  stake pool that they delegate to.</p>
</li>
<li>
<p><code class="AgdaArgument">stake</code>: Distribution of stake for all
  <code class="AgdaDatatype">Credential</code>s.</p>
</li>
</ul>
<pre class="Agda"><a id="Delegations"></a><a id="14454" href="Ledger.Conway.Specification.Rewards.html#14454" class="Function">Delegations</a> <a id="14466" class="Symbol">:</a> <a id="14468" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="14473" href="Ledger.Conway.Specification.Rewards.html#14454" class="Function">Delegations</a> <a id="14485" class="Symbol">=</a> <a id="14487" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a> <a id="14498" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="14500" href="Ledger.Core.Specification.Crypto.html#2186" class="Function">KeyHash</a>

<a id="poolStake"></a><a id="14509" href="Ledger.Conway.Specification.Rewards.html#14509" class="Function">poolStake</a>  <a id="14520" class="Symbol">:</a> <a id="14522" href="Ledger.Core.Specification.Crypto.html#2186" class="Function">KeyHash</a> <a id="14530" class="Symbol">→</a> <a id="14532" href="Ledger.Conway.Specification.Rewards.html#14454" class="Function">Delegations</a> <a id="14544" class="Symbol">→</a> <a id="14546" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a> <a id="14552" class="Symbol">→</a> <a id="14554" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a>
<a id="14560" href="Ledger.Conway.Specification.Rewards.html#14509" class="Function">poolStake</a> <a id="14570" href="Ledger.Conway.Specification.Rewards.html#14570" class="Bound">hk</a> <a id="14573" href="Ledger.Conway.Specification.Rewards.html#14573" class="Bound">delegs</a> <a id="14580" href="Ledger.Conway.Specification.Rewards.html#14580" class="Bound">stake</a> <a id="14586" class="Symbol">=</a> <a id="14588" href="Ledger.Conway.Specification.Rewards.html#14580" class="Bound">stake</a> <a id="14594" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="14596" href="Class.IsSet.html#916" class="Function">dom</a> <a id="14600" class="Symbol">(</a><a id="14601" href="Ledger.Conway.Specification.Rewards.html#14573" class="Bound">delegs</a> <a id="14608" href="Axiom.Set.Map.html#14434" class="Function Operator">∣^</a> <a id="14611" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="14613" href="Ledger.Conway.Specification.Rewards.html#14570" class="Bound">hk</a> <a id="14616" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="14617" class="Symbol">)</a>
</pre>
<h3 id="sec:computing-a-reward-update">Computing a Reward Update<a class="headerlink" href="#sec:computing-a-reward-update" title="Permanent link">&para;</a></h3>
<p>This section defines the <code class="AgdaFunction">reward</code> function which applies
<code class="AgdaFunction">rewardOnePool</code> to each registered stake pool.
Relevant quantities are the following:</p>
<ul>
<li>
<p><code class="AgdaFunction">uncurryᵐ</code>: Helper function to rearrange a nested
  mapping.</p>
</li>
<li>
<p><code class="AgdaArgument">blocks</code>: Number of blocks produced by pools in the
  last epoch, as a mapping from pool <code class="AgdaDatatype">KeyHash</code> to number.</p>
</li>
<li>
<p><code class="AgdaArgument">poolParams</code>: Parameters of all known stake pools.</p>
</li>
<li>
<p><code class="AgdaArgument">stake</code>: Distribution of stake, as mapping from
  <code class="AgdaDatatype">Credential</code> to <code class="AgdaFunction">Coin</code>.</p>
</li>
<li>
<p><code class="AgdaArgument">delegs</code>: Mapping from <code class="AgdaDatatype">Credential</code>s to
  stake pool that they delegate to.</p>
</li>
<li>
<p><code class="AgdaArgument">total</code>: Total stake <span class="arithmatex">\(=\)</span> amount of Ada in circulation,
  for computing the relative stake.</p>
</li>
<li>
<p><code class="AgdaFunction">active</code>: Active stake <span class="arithmatex">\(=\)</span> amount of Ada that was used
  for selecting block producers.</p>
</li>
<li>
<p><code class="AgdaFunction">Σ_/total</code>: Sum of stake divided by total stake.</p>
</li>
<li>
<p><code class="AgdaFunction">Σ_/active</code>: Sum of stake divided by active stake.</p>
</li>
<li>
<p><code class="AgdaFunction">N</code>: Total number of blocks produced in the last epoch.</p>
</li>
<li>
<p><code class="AgdaFunction">pdata</code>: Data needed to compute rewards for each pool.</p>
</li>
</ul>
<pre class="Agda"><a id="BlocksMade"></a><a id="15890" href="Ledger.Conway.Specification.Rewards.html#15890" class="Function">BlocksMade</a> <a id="15901" class="Symbol">:</a> <a id="15903" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="15908" href="Ledger.Conway.Specification.Rewards.html#15890" class="Function">BlocksMade</a> <a id="15919" class="Symbol">=</a> <a id="15921" href="Ledger.Core.Specification.Crypto.html#2186" class="Function">KeyHash</a> <a id="15929" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="15931" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="uncurryᵐ"></a><a id="15934" href="Ledger.Conway.Specification.Rewards.html#15934" class="Function">uncurryᵐ</a> <a id="15943" class="Symbol">:</a>
</pre>
<pre class="Agda hidden-source">  <a id="15965" class="Symbol">∀</a> <a id="15967" class="Symbol">{</a><a id="15968" href="Ledger.Conway.Specification.Rewards.html#15968" class="Bound">A</a> <a id="15970" href="Ledger.Conway.Specification.Rewards.html#15970" class="Bound">B</a> <a id="15972" href="Ledger.Conway.Specification.Rewards.html#15972" class="Bound">C</a> <a id="15974" class="Symbol">:</a> <a id="15976" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="15980" class="Symbol">}</a> <a id="15982" class="Symbol">⦃</a> <a id="15984" href="Ledger.Conway.Specification.Rewards.html#15984" class="Bound">_</a> <a id="15986" class="Symbol">:</a> <a id="15988" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="15994" href="Ledger.Conway.Specification.Rewards.html#15968" class="Bound">A</a> <a id="15996" class="Symbol">⦄</a> <a id="15998" class="Symbol">⦃</a> <a id="16000" href="Ledger.Conway.Specification.Rewards.html#16000" class="Bound">_</a> <a id="16002" class="Symbol">:</a> <a id="16004" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="16010" href="Ledger.Conway.Specification.Rewards.html#15970" class="Bound">B</a> <a id="16012" class="Symbol">⦄</a> <a id="16014" class="Symbol">→</a>
</pre>

<pre class="Agda">  <a id="16035" href="Ledger.Conway.Specification.Rewards.html#15968" class="Bound">A</a> <a id="16037" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16039" class="Symbol">(</a><a id="16040" href="Ledger.Conway.Specification.Rewards.html#15970" class="Bound">B</a> <a id="16042" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16044" href="Ledger.Conway.Specification.Rewards.html#15972" class="Bound">C</a><a id="16045" class="Symbol">)</a> <a id="16047" class="Symbol">→</a> <a id="16049" class="Symbol">(</a><a id="16050" href="Ledger.Conway.Specification.Rewards.html#15968" class="Bound">A</a> <a id="16052" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="16054" href="Ledger.Conway.Specification.Rewards.html#15970" class="Bound">B</a><a id="16055" class="Symbol">)</a> <a id="16057" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16059" href="Ledger.Conway.Specification.Rewards.html#15972" class="Bound">C</a>
</pre>
<pre class="Agda hidden-source"><a id="16079" href="Ledger.Conway.Specification.Rewards.html#15934" class="Function">uncurryᵐ</a> <a id="16088" class="Symbol">{</a><a id="16089" href="Ledger.Conway.Specification.Rewards.html#16089" class="Bound">A</a><a id="16090" class="Symbol">}</a> <a id="16092" class="Symbol">{</a><a id="16093" href="Ledger.Conway.Specification.Rewards.html#16093" class="Bound">B</a><a id="16094" class="Symbol">}</a> <a id="16096" class="Symbol">{</a><a id="16097" href="Ledger.Conway.Specification.Rewards.html#16097" class="Bound">C</a><a id="16098" class="Symbol">}</a> <a id="16100" href="Ledger.Conway.Specification.Rewards.html#16100" class="Bound">abc</a> <a id="16104" class="Symbol">=</a> <a id="16106" href="Axiom.Set.Map.html#10460" class="Function">mapFromPartialFun</a> <a id="16124" href="Ledger.Conway.Specification.Rewards.html#16152" class="Function">lookup&#39;</a> <a id="16132" href="Ledger.Conway.Specification.Rewards.html#16310" class="Function">domain&#39;</a>
  <a id="16142" class="Keyword">where</a>
    <a id="16152" href="Ledger.Conway.Specification.Rewards.html#16152" class="Function">lookup&#39;</a> <a id="16160" class="Symbol">:</a> <a id="16162" class="Symbol">(</a><a id="16163" href="Ledger.Conway.Specification.Rewards.html#16089" class="Bound">A</a> <a id="16165" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="16167" href="Ledger.Conway.Specification.Rewards.html#16093" class="Bound">B</a><a id="16168" class="Symbol">)</a> <a id="16170" class="Symbol">→</a> <a id="16172" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="16178" href="Ledger.Conway.Specification.Rewards.html#16097" class="Bound">C</a>
    <a id="16184" href="Ledger.Conway.Specification.Rewards.html#16152" class="Function">lookup&#39;</a> <a id="16192" class="Symbol">(</a><a id="16193" href="Ledger.Conway.Specification.Rewards.html#16193" class="Bound">a</a> <a id="16195" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16197" href="Ledger.Conway.Specification.Rewards.html#16197" class="Bound">b</a><a id="16198" class="Symbol">)</a> <a id="16200" class="Symbol">=</a> <a id="16202" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="16211" href="Ledger.Conway.Specification.Rewards.html#16100" class="Bound">abc</a> <a id="16215" href="Ledger.Conway.Specification.Rewards.html#16193" class="Bound">a</a> <a id="16217" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="16221" class="Symbol">(λ</a> <a id="16224" href="Ledger.Conway.Specification.Rewards.html#16224" class="Bound">bc</a> <a id="16227" class="Symbol">→</a> <a id="16229" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="16238" href="Ledger.Conway.Specification.Rewards.html#16224" class="Bound">bc</a> <a id="16241" href="Ledger.Conway.Specification.Rewards.html#16197" class="Bound">b</a><a id="16242" class="Symbol">)</a>

    <a id="16249" href="Ledger.Conway.Specification.Rewards.html#16249" class="Function">joinˢ</a> <a id="16255" class="Symbol">:</a> <a id="16257" class="Symbol">∀</a> <a id="16259" class="Symbol">{</a><a id="16260" href="Ledger.Conway.Specification.Rewards.html#16260" class="Bound">X</a><a id="16261" class="Symbol">}</a> <a id="16263" class="Symbol">→</a> <a id="16265" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="16267" class="Symbol">(</a><a id="16268" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="16270" href="Ledger.Conway.Specification.Rewards.html#16260" class="Bound">X</a><a id="16271" class="Symbol">)</a> <a id="16273" class="Symbol">→</a> <a id="16275" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="16277" href="Ledger.Conway.Specification.Rewards.html#16260" class="Bound">X</a>
    <a id="16283" href="Ledger.Conway.Specification.Rewards.html#16249" class="Function">joinˢ</a> <a id="16289" class="Symbol">=</a> <a id="16291" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a> <a id="16302" href="Function.Base.html#704" class="Function">id</a>

    <a id="16310" href="Ledger.Conway.Specification.Rewards.html#16310" class="Function">domain&#39;</a> <a id="16318" class="Symbol">:</a> <a id="16320" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="16322" class="Symbol">(</a><a id="16323" href="Ledger.Conway.Specification.Rewards.html#16089" class="Bound">A</a> <a id="16325" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="16327" href="Ledger.Conway.Specification.Rewards.html#16093" class="Bound">B</a><a id="16328" class="Symbol">)</a>
    <a id="16334" href="Ledger.Conway.Specification.Rewards.html#16310" class="Function">domain&#39;</a> <a id="16342" class="Symbol">=</a> <a id="16344" href="Ledger.Conway.Specification.Rewards.html#16249" class="Function">joinˢ</a> <a id="16350" class="Symbol">(</a><a id="16351" href="Class.IsSet.html#959" class="Function">range</a> <a id="16357" class="Symbol">(</a><a id="16358" href="Axiom.Set.Map.html#8706" class="Function">mapWithKey</a> <a id="16369" class="Symbol">(λ</a> <a id="16372" href="Ledger.Conway.Specification.Rewards.html#16372" class="Bound">a</a> <a id="16374" href="Ledger.Conway.Specification.Rewards.html#16374" class="Bound">bc</a> <a id="16377" class="Symbol">→</a> <a id="16379" href="Class.IsSet.html#959" class="Function">range</a> <a id="16385" class="Symbol">(</a><a id="16386" href="Axiom.Set.Map.html#8706" class="Function">mapWithKey</a> <a id="16397" class="Symbol">(λ</a> <a id="16400" href="Ledger.Conway.Specification.Rewards.html#16400" class="Bound">b</a> <a id="16402" href="Ledger.Conway.Specification.Rewards.html#16402" class="Bound">_</a> <a id="16404" class="Symbol">→</a> <a id="16406" class="Symbol">(</a><a id="16407" href="Ledger.Conway.Specification.Rewards.html#16372" class="Bound">a</a> <a id="16409" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16411" href="Ledger.Conway.Specification.Rewards.html#16400" class="Bound">b</a><a id="16412" class="Symbol">))</a> <a id="16415" href="Ledger.Conway.Specification.Rewards.html#16374" class="Bound">bc</a><a id="16417" class="Symbol">))</a> <a id="16420" href="Ledger.Conway.Specification.Rewards.html#16100" class="Bound">abc</a><a id="16423" class="Symbol">))</a>
</pre>

<pre class="Agda"><a id="reward"></a><a id="16443" href="Ledger.Conway.Specification.Rewards.html#16443" class="Function">reward</a> <a id="16450" class="Symbol">:</a>  <a id="16453" href="Ledger.Conway.Specification.PParams.html#3050" class="Record">PParams</a> <a id="16461" class="Symbol">→</a> <a id="16463" href="Ledger.Conway.Specification.Rewards.html#15890" class="Function">BlocksMade</a> <a id="16474" class="Symbol">→</a> <a id="16476" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="16481" class="Symbol">→</a> <a id="16483" class="Symbol">(</a><a id="16484" href="Ledger.Core.Specification.Crypto.html#2186" class="Function">KeyHash</a> <a id="16492" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16494" href="Ledger.Conway.Specification.Certs.html#1620" class="Record">StakePoolParams</a><a id="16509" class="Symbol">)</a>
          <a id="16521" class="Symbol">→</a> <a id="16523" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a> <a id="16529" class="Symbol">→</a> <a id="16531" href="Ledger.Conway.Specification.Rewards.html#14454" class="Function">Delegations</a> <a id="16543" class="Symbol">→</a> <a id="16545" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a> <a id="16550" class="Symbol">→</a> <a id="16552" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a>
<a id="16558" href="Ledger.Conway.Specification.Rewards.html#16443" class="Function">reward</a> <a id="16565" href="Ledger.Conway.Specification.Rewards.html#16565" class="Bound">pp</a> <a id="16568" href="Ledger.Conway.Specification.Rewards.html#16568" class="Bound">blocks</a> <a id="16575" href="Ledger.Conway.Specification.Rewards.html#16575" class="Bound">rewardPot</a> <a id="16585" href="Ledger.Conway.Specification.Rewards.html#16585" class="Bound">poolParams</a> <a id="16596" href="Ledger.Conway.Specification.Rewards.html#16596" class="Bound">stake</a> <a id="16602" href="Ledger.Conway.Specification.Rewards.html#16602" class="Bound">delegs</a> <a id="16609" href="Ledger.Conway.Specification.Rewards.html#16609" class="Bound">total</a> <a id="16615" class="Symbol">=</a> <a id="16617" href="Ledger.Conway.Specification.Rewards.html#17239" class="Function">rewards</a>
  <a id="16627" class="Keyword">where</a>
    <a id="16637" href="Ledger.Conway.Specification.Rewards.html#16637" class="Function">active</a>      <a id="16649" class="Symbol">=</a> <a id="16651" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="16654" href="Ledger.Conway.Specification.Rewards.html#16654" class="Bound">c</a> <a id="16656" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="16658" href="Ledger.Conway.Specification.Rewards.html#16596" class="Bound">stake</a> <a id="16664" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="16666" href="Ledger.Conway.Specification.Rewards.html#16654" class="Bound">c</a>
    <a id="16672" href="Ledger.Conway.Specification.Rewards.html#16672" class="Function Operator">Σ_/total</a>    <a id="16684" class="Symbol">=</a> <a id="16686" class="Symbol">λ</a> <a id="16688" href="Ledger.Conway.Specification.Rewards.html#16688" class="Bound">st</a> <a id="16691" class="Symbol">→</a> <a id="16693" href="Ledger.Prelude.Numeric.UnitInterval.html#2772" class="Function">clamp</a> <a id="16699" class="Symbol">((</a><a id="16701" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="16704" href="Ledger.Conway.Specification.Rewards.html#16704" class="Bound">c</a> <a id="16706" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="16708" href="Ledger.Conway.Specification.Rewards.html#16688" class="Bound">st</a> <a id="16711" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="16713" href="Ledger.Conway.Specification.Rewards.html#16704" class="Bound">c</a><a id="16714" class="Symbol">)</a> <a id="16716" href="Ledger.Prelude.html#1904" class="Function Operator">/₀</a> <a id="16719" href="Ledger.Conway.Specification.Rewards.html#16609" class="Bound">total</a><a id="16724" class="Symbol">)</a>
    <a id="16730" href="Ledger.Conway.Specification.Rewards.html#16730" class="Function Operator">Σ_/active</a>   <a id="16742" class="Symbol">=</a> <a id="16744" class="Symbol">λ</a> <a id="16746" href="Ledger.Conway.Specification.Rewards.html#16746" class="Bound">st</a> <a id="16749" class="Symbol">→</a> <a id="16751" href="Ledger.Prelude.Numeric.UnitInterval.html#2772" class="Function">clamp</a> <a id="16757" class="Symbol">((</a><a id="16759" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="16762" href="Ledger.Conway.Specification.Rewards.html#16762" class="Bound">c</a> <a id="16764" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="16766" href="Ledger.Conway.Specification.Rewards.html#16746" class="Bound">st</a> <a id="16769" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="16771" href="Ledger.Conway.Specification.Rewards.html#16762" class="Bound">c</a><a id="16772" class="Symbol">)</a> <a id="16774" href="Ledger.Prelude.html#1904" class="Function Operator">/₀</a> <a id="16777" href="Ledger.Conway.Specification.Rewards.html#16637" class="Function">active</a><a id="16783" class="Symbol">)</a>
    <a id="16789" href="Ledger.Conway.Specification.Rewards.html#16789" class="Function">N</a>           <a id="16801" class="Symbol">=</a> <a id="16803" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="16806" href="Ledger.Conway.Specification.Rewards.html#16806" class="Bound">m</a> <a id="16808" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="16810" href="Ledger.Conway.Specification.Rewards.html#16568" class="Bound">blocks</a> <a id="16817" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="16819" href="Ledger.Conway.Specification.Rewards.html#16806" class="Bound">m</a>
    <a id="16825" href="Ledger.Conway.Specification.Rewards.html#16825" class="Function">mkPoolData</a>  <a id="16837" class="Symbol">=</a> <a id="16839" class="Symbol">λ</a> <a id="16841" href="Ledger.Conway.Specification.Rewards.html#16841" class="Bound">hk</a> <a id="16844" href="Ledger.Conway.Specification.Rewards.html#16844" class="Bound">p</a> <a id="16846" class="Symbol">→</a> <a id="16848" href="Class.Functor.Core.html#272" class="Function">map</a>  <a id="16853" class="Symbol">(λ</a> <a id="16856" href="Ledger.Conway.Specification.Rewards.html#16856" class="Bound">n</a> <a id="16858" class="Symbol">→</a> <a id="16860" class="Symbol">(</a><a id="16861" href="Ledger.Conway.Specification.Rewards.html#16856" class="Bound">n</a> <a id="16863" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16865" href="Ledger.Conway.Specification.Rewards.html#16844" class="Bound">p</a> <a id="16867" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16869" href="Ledger.Conway.Specification.Rewards.html#14509" class="Function">poolStake</a> <a id="16879" href="Ledger.Conway.Specification.Rewards.html#16841" class="Bound">hk</a> <a id="16882" href="Ledger.Conway.Specification.Rewards.html#16602" class="Bound">delegs</a> <a id="16889" href="Ledger.Conway.Specification.Rewards.html#16596" class="Bound">stake</a><a id="16894" class="Symbol">))</a>
                                <a id="16929" class="Symbol">(</a><a id="16930" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="16939" href="Ledger.Conway.Specification.Rewards.html#16568" class="Bound">blocks</a> <a id="16946" href="Ledger.Conway.Specification.Rewards.html#16841" class="Bound">hk</a><a id="16948" class="Symbol">)</a>
    <a id="16954" href="Ledger.Conway.Specification.Rewards.html#16954" class="Function">pdata</a>       <a id="16966" class="Symbol">=</a> <a id="16968" href="Axiom.Set.Map.html#10313" class="Function">mapMaybeWithKeyᵐ</a> <a id="16985" href="Ledger.Conway.Specification.Rewards.html#16825" class="Function">mkPoolData</a> <a id="16996" href="Ledger.Conway.Specification.Rewards.html#16585" class="Bound">poolParams</a>

    <a id="17012" href="Ledger.Conway.Specification.Rewards.html#17012" class="Function">f</a> <a id="17014" class="Symbol">:</a> <a id="17016" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="17018" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="17020" href="Ledger.Conway.Specification.Certs.html#1620" class="Record">StakePoolParams</a> <a id="17036" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="17038" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a> <a id="17044" class="Symbol">→</a> <a id="17046" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a>
    <a id="17056" href="Ledger.Conway.Specification.Rewards.html#17012" class="Function">f</a> <a id="17058" class="Symbol">=</a> <a id="17060" class="Symbol">(λ</a> <a id="17063" class="Symbol">(</a><a id="17064" href="Ledger.Conway.Specification.Rewards.html#17064" class="Bound">n</a> <a id="17066" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="17068" href="Ledger.Conway.Specification.Rewards.html#17068" class="Bound">p</a> <a id="17070" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="17072" href="Ledger.Conway.Specification.Rewards.html#17072" class="Bound">s</a><a id="17073" class="Symbol">)</a> <a id="17075" class="Symbol">→</a> <a id="17077" href="Ledger.Conway.Specification.Rewards.html#12736" class="Function">rewardOnePool</a> <a id="17091" href="Ledger.Conway.Specification.Rewards.html#16565" class="Bound">pp</a> <a id="17094" href="Ledger.Conway.Specification.Rewards.html#16575" class="Bound">rewardPot</a> <a id="17104" href="Ledger.Conway.Specification.Rewards.html#17064" class="Bound">n</a> <a id="17106" href="Ledger.Conway.Specification.Rewards.html#16789" class="Function">N</a> <a id="17108" href="Ledger.Conway.Specification.Rewards.html#17068" class="Bound">p</a> <a id="17110" href="Ledger.Conway.Specification.Rewards.html#17072" class="Bound">s</a> <a id="17112" class="Symbol">(</a><a id="17113" href="Ledger.Conway.Specification.Rewards.html#16672" class="Function Operator">Σ</a> <a id="17115" href="Ledger.Conway.Specification.Rewards.html#17072" class="Bound">s</a> <a id="17117" href="Ledger.Conway.Specification.Rewards.html#16672" class="Function Operator">/total</a><a id="17123" class="Symbol">)</a> <a id="17125" class="Symbol">(</a><a id="17126" href="Ledger.Conway.Specification.Rewards.html#16730" class="Function Operator">Σ</a> <a id="17128" href="Ledger.Conway.Specification.Rewards.html#17072" class="Bound">s</a> <a id="17130" href="Ledger.Conway.Specification.Rewards.html#16730" class="Function Operator">/active</a><a id="17137" class="Symbol">)</a> <a id="17139" href="Ledger.Conway.Specification.Rewards.html#16609" class="Bound">total</a><a id="17144" class="Symbol">)</a>

    <a id="17151" href="Ledger.Conway.Specification.Rewards.html#17151" class="Function">results</a> <a id="17159" class="Symbol">:</a> <a id="17161" class="Symbol">(</a><a id="17162" href="Ledger.Core.Specification.Crypto.html#2186" class="Function">KeyHash</a> <a id="17170" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="17172" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a><a id="17182" class="Symbol">)</a> <a id="17184" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="17186" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
    <a id="17195" href="Ledger.Conway.Specification.Rewards.html#17151" class="Function">results</a> <a id="17203" class="Symbol">=</a>  <a id="17206" href="Ledger.Conway.Specification.Rewards.html#15934" class="Function">uncurryᵐ</a> <a id="17215" class="Symbol">(</a><a id="17216" href="Axiom.Set.Map.html#6068" class="Function">mapValues</a> <a id="17226" href="Ledger.Conway.Specification.Rewards.html#17012" class="Function">f</a> <a id="17228" href="Ledger.Conway.Specification.Rewards.html#16954" class="Function">pdata</a><a id="17233" class="Symbol">)</a>
    <a id="17239" href="Ledger.Conway.Specification.Rewards.html#17239" class="Function">rewards</a>  <a id="17248" class="Symbol">=</a> <a id="17250" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a> <a id="17262" class="Symbol">(</a><a id="17263" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="17268" class="Symbol">(λ</a> <a id="17271" class="Symbol">(</a><a id="17272" href="Ledger.Conway.Specification.Rewards.html#17272" class="Bound">kh</a> <a id="17275" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="17277" href="Ledger.Conway.Specification.Rewards.html#17277" class="Bound">cred</a><a id="17281" class="Symbol">)</a> <a id="17283" class="Symbol">→</a> <a id="17285" class="Symbol">(</a><a id="17286" href="Ledger.Conway.Specification.Rewards.html#17272" class="Bound">kh</a> <a id="17289" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="17291" href="Ledger.Conway.Specification.Rewards.html#17277" class="Bound">cred</a><a id="17295" class="Symbol">)</a> <a id="17297" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="17299" href="Ledger.Conway.Specification.Rewards.html#17277" class="Bound">cred</a><a id="17303" class="Symbol">)</a> <a id="17305" class="Symbol">(</a><a id="17306" href="Class.IsSet.html#916" class="Function">dom</a> <a id="17310" href="Ledger.Conway.Specification.Rewards.html#17151" class="Function">results</a><a id="17317" class="Symbol">))</a> <a id="17320" href="Ledger.Conway.Specification.Rewards.html#17151" class="Function">results</a>
</pre>
<h3 id="sec:reward-update">Reward Update<a class="headerlink" href="#sec:reward-update" title="Permanent link">&para;</a></h3>
<p>This section defines the <code class="AgdaRecord">RewardUpdate</code> type, which records
the net flow of Ada due to paying out rewards after an epoch. The
update consists of four net flows.</p>
<ul>
<li>
<p><code class="AgdaField">Δt</code>: The change to the treasury. This will be a positive
  value.</p>
</li>
<li>
<p><code class="AgdaField">Δr</code>: The change to the reserves. We typically expect this
  to be a negative value.</p>
</li>
<li>
<p><code class="AgdaField">Δf</code>: The change to the fee pot. This will be a negative
  value.</p>
</li>
<li>
<p><code class="AgdaField">rs</code>: The map of new individual rewards, to be added to
  the existing rewards.</p>
</li>
</ul>
<p>We require these net flows to satisfy certain constraints that are also stored in the
<code class="AgdaRecord">RewardUpdate</code> data type.  Specifically, <code class="AgdaField">flowConservation</code> asserts
that all four net flows add up to zero.  We also state the directions of
<code class="AgdaField">Δt</code> and <code class="AgdaField">Δf</code>.</p>
<pre class="Agda"><a id="18206" class="Keyword">record</a> <a id="RewardUpdate"></a><a id="18213" href="Ledger.Conway.Specification.Rewards.html#18213" class="Record">RewardUpdate</a> <a id="18226" class="Symbol">:</a> <a id="18228" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="18232" class="Keyword">where</a>
  <a id="18240" class="Keyword">field</a>
    <a id="RewardUpdate.Δt"></a><a id="18250" href="Ledger.Conway.Specification.Rewards.html#18250" class="Field">Δt</a> <a id="RewardUpdate.Δr"></a><a id="18253" href="Ledger.Conway.Specification.Rewards.html#18253" class="Field">Δr</a> <a id="RewardUpdate.Δf"></a><a id="18256" href="Ledger.Conway.Specification.Rewards.html#18256" class="Field">Δf</a>          <a id="18268" class="Symbol">:</a> <a id="18270" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
    <a id="RewardUpdate.rs"></a><a id="18276" href="Ledger.Conway.Specification.Rewards.html#18276" class="Field">rs</a>                <a id="18294" class="Symbol">:</a> <a id="18296" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a>
    <a id="RewardUpdate.flowConservation"></a><a id="18306" href="Ledger.Conway.Specification.Rewards.html#18306" class="Field">flowConservation</a>  <a id="18324" class="Symbol">:</a> <a id="18326" href="Ledger.Conway.Specification.Rewards.html#18250" class="Field">Δt</a> <a id="18329" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18331" href="Ledger.Conway.Specification.Rewards.html#18253" class="Field">Δr</a> <a id="18334" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18336" href="Ledger.Conway.Specification.Rewards.html#18256" class="Field">Δf</a> <a id="18339" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18341" href="Ledger.Conway.Specification.Rewards.html#583" class="InductiveConstructor">pos</a> <a id="18345" class="Symbol">(</a><a id="18346" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="18349" href="Ledger.Conway.Specification.Rewards.html#18349" class="Bound">c</a> <a id="18351" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="18353" href="Ledger.Conway.Specification.Rewards.html#18276" class="Field">rs</a> <a id="18356" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="18358" href="Ledger.Conway.Specification.Rewards.html#18349" class="Bound">c</a><a id="18359" class="Symbol">)</a> <a id="18361" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="18363" class="Number">0</a>
    <a id="RewardUpdate.Δt-nonnegative"></a><a id="18369" href="Ledger.Conway.Specification.Rewards.html#18369" class="Field">Δt-nonnegative</a>    <a id="18387" class="Symbol">:</a> <a id="18389" class="Number">0</a> <a id="18391" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="18393" href="Ledger.Conway.Specification.Rewards.html#18250" class="Field">Δt</a>
    <a id="RewardUpdate.Δf-nonpositive"></a><a id="18400" href="Ledger.Conway.Specification.Rewards.html#18400" class="Field">Δf-nonpositive</a>    <a id="18418" class="Symbol">:</a> <a id="18420" href="Ledger.Conway.Specification.Rewards.html#18256" class="Field">Δf</a> <a id="18423" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="18425" class="Number">0</a>
</pre>
<p>The function <code class="AgdaFunction">createRUpd</code> calculates the <code class="AgdaRecord">RewardUpdate</code>,
but requires the definition of the type <code class="AgdaRecord">EpochState</code>, so we have to
defer the definition of this function to the
<a href="Ledger.Conway.Specification.Epoch.html#sec:epoch-boundary">Epoch Boundary</a> section.</p>
<h3 id="sec:diagram-rewards">Diagram: preservation of funds and rewards<a class="headerlink" href="#sec:diagram-rewards" title="Permanent link">&para;</a></h3>
<p>The flowchart in this section illustrates the potential flows of funds through the
entire system that can happen during one transition step as described in this document.</p>
<p><strong>Exception</strong>. Withdrawals from the “Treasury” are not shown in the diagram; they
can move funds into “Reward accounts.”</p>
<div class="admonition note">
<p class="admonition-title">Potential flows of funds during one transition step</p>
<p><a id="fig:rewards-flowchart"></a>
<figure class="svg-card">
  <img src="img/Rewards-Diagram.svg" alt="Rewards flowchart">
</figure></p>
<p>Value flows between accounting pots, but the total amount of value in the system
remains constant.  In particular, the red subgraph represents the inputs and outputs
to the <code class="AgdaFunction">rewardPot</code>, a temporary variable used during the reward update
calculation in the function <code class="AgdaFunction">createRUpd</code>.  Each red arrow corresponds
to one field of the <code class="AgdaRecord">RewardUpdate</code> data type.  The blue arrows represent
the flow of funds after they have passed through the <code class="AgdaFunction">rewardPot</code>.</p>
</div>
<h2 id="sec:stake-distribution-calculation">Stake Distribution Calculation<a class="headerlink" href="#sec:stake-distribution-calculation" title="Permanent link">&para;</a></h2>
<p>This section defines the calculation of the stake distribution for the
purpose of calculating rewards.</p>
<h3 id="definitions-of-the-snapshot-type">Definitions of the Snapshot type<a class="headerlink" href="#definitions-of-the-snapshot-type" title="Permanent link">&para;</a></h3>
<p>This subsection defines the <code class="AgdaField">Snapshot</code> type which represents a stake
distribution snapshot.  Such a snapshot contains the essential data needed to compute
rewards.</p>
<ul>
<li>
<p><code class="AgdaField">stake</code> A stake distribution, that is a mapping from
  credentials to coin.</p>
</li>
<li>
<p><code class="AgdaField">delegations</code>: A delegation map, that is a mapping from
  credentials to the stake pools that they delegate to.</p>
</li>
<li>
<p><code class="AgdaField">poolParameters</code>: A mapping that stores the pool
  parameters of each stake pool.</p>
</li>
</ul>
<pre class="Agda"><a id="20551" class="Keyword">record</a> <a id="Snapshot"></a><a id="20558" href="Ledger.Conway.Specification.Rewards.html#20558" class="Record">Snapshot</a> <a id="20567" class="Symbol">:</a> <a id="20569" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="20573" class="Keyword">where</a>
  <a id="20581" class="Keyword">field</a>
    <a id="Snapshot.stake"></a><a id="20591" href="Ledger.Conway.Specification.Rewards.html#20591" class="Field">stake</a>           <a id="20607" class="Symbol">:</a> <a id="20609" href="Ledger.Conway.Specification.Rewards.html#12696" class="Function">Stake</a>
    <a id="Snapshot.delegations"></a><a id="20619" href="Ledger.Conway.Specification.Rewards.html#20619" class="Field">delegations</a>     <a id="20635" class="Symbol">:</a> <a id="20637" href="Ledger.Conway.Specification.Rewards.html#14454" class="Function">Delegations</a>
    <a id="Snapshot.poolParameters"></a><a id="20653" href="Ledger.Conway.Specification.Rewards.html#20653" class="Field">poolParameters</a>  <a id="20669" class="Symbol">:</a> <a id="20671" href="Ledger.Core.Specification.Crypto.html#2186" class="Function">KeyHash</a> <a id="20679" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="20681" href="Ledger.Conway.Specification.Certs.html#1620" class="Record">StakePoolParams</a>
</pre>
<pre class="Agda hidden-source">
<a id="20716" class="Keyword">instance</a>
  <a id="20727" class="Keyword">unquoteDecl</a> <a id="HasCast-Snapshot"></a><a id="20739" href="Ledger.Conway.Specification.Rewards.html#20739" class="Function">HasCast-Snapshot</a> <a id="20756" class="Symbol">=</a>
    <a id="20762" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a> <a id="20777" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="20779" class="Symbol">(</a><a id="20780" class="Keyword">quote</a> <a id="20786" href="Ledger.Conway.Specification.Rewards.html#20558" class="Record">Snapshot</a> <a id="20795" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="20797" href="Ledger.Conway.Specification.Rewards.html#20739" class="Function">HasCast-Snapshot</a><a id="20813" class="Symbol">)</a> <a id="20815" href="Data.List.Base.html#4907" class="Function Operator">]</a>
</pre>

<h3 id="functions-for-computing-stake-distributions">Functions for Computing Stake Distributions<a class="headerlink" href="#functions-for-computing-stake-distributions" title="Permanent link">&para;</a></h3>
<p>This section defines the calculation of the stake distribution from the data
contained in a ledger state.  Here,</p>
<ul>
<li>
<p><code class="AgdaFunction">utxoBalance</code> computes the coin balance of all those
  UTxO with a given stake <code class="AgdaDatatype">Credential</code>.</p>
</li>
<li>
<p><code class="AgdaFunction">activeDelegs</code> represents the active stake
  <code class="AgdaDatatype">Credential</code>s, i.e. those that delegate to an existing
  pool and that have a registered reward account.</p>
</li>
<li>
<p><code class="AgdaFunction">activeRewards</code> is a mapping from active stake
  <code class="AgdaDatatype">Credential</code>s to the balance of their reward account.</p>
</li>
<li>
<p><code class="AgdaFunction">activeStake</code> stores the stake for each active
  <code class="AgdaDatatype">Credential</code>, i.e. the sum of coins from the UTxO set
  plus the reward account balance.</p>
</li>
</ul>
<pre class="Agda hidden-source"><a id="21618" class="Keyword">private</a>
  <a id="getStakeCred"></a><a id="21628" href="Ledger.Conway.Specification.Rewards.html#21628" class="Function">getStakeCred</a> <a id="21641" class="Symbol">:</a> <a id="21643" href="Ledger.Conway.Specification.Transaction.html#4476" class="Function">TxOut</a> <a id="21649" class="Symbol">→</a> <a id="21651" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="21657" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a>
  <a id="21670" href="Ledger.Conway.Specification.Rewards.html#21628" class="Function">getStakeCred</a> <a id="21683" class="Symbol">(</a><a id="21684" href="Ledger.Conway.Specification.Rewards.html#21684" class="Bound">a</a> <a id="21686" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="21688" class="Symbol">_</a> <a id="21690" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="21692" class="Symbol">_</a> <a id="21694" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="21696" class="Symbol">_)</a> <a id="21699" class="Symbol">=</a> <a id="21701" href="Ledger.Core.Specification.Address.html#3762" class="Function">stakeCred</a> <a id="21711" href="Ledger.Conway.Specification.Rewards.html#21684" class="Bound">a</a>

<a id="21714" class="Keyword">opaque</a>
</pre>

<pre class="Agda">  <a id="stakeDistr"></a><a id="21740" href="Ledger.Conway.Specification.Rewards.html#21740" class="Function">stakeDistr</a> <a id="21751" class="Symbol">:</a> <a id="21753" href="Ledger.Conway.Specification.Transaction.html#4544" class="Function">UTxO</a> <a id="21758" class="Symbol">→</a> <a id="21760" href="Ledger.Conway.Specification.Certs.html#3864" class="Record">DState</a> <a id="21767" class="Symbol">→</a> <a id="21769" href="Ledger.Conway.Specification.Certs.html#4544" class="Record">PState</a> <a id="21776" class="Symbol">→</a> <a id="21778" href="Ledger.Conway.Specification.Rewards.html#20558" class="Record">Snapshot</a>
  <a id="21789" href="Ledger.Conway.Specification.Rewards.html#21740" class="Function">stakeDistr</a> <a id="21800" href="Ledger.Conway.Specification.Rewards.html#21800" class="Bound">utxo</a> <a id="21805" href="Ledger.Conway.Specification.Rewards.html#21805" class="Bound">dState</a> <a id="21812" href="Ledger.Conway.Specification.Rewards.html#21812" class="Bound">pState</a> <a id="21819" class="Symbol">=</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Rewards.html#22075}{\htmlId{21829}{\htmlClass{Function}{\text{activeStake}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#3997}{\htmlId{21843}{\htmlClass{Function}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Rewards.html#21904}{\htmlId{21857}{\htmlClass{Function}{\text{poolParams}}}}\, \end{pmatrix}$</a>
    <a id="21874" class="Keyword">where</a>
</pre>
<pre class="Agda hidden-source">      <a id="21904" href="Ledger.Conway.Specification.Rewards.html#21904" class="Function">poolParams</a>    <a id="21918" class="Symbol">:</a> <a id="21920" href="Ledger.Core.Specification.Crypto.html#2186" class="Function">KeyHash</a> <a id="21928" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="21930" href="Ledger.Conway.Specification.Certs.html#1620" class="Record">StakePoolParams</a>
      <a id="21952" href="Ledger.Conway.Specification.Rewards.html#21952" class="Function">utxoBalance</a>   <a id="21966" class="Symbol">:</a> <a id="21968" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a> <a id="21979" class="Symbol">→</a> <a id="21981" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
      <a id="21992" href="Ledger.Conway.Specification.Rewards.html#21992" class="Function">activeDelegs</a>  <a id="22006" class="Symbol">:</a> <a id="22008" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a> <a id="22019" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="22021" href="Ledger.Core.Specification.Crypto.html#2186" class="Function">KeyHash</a>
      <a id="22035" href="Ledger.Conway.Specification.Rewards.html#22035" class="Function">activeRewards</a> <a id="22049" class="Symbol">:</a> <a id="22051" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a> <a id="22062" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="22064" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
      <a id="22075" href="Ledger.Conway.Specification.Rewards.html#22075" class="Function">activeStake</a>   <a id="22089" class="Symbol">:</a> <a id="22091" href="Ledger.Core.Specification.Address.html#1422" class="Datatype">Credential</a> <a id="22102" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="22104" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
</pre>

<pre class="Agda">      <a id="22132" href="Ledger.Conway.Specification.Rewards.html#21904" class="Function">poolParams</a>     <a id="22147" class="Symbol">=</a> <a id="22149" href="Ledger.Conway.Specification.Rewards.html#21812" class="Bound">pState</a> <a id="22156" class="Symbol">.</a><a id="22157" href="Ledger.Conway.Specification.Certs.html#4576" class="Field">PState.pools</a>
      <a id="22176" class="Keyword">open</a> <a id="22181" href="Ledger.Conway.Specification.Certs.html#3864" class="Module">DState</a> <a id="22188" href="Ledger.Conway.Specification.Rewards.html#21805" class="Bound">dState</a> <a id="22195" class="Keyword">using</a> <a id="22201" class="Symbol">(</a><a id="22202" href="Ledger.Conway.Specification.Certs.html#3997" class="Field">stakeDelegs</a><a id="22213" class="Symbol">;</a> <a id="22215" href="Ledger.Conway.Specification.Certs.html#4037" class="Field">rewards</a><a id="22222" class="Symbol">)</a>
      <a id="22230" href="Ledger.Conway.Specification.Rewards.html#21952" class="Function">utxoBalance</a>    <a id="22245" class="Symbol">=</a> <a id="22247" class="Symbol">λ</a> <a id="22249" href="Ledger.Conway.Specification.Rewards.html#22249" class="Bound">cred</a> <a id="22254" class="Symbol">→</a> <a id="22256" href="Ledger.Conway.Specification.Utxo.html#5012" class="Function">cbalance</a> <a id="22265" class="Symbol">(</a><a id="22266" href="Ledger.Conway.Specification.Rewards.html#21800" class="Bound">utxo</a> <a id="22271" href="abstract-set-theory.FiniteSetTheory.html#3088" class="Function Operator">∣^&#39;</a> <a id="22275" class="Symbol">λ</a> <a id="22277" href="Ledger.Conway.Specification.Rewards.html#22277" class="Bound">txout</a> <a id="22283" class="Symbol">→</a> <a id="22285" href="Ledger.Conway.Specification.Rewards.html#21628" class="Function">getStakeCred</a> <a id="22298" href="Ledger.Conway.Specification.Rewards.html#22277" class="Bound">txout</a> <a id="22304" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="22306" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="22311" href="Ledger.Conway.Specification.Rewards.html#22249" class="Bound">cred</a><a id="22315" class="Symbol">)</a>
      <a id="22323" href="Ledger.Conway.Specification.Rewards.html#21992" class="Function">activeDelegs</a>   <a id="22338" class="Symbol">=</a> <a id="22340" class="Symbol">(</a><a id="22341" href="Ledger.Conway.Specification.Certs.html#3997" class="Function">stakeDelegs</a> <a id="22353" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="22355" href="Class.IsSet.html#916" class="Function">dom</a> <a id="22359" href="Ledger.Conway.Specification.Certs.html#4037" class="Function">rewards</a><a id="22366" class="Symbol">)</a> <a id="22368" href="Axiom.Set.Map.html#14434" class="Function Operator">∣^</a> <a id="22371" href="Class.IsSet.html#916" class="Function">dom</a> <a id="22375" href="Ledger.Conway.Specification.Rewards.html#21904" class="Function">poolParams</a>
      <a id="22392" href="Ledger.Conway.Specification.Rewards.html#22035" class="Function">activeRewards</a>  <a id="22407" class="Symbol">=</a> <a id="22409" href="Ledger.Conway.Specification.Certs.html#4037" class="Function">rewards</a> <a id="22417" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="22419" href="Class.IsSet.html#916" class="Function">dom</a> <a id="22423" href="Ledger.Conway.Specification.Rewards.html#21992" class="Function">activeDelegs</a>
      <a id="22442" href="Ledger.Conway.Specification.Rewards.html#22075" class="Function">activeStake</a>    <a id="22457" class="Symbol">=</a>
        <a id="22467" href="Axiom.Set.Map.html#8706" class="Function">mapWithKey</a> <a id="22478" class="Symbol">(λ</a> <a id="22481" href="Ledger.Conway.Specification.Rewards.html#22481" class="Bound">c</a> <a id="22483" href="Ledger.Conway.Specification.Rewards.html#22483" class="Bound">rewardBalance</a> <a id="22497" class="Symbol">→</a> <a id="22499" href="Ledger.Conway.Specification.Rewards.html#21952" class="Function">utxoBalance</a> <a id="22511" href="Ledger.Conway.Specification.Rewards.html#22481" class="Bound">c</a> <a id="22513" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="22515" href="Ledger.Conway.Specification.Rewards.html#22483" class="Bound">rewardBalance</a><a id="22528" class="Symbol">)</a> <a id="22530" href="Ledger.Conway.Specification.Rewards.html#22035" class="Function">activeRewards</a>
</pre>
<h2 id="sec:rewards-time">Timing of Rewards Payout<a class="headerlink" href="#sec:rewards-time" title="Permanent link">&para;</a></h2>
<h3 id="sec:rewards-timeline">Rewards Calculation Timeline<a class="headerlink" href="#sec:rewards-timeline" title="Permanent link">&para;</a></h3>
<p>As described in the <a href="#sec:rewards-motivation">Rewards Motivation</a> section, the probability of
producing a block depends on the stake delegated to the block producer.  However, the
stake distribution changes over time, as funds are transferred between parties.  This
raises the question: What is the point in time from which we take the stake
distribution?  Right at the moment of producing a block?  Some time in the past?  How
do we deal with the fact that the blockchain is only <em>eventually consistent</em> (i.e.,
blocks can be rolled back before a stable consensus on the chain is formed)?</p>
<p>On Cardano, the answer to these questions is to group time into <em>epochs</em>.  An epoch
is long enough such that at the beginning of a new epoch, the beginning of the
previous epoch has become stable.  An epoch is also long enough for human users to
react to parameter changes, such as stake pool costs or performance.  But an epoch is
also short enough so that changes to the stake distribution will be reflected in block
production within a reasonable time frame.</p>
<p>The rewards for the blocks produced during a given epoch <span class="arithmatex">\(e_i\)</span> involve the two epochs
surrounding it.  In particular, the stake distribution will come from the previous
epoch and the rewards will be calculated in the following epoch.  At each epoch
boundary, one snapshot of the stake distribution is taken; changes to the stake
distribution within an epoch are not considered until the next snapshot is taken.
More concretely:</p>
<ol>
<li>
<p>A stake distribution snapshot is taken at the begining of epoch <span class="arithmatex">\(e_{i-1}\)</span>.</p>
</li>
<li>
<p>The randomness for leader election is fixed during epoch <span class="arithmatex">\(e_{i-1}\)</span></p>
</li>
<li>
<p>Epoch <span class="arithmatex">\(e_{i}\)</span> begins, blocks are produced using the snapshot taken at (A).</p>
</li>
<li>
<p>Epoch <span class="arithmatex">\(e_{i}\)</span> ends.  A snapshot is taken of the stake pool performance during
    epoch <span class="arithmatex">\(e_{i}\)</span>. A snapshot is also taken of the fee pot.</p>
</li>
<li>
<p>The snapshots from (D) are stable and the reward calculation can begin.</p>
</li>
<li>
<p>The reward calculation is finished and an update to the ledger state is ready to
    be applied.</p>
</li>
<li>
<p>Rewards are given out.</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Timeline of the rewards calculation</p>
<p>The snapshot taken at (A) is labeled “mark” during epoch <span class="arithmatex">\(e_{i-1}\)</span>, “set” during
epoch <span class="arithmatex">\(e_i\)</span> and “go” during epoch <span class="arithmatex">\(e_{i+1}\)</span>.  At (G) the snapshot taken at (A) is
no longer needed and will be discarded.</p>
<p><a id="fig:reward-timing"></a>
<figure class="svg-card">
  <img src="img/RewardsTiming-Diagram.svg" alt="Rewards timeline">
</figure></p>
<p><strong>N.B.</strong>  Between time D and E we are concerned with chain growth and stability.
Therefore this duration can be stated as 2k blocks (to state it in slots requires
details about the particular version of the Ouroboros protocol). The duration
between F and G is also 2k blocks.  Between E and F a single honest block is
enough to ensure a random nonce.</p>
</div>
<p>In order to specify this logic, we store the last three snapshots of the stake
distributions.  The mnemonic “mark, set, go” will be used to keep track of the
snapshots, where the label “mark” refers to the most recent snapshot, and “go” refers
to the snapshot that is ready to be used in the reward calculation.  Blocks will be
produced using the snapshot labeled “set”, whereas rewards are computed from the
snapshot labeled “go”.</p>
<h3 id="sec:illustration-reward-cycle">Example Illustration of the Reward Cycle<a class="headerlink" href="#sec:illustration-reward-cycle" title="Permanent link">&para;</a></h3>
<p>For better understanding, here an example of the logic described in the
previous section.</p>
<p>1.00,0.50,0.00 0.65,0.00,0.00 0.00,0.50,0.00 0.00,0.95,0.00
0.00,0.00,0.90 0.00,0.60,0.90</p>
<p>Bob registers his stake pool in epoch <span class="arithmatex">\(e_1\)</span>. Alice delegates to Bob’s
stake pool in epoch <span class="arithmatex">\(e_1\)</span>. Just before the end of epoch <span class="arithmatex">\(e_1\)</span>, Bob
submits a stake pool re-registration, changing his pool parameters. The
change in parameters is not immediate, as shown by the curved arrow
around the epoch boundary.</p>
<p>A snapshot is taken on the <span class="arithmatex">\(e_1\)</span>/<span class="arithmatex">\(e_2\)</span> boundary. It is labeled “mark”
initially. This snapshot includes Alice’s delegation to Bob’s pool, and
Bob’s pool parameters and listed in the initial pool registration
certificate.</p>
<p>If Alice changes her delegation choice any time during epoch <span class="arithmatex">\(e_2\)</span>, she
will never be effected by Bob’s change of parameters.</p>
<p>A new snapshot is taken on the <span class="arithmatex">\(e_2\)</span>/<span class="arithmatex">\(e_3\)</span> boundary. The previous
(darker blue) snapshot is now labeled “set”, and the new one labeled
“mark”. The “set” snapshot is used for leader election in epoch <span class="arithmatex">\(e_3\)</span>.</p>
<p>On the <span class="arithmatex">\(e_3\)</span>/<span class="arithmatex">\(e_4\)</span> boundary, the darker blue snapshot is labeled “go”
and the lighter blue snapshot is labeled “set”. Bob’s stake pool
performance during epoch <span class="arithmatex">\(e_3\)</span> (he produced 4 blocks) will be used with
the darker blue snapshot for the rewards which will be handed out at the
beginning of epoch <span class="arithmatex">\(e_5\)</span>.</p>
<h3 id="sec:stake-distribution-snapshots">Stake Distribution Snapshots<a class="headerlink" href="#sec:stake-distribution-snapshots" title="Permanent link">&para;</a></h3>
<p>This section defines the SNAP transition rule for stake distribution
snapshots, including the type <code class="AgdaField">Snapshots</code> that contains the data that
needs to be saved at the end of an epoch.  This relevant data are:</p>
<ul>
<li>
<p><code class="AgdaField">mark</code>, <code class="AgdaField">set</code>, <code class="AgdaField">go</code>: Three stake
  distribution snapshots as explained in
  the <a href="#sec:rewards-timeline">Rewards Timeline</a> section.</p>
</li>
<li>
<p><code class="AgdaField">feeSS</code>: stores the fees which are added to the reward pot
  during the next reward update calculation, which is then subtracted
  from the fee pot on the epoch boundary.</p>
</li>
</ul>
<pre class="Agda"><a id="28131" class="Keyword">record</a> <a id="Snapshots"></a><a id="28138" href="Ledger.Conway.Specification.Rewards.html#28138" class="Record">Snapshots</a> <a id="28148" class="Symbol">:</a> <a id="28150" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="28154" class="Keyword">where</a>
  <a id="28162" class="Keyword">field</a>
    <a id="Snapshots.mark"></a><a id="28172" href="Ledger.Conway.Specification.Rewards.html#28172" class="Field">mark</a> <a id="Snapshots.set"></a><a id="28177" href="Ledger.Conway.Specification.Rewards.html#28177" class="Field">set</a> <a id="Snapshots.go"></a><a id="28181" href="Ledger.Conway.Specification.Rewards.html#28181" class="Field">go</a>  <a id="28185" class="Symbol">:</a> <a id="28187" href="Ledger.Conway.Specification.Rewards.html#20558" class="Record">Snapshot</a>
    <a id="Snapshots.feeSS"></a><a id="28200" href="Ledger.Conway.Specification.Rewards.html#28200" class="Field">feeSS</a>        <a id="28213" class="Symbol">:</a> <a id="28215" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
</pre>
<pre class="Agda hidden-source"><a id="28238" class="Keyword">instance</a>
  <a id="28249" class="Keyword">unquoteDecl</a> <a id="HasCast-Snapshots"></a><a id="28261" href="Ledger.Conway.Specification.Rewards.html#28261" class="Function">HasCast-Snapshots</a> <a id="28279" class="Symbol">=</a>
    <a id="28285" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a> <a id="28300" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="28302" class="Symbol">(</a><a id="28303" class="Keyword">quote</a> <a id="28309" href="Ledger.Conway.Specification.Rewards.html#28138" class="Record">Snapshots</a> <a id="28319" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="28321" href="Ledger.Conway.Specification.Rewards.html#28261" class="Function">HasCast-Snapshots</a><a id="28338" class="Symbol">)</a> <a id="28340" href="Data.List.Base.html#4907" class="Function Operator">]</a>
</pre>

<p>The snapshot transition rule has no preconditions and results in the following state change:</p>
<ul>
<li>
<p>The oldest snapshot is replaced with the penultimate one.</p>
</li>
<li>
<p>The penultimate snapshot is replaced with the newest one.</p>
</li>
<li>
<p>The newest snapshot is replaced with one just calculated.</p>
</li>
<li>
<p>The current fees pot is stored in <code class="AgdaField">feeSS</code>.  Note that this value will
  not change during the epoch, unlike the <code class="AgdaField">fees</code> value in the UTxO state.</p>
</li>
</ul>
<pre class="Agda hidden-source"><a id="28812" class="Keyword">private</a> <a id="28820" class="Keyword">variable</a>
  <a id="28831" href="Ledger.Conway.Specification.Rewards.html#28831" class="Generalizable">lstate</a> <a id="28838" class="Symbol">:</a> <a id="28840" href="Ledger.Conway.Specification.Ledger.html#1765" class="Record">LState</a>
  <a id="28849" href="Ledger.Conway.Specification.Rewards.html#28849" class="Generalizable">mark</a> <a id="28854" href="Ledger.Conway.Specification.Rewards.html#28854" class="Generalizable">set</a> <a id="28858" href="Ledger.Conway.Specification.Rewards.html#28858" class="Generalizable">go</a> <a id="28861" class="Symbol">:</a> <a id="28863" href="Ledger.Conway.Specification.Rewards.html#20558" class="Record">Snapshot</a>
  <a id="28874" href="Ledger.Conway.Specification.Rewards.html#28874" class="Generalizable">feeSS</a> <a id="28880" class="Symbol">:</a> <a id="28882" href="Ledger.Prelude.Base.html#89" class="Function">Coin</a>
</pre>

<p><a id="sec:snap-transition-system"></a></p>
<pre class="Agda"><a id="28944" class="Keyword">data</a> <a id="_⊢_⇀⦇_,SNAP⦈_"></a><a id="28949" href="Ledger.Conway.Specification.Rewards.html#28949" class="Datatype Operator">_⊢_⇀⦇_,SNAP⦈_</a> <a id="28963" class="Symbol">:</a> <a id="28965" href="Ledger.Conway.Specification.Ledger.html#1765" class="Record">LState</a> <a id="28972" class="Symbol">→</a> <a id="28974" href="Ledger.Conway.Specification.Rewards.html#28138" class="Record">Snapshots</a> <a id="28984" class="Symbol">→</a> <a id="28986" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="28988" class="Symbol">→</a> <a id="28990" href="Ledger.Conway.Specification.Rewards.html#28138" class="Record">Snapshots</a> <a id="29000" class="Symbol">→</a> <a id="29002" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="29007" class="Keyword">where</a>
  <a id="_⊢_⇀⦇_,SNAP⦈_.SNAP"></a><a id="29015" href="Ledger.Conway.Specification.Rewards.html#29015" class="InductiveConstructor">SNAP</a> <a id="29020" class="Symbol">:</a> <a id="29022" class="Keyword">let</a> <a id="29026" class="Keyword">open</a> <a id="29031" href="Ledger.Conway.Specification.Ledger.html#1765" class="Module">LState</a> <a id="29038" href="Ledger.Conway.Specification.Rewards.html#28831" class="Generalizable">lstate</a><a id="29044" class="Symbol">;</a> <a id="29046" class="Keyword">open</a> <a id="29051" href="Ledger.Conway.Specification.Utxo.html#3273" class="Module">UTxOState</a> <a id="29061" href="Ledger.Conway.Specification.Ledger.html#1859" class="Function">utxoSt</a><a id="29067" class="Symbol">;</a> <a id="29069" class="Keyword">open</a> <a id="29074" href="Ledger.Conway.Specification.Certs.html#5200" class="Module">CertState</a> <a id="29084" href="Ledger.Conway.Specification.Ledger.html#1912" class="Function">certState</a>
             <a id="29107" href="Ledger.Conway.Specification.Rewards.html#29107" class="Bound">stake</a> <a id="29113" class="Symbol">=</a> <a id="29115" href="Ledger.Conway.Specification.Rewards.html#21740" class="Function">stakeDistr</a> <a id="29126" href="Ledger.Conway.Specification.Utxo.html#3368" class="Function">utxo</a> <a id="29131" href="Ledger.Conway.Specification.Certs.html#5298" class="Function">dState</a> <a id="29138" href="Ledger.Conway.Specification.Certs.html#5318" class="Function">pState</a>
    <a id="29149" class="Keyword">in</a>
    <a id="29156" href="Ledger.Conway.Specification.Rewards.html#28831" class="Generalizable">lstate</a> <a id="29163" href="Ledger.Conway.Specification.Rewards.html#28949" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Rewards.html#28849}{\htmlId{29167}{\htmlClass{Generalizable}{\text{mark}}}}\, \\ \,\href{Ledger.Conway.Specification.Rewards.html#28854}{\htmlId{29174}{\htmlClass{Generalizable}{\text{set}}}}\, \\ \,\href{Ledger.Conway.Specification.Rewards.html#28858}{\htmlId{29180}{\htmlClass{Generalizable}{\text{go}}}}\, \\ \,\href{Ledger.Conway.Specification.Rewards.html#28874}{\htmlId{29185}{\htmlClass{Generalizable}{\text{feeSS}}}}\, \end{pmatrix}$</a> <a id="29193" href="Ledger.Conway.Specification.Rewards.html#28949" class="Datatype Operator">⇀⦇</a> <a id="29196" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="29199" href="Ledger.Conway.Specification.Rewards.html#28949" class="Datatype Operator">,SNAP⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Rewards.html#29107}{\htmlId{29208}{\htmlClass{Bound}{\text{stake}}}}\, \\ \,\href{Ledger.Conway.Specification.Rewards.html#28849}{\htmlId{29216}{\htmlClass{Generalizable}{\text{mark}}}}\, \\ \,\href{Ledger.Conway.Specification.Rewards.html#28854}{\htmlId{29223}{\htmlClass{Generalizable}{\text{set}}}}\, \\ \,\href{Ledger.Conway.Specification.Utxo.html#3390}{\htmlId{29229}{\htmlClass{Function}{\text{fees}}}}\, \end{pmatrix}$</a>
</pre>
<h1 class="unnumbered" id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h1>
<p><strong>[Team18]</strong> <span id="shelley-delegation-design"
label="shelley-delegation-design"></span> IOHK Formal Methods Team.
<em>Design Specification for Delegation and Incentives in Cardano, IOHK
Deliverable SL-D1</em>. 2018.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="Ledger.Conway.Specification.Ratify.Properties.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Properties">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Properties
              </div>
            </div>
          </a>
        
        
          
          <a href="Ledger.Conway.Specification.Script.html" class="md-footer__link md-footer__link--next" aria-label="Next: Script">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Script
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["navigation.sections", "toc.integrate", "content.tooltips", "navigation.footer", "navigation.tabs", "content.code.copy"], "search": "assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
      
        <script src="js/katex-config.js"></script>
      
        <script src="AgdaKaTeX.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      
        <script src="js/custom.js"></script>
      
    
  </body>
</html>