<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>

<a id="127" class="Keyword">module</a> <a id="134" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="182" class="Symbol">(</a><a id="183" href="Ledger.Conway.Specification.Script.Validation.html#183" class="Bound">txs</a> <a id="187" class="Symbol">:</a> <a id="189" class="Symbol">_)</a> <a id="192" class="Symbol">(</a><a id="193" class="Keyword">open</a> <a id="198" href="Ledger.Conway.Specification.Transaction.html#1000" class="Module">TransactionStructure</a> <a id="219" href="Ledger.Conway.Specification.Script.Validation.html#183" class="Bound">txs</a><a id="222" class="Symbol">)</a>
  <a id="226" class="Symbol">(</a><a id="227" href="Ledger.Conway.Specification.Script.Validation.html#227" class="Bound">abs</a> <a id="231" class="Symbol">:</a> <a id="233" href="Ledger.Conway.Specification.Abstract.html#641" class="Record">AbstractFunctions</a> <a id="251" href="Ledger.Conway.Specification.Script.Validation.html#183" class="Bound">txs</a><a id="254" class="Symbol">)</a> <a id="256" class="Symbol">(</a><a id="257" class="Keyword">open</a> <a id="262" href="Ledger.Conway.Specification.Abstract.html#641" class="Module">AbstractFunctions</a> <a id="280" href="Ledger.Conway.Specification.Script.Validation.html#227" class="Bound">abs</a><a id="283" class="Symbol">)</a> <a id="285" class="Symbol">(</a><a id="286" class="Keyword">open</a> <a id="291" href="Ledger.Conway.Specification.Abstract.html#282" class="Module">indexOf</a> <a id="299" href="Ledger.Conway.Specification.Abstract.html#773" class="Field">indexOfImp</a><a id="309" class="Symbol">)</a>
  <a id="313" class="Keyword">where</a>

<a id="320" class="Keyword">open</a> <a id="325" class="Keyword">import</a> <a id="332" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="393" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>

<a id="407" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="412" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="426" class="Symbol">:</a> <a id="428" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="433" class="Keyword">where</a>
  <a id="ScriptPurpose.Cert"></a><a id="441" href="Ledger.Conway.Specification.Script.Validation.html#441" class="InductiveConstructor">Cert</a>     <a id="450" class="Symbol">:</a> <a id="452" href="Ledger.Conway.Specification.Certs.html#1346" class="Datatype">DCert</a>        <a id="465" class="Symbol">→</a> <a id="467" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Rwrd"></a><a id="483" href="Ledger.Conway.Specification.Script.Validation.html#483" class="InductiveConstructor">Rwrd</a>     <a id="492" class="Symbol">:</a> <a id="494" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>      <a id="507" class="Symbol">→</a> <a id="509" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Mint"></a><a id="525" href="Ledger.Conway.Specification.Script.Validation.html#525" class="InductiveConstructor">Mint</a>     <a id="534" class="Symbol">:</a> <a id="536" href="Ledger.Core.Specification.Crypto.html#1194" class="Function">ScriptHash</a>   <a id="549" class="Symbol">→</a> <a id="551" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Spend"></a><a id="567" href="Ledger.Conway.Specification.Script.Validation.html#567" class="InductiveConstructor">Spend</a>    <a id="576" class="Symbol">:</a> <a id="578" href="Ledger.Conway.Specification.Transaction.html#2607" class="Function">TxIn</a>         <a id="591" class="Symbol">→</a> <a id="593" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Vote"></a><a id="609" href="Ledger.Conway.Specification.Script.Validation.html#609" class="InductiveConstructor">Vote</a>     <a id="618" class="Symbol">:</a> <a id="620" href="Ledger.Conway.Specification.Gov.Actions.html#386" class="Function">Voter</a>        <a id="633" class="Symbol">→</a> <a id="635" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Propose"></a><a id="651" href="Ledger.Conway.Specification.Script.Validation.html#651" class="InductiveConstructor">Propose</a>  <a id="660" class="Symbol">:</a> <a id="662" href="Ledger.Conway.Specification.Gov.Actions.html#2518" class="Record">GovProposal</a>  <a id="675" class="Symbol">→</a> <a id="677" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>

<a id="rdptr"></a><a id="692" href="Ledger.Conway.Specification.Script.Validation.html#692" class="Function">rdptr</a> <a id="698" class="Symbol">:</a> <a id="700" href="Ledger.Conway.Specification.Transaction.html#2987" class="Record">TxBody</a> <a id="707" class="Symbol">→</a> <a id="709" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="723" class="Symbol">→</a> <a id="725" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="731" href="Ledger.Conway.Specification.Transaction.html#2752" class="Function">RdmrPtr</a>
<a id="739" href="Ledger.Conway.Specification.Script.Validation.html#692" class="Function">rdptr</a> <a id="745" href="Ledger.Conway.Specification.Script.Validation.html#745" class="Bound">txb</a> <a id="749" class="Symbol">=</a> <a id="751" class="Symbol">λ</a> <a id="753" class="Keyword">where</a>
  <a id="761" class="Symbol">(</a><a id="762" href="Ledger.Conway.Specification.Script.Validation.html#441" class="InductiveConstructor">Cert</a> <a id="767" href="Ledger.Conway.Specification.Script.Validation.html#767" class="Bound">h</a><a id="768" class="Symbol">)</a>     <a id="774" class="Symbol">→</a> <a id="776" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="780" class="Symbol">(</a><a id="781" href="Ledger.Conway.Specification.Transaction.html#892" class="InductiveConstructor">Cert</a>    <a id="789" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="791" class="Symbol">)</a> <a id="793" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="795" href="Ledger.Conway.Specification.Abstract.html#315" class="Function">indexOfDCert</a>    <a id="811" href="Ledger.Conway.Specification.Script.Validation.html#767" class="Bound">h</a> <a id="813" href="Ledger.Conway.Specification.Transaction.html#3221" class="Field">txcerts</a>
  <a id="823" class="Symbol">(</a><a id="824" href="Ledger.Conway.Specification.Script.Validation.html#483" class="InductiveConstructor">Rwrd</a> <a id="829" href="Ledger.Conway.Specification.Script.Validation.html#829" class="Bound">h</a><a id="830" class="Symbol">)</a>     <a id="836" class="Symbol">→</a> <a id="838" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="842" class="Symbol">(</a><a id="843" href="Ledger.Conway.Specification.Transaction.html#897" class="InductiveConstructor">Rewrd</a>   <a id="851" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="853" class="Symbol">)</a> <a id="855" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="857" href="Ledger.Conway.Specification.Abstract.html#367" class="Function">indexOfRwdAddr</a>  <a id="873" href="Ledger.Conway.Specification.Script.Validation.html#829" class="Bound">h</a> <a id="875" href="Ledger.Conway.Specification.Transaction.html#3255" class="Field">txwdrls</a>
  <a id="885" class="Symbol">(</a><a id="886" href="Ledger.Conway.Specification.Script.Validation.html#525" class="InductiveConstructor">Mint</a> <a id="891" href="Ledger.Conway.Specification.Script.Validation.html#891" class="Bound">h</a><a id="892" class="Symbol">)</a>     <a id="898" class="Symbol">→</a> <a id="900" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="904" class="Symbol">(</a><a id="905" href="Ledger.Conway.Specification.Transaction.html#887" class="InductiveConstructor">Mint</a>    <a id="913" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="915" class="Symbol">)</a> <a id="917" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="919" href="Ledger.Conway.Specification.Abstract.html#462" class="Function">indexOfPolicyId</a> <a id="935" href="Ledger.Conway.Specification.Script.Validation.html#891" class="Bound">h</a> <a id="937" class="Symbol">(</a><a id="938" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#928" class="Function">policies</a> <a id="947" href="Ledger.Conway.Specification.Transaction.html#3145" class="Field">mint</a><a id="951" class="Symbol">)</a>
  <a id="955" class="Symbol">(</a><a id="956" href="Ledger.Conway.Specification.Script.Validation.html#567" class="InductiveConstructor">Spend</a> <a id="962" href="Ledger.Conway.Specification.Script.Validation.html#962" class="Bound">h</a><a id="963" class="Symbol">)</a>    <a id="968" class="Symbol">→</a> <a id="970" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="974" class="Symbol">(</a><a id="975" href="Ledger.Conway.Specification.Transaction.html#881" class="InductiveConstructor">Spend</a>   <a id="983" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="985" class="Symbol">)</a> <a id="987" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="989" href="Ledger.Conway.Specification.Abstract.html#415" class="Function">indexOfTxIn</a>     <a id="1005" href="Ledger.Conway.Specification.Script.Validation.html#962" class="Bound">h</a> <a id="1007" href="Ledger.Conway.Specification.Transaction.html#3023" class="Field">txins</a>
  <a id="1015" class="Symbol">(</a><a id="1016" href="Ledger.Conway.Specification.Script.Validation.html#609" class="InductiveConstructor">Vote</a> <a id="1021" href="Ledger.Conway.Specification.Script.Validation.html#1021" class="Bound">h</a><a id="1022" class="Symbol">)</a>     <a id="1028" class="Symbol">→</a> <a id="1030" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1034" class="Symbol">(</a><a id="1035" href="Ledger.Conway.Specification.Transaction.html#903" class="InductiveConstructor">Vote</a>    <a id="1043" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1045" class="Symbol">)</a> <a id="1047" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1049" href="Ledger.Conway.Specification.Abstract.html#521" class="Function">indexOfVote</a>     <a id="1065" href="Ledger.Conway.Specification.Script.Validation.html#1021" class="Bound">h</a> <a id="1067" class="Symbol">(</a><a id="1068" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1072" href="Ledger.Conway.Specification.Gov.Actions.html#2436" class="Field">GovVote.voter</a> <a id="1086" href="Ledger.Conway.Specification.Transaction.html#3283" class="Field">txvote</a><a id="1092" class="Symbol">)</a>
  <a id="1096" class="Symbol">(</a><a id="1097" href="Ledger.Conway.Specification.Script.Validation.html#651" class="InductiveConstructor">Propose</a> <a id="1105" href="Ledger.Conway.Specification.Script.Validation.html#1105" class="Bound">h</a><a id="1106" class="Symbol">)</a>  <a id="1109" class="Symbol">→</a> <a id="1111" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1115" class="Symbol">(</a><a id="1116" href="Ledger.Conway.Specification.Transaction.html#908" class="InductiveConstructor">Propose</a> <a id="1124" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1126" class="Symbol">)</a> <a id="1128" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1130" href="Ledger.Conway.Specification.Abstract.html#573" class="Function">indexOfProposal</a> <a id="1146" href="Ledger.Conway.Specification.Script.Validation.html#1105" class="Bound">h</a> <a id="1148" href="Ledger.Conway.Specification.Transaction.html#3319" class="Field">txprop</a>
 <a id="1156" class="Keyword">where</a> <a id="1162" class="Keyword">open</a> <a id="1167" href="Ledger.Conway.Specification.Transaction.html#2987" class="Module">TxBody</a> <a id="1174" href="Ledger.Conway.Specification.Script.Validation.html#745" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1179" href="Ledger.Conway.Specification.Script.Validation.html#1179" class="Function">indexedRdmrs</a> <a id="1192" class="Symbol">:</a> <a id="1194" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a> <a id="1197" class="Symbol">→</a> <a id="1199" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="1213" class="Symbol">→</a> <a id="1215" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1221" class="Symbol">(</a><a id="1222" href="Ledger.Conway.Specification.Script.Base.html#1787" class="Function">Redeemer</a> <a id="1231" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1233" href="Ledger.Conway.Specification.Script.Base.html#1017" class="Function">ExUnits</a><a id="1240" class="Symbol">)</a>
<a id="1242" href="Ledger.Conway.Specification.Script.Validation.html#1179" class="Function">indexedRdmrs</a> <a id="1255" href="Ledger.Conway.Specification.Script.Validation.html#1255" class="Bound">tx</a> <a id="1258" href="Ledger.Conway.Specification.Script.Validation.html#1258" class="Bound">sp</a> <a id="1261" class="Symbol">=</a> <a id="1263" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1269" class="Symbol">(λ</a> <a id="1272" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="Bound">x</a> <a id="1274" class="Symbol">→</a> <a id="1276" href="Axiom.Set.Map.html#13670" class="Function">lookupᵐ?</a> <a id="1285" href="Ledger.Conway.Specification.Transaction.html#4375" class="Function">txrdmrs</a> <a id="1293" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="Bound">x</a><a id="1294" class="Symbol">)</a> <a id="1296" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1304" class="Symbol">(</a><a id="1305" href="Ledger.Conway.Specification.Script.Validation.html#692" class="Function">rdptr</a> <a id="1311" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a> <a id="1316" href="Ledger.Conway.Specification.Script.Validation.html#1258" class="Bound">sp</a><a id="1318" class="Symbol">)</a>
  <a id="1322" class="Keyword">where</a> <a id="1328" class="Keyword">open</a> <a id="1333" href="Ledger.Conway.Specification.Transaction.html#4500" class="Module">Tx</a> <a id="1336" href="Ledger.Conway.Specification.Script.Validation.html#1255" class="Bound">tx</a><a id="1338" class="Symbol">;</a> <a id="1340" class="Keyword">open</a> <a id="1345" href="Ledger.Conway.Specification.Transaction.html#4255" class="Module">TxWitnesses</a> <a id="1357" href="Ledger.Conway.Specification.Transaction.html#4556" class="Function">wits</a>

<a id="getDatum"></a><a id="1363" href="Ledger.Conway.Specification.Script.Validation.html#1363" class="Function">getDatum</a> <a id="1372" class="Symbol">:</a> <a id="1374" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a> <a id="1377" class="Symbol">→</a> <a id="1379" href="Ledger.Conway.Specification.Transaction.html#2698" class="Function">UTxO</a> <a id="1384" class="Symbol">→</a> <a id="1386" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="1400" class="Symbol">→</a> <a id="1402" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1408" href="Ledger.Conway.Specification.Script.Base.html#1769" class="Function">Datum</a>
<a id="1414" href="Ledger.Conway.Specification.Script.Validation.html#1363" class="Function">getDatum</a> <a id="1423" href="Ledger.Conway.Specification.Script.Validation.html#1423" class="Bound">tx</a> <a id="1426" href="Ledger.Conway.Specification.Script.Validation.html#1426" class="Bound">utxo</a> <a id="1431" class="Symbol">(</a><a id="1432" href="Ledger.Conway.Specification.Script.Validation.html#567" class="InductiveConstructor">Spend</a> <a id="1438" href="Ledger.Conway.Specification.Script.Validation.html#1438" class="Bound">txin</a><a id="1442" class="Symbol">)</a> <a id="1444" class="Symbol">=</a>
  <a id="1448" class="Keyword">do</a> <a id="1451" class="Symbol">(_</a> <a id="1454" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1456" class="Symbol">_</a> <a id="1458" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1460" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1465" href="Ledger.Conway.Specification.Script.Validation.html#1465" class="Bound">d</a> <a id="1467" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1469" class="Symbol">_)</a> <a id="1472" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1474" href="Axiom.Set.Map.html#13670" class="Function">lookupᵐ?</a> <a id="1483" href="Ledger.Conway.Specification.Script.Validation.html#1426" class="Bound">utxo</a> <a id="1488" href="Ledger.Conway.Specification.Script.Validation.html#1438" class="Bound">txin</a>
                          <a id="1519" class="Keyword">where</a>
                            <a id="1553" class="Symbol">(_</a> <a id="1556" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1558" class="Symbol">_</a> <a id="1560" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1562" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1570" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1572" class="Symbol">_)</a> <a id="1575" class="Symbol">→</a> <a id="1577" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1590" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="1595" href="Ledger.Conway.Specification.Script.Validation.html#1465" class="Bound">d</a> <a id="1597" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="1600" class="Symbol">λ</a> <a id="1602" class="Keyword">where</a>
       <a id="1615" class="Symbol">(</a><a id="1616" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1621" href="Ledger.Conway.Specification.Script.Validation.html#1621" class="Bound">d</a><a id="1622" class="Symbol">)</a> <a id="1624" class="Symbol">→</a> <a id="1626" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1631" href="Ledger.Conway.Specification.Script.Validation.html#1621" class="Bound">d</a>
       <a id="1640" class="Symbol">(</a><a id="1641" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1646" href="Ledger.Conway.Specification.Script.Validation.html#1646" class="Bound">h</a><a id="1647" class="Symbol">)</a> <a id="1649" class="Symbol">→</a> <a id="1651" href="Axiom.Set.Map.html#13670" class="Function">lookupᵐ?</a> <a id="1660" href="Ledger.Conway.Specification.Script.Validation.html#1682" class="Function">m</a> <a id="1662" href="Ledger.Conway.Specification.Script.Validation.html#1646" class="Bound">h</a>
     <a id="1669" class="Keyword">where</a>
       <a id="1682" href="Ledger.Conway.Specification.Script.Validation.html#1682" class="Function">m</a> <a id="1684" class="Symbol">=</a> <a id="1686" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="1695" class="Symbol">(</a><a id="1696" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1701" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1703" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="1708" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1710" href="Function.Base.html#704" class="Function">id</a> <a id="1713" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1715" class="Symbol">(</a><a id="1716" href="Ledger.Conway.Specification.Transaction.html#4350" class="Field">TxWitnesses.txdats</a> <a id="1735" class="Symbol">(</a><a id="1736" href="Ledger.Conway.Specification.Transaction.html#4556" class="Field">Tx.wits</a> <a id="1744" href="Ledger.Conway.Specification.Script.Validation.html#1423" class="Bound">tx</a><a id="1746" class="Symbol">)))</a>
<a id="1750" href="Ledger.Conway.Specification.Script.Validation.html#1363" class="CatchallClause Function">getDatum</a><a id="1758" class="CatchallClause"> </a><a id="1759" href="Ledger.Conway.Specification.Script.Validation.html#1759" class="CatchallClause Bound">tx</a><a id="1761" class="CatchallClause"> </a><a id="1762" href="Ledger.Conway.Specification.Script.Validation.html#1762" class="CatchallClause Bound">utxo</a><a id="1766" class="CatchallClause"> </a><a id="1767" class="CatchallClause Symbol">_</a> <a id="1769" class="Symbol">=</a> <a id="1771" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="1780" class="Keyword">record</a> <a id="TxInfo"></a><a id="1787" href="Ledger.Conway.Specification.Script.Validation.html#1787" class="Record">TxInfo</a> <a id="1794" class="Symbol">:</a> <a id="1796" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1801" class="Keyword">where</a>
  <a id="1809" class="Keyword">field</a> <a id="TxInfo.realizedInputs"></a><a id="1815" href="Ledger.Conway.Specification.Script.Validation.html#1815" class="Field">realizedInputs</a> <a id="1830" class="Symbol">:</a> <a id="1832" href="Ledger.Conway.Specification.Transaction.html#2698" class="Function">UTxO</a>
        <a id="TxInfo.txouts"></a><a id="1845" href="Ledger.Conway.Specification.Script.Validation.html#1845" class="Field">txouts</a>  <a id="1853" class="Symbol">:</a> <a id="1855" href="Ledger.Conway.Specification.Transaction.html#1049" class="Field">Ix</a> <a id="1858" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1860" href="Ledger.Conway.Specification.Transaction.html#2630" class="Function">TxOut</a>
        <a id="TxInfo.fee"></a><a id="1874" href="Ledger.Conway.Specification.Script.Validation.html#1874" class="Field">fee</a>     <a id="1882" class="Symbol">:</a> <a id="1884" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#518" class="Function">Value</a>
        <a id="TxInfo.mint"></a><a id="1898" href="Ledger.Conway.Specification.Script.Validation.html#1898" class="Field">mint</a>    <a id="1906" class="Symbol">:</a> <a id="1908" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#518" class="Function">Value</a>
        <a id="TxInfo.txcerts"></a><a id="1922" href="Ledger.Conway.Specification.Script.Validation.html#1922" class="Field">txcerts</a> <a id="1930" class="Symbol">:</a> <a id="1932" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1937" href="Ledger.Conway.Specification.Certs.html#1346" class="Datatype">DCert</a>
        <a id="TxInfo.txwdrls"></a><a id="1951" href="Ledger.Conway.Specification.Script.Validation.html#1951" class="Field">txwdrls</a> <a id="1959" class="Symbol">:</a> <a id="1961" href="Ledger.Conway.Specification.Transaction.html#2724" class="Function">Wdrl</a>
        <a id="TxInfo.txvldt"></a><a id="1974" href="Ledger.Conway.Specification.Script.Validation.html#1974" class="Field">txvldt</a>  <a id="1982" class="Symbol">:</a> <a id="1984" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1990" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a> <a id="1995" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1997" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2003" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a>
        <a id="TxInfo.vkKey"></a><a id="2016" href="Ledger.Conway.Specification.Script.Validation.html#2016" class="Field">vkKey</a>   <a id="2024" class="Symbol">:</a> <a id="2026" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2028" href="Ledger.Core.Specification.Crypto.html#1338" class="Function">KeyHash</a>
        <a id="TxInfo.txdats"></a><a id="2044" href="Ledger.Conway.Specification.Script.Validation.html#2044" class="Field">txdats</a>  <a id="2052" class="Symbol">:</a> <a id="2054" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2056" href="Ledger.Conway.Specification.Script.Base.html#1769" class="Function">Datum</a>
        <a id="TxInfo.txid"></a><a id="2070" href="Ledger.Conway.Specification.Script.Validation.html#2070" class="Field">txid</a>    <a id="2078" class="Symbol">:</a> <a id="2080" href="Ledger.Conway.Specification.Transaction.html#1052" class="Field">TxId</a>

<a id="txInfo"></a><a id="2086" href="Ledger.Conway.Specification.Script.Validation.html#2086" class="Function">txInfo</a> <a id="2093" class="Symbol">:</a> <a id="2095" href="Ledger.Conway.Specification.Script.Base.html#966" class="Function">Language</a> <a id="2104" class="Symbol">→</a> <a id="2106" href="Ledger.Conway.Specification.PParams.html#1728" class="Record">PParams</a>
                  <a id="2132" class="Symbol">→</a> <a id="2134" href="Ledger.Conway.Specification.Transaction.html#2698" class="Function">UTxO</a>
                  <a id="2157" class="Symbol">→</a> <a id="2159" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a>
                  <a id="2180" class="Symbol">→</a> <a id="2182" href="Ledger.Conway.Specification.Script.Validation.html#1787" class="Record">TxInfo</a>
<a id="2189" href="Ledger.Conway.Specification.Script.Validation.html#2086" class="Function">txInfo</a> <a id="2196" href="Ledger.Conway.Specification.Script.Validation.html#2196" class="Bound">l</a> <a id="2198" href="Ledger.Conway.Specification.Script.Validation.html#2198" class="Bound">pp</a> <a id="2201" href="Ledger.Conway.Specification.Script.Validation.html#2201" class="Bound">utxo</a> <a id="2206" href="Ledger.Conway.Specification.Script.Validation.html#2206" class="Bound">tx</a> <a id="2209" class="Symbol">=</a> <a id="2211" class="Keyword">record</a>
  <a id="2220" class="Symbol">{</a> <a id="2222" href="Ledger.Conway.Specification.Script.Validation.html#2222" class="Module">TxBody</a> <a id="2229" href="Ledger.Conway.Specification.Transaction.html#4532" class="Field">body</a>
  <a id="2236" class="Symbol">;</a> <a id="2238" href="Ledger.Conway.Specification.Script.Validation.html#2238" class="Module">TxWitnesses</a> <a id="2250" href="Ledger.Conway.Specification.Transaction.html#4556" class="Field">wits</a>
  <a id="2257" class="Symbol">;</a> <a id="2259" href="Ledger.Conway.Specification.Script.Validation.html#1815" class="Field">realizedInputs</a> <a id="2274" class="Symbol">=</a> <a id="2276" href="Ledger.Conway.Specification.Script.Validation.html#2201" class="Bound">utxo</a> <a id="2281" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2283" href="Ledger.Conway.Specification.Transaction.html#3023" class="Function">txins</a>
  <a id="2291" class="Symbol">;</a> <a id="2293" href="Ledger.Conway.Specification.Script.Validation.html#1874" class="Field">fee</a> <a id="2297" class="Symbol">=</a> <a id="2299" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2306" href="Ledger.Conway.Specification.Transaction.html#3117" class="Function">txfee</a>
  <a id="2314" class="Symbol">;</a> <a id="2316" href="Ledger.Conway.Specification.Script.Validation.html#1898" class="Field">mint</a> <a id="2321" class="Symbol">=</a> <a id="2323" href="Ledger.Conway.Specification.Transaction.html#3145" class="Function">mint</a>
  <a id="2330" class="Symbol">;</a> <a id="2332" href="Ledger.Conway.Specification.Script.Validation.html#2016" class="Field">vkKey</a> <a id="2338" class="Symbol">=</a> <a id="2340" href="Ledger.Conway.Specification.Transaction.html#3588" class="Function">reqSigHash</a>
  <a id="2353" class="Symbol">}</a> <a id="2355" class="Keyword">where</a> <a id="2361" class="Keyword">open</a> <a id="2366" href="Ledger.Conway.Specification.Transaction.html#4500" class="Module">Tx</a> <a id="2369" href="Ledger.Conway.Specification.Script.Validation.html#2206" class="Bound">tx</a><a id="2371" class="Symbol">;</a> <a id="2373" class="Keyword">open</a> <a id="2378" href="Ledger.Conway.Specification.Transaction.html#2987" class="Module">TxBody</a> <a id="2385" href="Ledger.Conway.Specification.Transaction.html#4532" class="Field">body</a>

<a id="credsNeeded"></a><a id="2391" href="Ledger.Conway.Specification.Script.Validation.html#2391" class="Function">credsNeeded</a> <a id="2403" class="Symbol">:</a> <a id="2405" href="Ledger.Conway.Specification.Transaction.html#2698" class="Function">UTxO</a> <a id="2410" class="Symbol">→</a> <a id="2412" href="Ledger.Conway.Specification.Transaction.html#2987" class="Record">TxBody</a> <a id="2419" class="Symbol">→</a> <a id="2421" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2423" class="Symbol">(</a><a id="2424" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="2438" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2440" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a><a id="2450" class="Symbol">)</a>
<a id="2452" href="Ledger.Conway.Specification.Script.Validation.html#2391" class="Function">credsNeeded</a> <a id="2464" href="Ledger.Conway.Specification.Script.Validation.html#2464" class="Bound">utxo</a> <a id="2469" href="Ledger.Conway.Specification.Script.Validation.html#2469" class="Bound">txb</a>
  <a id="2475" class="Symbol">=</a>  <a id="2478" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2483" class="Symbol">(λ</a> <a id="2486" class="Symbol">(</a><a id="2487" href="Ledger.Conway.Specification.Script.Validation.html#2487" class="Bound">i</a> <a id="2489" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2491" href="Ledger.Conway.Specification.Script.Validation.html#2491" class="Bound">o</a><a id="2492" class="Symbol">)</a>  <a id="2495" class="Symbol">→</a> <a id="2497" class="Symbol">(</a><a id="2498" href="Ledger.Conway.Specification.Script.Validation.html#567" class="InductiveConstructor">Spend</a>  <a id="2505" href="Ledger.Conway.Specification.Script.Validation.html#2487" class="Bound">i</a> <a id="2507" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2509" href="Ledger.Core.Specification.Address.html#2462" class="Function">payCred</a> <a id="2517" class="Symbol">(</a><a id="2518" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2524" href="Ledger.Conway.Specification.Script.Validation.html#2491" class="Bound">o</a><a id="2525" class="Symbol">)))</a> <a id="2529" class="Symbol">((</a><a id="2531" href="Ledger.Conway.Specification.Script.Validation.html#2464" class="Bound">utxo</a> <a id="2536" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2538" class="Symbol">(</a><a id="2539" href="Ledger.Conway.Specification.Transaction.html#3023" class="Field">txins</a> <a id="2545" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="2547" href="Ledger.Conway.Specification.Transaction.html#3558" class="Field">collateral</a><a id="2557" class="Symbol">))</a> <a id="2560" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2561" class="Symbol">)</a>
  <a id="2565" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2568" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2573" class="Symbol">(λ</a> <a id="2576" href="Ledger.Conway.Specification.Script.Validation.html#2576" class="Bound">a</a>        <a id="2585" class="Symbol">→</a> <a id="2587" class="Symbol">(</a><a id="2588" href="Ledger.Conway.Specification.Script.Validation.html#483" class="InductiveConstructor">Rwrd</a>   <a id="2595" href="Ledger.Conway.Specification.Script.Validation.html#2576" class="Bound">a</a> <a id="2597" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2599" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="2605" href="Ledger.Conway.Specification.Script.Validation.html#2576" class="Bound">a</a><a id="2606" class="Symbol">))</a> <a id="2609" class="Symbol">(</a><a id="2610" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2614" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2616" href="Ledger.Conway.Specification.Transaction.html#3255" class="Field">txwdrls</a> <a id="2624" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a><a id="2625" class="Symbol">)</a>
  <a id="2629" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2632" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="2643" class="Symbol">(λ</a> <a id="2646" href="Ledger.Conway.Specification.Script.Validation.html#2646" class="Bound">c</a>  <a id="2649" class="Symbol">→</a> <a id="2651" class="Symbol">(</a><a id="2652" href="Ledger.Conway.Specification.Script.Validation.html#441" class="InductiveConstructor">Cert</a>   <a id="2659" href="Ledger.Conway.Specification.Script.Validation.html#2646" class="Bound">c</a> <a id="2661" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2663" class="Symbol">)</a> <a id="2665" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2669" href="Ledger.Conway.Specification.Certs.html#2100" class="Function">cwitness</a> <a id="2678" href="Ledger.Conway.Specification.Script.Validation.html#2646" class="Bound">c</a><a id="2679" class="Symbol">)</a> <a id="2681" class="Symbol">(</a><a id="2682" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="2691" href="Ledger.Conway.Specification.Transaction.html#3221" class="Field">txcerts</a><a id="2698" class="Symbol">)</a>
  <a id="2702" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2705" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2710" class="Symbol">(λ</a> <a id="2713" href="Ledger.Conway.Specification.Script.Validation.html#2713" class="Bound">x</a>        <a id="2722" class="Symbol">→</a> <a id="2724" class="Symbol">(</a><a id="2725" href="Ledger.Conway.Specification.Script.Validation.html#525" class="InductiveConstructor">Mint</a>   <a id="2732" href="Ledger.Conway.Specification.Script.Validation.html#2713" class="Bound">x</a> <a id="2734" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2736" href="Ledger.Core.Specification.Address.html#322" class="InductiveConstructor">ScriptObj</a> <a id="2746" href="Ledger.Conway.Specification.Script.Validation.html#2713" class="Bound">x</a><a id="2747" class="Symbol">))</a> <a id="2750" class="Symbol">(</a><a id="2751" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#928" class="Function">policies</a> <a id="2760" href="Ledger.Conway.Specification.Transaction.html#3145" class="Field">mint</a><a id="2764" class="Symbol">)</a>
  <a id="2768" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2771" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2776" class="Symbol">(λ</a> <a id="2779" href="Ledger.Conway.Specification.Script.Validation.html#2779" class="Bound">v</a>        <a id="2788" class="Symbol">→</a> <a id="2790" class="Symbol">(</a><a id="2791" href="Ledger.Conway.Specification.Script.Validation.html#609" class="InductiveConstructor">Vote</a>   <a id="2798" href="Ledger.Conway.Specification.Script.Validation.html#2779" class="Bound">v</a> <a id="2800" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2802" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2808" href="Ledger.Conway.Specification.Script.Validation.html#2779" class="Bound">v</a><a id="2809" class="Symbol">))</a> <a id="2812" class="Symbol">(</a><a id="2813" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="2822" class="Symbol">(</a><a id="2823" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2827" href="Ledger.Conway.Specification.Gov.Actions.html#2436" class="Field">voter</a> <a id="2833" href="Ledger.Conway.Specification.Transaction.html#3283" class="Field">txvote</a><a id="2839" class="Symbol">))</a>
  <a id="2844" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2847" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="2858" class="Symbol">(λ</a> <a id="2861" href="Ledger.Conway.Specification.Script.Validation.html#2861" class="Bound">p</a> <a id="2863" class="Symbol">→</a> <a id="2865" href="Class.ToBool.html#389" class="Function Operator">if</a> <a id="2868" href="Ledger.Conway.Specification.Script.Validation.html#2861" class="Bound">p</a> <a id="2870" class="Symbol">.</a><a id="2871" href="Ledger.Conway.Specification.Gov.Actions.html#2627" class="Field">policy</a> <a id="2878" href="Class.ToBool.html#389" class="Function Operator">then</a> <a id="2883" class="Symbol">(λ</a> <a id="2886" class="Symbol">{</a><a id="2887" href="Ledger.Conway.Specification.Script.Validation.html#2887" class="Bound">sh</a><a id="2889" class="Symbol">}</a> <a id="2891" class="Symbol">→</a> <a id="2893" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2898" class="Symbol">(</a><a id="2899" href="Ledger.Conway.Specification.Script.Validation.html#651" class="InductiveConstructor">Propose</a>  <a id="2908" href="Ledger.Conway.Specification.Script.Validation.html#2861" class="Bound">p</a> <a id="2910" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2912" href="Ledger.Core.Specification.Address.html#322" class="InductiveConstructor">ScriptObj</a> <a id="2922" href="Ledger.Conway.Specification.Script.Validation.html#2887" class="Bound">sh</a><a id="2924" class="Symbol">))</a> <a id="2927" href="Class.ToBool.html#389" class="Function Operator">else</a> <a id="2932" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2939" class="Symbol">)</a>
                <a id="2957" class="Symbol">(</a><a id="2958" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="2967" href="Ledger.Conway.Specification.Transaction.html#3319" class="Field">txprop</a><a id="2973" class="Symbol">)</a>
  <a id="2977" class="Keyword">where</a>
    <a id="2987" class="Keyword">open</a> <a id="2992" href="Ledger.Conway.Specification.Transaction.html#2987" class="Module">TxBody</a> <a id="2999" href="Ledger.Conway.Specification.Script.Validation.html#2469" class="Bound">txb</a>
    <a id="3007" class="Keyword">open</a> <a id="3012" href="Ledger.Conway.Specification.Gov.Actions.html#2373" class="Module">GovVote</a>
    <a id="3024" class="Keyword">open</a> <a id="3029" href="Ledger.Core.Specification.Address.html#1324" class="Module">RwdAddr</a>
    <a id="3041" class="Keyword">open</a> <a id="3046" href="Ledger.Conway.Specification.Gov.Actions.html#2518" class="Module">GovProposal</a>

<a id="valContext"></a><a id="3059" href="Ledger.Conway.Specification.Script.Validation.html#3059" class="Function">valContext</a> <a id="3070" class="Symbol">:</a> <a id="3072" href="Ledger.Conway.Specification.Script.Validation.html#1787" class="Record">TxInfo</a> <a id="3079" class="Symbol">→</a> <a id="3081" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="3095" class="Symbol">→</a> <a id="3097" href="Ledger.Conway.Specification.Script.Base.html#1707" class="Function">Data</a>
<a id="3102" href="Ledger.Conway.Specification.Script.Validation.html#3059" class="Function">valContext</a> <a id="3113" href="Ledger.Conway.Specification.Script.Validation.html#3113" class="Bound">txinfo</a> <a id="3120" href="Ledger.Conway.Specification.Script.Validation.html#3120" class="Bound">sp</a> <a id="3123" class="Symbol">=</a> <a id="3125" href="Ledger.Conway.Specification.Script.Base.html#2006" class="Function">toData</a> <a id="3132" class="Symbol">(</a><a id="3133" href="Ledger.Conway.Specification.Script.Validation.html#3113" class="Bound">txinfo</a> <a id="3140" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3142" href="Ledger.Conway.Specification.Script.Validation.html#3120" class="Bound">sp</a><a id="3144" class="Symbol">)</a>

<a id="txOutToDataHash"></a><a id="3147" href="Ledger.Conway.Specification.Script.Validation.html#3147" class="Function">txOutToDataHash</a> <a id="3163" class="Symbol">:</a> <a id="3165" href="Ledger.Conway.Specification.Transaction.html#2630" class="Function">TxOut</a> <a id="3171" class="Symbol">→</a> <a id="3173" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3179" href="Ledger.Conway.Specification.Script.Base.html#1722" class="Function">DataHash</a>
<a id="3188" href="Ledger.Conway.Specification.Script.Validation.html#3147" class="Function">txOutToDataHash</a> <a id="3204" class="Symbol">(_</a> <a id="3207" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3209" class="Symbol">_</a> <a id="3211" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3213" href="Ledger.Conway.Specification.Script.Validation.html#3213" class="Bound">d</a> <a id="3215" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3217" class="Symbol">_)</a> <a id="3220" class="Symbol">=</a> <a id="3222" href="Ledger.Conway.Specification.Script.Validation.html#3213" class="Bound">d</a> <a id="3224" href="Class.Monad.Core.html#299" class="Field Operator">&gt;&gt;=</a> <a id="3228" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="3236" href="Ledger.Conway.Specification.Script.Validation.html#3236" class="Function">txOutToP2Script</a>
  <a id="3254" class="Symbol">:</a> <a id="3256" href="Ledger.Conway.Specification.Transaction.html#2698" class="Function">UTxO</a> <a id="3261" class="Symbol">→</a> <a id="3263" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a>
  <a id="3268" class="Symbol">→</a> <a id="3270" href="Ledger.Conway.Specification.Transaction.html#2630" class="Function">TxOut</a> <a id="3276" class="Symbol">→</a> <a id="3278" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3284" href="Ledger.Conway.Specification.Script.Base.html#2364" class="Function">P2Script</a>
<a id="3293" href="Ledger.Conway.Specification.Script.Validation.html#3236" class="Function">txOutToP2Script</a> <a id="3309" href="Ledger.Conway.Specification.Script.Validation.html#3309" class="Bound">utxo</a> <a id="3314" href="Ledger.Conway.Specification.Script.Validation.html#3314" class="Bound">tx</a> <a id="3317" class="Symbol">(</a><a id="3318" href="Ledger.Conway.Specification.Script.Validation.html#3318" class="Bound">a</a> <a id="3320" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3322" class="Symbol">_)</a> <a id="3325" class="Symbol">=</a>
  <a id="3329" class="Keyword">do</a> <a id="3332" href="Ledger.Conway.Specification.Script.Validation.html#3332" class="Bound">sh</a> <a id="3335" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="3337" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a> <a id="3349" class="Symbol">(</a><a id="3350" href="Ledger.Core.Specification.Address.html#2462" class="Function">payCred</a> <a id="3358" href="Ledger.Conway.Specification.Script.Validation.html#3318" class="Bound">a</a><a id="3359" class="Symbol">)</a>
     <a id="3366" href="Ledger.Conway.Specification.Script.Validation.html#3366" class="Bound">s</a>  <a id="3369" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="3371" href="Ledger.Conway.Specification.Transaction.html#6139" class="Function">lookupScriptHash</a> <a id="3388" href="Ledger.Conway.Specification.Script.Validation.html#3332" class="Bound">sh</a> <a id="3391" href="Ledger.Conway.Specification.Script.Validation.html#3314" class="Bound">tx</a> <a id="3394" href="Ledger.Conway.Specification.Script.Validation.html#3309" class="Bound">utxo</a>
     <a id="3404" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="3415" href="Ledger.Conway.Specification.Script.Validation.html#3366" class="Bound">s</a>

<a id="3418" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3427" href="Ledger.Conway.Specification.Script.Validation.html#3427" class="Function">collectP2ScriptsWithContext</a>
    <a id="3459" class="Symbol">:</a> <a id="3461" href="Ledger.Conway.Specification.PParams.html#1728" class="Record">PParams</a> <a id="3469" class="Symbol">→</a> <a id="3471" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a> <a id="3474" class="Symbol">→</a> <a id="3476" href="Ledger.Conway.Specification.Transaction.html#2698" class="Function">UTxO</a>
    <a id="3485" class="Symbol">→</a> <a id="3487" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3492" class="Symbol">(</a><a id="3493" href="Ledger.Conway.Specification.Script.Base.html#2364" class="Function">P2Script</a> <a id="3502" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3504" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3509" href="Ledger.Conway.Specification.Script.Base.html#1707" class="Function">Data</a> <a id="3514" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3516" href="Ledger.Conway.Specification.Script.Base.html#1017" class="Function">ExUnits</a> <a id="3524" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3526" href="Ledger.Conway.Specification.Script.Base.html#988" class="Function">CostModel</a><a id="3535" class="Symbol">)</a>
  <a id="3539" href="Ledger.Conway.Specification.Script.Validation.html#3427" class="Function">collectP2ScriptsWithContext</a> <a id="3567" href="Ledger.Conway.Specification.Script.Validation.html#3567" class="Bound">pp</a> <a id="3570" href="Ledger.Conway.Specification.Script.Validation.html#3570" class="Bound">tx</a> <a id="3573" href="Ledger.Conway.Specification.Script.Validation.html#3573" class="Bound">utxo</a>
    <a id="3582" class="Symbol">=</a> <a id="3584" href="abstract-set-theory.FiniteSetTheory.html#2463" class="Function">setToList</a>
    <a id="3598" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3600" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3611" class="Symbol">(λ</a> <a id="3614" class="Symbol">(</a><a id="3615" href="Ledger.Conway.Specification.Script.Validation.html#3615" class="Bound">sp</a> <a id="3618" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3620" href="Ledger.Conway.Specification.Script.Validation.html#3620" class="Bound">c</a><a id="3621" class="Symbol">)</a> <a id="3623" class="Symbol">→</a> <a id="3625" href="Class.ToBool.html#389" class="Function Operator">if</a> <a id="3628" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a> <a id="3640" href="Ledger.Conway.Specification.Script.Validation.html#3620" class="Bound">c</a>
                                <a id="3674" href="Class.ToBool.html#389" class="Function Operator">then</a> <a id="3679" class="Symbol">(λ</a> <a id="3682" class="Symbol">{</a><a id="3683" href="Ledger.Conway.Specification.Script.Validation.html#3683" class="Bound">sh</a><a id="3685" class="Symbol">}</a> <a id="3687" class="Symbol">→</a> <a id="3689" href="Ledger.Conway.Specification.Script.Validation.html#3809" class="Function">toScriptInput</a> <a id="3703" href="Ledger.Conway.Specification.Script.Validation.html#3615" class="Bound">sp</a> <a id="3706" href="Ledger.Conway.Specification.Script.Validation.html#3683" class="Bound">sh</a><a id="3708" class="Symbol">)</a>
                                <a id="3742" href="Class.ToBool.html#389" class="Function Operator">else</a> <a id="3747" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3754" class="Symbol">)</a>
    <a id="3760" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3762" href="Ledger.Conway.Specification.Script.Validation.html#2391" class="Function">credsNeeded</a> <a id="3774" href="Ledger.Conway.Specification.Script.Validation.html#3573" class="Bound">utxo</a> <a id="3779" class="Symbol">(</a><a id="3780" href="Ledger.Conway.Specification.Script.Validation.html#3570" class="Bound">tx</a> <a id="3783" class="Symbol">.</a><a id="3784" href="Ledger.Conway.Specification.Transaction.html#4532" class="Field">Tx.body</a><a id="3791" class="Symbol">)</a>
    <a id="3797" class="Keyword">where</a>
      <a id="3809" href="Ledger.Conway.Specification.Script.Validation.html#3809" class="Function">toScriptInput</a>
        <a id="3831" class="Symbol">:</a> <a id="3833" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="3847" class="Symbol">→</a> <a id="3849" href="Ledger.Core.Specification.Crypto.html#1194" class="Function">ScriptHash</a>
        <a id="3868" class="Symbol">→</a> <a id="3870" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3876" class="Symbol">(</a><a id="3877" href="Ledger.Conway.Specification.Script.Base.html#2364" class="Function">P2Script</a> <a id="3886" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3888" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3893" href="Ledger.Conway.Specification.Script.Base.html#1707" class="Function">Data</a> <a id="3898" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3900" href="Ledger.Conway.Specification.Script.Base.html#1017" class="Function">ExUnits</a> <a id="3908" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3910" href="Ledger.Conway.Specification.Script.Base.html#988" class="Function">CostModel</a><a id="3919" class="Symbol">)</a>
      <a id="3927" href="Ledger.Conway.Specification.Script.Validation.html#3809" class="Function">toScriptInput</a> <a id="3941" href="Ledger.Conway.Specification.Script.Validation.html#3941" class="Bound">sp</a> <a id="3944" href="Ledger.Conway.Specification.Script.Validation.html#3944" class="Bound">sh</a> <a id="3947" class="Symbol">=</a>
        <a id="3957" class="Keyword">do</a> <a id="3960" href="Ledger.Conway.Specification.Script.Validation.html#3960" class="Bound">s</a> <a id="3962" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="3964" href="Ledger.Conway.Specification.Transaction.html#6139" class="Function">lookupScriptHash</a> <a id="3981" href="Ledger.Conway.Specification.Script.Validation.html#3944" class="Bound">sh</a> <a id="3984" href="Ledger.Conway.Specification.Script.Validation.html#3570" class="Bound">tx</a> <a id="3987" href="Ledger.Conway.Specification.Script.Validation.html#3573" class="Bound">utxo</a>
           <a id="4003" href="Ledger.Conway.Specification.Script.Validation.html#4003" class="Bound">p2s</a> <a id="4007" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="4009" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="4020" href="Ledger.Conway.Specification.Script.Validation.html#3960" class="Bound">s</a>
           <a id="4033" class="Symbol">(</a><a id="4034" href="Ledger.Conway.Specification.Script.Validation.html#4034" class="Bound">rdmr</a> <a id="4039" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4041" href="Ledger.Conway.Specification.Script.Validation.html#4041" class="Bound">exunits</a><a id="4048" class="Symbol">)</a> <a id="4050" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="4052" href="Ledger.Conway.Specification.Script.Validation.html#1179" class="Function">indexedRdmrs</a> <a id="4065" href="Ledger.Conway.Specification.Script.Validation.html#3570" class="Bound">tx</a> <a id="4068" href="Ledger.Conway.Specification.Script.Validation.html#3941" class="Bound">sp</a>
           <a id="4082" class="Keyword">let</a> <a id="4086" href="Ledger.Conway.Specification.Script.Validation.html#4086" class="Bound">data&#39;</a>     <a id="4096" class="Symbol">=</a> <a id="4098" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="4104" href="Data.List.Base.html#5205" class="Function Operator">[_]</a> <a id="4108" class="InductiveConstructor">[]</a> <a id="4111" class="Symbol">(</a><a id="4112" href="Ledger.Conway.Specification.Script.Validation.html#1363" class="Function">getDatum</a> <a id="4121" href="Ledger.Conway.Specification.Script.Validation.html#3570" class="Bound">tx</a> <a id="4124" href="Ledger.Conway.Specification.Script.Validation.html#3573" class="Bound">utxo</a> <a id="4129" href="Ledger.Conway.Specification.Script.Validation.html#3941" class="Bound">sp</a><a id="4131" class="Symbol">)</a> <a id="4133" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="4136" href="Ledger.Conway.Specification.Script.Validation.html#4034" class="Bound">rdmr</a> <a id="4141" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4143" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="4145" href="Ledger.Conway.Specification.Script.Validation.html#3059" class="Function">valContext</a> <a id="4156" class="Symbol">(</a><a id="4157" href="Ledger.Conway.Specification.Script.Validation.html#2086" class="Function">txInfo</a> <a id="4164" class="Symbol">(</a><a id="4165" href="Ledger.Conway.Specification.Script.Base.html#1963" class="Function">language</a> <a id="4174" href="Ledger.Conway.Specification.Script.Validation.html#4003" class="Bound">p2s</a><a id="4177" class="Symbol">)</a> <a id="4179" href="Ledger.Conway.Specification.Script.Validation.html#3567" class="Bound">pp</a> <a id="4182" href="Ledger.Conway.Specification.Script.Validation.html#3573" class="Bound">utxo</a> <a id="4187" href="Ledger.Conway.Specification.Script.Validation.html#3570" class="Bound">tx</a><a id="4189" class="Symbol">)</a> <a id="4191" href="Ledger.Conway.Specification.Script.Validation.html#3941" class="Bound">sp</a> <a id="4194" href="Data.List.Base.html#5205" class="Function Operator">]</a>
               <a id="4211" href="Ledger.Conway.Specification.Script.Validation.html#4211" class="Bound">costModel</a> <a id="4221" class="Symbol">=</a> <a id="4223" href="Ledger.Conway.Specification.PParams.html#3107" class="Field">PParams.costmdls</a> <a id="4240" href="Ledger.Conway.Specification.Script.Validation.html#3567" class="Bound">pp</a>
           <a id="4254" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4259" class="Symbol">(</a><a id="4260" href="Ledger.Conway.Specification.Script.Validation.html#4003" class="Bound">p2s</a> <a id="4264" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4266" href="Ledger.Conway.Specification.Script.Validation.html#4086" class="Bound">data&#39;</a> <a id="4272" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4274" href="Ledger.Conway.Specification.Script.Validation.html#4041" class="Bound">exunits</a> <a id="4282" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4284" href="Ledger.Conway.Specification.Script.Validation.html#4211" class="Bound">costModel</a><a id="4293" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="4296" href="Ledger.Conway.Specification.Script.Validation.html#4296" class="Function">evalP2Scripts</a> <a id="4310" class="Symbol">:</a> <a id="4312" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4317" class="Symbol">(</a><a id="4318" href="Ledger.Conway.Specification.Script.Base.html#2364" class="Function">P2Script</a> <a id="4327" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4329" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4334" href="Ledger.Conway.Specification.Script.Base.html#1707" class="Function">Data</a> <a id="4339" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4341" href="Ledger.Conway.Specification.Script.Base.html#1017" class="Function">ExUnits</a> <a id="4349" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4351" href="Ledger.Conway.Specification.Script.Base.html#988" class="Function">CostModel</a><a id="4360" class="Symbol">)</a> <a id="4362" class="Symbol">→</a> <a id="4364" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4369" href="Ledger.Conway.Specification.Script.Validation.html#4296" class="Function">evalP2Scripts</a> <a id="4383" class="Symbol">=</a> <a id="4385" href="Data.List.Base.html#4910" class="Function">all</a> <a id="4389" class="Symbol">(λ</a> <a id="4392" class="Symbol">(</a><a id="4393" href="Ledger.Conway.Specification.Script.Validation.html#4393" class="Bound">s</a> <a id="4395" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4397" href="Ledger.Conway.Specification.Script.Validation.html#4397" class="Bound">d</a> <a id="4399" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4401" href="Ledger.Conway.Specification.Script.Validation.html#4401" class="Bound">eu</a> <a id="4404" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4406" href="Ledger.Conway.Specification.Script.Validation.html#4406" class="Bound">cm</a><a id="4408" class="Symbol">)</a> <a id="4410" class="Symbol">→</a> <a id="4412" href="Ledger.Conway.Specification.Abstract.html#804" class="Field">runPLCScript</a> <a id="4425" href="Ledger.Conway.Specification.Script.Validation.html#4406" class="Bound">cm</a> <a id="4428" href="Ledger.Conway.Specification.Script.Validation.html#4393" class="Bound">s</a> <a id="4430" href="Ledger.Conway.Specification.Script.Validation.html#4401" class="Bound">eu</a> <a id="4433" href="Ledger.Conway.Specification.Script.Validation.html#4397" class="Bound">d</a><a id="4434" class="Symbol">)</a>
</pre></body></html>