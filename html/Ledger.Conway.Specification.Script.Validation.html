<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>

<a id="128" class="Keyword">module</a> <a id="135" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="183" class="Symbol">(</a><a id="184" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a> <a id="188" class="Symbol">:</a> <a id="190" class="Symbol">_)</a> <a id="193" class="Symbol">(</a><a id="194" class="Keyword">open</a> <a id="199" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="220" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a><a id="223" class="Symbol">)</a>
  <a id="227" class="Symbol">(</a><a id="228" href="Ledger.Conway.Specification.Script.Validation.html#228" class="Bound">abs</a> <a id="232" class="Symbol">:</a> <a id="234" href="Ledger.Conway.Specification.Abstract.html#720" class="Record">AbstractFunctions</a> <a id="252" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a><a id="255" class="Symbol">)</a> <a id="257" class="Symbol">(</a><a id="258" class="Keyword">open</a> <a id="263" href="Ledger.Conway.Specification.Abstract.html#720" class="Module">AbstractFunctions</a> <a id="281" href="Ledger.Conway.Specification.Script.Validation.html#228" class="Bound">abs</a><a id="284" class="Symbol">)</a> <a id="286" class="Symbol">(</a><a id="287" class="Keyword">open</a> <a id="292" href="Ledger.Conway.Specification.Abstract.html#348" class="Module">indexOf</a> <a id="300" href="Ledger.Conway.Specification.Abstract.html#852" class="Field">indexOfImp</a><a id="310" class="Symbol">)</a>
  <a id="314" class="Keyword">where</a>

<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="394" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>


<a id="409" class="Keyword">open</a> <a id="414" class="Keyword">import</a> <a id="421" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a> <a id="458" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a>
<a id="462" class="Keyword">open</a> <a id="467" class="Keyword">import</a> <a id="474" href="Ledger.Conway.Specification.Script.ScriptPurpose.html" class="Module">Ledger.Conway.Specification.Script.ScriptPurpose</a> <a id="523" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a>

<a id="rdptr"></a><a id="528" href="Ledger.Conway.Specification.Script.Validation.html#528" class="Function">rdptr</a> <a id="534" class="Symbol">:</a> <a id="536" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a> <a id="543" class="Symbol">→</a> <a id="545" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="559" class="Symbol">→</a> <a id="561" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="567" href="Ledger.Conway.Specification.Transaction.html#2752" class="Function">RdmrPtr</a>
<a id="575" href="Ledger.Conway.Specification.Script.Validation.html#528" class="Function">rdptr</a> <a id="581" href="Ledger.Conway.Specification.Script.Validation.html#581" class="Bound">txb</a> <a id="585" class="Symbol">=</a> <a id="587" class="Symbol">λ</a> <a id="589" class="Keyword">where</a>
  <a id="597" class="Symbol">(</a><a id="598" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#323" class="InductiveConstructor">Cert</a> <a id="603" href="Ledger.Conway.Specification.Script.Validation.html#603" class="Bound">h</a><a id="604" class="Symbol">)</a>     <a id="610" class="Symbol">→</a> <a id="612" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="616" class="Symbol">(</a><a id="617" href="Ledger.Conway.Specification.Transaction.html#892" class="InductiveConstructor">Cert</a>    <a id="625" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="627" class="Symbol">)</a> <a id="629" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="631" href="Ledger.Conway.Specification.Abstract.html#381" class="Function">indexOfDCert</a>    <a id="647" href="Ledger.Conway.Specification.Script.Validation.html#603" class="Bound">h</a> <a id="649" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a>
  <a id="659" class="Symbol">(</a><a id="660" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#365" class="InductiveConstructor">Rwrd</a> <a id="665" href="Ledger.Conway.Specification.Script.Validation.html#665" class="Bound">h</a><a id="666" class="Symbol">)</a>     <a id="672" class="Symbol">→</a> <a id="674" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="678" class="Symbol">(</a><a id="679" href="Ledger.Conway.Specification.Transaction.html#897" class="InductiveConstructor">Rewrd</a>   <a id="687" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="689" class="Symbol">)</a> <a id="691" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="693" href="Ledger.Conway.Specification.Abstract.html#433" class="Function">indexOfRwdAddr</a>  <a id="709" href="Ledger.Conway.Specification.Script.Validation.html#665" class="Bound">h</a> <a id="711" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a>
  <a id="727" class="Symbol">(</a><a id="728" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#407" class="InductiveConstructor">Mint</a> <a id="733" href="Ledger.Conway.Specification.Script.Validation.html#733" class="Bound">h</a><a id="734" class="Symbol">)</a>     <a id="740" class="Symbol">→</a> <a id="742" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="746" class="Symbol">(</a><a id="747" href="Ledger.Conway.Specification.Transaction.html#887" class="InductiveConstructor">Mint</a>    <a id="755" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="757" class="Symbol">)</a> <a id="759" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="761" href="Ledger.Conway.Specification.Abstract.html#535" class="Function">indexOfPolicyId</a> <a id="777" href="Ledger.Conway.Specification.Script.Validation.html#733" class="Bound">h</a> <a id="779" class="Symbol">(</a><a id="780" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#927" class="Function">policies</a> <a id="789" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a><a id="793" class="Symbol">)</a>
  <a id="797" class="Symbol">(</a><a id="798" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#449" class="InductiveConstructor">Spend</a> <a id="804" href="Ledger.Conway.Specification.Script.Validation.html#804" class="Bound">h</a><a id="805" class="Symbol">)</a>    <a id="810" class="Symbol">→</a> <a id="812" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="816" class="Symbol">(</a><a id="817" href="Ledger.Conway.Specification.Transaction.html#881" class="InductiveConstructor">Spend</a>   <a id="825" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="827" class="Symbol">)</a> <a id="829" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="831" href="Ledger.Conway.Specification.Abstract.html#488" class="Function">indexOfTxIn</a>     <a id="847" href="Ledger.Conway.Specification.Script.Validation.html#804" class="Bound">h</a> <a id="849" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a>
  <a id="857" class="Symbol">(</a><a id="858" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#491" class="InductiveConstructor">Vote</a> <a id="863" href="Ledger.Conway.Specification.Script.Validation.html#863" class="Bound">h</a><a id="864" class="Symbol">)</a>     <a id="870" class="Symbol">→</a> <a id="872" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="876" class="Symbol">(</a><a id="877" href="Ledger.Conway.Specification.Transaction.html#903" class="InductiveConstructor">Vote</a>    <a id="885" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="887" class="Symbol">)</a> <a id="889" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="891" href="Ledger.Conway.Specification.Abstract.html#594" class="Function">indexOfVote</a>     <a id="907" href="Ledger.Conway.Specification.Script.Validation.html#863" class="Bound">h</a> <a id="909" class="Symbol">(</a><a id="910" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="914" href="Ledger.Conway.Specification.Gov.Actions.html#2357" class="Field">GovVote.voter</a> <a id="928" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a><a id="938" class="Symbol">)</a>
  <a id="942" class="Symbol">(</a><a id="943" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#533" class="InductiveConstructor">Propose</a> <a id="951" href="Ledger.Conway.Specification.Script.Validation.html#951" class="Bound">h</a><a id="952" class="Symbol">)</a>  <a id="955" class="Symbol">→</a> <a id="957" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="961" class="Symbol">(</a><a id="962" href="Ledger.Conway.Specification.Transaction.html#908" class="InductiveConstructor">Propose</a> <a id="970" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="972" class="Symbol">)</a> <a id="974" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="976" href="Ledger.Conway.Specification.Abstract.html#652" class="Function">indexOfProposal</a> <a id="992" href="Ledger.Conway.Specification.Script.Validation.html#951" class="Bound">h</a> <a id="994" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a>
 <a id="1010" class="Keyword">where</a> <a id="1016" class="Keyword">open</a> <a id="1021" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="1028" href="Ledger.Conway.Specification.Script.Validation.html#581" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1033" href="Ledger.Conway.Specification.Script.Validation.html#1033" class="Function">indexedRdmrs</a> <a id="1046" class="Symbol">:</a> <a id="1048" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1051" class="Symbol">→</a> <a id="1053" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="1067" class="Symbol">→</a> <a id="1069" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1075" class="Symbol">(</a><a id="1076" href="Ledger.Conway.Specification.Script.Base.html#1788" class="Function">Redeemer</a> <a id="1085" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1087" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a><a id="1094" class="Symbol">)</a>
<a id="1096" href="Ledger.Conway.Specification.Script.Validation.html#1033" class="Function">indexedRdmrs</a> <a id="1109" href="Ledger.Conway.Specification.Script.Validation.html#1109" class="Bound">tx</a> <a id="1112" href="Ledger.Conway.Specification.Script.Validation.html#1112" class="Bound">sp</a> <a id="1115" class="Symbol">=</a> <a id="1117" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1123" class="Symbol">(λ</a> <a id="1126" href="Ledger.Conway.Specification.Script.Validation.html#1126" class="Bound">x</a> <a id="1128" class="Symbol">→</a> <a id="1130" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1139" href="Ledger.Conway.Specification.Transaction.html#4557" class="Function">txrdmrs</a> <a id="1147" href="Ledger.Conway.Specification.Script.Validation.html#1126" class="Bound">x</a><a id="1148" class="Symbol">)</a> <a id="1150" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1158" class="Symbol">(</a><a id="1159" href="Ledger.Conway.Specification.Script.Validation.html#528" class="Function">rdptr</a> <a id="1165" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a> <a id="1170" href="Ledger.Conway.Specification.Script.Validation.html#1112" class="Bound">sp</a><a id="1172" class="Symbol">)</a>
  <a id="1176" class="Keyword">where</a> <a id="1182" class="Keyword">open</a> <a id="1187" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="1190" href="Ledger.Conway.Specification.Script.Validation.html#1109" class="Bound">tx</a><a id="1192" class="Symbol">;</a> <a id="1194" class="Keyword">open</a> <a id="1199" href="Ledger.Conway.Specification.Transaction.html#4437" class="Module">TxWitnesses</a> <a id="1211" href="Ledger.Conway.Specification.Transaction.html#4738" class="Function">wits</a>

<a id="getDatum"></a><a id="1217" href="Ledger.Conway.Specification.Script.Validation.html#1217" class="Function">getDatum</a> <a id="1226" class="Symbol">:</a> <a id="1228" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1231" class="Symbol">→</a> <a id="1233" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="1238" class="Symbol">→</a> <a id="1240" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="1254" class="Symbol">→</a> <a id="1256" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1262" href="Ledger.Conway.Specification.Script.Base.html#1770" class="Function">Datum</a>
<a id="1268" href="Ledger.Conway.Specification.Script.Validation.html#1217" class="Function">getDatum</a> <a id="1277" href="Ledger.Conway.Specification.Script.Validation.html#1277" class="Bound">tx</a> <a id="1280" href="Ledger.Conway.Specification.Script.Validation.html#1280" class="Bound">utxo</a> <a id="1285" class="Symbol">(</a><a id="1286" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#449" class="InductiveConstructor">Spend</a> <a id="1292" href="Ledger.Conway.Specification.Script.Validation.html#1292" class="Bound">txin</a><a id="1296" class="Symbol">)</a> <a id="1298" class="Symbol">=</a>
  <a id="1302" class="Keyword">do</a> <a id="1305" class="Symbol">(_</a> <a id="1308" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1310" class="Symbol">_</a> <a id="1312" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1314" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1319" href="Ledger.Conway.Specification.Script.Validation.html#1319" class="Bound">d</a> <a id="1321" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1323" class="Symbol">_)</a> <a id="1326" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1328" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1337" href="Ledger.Conway.Specification.Script.Validation.html#1280" class="Bound">utxo</a> <a id="1342" href="Ledger.Conway.Specification.Script.Validation.html#1292" class="Bound">txin</a>
                          <a id="1373" class="Keyword">where</a>
                            <a id="1407" class="Symbol">(_</a> <a id="1410" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1412" class="Symbol">_</a> <a id="1414" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1416" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1424" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1426" class="Symbol">_)</a> <a id="1429" class="Symbol">→</a> <a id="1431" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1444" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1449" href="Ledger.Conway.Specification.Script.Validation.html#1319" class="Bound">d</a> <a id="1451" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1454" class="Symbol">λ</a> <a id="1456" class="Keyword">where</a>
       <a id="1469" class="Symbol">(</a><a id="1470" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1475" href="Ledger.Conway.Specification.Script.Validation.html#1475" class="Bound">d</a><a id="1476" class="Symbol">)</a> <a id="1478" class="Symbol">→</a> <a id="1480" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1485" href="Ledger.Conway.Specification.Script.Validation.html#1475" class="Bound">d</a>
       <a id="1494" class="Symbol">(</a><a id="1495" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1500" href="Ledger.Conway.Specification.Script.Validation.html#1500" class="Bound">h</a><a id="1501" class="Symbol">)</a> <a id="1503" class="Symbol">→</a> <a id="1505" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1514" href="Ledger.Conway.Specification.Script.Validation.html#1536" class="Function">m</a> <a id="1516" href="Ledger.Conway.Specification.Script.Validation.html#1500" class="Bound">h</a>
     <a id="1523" class="Keyword">where</a>
       <a id="1536" href="Ledger.Conway.Specification.Script.Validation.html#1536" class="Function">m</a> <a id="1538" class="Symbol">=</a> <a id="1540" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="1549" class="Symbol">(</a><a id="1550" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1555" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1557" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="1562" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1564" href="Function.Base.html#704" class="Function">id</a> <a id="1567" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1569" class="Symbol">(</a><a id="1570" href="Ledger.Conway.Specification.Transaction.html#4532" class="Field">TxWitnesses.txdats</a> <a id="1589" class="Symbol">(</a><a id="1590" href="Ledger.Conway.Specification.Transaction.html#4738" class="Field">Tx.wits</a> <a id="1598" href="Ledger.Conway.Specification.Script.Validation.html#1277" class="Bound">tx</a><a id="1600" class="Symbol">)))</a>
<a id="1604" href="Ledger.Conway.Specification.Script.Validation.html#1217" class="CatchallClause Function">getDatum</a><a id="1612" class="CatchallClause"> </a><a id="1613" href="Ledger.Conway.Specification.Script.Validation.html#1613" class="CatchallClause Bound">tx</a><a id="1615" class="CatchallClause"> </a><a id="1616" href="Ledger.Conway.Specification.Script.Validation.html#1616" class="CatchallClause Bound">utxo</a><a id="1620" class="CatchallClause"> </a><a id="1621" class="CatchallClause Symbol">_</a> <a id="1623" class="Symbol">=</a> <a id="1625" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="txInfo"></a><a id="1635" href="Ledger.Conway.Specification.Script.Validation.html#1635" class="Function">txInfo</a> <a id="1642" class="Symbol">:</a> <a id="1644" href="Ledger.Conway.Specification.Script.Base.html#967" class="Function">Language</a> <a id="1653" class="Symbol">→</a> <a id="1655" href="Ledger.Conway.Specification.PParams.html#1689" class="Record">PParams</a>
                  <a id="1681" class="Symbol">→</a> <a id="1683" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
                  <a id="1706" class="Symbol">→</a> <a id="1708" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a>
                  <a id="1729" class="Symbol">→</a> <a id="1731" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#581" class="Record">TxInfo</a>
<a id="1738" href="Ledger.Conway.Specification.Script.Validation.html#1635" class="Function">txInfo</a> <a id="1745" href="Ledger.Conway.Specification.Script.Validation.html#1745" class="Bound">l</a> <a id="1747" href="Ledger.Conway.Specification.Script.Validation.html#1747" class="Bound">pp</a> <a id="1750" href="Ledger.Conway.Specification.Script.Validation.html#1750" class="Bound">utxo</a> <a id="1755" href="Ledger.Conway.Specification.Script.Validation.html#1755" class="Bound">tx</a> <a id="1758" class="Symbol">=</a> <a id="1760" class="Keyword">record</a>
  <a id="1769" class="Symbol">{</a> <a id="1771" href="Ledger.Conway.Specification.Script.Validation.html#1771" class="Module">TxBody</a> <a id="1778" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">body</a>
  <a id="1785" class="Symbol">;</a> <a id="1787" href="Ledger.Conway.Specification.Script.Validation.html#1787" class="Module">TxWitnesses</a> <a id="1799" href="Ledger.Conway.Specification.Transaction.html#4738" class="Field">wits</a>
  <a id="1806" class="Symbol">;</a> <a id="1808" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#609" class="Field">realizedInputs</a> <a id="1823" class="Symbol">=</a> <a id="1825" href="Ledger.Conway.Specification.Script.Validation.html#1750" class="Bound">utxo</a> <a id="1830" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="1832" href="Ledger.Conway.Specification.Transaction.html#3032" class="Function">txIns</a>
  <a id="1840" class="Symbol">;</a> <a id="1842" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#675" class="Field">fee</a> <a id="1846" class="Symbol">=</a> <a id="1848" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#882" class="Function">inject</a> <a id="1855" href="Ledger.Conway.Specification.Transaction.html#3254" class="Function">txFee</a>
  <a id="1863" class="Symbol">;</a> <a id="1865" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#706" class="Field">mint</a> <a id="1870" class="Symbol">=</a> <a id="1872" href="Ledger.Conway.Specification.Transaction.html#3638" class="Function">mint</a>
  <a id="1879" class="Symbol">;</a> <a id="1881" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#859" class="Field">vkKey</a> <a id="1887" class="Symbol">=</a> <a id="1889" href="Ledger.Conway.Specification.Transaction.html#3673" class="Function">reqSignerHashes</a>
  <a id="1907" class="Symbol">}</a> <a id="1909" class="Keyword">where</a> <a id="1915" class="Keyword">open</a> <a id="1920" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="1923" href="Ledger.Conway.Specification.Script.Validation.html#1755" class="Bound">tx</a><a id="1925" class="Symbol">;</a> <a id="1927" class="Keyword">open</a> <a id="1932" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="1939" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">body</a>

<a id="credsNeeded"></a><a id="1945" href="Ledger.Conway.Specification.Script.Validation.html#1945" class="Function">credsNeeded</a> <a id="1957" class="Symbol">:</a> <a id="1959" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="1964" class="Symbol">→</a> <a id="1966" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a> <a id="1973" class="Symbol">→</a> <a id="1975" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="1977" class="Symbol">(</a><a id="1978" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="1992" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1994" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="2004" class="Symbol">)</a>
<a id="2006" href="Ledger.Conway.Specification.Script.Validation.html#1945" class="Function">credsNeeded</a> <a id="2018" href="Ledger.Conway.Specification.Script.Validation.html#2018" class="Bound">utxo</a> <a id="2023" href="Ledger.Conway.Specification.Script.Validation.html#2023" class="Bound">txb</a>
  <a id="2029" class="Symbol">=</a>  <a id="2032" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2037" class="Symbol">(λ</a> <a id="2040" class="Symbol">(</a><a id="2041" href="Ledger.Conway.Specification.Script.Validation.html#2041" class="Bound">i</a> <a id="2043" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2045" href="Ledger.Conway.Specification.Script.Validation.html#2045" class="Bound">o</a><a id="2046" class="Symbol">)</a>  <a id="2049" class="Symbol">→</a> <a id="2051" class="Symbol">(</a><a id="2052" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#449" class="InductiveConstructor">Spend</a>  <a id="2059" href="Ledger.Conway.Specification.Script.Validation.html#2041" class="Bound">i</a> <a id="2061" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2063" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="2071" class="Symbol">(</a><a id="2072" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2078" href="Ledger.Conway.Specification.Script.Validation.html#2045" class="Bound">o</a><a id="2079" class="Symbol">)))</a> <a id="2083" class="Symbol">((</a><a id="2085" href="Ledger.Conway.Specification.Script.Validation.html#2018" class="Bound">utxo</a> <a id="2090" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="2092" class="Symbol">(</a><a id="2093" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a> <a id="2099" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="2101" href="Ledger.Conway.Specification.Transaction.html#3104" class="Field">collateralInputs</a><a id="2117" class="Symbol">))</a> <a id="2120" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2121" class="Symbol">)</a>
  <a id="2125" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2128" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2133" class="Symbol">(λ</a> <a id="2136" href="Ledger.Conway.Specification.Script.Validation.html#2136" class="Bound">a</a>        <a id="2145" class="Symbol">→</a> <a id="2147" class="Symbol">(</a><a id="2148" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#365" class="InductiveConstructor">Rwrd</a>   <a id="2155" href="Ledger.Conway.Specification.Script.Validation.html#2136" class="Bound">a</a> <a id="2157" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2159" href="Ledger.Core.Specification.Address.html#1367" class="Field">stake</a> <a id="2165" href="Ledger.Conway.Specification.Script.Validation.html#2136" class="Bound">a</a><a id="2166" class="Symbol">))</a> <a id="2169" class="Symbol">(</a><a id="2170" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2174" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2176" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a> <a id="2190" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a><a id="2191" class="Symbol">)</a>
  <a id="2195" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2198" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2209" class="Symbol">(λ</a> <a id="2212" href="Ledger.Conway.Specification.Script.Validation.html#2212" class="Bound">c</a>  <a id="2215" class="Symbol">→</a> <a id="2217" class="Symbol">(</a><a id="2218" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#323" class="InductiveConstructor">Cert</a>   <a id="2225" href="Ledger.Conway.Specification.Script.Validation.html#2212" class="Bound">c</a> <a id="2227" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2229" class="Symbol">)</a> <a id="2231" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2235" href="Ledger.Conway.Specification.Certs.html#2865" class="Function">cwitness</a> <a id="2244" href="Ledger.Conway.Specification.Script.Validation.html#2212" class="Bound">c</a><a id="2245" class="Symbol">)</a> <a id="2247" class="Symbol">(</a><a id="2248" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2257" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a><a id="2264" class="Symbol">)</a>
  <a id="2268" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2271" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2276" class="Symbol">(λ</a> <a id="2279" href="Ledger.Conway.Specification.Script.Validation.html#2279" class="Bound">x</a>        <a id="2288" class="Symbol">→</a> <a id="2290" class="Symbol">(</a><a id="2291" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#407" class="InductiveConstructor">Mint</a>   <a id="2298" href="Ledger.Conway.Specification.Script.Validation.html#2279" class="Bound">x</a> <a id="2300" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2302" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2312" href="Ledger.Conway.Specification.Script.Validation.html#2279" class="Bound">x</a><a id="2313" class="Symbol">))</a> <a id="2316" class="Symbol">(</a><a id="2317" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#927" class="Function">policies</a> <a id="2326" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a><a id="2330" class="Symbol">)</a>
  <a id="2334" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2337" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2348" class="Symbol">(λ</a> <a id="2351" href="Ledger.Conway.Specification.Script.Validation.html#2351" class="Bound">v</a> <a id="2353" class="Symbol">→</a> <a id="2355" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2358" href="Ledger.Conway.Specification.Gov.Actions.html#6701" class="Function">isGovVoterCredential</a> <a id="2379" href="Ledger.Conway.Specification.Script.Validation.html#2351" class="Bound">v</a> <a id="2381" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2386" class="Symbol">(λ</a> <a id="2389" class="Symbol">{</a><a id="2390" href="Ledger.Conway.Specification.Script.Validation.html#2390" class="Bound">c</a><a id="2391" class="Symbol">}</a> <a id="2393" class="Symbol">→</a> <a id="2395" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2400" class="Symbol">(</a><a id="2401" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#491" class="InductiveConstructor">Vote</a> <a id="2406" href="Ledger.Conway.Specification.Script.Validation.html#2351" class="Bound">v</a> <a id="2408" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2410" href="Ledger.Conway.Specification.Script.Validation.html#2390" class="Bound">c</a><a id="2411" class="Symbol">))</a> <a id="2414" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2419" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2426" class="Symbol">)</a>
                <a id="2444" class="Symbol">(</a><a id="2445" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2454" class="Symbol">(</a><a id="2455" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2459" href="Ledger.Conway.Specification.Gov.Actions.html#2357" class="Field">voter</a> <a id="2465" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a><a id="2475" class="Symbol">))</a>
  <a id="2480" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2483" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2494" class="Symbol">(λ</a> <a id="2497" href="Ledger.Conway.Specification.Script.Validation.html#2497" class="Bound">p</a> <a id="2499" class="Symbol">→</a> <a id="2501" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2504" href="Ledger.Conway.Specification.Script.Validation.html#2497" class="Bound">p</a> <a id="2506" class="Symbol">.</a><a id="2507" href="Ledger.Conway.Specification.Gov.Actions.html#3712" class="Field">policy</a> <a id="2514" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2519" class="Symbol">(λ</a> <a id="2522" class="Symbol">{</a><a id="2523" href="Ledger.Conway.Specification.Script.Validation.html#2523" class="Bound">sh</a><a id="2525" class="Symbol">}</a> <a id="2527" class="Symbol">→</a> <a id="2529" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2534" class="Symbol">(</a><a id="2535" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#533" class="InductiveConstructor">Propose</a>  <a id="2544" href="Ledger.Conway.Specification.Script.Validation.html#2497" class="Bound">p</a> <a id="2546" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2548" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2558" href="Ledger.Conway.Specification.Script.Validation.html#2523" class="Bound">sh</a><a id="2560" class="Symbol">))</a> <a id="2563" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2568" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2575" class="Symbol">)</a>
                <a id="2593" class="Symbol">(</a><a id="2594" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2603" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a><a id="2617" class="Symbol">)</a>


  <a id="2623" class="Keyword">where</a> <a id="2629" class="Keyword">open</a> <a id="2634" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="2641" href="Ledger.Conway.Specification.Script.Validation.html#2023" class="Bound">txb</a><a id="2644" class="Symbol">;</a> <a id="2646" class="Keyword">open</a> <a id="2651" href="Ledger.Conway.Specification.Gov.Actions.html#2294" class="Module">GovVote</a><a id="2658" class="Symbol">;</a> <a id="2660" class="Keyword">open</a> <a id="2665" href="Ledger.Core.Specification.Address.html#1313" class="Module">RwdAddr</a><a id="2672" class="Symbol">;</a> <a id="2674" class="Keyword">open</a> <a id="2679" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Module">GovProposal</a>

<a id="2692" class="Comment">-- valContext : TxInfo → ScriptPurpose → Data</a>
<a id="2738" class="Comment">-- valContext txinfo sp = toData (txinfo , sp)</a>

<a id="txOutToDataHash"></a><a id="2786" href="Ledger.Conway.Specification.Script.Validation.html#2786" class="Function">txOutToDataHash</a> <a id="2802" class="Symbol">:</a> <a id="2804" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="2810" class="Symbol">→</a> <a id="2812" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2818" href="Ledger.Conway.Specification.Script.Base.html#1723" class="Function">DataHash</a>
<a id="2827" href="Ledger.Conway.Specification.Script.Validation.html#2786" class="Function">txOutToDataHash</a> <a id="2843" class="Symbol">(_</a> <a id="2846" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2848" class="Symbol">_</a> <a id="2850" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2852" href="Ledger.Conway.Specification.Script.Validation.html#2852" class="Bound">d</a> <a id="2854" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2856" class="Symbol">_)</a> <a id="2859" class="Symbol">=</a> <a id="2861" href="Ledger.Conway.Specification.Script.Validation.html#2852" class="Bound">d</a> <a id="2863" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="2867" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="2875" href="Ledger.Conway.Specification.Script.Validation.html#2875" class="Function">txOutToP2Script</a>
  <a id="2893" class="Symbol">:</a> <a id="2895" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="2900" class="Symbol">→</a> <a id="2902" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a>
  <a id="2907" class="Symbol">→</a> <a id="2909" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="2915" class="Symbol">→</a> <a id="2917" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2923" href="Ledger.Conway.Specification.Script.Base.html#2367" class="Function">P2Script</a>
<a id="2932" href="Ledger.Conway.Specification.Script.Validation.html#2875" class="Function">txOutToP2Script</a> <a id="2948" href="Ledger.Conway.Specification.Script.Validation.html#2948" class="Bound">utxo</a> <a id="2953" href="Ledger.Conway.Specification.Script.Validation.html#2953" class="Bound">tx</a> <a id="2956" class="Symbol">(</a><a id="2957" href="Ledger.Conway.Specification.Script.Validation.html#2957" class="Bound">a</a> <a id="2959" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2961" class="Symbol">_)</a> <a id="2964" class="Symbol">=</a>
  <a id="2968" class="Keyword">do</a> <a id="2971" href="Ledger.Conway.Specification.Script.Validation.html#2971" class="Bound">sh</a> <a id="2974" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="2976" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="2988" class="Symbol">(</a><a id="2989" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="2997" href="Ledger.Conway.Specification.Script.Validation.html#2957" class="Bound">a</a><a id="2998" class="Symbol">)</a>
     <a id="3005" href="Ledger.Conway.Specification.Script.Validation.html#3005" class="Bound">s</a>  <a id="3008" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3010" href="Ledger.Conway.Specification.Transaction.html#6502" class="Function">lookupScriptHash</a> <a id="3027" href="Ledger.Conway.Specification.Script.Validation.html#2971" class="Bound">sh</a> <a id="3030" href="Ledger.Conway.Specification.Script.Validation.html#2953" class="Bound">tx</a> <a id="3033" href="Ledger.Conway.Specification.Script.Validation.html#2948" class="Bound">utxo</a>
     <a id="3043" href="Ledger.Conway.Specification.Script.Base.html#3220" class="Function">toP2Script</a> <a id="3054" href="Ledger.Conway.Specification.Script.Validation.html#3005" class="Bound">s</a>

<a id="3057" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3066" href="Ledger.Conway.Specification.Script.Validation.html#3066" class="Function">collectP2ScriptsWithContext</a>
    <a id="3098" class="Symbol">:</a> <a id="3100" href="Ledger.Conway.Specification.PParams.html#1689" class="Record">PParams</a> <a id="3108" class="Symbol">→</a> <a id="3110" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="3113" class="Symbol">→</a> <a id="3115" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
    <a id="3124" class="Symbol">→</a> <a id="3126" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3131" class="Symbol">(</a><a id="3132" href="Ledger.Conway.Specification.Script.Base.html#2367" class="Function">P2Script</a> <a id="3141" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3143" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3148" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="3153" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3155" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="3163" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3165" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="3174" class="Symbol">)</a>
  <a id="3178" href="Ledger.Conway.Specification.Script.Validation.html#3066" class="Function">collectP2ScriptsWithContext</a> <a id="3206" href="Ledger.Conway.Specification.Script.Validation.html#3206" class="Bound">pp</a> <a id="3209" href="Ledger.Conway.Specification.Script.Validation.html#3209" class="Bound">tx</a> <a id="3212" href="Ledger.Conway.Specification.Script.Validation.html#3212" class="Bound">utxo</a>
    <a id="3221" class="Symbol">=</a> <a id="3223" href="abstract-set-theory.FiniteSetTheory.html#2617" class="Function">setToList</a>
    <a id="3237" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3239" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3250" class="Symbol">(λ</a> <a id="3253" class="Symbol">(</a><a id="3254" href="Ledger.Conway.Specification.Script.Validation.html#3254" class="Bound">sp</a> <a id="3257" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3259" href="Ledger.Conway.Specification.Script.Validation.html#3259" class="Bound">c</a><a id="3260" class="Symbol">)</a> <a id="3262" class="Symbol">→</a> <a id="3264" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3267" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3279" href="Ledger.Conway.Specification.Script.Validation.html#3259" class="Bound">c</a>
                                <a id="3313" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3318" class="Symbol">(λ</a> <a id="3321" class="Symbol">{</a><a id="3322" href="Ledger.Conway.Specification.Script.Validation.html#3322" class="Bound">sh</a><a id="3324" class="Symbol">}</a> <a id="3326" class="Symbol">→</a> <a id="3328" href="Ledger.Conway.Specification.Script.Validation.html#3448" class="Function">toScriptInput</a> <a id="3342" href="Ledger.Conway.Specification.Script.Validation.html#3254" class="Bound">sp</a> <a id="3345" href="Ledger.Conway.Specification.Script.Validation.html#3322" class="Bound">sh</a><a id="3347" class="Symbol">)</a>
                                <a id="3381" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3386" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3393" class="Symbol">)</a>
    <a id="3399" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3401" href="Ledger.Conway.Specification.Script.Validation.html#1945" class="Function">credsNeeded</a> <a id="3413" href="Ledger.Conway.Specification.Script.Validation.html#3212" class="Bound">utxo</a> <a id="3418" class="Symbol">(</a><a id="3419" href="Ledger.Conway.Specification.Script.Validation.html#3209" class="Bound">tx</a> <a id="3422" class="Symbol">.</a><a id="3423" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">Tx.body</a><a id="3430" class="Symbol">)</a>
    <a id="3436" class="Keyword">where</a>
      <a id="3448" href="Ledger.Conway.Specification.Script.Validation.html#3448" class="Function">toScriptInput</a>
        <a id="3470" class="Symbol">:</a> <a id="3472" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="3486" class="Symbol">→</a> <a id="3488" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
        <a id="3507" class="Symbol">→</a> <a id="3509" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3515" class="Symbol">(</a><a id="3516" href="Ledger.Conway.Specification.Script.Base.html#2367" class="Function">P2Script</a> <a id="3525" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3527" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3532" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="3537" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3539" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="3547" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3549" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="3558" class="Symbol">)</a>
      <a id="3566" href="Ledger.Conway.Specification.Script.Validation.html#3448" class="Function">toScriptInput</a> <a id="3580" href="Ledger.Conway.Specification.Script.Validation.html#3580" class="Bound">sp</a> <a id="3583" href="Ledger.Conway.Specification.Script.Validation.html#3583" class="Bound">sh</a> <a id="3586" class="Symbol">=</a>
        <a id="3596" class="Keyword">do</a> <a id="3599" href="Ledger.Conway.Specification.Script.Validation.html#3599" class="Bound">s</a> <a id="3601" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3603" href="Ledger.Conway.Specification.Transaction.html#6502" class="Function">lookupScriptHash</a> <a id="3620" href="Ledger.Conway.Specification.Script.Validation.html#3583" class="Bound">sh</a> <a id="3623" href="Ledger.Conway.Specification.Script.Validation.html#3209" class="Bound">tx</a> <a id="3626" href="Ledger.Conway.Specification.Script.Validation.html#3212" class="Bound">utxo</a>
           <a id="3642" href="Ledger.Conway.Specification.Script.Validation.html#3642" class="Bound">p2s</a> <a id="3646" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3648" href="Ledger.Conway.Specification.Script.Base.html#3220" class="Function">toP2Script</a> <a id="3659" href="Ledger.Conway.Specification.Script.Validation.html#3599" class="Bound">s</a>
           <a id="3672" class="Symbol">(</a><a id="3673" href="Ledger.Conway.Specification.Script.Validation.html#3673" class="Bound">rdmr</a> <a id="3678" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3680" href="Ledger.Conway.Specification.Script.Validation.html#3680" class="Bound">exunits</a><a id="3687" class="Symbol">)</a> <a id="3689" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3691" href="Ledger.Conway.Specification.Script.Validation.html#1033" class="Function">indexedRdmrs</a> <a id="3704" href="Ledger.Conway.Specification.Script.Validation.html#3209" class="Bound">tx</a> <a id="3707" href="Ledger.Conway.Specification.Script.Validation.html#3580" class="Bound">sp</a>
           <a id="3721" class="Keyword">let</a> <a id="3725" href="Ledger.Conway.Specification.Script.Validation.html#3725" class="Bound">data&#39;</a>     <a id="3735" class="Symbol">=</a> <a id="3737" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="3743" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="3747" class="InductiveConstructor">[]</a> <a id="3750" class="Symbol">(</a><a id="3751" href="Ledger.Conway.Specification.Script.Validation.html#1217" class="Function">getDatum</a> <a id="3760" href="Ledger.Conway.Specification.Script.Validation.html#3209" class="Bound">tx</a> <a id="3763" href="Ledger.Conway.Specification.Script.Validation.html#3212" class="Bound">utxo</a> <a id="3768" href="Ledger.Conway.Specification.Script.Validation.html#3580" class="Bound">sp</a><a id="3770" class="Symbol">)</a> <a id="3772" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="3775" href="Ledger.Conway.Specification.Script.Validation.html#3673" class="Bound">rdmr</a> <a id="3780" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3782" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="3784" href="Ledger.Conway.Specification.Abstract.html#990" class="Field">valContext</a> <a id="3795" class="Symbol">(</a><a id="3796" href="Ledger.Conway.Specification.Script.Validation.html#1635" class="Function">txInfo</a> <a id="3803" class="Symbol">(</a><a id="3804" href="Ledger.Conway.Specification.Script.Base.html#1964" class="Function">language</a> <a id="3813" href="Ledger.Conway.Specification.Script.Validation.html#3642" class="Bound">p2s</a><a id="3816" class="Symbol">)</a> <a id="3818" href="Ledger.Conway.Specification.Script.Validation.html#3206" class="Bound">pp</a> <a id="3821" href="Ledger.Conway.Specification.Script.Validation.html#3212" class="Bound">utxo</a> <a id="3826" href="Ledger.Conway.Specification.Script.Validation.html#3209" class="Bound">tx</a><a id="3828" class="Symbol">)</a> <a id="3830" href="Ledger.Conway.Specification.Script.Validation.html#3580" class="Bound">sp</a> <a id="3833" href="Data.List.Base.html#4907" class="Function Operator">]</a>
               <a id="3850" href="Ledger.Conway.Specification.Script.Validation.html#3850" class="Bound">costModel</a> <a id="3860" class="Symbol">=</a> <a id="3862" href="Ledger.Conway.Specification.PParams.html#3068" class="Field">PParams.costmdls</a> <a id="3879" href="Ledger.Conway.Specification.Script.Validation.html#3206" class="Bound">pp</a>
           <a id="3893" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3898" class="Symbol">(</a><a id="3899" href="Ledger.Conway.Specification.Script.Validation.html#3642" class="Bound">p2s</a> <a id="3903" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3905" href="Ledger.Conway.Specification.Script.Validation.html#3725" class="Bound">data&#39;</a> <a id="3911" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3913" href="Ledger.Conway.Specification.Script.Validation.html#3680" class="Bound">exunits</a> <a id="3921" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3923" href="Ledger.Conway.Specification.Script.Validation.html#3850" class="Bound">costModel</a><a id="3932" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="3935" href="Ledger.Conway.Specification.Script.Validation.html#3935" class="Function">evalP2Scripts</a> <a id="3949" class="Symbol">:</a> <a id="3951" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3956" class="Symbol">(</a><a id="3957" href="Ledger.Conway.Specification.Script.Base.html#2367" class="Function">P2Script</a> <a id="3966" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3968" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3973" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="3978" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3980" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="3988" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3990" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="3999" class="Symbol">)</a> <a id="4001" class="Symbol">→</a> <a id="4003" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4008" href="Ledger.Conway.Specification.Script.Validation.html#3935" class="Function">evalP2Scripts</a> <a id="4022" class="Symbol">=</a> <a id="4024" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="4028" class="Symbol">(λ</a> <a id="4031" class="Symbol">(</a><a id="4032" href="Ledger.Conway.Specification.Script.Validation.html#4032" class="Bound">s</a> <a id="4034" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4036" href="Ledger.Conway.Specification.Script.Validation.html#4036" class="Bound">d</a> <a id="4038" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4040" href="Ledger.Conway.Specification.Script.Validation.html#4040" class="Bound">eu</a> <a id="4043" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4045" href="Ledger.Conway.Specification.Script.Validation.html#4045" class="Bound">cm</a><a id="4047" class="Symbol">)</a> <a id="4049" class="Symbol">→</a> <a id="4051" href="Ledger.Conway.Specification.Abstract.html#883" class="Field">runPLCScript</a> <a id="4064" href="Ledger.Conway.Specification.Script.Validation.html#4045" class="Bound">cm</a> <a id="4067" href="Ledger.Conway.Specification.Script.Validation.html#4032" class="Bound">s</a> <a id="4069" href="Ledger.Conway.Specification.Script.Validation.html#4040" class="Bound">eu</a> <a id="4072" href="Ledger.Conway.Specification.Script.Validation.html#4036" class="Bound">d</a><a id="4073" class="Symbol">)</a>

</pre></body></html>