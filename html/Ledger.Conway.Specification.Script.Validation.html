<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="124" class="Keyword">module</a> <a id="131" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="179" class="Symbol">(</a><a id="180" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a> <a id="184" class="Symbol">:</a> <a id="186" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="206" class="Symbol">)</a> <a id="208" class="Symbol">(</a><a id="209" class="Keyword">open</a> <a id="214" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="235" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a><a id="238" class="Symbol">)</a>
  <a id="242" class="Symbol">(</a><a id="243" href="Ledger.Conway.Specification.Script.Validation.html#243" class="Bound">abs</a> <a id="247" class="Symbol">:</a> <a id="249" href="Ledger.Core.Specification.Abstract.html#651" class="Record">AbstractFunctions</a> <a id="267" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a><a id="270" class="Symbol">)</a>
  <a id="274" class="Keyword">where</a>

<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="354" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="367" class="Keyword">open</a> <a id="372" class="Keyword">import</a> <a id="379" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="419" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a> <a id="423" href="Ledger.Conway.Specification.Script.Validation.html#243" class="Bound">abs</a>

<a id="428" class="Keyword">open</a> <a id="433" href="Ledger.Core.Specification.Abstract.html#651" class="Module">AbstractFunctions</a> <a id="451" href="Ledger.Conway.Specification.Script.Validation.html#243" class="Bound">abs</a>
<a id="455" class="Keyword">open</a> <a id="460" href="Ledger.Core.Specification.Abstract.html#279" class="Module">indexOf</a> <a id="468" href="Ledger.Core.Specification.Abstract.html#783" class="Field">indexOfImp</a>


<a id="481" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="486" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a> <a id="500" class="Symbol">:</a> <a id="502" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="507" class="Keyword">where</a>
  <a id="ScriptPurpose.Cert"></a><a id="515" href="Ledger.Conway.Specification.Script.Validation.html#515" class="InductiveConstructor">Cert</a>     <a id="524" class="Symbol">:</a> <a id="526" href="Ledger.Core.Specification.Certs.html#2224" class="Datatype">DCert</a>        <a id="539" class="Symbol">→</a> <a id="541" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Rwrd"></a><a id="557" href="Ledger.Conway.Specification.Script.Validation.html#557" class="InductiveConstructor">Rwrd</a>     <a id="566" class="Symbol">:</a> <a id="568" href="Ledger.Core.Specification.Address.html#1313" class="Record">RwdAddr</a>      <a id="581" class="Symbol">→</a> <a id="583" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Mint"></a><a id="599" href="Ledger.Conway.Specification.Script.Validation.html#599" class="InductiveConstructor">Mint</a>     <a id="608" class="Symbol">:</a> <a id="610" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>   <a id="623" class="Symbol">→</a> <a id="625" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Spend"></a><a id="641" href="Ledger.Conway.Specification.Script.Validation.html#641" class="InductiveConstructor">Spend</a>    <a id="650" class="Symbol">:</a> <a id="652" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a>         <a id="665" class="Symbol">→</a> <a id="667" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Vote"></a><a id="683" href="Ledger.Conway.Specification.Script.Validation.html#683" class="InductiveConstructor">Vote</a>     <a id="692" class="Symbol">:</a> <a id="694" href="Ledger.Core.Specification.Gov.Actions.html#2077" class="Record">GovVoter</a>     <a id="707" class="Symbol">→</a> <a id="709" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Propose"></a><a id="725" href="Ledger.Conway.Specification.Script.Validation.html#725" class="InductiveConstructor">Propose</a>  <a id="734" class="Symbol">:</a> <a id="736" href="Ledger.Core.Specification.Gov.Actions.html#3598" class="Record">GovProposal</a>  <a id="749" class="Symbol">→</a> <a id="751" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a>


<a id="rdptr"></a><a id="767" href="Ledger.Conway.Specification.Script.Validation.html#767" class="Function">rdptr</a> <a id="773" class="Symbol">:</a> <a id="775" href="Ledger.Conway.Specification.Transaction.html#350" class="Record">TxBody</a> <a id="782" class="Symbol">→</a> <a id="784" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a> <a id="798" class="Symbol">→</a> <a id="800" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="806" href="Ledger.Core.Specification.Transaction.html#2643" class="Function">RdmrPtr</a>
<a id="814" href="Ledger.Conway.Specification.Script.Validation.html#767" class="Function">rdptr</a> <a id="820" href="Ledger.Conway.Specification.Script.Validation.html#820" class="Bound">txb</a> <a id="824" class="Symbol">=</a> <a id="826" class="Symbol">λ</a> <a id="828" class="Keyword">where</a>
  <a id="836" class="Symbol">(</a><a id="837" href="Ledger.Conway.Specification.Script.Validation.html#515" class="InductiveConstructor">Cert</a> <a id="842" href="Ledger.Conway.Specification.Script.Validation.html#842" class="Bound">h</a><a id="843" class="Symbol">)</a>     <a id="849" class="Symbol">→</a> <a id="851" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="855" class="Symbol">(</a><a id="856" href="Ledger.Core.Specification.Transaction.html#789" class="InductiveConstructor">Cert</a>    <a id="864" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="866" class="Symbol">)</a> <a id="868" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="870" href="Ledger.Core.Specification.Abstract.html#312" class="Function">indexOfDCert</a>    <a id="886" href="Ledger.Conway.Specification.Script.Validation.html#842" class="Bound">h</a> <a id="888" href="Ledger.Conway.Specification.Transaction.html#554" class="Field">txCerts</a>
  <a id="898" class="Symbol">(</a><a id="899" href="Ledger.Conway.Specification.Script.Validation.html#557" class="InductiveConstructor">Rwrd</a> <a id="904" href="Ledger.Conway.Specification.Script.Validation.html#904" class="Bound">h</a><a id="905" class="Symbol">)</a>     <a id="911" class="Symbol">→</a> <a id="913" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="917" class="Symbol">(</a><a id="918" href="Ledger.Core.Specification.Transaction.html#794" class="InductiveConstructor">Rewrd</a>   <a id="926" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="928" class="Symbol">)</a> <a id="930" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="932" href="Ledger.Core.Specification.Abstract.html#364" class="Function">indexOfRwdAddr</a>  <a id="948" href="Ledger.Conway.Specification.Script.Validation.html#904" class="Bound">h</a> <a id="950" href="Ledger.Conway.Specification.Transaction.html#624" class="Field">txWithdrawals</a>
  <a id="966" class="Symbol">(</a><a id="967" href="Ledger.Conway.Specification.Script.Validation.html#599" class="InductiveConstructor">Mint</a> <a id="972" href="Ledger.Conway.Specification.Script.Validation.html#972" class="Bound">h</a><a id="973" class="Symbol">)</a>     <a id="979" class="Symbol">→</a> <a id="981" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="985" class="Symbol">(</a><a id="986" href="Ledger.Core.Specification.Transaction.html#784" class="InductiveConstructor">Mint</a>    <a id="994" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="996" class="Symbol">)</a> <a id="998" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1000" href="Ledger.Core.Specification.Abstract.html#466" class="Function">indexOfPolicyId</a> <a id="1016" href="Ledger.Conway.Specification.Script.Validation.html#972" class="Bound">h</a> <a id="1018" class="Symbol">(</a><a id="1019" href="Ledger.Core.Specification.TokenAlgebra.Base.html#925" class="Function">policies</a> <a id="1028" href="Ledger.Conway.Specification.Transaction.html#958" class="Field">mint</a><a id="1032" class="Symbol">)</a>
  <a id="1036" class="Symbol">(</a><a id="1037" href="Ledger.Conway.Specification.Script.Validation.html#641" class="InductiveConstructor">Spend</a> <a id="1043" href="Ledger.Conway.Specification.Script.Validation.html#1043" class="Bound">h</a><a id="1044" class="Symbol">)</a>    <a id="1049" class="Symbol">→</a> <a id="1051" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Ledger.Core.Specification.Transaction.html#778" class="InductiveConstructor">Spend</a>   <a id="1064" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1066" class="Symbol">)</a> <a id="1068" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1070" href="Ledger.Core.Specification.Abstract.html#419" class="Function">indexOfTxIn</a>     <a id="1086" href="Ledger.Conway.Specification.Script.Validation.html#1043" class="Bound">h</a> <a id="1088" href="Ledger.Conway.Specification.Transaction.html#382" class="Field">txIns</a>
  <a id="1096" class="Symbol">(</a><a id="1097" href="Ledger.Conway.Specification.Script.Validation.html#683" class="InductiveConstructor">Vote</a> <a id="1102" href="Ledger.Conway.Specification.Script.Validation.html#1102" class="Bound">h</a><a id="1103" class="Symbol">)</a>     <a id="1109" class="Symbol">→</a> <a id="1111" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1115" class="Symbol">(</a><a id="1116" href="Ledger.Core.Specification.Transaction.html#800" class="InductiveConstructor">Vote</a>    <a id="1124" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1126" class="Symbol">)</a> <a id="1128" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1130" href="Ledger.Core.Specification.Abstract.html#525" class="Function">indexOfVote</a>     <a id="1146" href="Ledger.Conway.Specification.Script.Validation.html#1102" class="Bound">h</a> <a id="1148" class="Symbol">(</a><a id="1149" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1153" href="Ledger.Core.Specification.Gov.Actions.html#2352" class="Field">GovVote.voter</a> <a id="1167" href="Ledger.Conway.Specification.Transaction.html#791" class="Field">txGovVotes</a><a id="1177" class="Symbol">)</a>
  <a id="1181" class="Symbol">(</a><a id="1182" href="Ledger.Conway.Specification.Script.Validation.html#725" class="InductiveConstructor">Propose</a> <a id="1190" href="Ledger.Conway.Specification.Script.Validation.html#1190" class="Bound">h</a><a id="1191" class="Symbol">)</a>  <a id="1194" class="Symbol">→</a> <a id="1196" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1200" class="Symbol">(</a><a id="1201" href="Ledger.Core.Specification.Transaction.html#805" class="InductiveConstructor">Propose</a> <a id="1209" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1211" class="Symbol">)</a> <a id="1213" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1215" href="Ledger.Core.Specification.Abstract.html#583" class="Function">indexOfProposal</a> <a id="1231" href="Ledger.Conway.Specification.Script.Validation.html#1190" class="Bound">h</a> <a id="1233" href="Ledger.Conway.Specification.Transaction.html#831" class="Field">txGovProposals</a>
 <a id="1249" class="Keyword">where</a> <a id="1255" class="Keyword">open</a> <a id="1260" href="Ledger.Conway.Specification.Transaction.html#350" class="Module">TxBody</a> <a id="1267" href="Ledger.Conway.Specification.Script.Validation.html#820" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1272" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="Function">indexedRdmrs</a> <a id="1285" class="Symbol">:</a> <a id="1287" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="1290" class="Symbol">→</a> <a id="1292" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a> <a id="1306" class="Symbol">→</a> <a id="1308" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1314" class="Symbol">(</a><a id="1315" href="Ledger.Core.Specification.Script.Base.html#1786" class="Function">Redeemer</a> <a id="1324" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1326" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a><a id="1333" class="Symbol">)</a>
<a id="1335" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="Function">indexedRdmrs</a> <a id="1348" href="Ledger.Conway.Specification.Script.Validation.html#1348" class="Bound">tx</a> <a id="1351" href="Ledger.Conway.Specification.Script.Validation.html#1351" class="Bound">sp</a> <a id="1354" class="Symbol">=</a> <a id="1356" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1362" class="Symbol">(λ</a> <a id="1365" href="Ledger.Conway.Specification.Script.Validation.html#1365" class="Bound">x</a> <a id="1367" class="Symbol">→</a> <a id="1369" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1378" href="Ledger.Core.Specification.Transaction.html#3007" class="Function">txrdmrs</a> <a id="1386" href="Ledger.Conway.Specification.Script.Validation.html#1365" class="Bound">x</a><a id="1387" class="Symbol">)</a> <a id="1389" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1397" class="Symbol">(</a><a id="1398" href="Ledger.Conway.Specification.Script.Validation.html#767" class="Function">rdptr</a> <a id="1404" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a> <a id="1409" href="Ledger.Conway.Specification.Script.Validation.html#1351" class="Bound">sp</a><a id="1411" class="Symbol">)</a>
  <a id="1415" class="Keyword">where</a> <a id="1421" class="Keyword">open</a> <a id="1426" href="Ledger.Conway.Specification.Transaction.html#1719" class="Module">Tx</a> <a id="1429" href="Ledger.Conway.Specification.Script.Validation.html#1348" class="Bound">tx</a><a id="1431" class="Symbol">;</a> <a id="1433" class="Keyword">open</a> <a id="1438" href="Ledger.Core.Specification.Transaction.html#2887" class="Module">TxWitnesses</a> <a id="1450" href="Ledger.Conway.Specification.Transaction.html#1769" class="Function">wits</a>

<a id="getDatum"></a><a id="1456" href="Ledger.Conway.Specification.Script.Validation.html#1456" class="Function">getDatum</a> <a id="1465" class="Symbol">:</a> <a id="1467" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="1477" class="Symbol">→</a> <a id="1479" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a> <a id="1493" class="Symbol">→</a> <a id="1495" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1501" href="Ledger.Core.Specification.Script.Base.html#1768" class="Function">Datum</a>
<a id="1507" href="Ledger.Conway.Specification.Script.Validation.html#1456" class="Function">getDatum</a> <a id="1516" href="Ledger.Conway.Specification.Script.Validation.html#1516" class="Bound">tx</a> <a id="1519" href="Ledger.Conway.Specification.Script.Validation.html#1519" class="Bound">utxo</a> <a id="1524" class="Symbol">(</a><a id="1525" href="Ledger.Conway.Specification.Script.Validation.html#641" class="InductiveConstructor">Spend</a> <a id="1531" href="Ledger.Conway.Specification.Script.Validation.html#1531" class="Bound">txin</a><a id="1535" class="Symbol">)</a> <a id="1537" class="Symbol">=</a>
  <a id="1541" class="Keyword">do</a> <a id="1544" class="Symbol">(_</a> <a id="1547" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1549" class="Symbol">_</a> <a id="1551" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1553" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1558" href="Ledger.Conway.Specification.Script.Validation.html#1558" class="Bound">d</a> <a id="1560" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1562" class="Symbol">_)</a> <a id="1565" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1567" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1576" href="Ledger.Conway.Specification.Script.Validation.html#1519" class="Bound">utxo</a> <a id="1581" href="Ledger.Conway.Specification.Script.Validation.html#1531" class="Bound">txin</a>
                          <a id="1612" class="Keyword">where</a>
                            <a id="1646" class="Symbol">(_</a> <a id="1649" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1651" class="Symbol">_</a> <a id="1653" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1655" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1663" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1665" class="Symbol">_)</a> <a id="1668" class="Symbol">→</a> <a id="1670" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1683" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1688" href="Ledger.Conway.Specification.Script.Validation.html#1558" class="Bound">d</a> <a id="1690" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1693" class="Symbol">λ</a> <a id="1695" class="Keyword">where</a>
       <a id="1708" class="Symbol">(</a><a id="1709" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1714" href="Ledger.Conway.Specification.Script.Validation.html#1714" class="Bound">d</a><a id="1715" class="Symbol">)</a> <a id="1717" class="Symbol">→</a> <a id="1719" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1724" href="Ledger.Conway.Specification.Script.Validation.html#1714" class="Bound">d</a>
       <a id="1733" class="Symbol">(</a><a id="1734" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1739" href="Ledger.Conway.Specification.Script.Validation.html#1739" class="Bound">h</a><a id="1740" class="Symbol">)</a> <a id="1742" class="Symbol">→</a> <a id="1744" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1753" href="Ledger.Conway.Specification.Script.Validation.html#1775" class="Function">m</a> <a id="1755" href="Ledger.Conway.Specification.Script.Validation.html#1739" class="Bound">h</a>
     <a id="1762" class="Keyword">where</a>
       <a id="1775" href="Ledger.Conway.Specification.Script.Validation.html#1775" class="Function">m</a> <a id="1777" class="Symbol">=</a> <a id="1779" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="1788" class="Symbol">(</a><a id="1789" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1794" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1796" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="1801" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1803" href="Function.Base.html#704" class="Function">id</a> <a id="1806" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1808" class="Symbol">(</a><a id="1809" href="Ledger.Core.Specification.Transaction.html#2982" class="Field">TxWitnesses.txdats</a> <a id="1828" class="Symbol">(</a><a id="1829" href="Ledger.Conway.Specification.Transaction.html#1769" class="Field">Tx.wits</a> <a id="1837" href="Ledger.Conway.Specification.Script.Validation.html#1516" class="Bound">tx</a><a id="1839" class="Symbol">)))</a>
<a id="1843" href="Ledger.Conway.Specification.Script.Validation.html#1456" class="CatchallClause Function">getDatum</a><a id="1851" class="CatchallClause"> </a><a id="1852" href="Ledger.Conway.Specification.Script.Validation.html#1852" class="CatchallClause Bound">tx</a><a id="1854" class="CatchallClause"> </a><a id="1855" href="Ledger.Conway.Specification.Script.Validation.html#1855" class="CatchallClause Bound">utxo</a><a id="1859" class="CatchallClause"> </a><a id="1860" class="CatchallClause Symbol">_</a> <a id="1862" class="Symbol">=</a> <a id="1864" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="1874" class="Keyword">record</a> <a id="TxInfo"></a><a id="1881" href="Ledger.Conway.Specification.Script.Validation.html#1881" class="Record">TxInfo</a> <a id="1888" class="Symbol">:</a> <a id="1890" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1895" class="Keyword">where</a>
  <a id="1903" class="Keyword">field</a> <a id="TxInfo.realizedInputs"></a><a id="1909" href="Ledger.Conway.Specification.Script.Validation.html#1909" class="Field">realizedInputs</a> <a id="1924" class="Symbol">:</a> <a id="1926" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a>
        <a id="TxInfo.txOuts"></a><a id="1939" href="Ledger.Conway.Specification.Script.Validation.html#1939" class="Field">txOuts</a>         <a id="1954" class="Symbol">:</a> <a id="1956" href="Ledger.Core.Specification.Transaction.html#945" class="Field">Ix</a> <a id="1959" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1961" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a>
        <a id="TxInfo.fee"></a><a id="1975" href="Ledger.Conway.Specification.Script.Validation.html#1975" class="Field">fee</a>            <a id="1990" class="Symbol">:</a> <a id="1992" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
        <a id="TxInfo.mint"></a><a id="2006" href="Ledger.Conway.Specification.Script.Validation.html#2006" class="Field">mint</a>           <a id="2021" class="Symbol">:</a> <a id="2023" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
        <a id="TxInfo.txCerts"></a><a id="2037" href="Ledger.Conway.Specification.Script.Validation.html#2037" class="Field">txCerts</a>        <a id="2052" class="Symbol">:</a> <a id="2054" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2059" href="Ledger.Core.Specification.Certs.html#2224" class="Datatype">DCert</a>
        <a id="TxInfo.txWithdrawals"></a><a id="2073" href="Ledger.Conway.Specification.Script.Validation.html#2073" class="Field">txWithdrawals</a>  <a id="2088" class="Symbol">:</a> <a id="2090" href="Ledger.Core.Specification.Address.html#1388" class="Function">Withdrawals</a>
        <a id="TxInfo.txVldt"></a><a id="2110" href="Ledger.Conway.Specification.Script.Validation.html#2110" class="Field">txVldt</a>         <a id="2125" class="Symbol">:</a> <a id="2127" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2133" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a> <a id="2138" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2140" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2146" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a>
        <a id="TxInfo.vkKey"></a><a id="2159" href="Ledger.Conway.Specification.Script.Validation.html#2159" class="Field">vkKey</a>          <a id="2174" class="Symbol">:</a> <a id="2176" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2178" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
        <a id="TxInfo.txdats"></a><a id="2194" href="Ledger.Conway.Specification.Script.Validation.html#2194" class="Field">txdats</a>         <a id="2209" class="Symbol">:</a> <a id="2211" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2213" href="Ledger.Core.Specification.Script.Base.html#1768" class="Function">Datum</a>
        <a id="TxInfo.txId"></a><a id="2227" href="Ledger.Conway.Specification.Script.Validation.html#2227" class="Field">txId</a>           <a id="2242" class="Symbol">:</a> <a id="2244" href="Ledger.Core.Specification.Transaction.html#948" class="Field">TxId</a>

<a id="txInfo"></a><a id="2250" href="Ledger.Conway.Specification.Script.Validation.html#2250" class="Function">txInfo</a> <a id="2257" class="Symbol">:</a> <a id="2259" href="Ledger.Core.Specification.Script.Base.html#965" class="Function">Language</a> <a id="2268" class="Symbol">→</a> <a id="2270" href="Ledger.Conway.Specification.PParams.html#1687" class="Record">PParams</a>
                  <a id="2296" class="Symbol">→</a> <a id="2298" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a>
                  <a id="2321" class="Symbol">→</a> <a id="2323" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a>
                  <a id="2344" class="Symbol">→</a> <a id="2346" href="Ledger.Conway.Specification.Script.Validation.html#1881" class="Record">TxInfo</a>
<a id="2353" href="Ledger.Conway.Specification.Script.Validation.html#2250" class="Function">txInfo</a> <a id="2360" href="Ledger.Conway.Specification.Script.Validation.html#2360" class="Bound">l</a> <a id="2362" href="Ledger.Conway.Specification.Script.Validation.html#2362" class="Bound">pp</a> <a id="2365" href="Ledger.Conway.Specification.Script.Validation.html#2365" class="Bound">utxo</a> <a id="2370" href="Ledger.Conway.Specification.Script.Validation.html#2370" class="Bound">tx</a> <a id="2373" class="Symbol">=</a> <a id="2375" class="Keyword">record</a>
  <a id="2384" class="Symbol">{</a> <a id="2386" href="Ledger.Conway.Specification.Script.Validation.html#2386" class="Module">TxBody</a> <a id="2393" href="Ledger.Conway.Specification.Transaction.html#1747" class="Field">body</a>
  <a id="2400" class="Symbol">;</a> <a id="2402" href="Ledger.Conway.Specification.Script.Validation.html#2402" class="Module">TxWitnesses</a> <a id="2414" href="Ledger.Conway.Specification.Transaction.html#1769" class="Field">wits</a>
  <a id="2421" class="Symbol">;</a> <a id="2423" href="Ledger.Conway.Specification.Script.Validation.html#1909" class="Field">realizedInputs</a> <a id="2438" class="Symbol">=</a> <a id="2440" href="Ledger.Conway.Specification.Script.Validation.html#2365" class="Bound">utxo</a> <a id="2445" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="2447" href="Ledger.Conway.Specification.Transaction.html#382" class="Function">txIns</a>
  <a id="2455" class="Symbol">;</a> <a id="2457" href="Ledger.Conway.Specification.Script.Validation.html#1975" class="Field">fee</a> <a id="2461" class="Symbol">=</a> <a id="2463" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a> <a id="2470" href="Ledger.Conway.Specification.Transaction.html#592" class="Function">txFee</a>
  <a id="2478" class="Symbol">;</a> <a id="2480" href="Ledger.Conway.Specification.Script.Validation.html#2006" class="Field">mint</a> <a id="2485" class="Symbol">=</a> <a id="2487" href="Ledger.Conway.Specification.Transaction.html#958" class="Function">mint</a>
  <a id="2494" class="Symbol">;</a> <a id="2496" href="Ledger.Conway.Specification.Script.Validation.html#2159" class="Field">vkKey</a> <a id="2502" class="Symbol">=</a> <a id="2504" href="Ledger.Conway.Specification.Transaction.html#991" class="Function">reqSignerHashes</a>
  <a id="2522" class="Symbol">}</a> <a id="2524" class="Keyword">where</a> <a id="2530" class="Keyword">open</a> <a id="2535" href="Ledger.Conway.Specification.Transaction.html#1719" class="Module">Tx</a> <a id="2538" href="Ledger.Conway.Specification.Script.Validation.html#2370" class="Bound">tx</a><a id="2540" class="Symbol">;</a> <a id="2542" class="Keyword">open</a> <a id="2547" href="Ledger.Conway.Specification.Transaction.html#350" class="Module">TxBody</a> <a id="2554" href="Ledger.Conway.Specification.Transaction.html#1747" class="Field">body</a>

<a id="credsNeeded"></a><a id="2560" href="Ledger.Conway.Specification.Script.Validation.html#2560" class="Function">credsNeeded</a> <a id="2572" class="Symbol">:</a> <a id="2574" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="2579" class="Symbol">→</a> <a id="2581" href="Ledger.Conway.Specification.Transaction.html#350" class="Record">TxBody</a> <a id="2588" class="Symbol">→</a> <a id="2590" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2592" class="Symbol">(</a><a id="2593" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a> <a id="2607" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2609" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="2619" class="Symbol">)</a>
<a id="2621" href="Ledger.Conway.Specification.Script.Validation.html#2560" class="Function">credsNeeded</a> <a id="2633" href="Ledger.Conway.Specification.Script.Validation.html#2633" class="Bound">utxo</a> <a id="2638" href="Ledger.Conway.Specification.Script.Validation.html#2638" class="Bound">txb</a>
  <a id="2644" class="Symbol">=</a>  <a id="2647" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2652" class="Symbol">(λ</a> <a id="2655" class="Symbol">(</a><a id="2656" href="Ledger.Conway.Specification.Script.Validation.html#2656" class="Bound">i</a> <a id="2658" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2660" href="Ledger.Conway.Specification.Script.Validation.html#2660" class="Bound">o</a><a id="2661" class="Symbol">)</a>  <a id="2664" class="Symbol">→</a> <a id="2666" class="Symbol">(</a><a id="2667" href="Ledger.Conway.Specification.Script.Validation.html#641" class="InductiveConstructor">Spend</a>  <a id="2674" href="Ledger.Conway.Specification.Script.Validation.html#2656" class="Bound">i</a> <a id="2676" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2678" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="2686" class="Symbol">(</a><a id="2687" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2693" href="Ledger.Conway.Specification.Script.Validation.html#2660" class="Bound">o</a><a id="2694" class="Symbol">)))</a> <a id="2698" class="Symbol">((</a><a id="2700" href="Ledger.Conway.Specification.Script.Validation.html#2633" class="Bound">utxo</a> <a id="2705" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="2707" class="Symbol">(</a><a id="2708" href="Ledger.Conway.Specification.Transaction.html#382" class="Field">txIns</a> <a id="2714" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="2716" href="Ledger.Conway.Specification.Transaction.html#450" class="Field">collateralInputs</a><a id="2732" class="Symbol">))</a> <a id="2735" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2736" class="Symbol">)</a>
  <a id="2740" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2743" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2748" class="Symbol">(λ</a> <a id="2751" href="Ledger.Conway.Specification.Script.Validation.html#2751" class="Bound">a</a>        <a id="2760" class="Symbol">→</a> <a id="2762" class="Symbol">(</a><a id="2763" href="Ledger.Conway.Specification.Script.Validation.html#557" class="InductiveConstructor">Rwrd</a>   <a id="2770" href="Ledger.Conway.Specification.Script.Validation.html#2751" class="Bound">a</a> <a id="2772" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2774" href="Ledger.Core.Specification.Address.html#1367" class="Field">stake</a> <a id="2780" href="Ledger.Conway.Specification.Script.Validation.html#2751" class="Bound">a</a><a id="2781" class="Symbol">))</a> <a id="2784" class="Symbol">(</a><a id="2785" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2789" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2791" href="Ledger.Conway.Specification.Transaction.html#624" class="Field">txWithdrawals</a> <a id="2805" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a><a id="2806" class="Symbol">)</a>
  <a id="2810" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2813" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2824" class="Symbol">(λ</a> <a id="2827" href="Ledger.Conway.Specification.Script.Validation.html#2827" class="Bound">c</a>  <a id="2830" class="Symbol">→</a> <a id="2832" class="Symbol">(</a><a id="2833" href="Ledger.Conway.Specification.Script.Validation.html#515" class="InductiveConstructor">Cert</a>   <a id="2840" href="Ledger.Conway.Specification.Script.Validation.html#2827" class="Bound">c</a> <a id="2842" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2844" class="Symbol">)</a> <a id="2846" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2850" href="Ledger.Core.Specification.Certs.html#2979" class="Function">cwitness</a> <a id="2859" href="Ledger.Conway.Specification.Script.Validation.html#2827" class="Bound">c</a><a id="2860" class="Symbol">)</a> <a id="2862" class="Symbol">(</a><a id="2863" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2872" href="Ledger.Conway.Specification.Transaction.html#554" class="Field">txCerts</a><a id="2879" class="Symbol">)</a>
  <a id="2883" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2886" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2891" class="Symbol">(λ</a> <a id="2894" href="Ledger.Conway.Specification.Script.Validation.html#2894" class="Bound">x</a>        <a id="2903" class="Symbol">→</a> <a id="2905" class="Symbol">(</a><a id="2906" href="Ledger.Conway.Specification.Script.Validation.html#599" class="InductiveConstructor">Mint</a>   <a id="2913" href="Ledger.Conway.Specification.Script.Validation.html#2894" class="Bound">x</a> <a id="2915" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2917" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2927" href="Ledger.Conway.Specification.Script.Validation.html#2894" class="Bound">x</a><a id="2928" class="Symbol">))</a> <a id="2931" class="Symbol">(</a><a id="2932" href="Ledger.Core.Specification.TokenAlgebra.Base.html#925" class="Function">policies</a> <a id="2941" href="Ledger.Conway.Specification.Transaction.html#958" class="Field">mint</a><a id="2945" class="Symbol">)</a>
  <a id="2949" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2952" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2963" class="Symbol">(λ</a> <a id="2966" href="Ledger.Conway.Specification.Script.Validation.html#2966" class="Bound">v</a> <a id="2968" class="Symbol">→</a> <a id="2970" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2973" href="Ledger.Core.Specification.Gov.Actions.html#6696" class="Function">isGovVoterCredential</a> <a id="2994" href="Ledger.Conway.Specification.Script.Validation.html#2966" class="Bound">v</a> <a id="2996" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3001" class="Symbol">(λ</a> <a id="3004" class="Symbol">{</a><a id="3005" href="Ledger.Conway.Specification.Script.Validation.html#3005" class="Bound">c</a><a id="3006" class="Symbol">}</a> <a id="3008" class="Symbol">→</a> <a id="3010" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3015" class="Symbol">(</a><a id="3016" href="Ledger.Conway.Specification.Script.Validation.html#683" class="InductiveConstructor">Vote</a> <a id="3021" href="Ledger.Conway.Specification.Script.Validation.html#2966" class="Bound">v</a> <a id="3023" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3025" href="Ledger.Conway.Specification.Script.Validation.html#3005" class="Bound">c</a><a id="3026" class="Symbol">))</a> <a id="3029" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3034" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3041" class="Symbol">)</a>
                <a id="3059" class="Symbol">(</a><a id="3060" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="3069" class="Symbol">(</a><a id="3070" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3074" href="Ledger.Core.Specification.Gov.Actions.html#2352" class="Field">voter</a> <a id="3080" href="Ledger.Conway.Specification.Transaction.html#791" class="Field">txGovVotes</a><a id="3090" class="Symbol">))</a>
  <a id="3095" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="3098" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3109" class="Symbol">(λ</a> <a id="3112" href="Ledger.Conway.Specification.Script.Validation.html#3112" class="Bound">p</a> <a id="3114" class="Symbol">→</a> <a id="3116" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3119" href="Ledger.Conway.Specification.Script.Validation.html#3112" class="Bound">p</a> <a id="3121" class="Symbol">.</a><a id="3122" href="Ledger.Core.Specification.Gov.Actions.html#3707" class="Field">policy</a> <a id="3129" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3134" class="Symbol">(λ</a> <a id="3137" class="Symbol">{</a><a id="3138" href="Ledger.Conway.Specification.Script.Validation.html#3138" class="Bound">sh</a><a id="3140" class="Symbol">}</a> <a id="3142" class="Symbol">→</a> <a id="3144" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3149" class="Symbol">(</a><a id="3150" href="Ledger.Conway.Specification.Script.Validation.html#725" class="InductiveConstructor">Propose</a>  <a id="3159" href="Ledger.Conway.Specification.Script.Validation.html#3112" class="Bound">p</a> <a id="3161" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3163" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="3173" href="Ledger.Conway.Specification.Script.Validation.html#3138" class="Bound">sh</a><a id="3175" class="Symbol">))</a> <a id="3178" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3183" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3190" class="Symbol">)</a>
                <a id="3208" class="Symbol">(</a><a id="3209" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="3218" href="Ledger.Conway.Specification.Transaction.html#831" class="Field">txGovProposals</a><a id="3232" class="Symbol">)</a>


  <a id="3238" class="Keyword">where</a> <a id="3244" class="Keyword">open</a> <a id="3249" href="Ledger.Conway.Specification.Transaction.html#350" class="Module">TxBody</a> <a id="3256" href="Ledger.Conway.Specification.Script.Validation.html#2638" class="Bound">txb</a><a id="3259" class="Symbol">;</a> <a id="3261" class="Keyword">open</a> <a id="3266" href="Ledger.Core.Specification.Gov.Actions.html#2289" class="Module">GovVote</a><a id="3273" class="Symbol">;</a> <a id="3275" class="Keyword">open</a> <a id="3280" href="Ledger.Core.Specification.Address.html#1313" class="Module">RwdAddr</a><a id="3287" class="Symbol">;</a> <a id="3289" class="Keyword">open</a> <a id="3294" href="Ledger.Core.Specification.Gov.Actions.html#3598" class="Module">GovProposal</a>

<a id="valContext"></a><a id="3307" href="Ledger.Conway.Specification.Script.Validation.html#3307" class="Function">valContext</a> <a id="3318" class="Symbol">:</a> <a id="3320" href="Ledger.Conway.Specification.Script.Validation.html#1881" class="Record">TxInfo</a> <a id="3327" class="Symbol">→</a> <a id="3329" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a> <a id="3343" class="Symbol">→</a> <a id="3345" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a>
<a id="3350" href="Ledger.Conway.Specification.Script.Validation.html#3307" class="Function">valContext</a> <a id="3361" href="Ledger.Conway.Specification.Script.Validation.html#3361" class="Bound">txinfo</a> <a id="3368" href="Ledger.Conway.Specification.Script.Validation.html#3368" class="Bound">sp</a> <a id="3371" class="Symbol">=</a> <a id="3373" href="Ledger.Core.Specification.Script.Base.html#2005" class="Function">toData</a> <a id="3380" class="Symbol">(</a><a id="3381" href="Ledger.Conway.Specification.Script.Validation.html#3361" class="Bound">txinfo</a> <a id="3388" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3390" href="Ledger.Conway.Specification.Script.Validation.html#3368" class="Bound">sp</a><a id="3392" class="Symbol">)</a>

<a id="txOutToDataHash"></a><a id="3395" href="Ledger.Conway.Specification.Script.Validation.html#3395" class="Function">txOutToDataHash</a> <a id="3411" class="Symbol">:</a> <a id="3413" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="3419" class="Symbol">→</a> <a id="3421" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3427" href="Ledger.Core.Specification.Script.Base.html#1721" class="Function">DataHash</a>
<a id="3436" href="Ledger.Conway.Specification.Script.Validation.html#3395" class="Function">txOutToDataHash</a> <a id="3452" class="Symbol">(_</a> <a id="3455" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3457" class="Symbol">_</a> <a id="3459" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3461" href="Ledger.Conway.Specification.Script.Validation.html#3461" class="Bound">d</a> <a id="3463" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3465" class="Symbol">_)</a> <a id="3468" class="Symbol">=</a> <a id="3470" href="Ledger.Conway.Specification.Script.Validation.html#3461" class="Bound">d</a> <a id="3472" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="3476" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="3484" href="Ledger.Conway.Specification.Script.Validation.html#3484" class="Function">txOutToP2Script</a>
  <a id="3502" class="Symbol">:</a> <a id="3504" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="3509" class="Symbol">→</a> <a id="3511" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a>
  <a id="3516" class="Symbol">→</a> <a id="3518" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="3524" class="Symbol">→</a> <a id="3526" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3532" href="Ledger.Core.Specification.Script.Base.html#2363" class="Function">P2Script</a>
<a id="3541" href="Ledger.Conway.Specification.Script.Validation.html#3484" class="Function">txOutToP2Script</a> <a id="3557" href="Ledger.Conway.Specification.Script.Validation.html#3557" class="Bound">utxo</a> <a id="3562" href="Ledger.Conway.Specification.Script.Validation.html#3562" class="Bound">tx</a> <a id="3565" class="Symbol">(</a><a id="3566" href="Ledger.Conway.Specification.Script.Validation.html#3566" class="Bound">a</a> <a id="3568" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3570" class="Symbol">_)</a> <a id="3573" class="Symbol">=</a>
  <a id="3577" class="Keyword">do</a> <a id="3580" href="Ledger.Conway.Specification.Script.Validation.html#3580" class="Bound">sh</a> <a id="3583" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3585" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3597" class="Symbol">(</a><a id="3598" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="3606" href="Ledger.Conway.Specification.Script.Validation.html#3566" class="Bound">a</a><a id="3607" class="Symbol">)</a>
     <a id="3614" href="Ledger.Conway.Specification.Script.Validation.html#3614" class="Bound">s</a>  <a id="3617" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3619" href="Ledger.Conway.Specification.Transaction.html#2893" class="Function">lookupScriptHash</a> <a id="3636" href="Ledger.Conway.Specification.Script.Validation.html#3580" class="Bound">sh</a> <a id="3639" href="Ledger.Conway.Specification.Script.Validation.html#3562" class="Bound">tx</a> <a id="3642" href="Ledger.Conway.Specification.Script.Validation.html#3557" class="Bound">utxo</a>
     <a id="3652" href="Ledger.Core.Specification.Script.Base.html#3216" class="Function">toP2Script</a> <a id="3663" href="Ledger.Conway.Specification.Script.Validation.html#3614" class="Bound">s</a>

<a id="3666" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3675" href="Ledger.Conway.Specification.Script.Validation.html#3675" class="Function">collectP2ScriptsWithContext</a>
    <a id="3707" class="Symbol">:</a> <a id="3709" href="Ledger.Conway.Specification.PParams.html#1687" class="Record">PParams</a> <a id="3717" class="Symbol">→</a> <a id="3719" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="3722" class="Symbol">→</a> <a id="3724" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a>
    <a id="3733" class="Symbol">→</a> <a id="3735" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3740" class="Symbol">(</a><a id="3741" href="Ledger.Core.Specification.Script.Base.html#2363" class="Function">P2Script</a> <a id="3750" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3752" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3757" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="3762" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3764" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="3772" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3774" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="3783" class="Symbol">)</a>
  <a id="3787" href="Ledger.Conway.Specification.Script.Validation.html#3675" class="Function">collectP2ScriptsWithContext</a> <a id="3815" href="Ledger.Conway.Specification.Script.Validation.html#3815" class="Bound">pp</a> <a id="3818" href="Ledger.Conway.Specification.Script.Validation.html#3818" class="Bound">tx</a> <a id="3821" href="Ledger.Conway.Specification.Script.Validation.html#3821" class="Bound">utxo</a>
    <a id="3830" class="Symbol">=</a> <a id="3832" href="abstract-set-theory.FiniteSetTheory.html#2556" class="Function">setToList</a>
    <a id="3846" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3848" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3859" class="Symbol">(λ</a> <a id="3862" class="Symbol">(</a><a id="3863" href="Ledger.Conway.Specification.Script.Validation.html#3863" class="Bound">sp</a> <a id="3866" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3868" href="Ledger.Conway.Specification.Script.Validation.html#3868" class="Bound">c</a><a id="3869" class="Symbol">)</a> <a id="3871" class="Symbol">→</a> <a id="3873" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3876" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3888" href="Ledger.Conway.Specification.Script.Validation.html#3868" class="Bound">c</a>
                                <a id="3922" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3927" class="Symbol">(λ</a> <a id="3930" class="Symbol">{</a><a id="3931" href="Ledger.Conway.Specification.Script.Validation.html#3931" class="Bound">sh</a><a id="3933" class="Symbol">}</a> <a id="3935" class="Symbol">→</a> <a id="3937" href="Ledger.Conway.Specification.Script.Validation.html#4057" class="Function">toScriptInput</a> <a id="3951" href="Ledger.Conway.Specification.Script.Validation.html#3863" class="Bound">sp</a> <a id="3954" href="Ledger.Conway.Specification.Script.Validation.html#3931" class="Bound">sh</a><a id="3956" class="Symbol">)</a>
                                <a id="3990" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3995" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="4002" class="Symbol">)</a>
    <a id="4008" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="4010" href="Ledger.Conway.Specification.Script.Validation.html#2560" class="Function">credsNeeded</a> <a id="4022" href="Ledger.Conway.Specification.Script.Validation.html#3821" class="Bound">utxo</a> <a id="4027" class="Symbol">(</a><a id="4028" href="Ledger.Conway.Specification.Script.Validation.html#3818" class="Bound">tx</a> <a id="4031" class="Symbol">.</a><a id="4032" href="Ledger.Conway.Specification.Transaction.html#1747" class="Field">Tx.body</a><a id="4039" class="Symbol">)</a>
    <a id="4045" class="Keyword">where</a>
      <a id="4057" href="Ledger.Conway.Specification.Script.Validation.html#4057" class="Function">toScriptInput</a>
        <a id="4079" class="Symbol">:</a> <a id="4081" href="Ledger.Conway.Specification.Script.Validation.html#486" class="Datatype">ScriptPurpose</a> <a id="4095" class="Symbol">→</a> <a id="4097" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
        <a id="4116" class="Symbol">→</a> <a id="4118" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4124" class="Symbol">(</a><a id="4125" href="Ledger.Core.Specification.Script.Base.html#2363" class="Function">P2Script</a> <a id="4134" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4136" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4141" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="4146" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4148" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="4156" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4158" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="4167" class="Symbol">)</a>
      <a id="4175" href="Ledger.Conway.Specification.Script.Validation.html#4057" class="Function">toScriptInput</a> <a id="4189" href="Ledger.Conway.Specification.Script.Validation.html#4189" class="Bound">sp</a> <a id="4192" href="Ledger.Conway.Specification.Script.Validation.html#4192" class="Bound">sh</a> <a id="4195" class="Symbol">=</a>
        <a id="4205" class="Keyword">do</a> <a id="4208" href="Ledger.Conway.Specification.Script.Validation.html#4208" class="Bound">s</a> <a id="4210" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4212" href="Ledger.Conway.Specification.Transaction.html#2893" class="Function">lookupScriptHash</a> <a id="4229" href="Ledger.Conway.Specification.Script.Validation.html#4192" class="Bound">sh</a> <a id="4232" href="Ledger.Conway.Specification.Script.Validation.html#3818" class="Bound">tx</a> <a id="4235" href="Ledger.Conway.Specification.Script.Validation.html#3821" class="Bound">utxo</a>
           <a id="4251" href="Ledger.Conway.Specification.Script.Validation.html#4251" class="Bound">p2s</a> <a id="4255" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4257" href="Ledger.Core.Specification.Script.Base.html#3216" class="Function">toP2Script</a> <a id="4268" href="Ledger.Conway.Specification.Script.Validation.html#4208" class="Bound">s</a>
           <a id="4281" class="Symbol">(</a><a id="4282" href="Ledger.Conway.Specification.Script.Validation.html#4282" class="Bound">rdmr</a> <a id="4287" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4289" href="Ledger.Conway.Specification.Script.Validation.html#4289" class="Bound">exunits</a><a id="4296" class="Symbol">)</a> <a id="4298" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4300" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="Function">indexedRdmrs</a> <a id="4313" href="Ledger.Conway.Specification.Script.Validation.html#3818" class="Bound">tx</a> <a id="4316" href="Ledger.Conway.Specification.Script.Validation.html#4189" class="Bound">sp</a>
           <a id="4330" class="Keyword">let</a> <a id="4334" href="Ledger.Conway.Specification.Script.Validation.html#4334" class="Bound">data&#39;</a>     <a id="4344" class="Symbol">=</a> <a id="4346" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="4352" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="4356" class="InductiveConstructor">[]</a> <a id="4359" class="Symbol">(</a><a id="4360" href="Ledger.Conway.Specification.Script.Validation.html#1456" class="Function">getDatum</a> <a id="4369" href="Ledger.Conway.Specification.Script.Validation.html#3818" class="Bound">tx</a> <a id="4372" href="Ledger.Conway.Specification.Script.Validation.html#3821" class="Bound">utxo</a> <a id="4377" href="Ledger.Conway.Specification.Script.Validation.html#4189" class="Bound">sp</a><a id="4379" class="Symbol">)</a> <a id="4381" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="4384" href="Ledger.Conway.Specification.Script.Validation.html#4282" class="Bound">rdmr</a> <a id="4389" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4391" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="4393" href="Ledger.Conway.Specification.Script.Validation.html#3307" class="Function">valContext</a> <a id="4404" class="Symbol">(</a><a id="4405" href="Ledger.Conway.Specification.Script.Validation.html#2250" class="Function">txInfo</a> <a id="4412" class="Symbol">(</a><a id="4413" href="Ledger.Core.Specification.Script.Base.html#1962" class="Function">language</a> <a id="4422" href="Ledger.Conway.Specification.Script.Validation.html#4251" class="Bound">p2s</a><a id="4425" class="Symbol">)</a> <a id="4427" href="Ledger.Conway.Specification.Script.Validation.html#3815" class="Bound">pp</a> <a id="4430" href="Ledger.Conway.Specification.Script.Validation.html#3821" class="Bound">utxo</a> <a id="4435" href="Ledger.Conway.Specification.Script.Validation.html#3818" class="Bound">tx</a><a id="4437" class="Symbol">)</a> <a id="4439" href="Ledger.Conway.Specification.Script.Validation.html#4189" class="Bound">sp</a> <a id="4442" href="Data.List.Base.html#4907" class="Function Operator">]</a>
               <a id="4459" href="Ledger.Conway.Specification.Script.Validation.html#4459" class="Bound">costModel</a> <a id="4469" class="Symbol">=</a> <a id="4471" href="Ledger.Conway.Specification.PParams.html#3066" class="Field">PParams.costmdls</a> <a id="4488" href="Ledger.Conway.Specification.Script.Validation.html#3815" class="Bound">pp</a>
           <a id="4502" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4507" class="Symbol">(</a><a id="4508" href="Ledger.Conway.Specification.Script.Validation.html#4251" class="Bound">p2s</a> <a id="4512" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4514" href="Ledger.Conway.Specification.Script.Validation.html#4334" class="Bound">data&#39;</a> <a id="4520" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4522" href="Ledger.Conway.Specification.Script.Validation.html#4289" class="Bound">exunits</a> <a id="4530" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4532" href="Ledger.Conway.Specification.Script.Validation.html#4459" class="Bound">costModel</a><a id="4541" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="4544" href="Ledger.Conway.Specification.Script.Validation.html#4544" class="Function">evalP2Scripts</a> <a id="4558" class="Symbol">:</a> <a id="4560" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4565" class="Symbol">(</a><a id="4566" href="Ledger.Core.Specification.Script.Base.html#2363" class="Function">P2Script</a> <a id="4575" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4577" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4582" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="4587" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4589" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="4597" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4599" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="4608" class="Symbol">)</a> <a id="4610" class="Symbol">→</a> <a id="4612" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4617" href="Ledger.Conway.Specification.Script.Validation.html#4544" class="Function">evalP2Scripts</a> <a id="4631" class="Symbol">=</a> <a id="4633" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="4637" class="Symbol">(λ</a> <a id="4640" class="Symbol">(</a><a id="4641" href="Ledger.Conway.Specification.Script.Validation.html#4641" class="Bound">s</a> <a id="4643" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4645" href="Ledger.Conway.Specification.Script.Validation.html#4645" class="Bound">d</a> <a id="4647" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4649" href="Ledger.Conway.Specification.Script.Validation.html#4649" class="Bound">eu</a> <a id="4652" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4654" href="Ledger.Conway.Specification.Script.Validation.html#4654" class="Bound">cm</a><a id="4656" class="Symbol">)</a> <a id="4658" class="Symbol">→</a> <a id="4660" href="Ledger.Core.Specification.Abstract.html#814" class="Field">runPLCScript</a> <a id="4673" href="Ledger.Conway.Specification.Script.Validation.html#4654" class="Bound">cm</a> <a id="4676" href="Ledger.Conway.Specification.Script.Validation.html#4641" class="Bound">s</a> <a id="4678" href="Ledger.Conway.Specification.Script.Validation.html#4649" class="Bound">eu</a> <a id="4681" href="Ledger.Conway.Specification.Script.Validation.html#4645" class="Bound">d</a><a id="4682" class="Symbol">)</a>

</pre></body></html>