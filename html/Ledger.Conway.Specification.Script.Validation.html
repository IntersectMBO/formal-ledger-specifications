<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>
<a id="76" class="Keyword">open</a> <a id="81" class="Keyword">import</a> <a id="88" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>

<a id="126" class="Keyword">module</a> <a id="133" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="181" class="Symbol">(</a><a id="182" href="Ledger.Conway.Specification.Script.Validation.html#182" class="Bound">txs</a> <a id="186" class="Symbol">:</a> <a id="188" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="208" class="Symbol">)</a> <a id="210" class="Symbol">(</a><a id="211" class="Keyword">open</a> <a id="216" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="237" href="Ledger.Conway.Specification.Script.Validation.html#182" class="Bound">txs</a><a id="240" class="Symbol">)</a>
  <a id="244" class="Symbol">(</a><a id="245" href="Ledger.Conway.Specification.Script.Validation.html#245" class="Bound">abs</a> <a id="249" class="Symbol">:</a> <a id="251" href="Ledger.Conway.Specification.Abstract.html#653" class="Record">AbstractFunctions</a> <a id="269" href="Ledger.Conway.Specification.Script.Validation.html#182" class="Bound">txs</a><a id="272" class="Symbol">)</a>
  <a id="276" class="Keyword">where</a>

<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="310" class="Keyword">open</a> <a id="315" class="Keyword">import</a> <a id="322" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="356" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="421" href="Ledger.Conway.Specification.Script.Validation.html#182" class="Bound">txs</a> <a id="425" href="Ledger.Conway.Specification.Script.Validation.html#245" class="Bound">abs</a>

<a id="430" class="Keyword">open</a> <a id="435" href="Ledger.Conway.Specification.Abstract.html#653" class="Module">AbstractFunctions</a> <a id="453" href="Ledger.Conway.Specification.Script.Validation.html#245" class="Bound">abs</a>
<a id="457" class="Keyword">open</a> <a id="462" href="Ledger.Conway.Specification.Abstract.html#281" class="Module">indexOf</a> <a id="470" href="Ledger.Conway.Specification.Abstract.html#785" class="Field">indexOfImp</a>


<a id="483" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="488" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a> <a id="502" class="Symbol">:</a> <a id="504" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="509" class="Keyword">where</a>
  <a id="ScriptPurpose.Cert"></a><a id="517" href="Ledger.Conway.Specification.Script.Validation.html#517" class="InductiveConstructor">Cert</a>     <a id="526" class="Symbol">:</a> <a id="528" href="Ledger.Conway.Specification.Certs.html#2251" class="Datatype">DCert</a>        <a id="541" class="Symbol">→</a> <a id="543" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Rwrd"></a><a id="559" href="Ledger.Conway.Specification.Script.Validation.html#559" class="InductiveConstructor">Rwrd</a>     <a id="568" class="Symbol">:</a> <a id="570" href="Ledger.Core.Specification.Address.html#1313" class="Record">RwdAddr</a>      <a id="583" class="Symbol">→</a> <a id="585" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Mint"></a><a id="601" href="Ledger.Conway.Specification.Script.Validation.html#601" class="InductiveConstructor">Mint</a>     <a id="610" class="Symbol">:</a> <a id="612" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>   <a id="625" class="Symbol">→</a> <a id="627" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Spend"></a><a id="643" href="Ledger.Conway.Specification.Script.Validation.html#643" class="InductiveConstructor">Spend</a>    <a id="652" class="Symbol">:</a> <a id="654" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a>         <a id="667" class="Symbol">→</a> <a id="669" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Vote"></a><a id="685" href="Ledger.Conway.Specification.Script.Validation.html#685" class="InductiveConstructor">Vote</a>     <a id="694" class="Symbol">:</a> <a id="696" href="Ledger.Core.Specification.Gov.Actions.html#2077" class="Record">GovVoter</a>     <a id="709" class="Symbol">→</a> <a id="711" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Propose"></a><a id="727" href="Ledger.Conway.Specification.Script.Validation.html#727" class="InductiveConstructor">Propose</a>  <a id="736" class="Symbol">:</a> <a id="738" href="Ledger.Core.Specification.Gov.Actions.html#3598" class="Record">GovProposal</a>  <a id="751" class="Symbol">→</a> <a id="753" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a>


<a id="rdptr"></a><a id="769" href="Ledger.Conway.Specification.Script.Validation.html#769" class="Function">rdptr</a> <a id="775" class="Symbol">:</a> <a id="777" href="Ledger.Conway.Specification.Transaction.html#352" class="Record">TxBody</a> <a id="784" class="Symbol">→</a> <a id="786" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a> <a id="800" class="Symbol">→</a> <a id="802" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="808" href="Ledger.Core.Specification.Transaction.html#2643" class="Function">RdmrPtr</a>
<a id="816" href="Ledger.Conway.Specification.Script.Validation.html#769" class="Function">rdptr</a> <a id="822" href="Ledger.Conway.Specification.Script.Validation.html#822" class="Bound">txb</a> <a id="826" class="Symbol">=</a> <a id="828" class="Symbol">λ</a> <a id="830" class="Keyword">where</a>
  <a id="838" class="Symbol">(</a><a id="839" href="Ledger.Conway.Specification.Script.Validation.html#517" class="InductiveConstructor">Cert</a> <a id="844" href="Ledger.Conway.Specification.Script.Validation.html#844" class="Bound">h</a><a id="845" class="Symbol">)</a>     <a id="851" class="Symbol">→</a> <a id="853" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="857" class="Symbol">(</a><a id="858" href="Ledger.Core.Specification.Transaction.html#789" class="InductiveConstructor">Cert</a>    <a id="866" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="868" class="Symbol">)</a> <a id="870" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="872" href="Ledger.Conway.Specification.Abstract.html#314" class="Function">indexOfDCert</a>    <a id="888" href="Ledger.Conway.Specification.Script.Validation.html#844" class="Bound">h</a> <a id="890" href="Ledger.Conway.Specification.Transaction.html#556" class="Field">txCerts</a>
  <a id="900" class="Symbol">(</a><a id="901" href="Ledger.Conway.Specification.Script.Validation.html#559" class="InductiveConstructor">Rwrd</a> <a id="906" href="Ledger.Conway.Specification.Script.Validation.html#906" class="Bound">h</a><a id="907" class="Symbol">)</a>     <a id="913" class="Symbol">→</a> <a id="915" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="919" class="Symbol">(</a><a id="920" href="Ledger.Core.Specification.Transaction.html#794" class="InductiveConstructor">Rewrd</a>   <a id="928" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="930" class="Symbol">)</a> <a id="932" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="934" href="Ledger.Conway.Specification.Abstract.html#366" class="Function">indexOfRwdAddr</a>  <a id="950" href="Ledger.Conway.Specification.Script.Validation.html#906" class="Bound">h</a> <a id="952" href="Ledger.Conway.Specification.Transaction.html#626" class="Field">txWithdrawals</a>
  <a id="968" class="Symbol">(</a><a id="969" href="Ledger.Conway.Specification.Script.Validation.html#601" class="InductiveConstructor">Mint</a> <a id="974" href="Ledger.Conway.Specification.Script.Validation.html#974" class="Bound">h</a><a id="975" class="Symbol">)</a>     <a id="981" class="Symbol">→</a> <a id="983" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="987" class="Symbol">(</a><a id="988" href="Ledger.Core.Specification.Transaction.html#784" class="InductiveConstructor">Mint</a>    <a id="996" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="998" class="Symbol">)</a> <a id="1000" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1002" href="Ledger.Conway.Specification.Abstract.html#468" class="Function">indexOfPolicyId</a> <a id="1018" href="Ledger.Conway.Specification.Script.Validation.html#974" class="Bound">h</a> <a id="1020" class="Symbol">(</a><a id="1021" href="Ledger.Core.Specification.TokenAlgebra.Base.html#925" class="Function">policies</a> <a id="1030" href="Ledger.Conway.Specification.Transaction.html#960" class="Field">mint</a><a id="1034" class="Symbol">)</a>
  <a id="1038" class="Symbol">(</a><a id="1039" href="Ledger.Conway.Specification.Script.Validation.html#643" class="InductiveConstructor">Spend</a> <a id="1045" href="Ledger.Conway.Specification.Script.Validation.html#1045" class="Bound">h</a><a id="1046" class="Symbol">)</a>    <a id="1051" class="Symbol">→</a> <a id="1053" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1057" class="Symbol">(</a><a id="1058" href="Ledger.Core.Specification.Transaction.html#778" class="InductiveConstructor">Spend</a>   <a id="1066" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1068" class="Symbol">)</a> <a id="1070" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1072" href="Ledger.Conway.Specification.Abstract.html#421" class="Function">indexOfTxIn</a>     <a id="1088" href="Ledger.Conway.Specification.Script.Validation.html#1045" class="Bound">h</a> <a id="1090" href="Ledger.Conway.Specification.Transaction.html#384" class="Field">txIns</a>
  <a id="1098" class="Symbol">(</a><a id="1099" href="Ledger.Conway.Specification.Script.Validation.html#685" class="InductiveConstructor">Vote</a> <a id="1104" href="Ledger.Conway.Specification.Script.Validation.html#1104" class="Bound">h</a><a id="1105" class="Symbol">)</a>     <a id="1111" class="Symbol">→</a> <a id="1113" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1117" class="Symbol">(</a><a id="1118" href="Ledger.Core.Specification.Transaction.html#800" class="InductiveConstructor">Vote</a>    <a id="1126" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1128" class="Symbol">)</a> <a id="1130" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1132" href="Ledger.Conway.Specification.Abstract.html#527" class="Function">indexOfVote</a>     <a id="1148" href="Ledger.Conway.Specification.Script.Validation.html#1104" class="Bound">h</a> <a id="1150" class="Symbol">(</a><a id="1151" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1155" href="Ledger.Core.Specification.Gov.Actions.html#2352" class="Field">GovVote.voter</a> <a id="1169" href="Ledger.Conway.Specification.Transaction.html#793" class="Field">txGovVotes</a><a id="1179" class="Symbol">)</a>
  <a id="1183" class="Symbol">(</a><a id="1184" href="Ledger.Conway.Specification.Script.Validation.html#727" class="InductiveConstructor">Propose</a> <a id="1192" href="Ledger.Conway.Specification.Script.Validation.html#1192" class="Bound">h</a><a id="1193" class="Symbol">)</a>  <a id="1196" class="Symbol">→</a> <a id="1198" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1202" class="Symbol">(</a><a id="1203" href="Ledger.Core.Specification.Transaction.html#805" class="InductiveConstructor">Propose</a> <a id="1211" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1213" class="Symbol">)</a> <a id="1215" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1217" href="Ledger.Conway.Specification.Abstract.html#585" class="Function">indexOfProposal</a> <a id="1233" href="Ledger.Conway.Specification.Script.Validation.html#1192" class="Bound">h</a> <a id="1235" href="Ledger.Conway.Specification.Transaction.html#833" class="Field">txGovProposals</a>
 <a id="1251" class="Keyword">where</a> <a id="1257" class="Keyword">open</a> <a id="1262" href="Ledger.Conway.Specification.Transaction.html#352" class="Module">TxBody</a> <a id="1269" href="Ledger.Conway.Specification.Script.Validation.html#822" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1274" href="Ledger.Conway.Specification.Script.Validation.html#1274" class="Function">indexedRdmrs</a> <a id="1287" class="Symbol">:</a> <a id="1289" href="Ledger.Conway.Specification.Transaction.html#1721" class="Record">Tx</a> <a id="1292" class="Symbol">→</a> <a id="1294" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a> <a id="1308" class="Symbol">→</a> <a id="1310" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1316" class="Symbol">(</a><a id="1317" href="Ledger.Core.Specification.Script.Base.html#1786" class="Function">Redeemer</a> <a id="1326" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1328" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a><a id="1335" class="Symbol">)</a>
<a id="1337" href="Ledger.Conway.Specification.Script.Validation.html#1274" class="Function">indexedRdmrs</a> <a id="1350" href="Ledger.Conway.Specification.Script.Validation.html#1350" class="Bound">tx</a> <a id="1353" href="Ledger.Conway.Specification.Script.Validation.html#1353" class="Bound">sp</a> <a id="1356" class="Symbol">=</a> <a id="1358" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1364" class="Symbol">(λ</a> <a id="1367" href="Ledger.Conway.Specification.Script.Validation.html#1367" class="Bound">x</a> <a id="1369" class="Symbol">→</a> <a id="1371" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1380" href="Ledger.Core.Specification.Transaction.html#3007" class="Function">txrdmrs</a> <a id="1388" href="Ledger.Conway.Specification.Script.Validation.html#1367" class="Bound">x</a><a id="1389" class="Symbol">)</a> <a id="1391" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1399" class="Symbol">(</a><a id="1400" href="Ledger.Conway.Specification.Script.Validation.html#769" class="Function">rdptr</a> <a id="1406" href="Ledger.Conway.Specification.Transaction.html#1749" class="Function">body</a> <a id="1411" href="Ledger.Conway.Specification.Script.Validation.html#1353" class="Bound">sp</a><a id="1413" class="Symbol">)</a>
  <a id="1417" class="Keyword">where</a> <a id="1423" class="Keyword">open</a> <a id="1428" href="Ledger.Conway.Specification.Transaction.html#1721" class="Module">Tx</a> <a id="1431" href="Ledger.Conway.Specification.Script.Validation.html#1350" class="Bound">tx</a><a id="1433" class="Symbol">;</a> <a id="1435" class="Keyword">open</a> <a id="1440" href="Ledger.Core.Specification.Transaction.html#2887" class="Module">TxWitnesses</a> <a id="1452" href="Ledger.Conway.Specification.Transaction.html#1771" class="Function">wits</a>

<a id="getDatum"></a><a id="1458" href="Ledger.Conway.Specification.Script.Validation.html#1458" class="Function">getDatum</a> <a id="1467" class="Symbol">:</a> <a id="1469" href="Ledger.Conway.Specification.Transaction.html#1721" class="Record">Tx</a> <a id="1472" class="Symbol">→</a> <a id="1474" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="1479" class="Symbol">→</a> <a id="1481" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a> <a id="1495" class="Symbol">→</a> <a id="1497" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1503" href="Ledger.Core.Specification.Script.Base.html#1768" class="Function">Datum</a>
<a id="1509" href="Ledger.Conway.Specification.Script.Validation.html#1458" class="Function">getDatum</a> <a id="1518" href="Ledger.Conway.Specification.Script.Validation.html#1518" class="Bound">tx</a> <a id="1521" href="Ledger.Conway.Specification.Script.Validation.html#1521" class="Bound">utxo</a> <a id="1526" class="Symbol">(</a><a id="1527" href="Ledger.Conway.Specification.Script.Validation.html#643" class="InductiveConstructor">Spend</a> <a id="1533" href="Ledger.Conway.Specification.Script.Validation.html#1533" class="Bound">txin</a><a id="1537" class="Symbol">)</a> <a id="1539" class="Symbol">=</a>
  <a id="1543" class="Keyword">do</a> <a id="1546" class="Symbol">(_</a> <a id="1549" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1551" class="Symbol">_</a> <a id="1553" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1555" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1560" href="Ledger.Conway.Specification.Script.Validation.html#1560" class="Bound">d</a> <a id="1562" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1564" class="Symbol">_)</a> <a id="1567" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1569" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1578" href="Ledger.Conway.Specification.Script.Validation.html#1521" class="Bound">utxo</a> <a id="1583" href="Ledger.Conway.Specification.Script.Validation.html#1533" class="Bound">txin</a>
                          <a id="1614" class="Keyword">where</a>
                            <a id="1648" class="Symbol">(_</a> <a id="1651" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1653" class="Symbol">_</a> <a id="1655" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1657" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1665" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1667" class="Symbol">_)</a> <a id="1670" class="Symbol">→</a> <a id="1672" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1685" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1690" href="Ledger.Conway.Specification.Script.Validation.html#1560" class="Bound">d</a> <a id="1692" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1695" class="Symbol">λ</a> <a id="1697" class="Keyword">where</a>
       <a id="1710" class="Symbol">(</a><a id="1711" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1716" href="Ledger.Conway.Specification.Script.Validation.html#1716" class="Bound">d</a><a id="1717" class="Symbol">)</a> <a id="1719" class="Symbol">→</a> <a id="1721" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1726" href="Ledger.Conway.Specification.Script.Validation.html#1716" class="Bound">d</a>
       <a id="1735" class="Symbol">(</a><a id="1736" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1741" href="Ledger.Conway.Specification.Script.Validation.html#1741" class="Bound">h</a><a id="1742" class="Symbol">)</a> <a id="1744" class="Symbol">→</a> <a id="1746" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1755" href="Ledger.Conway.Specification.Script.Validation.html#1777" class="Function">m</a> <a id="1757" href="Ledger.Conway.Specification.Script.Validation.html#1741" class="Bound">h</a>
     <a id="1764" class="Keyword">where</a>
       <a id="1777" href="Ledger.Conway.Specification.Script.Validation.html#1777" class="Function">m</a> <a id="1779" class="Symbol">=</a> <a id="1781" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="1790" class="Symbol">(</a><a id="1791" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1796" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1798" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="1803" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1805" href="Function.Base.html#704" class="Function">id</a> <a id="1808" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1810" class="Symbol">(</a><a id="1811" href="Ledger.Core.Specification.Transaction.html#2982" class="Field">TxWitnesses.txdats</a> <a id="1830" class="Symbol">(</a><a id="1831" href="Ledger.Conway.Specification.Transaction.html#1771" class="Field">Tx.wits</a> <a id="1839" href="Ledger.Conway.Specification.Script.Validation.html#1518" class="Bound">tx</a><a id="1841" class="Symbol">)))</a>
<a id="1845" href="Ledger.Conway.Specification.Script.Validation.html#1458" class="CatchallClause Function">getDatum</a><a id="1853" class="CatchallClause"> </a><a id="1854" href="Ledger.Conway.Specification.Script.Validation.html#1854" class="CatchallClause Bound">tx</a><a id="1856" class="CatchallClause"> </a><a id="1857" href="Ledger.Conway.Specification.Script.Validation.html#1857" class="CatchallClause Bound">utxo</a><a id="1861" class="CatchallClause"> </a><a id="1862" class="CatchallClause Symbol">_</a> <a id="1864" class="Symbol">=</a> <a id="1866" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="1876" class="Keyword">record</a> <a id="TxInfo"></a><a id="1883" href="Ledger.Conway.Specification.Script.Validation.html#1883" class="Record">TxInfo</a> <a id="1890" class="Symbol">:</a> <a id="1892" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1897" class="Keyword">where</a>
  <a id="1905" class="Keyword">field</a> <a id="TxInfo.realizedInputs"></a><a id="1911" href="Ledger.Conway.Specification.Script.Validation.html#1911" class="Field">realizedInputs</a> <a id="1926" class="Symbol">:</a> <a id="1928" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a>
        <a id="TxInfo.txOuts"></a><a id="1941" href="Ledger.Conway.Specification.Script.Validation.html#1941" class="Field">txOuts</a>         <a id="1956" class="Symbol">:</a> <a id="1958" href="Ledger.Core.Specification.Transaction.html#945" class="Field">Ix</a> <a id="1961" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1963" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a>
        <a id="TxInfo.fee"></a><a id="1977" href="Ledger.Conway.Specification.Script.Validation.html#1977" class="Field">fee</a>            <a id="1992" class="Symbol">:</a> <a id="1994" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
        <a id="TxInfo.mint"></a><a id="2008" href="Ledger.Conway.Specification.Script.Validation.html#2008" class="Field">mint</a>           <a id="2023" class="Symbol">:</a> <a id="2025" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
        <a id="TxInfo.txCerts"></a><a id="2039" href="Ledger.Conway.Specification.Script.Validation.html#2039" class="Field">txCerts</a>        <a id="2054" class="Symbol">:</a> <a id="2056" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2061" href="Ledger.Conway.Specification.Certs.html#2251" class="Datatype">DCert</a>
        <a id="TxInfo.txWithdrawals"></a><a id="2075" href="Ledger.Conway.Specification.Script.Validation.html#2075" class="Field">txWithdrawals</a>  <a id="2090" class="Symbol">:</a> <a id="2092" href="Ledger.Core.Specification.Address.html#1388" class="Function">Withdrawals</a>
        <a id="TxInfo.txVldt"></a><a id="2112" href="Ledger.Conway.Specification.Script.Validation.html#2112" class="Field">txVldt</a>         <a id="2127" class="Symbol">:</a> <a id="2129" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2135" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a> <a id="2140" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2142" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2148" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a>
        <a id="TxInfo.vkKey"></a><a id="2161" href="Ledger.Conway.Specification.Script.Validation.html#2161" class="Field">vkKey</a>          <a id="2176" class="Symbol">:</a> <a id="2178" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2180" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
        <a id="TxInfo.txdats"></a><a id="2196" href="Ledger.Conway.Specification.Script.Validation.html#2196" class="Field">txdats</a>         <a id="2211" class="Symbol">:</a> <a id="2213" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2215" href="Ledger.Core.Specification.Script.Base.html#1768" class="Function">Datum</a>
        <a id="TxInfo.txId"></a><a id="2229" href="Ledger.Conway.Specification.Script.Validation.html#2229" class="Field">txId</a>           <a id="2244" class="Symbol">:</a> <a id="2246" href="Ledger.Core.Specification.Transaction.html#948" class="Field">TxId</a>

<a id="txInfo"></a><a id="2252" href="Ledger.Conway.Specification.Script.Validation.html#2252" class="Function">txInfo</a> <a id="2259" class="Symbol">:</a> <a id="2261" href="Ledger.Core.Specification.Script.Base.html#965" class="Function">Language</a> <a id="2270" class="Symbol">→</a> <a id="2272" href="Ledger.Conway.Specification.PParams.html#1687" class="Record">PParams</a>
                  <a id="2298" class="Symbol">→</a> <a id="2300" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a>
                  <a id="2323" class="Symbol">→</a> <a id="2325" href="Ledger.Conway.Specification.Transaction.html#1721" class="Record">Tx</a>
                  <a id="2346" class="Symbol">→</a> <a id="2348" href="Ledger.Conway.Specification.Script.Validation.html#1883" class="Record">TxInfo</a>
<a id="2355" href="Ledger.Conway.Specification.Script.Validation.html#2252" class="Function">txInfo</a> <a id="2362" href="Ledger.Conway.Specification.Script.Validation.html#2362" class="Bound">l</a> <a id="2364" href="Ledger.Conway.Specification.Script.Validation.html#2364" class="Bound">pp</a> <a id="2367" href="Ledger.Conway.Specification.Script.Validation.html#2367" class="Bound">utxo</a> <a id="2372" href="Ledger.Conway.Specification.Script.Validation.html#2372" class="Bound">tx</a> <a id="2375" class="Symbol">=</a> <a id="2377" class="Keyword">record</a>
  <a id="2386" class="Symbol">{</a> <a id="2388" href="Ledger.Conway.Specification.Script.Validation.html#2388" class="Module">TxBody</a> <a id="2395" href="Ledger.Conway.Specification.Transaction.html#1749" class="Field">body</a>
  <a id="2402" class="Symbol">;</a> <a id="2404" href="Ledger.Conway.Specification.Script.Validation.html#2404" class="Module">TxWitnesses</a> <a id="2416" href="Ledger.Conway.Specification.Transaction.html#1771" class="Field">wits</a>
  <a id="2423" class="Symbol">;</a> <a id="2425" href="Ledger.Conway.Specification.Script.Validation.html#1911" class="Field">realizedInputs</a> <a id="2440" class="Symbol">=</a> <a id="2442" href="Ledger.Conway.Specification.Script.Validation.html#2367" class="Bound">utxo</a> <a id="2447" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="2449" href="Ledger.Conway.Specification.Transaction.html#384" class="Function">txIns</a>
  <a id="2457" class="Symbol">;</a> <a id="2459" href="Ledger.Conway.Specification.Script.Validation.html#1977" class="Field">fee</a> <a id="2463" class="Symbol">=</a> <a id="2465" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a> <a id="2472" href="Ledger.Conway.Specification.Transaction.html#594" class="Function">txFee</a>
  <a id="2480" class="Symbol">;</a> <a id="2482" href="Ledger.Conway.Specification.Script.Validation.html#2008" class="Field">mint</a> <a id="2487" class="Symbol">=</a> <a id="2489" href="Ledger.Conway.Specification.Transaction.html#960" class="Function">mint</a>
  <a id="2496" class="Symbol">;</a> <a id="2498" href="Ledger.Conway.Specification.Script.Validation.html#2161" class="Field">vkKey</a> <a id="2504" class="Symbol">=</a> <a id="2506" href="Ledger.Conway.Specification.Transaction.html#993" class="Function">reqSignerHashes</a>
  <a id="2524" class="Symbol">}</a> <a id="2526" class="Keyword">where</a> <a id="2532" class="Keyword">open</a> <a id="2537" href="Ledger.Conway.Specification.Transaction.html#1721" class="Module">Tx</a> <a id="2540" href="Ledger.Conway.Specification.Script.Validation.html#2372" class="Bound">tx</a><a id="2542" class="Symbol">;</a> <a id="2544" class="Keyword">open</a> <a id="2549" href="Ledger.Conway.Specification.Transaction.html#352" class="Module">TxBody</a> <a id="2556" href="Ledger.Conway.Specification.Transaction.html#1749" class="Field">body</a>

<a id="credsNeeded"></a><a id="2562" href="Ledger.Conway.Specification.Script.Validation.html#2562" class="Function">credsNeeded</a> <a id="2574" class="Symbol">:</a> <a id="2576" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="2581" class="Symbol">→</a> <a id="2583" href="Ledger.Conway.Specification.Transaction.html#352" class="Record">TxBody</a> <a id="2590" class="Symbol">→</a> <a id="2592" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2594" class="Symbol">(</a><a id="2595" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a> <a id="2609" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2611" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="2621" class="Symbol">)</a>
<a id="2623" href="Ledger.Conway.Specification.Script.Validation.html#2562" class="Function">credsNeeded</a> <a id="2635" href="Ledger.Conway.Specification.Script.Validation.html#2635" class="Bound">utxo</a> <a id="2640" href="Ledger.Conway.Specification.Script.Validation.html#2640" class="Bound">txb</a>
  <a id="2646" class="Symbol">=</a>  <a id="2649" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2654" class="Symbol">(λ</a> <a id="2657" class="Symbol">(</a><a id="2658" href="Ledger.Conway.Specification.Script.Validation.html#2658" class="Bound">i</a> <a id="2660" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2662" href="Ledger.Conway.Specification.Script.Validation.html#2662" class="Bound">o</a><a id="2663" class="Symbol">)</a>  <a id="2666" class="Symbol">→</a> <a id="2668" class="Symbol">(</a><a id="2669" href="Ledger.Conway.Specification.Script.Validation.html#643" class="InductiveConstructor">Spend</a>  <a id="2676" href="Ledger.Conway.Specification.Script.Validation.html#2658" class="Bound">i</a> <a id="2678" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2680" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="2688" class="Symbol">(</a><a id="2689" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2695" href="Ledger.Conway.Specification.Script.Validation.html#2662" class="Bound">o</a><a id="2696" class="Symbol">)))</a> <a id="2700" class="Symbol">((</a><a id="2702" href="Ledger.Conway.Specification.Script.Validation.html#2635" class="Bound">utxo</a> <a id="2707" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="2709" class="Symbol">(</a><a id="2710" href="Ledger.Conway.Specification.Transaction.html#384" class="Field">txIns</a> <a id="2716" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="2718" href="Ledger.Conway.Specification.Transaction.html#452" class="Field">collateralInputs</a><a id="2734" class="Symbol">))</a> <a id="2737" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2738" class="Symbol">)</a>
  <a id="2742" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2745" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2750" class="Symbol">(λ</a> <a id="2753" href="Ledger.Conway.Specification.Script.Validation.html#2753" class="Bound">a</a>        <a id="2762" class="Symbol">→</a> <a id="2764" class="Symbol">(</a><a id="2765" href="Ledger.Conway.Specification.Script.Validation.html#559" class="InductiveConstructor">Rwrd</a>   <a id="2772" href="Ledger.Conway.Specification.Script.Validation.html#2753" class="Bound">a</a> <a id="2774" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2776" href="Ledger.Core.Specification.Address.html#1367" class="Field">stake</a> <a id="2782" href="Ledger.Conway.Specification.Script.Validation.html#2753" class="Bound">a</a><a id="2783" class="Symbol">))</a> <a id="2786" class="Symbol">(</a><a id="2787" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2791" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2793" href="Ledger.Conway.Specification.Transaction.html#626" class="Field">txWithdrawals</a> <a id="2807" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a><a id="2808" class="Symbol">)</a>
  <a id="2812" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2815" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2826" class="Symbol">(λ</a> <a id="2829" href="Ledger.Conway.Specification.Script.Validation.html#2829" class="Bound">c</a>  <a id="2832" class="Symbol">→</a> <a id="2834" class="Symbol">(</a><a id="2835" href="Ledger.Conway.Specification.Script.Validation.html#517" class="InductiveConstructor">Cert</a>   <a id="2842" href="Ledger.Conway.Specification.Script.Validation.html#2829" class="Bound">c</a> <a id="2844" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2846" class="Symbol">)</a> <a id="2848" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2852" href="Ledger.Conway.Specification.Certs.html#3006" class="Function">cwitness</a> <a id="2861" href="Ledger.Conway.Specification.Script.Validation.html#2829" class="Bound">c</a><a id="2862" class="Symbol">)</a> <a id="2864" class="Symbol">(</a><a id="2865" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2874" href="Ledger.Conway.Specification.Transaction.html#556" class="Field">txCerts</a><a id="2881" class="Symbol">)</a>
  <a id="2885" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2888" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2893" class="Symbol">(λ</a> <a id="2896" href="Ledger.Conway.Specification.Script.Validation.html#2896" class="Bound">x</a>        <a id="2905" class="Symbol">→</a> <a id="2907" class="Symbol">(</a><a id="2908" href="Ledger.Conway.Specification.Script.Validation.html#601" class="InductiveConstructor">Mint</a>   <a id="2915" href="Ledger.Conway.Specification.Script.Validation.html#2896" class="Bound">x</a> <a id="2917" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2919" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2929" href="Ledger.Conway.Specification.Script.Validation.html#2896" class="Bound">x</a><a id="2930" class="Symbol">))</a> <a id="2933" class="Symbol">(</a><a id="2934" href="Ledger.Core.Specification.TokenAlgebra.Base.html#925" class="Function">policies</a> <a id="2943" href="Ledger.Conway.Specification.Transaction.html#960" class="Field">mint</a><a id="2947" class="Symbol">)</a>
  <a id="2951" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2954" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2965" class="Symbol">(λ</a> <a id="2968" href="Ledger.Conway.Specification.Script.Validation.html#2968" class="Bound">v</a> <a id="2970" class="Symbol">→</a> <a id="2972" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2975" href="Ledger.Core.Specification.Gov.Actions.html#6696" class="Function">isGovVoterCredential</a> <a id="2996" href="Ledger.Conway.Specification.Script.Validation.html#2968" class="Bound">v</a> <a id="2998" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3003" class="Symbol">(λ</a> <a id="3006" class="Symbol">{</a><a id="3007" href="Ledger.Conway.Specification.Script.Validation.html#3007" class="Bound">c</a><a id="3008" class="Symbol">}</a> <a id="3010" class="Symbol">→</a> <a id="3012" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3017" class="Symbol">(</a><a id="3018" href="Ledger.Conway.Specification.Script.Validation.html#685" class="InductiveConstructor">Vote</a> <a id="3023" href="Ledger.Conway.Specification.Script.Validation.html#2968" class="Bound">v</a> <a id="3025" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3027" href="Ledger.Conway.Specification.Script.Validation.html#3007" class="Bound">c</a><a id="3028" class="Symbol">))</a> <a id="3031" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3036" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3043" class="Symbol">)</a>
                <a id="3061" class="Symbol">(</a><a id="3062" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="3071" class="Symbol">(</a><a id="3072" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3076" href="Ledger.Core.Specification.Gov.Actions.html#2352" class="Field">voter</a> <a id="3082" href="Ledger.Conway.Specification.Transaction.html#793" class="Field">txGovVotes</a><a id="3092" class="Symbol">))</a>
  <a id="3097" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="3100" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3111" class="Symbol">(λ</a> <a id="3114" href="Ledger.Conway.Specification.Script.Validation.html#3114" class="Bound">p</a> <a id="3116" class="Symbol">→</a> <a id="3118" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3121" href="Ledger.Conway.Specification.Script.Validation.html#3114" class="Bound">p</a> <a id="3123" class="Symbol">.</a><a id="3124" href="Ledger.Core.Specification.Gov.Actions.html#3707" class="Field">policy</a> <a id="3131" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3136" class="Symbol">(λ</a> <a id="3139" class="Symbol">{</a><a id="3140" href="Ledger.Conway.Specification.Script.Validation.html#3140" class="Bound">sh</a><a id="3142" class="Symbol">}</a> <a id="3144" class="Symbol">→</a> <a id="3146" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3151" class="Symbol">(</a><a id="3152" href="Ledger.Conway.Specification.Script.Validation.html#727" class="InductiveConstructor">Propose</a>  <a id="3161" href="Ledger.Conway.Specification.Script.Validation.html#3114" class="Bound">p</a> <a id="3163" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3165" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="3175" href="Ledger.Conway.Specification.Script.Validation.html#3140" class="Bound">sh</a><a id="3177" class="Symbol">))</a> <a id="3180" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3185" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3192" class="Symbol">)</a>
                <a id="3210" class="Symbol">(</a><a id="3211" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="3220" href="Ledger.Conway.Specification.Transaction.html#833" class="Field">txGovProposals</a><a id="3234" class="Symbol">)</a>


  <a id="3240" class="Keyword">where</a> <a id="3246" class="Keyword">open</a> <a id="3251" href="Ledger.Conway.Specification.Transaction.html#352" class="Module">TxBody</a> <a id="3258" href="Ledger.Conway.Specification.Script.Validation.html#2640" class="Bound">txb</a><a id="3261" class="Symbol">;</a> <a id="3263" class="Keyword">open</a> <a id="3268" href="Ledger.Core.Specification.Gov.Actions.html#2289" class="Module">GovVote</a><a id="3275" class="Symbol">;</a> <a id="3277" class="Keyword">open</a> <a id="3282" href="Ledger.Core.Specification.Address.html#1313" class="Module">RwdAddr</a><a id="3289" class="Symbol">;</a> <a id="3291" class="Keyword">open</a> <a id="3296" href="Ledger.Core.Specification.Gov.Actions.html#3598" class="Module">GovProposal</a>

<a id="valContext"></a><a id="3309" href="Ledger.Conway.Specification.Script.Validation.html#3309" class="Function">valContext</a> <a id="3320" class="Symbol">:</a> <a id="3322" href="Ledger.Conway.Specification.Script.Validation.html#1883" class="Record">TxInfo</a> <a id="3329" class="Symbol">→</a> <a id="3331" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a> <a id="3345" class="Symbol">→</a> <a id="3347" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a>
<a id="3352" href="Ledger.Conway.Specification.Script.Validation.html#3309" class="Function">valContext</a> <a id="3363" href="Ledger.Conway.Specification.Script.Validation.html#3363" class="Bound">txinfo</a> <a id="3370" href="Ledger.Conway.Specification.Script.Validation.html#3370" class="Bound">sp</a> <a id="3373" class="Symbol">=</a> <a id="3375" href="Ledger.Core.Specification.Script.Base.html#2005" class="Function">toData</a> <a id="3382" class="Symbol">(</a><a id="3383" href="Ledger.Conway.Specification.Script.Validation.html#3363" class="Bound">txinfo</a> <a id="3390" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3392" href="Ledger.Conway.Specification.Script.Validation.html#3370" class="Bound">sp</a><a id="3394" class="Symbol">)</a>

<a id="txOutToDataHash"></a><a id="3397" href="Ledger.Conway.Specification.Script.Validation.html#3397" class="Function">txOutToDataHash</a> <a id="3413" class="Symbol">:</a> <a id="3415" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="3421" class="Symbol">→</a> <a id="3423" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3429" href="Ledger.Core.Specification.Script.Base.html#1721" class="Function">DataHash</a>
<a id="3438" href="Ledger.Conway.Specification.Script.Validation.html#3397" class="Function">txOutToDataHash</a> <a id="3454" class="Symbol">(_</a> <a id="3457" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3459" class="Symbol">_</a> <a id="3461" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3463" href="Ledger.Conway.Specification.Script.Validation.html#3463" class="Bound">d</a> <a id="3465" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3467" class="Symbol">_)</a> <a id="3470" class="Symbol">=</a> <a id="3472" href="Ledger.Conway.Specification.Script.Validation.html#3463" class="Bound">d</a> <a id="3474" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="3478" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="3486" href="Ledger.Conway.Specification.Script.Validation.html#3486" class="Function">txOutToP2Script</a>
  <a id="3504" class="Symbol">:</a> <a id="3506" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="3511" class="Symbol">→</a> <a id="3513" href="Ledger.Conway.Specification.Transaction.html#1721" class="Record">Tx</a>
  <a id="3518" class="Symbol">→</a> <a id="3520" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="3526" class="Symbol">→</a> <a id="3528" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3534" href="Ledger.Core.Specification.Script.Base.html#2363" class="Function">P2Script</a>
<a id="3543" href="Ledger.Conway.Specification.Script.Validation.html#3486" class="Function">txOutToP2Script</a> <a id="3559" href="Ledger.Conway.Specification.Script.Validation.html#3559" class="Bound">utxo</a> <a id="3564" href="Ledger.Conway.Specification.Script.Validation.html#3564" class="Bound">tx</a> <a id="3567" class="Symbol">(</a><a id="3568" href="Ledger.Conway.Specification.Script.Validation.html#3568" class="Bound">a</a> <a id="3570" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3572" class="Symbol">_)</a> <a id="3575" class="Symbol">=</a>
  <a id="3579" class="Keyword">do</a> <a id="3582" href="Ledger.Conway.Specification.Script.Validation.html#3582" class="Bound">sh</a> <a id="3585" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3587" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3599" class="Symbol">(</a><a id="3600" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="3608" href="Ledger.Conway.Specification.Script.Validation.html#3568" class="Bound">a</a><a id="3609" class="Symbol">)</a>
     <a id="3616" href="Ledger.Conway.Specification.Script.Validation.html#3616" class="Bound">s</a>  <a id="3619" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3621" href="Ledger.Conway.Specification.Transaction.html#2895" class="Function">lookupScriptHash</a> <a id="3638" href="Ledger.Conway.Specification.Script.Validation.html#3582" class="Bound">sh</a> <a id="3641" href="Ledger.Conway.Specification.Script.Validation.html#3564" class="Bound">tx</a> <a id="3644" href="Ledger.Conway.Specification.Script.Validation.html#3559" class="Bound">utxo</a>
     <a id="3654" href="Ledger.Core.Specification.Script.Base.html#3216" class="Function">toP2Script</a> <a id="3665" href="Ledger.Conway.Specification.Script.Validation.html#3616" class="Bound">s</a>

<a id="3668" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3677" href="Ledger.Conway.Specification.Script.Validation.html#3677" class="Function">collectP2ScriptsWithContext</a>
    <a id="3709" class="Symbol">:</a> <a id="3711" href="Ledger.Conway.Specification.PParams.html#1687" class="Record">PParams</a> <a id="3719" class="Symbol">→</a> <a id="3721" href="Ledger.Conway.Specification.Transaction.html#1721" class="Record">Tx</a> <a id="3724" class="Symbol">→</a> <a id="3726" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a>
    <a id="3735" class="Symbol">→</a> <a id="3737" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3742" class="Symbol">(</a><a id="3743" href="Ledger.Core.Specification.Script.Base.html#2363" class="Function">P2Script</a> <a id="3752" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3754" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3759" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="3764" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3766" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="3774" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3776" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="3785" class="Symbol">)</a>
  <a id="3789" href="Ledger.Conway.Specification.Script.Validation.html#3677" class="Function">collectP2ScriptsWithContext</a> <a id="3817" href="Ledger.Conway.Specification.Script.Validation.html#3817" class="Bound">pp</a> <a id="3820" href="Ledger.Conway.Specification.Script.Validation.html#3820" class="Bound">tx</a> <a id="3823" href="Ledger.Conway.Specification.Script.Validation.html#3823" class="Bound">utxo</a>
    <a id="3832" class="Symbol">=</a> <a id="3834" href="abstract-set-theory.FiniteSetTheory.html#2556" class="Function">setToList</a>
    <a id="3848" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3850" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3861" class="Symbol">(λ</a> <a id="3864" class="Symbol">(</a><a id="3865" href="Ledger.Conway.Specification.Script.Validation.html#3865" class="Bound">sp</a> <a id="3868" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3870" href="Ledger.Conway.Specification.Script.Validation.html#3870" class="Bound">c</a><a id="3871" class="Symbol">)</a> <a id="3873" class="Symbol">→</a> <a id="3875" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3878" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3890" href="Ledger.Conway.Specification.Script.Validation.html#3870" class="Bound">c</a>
                                <a id="3924" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3929" class="Symbol">(λ</a> <a id="3932" class="Symbol">{</a><a id="3933" href="Ledger.Conway.Specification.Script.Validation.html#3933" class="Bound">sh</a><a id="3935" class="Symbol">}</a> <a id="3937" class="Symbol">→</a> <a id="3939" href="Ledger.Conway.Specification.Script.Validation.html#4059" class="Function">toScriptInput</a> <a id="3953" href="Ledger.Conway.Specification.Script.Validation.html#3865" class="Bound">sp</a> <a id="3956" href="Ledger.Conway.Specification.Script.Validation.html#3933" class="Bound">sh</a><a id="3958" class="Symbol">)</a>
                                <a id="3992" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3997" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="4004" class="Symbol">)</a>
    <a id="4010" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="4012" href="Ledger.Conway.Specification.Script.Validation.html#2562" class="Function">credsNeeded</a> <a id="4024" href="Ledger.Conway.Specification.Script.Validation.html#3823" class="Bound">utxo</a> <a id="4029" class="Symbol">(</a><a id="4030" href="Ledger.Conway.Specification.Script.Validation.html#3820" class="Bound">tx</a> <a id="4033" class="Symbol">.</a><a id="4034" href="Ledger.Conway.Specification.Transaction.html#1749" class="Field">Tx.body</a><a id="4041" class="Symbol">)</a>
    <a id="4047" class="Keyword">where</a>
      <a id="4059" href="Ledger.Conway.Specification.Script.Validation.html#4059" class="Function">toScriptInput</a>
        <a id="4081" class="Symbol">:</a> <a id="4083" href="Ledger.Conway.Specification.Script.Validation.html#488" class="Datatype">ScriptPurpose</a> <a id="4097" class="Symbol">→</a> <a id="4099" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
        <a id="4118" class="Symbol">→</a> <a id="4120" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4126" class="Symbol">(</a><a id="4127" href="Ledger.Core.Specification.Script.Base.html#2363" class="Function">P2Script</a> <a id="4136" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4138" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4143" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="4148" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4150" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="4158" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4160" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="4169" class="Symbol">)</a>
      <a id="4177" href="Ledger.Conway.Specification.Script.Validation.html#4059" class="Function">toScriptInput</a> <a id="4191" href="Ledger.Conway.Specification.Script.Validation.html#4191" class="Bound">sp</a> <a id="4194" href="Ledger.Conway.Specification.Script.Validation.html#4194" class="Bound">sh</a> <a id="4197" class="Symbol">=</a>
        <a id="4207" class="Keyword">do</a> <a id="4210" href="Ledger.Conway.Specification.Script.Validation.html#4210" class="Bound">s</a> <a id="4212" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4214" href="Ledger.Conway.Specification.Transaction.html#2895" class="Function">lookupScriptHash</a> <a id="4231" href="Ledger.Conway.Specification.Script.Validation.html#4194" class="Bound">sh</a> <a id="4234" href="Ledger.Conway.Specification.Script.Validation.html#3820" class="Bound">tx</a> <a id="4237" href="Ledger.Conway.Specification.Script.Validation.html#3823" class="Bound">utxo</a>
           <a id="4253" href="Ledger.Conway.Specification.Script.Validation.html#4253" class="Bound">p2s</a> <a id="4257" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4259" href="Ledger.Core.Specification.Script.Base.html#3216" class="Function">toP2Script</a> <a id="4270" href="Ledger.Conway.Specification.Script.Validation.html#4210" class="Bound">s</a>
           <a id="4283" class="Symbol">(</a><a id="4284" href="Ledger.Conway.Specification.Script.Validation.html#4284" class="Bound">rdmr</a> <a id="4289" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4291" href="Ledger.Conway.Specification.Script.Validation.html#4291" class="Bound">exunits</a><a id="4298" class="Symbol">)</a> <a id="4300" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4302" href="Ledger.Conway.Specification.Script.Validation.html#1274" class="Function">indexedRdmrs</a> <a id="4315" href="Ledger.Conway.Specification.Script.Validation.html#3820" class="Bound">tx</a> <a id="4318" href="Ledger.Conway.Specification.Script.Validation.html#4191" class="Bound">sp</a>
           <a id="4332" class="Keyword">let</a> <a id="4336" href="Ledger.Conway.Specification.Script.Validation.html#4336" class="Bound">data&#39;</a>     <a id="4346" class="Symbol">=</a> <a id="4348" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="4354" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="4358" class="InductiveConstructor">[]</a> <a id="4361" class="Symbol">(</a><a id="4362" href="Ledger.Conway.Specification.Script.Validation.html#1458" class="Function">getDatum</a> <a id="4371" href="Ledger.Conway.Specification.Script.Validation.html#3820" class="Bound">tx</a> <a id="4374" href="Ledger.Conway.Specification.Script.Validation.html#3823" class="Bound">utxo</a> <a id="4379" href="Ledger.Conway.Specification.Script.Validation.html#4191" class="Bound">sp</a><a id="4381" class="Symbol">)</a> <a id="4383" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="4386" href="Ledger.Conway.Specification.Script.Validation.html#4284" class="Bound">rdmr</a> <a id="4391" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4393" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="4395" href="Ledger.Conway.Specification.Script.Validation.html#3309" class="Function">valContext</a> <a id="4406" class="Symbol">(</a><a id="4407" href="Ledger.Conway.Specification.Script.Validation.html#2252" class="Function">txInfo</a> <a id="4414" class="Symbol">(</a><a id="4415" href="Ledger.Core.Specification.Script.Base.html#1962" class="Function">language</a> <a id="4424" href="Ledger.Conway.Specification.Script.Validation.html#4253" class="Bound">p2s</a><a id="4427" class="Symbol">)</a> <a id="4429" href="Ledger.Conway.Specification.Script.Validation.html#3817" class="Bound">pp</a> <a id="4432" href="Ledger.Conway.Specification.Script.Validation.html#3823" class="Bound">utxo</a> <a id="4437" href="Ledger.Conway.Specification.Script.Validation.html#3820" class="Bound">tx</a><a id="4439" class="Symbol">)</a> <a id="4441" href="Ledger.Conway.Specification.Script.Validation.html#4191" class="Bound">sp</a> <a id="4444" href="Data.List.Base.html#4907" class="Function Operator">]</a>
               <a id="4461" href="Ledger.Conway.Specification.Script.Validation.html#4461" class="Bound">costModel</a> <a id="4471" class="Symbol">=</a> <a id="4473" href="Ledger.Conway.Specification.PParams.html#3066" class="Field">PParams.costmdls</a> <a id="4490" href="Ledger.Conway.Specification.Script.Validation.html#3817" class="Bound">pp</a>
           <a id="4504" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4509" class="Symbol">(</a><a id="4510" href="Ledger.Conway.Specification.Script.Validation.html#4253" class="Bound">p2s</a> <a id="4514" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4516" href="Ledger.Conway.Specification.Script.Validation.html#4336" class="Bound">data&#39;</a> <a id="4522" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4524" href="Ledger.Conway.Specification.Script.Validation.html#4291" class="Bound">exunits</a> <a id="4532" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4534" href="Ledger.Conway.Specification.Script.Validation.html#4461" class="Bound">costModel</a><a id="4543" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="4546" href="Ledger.Conway.Specification.Script.Validation.html#4546" class="Function">evalP2Scripts</a> <a id="4560" class="Symbol">:</a> <a id="4562" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4567" class="Symbol">(</a><a id="4568" href="Ledger.Core.Specification.Script.Base.html#2363" class="Function">P2Script</a> <a id="4577" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4579" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4584" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="4589" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4591" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="4599" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4601" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="4610" class="Symbol">)</a> <a id="4612" class="Symbol">→</a> <a id="4614" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4619" href="Ledger.Conway.Specification.Script.Validation.html#4546" class="Function">evalP2Scripts</a> <a id="4633" class="Symbol">=</a> <a id="4635" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="4639" class="Symbol">(λ</a> <a id="4642" class="Symbol">(</a><a id="4643" href="Ledger.Conway.Specification.Script.Validation.html#4643" class="Bound">s</a> <a id="4645" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4647" href="Ledger.Conway.Specification.Script.Validation.html#4647" class="Bound">d</a> <a id="4649" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4651" href="Ledger.Conway.Specification.Script.Validation.html#4651" class="Bound">eu</a> <a id="4654" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4656" href="Ledger.Conway.Specification.Script.Validation.html#4656" class="Bound">cm</a><a id="4658" class="Symbol">)</a> <a id="4660" class="Symbol">→</a> <a id="4662" href="Ledger.Conway.Specification.Abstract.html#816" class="Field">runPLCScript</a> <a id="4675" href="Ledger.Conway.Specification.Script.Validation.html#4656" class="Bound">cm</a> <a id="4678" href="Ledger.Conway.Specification.Script.Validation.html#4643" class="Bound">s</a> <a id="4680" href="Ledger.Conway.Specification.Script.Validation.html#4651" class="Bound">eu</a> <a id="4683" href="Ledger.Conway.Specification.Script.Validation.html#4647" class="Bound">d</a><a id="4684" class="Symbol">)</a>

</pre></body></html>