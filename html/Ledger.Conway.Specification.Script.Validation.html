<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>

<a id="128" class="Keyword">module</a> <a id="135" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="183" class="Symbol">(</a><a id="184" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a> <a id="188" class="Symbol">:</a> <a id="190" class="Symbol">_)</a> <a id="193" class="Symbol">(</a><a id="194" class="Keyword">open</a> <a id="199" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="220" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a><a id="223" class="Symbol">)</a>
  <a id="227" class="Symbol">(</a><a id="228" href="Ledger.Conway.Specification.Script.Validation.html#228" class="Bound">abs</a> <a id="232" class="Symbol">:</a> <a id="234" href="Ledger.Conway.Specification.Abstract.html#829" class="Record">AbstractFunctions</a> <a id="252" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a><a id="255" class="Symbol">)</a> <a id="257" class="Symbol">(</a><a id="258" class="Keyword">open</a> <a id="263" href="Ledger.Conway.Specification.Abstract.html#829" class="Module">AbstractFunctions</a> <a id="281" href="Ledger.Conway.Specification.Script.Validation.html#228" class="Bound">abs</a><a id="284" class="Symbol">)</a> <a id="286" class="Symbol">(</a><a id="287" class="Keyword">open</a> <a id="292" href="Ledger.Conway.Specification.Abstract.html#348" class="Module">indexOf</a> <a id="300" href="Ledger.Conway.Specification.Abstract.html#961" class="Field">indexOfImp</a><a id="310" class="Symbol">)</a>
  <a id="314" class="Keyword">where</a>

<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="394" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>


<a id="409" class="Keyword">open</a> <a id="414" class="Keyword">import</a> <a id="421" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a> <a id="458" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a>
<a id="462" class="Keyword">open</a> <a id="467" class="Keyword">import</a> <a id="474" href="Ledger.Conway.Specification.Script.ScriptPurpose.html" class="Module">Ledger.Conway.Specification.Script.ScriptPurpose</a> <a id="523" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a>

<a id="rdptr"></a><a id="528" href="Ledger.Conway.Specification.Script.Validation.html#528" class="Function">rdptr</a> <a id="534" class="Symbol">:</a> <a id="536" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a> <a id="543" class="Symbol">→</a> <a id="545" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="559" class="Symbol">→</a> <a id="561" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="567" href="Ledger.Conway.Specification.Transaction.html#2752" class="Function">RdmrPtr</a>
<a id="575" href="Ledger.Conway.Specification.Script.Validation.html#528" class="Function">rdptr</a> <a id="581" href="Ledger.Conway.Specification.Script.Validation.html#581" class="Bound">txb</a> <a id="585" class="Symbol">=</a> <a id="587" class="Symbol">λ</a> <a id="589" class="Keyword">where</a>
  <a id="597" class="Symbol">(</a><a id="598" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#323" class="InductiveConstructor">Cert</a> <a id="603" href="Ledger.Conway.Specification.Script.Validation.html#603" class="Bound">h</a><a id="604" class="Symbol">)</a>     <a id="610" class="Symbol">→</a> <a id="612" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="616" class="Symbol">(</a><a id="617" href="Ledger.Conway.Specification.Transaction.html#892" class="InductiveConstructor">Cert</a>    <a id="625" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="627" class="Symbol">)</a> <a id="629" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="631" href="Ledger.Conway.Specification.Abstract.html#381" class="Function">indexOfDCert</a>    <a id="647" href="Ledger.Conway.Specification.Script.Validation.html#603" class="Bound">h</a> <a id="649" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a>
  <a id="659" class="Symbol">(</a><a id="660" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#367" class="InductiveConstructor">Rwrd</a> <a id="665" href="Ledger.Conway.Specification.Script.Validation.html#665" class="Bound">h</a><a id="666" class="Symbol">)</a>     <a id="672" class="Symbol">→</a> <a id="674" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="678" class="Symbol">(</a><a id="679" href="Ledger.Conway.Specification.Transaction.html#897" class="InductiveConstructor">Rewrd</a>   <a id="687" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="689" class="Symbol">)</a> <a id="691" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="693" href="Ledger.Conway.Specification.Abstract.html#455" class="Function">indexOfRewardAddress</a>  <a id="715" href="Ledger.Conway.Specification.Script.Validation.html#665" class="Bound">h</a> <a id="717" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a>
  <a id="733" class="Symbol">(</a><a id="734" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#411" class="InductiveConstructor">Mint</a> <a id="739" href="Ledger.Conway.Specification.Script.Validation.html#739" class="Bound">h</a><a id="740" class="Symbol">)</a>     <a id="746" class="Symbol">→</a> <a id="748" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="752" class="Symbol">(</a><a id="753" href="Ledger.Conway.Specification.Transaction.html#887" class="InductiveConstructor">Mint</a>    <a id="761" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="763" class="Symbol">)</a> <a id="765" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="767" href="Ledger.Conway.Specification.Abstract.html#603" class="Function">indexOfPolicyId</a> <a id="783" href="Ledger.Conway.Specification.Script.Validation.html#739" class="Bound">h</a> <a id="785" class="Symbol">(</a><a id="786" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#927" class="Function">policies</a> <a id="795" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a><a id="799" class="Symbol">)</a>
  <a id="803" class="Symbol">(</a><a id="804" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#455" class="InductiveConstructor">Spend</a> <a id="810" href="Ledger.Conway.Specification.Script.Validation.html#810" class="Bound">h</a><a id="811" class="Symbol">)</a>    <a id="816" class="Symbol">→</a> <a id="818" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="822" class="Symbol">(</a><a id="823" href="Ledger.Conway.Specification.Transaction.html#881" class="InductiveConstructor">Spend</a>   <a id="831" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="833" class="Symbol">)</a> <a id="835" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="837" href="Ledger.Conway.Specification.Abstract.html#529" class="Function">indexOfTxIn</a>     <a id="853" href="Ledger.Conway.Specification.Script.Validation.html#810" class="Bound">h</a> <a id="855" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a>
  <a id="863" class="Symbol">(</a><a id="864" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#499" class="InductiveConstructor">Vote</a> <a id="869" href="Ledger.Conway.Specification.Script.Validation.html#869" class="Bound">h</a><a id="870" class="Symbol">)</a>     <a id="876" class="Symbol">→</a> <a id="878" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="882" class="Symbol">(</a><a id="883" href="Ledger.Conway.Specification.Transaction.html#903" class="InductiveConstructor">Vote</a>    <a id="891" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="893" class="Symbol">)</a> <a id="895" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="897" href="Ledger.Conway.Specification.Abstract.html#677" class="Function">indexOfVote</a>     <a id="913" href="Ledger.Conway.Specification.Script.Validation.html#869" class="Bound">h</a> <a id="915" class="Symbol">(</a><a id="916" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="920" href="Ledger.Conway.Specification.Gov.Actions.html#2357" class="Field">GovVote.voter</a> <a id="934" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a><a id="944" class="Symbol">)</a>
  <a id="948" class="Symbol">(</a><a id="949" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#543" class="InductiveConstructor">Propose</a> <a id="957" href="Ledger.Conway.Specification.Script.Validation.html#957" class="Bound">h</a><a id="958" class="Symbol">)</a>  <a id="961" class="Symbol">→</a> <a id="963" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="967" class="Symbol">(</a><a id="968" href="Ledger.Conway.Specification.Transaction.html#908" class="InductiveConstructor">Propose</a> <a id="976" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="978" class="Symbol">)</a> <a id="980" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="982" href="Ledger.Conway.Specification.Abstract.html#751" class="Function">indexOfProposal</a> <a id="998" href="Ledger.Conway.Specification.Script.Validation.html#957" class="Bound">h</a> <a id="1000" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a>
 <a id="1016" class="Keyword">where</a> <a id="1022" class="Keyword">open</a> <a id="1027" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="1034" href="Ledger.Conway.Specification.Script.Validation.html#581" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1039" href="Ledger.Conway.Specification.Script.Validation.html#1039" class="Function">indexedRdmrs</a> <a id="1052" class="Symbol">:</a> <a id="1054" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1057" class="Symbol">→</a> <a id="1059" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="1073" class="Symbol">→</a> <a id="1075" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1081" class="Symbol">(</a><a id="1082" href="Ledger.Conway.Specification.Script.Base.html#1788" class="Function">Redeemer</a> <a id="1091" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1093" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a><a id="1100" class="Symbol">)</a>
<a id="1102" href="Ledger.Conway.Specification.Script.Validation.html#1039" class="Function">indexedRdmrs</a> <a id="1115" href="Ledger.Conway.Specification.Script.Validation.html#1115" class="Bound">tx</a> <a id="1118" href="Ledger.Conway.Specification.Script.Validation.html#1118" class="Bound">sp</a> <a id="1121" class="Symbol">=</a> <a id="1123" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1129" class="Symbol">(λ</a> <a id="1132" href="Ledger.Conway.Specification.Script.Validation.html#1132" class="Bound">x</a> <a id="1134" class="Symbol">→</a> <a id="1136" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="1145" href="Ledger.Conway.Specification.Transaction.html#4557" class="Function">txrdmrs</a> <a id="1153" href="Ledger.Conway.Specification.Script.Validation.html#1132" class="Bound">x</a><a id="1154" class="Symbol">)</a> <a id="1156" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1164" class="Symbol">(</a><a id="1165" href="Ledger.Conway.Specification.Script.Validation.html#528" class="Function">rdptr</a> <a id="1171" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a> <a id="1176" href="Ledger.Conway.Specification.Script.Validation.html#1118" class="Bound">sp</a><a id="1178" class="Symbol">)</a>
  <a id="1182" class="Keyword">where</a> <a id="1188" class="Keyword">open</a> <a id="1193" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="1196" href="Ledger.Conway.Specification.Script.Validation.html#1115" class="Bound">tx</a><a id="1198" class="Symbol">;</a> <a id="1200" class="Keyword">open</a> <a id="1205" href="Ledger.Conway.Specification.Transaction.html#4437" class="Module">TxWitnesses</a> <a id="1217" href="Ledger.Conway.Specification.Transaction.html#4738" class="Function">wits</a>

<a id="getDatum"></a><a id="1223" href="Ledger.Conway.Specification.Script.Validation.html#1223" class="Function">getDatum</a> <a id="1232" class="Symbol">:</a> <a id="1234" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1237" class="Symbol">→</a> <a id="1239" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="1244" class="Symbol">→</a> <a id="1246" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="1260" class="Symbol">→</a> <a id="1262" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1268" href="Ledger.Conway.Specification.Script.Base.html#1770" class="Function">Datum</a>
<a id="1274" href="Ledger.Conway.Specification.Script.Validation.html#1223" class="Function">getDatum</a> <a id="1283" href="Ledger.Conway.Specification.Script.Validation.html#1283" class="Bound">tx</a> <a id="1286" href="Ledger.Conway.Specification.Script.Validation.html#1286" class="Bound">utxo</a> <a id="1291" class="Symbol">(</a><a id="1292" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#455" class="InductiveConstructor">Spend</a> <a id="1298" href="Ledger.Conway.Specification.Script.Validation.html#1298" class="Bound">txin</a><a id="1302" class="Symbol">)</a> <a id="1304" class="Symbol">=</a>
  <a id="1308" class="Keyword">do</a> <a id="1311" class="Symbol">(_</a> <a id="1314" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1316" class="Symbol">_</a> <a id="1318" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1320" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1325" href="Ledger.Conway.Specification.Script.Validation.html#1325" class="Bound">d</a> <a id="1327" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1329" class="Symbol">_)</a> <a id="1332" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1334" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="1343" href="Ledger.Conway.Specification.Script.Validation.html#1286" class="Bound">utxo</a> <a id="1348" href="Ledger.Conway.Specification.Script.Validation.html#1298" class="Bound">txin</a>
                          <a id="1379" class="Keyword">where</a>
                            <a id="1413" class="Symbol">(_</a> <a id="1416" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1418" class="Symbol">_</a> <a id="1420" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1422" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1430" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1432" class="Symbol">_)</a> <a id="1435" class="Symbol">→</a> <a id="1437" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1450" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1455" href="Ledger.Conway.Specification.Script.Validation.html#1325" class="Bound">d</a> <a id="1457" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1460" class="Symbol">λ</a> <a id="1462" class="Keyword">where</a>
       <a id="1475" class="Symbol">(</a><a id="1476" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1481" href="Ledger.Conway.Specification.Script.Validation.html#1481" class="Bound">d</a><a id="1482" class="Symbol">)</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1491" href="Ledger.Conway.Specification.Script.Validation.html#1481" class="Bound">d</a>
       <a id="1500" class="Symbol">(</a><a id="1501" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1506" href="Ledger.Conway.Specification.Script.Validation.html#1506" class="Bound">h</a><a id="1507" class="Symbol">)</a> <a id="1509" class="Symbol">→</a> <a id="1511" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="1520" href="Ledger.Conway.Specification.Script.Validation.html#1542" class="Function">m</a> <a id="1522" href="Ledger.Conway.Specification.Script.Validation.html#1506" class="Bound">h</a>
     <a id="1529" class="Keyword">where</a>
       <a id="1542" href="Ledger.Conway.Specification.Script.Validation.html#1542" class="Function">m</a> <a id="1544" class="Symbol">=</a> <a id="1546" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="1555" class="Symbol">(</a><a id="1556" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1561" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1563" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="1568" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1570" href="Function.Base.html#704" class="Function">id</a> <a id="1573" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1575" class="Symbol">(</a><a id="1576" href="Ledger.Conway.Specification.Transaction.html#4532" class="Field">TxWitnesses.txdats</a> <a id="1595" class="Symbol">(</a><a id="1596" href="Ledger.Conway.Specification.Transaction.html#4738" class="Field">Tx.wits</a> <a id="1604" href="Ledger.Conway.Specification.Script.Validation.html#1283" class="Bound">tx</a><a id="1606" class="Symbol">)))</a>
<a id="1610" href="Ledger.Conway.Specification.Script.Validation.html#1223" class="CatchallClause Function">getDatum</a><a id="1618" class="CatchallClause"> </a><a id="1619" href="Ledger.Conway.Specification.Script.Validation.html#1619" class="CatchallClause Bound">tx</a><a id="1621" class="CatchallClause"> </a><a id="1622" href="Ledger.Conway.Specification.Script.Validation.html#1622" class="CatchallClause Bound">utxo</a><a id="1626" class="CatchallClause"> </a><a id="1627" class="CatchallClause Symbol">_</a> <a id="1629" class="Symbol">=</a> <a id="1631" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="txInfo"></a><a id="1641" href="Ledger.Conway.Specification.Script.Validation.html#1641" class="Function">txInfo</a> <a id="1648" class="Symbol">:</a> <a id="1650" href="Ledger.Conway.Specification.Script.Base.html#967" class="Function">Language</a> <a id="1659" class="Symbol">→</a> <a id="1661" href="Ledger.Conway.Specification.PParams.html#1689" class="Record">PParams</a>
                  <a id="1687" class="Symbol">→</a> <a id="1689" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
                  <a id="1712" class="Symbol">→</a> <a id="1714" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a>
                  <a id="1735" class="Symbol">→</a> <a id="1737" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#593" class="Record">TxInfo</a>
<a id="1744" href="Ledger.Conway.Specification.Script.Validation.html#1641" class="Function">txInfo</a> <a id="1751" href="Ledger.Conway.Specification.Script.Validation.html#1751" class="Bound">l</a> <a id="1753" href="Ledger.Conway.Specification.Script.Validation.html#1753" class="Bound">pp</a> <a id="1756" href="Ledger.Conway.Specification.Script.Validation.html#1756" class="Bound">utxo</a> <a id="1761" href="Ledger.Conway.Specification.Script.Validation.html#1761" class="Bound">tx</a> <a id="1764" class="Symbol">=</a> <a id="1766" class="Keyword">record</a>
  <a id="1775" class="Symbol">{</a> <a id="1777" href="Ledger.Conway.Specification.Script.Validation.html#1777" class="Module">TxBody</a> <a id="1784" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">body</a>
  <a id="1791" class="Symbol">;</a> <a id="1793" href="Ledger.Conway.Specification.Script.Validation.html#1793" class="Module">TxWitnesses</a> <a id="1805" href="Ledger.Conway.Specification.Transaction.html#4738" class="Field">wits</a>
  <a id="1812" class="Symbol">;</a> <a id="1814" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#621" class="Field">realizedInputs</a> <a id="1829" class="Symbol">=</a> <a id="1831" href="Ledger.Conway.Specification.Script.Validation.html#1756" class="Bound">utxo</a> <a id="1836" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="1838" href="Ledger.Conway.Specification.Transaction.html#3032" class="Function">txIns</a>
  <a id="1846" class="Symbol">;</a> <a id="1848" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#687" class="Field">fee</a> <a id="1852" class="Symbol">=</a> <a id="1854" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#882" class="Function">inject</a> <a id="1861" href="Ledger.Conway.Specification.Transaction.html#3254" class="Function">txFee</a>
  <a id="1869" class="Symbol">;</a> <a id="1871" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#718" class="Field">mint</a> <a id="1876" class="Symbol">=</a> <a id="1878" href="Ledger.Conway.Specification.Transaction.html#3638" class="Function">mint</a>
  <a id="1885" class="Symbol">;</a> <a id="1887" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#871" class="Field">vkKey</a> <a id="1893" class="Symbol">=</a> <a id="1895" href="Ledger.Conway.Specification.Transaction.html#3673" class="Function">reqSignerHashes</a>
  <a id="1913" class="Symbol">}</a> <a id="1915" class="Keyword">where</a> <a id="1921" class="Keyword">open</a> <a id="1926" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="1929" href="Ledger.Conway.Specification.Script.Validation.html#1761" class="Bound">tx</a><a id="1931" class="Symbol">;</a> <a id="1933" class="Keyword">open</a> <a id="1938" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="1945" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">body</a>

<a id="credsNeeded"></a><a id="1951" href="Ledger.Conway.Specification.Script.Validation.html#1951" class="Function">credsNeeded</a> <a id="1963" class="Symbol">:</a> <a id="1965" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="1970" class="Symbol">→</a> <a id="1972" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a> <a id="1979" class="Symbol">→</a> <a id="1981" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="1983" class="Symbol">(</a><a id="1984" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="1998" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2000" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="2010" class="Symbol">)</a>
<a id="2012" href="Ledger.Conway.Specification.Script.Validation.html#1951" class="Function">credsNeeded</a> <a id="2024" href="Ledger.Conway.Specification.Script.Validation.html#2024" class="Bound">utxo</a> <a id="2029" href="Ledger.Conway.Specification.Script.Validation.html#2029" class="Bound">txb</a>
  <a id="2035" class="Symbol">=</a>  <a id="2038" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2043" class="Symbol">(λ</a> <a id="2046" class="Symbol">(</a><a id="2047" href="Ledger.Conway.Specification.Script.Validation.html#2047" class="Bound">i</a> <a id="2049" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2051" href="Ledger.Conway.Specification.Script.Validation.html#2051" class="Bound">o</a><a id="2052" class="Symbol">)</a>  <a id="2055" class="Symbol">→</a> <a id="2057" class="Symbol">(</a><a id="2058" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#455" class="InductiveConstructor">Spend</a>  <a id="2065" href="Ledger.Conway.Specification.Script.Validation.html#2047" class="Bound">i</a> <a id="2067" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2069" href="Ledger.Core.Specification.Address.html#2685" class="Function">payCred</a> <a id="2077" class="Symbol">(</a><a id="2078" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2084" href="Ledger.Conway.Specification.Script.Validation.html#2051" class="Bound">o</a><a id="2085" class="Symbol">)))</a> <a id="2089" class="Symbol">((</a><a id="2091" href="Ledger.Conway.Specification.Script.Validation.html#2024" class="Bound">utxo</a> <a id="2096" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="2098" class="Symbol">(</a><a id="2099" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a> <a id="2105" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="2107" href="Ledger.Conway.Specification.Transaction.html#3104" class="Field">collateralInputs</a><a id="2123" class="Symbol">))</a> <a id="2126" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2127" class="Symbol">)</a>
  <a id="2131" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2134" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2139" class="Symbol">(λ</a> <a id="2142" href="Ledger.Conway.Specification.Script.Validation.html#2142" class="Bound">a</a>        <a id="2151" class="Symbol">→</a> <a id="2153" class="Symbol">(</a><a id="2154" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#367" class="InductiveConstructor">Rwrd</a>   <a id="2161" href="Ledger.Conway.Specification.Script.Validation.html#2142" class="Bound">a</a> <a id="2163" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2165" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a> <a id="2171" href="Ledger.Conway.Specification.Script.Validation.html#2142" class="Bound">a</a><a id="2172" class="Symbol">))</a> <a id="2175" class="Symbol">(</a><a id="2176" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2180" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2182" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a> <a id="2196" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a><a id="2197" class="Symbol">)</a>
  <a id="2201" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2204" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2215" class="Symbol">(λ</a> <a id="2218" href="Ledger.Conway.Specification.Script.Validation.html#2218" class="Bound">c</a>  <a id="2221" class="Symbol">→</a> <a id="2223" class="Symbol">(</a><a id="2224" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#323" class="InductiveConstructor">Cert</a>   <a id="2231" href="Ledger.Conway.Specification.Script.Validation.html#2218" class="Bound">c</a> <a id="2233" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2235" class="Symbol">)</a> <a id="2237" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2241" href="Ledger.Conway.Specification.Certs.html#2871" class="Function">cwitness</a> <a id="2250" href="Ledger.Conway.Specification.Script.Validation.html#2218" class="Bound">c</a><a id="2251" class="Symbol">)</a> <a id="2253" class="Symbol">(</a><a id="2254" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2263" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a><a id="2270" class="Symbol">)</a>
  <a id="2274" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2277" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2282" class="Symbol">(λ</a> <a id="2285" href="Ledger.Conway.Specification.Script.Validation.html#2285" class="Bound">x</a>        <a id="2294" class="Symbol">→</a> <a id="2296" class="Symbol">(</a><a id="2297" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#411" class="InductiveConstructor">Mint</a>   <a id="2304" href="Ledger.Conway.Specification.Script.Validation.html#2285" class="Bound">x</a> <a id="2306" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2308" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2318" href="Ledger.Conway.Specification.Script.Validation.html#2285" class="Bound">x</a><a id="2319" class="Symbol">))</a> <a id="2322" class="Symbol">(</a><a id="2323" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#927" class="Function">policies</a> <a id="2332" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a><a id="2336" class="Symbol">)</a>
  <a id="2340" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2343" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2354" class="Symbol">(λ</a> <a id="2357" href="Ledger.Conway.Specification.Script.Validation.html#2357" class="Bound">v</a> <a id="2359" class="Symbol">→</a> <a id="2361" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2364" href="Ledger.Conway.Specification.Gov.Actions.html#6713" class="Function">isGovVoterCredential</a> <a id="2385" href="Ledger.Conway.Specification.Script.Validation.html#2357" class="Bound">v</a> <a id="2387" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2392" class="Symbol">(λ</a> <a id="2395" class="Symbol">{</a><a id="2396" href="Ledger.Conway.Specification.Script.Validation.html#2396" class="Bound">c</a><a id="2397" class="Symbol">}</a> <a id="2399" class="Symbol">→</a> <a id="2401" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2406" class="Symbol">(</a><a id="2407" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#499" class="InductiveConstructor">Vote</a> <a id="2412" href="Ledger.Conway.Specification.Script.Validation.html#2357" class="Bound">v</a> <a id="2414" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2416" href="Ledger.Conway.Specification.Script.Validation.html#2396" class="Bound">c</a><a id="2417" class="Symbol">))</a> <a id="2420" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2425" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2432" class="Symbol">)</a>
                <a id="2450" class="Symbol">(</a><a id="2451" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2460" class="Symbol">(</a><a id="2461" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2465" href="Ledger.Conway.Specification.Gov.Actions.html#2357" class="Field">voter</a> <a id="2471" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a><a id="2481" class="Symbol">))</a>
  <a id="2486" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2489" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2500" class="Symbol">(λ</a> <a id="2503" href="Ledger.Conway.Specification.Script.Validation.html#2503" class="Bound">p</a> <a id="2505" class="Symbol">→</a> <a id="2507" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2510" href="Ledger.Conway.Specification.Script.Validation.html#2503" class="Bound">p</a> <a id="2512" class="Symbol">.</a><a id="2513" href="Ledger.Conway.Specification.Gov.Actions.html#3712" class="Field">policy</a> <a id="2520" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2525" class="Symbol">(λ</a> <a id="2528" class="Symbol">{</a><a id="2529" href="Ledger.Conway.Specification.Script.Validation.html#2529" class="Bound">sh</a><a id="2531" class="Symbol">}</a> <a id="2533" class="Symbol">→</a> <a id="2535" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2540" class="Symbol">(</a><a id="2541" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#543" class="InductiveConstructor">Propose</a>  <a id="2550" href="Ledger.Conway.Specification.Script.Validation.html#2503" class="Bound">p</a> <a id="2552" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2554" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2564" href="Ledger.Conway.Specification.Script.Validation.html#2529" class="Bound">sh</a><a id="2566" class="Symbol">))</a> <a id="2569" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2574" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2581" class="Symbol">)</a>
                <a id="2599" class="Symbol">(</a><a id="2600" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2609" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a><a id="2623" class="Symbol">)</a>


  <a id="2629" class="Keyword">where</a> <a id="2635" class="Keyword">open</a> <a id="2640" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="2647" href="Ledger.Conway.Specification.Script.Validation.html#2029" class="Bound">txb</a><a id="2650" class="Symbol">;</a> <a id="2652" class="Keyword">open</a> <a id="2657" href="Ledger.Conway.Specification.Gov.Actions.html#2294" class="Module">GovVote</a><a id="2664" class="Symbol">;</a> <a id="2666" class="Keyword">open</a> <a id="2671" href="Ledger.Core.Specification.Address.html#1313" class="Module">RewardAddress</a><a id="2684" class="Symbol">;</a> <a id="2686" class="Keyword">open</a> <a id="2691" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Module">GovProposal</a>

<a id="2704" class="Comment">-- valContext : TxInfo → ScriptPurpose → Data</a>
<a id="2750" class="Comment">-- valContext txinfo sp = toData (txinfo , sp)</a>

<a id="txOutToDataHash"></a><a id="2798" href="Ledger.Conway.Specification.Script.Validation.html#2798" class="Function">txOutToDataHash</a> <a id="2814" class="Symbol">:</a> <a id="2816" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="2822" class="Symbol">→</a> <a id="2824" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2830" href="Ledger.Conway.Specification.Script.Base.html#1723" class="Function">DataHash</a>
<a id="2839" href="Ledger.Conway.Specification.Script.Validation.html#2798" class="Function">txOutToDataHash</a> <a id="2855" class="Symbol">(_</a> <a id="2858" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2860" class="Symbol">_</a> <a id="2862" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2864" href="Ledger.Conway.Specification.Script.Validation.html#2864" class="Bound">d</a> <a id="2866" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2868" class="Symbol">_)</a> <a id="2871" class="Symbol">=</a> <a id="2873" href="Ledger.Conway.Specification.Script.Validation.html#2864" class="Bound">d</a> <a id="2875" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="2879" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="2887" href="Ledger.Conway.Specification.Script.Validation.html#2887" class="Function">txOutToP2Script</a>
  <a id="2905" class="Symbol">:</a> <a id="2907" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="2912" class="Symbol">→</a> <a id="2914" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a>
  <a id="2919" class="Symbol">→</a> <a id="2921" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="2927" class="Symbol">→</a> <a id="2929" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2935" href="Ledger.Conway.Specification.Script.Base.html#2367" class="Function">P2Script</a>
<a id="2944" href="Ledger.Conway.Specification.Script.Validation.html#2887" class="Function">txOutToP2Script</a> <a id="2960" href="Ledger.Conway.Specification.Script.Validation.html#2960" class="Bound">utxo</a> <a id="2965" href="Ledger.Conway.Specification.Script.Validation.html#2965" class="Bound">tx</a> <a id="2968" class="Symbol">(</a><a id="2969" href="Ledger.Conway.Specification.Script.Validation.html#2969" class="Bound">a</a> <a id="2971" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2973" class="Symbol">_)</a> <a id="2976" class="Symbol">=</a>
  <a id="2980" class="Keyword">do</a> <a id="2983" href="Ledger.Conway.Specification.Script.Validation.html#2983" class="Bound">sh</a> <a id="2986" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="2988" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3000" class="Symbol">(</a><a id="3001" href="Ledger.Core.Specification.Address.html#2685" class="Function">payCred</a> <a id="3009" href="Ledger.Conway.Specification.Script.Validation.html#2969" class="Bound">a</a><a id="3010" class="Symbol">)</a>
     <a id="3017" href="Ledger.Conway.Specification.Script.Validation.html#3017" class="Bound">s</a>  <a id="3020" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3022" href="Ledger.Conway.Specification.Transaction.html#6502" class="Function">lookupScriptHash</a> <a id="3039" href="Ledger.Conway.Specification.Script.Validation.html#2983" class="Bound">sh</a> <a id="3042" href="Ledger.Conway.Specification.Script.Validation.html#2965" class="Bound">tx</a> <a id="3045" href="Ledger.Conway.Specification.Script.Validation.html#2960" class="Bound">utxo</a>
     <a id="3055" href="Ledger.Conway.Specification.Script.Base.html#3220" class="Function">toP2Script</a> <a id="3066" href="Ledger.Conway.Specification.Script.Validation.html#3017" class="Bound">s</a>

<a id="3069" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3078" href="Ledger.Conway.Specification.Script.Validation.html#3078" class="Function">collectP2ScriptsWithContext</a>
    <a id="3110" class="Symbol">:</a> <a id="3112" href="Ledger.Conway.Specification.PParams.html#1689" class="Record">PParams</a> <a id="3120" class="Symbol">→</a> <a id="3122" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="3125" class="Symbol">→</a> <a id="3127" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
    <a id="3136" class="Symbol">→</a> <a id="3138" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3143" class="Symbol">(</a><a id="3144" href="Ledger.Conway.Specification.Script.Base.html#2367" class="Function">P2Script</a> <a id="3153" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3155" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3160" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="3165" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3167" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="3175" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3177" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="3186" class="Symbol">)</a>
  <a id="3190" href="Ledger.Conway.Specification.Script.Validation.html#3078" class="Function">collectP2ScriptsWithContext</a> <a id="3218" href="Ledger.Conway.Specification.Script.Validation.html#3218" class="Bound">pp</a> <a id="3221" href="Ledger.Conway.Specification.Script.Validation.html#3221" class="Bound">tx</a> <a id="3224" href="Ledger.Conway.Specification.Script.Validation.html#3224" class="Bound">utxo</a>
    <a id="3233" class="Symbol">=</a> <a id="3235" href="abstract-set-theory.FiniteSetTheory.html#2617" class="Function">setToList</a>
    <a id="3249" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3251" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3262" class="Symbol">(λ</a> <a id="3265" class="Symbol">(</a><a id="3266" href="Ledger.Conway.Specification.Script.Validation.html#3266" class="Bound">sp</a> <a id="3269" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3271" href="Ledger.Conway.Specification.Script.Validation.html#3271" class="Bound">c</a><a id="3272" class="Symbol">)</a> <a id="3274" class="Symbol">→</a> <a id="3276" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3279" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3291" href="Ledger.Conway.Specification.Script.Validation.html#3271" class="Bound">c</a>
                                <a id="3325" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3330" class="Symbol">(λ</a> <a id="3333" class="Symbol">{</a><a id="3334" href="Ledger.Conway.Specification.Script.Validation.html#3334" class="Bound">sh</a><a id="3336" class="Symbol">}</a> <a id="3338" class="Symbol">→</a> <a id="3340" href="Ledger.Conway.Specification.Script.Validation.html#3460" class="Function">toScriptInput</a> <a id="3354" href="Ledger.Conway.Specification.Script.Validation.html#3266" class="Bound">sp</a> <a id="3357" href="Ledger.Conway.Specification.Script.Validation.html#3334" class="Bound">sh</a><a id="3359" class="Symbol">)</a>
                                <a id="3393" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3398" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3405" class="Symbol">)</a>
    <a id="3411" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3413" href="Ledger.Conway.Specification.Script.Validation.html#1951" class="Function">credsNeeded</a> <a id="3425" href="Ledger.Conway.Specification.Script.Validation.html#3224" class="Bound">utxo</a> <a id="3430" class="Symbol">(</a><a id="3431" href="Ledger.Conway.Specification.Script.Validation.html#3221" class="Bound">tx</a> <a id="3434" class="Symbol">.</a><a id="3435" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">Tx.body</a><a id="3442" class="Symbol">)</a>
    <a id="3448" class="Keyword">where</a>
      <a id="3460" href="Ledger.Conway.Specification.Script.Validation.html#3460" class="Function">toScriptInput</a>
        <a id="3482" class="Symbol">:</a> <a id="3484" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#294" class="Datatype">ScriptPurpose</a> <a id="3498" class="Symbol">→</a> <a id="3500" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
        <a id="3519" class="Symbol">→</a> <a id="3521" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3527" class="Symbol">(</a><a id="3528" href="Ledger.Conway.Specification.Script.Base.html#2367" class="Function">P2Script</a> <a id="3537" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3539" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3544" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="3549" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3551" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="3559" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3561" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="3570" class="Symbol">)</a>
      <a id="3578" href="Ledger.Conway.Specification.Script.Validation.html#3460" class="Function">toScriptInput</a> <a id="3592" href="Ledger.Conway.Specification.Script.Validation.html#3592" class="Bound">sp</a> <a id="3595" href="Ledger.Conway.Specification.Script.Validation.html#3595" class="Bound">sh</a> <a id="3598" class="Symbol">=</a>
        <a id="3608" class="Keyword">do</a> <a id="3611" href="Ledger.Conway.Specification.Script.Validation.html#3611" class="Bound">s</a> <a id="3613" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3615" href="Ledger.Conway.Specification.Transaction.html#6502" class="Function">lookupScriptHash</a> <a id="3632" href="Ledger.Conway.Specification.Script.Validation.html#3595" class="Bound">sh</a> <a id="3635" href="Ledger.Conway.Specification.Script.Validation.html#3221" class="Bound">tx</a> <a id="3638" href="Ledger.Conway.Specification.Script.Validation.html#3224" class="Bound">utxo</a>
           <a id="3654" href="Ledger.Conway.Specification.Script.Validation.html#3654" class="Bound">p2s</a> <a id="3658" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3660" href="Ledger.Conway.Specification.Script.Base.html#3220" class="Function">toP2Script</a> <a id="3671" href="Ledger.Conway.Specification.Script.Validation.html#3611" class="Bound">s</a>
           <a id="3684" class="Symbol">(</a><a id="3685" href="Ledger.Conway.Specification.Script.Validation.html#3685" class="Bound">rdmr</a> <a id="3690" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3692" href="Ledger.Conway.Specification.Script.Validation.html#3692" class="Bound">exunits</a><a id="3699" class="Symbol">)</a> <a id="3701" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3703" href="Ledger.Conway.Specification.Script.Validation.html#1039" class="Function">indexedRdmrs</a> <a id="3716" href="Ledger.Conway.Specification.Script.Validation.html#3221" class="Bound">tx</a> <a id="3719" href="Ledger.Conway.Specification.Script.Validation.html#3592" class="Bound">sp</a>
           <a id="3733" class="Keyword">let</a> <a id="3737" href="Ledger.Conway.Specification.Script.Validation.html#3737" class="Bound">data&#39;</a>     <a id="3747" class="Symbol">=</a> <a id="3749" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="3755" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="3759" class="InductiveConstructor">[]</a> <a id="3762" class="Symbol">(</a><a id="3763" href="Ledger.Conway.Specification.Script.Validation.html#1223" class="Function">getDatum</a> <a id="3772" href="Ledger.Conway.Specification.Script.Validation.html#3221" class="Bound">tx</a> <a id="3775" href="Ledger.Conway.Specification.Script.Validation.html#3224" class="Bound">utxo</a> <a id="3780" href="Ledger.Conway.Specification.Script.Validation.html#3592" class="Bound">sp</a><a id="3782" class="Symbol">)</a> <a id="3784" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="3787" href="Ledger.Conway.Specification.Script.Validation.html#3685" class="Bound">rdmr</a> <a id="3792" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3794" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="3796" href="Ledger.Conway.Specification.Abstract.html#1099" class="Field">valContext</a> <a id="3807" class="Symbol">(</a><a id="3808" href="Ledger.Conway.Specification.Script.Validation.html#1641" class="Function">txInfo</a> <a id="3815" class="Symbol">(</a><a id="3816" href="Ledger.Conway.Specification.Script.Base.html#1964" class="Function">language</a> <a id="3825" href="Ledger.Conway.Specification.Script.Validation.html#3654" class="Bound">p2s</a><a id="3828" class="Symbol">)</a> <a id="3830" href="Ledger.Conway.Specification.Script.Validation.html#3218" class="Bound">pp</a> <a id="3833" href="Ledger.Conway.Specification.Script.Validation.html#3224" class="Bound">utxo</a> <a id="3838" href="Ledger.Conway.Specification.Script.Validation.html#3221" class="Bound">tx</a><a id="3840" class="Symbol">)</a> <a id="3842" href="Ledger.Conway.Specification.Script.Validation.html#3592" class="Bound">sp</a> <a id="3845" href="Data.List.Base.html#4907" class="Function Operator">]</a>
               <a id="3862" href="Ledger.Conway.Specification.Script.Validation.html#3862" class="Bound">costModel</a> <a id="3872" class="Symbol">=</a> <a id="3874" href="Ledger.Conway.Specification.PParams.html#3068" class="Field">PParams.costmdls</a> <a id="3891" href="Ledger.Conway.Specification.Script.Validation.html#3218" class="Bound">pp</a>
           <a id="3905" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3910" class="Symbol">(</a><a id="3911" href="Ledger.Conway.Specification.Script.Validation.html#3654" class="Bound">p2s</a> <a id="3915" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3917" href="Ledger.Conway.Specification.Script.Validation.html#3737" class="Bound">data&#39;</a> <a id="3923" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3925" href="Ledger.Conway.Specification.Script.Validation.html#3692" class="Bound">exunits</a> <a id="3933" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3935" href="Ledger.Conway.Specification.Script.Validation.html#3862" class="Bound">costModel</a><a id="3944" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="3947" href="Ledger.Conway.Specification.Script.Validation.html#3947" class="Function">evalP2Scripts</a> <a id="3961" class="Symbol">:</a> <a id="3963" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3968" class="Symbol">(</a><a id="3969" href="Ledger.Conway.Specification.Script.Base.html#2367" class="Function">P2Script</a> <a id="3978" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3980" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3985" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="3990" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3992" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="4000" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4002" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="4011" class="Symbol">)</a> <a id="4013" class="Symbol">→</a> <a id="4015" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4020" href="Ledger.Conway.Specification.Script.Validation.html#3947" class="Function">evalP2Scripts</a> <a id="4034" class="Symbol">=</a> <a id="4036" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="4040" class="Symbol">(λ</a> <a id="4043" class="Symbol">(</a><a id="4044" href="Ledger.Conway.Specification.Script.Validation.html#4044" class="Bound">s</a> <a id="4046" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4048" href="Ledger.Conway.Specification.Script.Validation.html#4048" class="Bound">d</a> <a id="4050" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4052" href="Ledger.Conway.Specification.Script.Validation.html#4052" class="Bound">eu</a> <a id="4055" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4057" href="Ledger.Conway.Specification.Script.Validation.html#4057" class="Bound">cm</a><a id="4059" class="Symbol">)</a> <a id="4061" class="Symbol">→</a> <a id="4063" href="Ledger.Conway.Specification.Abstract.html#992" class="Field">runPLCScript</a> <a id="4076" href="Ledger.Conway.Specification.Script.Validation.html#4057" class="Bound">cm</a> <a id="4079" href="Ledger.Conway.Specification.Script.Validation.html#4044" class="Bound">s</a> <a id="4081" href="Ledger.Conway.Specification.Script.Validation.html#4052" class="Bound">eu</a> <a id="4084" href="Ledger.Conway.Specification.Script.Validation.html#4048" class="Bound">d</a><a id="4085" class="Symbol">)</a>

</pre></body></html>