<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>

<a id="127" class="Keyword">module</a> <a id="134" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="182" class="Symbol">(</a><a id="183" href="Ledger.Conway.Specification.Script.Validation.html#183" class="Bound">txs</a> <a id="187" class="Symbol">:</a> <a id="189" class="Symbol">_)</a> <a id="192" class="Symbol">(</a><a id="193" class="Keyword">open</a> <a id="198" href="Ledger.Conway.Specification.Transaction.html#1000" class="Module">TransactionStructure</a> <a id="219" href="Ledger.Conway.Specification.Script.Validation.html#183" class="Bound">txs</a><a id="222" class="Symbol">)</a>
  <a id="226" class="Symbol">(</a><a id="227" href="Ledger.Conway.Specification.Script.Validation.html#227" class="Bound">abs</a> <a id="231" class="Symbol">:</a> <a id="233" href="Ledger.Conway.Specification.Abstract.html#654" class="Record">AbstractFunctions</a> <a id="251" href="Ledger.Conway.Specification.Script.Validation.html#183" class="Bound">txs</a><a id="254" class="Symbol">)</a> <a id="256" class="Symbol">(</a><a id="257" class="Keyword">open</a> <a id="262" href="Ledger.Conway.Specification.Abstract.html#654" class="Module">AbstractFunctions</a> <a id="280" href="Ledger.Conway.Specification.Script.Validation.html#227" class="Bound">abs</a><a id="283" class="Symbol">)</a> <a id="285" class="Symbol">(</a><a id="286" class="Keyword">open</a> <a id="291" href="Ledger.Conway.Specification.Abstract.html#282" class="Module">indexOf</a> <a id="299" href="Ledger.Conway.Specification.Abstract.html#786" class="Field">indexOfImp</a><a id="309" class="Symbol">)</a>
  <a id="313" class="Keyword">where</a>

<a id="320" class="Keyword">open</a> <a id="325" class="Keyword">import</a> <a id="332" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="393" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>

<a id="407" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="412" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="426" class="Symbol">:</a> <a id="428" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="433" class="Keyword">where</a>
  <a id="ScriptPurpose.Cert"></a><a id="441" href="Ledger.Conway.Specification.Script.Validation.html#441" class="InductiveConstructor">Cert</a>     <a id="450" class="Symbol">:</a> <a id="452" href="Ledger.Conway.Specification.Certs.html#2221" class="Datatype">DCert</a>        <a id="465" class="Symbol">→</a> <a id="467" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Rwrd"></a><a id="483" href="Ledger.Conway.Specification.Script.Validation.html#483" class="InductiveConstructor">Rwrd</a>     <a id="492" class="Symbol">:</a> <a id="494" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>      <a id="507" class="Symbol">→</a> <a id="509" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Mint"></a><a id="525" href="Ledger.Conway.Specification.Script.Validation.html#525" class="InductiveConstructor">Mint</a>     <a id="534" class="Symbol">:</a> <a id="536" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>   <a id="549" class="Symbol">→</a> <a id="551" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Spend"></a><a id="567" href="Ledger.Conway.Specification.Script.Validation.html#567" class="InductiveConstructor">Spend</a>    <a id="576" class="Symbol">:</a> <a id="578" href="Ledger.Conway.Specification.Transaction.html#2607" class="Function">TxIn</a>         <a id="591" class="Symbol">→</a> <a id="593" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Vote"></a><a id="609" href="Ledger.Conway.Specification.Script.Validation.html#609" class="InductiveConstructor">Vote</a>     <a id="618" class="Symbol">:</a> <a id="620" href="Ledger.Conway.Specification.Gov.Actions.html#539" class="Record">GovVoter</a>     <a id="633" class="Symbol">→</a> <a id="635" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Propose"></a><a id="651" href="Ledger.Conway.Specification.Script.Validation.html#651" class="InductiveConstructor">Propose</a>  <a id="660" class="Symbol">:</a> <a id="662" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Record">GovProposal</a>  <a id="675" class="Symbol">→</a> <a id="677" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a>

<a id="rdptr"></a><a id="692" href="Ledger.Conway.Specification.Script.Validation.html#692" class="Function">rdptr</a> <a id="698" class="Symbol">:</a> <a id="700" href="Ledger.Conway.Specification.Transaction.html#2998" class="Record">TxBody</a> <a id="707" class="Symbol">→</a> <a id="709" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="723" class="Symbol">→</a> <a id="725" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="731" href="Ledger.Conway.Specification.Transaction.html#2754" class="Function">RdmrPtr</a>
<a id="739" href="Ledger.Conway.Specification.Script.Validation.html#692" class="Function">rdptr</a> <a id="745" href="Ledger.Conway.Specification.Script.Validation.html#745" class="Bound">txb</a> <a id="749" class="Symbol">=</a> <a id="751" class="Symbol">λ</a> <a id="753" class="Keyword">where</a>
  <a id="761" class="Symbol">(</a><a id="762" href="Ledger.Conway.Specification.Script.Validation.html#441" class="InductiveConstructor">Cert</a> <a id="767" href="Ledger.Conway.Specification.Script.Validation.html#767" class="Bound">h</a><a id="768" class="Symbol">)</a>     <a id="774" class="Symbol">→</a> <a id="776" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="780" class="Symbol">(</a><a id="781" href="Ledger.Conway.Specification.Transaction.html#892" class="InductiveConstructor">Cert</a>    <a id="789" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="791" class="Symbol">)</a> <a id="793" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="795" href="Ledger.Conway.Specification.Abstract.html#315" class="Function">indexOfDCert</a>    <a id="811" href="Ledger.Conway.Specification.Script.Validation.html#767" class="Bound">h</a> <a id="813" href="Ledger.Conway.Specification.Transaction.html#3216" class="Field">txCerts</a>
  <a id="823" class="Symbol">(</a><a id="824" href="Ledger.Conway.Specification.Script.Validation.html#483" class="InductiveConstructor">Rwrd</a> <a id="829" href="Ledger.Conway.Specification.Script.Validation.html#829" class="Bound">h</a><a id="830" class="Symbol">)</a>     <a id="836" class="Symbol">→</a> <a id="838" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="842" class="Symbol">(</a><a id="843" href="Ledger.Conway.Specification.Transaction.html#897" class="InductiveConstructor">Rewrd</a>   <a id="851" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="853" class="Symbol">)</a> <a id="855" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="857" href="Ledger.Conway.Specification.Abstract.html#367" class="Function">indexOfRwdAddr</a>  <a id="873" href="Ledger.Conway.Specification.Script.Validation.html#829" class="Bound">h</a> <a id="875" href="Ledger.Conway.Specification.Transaction.html#3290" class="Field">txWithdrawals</a>
  <a id="891" class="Symbol">(</a><a id="892" href="Ledger.Conway.Specification.Script.Validation.html#525" class="InductiveConstructor">Mint</a> <a id="897" href="Ledger.Conway.Specification.Script.Validation.html#897" class="Bound">h</a><a id="898" class="Symbol">)</a>     <a id="904" class="Symbol">→</a> <a id="906" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="910" class="Symbol">(</a><a id="911" href="Ledger.Conway.Specification.Transaction.html#887" class="InductiveConstructor">Mint</a>    <a id="919" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="921" class="Symbol">)</a> <a id="923" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="925" href="Ledger.Conway.Specification.Abstract.html#469" class="Function">indexOfPolicyId</a> <a id="941" href="Ledger.Conway.Specification.Script.Validation.html#897" class="Bound">h</a> <a id="943" class="Symbol">(</a><a id="944" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#928" class="Function">policies</a> <a id="953" href="Ledger.Conway.Specification.Transaction.html#3640" class="Field">mint</a><a id="957" class="Symbol">)</a>
  <a id="961" class="Symbol">(</a><a id="962" href="Ledger.Conway.Specification.Script.Validation.html#567" class="InductiveConstructor">Spend</a> <a id="968" href="Ledger.Conway.Specification.Script.Validation.html#968" class="Bound">h</a><a id="969" class="Symbol">)</a>    <a id="974" class="Symbol">→</a> <a id="976" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="980" class="Symbol">(</a><a id="981" href="Ledger.Conway.Specification.Transaction.html#881" class="InductiveConstructor">Spend</a>   <a id="989" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="991" class="Symbol">)</a> <a id="993" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="995" href="Ledger.Conway.Specification.Abstract.html#422" class="Function">indexOfTxIn</a>     <a id="1011" href="Ledger.Conway.Specification.Script.Validation.html#968" class="Bound">h</a> <a id="1013" href="Ledger.Conway.Specification.Transaction.html#3034" class="Field">txIns</a>
  <a id="1021" class="Symbol">(</a><a id="1022" href="Ledger.Conway.Specification.Script.Validation.html#609" class="InductiveConstructor">Vote</a> <a id="1027" href="Ledger.Conway.Specification.Script.Validation.html#1027" class="Bound">h</a><a id="1028" class="Symbol">)</a>     <a id="1034" class="Symbol">→</a> <a id="1036" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1040" class="Symbol">(</a><a id="1041" href="Ledger.Conway.Specification.Transaction.html#903" class="InductiveConstructor">Vote</a>    <a id="1049" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1051" class="Symbol">)</a> <a id="1053" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1055" href="Ledger.Conway.Specification.Abstract.html#528" class="Function">indexOfVote</a>     <a id="1071" href="Ledger.Conway.Specification.Script.Validation.html#1027" class="Bound">h</a> <a id="1073" class="Symbol">(</a><a id="1074" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1078" href="Ledger.Conway.Specification.Gov.Actions.html#3333" class="Field">GovVote.voter</a> <a id="1092" href="Ledger.Conway.Specification.Transaction.html#3465" class="Field">txGovVotes</a><a id="1102" class="Symbol">)</a>
  <a id="1106" class="Symbol">(</a><a id="1107" href="Ledger.Conway.Specification.Script.Validation.html#651" class="InductiveConstructor">Propose</a> <a id="1115" href="Ledger.Conway.Specification.Script.Validation.html#1115" class="Bound">h</a><a id="1116" class="Symbol">)</a>  <a id="1119" class="Symbol">→</a> <a id="1121" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1125" class="Symbol">(</a><a id="1126" href="Ledger.Conway.Specification.Transaction.html#908" class="InductiveConstructor">Propose</a> <a id="1134" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1136" class="Symbol">)</a> <a id="1138" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1140" href="Ledger.Conway.Specification.Abstract.html#586" class="Function">indexOfProposal</a> <a id="1156" href="Ledger.Conway.Specification.Script.Validation.html#1115" class="Bound">h</a> <a id="1158" href="Ledger.Conway.Specification.Transaction.html#3507" class="Field">txGovProposals</a>
 <a id="1174" class="Keyword">where</a> <a id="1180" class="Keyword">open</a> <a id="1185" href="Ledger.Conway.Specification.Transaction.html#2998" class="Module">TxBody</a> <a id="1192" href="Ledger.Conway.Specification.Script.Validation.html#745" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1197" href="Ledger.Conway.Specification.Script.Validation.html#1197" class="Function">indexedRdmrs</a> <a id="1210" class="Symbol">:</a> <a id="1212" href="Ledger.Conway.Specification.Transaction.html#4684" class="Record">Tx</a> <a id="1215" class="Symbol">→</a> <a id="1217" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="1231" class="Symbol">→</a> <a id="1233" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1239" class="Symbol">(</a><a id="1240" href="Ledger.Conway.Specification.Script.Base.html#1787" class="Function">Redeemer</a> <a id="1249" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1251" href="Ledger.Conway.Specification.Script.Base.html#1017" class="Function">ExUnits</a><a id="1258" class="Symbol">)</a>
<a id="1260" href="Ledger.Conway.Specification.Script.Validation.html#1197" class="Function">indexedRdmrs</a> <a id="1273" href="Ledger.Conway.Specification.Script.Validation.html#1273" class="Bound">tx</a> <a id="1276" href="Ledger.Conway.Specification.Script.Validation.html#1276" class="Bound">sp</a> <a id="1279" class="Symbol">=</a> <a id="1281" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1287" class="Symbol">(λ</a> <a id="1290" href="Ledger.Conway.Specification.Script.Validation.html#1290" class="Bound">x</a> <a id="1292" class="Symbol">→</a> <a id="1294" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="1303" href="Ledger.Conway.Specification.Transaction.html#4559" class="Function">txrdmrs</a> <a id="1311" href="Ledger.Conway.Specification.Script.Validation.html#1290" class="Bound">x</a><a id="1312" class="Symbol">)</a> <a id="1314" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1322" class="Symbol">(</a><a id="1323" href="Ledger.Conway.Specification.Script.Validation.html#692" class="Function">rdptr</a> <a id="1329" href="Ledger.Conway.Specification.Transaction.html#4716" class="Function">body</a> <a id="1334" href="Ledger.Conway.Specification.Script.Validation.html#1276" class="Bound">sp</a><a id="1336" class="Symbol">)</a>
  <a id="1340" class="Keyword">where</a> <a id="1346" class="Keyword">open</a> <a id="1351" href="Ledger.Conway.Specification.Transaction.html#4684" class="Module">Tx</a> <a id="1354" href="Ledger.Conway.Specification.Script.Validation.html#1273" class="Bound">tx</a><a id="1356" class="Symbol">;</a> <a id="1358" class="Keyword">open</a> <a id="1363" href="Ledger.Conway.Specification.Transaction.html#4439" class="Module">TxWitnesses</a> <a id="1375" href="Ledger.Conway.Specification.Transaction.html#4740" class="Function">wits</a>

<a id="getDatum"></a><a id="1381" href="Ledger.Conway.Specification.Script.Validation.html#1381" class="Function">getDatum</a> <a id="1390" class="Symbol">:</a> <a id="1392" href="Ledger.Conway.Specification.Transaction.html#4684" class="Record">Tx</a> <a id="1395" class="Symbol">→</a> <a id="1397" href="Ledger.Conway.Specification.Transaction.html#2718" class="Function">UTxO</a> <a id="1402" class="Symbol">→</a> <a id="1404" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="1418" class="Symbol">→</a> <a id="1420" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1426" href="Ledger.Conway.Specification.Script.Base.html#1769" class="Function">Datum</a>
<a id="1432" href="Ledger.Conway.Specification.Script.Validation.html#1381" class="Function">getDatum</a> <a id="1441" href="Ledger.Conway.Specification.Script.Validation.html#1441" class="Bound">tx</a> <a id="1444" href="Ledger.Conway.Specification.Script.Validation.html#1444" class="Bound">utxo</a> <a id="1449" class="Symbol">(</a><a id="1450" href="Ledger.Conway.Specification.Script.Validation.html#567" class="InductiveConstructor">Spend</a> <a id="1456" href="Ledger.Conway.Specification.Script.Validation.html#1456" class="Bound">txin</a><a id="1460" class="Symbol">)</a> <a id="1462" class="Symbol">=</a>
  <a id="1466" class="Keyword">do</a> <a id="1469" class="Symbol">(_</a> <a id="1472" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1474" class="Symbol">_</a> <a id="1476" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1478" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1483" href="Ledger.Conway.Specification.Script.Validation.html#1483" class="Bound">d</a> <a id="1485" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1487" class="Symbol">_)</a> <a id="1490" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1492" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="1501" href="Ledger.Conway.Specification.Script.Validation.html#1444" class="Bound">utxo</a> <a id="1506" href="Ledger.Conway.Specification.Script.Validation.html#1456" class="Bound">txin</a>
                          <a id="1537" class="Keyword">where</a>
                            <a id="1571" class="Symbol">(_</a> <a id="1574" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1576" class="Symbol">_</a> <a id="1578" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1580" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1588" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1590" class="Symbol">_)</a> <a id="1593" class="Symbol">→</a> <a id="1595" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1608" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1613" href="Ledger.Conway.Specification.Script.Validation.html#1483" class="Bound">d</a> <a id="1615" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1618" class="Symbol">λ</a> <a id="1620" class="Keyword">where</a>
       <a id="1633" class="Symbol">(</a><a id="1634" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1639" href="Ledger.Conway.Specification.Script.Validation.html#1639" class="Bound">d</a><a id="1640" class="Symbol">)</a> <a id="1642" class="Symbol">→</a> <a id="1644" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1649" href="Ledger.Conway.Specification.Script.Validation.html#1639" class="Bound">d</a>
       <a id="1658" class="Symbol">(</a><a id="1659" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1664" href="Ledger.Conway.Specification.Script.Validation.html#1664" class="Bound">h</a><a id="1665" class="Symbol">)</a> <a id="1667" class="Symbol">→</a> <a id="1669" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="1678" href="Ledger.Conway.Specification.Script.Validation.html#1700" class="Function">m</a> <a id="1680" href="Ledger.Conway.Specification.Script.Validation.html#1664" class="Bound">h</a>
     <a id="1687" class="Keyword">where</a>
       <a id="1700" href="Ledger.Conway.Specification.Script.Validation.html#1700" class="Function">m</a> <a id="1702" class="Symbol">=</a> <a id="1704" href="Ledger.Prelude.html#1740" class="Function">setToMap</a> <a id="1713" class="Symbol">(</a><a id="1714" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1719" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1721" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="1726" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1728" href="Function.Base.html#704" class="Function">id</a> <a id="1731" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1733" class="Symbol">(</a><a id="1734" href="Ledger.Conway.Specification.Transaction.html#4534" class="Field">TxWitnesses.txdats</a> <a id="1753" class="Symbol">(</a><a id="1754" href="Ledger.Conway.Specification.Transaction.html#4740" class="Field">Tx.wits</a> <a id="1762" href="Ledger.Conway.Specification.Script.Validation.html#1441" class="Bound">tx</a><a id="1764" class="Symbol">)))</a>
<a id="1768" href="Ledger.Conway.Specification.Script.Validation.html#1381" class="CatchallClause Function">getDatum</a><a id="1776" class="CatchallClause"> </a><a id="1777" href="Ledger.Conway.Specification.Script.Validation.html#1777" class="CatchallClause Bound">tx</a><a id="1779" class="CatchallClause"> </a><a id="1780" href="Ledger.Conway.Specification.Script.Validation.html#1780" class="CatchallClause Bound">utxo</a><a id="1784" class="CatchallClause"> </a><a id="1785" class="CatchallClause Symbol">_</a> <a id="1787" class="Symbol">=</a> <a id="1789" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="1798" class="Keyword">record</a> <a id="TxInfo"></a><a id="1805" href="Ledger.Conway.Specification.Script.Validation.html#1805" class="Record">TxInfo</a> <a id="1812" class="Symbol">:</a> <a id="1814" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1819" class="Keyword">where</a>
  <a id="1827" class="Keyword">field</a> <a id="TxInfo.realizedInputs"></a><a id="1833" href="Ledger.Conway.Specification.Script.Validation.html#1833" class="Field">realizedInputs</a> <a id="1848" class="Symbol">:</a> <a id="1850" href="Ledger.Conway.Specification.Transaction.html#2718" class="Function">UTxO</a>
        <a id="TxInfo.txOuts"></a><a id="1863" href="Ledger.Conway.Specification.Script.Validation.html#1863" class="Field">txOuts</a>         <a id="1878" class="Symbol">:</a> <a id="1880" href="Ledger.Conway.Specification.Transaction.html#1049" class="Field">Ix</a> <a id="1883" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1885" href="Ledger.Conway.Specification.Transaction.html#2640" class="Function">TxOut</a>
        <a id="TxInfo.fee"></a><a id="1899" href="Ledger.Conway.Specification.Script.Validation.html#1899" class="Field">fee</a>            <a id="1914" class="Symbol">:</a> <a id="1916" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#518" class="Function">Value</a>
        <a id="TxInfo.mint"></a><a id="1930" href="Ledger.Conway.Specification.Script.Validation.html#1930" class="Field">mint</a>           <a id="1945" class="Symbol">:</a> <a id="1947" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#518" class="Function">Value</a>
        <a id="TxInfo.txCerts"></a><a id="1961" href="Ledger.Conway.Specification.Script.Validation.html#1961" class="Field">txCerts</a>        <a id="1976" class="Symbol">:</a> <a id="1978" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1983" href="Ledger.Conway.Specification.Certs.html#2221" class="Datatype">DCert</a>
        <a id="TxInfo.txWithdrawals"></a><a id="1997" href="Ledger.Conway.Specification.Script.Validation.html#1997" class="Field">txWithdrawals</a>  <a id="2012" class="Symbol">:</a> <a id="2014" href="Ledger.Core.Specification.Address.html#1399" class="Function">Withdrawals</a>
        <a id="TxInfo.txVldt"></a><a id="2034" href="Ledger.Conway.Specification.Script.Validation.html#2034" class="Field">txVldt</a>         <a id="2049" class="Symbol">:</a> <a id="2051" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2057" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a> <a id="2062" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2064" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2070" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a>
        <a id="TxInfo.vkKey"></a><a id="2083" href="Ledger.Conway.Specification.Script.Validation.html#2083" class="Field">vkKey</a>          <a id="2098" class="Symbol">:</a> <a id="2100" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2102" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
        <a id="TxInfo.txdats"></a><a id="2118" href="Ledger.Conway.Specification.Script.Validation.html#2118" class="Field">txdats</a>         <a id="2133" class="Symbol">:</a> <a id="2135" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2137" href="Ledger.Conway.Specification.Script.Base.html#1769" class="Function">Datum</a>
        <a id="TxInfo.txId"></a><a id="2151" href="Ledger.Conway.Specification.Script.Validation.html#2151" class="Field">txId</a>           <a id="2166" class="Symbol">:</a> <a id="2168" href="Ledger.Conway.Specification.Transaction.html#1052" class="Field">TxId</a>

<a id="txInfo"></a><a id="2174" href="Ledger.Conway.Specification.Script.Validation.html#2174" class="Function">txInfo</a> <a id="2181" class="Symbol">:</a> <a id="2183" href="Ledger.Conway.Specification.Script.Base.html#966" class="Function">Language</a> <a id="2192" class="Symbol">→</a> <a id="2194" href="Ledger.Conway.Specification.PParams.html#1685" class="Record">PParams</a>
                  <a id="2220" class="Symbol">→</a> <a id="2222" href="Ledger.Conway.Specification.Transaction.html#2718" class="Function">UTxO</a>
                  <a id="2245" class="Symbol">→</a> <a id="2247" href="Ledger.Conway.Specification.Transaction.html#4684" class="Record">Tx</a>
                  <a id="2268" class="Symbol">→</a> <a id="2270" href="Ledger.Conway.Specification.Script.Validation.html#1805" class="Record">TxInfo</a>
<a id="2277" href="Ledger.Conway.Specification.Script.Validation.html#2174" class="Function">txInfo</a> <a id="2284" href="Ledger.Conway.Specification.Script.Validation.html#2284" class="Bound">l</a> <a id="2286" href="Ledger.Conway.Specification.Script.Validation.html#2286" class="Bound">pp</a> <a id="2289" href="Ledger.Conway.Specification.Script.Validation.html#2289" class="Bound">utxo</a> <a id="2294" href="Ledger.Conway.Specification.Script.Validation.html#2294" class="Bound">tx</a> <a id="2297" class="Symbol">=</a> <a id="2299" class="Keyword">record</a>
  <a id="2308" class="Symbol">{</a> <a id="2310" href="Ledger.Conway.Specification.Script.Validation.html#2310" class="Module">TxBody</a> <a id="2317" href="Ledger.Conway.Specification.Transaction.html#4716" class="Field">body</a>
  <a id="2324" class="Symbol">;</a> <a id="2326" href="Ledger.Conway.Specification.Script.Validation.html#2326" class="Module">TxWitnesses</a> <a id="2338" href="Ledger.Conway.Specification.Transaction.html#4740" class="Field">wits</a>
  <a id="2345" class="Symbol">;</a> <a id="2347" href="Ledger.Conway.Specification.Script.Validation.html#1833" class="Field">realizedInputs</a> <a id="2362" class="Symbol">=</a> <a id="2364" href="Ledger.Conway.Specification.Script.Validation.html#2289" class="Bound">utxo</a> <a id="2369" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2371" href="Ledger.Conway.Specification.Transaction.html#3034" class="Function">txIns</a>
  <a id="2379" class="Symbol">;</a> <a id="2381" href="Ledger.Conway.Specification.Script.Validation.html#1899" class="Field">fee</a> <a id="2385" class="Symbol">=</a> <a id="2387" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2394" href="Ledger.Conway.Specification.Transaction.html#3256" class="Function">txFee</a>
  <a id="2402" class="Symbol">;</a> <a id="2404" href="Ledger.Conway.Specification.Script.Validation.html#1930" class="Field">mint</a> <a id="2409" class="Symbol">=</a> <a id="2411" href="Ledger.Conway.Specification.Transaction.html#3640" class="Function">mint</a>
  <a id="2418" class="Symbol">;</a> <a id="2420" href="Ledger.Conway.Specification.Script.Validation.html#2083" class="Field">vkKey</a> <a id="2426" class="Symbol">=</a> <a id="2428" href="Ledger.Conway.Specification.Transaction.html#3675" class="Function">reqSignerHashes</a>
  <a id="2446" class="Symbol">}</a> <a id="2448" class="Keyword">where</a> <a id="2454" class="Keyword">open</a> <a id="2459" href="Ledger.Conway.Specification.Transaction.html#4684" class="Module">Tx</a> <a id="2462" href="Ledger.Conway.Specification.Script.Validation.html#2294" class="Bound">tx</a><a id="2464" class="Symbol">;</a> <a id="2466" class="Keyword">open</a> <a id="2471" href="Ledger.Conway.Specification.Transaction.html#2998" class="Module">TxBody</a> <a id="2478" href="Ledger.Conway.Specification.Transaction.html#4716" class="Field">body</a>

<a id="credsNeeded"></a><a id="2484" href="Ledger.Conway.Specification.Script.Validation.html#2484" class="Function">credsNeeded</a> <a id="2496" class="Symbol">:</a> <a id="2498" href="Ledger.Conway.Specification.Transaction.html#2718" class="Function">UTxO</a> <a id="2503" class="Symbol">→</a> <a id="2505" href="Ledger.Conway.Specification.Transaction.html#2998" class="Record">TxBody</a> <a id="2512" class="Symbol">→</a> <a id="2514" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2516" class="Symbol">(</a><a id="2517" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="2531" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2533" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a><a id="2543" class="Symbol">)</a>
<a id="2545" href="Ledger.Conway.Specification.Script.Validation.html#2484" class="Function">credsNeeded</a> <a id="2557" href="Ledger.Conway.Specification.Script.Validation.html#2557" class="Bound">utxo</a> <a id="2562" href="Ledger.Conway.Specification.Script.Validation.html#2562" class="Bound">txb</a>
  <a id="2568" class="Symbol">=</a>  <a id="2571" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2576" class="Symbol">(λ</a> <a id="2579" class="Symbol">(</a><a id="2580" href="Ledger.Conway.Specification.Script.Validation.html#2580" class="Bound">i</a> <a id="2582" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2584" href="Ledger.Conway.Specification.Script.Validation.html#2584" class="Bound">o</a><a id="2585" class="Symbol">)</a>  <a id="2588" class="Symbol">→</a> <a id="2590" class="Symbol">(</a><a id="2591" href="Ledger.Conway.Specification.Script.Validation.html#567" class="InductiveConstructor">Spend</a>  <a id="2598" href="Ledger.Conway.Specification.Script.Validation.html#2580" class="Bound">i</a> <a id="2600" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2602" href="Ledger.Core.Specification.Address.html#2639" class="Function">payCred</a> <a id="2610" class="Symbol">(</a><a id="2611" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2617" href="Ledger.Conway.Specification.Script.Validation.html#2584" class="Bound">o</a><a id="2618" class="Symbol">)))</a> <a id="2622" class="Symbol">((</a><a id="2624" href="Ledger.Conway.Specification.Script.Validation.html#2557" class="Bound">utxo</a> <a id="2629" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2631" class="Symbol">(</a><a id="2632" href="Ledger.Conway.Specification.Transaction.html#3034" class="Field">txIns</a> <a id="2638" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="2640" href="Ledger.Conway.Specification.Transaction.html#3106" class="Field">collateralInputs</a><a id="2656" class="Symbol">))</a> <a id="2659" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2660" class="Symbol">)</a>
  <a id="2664" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2667" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2672" class="Symbol">(λ</a> <a id="2675" href="Ledger.Conway.Specification.Script.Validation.html#2675" class="Bound">a</a>        <a id="2684" class="Symbol">→</a> <a id="2686" class="Symbol">(</a><a id="2687" href="Ledger.Conway.Specification.Script.Validation.html#483" class="InductiveConstructor">Rwrd</a>   <a id="2694" href="Ledger.Conway.Specification.Script.Validation.html#2675" class="Bound">a</a> <a id="2696" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2698" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="2704" href="Ledger.Conway.Specification.Script.Validation.html#2675" class="Bound">a</a><a id="2705" class="Symbol">))</a> <a id="2708" class="Symbol">(</a><a id="2709" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2713" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="2715" href="Ledger.Conway.Specification.Transaction.html#3290" class="Field">txWithdrawals</a> <a id="2729" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a><a id="2730" class="Symbol">)</a>
  <a id="2734" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2737" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="2748" class="Symbol">(λ</a> <a id="2751" href="Ledger.Conway.Specification.Script.Validation.html#2751" class="Bound">c</a>  <a id="2754" class="Symbol">→</a> <a id="2756" class="Symbol">(</a><a id="2757" href="Ledger.Conway.Specification.Script.Validation.html#441" class="InductiveConstructor">Cert</a>   <a id="2764" href="Ledger.Conway.Specification.Script.Validation.html#2751" class="Bound">c</a> <a id="2766" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2768" class="Symbol">)</a> <a id="2770" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2774" href="Ledger.Conway.Specification.Certs.html#2975" class="Function">cwitness</a> <a id="2783" href="Ledger.Conway.Specification.Script.Validation.html#2751" class="Bound">c</a><a id="2784" class="Symbol">)</a> <a id="2786" class="Symbol">(</a><a id="2787" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="2796" href="Ledger.Conway.Specification.Transaction.html#3216" class="Field">txCerts</a><a id="2803" class="Symbol">)</a>
  <a id="2807" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2810" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2815" class="Symbol">(λ</a> <a id="2818" href="Ledger.Conway.Specification.Script.Validation.html#2818" class="Bound">x</a>        <a id="2827" class="Symbol">→</a> <a id="2829" class="Symbol">(</a><a id="2830" href="Ledger.Conway.Specification.Script.Validation.html#525" class="InductiveConstructor">Mint</a>   <a id="2837" href="Ledger.Conway.Specification.Script.Validation.html#2818" class="Bound">x</a> <a id="2839" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2841" href="Ledger.Core.Specification.Address.html#322" class="InductiveConstructor">ScriptObj</a> <a id="2851" href="Ledger.Conway.Specification.Script.Validation.html#2818" class="Bound">x</a><a id="2852" class="Symbol">))</a> <a id="2855" class="Symbol">(</a><a id="2856" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#928" class="Function">policies</a> <a id="2865" href="Ledger.Conway.Specification.Transaction.html#3640" class="Field">mint</a><a id="2869" class="Symbol">)</a>
  <a id="2873" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2876" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="2887" class="Symbol">(λ</a> <a id="2890" href="Ledger.Conway.Specification.Script.Validation.html#2890" class="Bound">v</a> <a id="2892" class="Symbol">→</a> <a id="2894" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2897" href="Ledger.Conway.Specification.Gov.Actions.html#6066" class="Function">isGovVoterCredential</a> <a id="2918" href="Ledger.Conway.Specification.Script.Validation.html#2890" class="Bound">v</a> <a id="2920" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2925" class="Symbol">(λ</a> <a id="2928" class="Symbol">{</a><a id="2929" href="Ledger.Conway.Specification.Script.Validation.html#2929" class="Bound">c</a><a id="2930" class="Symbol">}</a> <a id="2932" class="Symbol">→</a> <a id="2934" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2939" class="Symbol">(</a><a id="2940" href="Ledger.Conway.Specification.Script.Validation.html#609" class="InductiveConstructor">Vote</a> <a id="2945" href="Ledger.Conway.Specification.Script.Validation.html#2890" class="Bound">v</a> <a id="2947" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2949" href="Ledger.Conway.Specification.Script.Validation.html#2929" class="Bound">c</a><a id="2950" class="Symbol">))</a> <a id="2953" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2958" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2965" class="Symbol">)</a>
                <a id="2983" class="Symbol">(</a><a id="2984" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="2993" class="Symbol">(</a><a id="2994" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2998" href="Ledger.Conway.Specification.Gov.Actions.html#3333" class="Field">voter</a> <a id="3004" href="Ledger.Conway.Specification.Transaction.html#3465" class="Field">txGovVotes</a><a id="3014" class="Symbol">))</a>
  <a id="3019" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="3022" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3033" class="Symbol">(λ</a> <a id="3036" href="Ledger.Conway.Specification.Script.Validation.html#3036" class="Bound">p</a> <a id="3038" class="Symbol">→</a> <a id="3040" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3043" href="Ledger.Conway.Specification.Script.Validation.html#3036" class="Bound">p</a> <a id="3045" class="Symbol">.</a><a id="3046" href="Ledger.Conway.Specification.Gov.Actions.html#3527" class="Field">policy</a> <a id="3053" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3058" class="Symbol">(λ</a> <a id="3061" class="Symbol">{</a><a id="3062" href="Ledger.Conway.Specification.Script.Validation.html#3062" class="Bound">sh</a><a id="3064" class="Symbol">}</a> <a id="3066" class="Symbol">→</a> <a id="3068" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3073" class="Symbol">(</a><a id="3074" href="Ledger.Conway.Specification.Script.Validation.html#651" class="InductiveConstructor">Propose</a>  <a id="3083" href="Ledger.Conway.Specification.Script.Validation.html#3036" class="Bound">p</a> <a id="3085" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3087" href="Ledger.Core.Specification.Address.html#322" class="InductiveConstructor">ScriptObj</a> <a id="3097" href="Ledger.Conway.Specification.Script.Validation.html#3062" class="Bound">sh</a><a id="3099" class="Symbol">))</a> <a id="3102" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3107" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3114" class="Symbol">)</a>
                <a id="3132" class="Symbol">(</a><a id="3133" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="3142" href="Ledger.Conway.Specification.Transaction.html#3507" class="Field">txGovProposals</a><a id="3156" class="Symbol">)</a>
  <a id="3160" class="Keyword">where</a>
    <a id="3170" class="Keyword">open</a> <a id="3175" href="Ledger.Conway.Specification.Transaction.html#2998" class="Module">TxBody</a> <a id="3182" href="Ledger.Conway.Specification.Script.Validation.html#2562" class="Bound">txb</a>
    <a id="3190" class="Keyword">open</a> <a id="3195" href="Ledger.Conway.Specification.Gov.Actions.html#3270" class="Module">GovVote</a>
    <a id="3207" class="Keyword">open</a> <a id="3212" href="Ledger.Core.Specification.Address.html#1324" class="Module">RwdAddr</a>
    <a id="3224" class="Keyword">open</a> <a id="3229" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Module">GovProposal</a>

<a id="valContext"></a><a id="3242" href="Ledger.Conway.Specification.Script.Validation.html#3242" class="Function">valContext</a> <a id="3253" class="Symbol">:</a> <a id="3255" href="Ledger.Conway.Specification.Script.Validation.html#1805" class="Record">TxInfo</a> <a id="3262" class="Symbol">→</a> <a id="3264" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="3278" class="Symbol">→</a> <a id="3280" href="Ledger.Conway.Specification.Script.Base.html#1707" class="Function">Data</a>
<a id="3285" href="Ledger.Conway.Specification.Script.Validation.html#3242" class="Function">valContext</a> <a id="3296" href="Ledger.Conway.Specification.Script.Validation.html#3296" class="Bound">txinfo</a> <a id="3303" href="Ledger.Conway.Specification.Script.Validation.html#3303" class="Bound">sp</a> <a id="3306" class="Symbol">=</a> <a id="3308" href="Ledger.Conway.Specification.Script.Base.html#2006" class="Function">toData</a> <a id="3315" class="Symbol">(</a><a id="3316" href="Ledger.Conway.Specification.Script.Validation.html#3296" class="Bound">txinfo</a> <a id="3323" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3325" href="Ledger.Conway.Specification.Script.Validation.html#3303" class="Bound">sp</a><a id="3327" class="Symbol">)</a>

<a id="txOutToDataHash"></a><a id="3330" href="Ledger.Conway.Specification.Script.Validation.html#3330" class="Function">txOutToDataHash</a> <a id="3346" class="Symbol">:</a> <a id="3348" href="Ledger.Conway.Specification.Transaction.html#2640" class="Function">TxOut</a> <a id="3354" class="Symbol">→</a> <a id="3356" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3362" href="Ledger.Conway.Specification.Script.Base.html#1722" class="Function">DataHash</a>
<a id="3371" href="Ledger.Conway.Specification.Script.Validation.html#3330" class="Function">txOutToDataHash</a> <a id="3387" class="Symbol">(_</a> <a id="3390" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3392" class="Symbol">_</a> <a id="3394" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3396" href="Ledger.Conway.Specification.Script.Validation.html#3396" class="Bound">d</a> <a id="3398" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3400" class="Symbol">_)</a> <a id="3403" class="Symbol">=</a> <a id="3405" href="Ledger.Conway.Specification.Script.Validation.html#3396" class="Bound">d</a> <a id="3407" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="3411" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="3419" href="Ledger.Conway.Specification.Script.Validation.html#3419" class="Function">txOutToP2Script</a>
  <a id="3437" class="Symbol">:</a> <a id="3439" href="Ledger.Conway.Specification.Transaction.html#2718" class="Function">UTxO</a> <a id="3444" class="Symbol">→</a> <a id="3446" href="Ledger.Conway.Specification.Transaction.html#4684" class="Record">Tx</a>
  <a id="3451" class="Symbol">→</a> <a id="3453" href="Ledger.Conway.Specification.Transaction.html#2640" class="Function">TxOut</a> <a id="3459" class="Symbol">→</a> <a id="3461" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3467" href="Ledger.Conway.Specification.Script.Base.html#2364" class="Function">P2Script</a>
<a id="3476" href="Ledger.Conway.Specification.Script.Validation.html#3419" class="Function">txOutToP2Script</a> <a id="3492" href="Ledger.Conway.Specification.Script.Validation.html#3492" class="Bound">utxo</a> <a id="3497" href="Ledger.Conway.Specification.Script.Validation.html#3497" class="Bound">tx</a> <a id="3500" class="Symbol">(</a><a id="3501" href="Ledger.Conway.Specification.Script.Validation.html#3501" class="Bound">a</a> <a id="3503" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3505" class="Symbol">_)</a> <a id="3508" class="Symbol">=</a>
  <a id="3512" class="Keyword">do</a> <a id="3515" href="Ledger.Conway.Specification.Script.Validation.html#3515" class="Bound">sh</a> <a id="3518" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3520" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a> <a id="3532" class="Symbol">(</a><a id="3533" href="Ledger.Core.Specification.Address.html#2639" class="Function">payCred</a> <a id="3541" href="Ledger.Conway.Specification.Script.Validation.html#3501" class="Bound">a</a><a id="3542" class="Symbol">)</a>
     <a id="3549" href="Ledger.Conway.Specification.Script.Validation.html#3549" class="Bound">s</a>  <a id="3552" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3554" href="Ledger.Conway.Specification.Transaction.html#6504" class="Function">lookupScriptHash</a> <a id="3571" href="Ledger.Conway.Specification.Script.Validation.html#3515" class="Bound">sh</a> <a id="3574" href="Ledger.Conway.Specification.Script.Validation.html#3497" class="Bound">tx</a> <a id="3577" href="Ledger.Conway.Specification.Script.Validation.html#3492" class="Bound">utxo</a>
     <a id="3587" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="3598" href="Ledger.Conway.Specification.Script.Validation.html#3549" class="Bound">s</a>

<a id="3601" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3610" href="Ledger.Conway.Specification.Script.Validation.html#3610" class="Function">collectP2ScriptsWithContext</a>
    <a id="3642" class="Symbol">:</a> <a id="3644" href="Ledger.Conway.Specification.PParams.html#1685" class="Record">PParams</a> <a id="3652" class="Symbol">→</a> <a id="3654" href="Ledger.Conway.Specification.Transaction.html#4684" class="Record">Tx</a> <a id="3657" class="Symbol">→</a> <a id="3659" href="Ledger.Conway.Specification.Transaction.html#2718" class="Function">UTxO</a>
    <a id="3668" class="Symbol">→</a> <a id="3670" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3675" class="Symbol">(</a><a id="3676" href="Ledger.Conway.Specification.Script.Base.html#2364" class="Function">P2Script</a> <a id="3685" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3687" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3692" href="Ledger.Conway.Specification.Script.Base.html#1707" class="Function">Data</a> <a id="3697" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3699" href="Ledger.Conway.Specification.Script.Base.html#1017" class="Function">ExUnits</a> <a id="3707" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3709" href="Ledger.Conway.Specification.Script.Base.html#988" class="Function">CostModel</a><a id="3718" class="Symbol">)</a>
  <a id="3722" href="Ledger.Conway.Specification.Script.Validation.html#3610" class="Function">collectP2ScriptsWithContext</a> <a id="3750" href="Ledger.Conway.Specification.Script.Validation.html#3750" class="Bound">pp</a> <a id="3753" href="Ledger.Conway.Specification.Script.Validation.html#3753" class="Bound">tx</a> <a id="3756" href="Ledger.Conway.Specification.Script.Validation.html#3756" class="Bound">utxo</a>
    <a id="3765" class="Symbol">=</a> <a id="3767" href="abstract-set-theory.FiniteSetTheory.html#2463" class="Function">setToList</a>
    <a id="3781" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3783" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3794" class="Symbol">(λ</a> <a id="3797" class="Symbol">(</a><a id="3798" href="Ledger.Conway.Specification.Script.Validation.html#3798" class="Bound">sp</a> <a id="3801" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3803" href="Ledger.Conway.Specification.Script.Validation.html#3803" class="Bound">c</a><a id="3804" class="Symbol">)</a> <a id="3806" class="Symbol">→</a> <a id="3808" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3811" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a> <a id="3823" href="Ledger.Conway.Specification.Script.Validation.html#3803" class="Bound">c</a>
                                <a id="3857" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3862" class="Symbol">(λ</a> <a id="3865" class="Symbol">{</a><a id="3866" href="Ledger.Conway.Specification.Script.Validation.html#3866" class="Bound">sh</a><a id="3868" class="Symbol">}</a> <a id="3870" class="Symbol">→</a> <a id="3872" href="Ledger.Conway.Specification.Script.Validation.html#3992" class="Function">toScriptInput</a> <a id="3886" href="Ledger.Conway.Specification.Script.Validation.html#3798" class="Bound">sp</a> <a id="3889" href="Ledger.Conway.Specification.Script.Validation.html#3866" class="Bound">sh</a><a id="3891" class="Symbol">)</a>
                                <a id="3925" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3930" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3937" class="Symbol">)</a>
    <a id="3943" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3945" href="Ledger.Conway.Specification.Script.Validation.html#2484" class="Function">credsNeeded</a> <a id="3957" href="Ledger.Conway.Specification.Script.Validation.html#3756" class="Bound">utxo</a> <a id="3962" class="Symbol">(</a><a id="3963" href="Ledger.Conway.Specification.Script.Validation.html#3753" class="Bound">tx</a> <a id="3966" class="Symbol">.</a><a id="3967" href="Ledger.Conway.Specification.Transaction.html#4716" class="Field">Tx.body</a><a id="3974" class="Symbol">)</a>
    <a id="3980" class="Keyword">where</a>
      <a id="3992" href="Ledger.Conway.Specification.Script.Validation.html#3992" class="Function">toScriptInput</a>
        <a id="4014" class="Symbol">:</a> <a id="4016" href="Ledger.Conway.Specification.Script.Validation.html#412" class="Datatype">ScriptPurpose</a> <a id="4030" class="Symbol">→</a> <a id="4032" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
        <a id="4051" class="Symbol">→</a> <a id="4053" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4059" class="Symbol">(</a><a id="4060" href="Ledger.Conway.Specification.Script.Base.html#2364" class="Function">P2Script</a> <a id="4069" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4071" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4076" href="Ledger.Conway.Specification.Script.Base.html#1707" class="Function">Data</a> <a id="4081" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4083" href="Ledger.Conway.Specification.Script.Base.html#1017" class="Function">ExUnits</a> <a id="4091" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4093" href="Ledger.Conway.Specification.Script.Base.html#988" class="Function">CostModel</a><a id="4102" class="Symbol">)</a>
      <a id="4110" href="Ledger.Conway.Specification.Script.Validation.html#3992" class="Function">toScriptInput</a> <a id="4124" href="Ledger.Conway.Specification.Script.Validation.html#4124" class="Bound">sp</a> <a id="4127" href="Ledger.Conway.Specification.Script.Validation.html#4127" class="Bound">sh</a> <a id="4130" class="Symbol">=</a>
        <a id="4140" class="Keyword">do</a> <a id="4143" href="Ledger.Conway.Specification.Script.Validation.html#4143" class="Bound">s</a> <a id="4145" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4147" href="Ledger.Conway.Specification.Transaction.html#6504" class="Function">lookupScriptHash</a> <a id="4164" href="Ledger.Conway.Specification.Script.Validation.html#4127" class="Bound">sh</a> <a id="4167" href="Ledger.Conway.Specification.Script.Validation.html#3753" class="Bound">tx</a> <a id="4170" href="Ledger.Conway.Specification.Script.Validation.html#3756" class="Bound">utxo</a>
           <a id="4186" href="Ledger.Conway.Specification.Script.Validation.html#4186" class="Bound">p2s</a> <a id="4190" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4192" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="4203" href="Ledger.Conway.Specification.Script.Validation.html#4143" class="Bound">s</a>
           <a id="4216" class="Symbol">(</a><a id="4217" href="Ledger.Conway.Specification.Script.Validation.html#4217" class="Bound">rdmr</a> <a id="4222" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4224" href="Ledger.Conway.Specification.Script.Validation.html#4224" class="Bound">exunits</a><a id="4231" class="Symbol">)</a> <a id="4233" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4235" href="Ledger.Conway.Specification.Script.Validation.html#1197" class="Function">indexedRdmrs</a> <a id="4248" href="Ledger.Conway.Specification.Script.Validation.html#3753" class="Bound">tx</a> <a id="4251" href="Ledger.Conway.Specification.Script.Validation.html#4124" class="Bound">sp</a>
           <a id="4265" class="Keyword">let</a> <a id="4269" href="Ledger.Conway.Specification.Script.Validation.html#4269" class="Bound">data&#39;</a>     <a id="4279" class="Symbol">=</a> <a id="4281" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="4287" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="4291" class="InductiveConstructor">[]</a> <a id="4294" class="Symbol">(</a><a id="4295" href="Ledger.Conway.Specification.Script.Validation.html#1381" class="Function">getDatum</a> <a id="4304" href="Ledger.Conway.Specification.Script.Validation.html#3753" class="Bound">tx</a> <a id="4307" href="Ledger.Conway.Specification.Script.Validation.html#3756" class="Bound">utxo</a> <a id="4312" href="Ledger.Conway.Specification.Script.Validation.html#4124" class="Bound">sp</a><a id="4314" class="Symbol">)</a> <a id="4316" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="4319" href="Ledger.Conway.Specification.Script.Validation.html#4217" class="Bound">rdmr</a> <a id="4324" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4326" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="4328" href="Ledger.Conway.Specification.Script.Validation.html#3242" class="Function">valContext</a> <a id="4339" class="Symbol">(</a><a id="4340" href="Ledger.Conway.Specification.Script.Validation.html#2174" class="Function">txInfo</a> <a id="4347" class="Symbol">(</a><a id="4348" href="Ledger.Conway.Specification.Script.Base.html#1963" class="Function">language</a> <a id="4357" href="Ledger.Conway.Specification.Script.Validation.html#4186" class="Bound">p2s</a><a id="4360" class="Symbol">)</a> <a id="4362" href="Ledger.Conway.Specification.Script.Validation.html#3750" class="Bound">pp</a> <a id="4365" href="Ledger.Conway.Specification.Script.Validation.html#3756" class="Bound">utxo</a> <a id="4370" href="Ledger.Conway.Specification.Script.Validation.html#3753" class="Bound">tx</a><a id="4372" class="Symbol">)</a> <a id="4374" href="Ledger.Conway.Specification.Script.Validation.html#4124" class="Bound">sp</a> <a id="4377" href="Data.List.Base.html#4907" class="Function Operator">]</a>
               <a id="4394" href="Ledger.Conway.Specification.Script.Validation.html#4394" class="Bound">costModel</a> <a id="4404" class="Symbol">=</a> <a id="4406" href="Ledger.Conway.Specification.PParams.html#3064" class="Field">PParams.costmdls</a> <a id="4423" href="Ledger.Conway.Specification.Script.Validation.html#3750" class="Bound">pp</a>
           <a id="4437" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4442" class="Symbol">(</a><a id="4443" href="Ledger.Conway.Specification.Script.Validation.html#4186" class="Bound">p2s</a> <a id="4447" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4449" href="Ledger.Conway.Specification.Script.Validation.html#4269" class="Bound">data&#39;</a> <a id="4455" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4457" href="Ledger.Conway.Specification.Script.Validation.html#4224" class="Bound">exunits</a> <a id="4465" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4467" href="Ledger.Conway.Specification.Script.Validation.html#4394" class="Bound">costModel</a><a id="4476" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="4479" href="Ledger.Conway.Specification.Script.Validation.html#4479" class="Function">evalP2Scripts</a> <a id="4493" class="Symbol">:</a> <a id="4495" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4500" class="Symbol">(</a><a id="4501" href="Ledger.Conway.Specification.Script.Base.html#2364" class="Function">P2Script</a> <a id="4510" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4512" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4517" href="Ledger.Conway.Specification.Script.Base.html#1707" class="Function">Data</a> <a id="4522" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4524" href="Ledger.Conway.Specification.Script.Base.html#1017" class="Function">ExUnits</a> <a id="4532" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4534" href="Ledger.Conway.Specification.Script.Base.html#988" class="Function">CostModel</a><a id="4543" class="Symbol">)</a> <a id="4545" class="Symbol">→</a> <a id="4547" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4552" href="Ledger.Conway.Specification.Script.Validation.html#4479" class="Function">evalP2Scripts</a> <a id="4566" class="Symbol">=</a> <a id="4568" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="4572" class="Symbol">(λ</a> <a id="4575" class="Symbol">(</a><a id="4576" href="Ledger.Conway.Specification.Script.Validation.html#4576" class="Bound">s</a> <a id="4578" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4580" href="Ledger.Conway.Specification.Script.Validation.html#4580" class="Bound">d</a> <a id="4582" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4584" href="Ledger.Conway.Specification.Script.Validation.html#4584" class="Bound">eu</a> <a id="4587" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4589" href="Ledger.Conway.Specification.Script.Validation.html#4589" class="Bound">cm</a><a id="4591" class="Symbol">)</a> <a id="4593" class="Symbol">→</a> <a id="4595" href="Ledger.Conway.Specification.Abstract.html#817" class="Field">runPLCScript</a> <a id="4608" href="Ledger.Conway.Specification.Script.Validation.html#4589" class="Bound">cm</a> <a id="4611" href="Ledger.Conway.Specification.Script.Validation.html#4576" class="Bound">s</a> <a id="4613" href="Ledger.Conway.Specification.Script.Validation.html#4584" class="Bound">eu</a> <a id="4616" href="Ledger.Conway.Specification.Script.Validation.html#4580" class="Bound">d</a><a id="4617" class="Symbol">)</a>
</pre></body></html>