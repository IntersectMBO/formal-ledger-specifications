<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>

<a id="128" class="Keyword">module</a> <a id="135" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="183" class="Symbol">(</a><a id="184" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a> <a id="188" class="Symbol">:</a> <a id="190" class="Symbol">_)</a> <a id="193" class="Symbol">(</a><a id="194" class="Keyword">open</a> <a id="199" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="220" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a><a id="223" class="Symbol">)</a>
  <a id="227" class="Symbol">(</a><a id="228" href="Ledger.Conway.Specification.Script.Validation.html#228" class="Bound">abs</a> <a id="232" class="Symbol">:</a> <a id="234" href="Ledger.Conway.Specification.Abstract.html#655" class="Record">AbstractFunctions</a> <a id="252" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a><a id="255" class="Symbol">)</a> <a id="257" class="Symbol">(</a><a id="258" class="Keyword">open</a> <a id="263" href="Ledger.Conway.Specification.Abstract.html#655" class="Module">AbstractFunctions</a> <a id="281" href="Ledger.Conway.Specification.Script.Validation.html#228" class="Bound">abs</a><a id="284" class="Symbol">)</a> <a id="286" class="Symbol">(</a><a id="287" class="Keyword">open</a> <a id="292" href="Ledger.Conway.Specification.Abstract.html#283" class="Module">indexOf</a> <a id="300" href="Ledger.Conway.Specification.Abstract.html#787" class="Field">indexOfImp</a><a id="310" class="Symbol">)</a>
  <a id="314" class="Keyword">where</a>

<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="394" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>


<a id="409" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="414" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a> <a id="428" class="Symbol">:</a> <a id="430" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="435" class="Keyword">where</a>
  <a id="ScriptPurpose.Cert"></a><a id="443" href="Ledger.Conway.Specification.Script.Validation.html#443" class="InductiveConstructor">Cert</a>     <a id="452" class="Symbol">:</a> <a id="454" href="Ledger.Conway.Specification.Certs.html#2110" class="Datatype">DCert</a>        <a id="467" class="Symbol">→</a> <a id="469" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Rwrd"></a><a id="485" href="Ledger.Conway.Specification.Script.Validation.html#485" class="InductiveConstructor">Rwrd</a>     <a id="494" class="Symbol">:</a> <a id="496" href="Ledger.Core.Specification.Address.html#1313" class="Record">RwdAddr</a>      <a id="509" class="Symbol">→</a> <a id="511" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Mint"></a><a id="527" href="Ledger.Conway.Specification.Script.Validation.html#527" class="InductiveConstructor">Mint</a>     <a id="536" class="Symbol">:</a> <a id="538" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>   <a id="551" class="Symbol">→</a> <a id="553" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Spend"></a><a id="569" href="Ledger.Conway.Specification.Script.Validation.html#569" class="InductiveConstructor">Spend</a>    <a id="578" class="Symbol">:</a> <a id="580" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a>         <a id="593" class="Symbol">→</a> <a id="595" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Vote"></a><a id="611" href="Ledger.Conway.Specification.Script.Validation.html#611" class="InductiveConstructor">Vote</a>     <a id="620" class="Symbol">:</a> <a id="622" href="Ledger.Conway.Specification.Gov.Actions.html#2082" class="Record">GovVoter</a>     <a id="635" class="Symbol">→</a> <a id="637" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Propose"></a><a id="653" href="Ledger.Conway.Specification.Script.Validation.html#653" class="InductiveConstructor">Propose</a>  <a id="662" class="Symbol">:</a> <a id="664" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Record">GovProposal</a>  <a id="677" class="Symbol">→</a> <a id="679" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a>


<a id="rdptr"></a><a id="695" href="Ledger.Conway.Specification.Script.Validation.html#695" class="Function">rdptr</a> <a id="701" class="Symbol">:</a> <a id="703" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a> <a id="710" class="Symbol">→</a> <a id="712" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a> <a id="726" class="Symbol">→</a> <a id="728" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="734" href="Ledger.Conway.Specification.Transaction.html#2752" class="Function">RdmrPtr</a>
<a id="742" href="Ledger.Conway.Specification.Script.Validation.html#695" class="Function">rdptr</a> <a id="748" href="Ledger.Conway.Specification.Script.Validation.html#748" class="Bound">txb</a> <a id="752" class="Symbol">=</a> <a id="754" class="Symbol">λ</a> <a id="756" class="Keyword">where</a>
  <a id="764" class="Symbol">(</a><a id="765" href="Ledger.Conway.Specification.Script.Validation.html#443" class="InductiveConstructor">Cert</a> <a id="770" href="Ledger.Conway.Specification.Script.Validation.html#770" class="Bound">h</a><a id="771" class="Symbol">)</a>     <a id="777" class="Symbol">→</a> <a id="779" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="783" class="Symbol">(</a><a id="784" href="Ledger.Conway.Specification.Transaction.html#892" class="InductiveConstructor">Cert</a>    <a id="792" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="794" class="Symbol">)</a> <a id="796" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="798" href="Ledger.Conway.Specification.Abstract.html#316" class="Function">indexOfDCert</a>    <a id="814" href="Ledger.Conway.Specification.Script.Validation.html#770" class="Bound">h</a> <a id="816" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a>
  <a id="826" class="Symbol">(</a><a id="827" href="Ledger.Conway.Specification.Script.Validation.html#485" class="InductiveConstructor">Rwrd</a> <a id="832" href="Ledger.Conway.Specification.Script.Validation.html#832" class="Bound">h</a><a id="833" class="Symbol">)</a>     <a id="839" class="Symbol">→</a> <a id="841" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="845" class="Symbol">(</a><a id="846" href="Ledger.Conway.Specification.Transaction.html#897" class="InductiveConstructor">Rewrd</a>   <a id="854" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="856" class="Symbol">)</a> <a id="858" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="860" href="Ledger.Conway.Specification.Abstract.html#368" class="Function">indexOfRwdAddr</a>  <a id="876" href="Ledger.Conway.Specification.Script.Validation.html#832" class="Bound">h</a> <a id="878" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a>
  <a id="894" class="Symbol">(</a><a id="895" href="Ledger.Conway.Specification.Script.Validation.html#527" class="InductiveConstructor">Mint</a> <a id="900" href="Ledger.Conway.Specification.Script.Validation.html#900" class="Bound">h</a><a id="901" class="Symbol">)</a>     <a id="907" class="Symbol">→</a> <a id="909" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="913" class="Symbol">(</a><a id="914" href="Ledger.Conway.Specification.Transaction.html#887" class="InductiveConstructor">Mint</a>    <a id="922" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="924" class="Symbol">)</a> <a id="926" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="928" href="Ledger.Conway.Specification.Abstract.html#470" class="Function">indexOfPolicyId</a> <a id="944" href="Ledger.Conway.Specification.Script.Validation.html#900" class="Bound">h</a> <a id="946" class="Symbol">(</a><a id="947" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#927" class="Function">policies</a> <a id="956" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a><a id="960" class="Symbol">)</a>
  <a id="964" class="Symbol">(</a><a id="965" href="Ledger.Conway.Specification.Script.Validation.html#569" class="InductiveConstructor">Spend</a> <a id="971" href="Ledger.Conway.Specification.Script.Validation.html#971" class="Bound">h</a><a id="972" class="Symbol">)</a>    <a id="977" class="Symbol">→</a> <a id="979" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="983" class="Symbol">(</a><a id="984" href="Ledger.Conway.Specification.Transaction.html#881" class="InductiveConstructor">Spend</a>   <a id="992" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="994" class="Symbol">)</a> <a id="996" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="998" href="Ledger.Conway.Specification.Abstract.html#423" class="Function">indexOfTxIn</a>     <a id="1014" href="Ledger.Conway.Specification.Script.Validation.html#971" class="Bound">h</a> <a id="1016" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a>
  <a id="1024" class="Symbol">(</a><a id="1025" href="Ledger.Conway.Specification.Script.Validation.html#611" class="InductiveConstructor">Vote</a> <a id="1030" href="Ledger.Conway.Specification.Script.Validation.html#1030" class="Bound">h</a><a id="1031" class="Symbol">)</a>     <a id="1037" class="Symbol">→</a> <a id="1039" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1043" class="Symbol">(</a><a id="1044" href="Ledger.Conway.Specification.Transaction.html#903" class="InductiveConstructor">Vote</a>    <a id="1052" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1054" class="Symbol">)</a> <a id="1056" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1058" href="Ledger.Conway.Specification.Abstract.html#529" class="Function">indexOfVote</a>     <a id="1074" href="Ledger.Conway.Specification.Script.Validation.html#1030" class="Bound">h</a> <a id="1076" class="Symbol">(</a><a id="1077" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1081" href="Ledger.Conway.Specification.Gov.Actions.html#2357" class="Field">GovVote.voter</a> <a id="1095" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a><a id="1105" class="Symbol">)</a>
  <a id="1109" class="Symbol">(</a><a id="1110" href="Ledger.Conway.Specification.Script.Validation.html#653" class="InductiveConstructor">Propose</a> <a id="1118" href="Ledger.Conway.Specification.Script.Validation.html#1118" class="Bound">h</a><a id="1119" class="Symbol">)</a>  <a id="1122" class="Symbol">→</a> <a id="1124" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1128" class="Symbol">(</a><a id="1129" href="Ledger.Conway.Specification.Transaction.html#908" class="InductiveConstructor">Propose</a> <a id="1137" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1139" class="Symbol">)</a> <a id="1141" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1143" href="Ledger.Conway.Specification.Abstract.html#587" class="Function">indexOfProposal</a> <a id="1159" href="Ledger.Conway.Specification.Script.Validation.html#1118" class="Bound">h</a> <a id="1161" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a>
 <a id="1177" class="Keyword">where</a> <a id="1183" class="Keyword">open</a> <a id="1188" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="1195" href="Ledger.Conway.Specification.Script.Validation.html#748" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1200" href="Ledger.Conway.Specification.Script.Validation.html#1200" class="Function">indexedRdmrs</a> <a id="1213" class="Symbol">:</a> <a id="1215" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1218" class="Symbol">→</a> <a id="1220" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a> <a id="1234" class="Symbol">→</a> <a id="1236" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1242" class="Symbol">(</a><a id="1243" href="Ledger.Conway.Specification.Script.Base.html#1788" class="Function">Redeemer</a> <a id="1252" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1254" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a><a id="1261" class="Symbol">)</a>
<a id="1263" href="Ledger.Conway.Specification.Script.Validation.html#1200" class="Function">indexedRdmrs</a> <a id="1276" href="Ledger.Conway.Specification.Script.Validation.html#1276" class="Bound">tx</a> <a id="1279" href="Ledger.Conway.Specification.Script.Validation.html#1279" class="Bound">sp</a> <a id="1282" class="Symbol">=</a> <a id="1284" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1290" class="Symbol">(λ</a> <a id="1293" href="Ledger.Conway.Specification.Script.Validation.html#1293" class="Bound">x</a> <a id="1295" class="Symbol">→</a> <a id="1297" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1306" href="Ledger.Conway.Specification.Transaction.html#4557" class="Function">txrdmrs</a> <a id="1314" href="Ledger.Conway.Specification.Script.Validation.html#1293" class="Bound">x</a><a id="1315" class="Symbol">)</a> <a id="1317" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1325" class="Symbol">(</a><a id="1326" href="Ledger.Conway.Specification.Script.Validation.html#695" class="Function">rdptr</a> <a id="1332" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a> <a id="1337" href="Ledger.Conway.Specification.Script.Validation.html#1279" class="Bound">sp</a><a id="1339" class="Symbol">)</a>
  <a id="1343" class="Keyword">where</a> <a id="1349" class="Keyword">open</a> <a id="1354" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="1357" href="Ledger.Conway.Specification.Script.Validation.html#1276" class="Bound">tx</a><a id="1359" class="Symbol">;</a> <a id="1361" class="Keyword">open</a> <a id="1366" href="Ledger.Conway.Specification.Transaction.html#4437" class="Module">TxWitnesses</a> <a id="1378" href="Ledger.Conway.Specification.Transaction.html#4738" class="Function">wits</a>

<a id="getDatum"></a><a id="1384" href="Ledger.Conway.Specification.Script.Validation.html#1384" class="Function">getDatum</a> <a id="1393" class="Symbol">:</a> <a id="1395" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1398" class="Symbol">→</a> <a id="1400" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="1405" class="Symbol">→</a> <a id="1407" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a> <a id="1421" class="Symbol">→</a> <a id="1423" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1429" href="Ledger.Conway.Specification.Script.Base.html#1770" class="Function">Datum</a>
<a id="1435" href="Ledger.Conway.Specification.Script.Validation.html#1384" class="Function">getDatum</a> <a id="1444" href="Ledger.Conway.Specification.Script.Validation.html#1444" class="Bound">tx</a> <a id="1447" href="Ledger.Conway.Specification.Script.Validation.html#1447" class="Bound">utxo</a> <a id="1452" class="Symbol">(</a><a id="1453" href="Ledger.Conway.Specification.Script.Validation.html#569" class="InductiveConstructor">Spend</a> <a id="1459" href="Ledger.Conway.Specification.Script.Validation.html#1459" class="Bound">txin</a><a id="1463" class="Symbol">)</a> <a id="1465" class="Symbol">=</a>
  <a id="1469" class="Keyword">do</a> <a id="1472" class="Symbol">(_</a> <a id="1475" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1477" class="Symbol">_</a> <a id="1479" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1481" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1486" href="Ledger.Conway.Specification.Script.Validation.html#1486" class="Bound">d</a> <a id="1488" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1490" class="Symbol">_)</a> <a id="1493" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1495" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1504" href="Ledger.Conway.Specification.Script.Validation.html#1447" class="Bound">utxo</a> <a id="1509" href="Ledger.Conway.Specification.Script.Validation.html#1459" class="Bound">txin</a>
                          <a id="1540" class="Keyword">where</a>
                            <a id="1574" class="Symbol">(_</a> <a id="1577" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1579" class="Symbol">_</a> <a id="1581" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1583" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1591" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1593" class="Symbol">_)</a> <a id="1596" class="Symbol">→</a> <a id="1598" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1611" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1616" href="Ledger.Conway.Specification.Script.Validation.html#1486" class="Bound">d</a> <a id="1618" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1621" class="Symbol">λ</a> <a id="1623" class="Keyword">where</a>
       <a id="1636" class="Symbol">(</a><a id="1637" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1642" href="Ledger.Conway.Specification.Script.Validation.html#1642" class="Bound">d</a><a id="1643" class="Symbol">)</a> <a id="1645" class="Symbol">→</a> <a id="1647" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1652" href="Ledger.Conway.Specification.Script.Validation.html#1642" class="Bound">d</a>
       <a id="1661" class="Symbol">(</a><a id="1662" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1667" href="Ledger.Conway.Specification.Script.Validation.html#1667" class="Bound">h</a><a id="1668" class="Symbol">)</a> <a id="1670" class="Symbol">→</a> <a id="1672" href="Axiom.Set.Map.html#17167" class="Function">lookupᵐ?</a> <a id="1681" href="Ledger.Conway.Specification.Script.Validation.html#1703" class="Function">m</a> <a id="1683" href="Ledger.Conway.Specification.Script.Validation.html#1667" class="Bound">h</a>
     <a id="1690" class="Keyword">where</a>
       <a id="1703" href="Ledger.Conway.Specification.Script.Validation.html#1703" class="Function">m</a> <a id="1705" class="Symbol">=</a> <a id="1707" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="1716" class="Symbol">(</a><a id="1717" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1722" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1724" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="1729" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1731" href="Function.Base.html#704" class="Function">id</a> <a id="1734" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1736" class="Symbol">(</a><a id="1737" href="Ledger.Conway.Specification.Transaction.html#4532" class="Field">TxWitnesses.txdats</a> <a id="1756" class="Symbol">(</a><a id="1757" href="Ledger.Conway.Specification.Transaction.html#4738" class="Field">Tx.wits</a> <a id="1765" href="Ledger.Conway.Specification.Script.Validation.html#1444" class="Bound">tx</a><a id="1767" class="Symbol">)))</a>
<a id="1771" href="Ledger.Conway.Specification.Script.Validation.html#1384" class="CatchallClause Function">getDatum</a><a id="1779" class="CatchallClause"> </a><a id="1780" href="Ledger.Conway.Specification.Script.Validation.html#1780" class="CatchallClause Bound">tx</a><a id="1782" class="CatchallClause"> </a><a id="1783" href="Ledger.Conway.Specification.Script.Validation.html#1783" class="CatchallClause Bound">utxo</a><a id="1787" class="CatchallClause"> </a><a id="1788" class="CatchallClause Symbol">_</a> <a id="1790" class="Symbol">=</a> <a id="1792" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="1802" class="Keyword">record</a> <a id="TxInfo"></a><a id="1809" href="Ledger.Conway.Specification.Script.Validation.html#1809" class="Record">TxInfo</a> <a id="1816" class="Symbol">:</a> <a id="1818" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1823" class="Keyword">where</a>
  <a id="1831" class="Keyword">field</a> <a id="TxInfo.realizedInputs"></a><a id="1837" href="Ledger.Conway.Specification.Script.Validation.html#1837" class="Field">realizedInputs</a> <a id="1852" class="Symbol">:</a> <a id="1854" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
        <a id="TxInfo.txOuts"></a><a id="1867" href="Ledger.Conway.Specification.Script.Validation.html#1867" class="Field">txOuts</a>         <a id="1882" class="Symbol">:</a> <a id="1884" href="Ledger.Conway.Specification.Transaction.html#1048" class="Field">Ix</a> <a id="1887" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1889" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a>
        <a id="TxInfo.fee"></a><a id="1903" href="Ledger.Conway.Specification.Script.Validation.html#1903" class="Field">fee</a>            <a id="1918" class="Symbol">:</a> <a id="1920" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
        <a id="TxInfo.mint"></a><a id="1934" href="Ledger.Conway.Specification.Script.Validation.html#1934" class="Field">mint</a>           <a id="1949" class="Symbol">:</a> <a id="1951" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
        <a id="TxInfo.txCerts"></a><a id="1965" href="Ledger.Conway.Specification.Script.Validation.html#1965" class="Field">txCerts</a>        <a id="1980" class="Symbol">:</a> <a id="1982" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1987" href="Ledger.Conway.Specification.Certs.html#2110" class="Datatype">DCert</a>
        <a id="TxInfo.txWithdrawals"></a><a id="2001" href="Ledger.Conway.Specification.Script.Validation.html#2001" class="Field">txWithdrawals</a>  <a id="2016" class="Symbol">:</a> <a id="2018" href="Ledger.Core.Specification.Address.html#1388" class="Function">Withdrawals</a>
        <a id="TxInfo.txVldt"></a><a id="2038" href="Ledger.Conway.Specification.Script.Validation.html#2038" class="Field">txVldt</a>         <a id="2053" class="Symbol">:</a> <a id="2055" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2061" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a> <a id="2066" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2068" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2074" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a>
        <a id="TxInfo.vkKey"></a><a id="2087" href="Ledger.Conway.Specification.Script.Validation.html#2087" class="Field">vkKey</a>          <a id="2102" class="Symbol">:</a> <a id="2104" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2106" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
        <a id="TxInfo.txdats"></a><a id="2122" href="Ledger.Conway.Specification.Script.Validation.html#2122" class="Field">txdats</a>         <a id="2137" class="Symbol">:</a> <a id="2139" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2141" href="Ledger.Conway.Specification.Script.Base.html#1770" class="Function">Datum</a>
        <a id="TxInfo.txId"></a><a id="2155" href="Ledger.Conway.Specification.Script.Validation.html#2155" class="Field">txId</a>           <a id="2170" class="Symbol">:</a> <a id="2172" href="Ledger.Conway.Specification.Transaction.html#1051" class="Field">TxId</a>

<a id="txInfo"></a><a id="2178" href="Ledger.Conway.Specification.Script.Validation.html#2178" class="Function">txInfo</a> <a id="2185" class="Symbol">:</a> <a id="2187" href="Ledger.Conway.Specification.Script.Base.html#967" class="Function">Language</a> <a id="2196" class="Symbol">→</a> <a id="2198" href="Ledger.Conway.Specification.PParams.html#1689" class="Record">PParams</a>
                  <a id="2224" class="Symbol">→</a> <a id="2226" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
                  <a id="2249" class="Symbol">→</a> <a id="2251" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a>
                  <a id="2272" class="Symbol">→</a> <a id="2274" href="Ledger.Conway.Specification.Script.Validation.html#1809" class="Record">TxInfo</a>
<a id="2281" href="Ledger.Conway.Specification.Script.Validation.html#2178" class="Function">txInfo</a> <a id="2288" href="Ledger.Conway.Specification.Script.Validation.html#2288" class="Bound">l</a> <a id="2290" href="Ledger.Conway.Specification.Script.Validation.html#2290" class="Bound">pp</a> <a id="2293" href="Ledger.Conway.Specification.Script.Validation.html#2293" class="Bound">utxo</a> <a id="2298" href="Ledger.Conway.Specification.Script.Validation.html#2298" class="Bound">tx</a> <a id="2301" class="Symbol">=</a> <a id="2303" class="Keyword">record</a>
  <a id="2312" class="Symbol">{</a> <a id="2314" href="Ledger.Conway.Specification.Script.Validation.html#2314" class="Module">TxBody</a> <a id="2321" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">body</a>
  <a id="2328" class="Symbol">;</a> <a id="2330" href="Ledger.Conway.Specification.Script.Validation.html#2330" class="Module">TxWitnesses</a> <a id="2342" href="Ledger.Conway.Specification.Transaction.html#4738" class="Field">wits</a>
  <a id="2349" class="Symbol">;</a> <a id="2351" href="Ledger.Conway.Specification.Script.Validation.html#1837" class="Field">realizedInputs</a> <a id="2366" class="Symbol">=</a> <a id="2368" href="Ledger.Conway.Specification.Script.Validation.html#2293" class="Bound">utxo</a> <a id="2373" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="2375" href="Ledger.Conway.Specification.Transaction.html#3032" class="Function">txIns</a>
  <a id="2383" class="Symbol">;</a> <a id="2385" href="Ledger.Conway.Specification.Script.Validation.html#1903" class="Field">fee</a> <a id="2389" class="Symbol">=</a> <a id="2391" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#882" class="Function">inject</a> <a id="2398" href="Ledger.Conway.Specification.Transaction.html#3254" class="Function">txFee</a>
  <a id="2406" class="Symbol">;</a> <a id="2408" href="Ledger.Conway.Specification.Script.Validation.html#1934" class="Field">mint</a> <a id="2413" class="Symbol">=</a> <a id="2415" href="Ledger.Conway.Specification.Transaction.html#3638" class="Function">mint</a>
  <a id="2422" class="Symbol">;</a> <a id="2424" href="Ledger.Conway.Specification.Script.Validation.html#2087" class="Field">vkKey</a> <a id="2430" class="Symbol">=</a> <a id="2432" href="Ledger.Conway.Specification.Transaction.html#3673" class="Function">reqSignerHashes</a>
  <a id="2450" class="Symbol">}</a> <a id="2452" class="Keyword">where</a> <a id="2458" class="Keyword">open</a> <a id="2463" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="2466" href="Ledger.Conway.Specification.Script.Validation.html#2298" class="Bound">tx</a><a id="2468" class="Symbol">;</a> <a id="2470" class="Keyword">open</a> <a id="2475" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="2482" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">body</a>

<a id="credsNeeded"></a><a id="2488" href="Ledger.Conway.Specification.Script.Validation.html#2488" class="Function">credsNeeded</a> <a id="2500" class="Symbol">:</a> <a id="2502" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="2507" class="Symbol">→</a> <a id="2509" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a> <a id="2516" class="Symbol">→</a> <a id="2518" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2520" class="Symbol">(</a><a id="2521" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a> <a id="2535" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2537" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="2547" class="Symbol">)</a>
<a id="2549" href="Ledger.Conway.Specification.Script.Validation.html#2488" class="Function">credsNeeded</a> <a id="2561" href="Ledger.Conway.Specification.Script.Validation.html#2561" class="Bound">utxo</a> <a id="2566" href="Ledger.Conway.Specification.Script.Validation.html#2566" class="Bound">txb</a>
  <a id="2572" class="Symbol">=</a>  <a id="2575" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2580" class="Symbol">(λ</a> <a id="2583" class="Symbol">(</a><a id="2584" href="Ledger.Conway.Specification.Script.Validation.html#2584" class="Bound">i</a> <a id="2586" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2588" href="Ledger.Conway.Specification.Script.Validation.html#2588" class="Bound">o</a><a id="2589" class="Symbol">)</a>  <a id="2592" class="Symbol">→</a> <a id="2594" class="Symbol">(</a><a id="2595" href="Ledger.Conway.Specification.Script.Validation.html#569" class="InductiveConstructor">Spend</a>  <a id="2602" href="Ledger.Conway.Specification.Script.Validation.html#2584" class="Bound">i</a> <a id="2604" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2606" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="2614" class="Symbol">(</a><a id="2615" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2621" href="Ledger.Conway.Specification.Script.Validation.html#2588" class="Bound">o</a><a id="2622" class="Symbol">)))</a> <a id="2626" class="Symbol">((</a><a id="2628" href="Ledger.Conway.Specification.Script.Validation.html#2561" class="Bound">utxo</a> <a id="2633" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="2635" class="Symbol">(</a><a id="2636" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a> <a id="2642" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="2644" href="Ledger.Conway.Specification.Transaction.html#3104" class="Field">collateralInputs</a><a id="2660" class="Symbol">))</a> <a id="2663" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2664" class="Symbol">)</a>
  <a id="2668" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2671" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2676" class="Symbol">(λ</a> <a id="2679" href="Ledger.Conway.Specification.Script.Validation.html#2679" class="Bound">a</a>        <a id="2688" class="Symbol">→</a> <a id="2690" class="Symbol">(</a><a id="2691" href="Ledger.Conway.Specification.Script.Validation.html#485" class="InductiveConstructor">Rwrd</a>   <a id="2698" href="Ledger.Conway.Specification.Script.Validation.html#2679" class="Bound">a</a> <a id="2700" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2702" href="Ledger.Core.Specification.Address.html#1367" class="Field">stake</a> <a id="2708" href="Ledger.Conway.Specification.Script.Validation.html#2679" class="Bound">a</a><a id="2709" class="Symbol">))</a> <a id="2712" class="Symbol">(</a><a id="2713" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2717" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2719" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a> <a id="2733" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a><a id="2734" class="Symbol">)</a>
  <a id="2738" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2741" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2752" class="Symbol">(λ</a> <a id="2755" href="Ledger.Conway.Specification.Script.Validation.html#2755" class="Bound">c</a>  <a id="2758" class="Symbol">→</a> <a id="2760" class="Symbol">(</a><a id="2761" href="Ledger.Conway.Specification.Script.Validation.html#443" class="InductiveConstructor">Cert</a>   <a id="2768" href="Ledger.Conway.Specification.Script.Validation.html#2755" class="Bound">c</a> <a id="2770" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2772" class="Symbol">)</a> <a id="2774" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2778" href="Ledger.Conway.Specification.Certs.html#2865" class="Function">cwitness</a> <a id="2787" href="Ledger.Conway.Specification.Script.Validation.html#2755" class="Bound">c</a><a id="2788" class="Symbol">)</a> <a id="2790" class="Symbol">(</a><a id="2791" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2800" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a><a id="2807" class="Symbol">)</a>
  <a id="2811" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2814" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2819" class="Symbol">(λ</a> <a id="2822" href="Ledger.Conway.Specification.Script.Validation.html#2822" class="Bound">x</a>        <a id="2831" class="Symbol">→</a> <a id="2833" class="Symbol">(</a><a id="2834" href="Ledger.Conway.Specification.Script.Validation.html#527" class="InductiveConstructor">Mint</a>   <a id="2841" href="Ledger.Conway.Specification.Script.Validation.html#2822" class="Bound">x</a> <a id="2843" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2845" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2855" href="Ledger.Conway.Specification.Script.Validation.html#2822" class="Bound">x</a><a id="2856" class="Symbol">))</a> <a id="2859" class="Symbol">(</a><a id="2860" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#927" class="Function">policies</a> <a id="2869" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a><a id="2873" class="Symbol">)</a>
  <a id="2877" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2880" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2891" class="Symbol">(λ</a> <a id="2894" href="Ledger.Conway.Specification.Script.Validation.html#2894" class="Bound">v</a> <a id="2896" class="Symbol">→</a> <a id="2898" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2901" href="Ledger.Conway.Specification.Gov.Actions.html#6701" class="Function">isGovVoterCredential</a> <a id="2922" href="Ledger.Conway.Specification.Script.Validation.html#2894" class="Bound">v</a> <a id="2924" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2929" class="Symbol">(λ</a> <a id="2932" class="Symbol">{</a><a id="2933" href="Ledger.Conway.Specification.Script.Validation.html#2933" class="Bound">c</a><a id="2934" class="Symbol">}</a> <a id="2936" class="Symbol">→</a> <a id="2938" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2943" class="Symbol">(</a><a id="2944" href="Ledger.Conway.Specification.Script.Validation.html#611" class="InductiveConstructor">Vote</a> <a id="2949" href="Ledger.Conway.Specification.Script.Validation.html#2894" class="Bound">v</a> <a id="2951" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2953" href="Ledger.Conway.Specification.Script.Validation.html#2933" class="Bound">c</a><a id="2954" class="Symbol">))</a> <a id="2957" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2962" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2969" class="Symbol">)</a>
                <a id="2987" class="Symbol">(</a><a id="2988" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2997" class="Symbol">(</a><a id="2998" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3002" href="Ledger.Conway.Specification.Gov.Actions.html#2357" class="Field">voter</a> <a id="3008" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a><a id="3018" class="Symbol">))</a>
  <a id="3023" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="3026" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3037" class="Symbol">(λ</a> <a id="3040" href="Ledger.Conway.Specification.Script.Validation.html#3040" class="Bound">p</a> <a id="3042" class="Symbol">→</a> <a id="3044" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3047" href="Ledger.Conway.Specification.Script.Validation.html#3040" class="Bound">p</a> <a id="3049" class="Symbol">.</a><a id="3050" href="Ledger.Conway.Specification.Gov.Actions.html#3712" class="Field">policy</a> <a id="3057" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3062" class="Symbol">(λ</a> <a id="3065" class="Symbol">{</a><a id="3066" href="Ledger.Conway.Specification.Script.Validation.html#3066" class="Bound">sh</a><a id="3068" class="Symbol">}</a> <a id="3070" class="Symbol">→</a> <a id="3072" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3077" class="Symbol">(</a><a id="3078" href="Ledger.Conway.Specification.Script.Validation.html#653" class="InductiveConstructor">Propose</a>  <a id="3087" href="Ledger.Conway.Specification.Script.Validation.html#3040" class="Bound">p</a> <a id="3089" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3091" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="3101" href="Ledger.Conway.Specification.Script.Validation.html#3066" class="Bound">sh</a><a id="3103" class="Symbol">))</a> <a id="3106" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3111" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3118" class="Symbol">)</a>
                <a id="3136" class="Symbol">(</a><a id="3137" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="3146" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a><a id="3160" class="Symbol">)</a>


  <a id="3166" class="Keyword">where</a> <a id="3172" class="Keyword">open</a> <a id="3177" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="3184" href="Ledger.Conway.Specification.Script.Validation.html#2566" class="Bound">txb</a><a id="3187" class="Symbol">;</a> <a id="3189" class="Keyword">open</a> <a id="3194" href="Ledger.Conway.Specification.Gov.Actions.html#2294" class="Module">GovVote</a><a id="3201" class="Symbol">;</a> <a id="3203" class="Keyword">open</a> <a id="3208" href="Ledger.Core.Specification.Address.html#1313" class="Module">RwdAddr</a><a id="3215" class="Symbol">;</a> <a id="3217" class="Keyword">open</a> <a id="3222" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Module">GovProposal</a>

<a id="valContext"></a><a id="3235" href="Ledger.Conway.Specification.Script.Validation.html#3235" class="Function">valContext</a> <a id="3246" class="Symbol">:</a> <a id="3248" href="Ledger.Conway.Specification.Script.Validation.html#1809" class="Record">TxInfo</a> <a id="3255" class="Symbol">→</a> <a id="3257" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a> <a id="3271" class="Symbol">→</a> <a id="3273" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a>
<a id="3278" href="Ledger.Conway.Specification.Script.Validation.html#3235" class="Function">valContext</a> <a id="3289" href="Ledger.Conway.Specification.Script.Validation.html#3289" class="Bound">txinfo</a> <a id="3296" href="Ledger.Conway.Specification.Script.Validation.html#3296" class="Bound">sp</a> <a id="3299" class="Symbol">=</a> <a id="3301" href="Ledger.Conway.Specification.Script.Base.html#2007" class="Function">toData</a> <a id="3308" class="Symbol">(</a><a id="3309" href="Ledger.Conway.Specification.Script.Validation.html#3289" class="Bound">txinfo</a> <a id="3316" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3318" href="Ledger.Conway.Specification.Script.Validation.html#3296" class="Bound">sp</a><a id="3320" class="Symbol">)</a>

<a id="txOutToDataHash"></a><a id="3323" href="Ledger.Conway.Specification.Script.Validation.html#3323" class="Function">txOutToDataHash</a> <a id="3339" class="Symbol">:</a> <a id="3341" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="3347" class="Symbol">→</a> <a id="3349" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3355" href="Ledger.Conway.Specification.Script.Base.html#1723" class="Function">DataHash</a>
<a id="3364" href="Ledger.Conway.Specification.Script.Validation.html#3323" class="Function">txOutToDataHash</a> <a id="3380" class="Symbol">(_</a> <a id="3383" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3385" class="Symbol">_</a> <a id="3387" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3389" href="Ledger.Conway.Specification.Script.Validation.html#3389" class="Bound">d</a> <a id="3391" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3393" class="Symbol">_)</a> <a id="3396" class="Symbol">=</a> <a id="3398" href="Ledger.Conway.Specification.Script.Validation.html#3389" class="Bound">d</a> <a id="3400" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="3404" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="3412" href="Ledger.Conway.Specification.Script.Validation.html#3412" class="Function">txOutToP2Script</a>
  <a id="3430" class="Symbol">:</a> <a id="3432" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="3437" class="Symbol">→</a> <a id="3439" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a>
  <a id="3444" class="Symbol">→</a> <a id="3446" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="3452" class="Symbol">→</a> <a id="3454" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3460" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a>
<a id="3469" href="Ledger.Conway.Specification.Script.Validation.html#3412" class="Function">txOutToP2Script</a> <a id="3485" href="Ledger.Conway.Specification.Script.Validation.html#3485" class="Bound">utxo</a> <a id="3490" href="Ledger.Conway.Specification.Script.Validation.html#3490" class="Bound">tx</a> <a id="3493" class="Symbol">(</a><a id="3494" href="Ledger.Conway.Specification.Script.Validation.html#3494" class="Bound">a</a> <a id="3496" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3498" class="Symbol">_)</a> <a id="3501" class="Symbol">=</a>
  <a id="3505" class="Keyword">do</a> <a id="3508" href="Ledger.Conway.Specification.Script.Validation.html#3508" class="Bound">sh</a> <a id="3511" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3513" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3525" class="Symbol">(</a><a id="3526" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="3534" href="Ledger.Conway.Specification.Script.Validation.html#3494" class="Bound">a</a><a id="3535" class="Symbol">)</a>
     <a id="3542" href="Ledger.Conway.Specification.Script.Validation.html#3542" class="Bound">s</a>  <a id="3545" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3547" href="Ledger.Conway.Specification.Transaction.html#6502" class="Function">lookupScriptHash</a> <a id="3564" href="Ledger.Conway.Specification.Script.Validation.html#3508" class="Bound">sh</a> <a id="3567" href="Ledger.Conway.Specification.Script.Validation.html#3490" class="Bound">tx</a> <a id="3570" href="Ledger.Conway.Specification.Script.Validation.html#3485" class="Bound">utxo</a>
     <a id="3580" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="3591" href="Ledger.Conway.Specification.Script.Validation.html#3542" class="Bound">s</a>

<a id="3594" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3603" href="Ledger.Conway.Specification.Script.Validation.html#3603" class="Function">collectP2ScriptsWithContext</a>
    <a id="3635" class="Symbol">:</a> <a id="3637" href="Ledger.Conway.Specification.PParams.html#1689" class="Record">PParams</a> <a id="3645" class="Symbol">→</a> <a id="3647" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="3650" class="Symbol">→</a> <a id="3652" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
    <a id="3661" class="Symbol">→</a> <a id="3663" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3668" class="Symbol">(</a><a id="3669" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="3678" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3680" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3685" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="3690" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3692" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="3700" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3702" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="3711" class="Symbol">)</a>
  <a id="3715" href="Ledger.Conway.Specification.Script.Validation.html#3603" class="Function">collectP2ScriptsWithContext</a> <a id="3743" href="Ledger.Conway.Specification.Script.Validation.html#3743" class="Bound">pp</a> <a id="3746" href="Ledger.Conway.Specification.Script.Validation.html#3746" class="Bound">tx</a> <a id="3749" href="Ledger.Conway.Specification.Script.Validation.html#3749" class="Bound">utxo</a>
    <a id="3758" class="Symbol">=</a> <a id="3760" href="abstract-set-theory.FiniteSetTheory.html#2556" class="Function">setToList</a>
    <a id="3774" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3776" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3787" class="Symbol">(λ</a> <a id="3790" class="Symbol">(</a><a id="3791" href="Ledger.Conway.Specification.Script.Validation.html#3791" class="Bound">sp</a> <a id="3794" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3796" href="Ledger.Conway.Specification.Script.Validation.html#3796" class="Bound">c</a><a id="3797" class="Symbol">)</a> <a id="3799" class="Symbol">→</a> <a id="3801" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3804" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3816" href="Ledger.Conway.Specification.Script.Validation.html#3796" class="Bound">c</a>
                                <a id="3850" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3855" class="Symbol">(λ</a> <a id="3858" class="Symbol">{</a><a id="3859" href="Ledger.Conway.Specification.Script.Validation.html#3859" class="Bound">sh</a><a id="3861" class="Symbol">}</a> <a id="3863" class="Symbol">→</a> <a id="3865" href="Ledger.Conway.Specification.Script.Validation.html#3985" class="Function">toScriptInput</a> <a id="3879" href="Ledger.Conway.Specification.Script.Validation.html#3791" class="Bound">sp</a> <a id="3882" href="Ledger.Conway.Specification.Script.Validation.html#3859" class="Bound">sh</a><a id="3884" class="Symbol">)</a>
                                <a id="3918" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3923" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3930" class="Symbol">)</a>
    <a id="3936" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3938" href="Ledger.Conway.Specification.Script.Validation.html#2488" class="Function">credsNeeded</a> <a id="3950" href="Ledger.Conway.Specification.Script.Validation.html#3749" class="Bound">utxo</a> <a id="3955" class="Symbol">(</a><a id="3956" href="Ledger.Conway.Specification.Script.Validation.html#3746" class="Bound">tx</a> <a id="3959" class="Symbol">.</a><a id="3960" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">Tx.body</a><a id="3967" class="Symbol">)</a>
    <a id="3973" class="Keyword">where</a>
      <a id="3985" href="Ledger.Conway.Specification.Script.Validation.html#3985" class="Function">toScriptInput</a>
        <a id="4007" class="Symbol">:</a> <a id="4009" href="Ledger.Conway.Specification.Script.Validation.html#414" class="Datatype">ScriptPurpose</a> <a id="4023" class="Symbol">→</a> <a id="4025" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
        <a id="4044" class="Symbol">→</a> <a id="4046" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4052" class="Symbol">(</a><a id="4053" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="4062" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4064" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4069" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="4074" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4076" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="4084" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4086" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="4095" class="Symbol">)</a>
      <a id="4103" href="Ledger.Conway.Specification.Script.Validation.html#3985" class="Function">toScriptInput</a> <a id="4117" href="Ledger.Conway.Specification.Script.Validation.html#4117" class="Bound">sp</a> <a id="4120" href="Ledger.Conway.Specification.Script.Validation.html#4120" class="Bound">sh</a> <a id="4123" class="Symbol">=</a>
        <a id="4133" class="Keyword">do</a> <a id="4136" href="Ledger.Conway.Specification.Script.Validation.html#4136" class="Bound">s</a> <a id="4138" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4140" href="Ledger.Conway.Specification.Transaction.html#6502" class="Function">lookupScriptHash</a> <a id="4157" href="Ledger.Conway.Specification.Script.Validation.html#4120" class="Bound">sh</a> <a id="4160" href="Ledger.Conway.Specification.Script.Validation.html#3746" class="Bound">tx</a> <a id="4163" href="Ledger.Conway.Specification.Script.Validation.html#3749" class="Bound">utxo</a>
           <a id="4179" href="Ledger.Conway.Specification.Script.Validation.html#4179" class="Bound">p2s</a> <a id="4183" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4185" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="4196" href="Ledger.Conway.Specification.Script.Validation.html#4136" class="Bound">s</a>
           <a id="4209" class="Symbol">(</a><a id="4210" href="Ledger.Conway.Specification.Script.Validation.html#4210" class="Bound">rdmr</a> <a id="4215" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4217" href="Ledger.Conway.Specification.Script.Validation.html#4217" class="Bound">exunits</a><a id="4224" class="Symbol">)</a> <a id="4226" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4228" href="Ledger.Conway.Specification.Script.Validation.html#1200" class="Function">indexedRdmrs</a> <a id="4241" href="Ledger.Conway.Specification.Script.Validation.html#3746" class="Bound">tx</a> <a id="4244" href="Ledger.Conway.Specification.Script.Validation.html#4117" class="Bound">sp</a>
           <a id="4258" class="Keyword">let</a> <a id="4262" href="Ledger.Conway.Specification.Script.Validation.html#4262" class="Bound">data&#39;</a>     <a id="4272" class="Symbol">=</a> <a id="4274" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="4280" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="4284" class="InductiveConstructor">[]</a> <a id="4287" class="Symbol">(</a><a id="4288" href="Ledger.Conway.Specification.Script.Validation.html#1384" class="Function">getDatum</a> <a id="4297" href="Ledger.Conway.Specification.Script.Validation.html#3746" class="Bound">tx</a> <a id="4300" href="Ledger.Conway.Specification.Script.Validation.html#3749" class="Bound">utxo</a> <a id="4305" href="Ledger.Conway.Specification.Script.Validation.html#4117" class="Bound">sp</a><a id="4307" class="Symbol">)</a> <a id="4309" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="4312" href="Ledger.Conway.Specification.Script.Validation.html#4210" class="Bound">rdmr</a> <a id="4317" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4319" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="4321" href="Ledger.Conway.Specification.Script.Validation.html#3235" class="Function">valContext</a> <a id="4332" class="Symbol">(</a><a id="4333" href="Ledger.Conway.Specification.Script.Validation.html#2178" class="Function">txInfo</a> <a id="4340" class="Symbol">(</a><a id="4341" href="Ledger.Conway.Specification.Script.Base.html#1964" class="Function">language</a> <a id="4350" href="Ledger.Conway.Specification.Script.Validation.html#4179" class="Bound">p2s</a><a id="4353" class="Symbol">)</a> <a id="4355" href="Ledger.Conway.Specification.Script.Validation.html#3743" class="Bound">pp</a> <a id="4358" href="Ledger.Conway.Specification.Script.Validation.html#3749" class="Bound">utxo</a> <a id="4363" href="Ledger.Conway.Specification.Script.Validation.html#3746" class="Bound">tx</a><a id="4365" class="Symbol">)</a> <a id="4367" href="Ledger.Conway.Specification.Script.Validation.html#4117" class="Bound">sp</a> <a id="4370" href="Data.List.Base.html#4907" class="Function Operator">]</a>
               <a id="4387" href="Ledger.Conway.Specification.Script.Validation.html#4387" class="Bound">costModel</a> <a id="4397" class="Symbol">=</a> <a id="4399" href="Ledger.Conway.Specification.PParams.html#3068" class="Field">PParams.costmdls</a> <a id="4416" href="Ledger.Conway.Specification.Script.Validation.html#3743" class="Bound">pp</a>
           <a id="4430" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4435" class="Symbol">(</a><a id="4436" href="Ledger.Conway.Specification.Script.Validation.html#4179" class="Bound">p2s</a> <a id="4440" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4442" href="Ledger.Conway.Specification.Script.Validation.html#4262" class="Bound">data&#39;</a> <a id="4448" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4450" href="Ledger.Conway.Specification.Script.Validation.html#4217" class="Bound">exunits</a> <a id="4458" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4460" href="Ledger.Conway.Specification.Script.Validation.html#4387" class="Bound">costModel</a><a id="4469" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="4472" href="Ledger.Conway.Specification.Script.Validation.html#4472" class="Function">evalP2Scripts</a> <a id="4486" class="Symbol">:</a> <a id="4488" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4493" class="Symbol">(</a><a id="4494" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="4503" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4505" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4510" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="4515" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4517" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="4525" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4527" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="4536" class="Symbol">)</a> <a id="4538" class="Symbol">→</a> <a id="4540" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4545" href="Ledger.Conway.Specification.Script.Validation.html#4472" class="Function">evalP2Scripts</a> <a id="4559" class="Symbol">=</a> <a id="4561" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="4565" class="Symbol">(λ</a> <a id="4568" class="Symbol">(</a><a id="4569" href="Ledger.Conway.Specification.Script.Validation.html#4569" class="Bound">s</a> <a id="4571" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4573" href="Ledger.Conway.Specification.Script.Validation.html#4573" class="Bound">d</a> <a id="4575" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4577" href="Ledger.Conway.Specification.Script.Validation.html#4577" class="Bound">eu</a> <a id="4580" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4582" href="Ledger.Conway.Specification.Script.Validation.html#4582" class="Bound">cm</a><a id="4584" class="Symbol">)</a> <a id="4586" class="Symbol">→</a> <a id="4588" href="Ledger.Conway.Specification.Abstract.html#818" class="Field">runPLCScript</a> <a id="4601" href="Ledger.Conway.Specification.Script.Validation.html#4582" class="Bound">cm</a> <a id="4604" href="Ledger.Conway.Specification.Script.Validation.html#4569" class="Bound">s</a> <a id="4606" href="Ledger.Conway.Specification.Script.Validation.html#4577" class="Bound">eu</a> <a id="4609" href="Ledger.Conway.Specification.Script.Validation.html#4573" class="Bound">d</a><a id="4610" class="Symbol">)</a>

</pre></body></html>