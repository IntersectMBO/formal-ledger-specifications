<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>

<a id="128" class="Keyword">module</a> <a id="135" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="183" class="Symbol">(</a><a id="184" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a> <a id="188" class="Symbol">:</a> <a id="190" class="Symbol">_)</a> <a id="193" class="Symbol">(</a><a id="194" class="Keyword">open</a> <a id="199" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="220" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a><a id="223" class="Symbol">)</a>
  <a id="227" class="Symbol">(</a><a id="228" href="Ledger.Conway.Specification.Script.Validation.html#228" class="Bound">abs</a> <a id="232" class="Symbol">:</a> <a id="234" href="Ledger.Conway.Specification.Abstract.html#654" class="Record">AbstractFunctions</a> <a id="252" href="Ledger.Conway.Specification.Script.Validation.html#184" class="Bound">txs</a><a id="255" class="Symbol">)</a> <a id="257" class="Symbol">(</a><a id="258" class="Keyword">open</a> <a id="263" href="Ledger.Conway.Specification.Abstract.html#654" class="Module">AbstractFunctions</a> <a id="281" href="Ledger.Conway.Specification.Script.Validation.html#228" class="Bound">abs</a><a id="284" class="Symbol">)</a> <a id="286" class="Symbol">(</a><a id="287" class="Keyword">open</a> <a id="292" href="Ledger.Conway.Specification.Abstract.html#282" class="Module">indexOf</a> <a id="300" href="Ledger.Conway.Specification.Abstract.html#786" class="Field">indexOfImp</a><a id="310" class="Symbol">)</a>
  <a id="314" class="Keyword">where</a>

<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="394" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>

<a id="408" class="Keyword">data</a> <a id="ScriptPurpose"></a><a id="413" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a> <a id="427" class="Symbol">:</a> <a id="429" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="434" class="Keyword">where</a>
  <a id="ScriptPurpose.Cert"></a><a id="442" href="Ledger.Conway.Specification.Script.Validation.html#442" class="InductiveConstructor">Cert</a>     <a id="451" class="Symbol">:</a> <a id="453" href="Ledger.Conway.Specification.Certs.html#2238" class="Datatype">DCert</a>        <a id="466" class="Symbol">→</a> <a id="468" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Rwrd"></a><a id="484" href="Ledger.Conway.Specification.Script.Validation.html#484" class="InductiveConstructor">Rwrd</a>     <a id="493" class="Symbol">:</a> <a id="495" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>      <a id="508" class="Symbol">→</a> <a id="510" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Mint"></a><a id="526" href="Ledger.Conway.Specification.Script.Validation.html#526" class="InductiveConstructor">Mint</a>     <a id="535" class="Symbol">:</a> <a id="537" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>   <a id="550" class="Symbol">→</a> <a id="552" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Spend"></a><a id="568" href="Ledger.Conway.Specification.Script.Validation.html#568" class="InductiveConstructor">Spend</a>    <a id="577" class="Symbol">:</a> <a id="579" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a>         <a id="592" class="Symbol">→</a> <a id="594" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Vote"></a><a id="610" href="Ledger.Conway.Specification.Script.Validation.html#610" class="InductiveConstructor">Vote</a>     <a id="619" class="Symbol">:</a> <a id="621" href="Ledger.Conway.Specification.Gov.Actions.html#539" class="Record">GovVoter</a>     <a id="634" class="Symbol">→</a> <a id="636" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a>
  <a id="ScriptPurpose.Propose"></a><a id="652" href="Ledger.Conway.Specification.Script.Validation.html#652" class="InductiveConstructor">Propose</a>  <a id="661" class="Symbol">:</a> <a id="663" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Record">GovProposal</a>  <a id="676" class="Symbol">→</a> <a id="678" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a>

<a id="rdptr"></a><a id="693" href="Ledger.Conway.Specification.Script.Validation.html#693" class="Function">rdptr</a> <a id="699" class="Symbol">:</a> <a id="701" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a> <a id="708" class="Symbol">→</a> <a id="710" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a> <a id="724" class="Symbol">→</a> <a id="726" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="732" href="Ledger.Conway.Specification.Transaction.html#2752" class="Function">RdmrPtr</a>
<a id="740" href="Ledger.Conway.Specification.Script.Validation.html#693" class="Function">rdptr</a> <a id="746" href="Ledger.Conway.Specification.Script.Validation.html#746" class="Bound">txb</a> <a id="750" class="Symbol">=</a> <a id="752" class="Symbol">λ</a> <a id="754" class="Keyword">where</a>
  <a id="762" class="Symbol">(</a><a id="763" href="Ledger.Conway.Specification.Script.Validation.html#442" class="InductiveConstructor">Cert</a> <a id="768" href="Ledger.Conway.Specification.Script.Validation.html#768" class="Bound">h</a><a id="769" class="Symbol">)</a>     <a id="775" class="Symbol">→</a> <a id="777" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="781" class="Symbol">(</a><a id="782" href="Ledger.Conway.Specification.Transaction.html#892" class="InductiveConstructor">Cert</a>    <a id="790" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="792" class="Symbol">)</a> <a id="794" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="796" href="Ledger.Conway.Specification.Abstract.html#315" class="Function">indexOfDCert</a>    <a id="812" href="Ledger.Conway.Specification.Script.Validation.html#768" class="Bound">h</a> <a id="814" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a>
  <a id="824" class="Symbol">(</a><a id="825" href="Ledger.Conway.Specification.Script.Validation.html#484" class="InductiveConstructor">Rwrd</a> <a id="830" href="Ledger.Conway.Specification.Script.Validation.html#830" class="Bound">h</a><a id="831" class="Symbol">)</a>     <a id="837" class="Symbol">→</a> <a id="839" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="843" class="Symbol">(</a><a id="844" href="Ledger.Conway.Specification.Transaction.html#897" class="InductiveConstructor">Rewrd</a>   <a id="852" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="854" class="Symbol">)</a> <a id="856" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="858" href="Ledger.Conway.Specification.Abstract.html#367" class="Function">indexOfRwdAddr</a>  <a id="874" href="Ledger.Conway.Specification.Script.Validation.html#830" class="Bound">h</a> <a id="876" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a>
  <a id="892" class="Symbol">(</a><a id="893" href="Ledger.Conway.Specification.Script.Validation.html#526" class="InductiveConstructor">Mint</a> <a id="898" href="Ledger.Conway.Specification.Script.Validation.html#898" class="Bound">h</a><a id="899" class="Symbol">)</a>     <a id="905" class="Symbol">→</a> <a id="907" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="911" class="Symbol">(</a><a id="912" href="Ledger.Conway.Specification.Transaction.html#887" class="InductiveConstructor">Mint</a>    <a id="920" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="922" class="Symbol">)</a> <a id="924" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="926" href="Ledger.Conway.Specification.Abstract.html#469" class="Function">indexOfPolicyId</a> <a id="942" href="Ledger.Conway.Specification.Script.Validation.html#898" class="Bound">h</a> <a id="944" class="Symbol">(</a><a id="945" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#928" class="Function">policies</a> <a id="954" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a><a id="958" class="Symbol">)</a>
  <a id="962" class="Symbol">(</a><a id="963" href="Ledger.Conway.Specification.Script.Validation.html#568" class="InductiveConstructor">Spend</a> <a id="969" href="Ledger.Conway.Specification.Script.Validation.html#969" class="Bound">h</a><a id="970" class="Symbol">)</a>    <a id="975" class="Symbol">→</a> <a id="977" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="981" class="Symbol">(</a><a id="982" href="Ledger.Conway.Specification.Transaction.html#881" class="InductiveConstructor">Spend</a>   <a id="990" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="992" class="Symbol">)</a> <a id="994" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="996" href="Ledger.Conway.Specification.Abstract.html#422" class="Function">indexOfTxIn</a>     <a id="1012" href="Ledger.Conway.Specification.Script.Validation.html#969" class="Bound">h</a> <a id="1014" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a>
  <a id="1022" class="Symbol">(</a><a id="1023" href="Ledger.Conway.Specification.Script.Validation.html#610" class="InductiveConstructor">Vote</a> <a id="1028" href="Ledger.Conway.Specification.Script.Validation.html#1028" class="Bound">h</a><a id="1029" class="Symbol">)</a>     <a id="1035" class="Symbol">→</a> <a id="1037" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1041" class="Symbol">(</a><a id="1042" href="Ledger.Conway.Specification.Transaction.html#903" class="InductiveConstructor">Vote</a>    <a id="1050" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1052" class="Symbol">)</a> <a id="1054" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1056" href="Ledger.Conway.Specification.Abstract.html#528" class="Function">indexOfVote</a>     <a id="1072" href="Ledger.Conway.Specification.Script.Validation.html#1028" class="Bound">h</a> <a id="1074" class="Symbol">(</a><a id="1075" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1079" href="Ledger.Conway.Specification.Gov.Actions.html#3333" class="Field">GovVote.voter</a> <a id="1093" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a><a id="1103" class="Symbol">)</a>
  <a id="1107" class="Symbol">(</a><a id="1108" href="Ledger.Conway.Specification.Script.Validation.html#652" class="InductiveConstructor">Propose</a> <a id="1116" href="Ledger.Conway.Specification.Script.Validation.html#1116" class="Bound">h</a><a id="1117" class="Symbol">)</a>  <a id="1120" class="Symbol">→</a> <a id="1122" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1126" class="Symbol">(</a><a id="1127" href="Ledger.Conway.Specification.Transaction.html#908" class="InductiveConstructor">Propose</a> <a id="1135" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1137" class="Symbol">)</a> <a id="1139" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1141" href="Ledger.Conway.Specification.Abstract.html#586" class="Function">indexOfProposal</a> <a id="1157" href="Ledger.Conway.Specification.Script.Validation.html#1116" class="Bound">h</a> <a id="1159" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a>
 <a id="1175" class="Keyword">where</a> <a id="1181" class="Keyword">open</a> <a id="1186" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="1193" href="Ledger.Conway.Specification.Script.Validation.html#746" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1198" href="Ledger.Conway.Specification.Script.Validation.html#1198" class="Function">indexedRdmrs</a> <a id="1211" class="Symbol">:</a> <a id="1213" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1216" class="Symbol">→</a> <a id="1218" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a> <a id="1232" class="Symbol">→</a> <a id="1234" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1240" class="Symbol">(</a><a id="1241" href="Ledger.Conway.Specification.Script.Base.html#1788" class="Function">Redeemer</a> <a id="1250" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1252" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a><a id="1259" class="Symbol">)</a>
<a id="1261" href="Ledger.Conway.Specification.Script.Validation.html#1198" class="Function">indexedRdmrs</a> <a id="1274" href="Ledger.Conway.Specification.Script.Validation.html#1274" class="Bound">tx</a> <a id="1277" href="Ledger.Conway.Specification.Script.Validation.html#1277" class="Bound">sp</a> <a id="1280" class="Symbol">=</a> <a id="1282" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1288" class="Symbol">(λ</a> <a id="1291" href="Ledger.Conway.Specification.Script.Validation.html#1291" class="Bound">x</a> <a id="1293" class="Symbol">→</a> <a id="1295" href="Axiom.Set.Map.html#16403" class="Function">lookupᵐ?</a> <a id="1304" href="Ledger.Conway.Specification.Transaction.html#4557" class="Function">txrdmrs</a> <a id="1312" href="Ledger.Conway.Specification.Script.Validation.html#1291" class="Bound">x</a><a id="1313" class="Symbol">)</a> <a id="1315" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1323" class="Symbol">(</a><a id="1324" href="Ledger.Conway.Specification.Script.Validation.html#693" class="Function">rdptr</a> <a id="1330" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a> <a id="1335" href="Ledger.Conway.Specification.Script.Validation.html#1277" class="Bound">sp</a><a id="1337" class="Symbol">)</a>
  <a id="1341" class="Keyword">where</a> <a id="1347" class="Keyword">open</a> <a id="1352" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="1355" href="Ledger.Conway.Specification.Script.Validation.html#1274" class="Bound">tx</a><a id="1357" class="Symbol">;</a> <a id="1359" class="Keyword">open</a> <a id="1364" href="Ledger.Conway.Specification.Transaction.html#4437" class="Module">TxWitnesses</a> <a id="1376" href="Ledger.Conway.Specification.Transaction.html#4738" class="Function">wits</a>

<a id="getDatum"></a><a id="1382" href="Ledger.Conway.Specification.Script.Validation.html#1382" class="Function">getDatum</a> <a id="1391" class="Symbol">:</a> <a id="1393" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1396" class="Symbol">→</a> <a id="1398" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="1403" class="Symbol">→</a> <a id="1405" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a> <a id="1419" class="Symbol">→</a> <a id="1421" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1427" href="Ledger.Conway.Specification.Script.Base.html#1770" class="Function">Datum</a>
<a id="1433" href="Ledger.Conway.Specification.Script.Validation.html#1382" class="Function">getDatum</a> <a id="1442" href="Ledger.Conway.Specification.Script.Validation.html#1442" class="Bound">tx</a> <a id="1445" href="Ledger.Conway.Specification.Script.Validation.html#1445" class="Bound">utxo</a> <a id="1450" class="Symbol">(</a><a id="1451" href="Ledger.Conway.Specification.Script.Validation.html#568" class="InductiveConstructor">Spend</a> <a id="1457" href="Ledger.Conway.Specification.Script.Validation.html#1457" class="Bound">txin</a><a id="1461" class="Symbol">)</a> <a id="1463" class="Symbol">=</a>
  <a id="1467" class="Keyword">do</a> <a id="1470" class="Symbol">(_</a> <a id="1473" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1475" class="Symbol">_</a> <a id="1477" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1479" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1484" href="Ledger.Conway.Specification.Script.Validation.html#1484" class="Bound">d</a> <a id="1486" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1488" class="Symbol">_)</a> <a id="1491" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1493" href="Axiom.Set.Map.html#16403" class="Function">lookupᵐ?</a> <a id="1502" href="Ledger.Conway.Specification.Script.Validation.html#1445" class="Bound">utxo</a> <a id="1507" href="Ledger.Conway.Specification.Script.Validation.html#1457" class="Bound">txin</a>
                          <a id="1538" class="Keyword">where</a>
                            <a id="1572" class="Symbol">(_</a> <a id="1575" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1577" class="Symbol">_</a> <a id="1579" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1581" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1589" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1591" class="Symbol">_)</a> <a id="1594" class="Symbol">→</a> <a id="1596" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1609" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1614" href="Ledger.Conway.Specification.Script.Validation.html#1484" class="Bound">d</a> <a id="1616" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1619" class="Symbol">λ</a> <a id="1621" class="Keyword">where</a>
       <a id="1634" class="Symbol">(</a><a id="1635" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1640" href="Ledger.Conway.Specification.Script.Validation.html#1640" class="Bound">d</a><a id="1641" class="Symbol">)</a> <a id="1643" class="Symbol">→</a> <a id="1645" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1650" href="Ledger.Conway.Specification.Script.Validation.html#1640" class="Bound">d</a>
       <a id="1659" class="Symbol">(</a><a id="1660" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1665" href="Ledger.Conway.Specification.Script.Validation.html#1665" class="Bound">h</a><a id="1666" class="Symbol">)</a> <a id="1668" class="Symbol">→</a> <a id="1670" href="Axiom.Set.Map.html#16403" class="Function">lookupᵐ?</a> <a id="1679" href="Ledger.Conway.Specification.Script.Validation.html#1701" class="Function">m</a> <a id="1681" href="Ledger.Conway.Specification.Script.Validation.html#1665" class="Bound">h</a>
     <a id="1688" class="Keyword">where</a>
       <a id="1701" href="Ledger.Conway.Specification.Script.Validation.html#1701" class="Function">m</a> <a id="1703" class="Symbol">=</a> <a id="1705" href="Ledger.Prelude.html#1740" class="Function">setToMap</a> <a id="1714" class="Symbol">(</a><a id="1715" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1720" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1722" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="1727" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1729" href="Function.Base.html#704" class="Function">id</a> <a id="1732" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1734" class="Symbol">(</a><a id="1735" href="Ledger.Conway.Specification.Transaction.html#4532" class="Field">TxWitnesses.txdats</a> <a id="1754" class="Symbol">(</a><a id="1755" href="Ledger.Conway.Specification.Transaction.html#4738" class="Field">Tx.wits</a> <a id="1763" href="Ledger.Conway.Specification.Script.Validation.html#1442" class="Bound">tx</a><a id="1765" class="Symbol">)))</a>
<a id="1769" href="Ledger.Conway.Specification.Script.Validation.html#1382" class="CatchallClause Function">getDatum</a><a id="1777" class="CatchallClause"> </a><a id="1778" href="Ledger.Conway.Specification.Script.Validation.html#1778" class="CatchallClause Bound">tx</a><a id="1780" class="CatchallClause"> </a><a id="1781" href="Ledger.Conway.Specification.Script.Validation.html#1781" class="CatchallClause Bound">utxo</a><a id="1785" class="CatchallClause"> </a><a id="1786" class="CatchallClause Symbol">_</a> <a id="1788" class="Symbol">=</a> <a id="1790" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="1799" class="Keyword">record</a> <a id="TxInfo"></a><a id="1806" href="Ledger.Conway.Specification.Script.Validation.html#1806" class="Record">TxInfo</a> <a id="1813" class="Symbol">:</a> <a id="1815" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1820" class="Keyword">where</a>
  <a id="1828" class="Keyword">field</a> <a id="TxInfo.realizedInputs"></a><a id="1834" href="Ledger.Conway.Specification.Script.Validation.html#1834" class="Field">realizedInputs</a> <a id="1849" class="Symbol">:</a> <a id="1851" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
        <a id="TxInfo.txOuts"></a><a id="1864" href="Ledger.Conway.Specification.Script.Validation.html#1864" class="Field">txOuts</a>         <a id="1879" class="Symbol">:</a> <a id="1881" href="Ledger.Conway.Specification.Transaction.html#1048" class="Field">Ix</a> <a id="1884" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1886" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a>
        <a id="TxInfo.fee"></a><a id="1900" href="Ledger.Conway.Specification.Script.Validation.html#1900" class="Field">fee</a>            <a id="1915" class="Symbol">:</a> <a id="1917" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#518" class="Function">Value</a>
        <a id="TxInfo.mint"></a><a id="1931" href="Ledger.Conway.Specification.Script.Validation.html#1931" class="Field">mint</a>           <a id="1946" class="Symbol">:</a> <a id="1948" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#518" class="Function">Value</a>
        <a id="TxInfo.txCerts"></a><a id="1962" href="Ledger.Conway.Specification.Script.Validation.html#1962" class="Field">txCerts</a>        <a id="1977" class="Symbol">:</a> <a id="1979" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1984" href="Ledger.Conway.Specification.Certs.html#2238" class="Datatype">DCert</a>
        <a id="TxInfo.txWithdrawals"></a><a id="1998" href="Ledger.Conway.Specification.Script.Validation.html#1998" class="Field">txWithdrawals</a>  <a id="2013" class="Symbol">:</a> <a id="2015" href="Ledger.Core.Specification.Address.html#1399" class="Function">Withdrawals</a>
        <a id="TxInfo.txVldt"></a><a id="2035" href="Ledger.Conway.Specification.Script.Validation.html#2035" class="Field">txVldt</a>         <a id="2050" class="Symbol">:</a> <a id="2052" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2058" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a> <a id="2063" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2065" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2071" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a>
        <a id="TxInfo.vkKey"></a><a id="2084" href="Ledger.Conway.Specification.Script.Validation.html#2084" class="Field">vkKey</a>          <a id="2099" class="Symbol">:</a> <a id="2101" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2103" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
        <a id="TxInfo.txdats"></a><a id="2119" href="Ledger.Conway.Specification.Script.Validation.html#2119" class="Field">txdats</a>         <a id="2134" class="Symbol">:</a> <a id="2136" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2138" href="Ledger.Conway.Specification.Script.Base.html#1770" class="Function">Datum</a>
        <a id="TxInfo.txId"></a><a id="2152" href="Ledger.Conway.Specification.Script.Validation.html#2152" class="Field">txId</a>           <a id="2167" class="Symbol">:</a> <a id="2169" href="Ledger.Conway.Specification.Transaction.html#1051" class="Field">TxId</a>

<a id="txInfo"></a><a id="2175" href="Ledger.Conway.Specification.Script.Validation.html#2175" class="Function">txInfo</a> <a id="2182" class="Symbol">:</a> <a id="2184" href="Ledger.Conway.Specification.Script.Base.html#967" class="Function">Language</a> <a id="2193" class="Symbol">→</a> <a id="2195" href="Ledger.Conway.Specification.PParams.html#1685" class="Record">PParams</a>
                  <a id="2221" class="Symbol">→</a> <a id="2223" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
                  <a id="2246" class="Symbol">→</a> <a id="2248" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a>
                  <a id="2269" class="Symbol">→</a> <a id="2271" href="Ledger.Conway.Specification.Script.Validation.html#1806" class="Record">TxInfo</a>
<a id="2278" href="Ledger.Conway.Specification.Script.Validation.html#2175" class="Function">txInfo</a> <a id="2285" href="Ledger.Conway.Specification.Script.Validation.html#2285" class="Bound">l</a> <a id="2287" href="Ledger.Conway.Specification.Script.Validation.html#2287" class="Bound">pp</a> <a id="2290" href="Ledger.Conway.Specification.Script.Validation.html#2290" class="Bound">utxo</a> <a id="2295" href="Ledger.Conway.Specification.Script.Validation.html#2295" class="Bound">tx</a> <a id="2298" class="Symbol">=</a> <a id="2300" class="Keyword">record</a>
  <a id="2309" class="Symbol">{</a> <a id="2311" href="Ledger.Conway.Specification.Script.Validation.html#2311" class="Module">TxBody</a> <a id="2318" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">body</a>
  <a id="2325" class="Symbol">;</a> <a id="2327" href="Ledger.Conway.Specification.Script.Validation.html#2327" class="Module">TxWitnesses</a> <a id="2339" href="Ledger.Conway.Specification.Transaction.html#4738" class="Field">wits</a>
  <a id="2346" class="Symbol">;</a> <a id="2348" href="Ledger.Conway.Specification.Script.Validation.html#1834" class="Field">realizedInputs</a> <a id="2363" class="Symbol">=</a> <a id="2365" href="Ledger.Conway.Specification.Script.Validation.html#2290" class="Bound">utxo</a> <a id="2370" href="Axiom.Set.Map.html#12770" class="Function Operator">∣</a> <a id="2372" href="Ledger.Conway.Specification.Transaction.html#3032" class="Function">txIns</a>
  <a id="2380" class="Symbol">;</a> <a id="2382" href="Ledger.Conway.Specification.Script.Validation.html#1900" class="Field">fee</a> <a id="2386" class="Symbol">=</a> <a id="2388" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2395" href="Ledger.Conway.Specification.Transaction.html#3254" class="Function">txFee</a>
  <a id="2403" class="Symbol">;</a> <a id="2405" href="Ledger.Conway.Specification.Script.Validation.html#1931" class="Field">mint</a> <a id="2410" class="Symbol">=</a> <a id="2412" href="Ledger.Conway.Specification.Transaction.html#3638" class="Function">mint</a>
  <a id="2419" class="Symbol">;</a> <a id="2421" href="Ledger.Conway.Specification.Script.Validation.html#2084" class="Field">vkKey</a> <a id="2427" class="Symbol">=</a> <a id="2429" href="Ledger.Conway.Specification.Transaction.html#3673" class="Function">reqSignerHashes</a>
  <a id="2447" class="Symbol">}</a> <a id="2449" class="Keyword">where</a> <a id="2455" class="Keyword">open</a> <a id="2460" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="2463" href="Ledger.Conway.Specification.Script.Validation.html#2295" class="Bound">tx</a><a id="2465" class="Symbol">;</a> <a id="2467" class="Keyword">open</a> <a id="2472" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="2479" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">body</a>

<a id="credsNeeded"></a><a id="2485" href="Ledger.Conway.Specification.Script.Validation.html#2485" class="Function">credsNeeded</a> <a id="2497" class="Symbol">:</a> <a id="2499" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="2504" class="Symbol">→</a> <a id="2506" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a> <a id="2513" class="Symbol">→</a> <a id="2515" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2517" class="Symbol">(</a><a id="2518" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a> <a id="2532" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2534" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a><a id="2544" class="Symbol">)</a>
<a id="2546" href="Ledger.Conway.Specification.Script.Validation.html#2485" class="Function">credsNeeded</a> <a id="2558" href="Ledger.Conway.Specification.Script.Validation.html#2558" class="Bound">utxo</a> <a id="2563" href="Ledger.Conway.Specification.Script.Validation.html#2563" class="Bound">txb</a>
  <a id="2569" class="Symbol">=</a>  <a id="2572" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2577" class="Symbol">(λ</a> <a id="2580" class="Symbol">(</a><a id="2581" href="Ledger.Conway.Specification.Script.Validation.html#2581" class="Bound">i</a> <a id="2583" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2585" href="Ledger.Conway.Specification.Script.Validation.html#2585" class="Bound">o</a><a id="2586" class="Symbol">)</a>  <a id="2589" class="Symbol">→</a> <a id="2591" class="Symbol">(</a><a id="2592" href="Ledger.Conway.Specification.Script.Validation.html#568" class="InductiveConstructor">Spend</a>  <a id="2599" href="Ledger.Conway.Specification.Script.Validation.html#2581" class="Bound">i</a> <a id="2601" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2603" href="Ledger.Core.Specification.Address.html#2639" class="Function">payCred</a> <a id="2611" class="Symbol">(</a><a id="2612" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2618" href="Ledger.Conway.Specification.Script.Validation.html#2585" class="Bound">o</a><a id="2619" class="Symbol">)))</a> <a id="2623" class="Symbol">((</a><a id="2625" href="Ledger.Conway.Specification.Script.Validation.html#2558" class="Bound">utxo</a> <a id="2630" href="Axiom.Set.Map.html#12770" class="Function Operator">∣</a> <a id="2632" class="Symbol">(</a><a id="2633" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a> <a id="2639" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="2641" href="Ledger.Conway.Specification.Transaction.html#3104" class="Field">collateralInputs</a><a id="2657" class="Symbol">))</a> <a id="2660" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2661" class="Symbol">)</a>
  <a id="2665" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2668" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2673" class="Symbol">(λ</a> <a id="2676" href="Ledger.Conway.Specification.Script.Validation.html#2676" class="Bound">a</a>        <a id="2685" class="Symbol">→</a> <a id="2687" class="Symbol">(</a><a id="2688" href="Ledger.Conway.Specification.Script.Validation.html#484" class="InductiveConstructor">Rwrd</a>   <a id="2695" href="Ledger.Conway.Specification.Script.Validation.html#2676" class="Bound">a</a> <a id="2697" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2699" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="2705" href="Ledger.Conway.Specification.Script.Validation.html#2676" class="Bound">a</a><a id="2706" class="Symbol">))</a> <a id="2709" class="Symbol">(</a><a id="2710" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2714" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="2716" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a> <a id="2730" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a><a id="2731" class="Symbol">)</a>
  <a id="2735" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2738" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="2749" class="Symbol">(λ</a> <a id="2752" href="Ledger.Conway.Specification.Script.Validation.html#2752" class="Bound">c</a>  <a id="2755" class="Symbol">→</a> <a id="2757" class="Symbol">(</a><a id="2758" href="Ledger.Conway.Specification.Script.Validation.html#442" class="InductiveConstructor">Cert</a>   <a id="2765" href="Ledger.Conway.Specification.Script.Validation.html#2752" class="Bound">c</a> <a id="2767" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2769" class="Symbol">)</a> <a id="2771" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2775" href="Ledger.Conway.Specification.Certs.html#2993" class="Function">cwitness</a> <a id="2784" href="Ledger.Conway.Specification.Script.Validation.html#2752" class="Bound">c</a><a id="2785" class="Symbol">)</a> <a id="2787" class="Symbol">(</a><a id="2788" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="2797" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a><a id="2804" class="Symbol">)</a>
  <a id="2808" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2811" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2816" class="Symbol">(λ</a> <a id="2819" href="Ledger.Conway.Specification.Script.Validation.html#2819" class="Bound">x</a>        <a id="2828" class="Symbol">→</a> <a id="2830" class="Symbol">(</a><a id="2831" href="Ledger.Conway.Specification.Script.Validation.html#526" class="InductiveConstructor">Mint</a>   <a id="2838" href="Ledger.Conway.Specification.Script.Validation.html#2819" class="Bound">x</a> <a id="2840" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2842" href="Ledger.Core.Specification.Address.html#322" class="InductiveConstructor">ScriptObj</a> <a id="2852" href="Ledger.Conway.Specification.Script.Validation.html#2819" class="Bound">x</a><a id="2853" class="Symbol">))</a> <a id="2856" class="Symbol">(</a><a id="2857" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#928" class="Function">policies</a> <a id="2866" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a><a id="2870" class="Symbol">)</a>
  <a id="2874" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="2877" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="2888" class="Symbol">(λ</a> <a id="2891" href="Ledger.Conway.Specification.Script.Validation.html#2891" class="Bound">v</a> <a id="2893" class="Symbol">→</a> <a id="2895" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2898" href="Ledger.Conway.Specification.Gov.Actions.html#6066" class="Function">isGovVoterCredential</a> <a id="2919" href="Ledger.Conway.Specification.Script.Validation.html#2891" class="Bound">v</a> <a id="2921" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2926" class="Symbol">(λ</a> <a id="2929" class="Symbol">{</a><a id="2930" href="Ledger.Conway.Specification.Script.Validation.html#2930" class="Bound">c</a><a id="2931" class="Symbol">}</a> <a id="2933" class="Symbol">→</a> <a id="2935" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2940" class="Symbol">(</a><a id="2941" href="Ledger.Conway.Specification.Script.Validation.html#610" class="InductiveConstructor">Vote</a> <a id="2946" href="Ledger.Conway.Specification.Script.Validation.html#2891" class="Bound">v</a> <a id="2948" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2950" href="Ledger.Conway.Specification.Script.Validation.html#2930" class="Bound">c</a><a id="2951" class="Symbol">))</a> <a id="2954" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2959" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2966" class="Symbol">)</a>
                <a id="2984" class="Symbol">(</a><a id="2985" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="2994" class="Symbol">(</a><a id="2995" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2999" href="Ledger.Conway.Specification.Gov.Actions.html#3333" class="Field">voter</a> <a id="3005" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a><a id="3015" class="Symbol">))</a>
  <a id="3020" href="Axiom.Set.html#8952" class="Function Operator">∪</a>  <a id="3023" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3034" class="Symbol">(λ</a> <a id="3037" href="Ledger.Conway.Specification.Script.Validation.html#3037" class="Bound">p</a> <a id="3039" class="Symbol">→</a> <a id="3041" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3044" href="Ledger.Conway.Specification.Script.Validation.html#3037" class="Bound">p</a> <a id="3046" class="Symbol">.</a><a id="3047" href="Ledger.Conway.Specification.Gov.Actions.html#3527" class="Field">policy</a> <a id="3054" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3059" class="Symbol">(λ</a> <a id="3062" class="Symbol">{</a><a id="3063" href="Ledger.Conway.Specification.Script.Validation.html#3063" class="Bound">sh</a><a id="3065" class="Symbol">}</a> <a id="3067" class="Symbol">→</a> <a id="3069" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3074" class="Symbol">(</a><a id="3075" href="Ledger.Conway.Specification.Script.Validation.html#652" class="InductiveConstructor">Propose</a>  <a id="3084" href="Ledger.Conway.Specification.Script.Validation.html#3037" class="Bound">p</a> <a id="3086" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3088" href="Ledger.Core.Specification.Address.html#322" class="InductiveConstructor">ScriptObj</a> <a id="3098" href="Ledger.Conway.Specification.Script.Validation.html#3063" class="Bound">sh</a><a id="3100" class="Symbol">))</a> <a id="3103" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3108" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3115" class="Symbol">)</a>
                <a id="3133" class="Symbol">(</a><a id="3134" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="3143" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a><a id="3157" class="Symbol">)</a>
  <a id="3161" class="Keyword">where</a>
    <a id="3171" class="Keyword">open</a> <a id="3176" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="3183" href="Ledger.Conway.Specification.Script.Validation.html#2563" class="Bound">txb</a>
    <a id="3191" class="Keyword">open</a> <a id="3196" href="Ledger.Conway.Specification.Gov.Actions.html#3270" class="Module">GovVote</a>
    <a id="3208" class="Keyword">open</a> <a id="3213" href="Ledger.Core.Specification.Address.html#1324" class="Module">RwdAddr</a>
    <a id="3225" class="Keyword">open</a> <a id="3230" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Module">GovProposal</a>

<a id="valContext"></a><a id="3243" href="Ledger.Conway.Specification.Script.Validation.html#3243" class="Function">valContext</a> <a id="3254" class="Symbol">:</a> <a id="3256" href="Ledger.Conway.Specification.Script.Validation.html#1806" class="Record">TxInfo</a> <a id="3263" class="Symbol">→</a> <a id="3265" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a> <a id="3279" class="Symbol">→</a> <a id="3281" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a>
<a id="3286" href="Ledger.Conway.Specification.Script.Validation.html#3243" class="Function">valContext</a> <a id="3297" href="Ledger.Conway.Specification.Script.Validation.html#3297" class="Bound">txinfo</a> <a id="3304" href="Ledger.Conway.Specification.Script.Validation.html#3304" class="Bound">sp</a> <a id="3307" class="Symbol">=</a> <a id="3309" href="Ledger.Conway.Specification.Script.Base.html#2007" class="Function">toData</a> <a id="3316" class="Symbol">(</a><a id="3317" href="Ledger.Conway.Specification.Script.Validation.html#3297" class="Bound">txinfo</a> <a id="3324" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3326" href="Ledger.Conway.Specification.Script.Validation.html#3304" class="Bound">sp</a><a id="3328" class="Symbol">)</a>

<a id="txOutToDataHash"></a><a id="3331" href="Ledger.Conway.Specification.Script.Validation.html#3331" class="Function">txOutToDataHash</a> <a id="3347" class="Symbol">:</a> <a id="3349" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="3355" class="Symbol">→</a> <a id="3357" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3363" href="Ledger.Conway.Specification.Script.Base.html#1723" class="Function">DataHash</a>
<a id="3372" href="Ledger.Conway.Specification.Script.Validation.html#3331" class="Function">txOutToDataHash</a> <a id="3388" class="Symbol">(_</a> <a id="3391" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3393" class="Symbol">_</a> <a id="3395" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3397" href="Ledger.Conway.Specification.Script.Validation.html#3397" class="Bound">d</a> <a id="3399" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3401" class="Symbol">_)</a> <a id="3404" class="Symbol">=</a> <a id="3406" href="Ledger.Conway.Specification.Script.Validation.html#3397" class="Bound">d</a> <a id="3408" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="3412" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="3420" href="Ledger.Conway.Specification.Script.Validation.html#3420" class="Function">txOutToP2Script</a>
  <a id="3438" class="Symbol">:</a> <a id="3440" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="3445" class="Symbol">→</a> <a id="3447" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a>
  <a id="3452" class="Symbol">→</a> <a id="3454" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="3460" class="Symbol">→</a> <a id="3462" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3468" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a>
<a id="3477" href="Ledger.Conway.Specification.Script.Validation.html#3420" class="Function">txOutToP2Script</a> <a id="3493" href="Ledger.Conway.Specification.Script.Validation.html#3493" class="Bound">utxo</a> <a id="3498" href="Ledger.Conway.Specification.Script.Validation.html#3498" class="Bound">tx</a> <a id="3501" class="Symbol">(</a><a id="3502" href="Ledger.Conway.Specification.Script.Validation.html#3502" class="Bound">a</a> <a id="3504" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3506" class="Symbol">_)</a> <a id="3509" class="Symbol">=</a>
  <a id="3513" class="Keyword">do</a> <a id="3516" href="Ledger.Conway.Specification.Script.Validation.html#3516" class="Bound">sh</a> <a id="3519" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3521" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a> <a id="3533" class="Symbol">(</a><a id="3534" href="Ledger.Core.Specification.Address.html#2639" class="Function">payCred</a> <a id="3542" href="Ledger.Conway.Specification.Script.Validation.html#3502" class="Bound">a</a><a id="3543" class="Symbol">)</a>
     <a id="3550" href="Ledger.Conway.Specification.Script.Validation.html#3550" class="Bound">s</a>  <a id="3553" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3555" href="Ledger.Conway.Specification.Transaction.html#6502" class="Function">lookupScriptHash</a> <a id="3572" href="Ledger.Conway.Specification.Script.Validation.html#3516" class="Bound">sh</a> <a id="3575" href="Ledger.Conway.Specification.Script.Validation.html#3498" class="Bound">tx</a> <a id="3578" href="Ledger.Conway.Specification.Script.Validation.html#3493" class="Bound">utxo</a>
     <a id="3588" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="3599" href="Ledger.Conway.Specification.Script.Validation.html#3550" class="Bound">s</a>

<a id="3602" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3611" href="Ledger.Conway.Specification.Script.Validation.html#3611" class="Function">collectP2ScriptsWithContext</a>
    <a id="3643" class="Symbol">:</a> <a id="3645" href="Ledger.Conway.Specification.PParams.html#1685" class="Record">PParams</a> <a id="3653" class="Symbol">→</a> <a id="3655" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="3658" class="Symbol">→</a> <a id="3660" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a>
    <a id="3669" class="Symbol">→</a> <a id="3671" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3676" class="Symbol">(</a><a id="3677" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="3686" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3688" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3693" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="3698" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3700" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="3708" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3710" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="3719" class="Symbol">)</a>
  <a id="3723" href="Ledger.Conway.Specification.Script.Validation.html#3611" class="Function">collectP2ScriptsWithContext</a> <a id="3751" href="Ledger.Conway.Specification.Script.Validation.html#3751" class="Bound">pp</a> <a id="3754" href="Ledger.Conway.Specification.Script.Validation.html#3754" class="Bound">tx</a> <a id="3757" href="Ledger.Conway.Specification.Script.Validation.html#3757" class="Bound">utxo</a>
    <a id="3766" class="Symbol">=</a> <a id="3768" href="abstract-set-theory.FiniteSetTheory.html#2556" class="Function">setToList</a>
    <a id="3782" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3784" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3795" class="Symbol">(λ</a> <a id="3798" class="Symbol">(</a><a id="3799" href="Ledger.Conway.Specification.Script.Validation.html#3799" class="Bound">sp</a> <a id="3802" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3804" href="Ledger.Conway.Specification.Script.Validation.html#3804" class="Bound">c</a><a id="3805" class="Symbol">)</a> <a id="3807" class="Symbol">→</a> <a id="3809" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3812" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a> <a id="3824" href="Ledger.Conway.Specification.Script.Validation.html#3804" class="Bound">c</a>
                                <a id="3858" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3863" class="Symbol">(λ</a> <a id="3866" class="Symbol">{</a><a id="3867" href="Ledger.Conway.Specification.Script.Validation.html#3867" class="Bound">sh</a><a id="3869" class="Symbol">}</a> <a id="3871" class="Symbol">→</a> <a id="3873" href="Ledger.Conway.Specification.Script.Validation.html#3993" class="Function">toScriptInput</a> <a id="3887" href="Ledger.Conway.Specification.Script.Validation.html#3799" class="Bound">sp</a> <a id="3890" href="Ledger.Conway.Specification.Script.Validation.html#3867" class="Bound">sh</a><a id="3892" class="Symbol">)</a>
                                <a id="3926" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3931" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3938" class="Symbol">)</a>
    <a id="3944" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3946" href="Ledger.Conway.Specification.Script.Validation.html#2485" class="Function">credsNeeded</a> <a id="3958" href="Ledger.Conway.Specification.Script.Validation.html#3757" class="Bound">utxo</a> <a id="3963" class="Symbol">(</a><a id="3964" href="Ledger.Conway.Specification.Script.Validation.html#3754" class="Bound">tx</a> <a id="3967" class="Symbol">.</a><a id="3968" href="Ledger.Conway.Specification.Transaction.html#4714" class="Field">Tx.body</a><a id="3975" class="Symbol">)</a>
    <a id="3981" class="Keyword">where</a>
      <a id="3993" href="Ledger.Conway.Specification.Script.Validation.html#3993" class="Function">toScriptInput</a>
        <a id="4015" class="Symbol">:</a> <a id="4017" href="Ledger.Conway.Specification.Script.Validation.html#413" class="Datatype">ScriptPurpose</a> <a id="4031" class="Symbol">→</a> <a id="4033" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
        <a id="4052" class="Symbol">→</a> <a id="4054" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4060" class="Symbol">(</a><a id="4061" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="4070" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4072" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4077" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="4082" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4084" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="4092" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4094" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="4103" class="Symbol">)</a>
      <a id="4111" href="Ledger.Conway.Specification.Script.Validation.html#3993" class="Function">toScriptInput</a> <a id="4125" href="Ledger.Conway.Specification.Script.Validation.html#4125" class="Bound">sp</a> <a id="4128" href="Ledger.Conway.Specification.Script.Validation.html#4128" class="Bound">sh</a> <a id="4131" class="Symbol">=</a>
        <a id="4141" class="Keyword">do</a> <a id="4144" href="Ledger.Conway.Specification.Script.Validation.html#4144" class="Bound">s</a> <a id="4146" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4148" href="Ledger.Conway.Specification.Transaction.html#6502" class="Function">lookupScriptHash</a> <a id="4165" href="Ledger.Conway.Specification.Script.Validation.html#4128" class="Bound">sh</a> <a id="4168" href="Ledger.Conway.Specification.Script.Validation.html#3754" class="Bound">tx</a> <a id="4171" href="Ledger.Conway.Specification.Script.Validation.html#3757" class="Bound">utxo</a>
           <a id="4187" href="Ledger.Conway.Specification.Script.Validation.html#4187" class="Bound">p2s</a> <a id="4191" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4193" href="Ledger.Conway.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="4204" href="Ledger.Conway.Specification.Script.Validation.html#4144" class="Bound">s</a>
           <a id="4217" class="Symbol">(</a><a id="4218" href="Ledger.Conway.Specification.Script.Validation.html#4218" class="Bound">rdmr</a> <a id="4223" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4225" href="Ledger.Conway.Specification.Script.Validation.html#4225" class="Bound">exunits</a><a id="4232" class="Symbol">)</a> <a id="4234" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4236" href="Ledger.Conway.Specification.Script.Validation.html#1198" class="Function">indexedRdmrs</a> <a id="4249" href="Ledger.Conway.Specification.Script.Validation.html#3754" class="Bound">tx</a> <a id="4252" href="Ledger.Conway.Specification.Script.Validation.html#4125" class="Bound">sp</a>
           <a id="4266" class="Keyword">let</a> <a id="4270" href="Ledger.Conway.Specification.Script.Validation.html#4270" class="Bound">data&#39;</a>     <a id="4280" class="Symbol">=</a> <a id="4282" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="4288" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="4292" class="InductiveConstructor">[]</a> <a id="4295" class="Symbol">(</a><a id="4296" href="Ledger.Conway.Specification.Script.Validation.html#1382" class="Function">getDatum</a> <a id="4305" href="Ledger.Conway.Specification.Script.Validation.html#3754" class="Bound">tx</a> <a id="4308" href="Ledger.Conway.Specification.Script.Validation.html#3757" class="Bound">utxo</a> <a id="4313" href="Ledger.Conway.Specification.Script.Validation.html#4125" class="Bound">sp</a><a id="4315" class="Symbol">)</a> <a id="4317" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="4320" href="Ledger.Conway.Specification.Script.Validation.html#4218" class="Bound">rdmr</a> <a id="4325" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4327" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="4329" href="Ledger.Conway.Specification.Script.Validation.html#3243" class="Function">valContext</a> <a id="4340" class="Symbol">(</a><a id="4341" href="Ledger.Conway.Specification.Script.Validation.html#2175" class="Function">txInfo</a> <a id="4348" class="Symbol">(</a><a id="4349" href="Ledger.Conway.Specification.Script.Base.html#1964" class="Function">language</a> <a id="4358" href="Ledger.Conway.Specification.Script.Validation.html#4187" class="Bound">p2s</a><a id="4361" class="Symbol">)</a> <a id="4363" href="Ledger.Conway.Specification.Script.Validation.html#3751" class="Bound">pp</a> <a id="4366" href="Ledger.Conway.Specification.Script.Validation.html#3757" class="Bound">utxo</a> <a id="4371" href="Ledger.Conway.Specification.Script.Validation.html#3754" class="Bound">tx</a><a id="4373" class="Symbol">)</a> <a id="4375" href="Ledger.Conway.Specification.Script.Validation.html#4125" class="Bound">sp</a> <a id="4378" href="Data.List.Base.html#4907" class="Function Operator">]</a>
               <a id="4395" href="Ledger.Conway.Specification.Script.Validation.html#4395" class="Bound">costModel</a> <a id="4405" class="Symbol">=</a> <a id="4407" href="Ledger.Conway.Specification.PParams.html#3064" class="Field">PParams.costmdls</a> <a id="4424" href="Ledger.Conway.Specification.Script.Validation.html#3751" class="Bound">pp</a>
           <a id="4438" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4443" class="Symbol">(</a><a id="4444" href="Ledger.Conway.Specification.Script.Validation.html#4187" class="Bound">p2s</a> <a id="4448" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4450" href="Ledger.Conway.Specification.Script.Validation.html#4270" class="Bound">data&#39;</a> <a id="4456" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4458" href="Ledger.Conway.Specification.Script.Validation.html#4225" class="Bound">exunits</a> <a id="4466" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4468" href="Ledger.Conway.Specification.Script.Validation.html#4395" class="Bound">costModel</a><a id="4477" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="4480" href="Ledger.Conway.Specification.Script.Validation.html#4480" class="Function">evalP2Scripts</a> <a id="4494" class="Symbol">:</a> <a id="4496" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4501" class="Symbol">(</a><a id="4502" href="Ledger.Conway.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="4511" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4513" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4518" href="Ledger.Conway.Specification.Script.Base.html#1708" class="Function">Data</a> <a id="4523" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4525" href="Ledger.Conway.Specification.Script.Base.html#1018" class="Function">ExUnits</a> <a id="4533" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4535" href="Ledger.Conway.Specification.Script.Base.html#989" class="Function">CostModel</a><a id="4544" class="Symbol">)</a> <a id="4546" class="Symbol">→</a> <a id="4548" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4553" href="Ledger.Conway.Specification.Script.Validation.html#4480" class="Function">evalP2Scripts</a> <a id="4567" class="Symbol">=</a> <a id="4569" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="4573" class="Symbol">(λ</a> <a id="4576" class="Symbol">(</a><a id="4577" href="Ledger.Conway.Specification.Script.Validation.html#4577" class="Bound">s</a> <a id="4579" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4581" href="Ledger.Conway.Specification.Script.Validation.html#4581" class="Bound">d</a> <a id="4583" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4585" href="Ledger.Conway.Specification.Script.Validation.html#4585" class="Bound">eu</a> <a id="4588" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4590" href="Ledger.Conway.Specification.Script.Validation.html#4590" class="Bound">cm</a><a id="4592" class="Symbol">)</a> <a id="4594" class="Symbol">→</a> <a id="4596" href="Ledger.Conway.Specification.Abstract.html#817" class="Field">runPLCScript</a> <a id="4609" href="Ledger.Conway.Specification.Script.Validation.html#4590" class="Bound">cm</a> <a id="4612" href="Ledger.Conway.Specification.Script.Validation.html#4577" class="Bound">s</a> <a id="4614" href="Ledger.Conway.Specification.Script.Validation.html#4585" class="Bound">eu</a> <a id="4617" href="Ledger.Conway.Specification.Script.Validation.html#4581" class="Bound">d</a><a id="4618" class="Symbol">)</a>

</pre></body></html>