<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Script.Validation</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="124" class="Keyword">module</a> <a id="131" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a>
  <a id="179" class="Symbol">(</a><a id="180" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a> <a id="184" class="Symbol">:</a> <a id="186" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="206" class="Symbol">)</a> <a id="208" class="Symbol">(</a><a id="209" class="Keyword">open</a> <a id="214" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="235" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a><a id="238" class="Symbol">)</a>
  <a id="242" class="Symbol">(</a><a id="243" href="Ledger.Conway.Specification.Script.Validation.html#243" class="Bound">abs</a> <a id="247" class="Symbol">:</a> <a id="249" href="Ledger.Core.Specification.Abstract.html#826" class="Record">AbstractFunctions</a> <a id="267" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a><a id="270" class="Symbol">)</a> <a id="272" class="Symbol">(</a><a id="273" class="Keyword">open</a> <a id="278" href="Ledger.Core.Specification.Abstract.html#826" class="Module">AbstractFunctions</a> <a id="296" href="Ledger.Conway.Specification.Script.Validation.html#243" class="Bound">abs</a><a id="299" class="Symbol">)</a> <a id="301" class="Symbol">(</a><a id="302" class="Keyword">open</a> <a id="307" href="Ledger.Core.Specification.Abstract.html#345" class="Module">indexOf</a> <a id="315" href="Ledger.Core.Specification.Abstract.html#958" class="Field">indexOfImp</a><a id="325" class="Symbol">)</a>
  <a id="329" class="Keyword">where</a>

<a id="336" class="Keyword">open</a> <a id="341" class="Keyword">import</a> <a id="348" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="363" class="Keyword">open</a> <a id="368" class="Keyword">import</a> <a id="375" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="409" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="422" class="Keyword">open</a> <a id="427" class="Keyword">import</a> <a id="434" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="474" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a> <a id="478" href="Ledger.Conway.Specification.Script.Validation.html#243" class="Bound">abs</a>
<a id="482" class="Keyword">open</a> <a id="487" class="Keyword">import</a> <a id="494" href="Ledger.Conway.Specification.Script.ScriptPurpose.html" class="Module">Ledger.Conway.Specification.Script.ScriptPurpose</a> <a id="543" href="Ledger.Conway.Specification.Script.Validation.html#180" class="Bound">txs</a>
<a id="rdptr"></a><a id="547" href="Ledger.Conway.Specification.Script.Validation.html#547" class="Function">rdptr</a> <a id="553" class="Symbol">:</a> <a id="555" href="Ledger.Conway.Specification.Transaction.html#350" class="Record">TxBody</a> <a id="562" class="Symbol">→</a> <a id="564" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#292" class="Datatype">ScriptPurpose</a> <a id="578" class="Symbol">→</a> <a id="580" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="586" href="Ledger.Core.Specification.Transaction.html#2643" class="Function">RdmrPtr</a>
<a id="594" href="Ledger.Conway.Specification.Script.Validation.html#547" class="Function">rdptr</a> <a id="600" href="Ledger.Conway.Specification.Script.Validation.html#600" class="Bound">txb</a> <a id="604" class="Symbol">=</a> <a id="606" class="Symbol">λ</a> <a id="608" class="Keyword">where</a>
  <a id="616" class="Symbol">(</a><a id="617" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#321" class="InductiveConstructor">Cert</a> <a id="622" href="Ledger.Conway.Specification.Script.Validation.html#622" class="Bound">h</a><a id="623" class="Symbol">)</a>     <a id="629" class="Symbol">→</a> <a id="631" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="635" class="Symbol">(</a><a id="636" href="Ledger.Core.Specification.Transaction.html#789" class="InductiveConstructor">Cert</a>    <a id="644" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="646" class="Symbol">)</a> <a id="648" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="650" href="Ledger.Core.Specification.Abstract.html#378" class="Function">indexOfDCert</a>          <a id="672" href="Ledger.Conway.Specification.Script.Validation.html#622" class="Bound">h</a> <a id="674" href="Ledger.Conway.Specification.Transaction.html#554" class="Field">txCerts</a>
  <a id="684" class="Symbol">(</a><a id="685" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#365" class="InductiveConstructor">Rwrd</a> <a id="690" href="Ledger.Conway.Specification.Script.Validation.html#690" class="Bound">h</a><a id="691" class="Symbol">)</a>     <a id="697" class="Symbol">→</a> <a id="699" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="703" class="Symbol">(</a><a id="704" href="Ledger.Core.Specification.Transaction.html#794" class="InductiveConstructor">Rewrd</a>   <a id="712" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="714" class="Symbol">)</a> <a id="716" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="718" href="Ledger.Core.Specification.Abstract.html#452" class="Function">indexOfRewardAddress</a>  <a id="740" href="Ledger.Conway.Specification.Script.Validation.html#690" class="Bound">h</a> <a id="742" href="Ledger.Conway.Specification.Transaction.html#624" class="Field">txWithdrawals</a>
  <a id="758" class="Symbol">(</a><a id="759" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#409" class="InductiveConstructor">Mint</a> <a id="764" href="Ledger.Conway.Specification.Script.Validation.html#764" class="Bound">h</a><a id="765" class="Symbol">)</a>     <a id="771" class="Symbol">→</a> <a id="773" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="777" class="Symbol">(</a><a id="778" href="Ledger.Core.Specification.Transaction.html#784" class="InductiveConstructor">Mint</a>    <a id="786" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="788" class="Symbol">)</a> <a id="790" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="792" href="Ledger.Core.Specification.Abstract.html#600" class="Function">indexOfPolicyId</a>       <a id="814" href="Ledger.Conway.Specification.Script.Validation.html#764" class="Bound">h</a> <a id="816" class="Symbol">(</a><a id="817" href="Ledger.Core.Specification.TokenAlgebra.Base.html#925" class="Function">policies</a> <a id="826" href="Ledger.Conway.Specification.Transaction.html#958" class="Field">mint</a><a id="830" class="Symbol">)</a>
  <a id="834" class="Symbol">(</a><a id="835" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#453" class="InductiveConstructor">Spend</a> <a id="841" href="Ledger.Conway.Specification.Script.Validation.html#841" class="Bound">h</a><a id="842" class="Symbol">)</a>    <a id="847" class="Symbol">→</a> <a id="849" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="853" class="Symbol">(</a><a id="854" href="Ledger.Core.Specification.Transaction.html#778" class="InductiveConstructor">Spend</a>   <a id="862" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="864" class="Symbol">)</a> <a id="866" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="868" href="Ledger.Core.Specification.Abstract.html#526" class="Function">indexOfTxIn</a>           <a id="890" href="Ledger.Conway.Specification.Script.Validation.html#841" class="Bound">h</a> <a id="892" href="Ledger.Conway.Specification.Transaction.html#382" class="Field">txIns</a>
  <a id="900" class="Symbol">(</a><a id="901" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#497" class="InductiveConstructor">Vote</a> <a id="906" href="Ledger.Conway.Specification.Script.Validation.html#906" class="Bound">h</a><a id="907" class="Symbol">)</a>     <a id="913" class="Symbol">→</a> <a id="915" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="919" class="Symbol">(</a><a id="920" href="Ledger.Core.Specification.Transaction.html#800" class="InductiveConstructor">Vote</a>    <a id="928" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="930" class="Symbol">)</a> <a id="932" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="934" href="Ledger.Core.Specification.Abstract.html#674" class="Function">indexOfVote</a>           <a id="956" href="Ledger.Conway.Specification.Script.Validation.html#906" class="Bound">h</a> <a id="958" class="Symbol">(</a><a id="959" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="963" href="Ledger.Core.Specification.Gov.Actions.html#2353" class="Field">GovVote.voter</a> <a id="977" href="Ledger.Conway.Specification.Transaction.html#791" class="Field">txGovVotes</a><a id="987" class="Symbol">)</a>
  <a id="991" class="Symbol">(</a><a id="992" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#541" class="InductiveConstructor">Propose</a> <a id="1000" href="Ledger.Conway.Specification.Script.Validation.html#1000" class="Bound">h</a><a id="1001" class="Symbol">)</a>  <a id="1004" class="Symbol">→</a> <a id="1006" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1010" class="Symbol">(</a><a id="1011" href="Ledger.Core.Specification.Transaction.html#805" class="InductiveConstructor">Propose</a> <a id="1019" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="1021" class="Symbol">)</a> <a id="1023" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1025" href="Ledger.Core.Specification.Abstract.html#748" class="Function">indexOfProposal</a>       <a id="1047" href="Ledger.Conway.Specification.Script.Validation.html#1000" class="Bound">h</a> <a id="1049" href="Ledger.Conway.Specification.Transaction.html#831" class="Field">txGovProposals</a>
 <a id="1065" class="Keyword">where</a> <a id="1071" class="Keyword">open</a> <a id="1076" href="Ledger.Conway.Specification.Transaction.html#350" class="Module">TxBody</a> <a id="1083" href="Ledger.Conway.Specification.Script.Validation.html#600" class="Bound">txb</a>

<a id="indexedRdmrs"></a><a id="1088" href="Ledger.Conway.Specification.Script.Validation.html#1088" class="Function">indexedRdmrs</a> <a id="1101" class="Symbol">:</a> <a id="1103" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="1106" class="Symbol">→</a> <a id="1108" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#292" class="Datatype">ScriptPurpose</a> <a id="1122" class="Symbol">→</a> <a id="1124" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1130" class="Symbol">(</a><a id="1131" href="Ledger.Core.Specification.Script.Base.html#1786" class="Function">Redeemer</a> <a id="1140" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1142" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a><a id="1149" class="Symbol">)</a>
<a id="1151" href="Ledger.Conway.Specification.Script.Validation.html#1088" class="Function">indexedRdmrs</a> <a id="1164" href="Ledger.Conway.Specification.Script.Validation.html#1164" class="Bound">tx</a> <a id="1167" href="Ledger.Conway.Specification.Script.Validation.html#1167" class="Bound">sp</a> <a id="1170" class="Symbol">=</a> <a id="1172" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1178" class="Symbol">(λ</a> <a id="1181" href="Ledger.Conway.Specification.Script.Validation.html#1181" class="Bound">x</a> <a id="1183" class="Symbol">→</a> <a id="1185" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="1194" href="Ledger.Core.Specification.Transaction.html#3007" class="Function">txrdmrs</a> <a id="1202" href="Ledger.Conway.Specification.Script.Validation.html#1181" class="Bound">x</a><a id="1203" class="Symbol">)</a> <a id="1205" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1213" class="Symbol">(</a><a id="1214" href="Ledger.Conway.Specification.Script.Validation.html#547" class="Function">rdptr</a> <a id="1220" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a> <a id="1225" href="Ledger.Conway.Specification.Script.Validation.html#1167" class="Bound">sp</a><a id="1227" class="Symbol">)</a>
  <a id="1231" class="Keyword">where</a> <a id="1237" class="Keyword">open</a> <a id="1242" href="Ledger.Conway.Specification.Transaction.html#1719" class="Module">Tx</a> <a id="1245" href="Ledger.Conway.Specification.Script.Validation.html#1164" class="Bound">tx</a><a id="1247" class="Symbol">;</a> <a id="1249" class="Keyword">open</a> <a id="1254" href="Ledger.Core.Specification.Transaction.html#2887" class="Module">TxWitnesses</a> <a id="1266" href="Ledger.Conway.Specification.Transaction.html#1769" class="Function">wits</a>

<a id="getDatum"></a><a id="1272" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="Function">getDatum</a> <a id="1281" class="Symbol">:</a> <a id="1283" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="1286" class="Symbol">→</a> <a id="1288" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="1293" class="Symbol">→</a> <a id="1295" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#292" class="Datatype">ScriptPurpose</a> <a id="1309" class="Symbol">→</a> <a id="1311" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1317" href="Ledger.Core.Specification.Script.Base.html#1768" class="Function">Datum</a>
<a id="1323" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="Function">getDatum</a> <a id="1332" href="Ledger.Conway.Specification.Script.Validation.html#1332" class="Bound">tx</a> <a id="1335" href="Ledger.Conway.Specification.Script.Validation.html#1335" class="Bound">utxo</a> <a id="1340" class="Symbol">(</a><a id="1341" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#453" class="InductiveConstructor">Spend</a> <a id="1347" href="Ledger.Conway.Specification.Script.Validation.html#1347" class="Bound">txin</a><a id="1351" class="Symbol">)</a> <a id="1353" class="Symbol">=</a>
  <a id="1357" class="Keyword">do</a> <a id="1360" class="Symbol">(_</a> <a id="1363" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1365" class="Symbol">_</a> <a id="1367" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1369" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1374" href="Ledger.Conway.Specification.Script.Validation.html#1374" class="Bound">d</a> <a id="1376" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1378" class="Symbol">_)</a> <a id="1381" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1383" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="1392" href="Ledger.Conway.Specification.Script.Validation.html#1335" class="Bound">utxo</a> <a id="1397" href="Ledger.Conway.Specification.Script.Validation.html#1347" class="Bound">txin</a>
                          <a id="1428" class="Keyword">where</a>
                            <a id="1462" class="Symbol">(_</a> <a id="1465" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1467" class="Symbol">_</a> <a id="1469" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1471" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1479" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1481" class="Symbol">_)</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
     <a id="1499" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1504" href="Ledger.Conway.Specification.Script.Validation.html#1374" class="Bound">d</a> <a id="1506" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1509" class="Symbol">λ</a> <a id="1511" class="Keyword">where</a>
       <a id="1524" class="Symbol">(</a><a id="1525" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1530" href="Ledger.Conway.Specification.Script.Validation.html#1530" class="Bound">d</a><a id="1531" class="Symbol">)</a> <a id="1533" class="Symbol">→</a> <a id="1535" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1540" href="Ledger.Conway.Specification.Script.Validation.html#1530" class="Bound">d</a>
       <a id="1549" class="Symbol">(</a><a id="1550" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1555" href="Ledger.Conway.Specification.Script.Validation.html#1555" class="Bound">h</a><a id="1556" class="Symbol">)</a> <a id="1558" class="Symbol">→</a> <a id="1560" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="1569" href="Ledger.Conway.Specification.Script.Validation.html#1591" class="Function">m</a> <a id="1571" href="Ledger.Conway.Specification.Script.Validation.html#1555" class="Bound">h</a>
     <a id="1578" class="Keyword">where</a>
       <a id="1591" href="Ledger.Conway.Specification.Script.Validation.html#1591" class="Function">m</a> <a id="1593" class="Symbol">=</a> <a id="1595" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="1604" class="Symbol">(</a><a id="1605" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="1610" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1612" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="1617" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1619" href="Function.Base.html#704" class="Function">id</a> <a id="1622" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="1624" class="Symbol">(</a><a id="1625" href="Ledger.Core.Specification.Transaction.html#2982" class="Field">TxWitnesses.txdats</a> <a id="1644" class="Symbol">(</a><a id="1645" href="Ledger.Conway.Specification.Transaction.html#1769" class="Field">Tx.wits</a> <a id="1653" href="Ledger.Conway.Specification.Script.Validation.html#1332" class="Bound">tx</a><a id="1655" class="Symbol">)))</a>
<a id="1659" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="CatchallClause Function">getDatum</a><a id="1667" class="CatchallClause"> </a><a id="1668" href="Ledger.Conway.Specification.Script.Validation.html#1668" class="CatchallClause Bound">tx</a><a id="1670" class="CatchallClause"> </a><a id="1671" href="Ledger.Conway.Specification.Script.Validation.html#1671" class="CatchallClause Bound">utxo</a><a id="1675" class="CatchallClause"> </a><a id="1676" class="CatchallClause Symbol">_</a> <a id="1678" class="Symbol">=</a> <a id="1680" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="txInfo"></a><a id="1690" href="Ledger.Conway.Specification.Script.Validation.html#1690" class="Function">txInfo</a> <a id="1697" class="Symbol">:</a> <a id="1699" href="Ledger.Core.Specification.Script.Base.html#965" class="Function">Language</a> <a id="1708" class="Symbol">→</a> <a id="1710" href="Ledger.Conway.Specification.PParams.html#1687" class="Record">PParams</a>
                  <a id="1736" class="Symbol">→</a> <a id="1738" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a>
                  <a id="1761" class="Symbol">→</a> <a id="1763" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a>
                  <a id="1784" class="Symbol">→</a> <a id="1786" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#591" class="Record">TxInfo</a>
<a id="1793" href="Ledger.Conway.Specification.Script.Validation.html#1690" class="Function">txInfo</a> <a id="1800" href="Ledger.Conway.Specification.Script.Validation.html#1800" class="Bound">l</a> <a id="1802" href="Ledger.Conway.Specification.Script.Validation.html#1802" class="Bound">pp</a> <a id="1805" href="Ledger.Conway.Specification.Script.Validation.html#1805" class="Bound">utxo</a> <a id="1810" href="Ledger.Conway.Specification.Script.Validation.html#1810" class="Bound">tx</a> <a id="1813" class="Symbol">=</a> <a id="1815" class="Keyword">record</a>
  <a id="1824" class="Symbol">{</a> <a id="1826" href="Ledger.Conway.Specification.Script.Validation.html#1826" class="Module">TxBody</a> <a id="1833" href="Ledger.Conway.Specification.Transaction.html#1747" class="Field">body</a>
  <a id="1840" class="Symbol">;</a> <a id="1842" href="Ledger.Conway.Specification.Script.Validation.html#1842" class="Module">TxWitnesses</a> <a id="1854" href="Ledger.Conway.Specification.Transaction.html#1769" class="Field">wits</a>
  <a id="1861" class="Symbol">;</a> <a id="1863" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#619" class="Field">realizedInputs</a> <a id="1878" class="Symbol">=</a> <a id="1880" href="Ledger.Conway.Specification.Script.Validation.html#1805" class="Bound">utxo</a> <a id="1885" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="1887" href="Ledger.Conway.Specification.Transaction.html#382" class="Function">txIns</a>
  <a id="1895" class="Symbol">;</a> <a id="1897" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#685" class="Field">fee</a> <a id="1901" class="Symbol">=</a> <a id="1903" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a> <a id="1910" href="Ledger.Conway.Specification.Transaction.html#592" class="Function">txFee</a>
  <a id="1918" class="Symbol">;</a> <a id="1920" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#716" class="Field">mint</a> <a id="1925" class="Symbol">=</a> <a id="1927" href="Ledger.Conway.Specification.Transaction.html#958" class="Function">mint</a>
  <a id="1934" class="Symbol">;</a> <a id="1936" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#869" class="Field">vkKey</a> <a id="1942" class="Symbol">=</a> <a id="1944" href="Ledger.Conway.Specification.Transaction.html#991" class="Function">reqSignerHashes</a>
  <a id="1962" class="Symbol">}</a> <a id="1964" class="Keyword">where</a> <a id="1970" class="Keyword">open</a> <a id="1975" href="Ledger.Conway.Specification.Transaction.html#1719" class="Module">Tx</a> <a id="1978" href="Ledger.Conway.Specification.Script.Validation.html#1810" class="Bound">tx</a><a id="1980" class="Symbol">;</a> <a id="1982" class="Keyword">open</a> <a id="1987" href="Ledger.Conway.Specification.Transaction.html#350" class="Module">TxBody</a> <a id="1994" href="Ledger.Conway.Specification.Transaction.html#1747" class="Field">body</a>

<a id="credsNeeded"></a><a id="2000" href="Ledger.Conway.Specification.Script.Validation.html#2000" class="Function">credsNeeded</a> <a id="2012" class="Symbol">:</a> <a id="2014" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="2019" class="Symbol">→</a> <a id="2021" href="Ledger.Conway.Specification.Transaction.html#350" class="Record">TxBody</a> <a id="2028" class="Symbol">→</a> <a id="2030" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2032" class="Symbol">(</a><a id="2033" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#292" class="Datatype">ScriptPurpose</a> <a id="2047" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2049" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="2059" class="Symbol">)</a>
<a id="2061" href="Ledger.Conway.Specification.Script.Validation.html#2000" class="Function">credsNeeded</a> <a id="2073" href="Ledger.Conway.Specification.Script.Validation.html#2073" class="Bound">utxo</a> <a id="2078" href="Ledger.Conway.Specification.Script.Validation.html#2078" class="Bound">txb</a>
  <a id="2084" class="Symbol">=</a>  <a id="2087" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2092" class="Symbol">(λ</a> <a id="2095" class="Symbol">(</a><a id="2096" href="Ledger.Conway.Specification.Script.Validation.html#2096" class="Bound">i</a> <a id="2098" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2100" href="Ledger.Conway.Specification.Script.Validation.html#2100" class="Bound">o</a><a id="2101" class="Symbol">)</a>  <a id="2104" class="Symbol">→</a> <a id="2106" class="Symbol">(</a><a id="2107" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#453" class="InductiveConstructor">Spend</a>  <a id="2114" href="Ledger.Conway.Specification.Script.Validation.html#2096" class="Bound">i</a> <a id="2116" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2118" href="Ledger.Core.Specification.Address.html#2685" class="Function">payCred</a> <a id="2126" class="Symbol">(</a><a id="2127" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="2133" href="Ledger.Conway.Specification.Script.Validation.html#2100" class="Bound">o</a><a id="2134" class="Symbol">)))</a> <a id="2138" class="Symbol">((</a><a id="2140" href="Ledger.Conway.Specification.Script.Validation.html#2073" class="Bound">utxo</a> <a id="2145" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="2147" class="Symbol">(</a><a id="2148" href="Ledger.Conway.Specification.Transaction.html#382" class="Field">txIns</a> <a id="2154" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="2156" href="Ledger.Conway.Specification.Transaction.html#450" class="Field">collateralInputs</a><a id="2172" class="Symbol">))</a> <a id="2175" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="2176" class="Symbol">)</a>
  <a id="2180" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2183" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2188" class="Symbol">(λ</a> <a id="2191" href="Ledger.Conway.Specification.Script.Validation.html#2191" class="Bound">a</a>        <a id="2200" class="Symbol">→</a> <a id="2202" class="Symbol">(</a><a id="2203" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#365" class="InductiveConstructor">Rwrd</a>   <a id="2210" href="Ledger.Conway.Specification.Script.Validation.html#2191" class="Bound">a</a> <a id="2212" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2214" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a> <a id="2220" href="Ledger.Conway.Specification.Script.Validation.html#2191" class="Bound">a</a><a id="2221" class="Symbol">))</a> <a id="2224" class="Symbol">(</a><a id="2225" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2229" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2231" href="Ledger.Conway.Specification.Transaction.html#624" class="Field">txWithdrawals</a> <a id="2245" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a><a id="2246" class="Symbol">)</a>
  <a id="2250" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2253" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2264" class="Symbol">(λ</a> <a id="2267" href="Ledger.Conway.Specification.Script.Validation.html#2267" class="Bound">c</a>  <a id="2270" class="Symbol">→</a> <a id="2272" class="Symbol">(</a><a id="2273" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#321" class="InductiveConstructor">Cert</a>   <a id="2280" href="Ledger.Conway.Specification.Script.Validation.html#2267" class="Bound">c</a> <a id="2282" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="2284" class="Symbol">)</a> <a id="2286" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2290" href="Ledger.Core.Specification.Certs.html#2834" class="Function">cwitness</a> <a id="2299" href="Ledger.Conway.Specification.Script.Validation.html#2267" class="Bound">c</a><a id="2300" class="Symbol">)</a> <a id="2302" class="Symbol">(</a><a id="2303" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2312" href="Ledger.Conway.Specification.Transaction.html#554" class="Field">txCerts</a><a id="2319" class="Symbol">)</a>
  <a id="2323" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2326" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2331" class="Symbol">(λ</a> <a id="2334" href="Ledger.Conway.Specification.Script.Validation.html#2334" class="Bound">x</a>        <a id="2343" class="Symbol">→</a> <a id="2345" class="Symbol">(</a><a id="2346" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#409" class="InductiveConstructor">Mint</a>   <a id="2353" href="Ledger.Conway.Specification.Script.Validation.html#2334" class="Bound">x</a> <a id="2355" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2357" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2367" href="Ledger.Conway.Specification.Script.Validation.html#2334" class="Bound">x</a><a id="2368" class="Symbol">))</a> <a id="2371" class="Symbol">(</a><a id="2372" href="Ledger.Core.Specification.TokenAlgebra.Base.html#925" class="Function">policies</a> <a id="2381" href="Ledger.Conway.Specification.Transaction.html#958" class="Field">mint</a><a id="2385" class="Symbol">)</a>
  <a id="2389" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2392" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2403" class="Symbol">(λ</a> <a id="2406" href="Ledger.Conway.Specification.Script.Validation.html#2406" class="Bound">v</a> <a id="2408" class="Symbol">→</a> <a id="2410" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2413" href="Ledger.Core.Specification.Gov.Actions.html#6709" class="Function">isGovVoterCredential</a> <a id="2434" href="Ledger.Conway.Specification.Script.Validation.html#2406" class="Bound">v</a> <a id="2436" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2441" class="Symbol">(λ</a> <a id="2444" class="Symbol">{</a><a id="2445" href="Ledger.Conway.Specification.Script.Validation.html#2445" class="Bound">c</a><a id="2446" class="Symbol">}</a> <a id="2448" class="Symbol">→</a> <a id="2450" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2455" class="Symbol">(</a><a id="2456" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#497" class="InductiveConstructor">Vote</a> <a id="2461" href="Ledger.Conway.Specification.Script.Validation.html#2406" class="Bound">v</a> <a id="2463" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2465" href="Ledger.Conway.Specification.Script.Validation.html#2445" class="Bound">c</a><a id="2466" class="Symbol">))</a> <a id="2469" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2474" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2481" class="Symbol">)</a>
                <a id="2499" class="Symbol">(</a><a id="2500" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2509" class="Symbol">(</a><a id="2510" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2514" href="Ledger.Core.Specification.Gov.Actions.html#2353" class="Field">voter</a> <a id="2520" href="Ledger.Conway.Specification.Transaction.html#791" class="Field">txGovVotes</a><a id="2530" class="Symbol">))</a>
  <a id="2535" href="Axiom.Set.html#9137" class="Function Operator">∪</a>  <a id="2538" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="2549" class="Symbol">(λ</a> <a id="2552" href="Ledger.Conway.Specification.Script.Validation.html#2552" class="Bound">p</a> <a id="2554" class="Symbol">→</a> <a id="2556" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2559" href="Ledger.Conway.Specification.Script.Validation.html#2552" class="Bound">p</a> <a id="2561" class="Symbol">.</a><a id="2562" href="Ledger.Core.Specification.Gov.Actions.html#3708" class="Field">policy</a> <a id="2569" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2574" class="Symbol">(λ</a> <a id="2577" class="Symbol">{</a><a id="2578" href="Ledger.Conway.Specification.Script.Validation.html#2578" class="Bound">sh</a><a id="2580" class="Symbol">}</a> <a id="2582" class="Symbol">→</a> <a id="2584" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2589" class="Symbol">(</a><a id="2590" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#541" class="InductiveConstructor">Propose</a>  <a id="2599" href="Ledger.Conway.Specification.Script.Validation.html#2552" class="Bound">p</a> <a id="2601" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2603" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2613" href="Ledger.Conway.Specification.Script.Validation.html#2578" class="Bound">sh</a><a id="2615" class="Symbol">))</a> <a id="2618" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2623" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="2630" class="Symbol">)</a>
                <a id="2648" class="Symbol">(</a><a id="2649" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2658" href="Ledger.Conway.Specification.Transaction.html#831" class="Field">txGovProposals</a><a id="2672" class="Symbol">)</a>


  <a id="2678" class="Keyword">where</a> <a id="2684" class="Keyword">open</a> <a id="2689" href="Ledger.Conway.Specification.Transaction.html#350" class="Module">TxBody</a> <a id="2696" href="Ledger.Conway.Specification.Script.Validation.html#2078" class="Bound">txb</a><a id="2699" class="Symbol">;</a> <a id="2701" class="Keyword">open</a> <a id="2706" href="Ledger.Core.Specification.Gov.Actions.html#2290" class="Module">GovVote</a><a id="2713" class="Symbol">;</a> <a id="2715" class="Keyword">open</a> <a id="2720" href="Ledger.Core.Specification.Address.html#1313" class="Module">RewardAddress</a><a id="2733" class="Symbol">;</a> <a id="2735" class="Keyword">open</a> <a id="2740" href="Ledger.Core.Specification.Gov.Actions.html#3599" class="Module">GovProposal</a>

<a id="txOutToDataHash"></a><a id="2753" href="Ledger.Conway.Specification.Script.Validation.html#2753" class="Function">txOutToDataHash</a> <a id="2769" class="Symbol">:</a> <a id="2771" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="2777" class="Symbol">→</a> <a id="2779" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2785" href="Ledger.Core.Specification.Script.Base.html#1721" class="Function">DataHash</a>
<a id="2794" href="Ledger.Conway.Specification.Script.Validation.html#2753" class="Function">txOutToDataHash</a> <a id="2810" class="Symbol">(_</a> <a id="2813" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2815" class="Symbol">_</a> <a id="2817" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2819" href="Ledger.Conway.Specification.Script.Validation.html#2819" class="Bound">d</a> <a id="2821" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2823" class="Symbol">_)</a> <a id="2826" class="Symbol">=</a> <a id="2828" href="Ledger.Conway.Specification.Script.Validation.html#2819" class="Bound">d</a> <a id="2830" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="2834" href="Data.Sum.html#870" class="Function">isInj₂</a>

<a id="txOutToP2Script"></a><a id="2842" href="Ledger.Conway.Specification.Script.Validation.html#2842" class="Function">txOutToP2Script</a>
  <a id="2860" class="Symbol">:</a> <a id="2862" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="2867" class="Symbol">→</a> <a id="2869" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a>
  <a id="2874" class="Symbol">→</a> <a id="2876" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="2882" class="Symbol">→</a> <a id="2884" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2890" href="Ledger.Core.Specification.Script.Base.html#2365" class="Function">P2Script</a>
<a id="2899" href="Ledger.Conway.Specification.Script.Validation.html#2842" class="Function">txOutToP2Script</a> <a id="2915" href="Ledger.Conway.Specification.Script.Validation.html#2915" class="Bound">utxo</a> <a id="2920" href="Ledger.Conway.Specification.Script.Validation.html#2920" class="Bound">tx</a> <a id="2923" class="Symbol">(</a><a id="2924" href="Ledger.Conway.Specification.Script.Validation.html#2924" class="Bound">a</a> <a id="2926" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2928" class="Symbol">_)</a> <a id="2931" class="Symbol">=</a>
  <a id="2935" class="Keyword">do</a> <a id="2938" href="Ledger.Conway.Specification.Script.Validation.html#2938" class="Bound">sh</a> <a id="2941" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="2943" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="2955" class="Symbol">(</a><a id="2956" href="Ledger.Core.Specification.Address.html#2685" class="Function">payCred</a> <a id="2964" href="Ledger.Conway.Specification.Script.Validation.html#2924" class="Bound">a</a><a id="2965" class="Symbol">)</a>
     <a id="2972" href="Ledger.Conway.Specification.Script.Validation.html#2972" class="Bound">s</a>  <a id="2975" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="2977" href="Ledger.Conway.Specification.Transaction.html#2893" class="Function">lookupScriptHash</a> <a id="2994" href="Ledger.Conway.Specification.Script.Validation.html#2938" class="Bound">sh</a> <a id="2997" href="Ledger.Conway.Specification.Script.Validation.html#2920" class="Bound">tx</a> <a id="3000" href="Ledger.Conway.Specification.Script.Validation.html#2915" class="Bound">utxo</a>
     <a id="3010" href="Ledger.Core.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="3021" href="Ledger.Conway.Specification.Script.Validation.html#2972" class="Bound">s</a>

<a id="3024" class="Keyword">opaque</a>
  <a id="collectP2ScriptsWithContext"></a><a id="3033" href="Ledger.Conway.Specification.Script.Validation.html#3033" class="Function">collectP2ScriptsWithContext</a>
    <a id="3065" class="Symbol">:</a> <a id="3067" href="Ledger.Conway.Specification.PParams.html#1687" class="Record">PParams</a> <a id="3075" class="Symbol">→</a> <a id="3077" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="3080" class="Symbol">→</a> <a id="3082" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a>
    <a id="3091" class="Symbol">→</a> <a id="3093" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3098" class="Symbol">(</a><a id="3099" href="Ledger.Core.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="3108" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3110" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3115" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="3120" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3122" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="3130" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3132" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="3141" class="Symbol">)</a>
  <a id="3145" href="Ledger.Conway.Specification.Script.Validation.html#3033" class="Function">collectP2ScriptsWithContext</a> <a id="3173" href="Ledger.Conway.Specification.Script.Validation.html#3173" class="Bound">pp</a> <a id="3176" href="Ledger.Conway.Specification.Script.Validation.html#3176" class="Bound">tx</a> <a id="3179" href="Ledger.Conway.Specification.Script.Validation.html#3179" class="Bound">utxo</a>
    <a id="3188" class="Symbol">=</a> <a id="3190" href="abstract-set-theory.FiniteSetTheory.html#2617" class="Function">setToList</a>
    <a id="3204" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3206" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3217" class="Symbol">(λ</a> <a id="3220" class="Symbol">(</a><a id="3221" href="Ledger.Conway.Specification.Script.Validation.html#3221" class="Bound">sp</a> <a id="3224" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3226" href="Ledger.Conway.Specification.Script.Validation.html#3226" class="Bound">c</a><a id="3227" class="Symbol">)</a> <a id="3229" class="Symbol">→</a> <a id="3231" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="3234" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="3246" href="Ledger.Conway.Specification.Script.Validation.html#3226" class="Bound">c</a>
                                <a id="3280" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="3285" class="Symbol">(λ</a> <a id="3288" class="Symbol">{</a><a id="3289" href="Ledger.Conway.Specification.Script.Validation.html#3289" class="Bound">sh</a><a id="3291" class="Symbol">}</a> <a id="3293" class="Symbol">→</a> <a id="3295" href="Ledger.Conway.Specification.Script.Validation.html#3415" class="Function">toScriptInput</a> <a id="3309" href="Ledger.Conway.Specification.Script.Validation.html#3221" class="Bound">sp</a> <a id="3312" href="Ledger.Conway.Specification.Script.Validation.html#3289" class="Bound">sh</a><a id="3314" class="Symbol">)</a>
                                <a id="3348" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="3353" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3360" class="Symbol">)</a>
    <a id="3366" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3368" href="Ledger.Conway.Specification.Script.Validation.html#2000" class="Function">credsNeeded</a> <a id="3380" href="Ledger.Conway.Specification.Script.Validation.html#3179" class="Bound">utxo</a> <a id="3385" class="Symbol">(</a><a id="3386" href="Ledger.Conway.Specification.Script.Validation.html#3176" class="Bound">tx</a> <a id="3389" class="Symbol">.</a><a id="3390" href="Ledger.Conway.Specification.Transaction.html#1747" class="Field">Tx.body</a><a id="3397" class="Symbol">)</a>
    <a id="3403" class="Keyword">where</a>
      <a id="3415" href="Ledger.Conway.Specification.Script.Validation.html#3415" class="Function">toScriptInput</a>
        <a id="3437" class="Symbol">:</a> <a id="3439" href="Ledger.Conway.Specification.Script.ScriptPurpose.html#292" class="Datatype">ScriptPurpose</a> <a id="3453" class="Symbol">→</a> <a id="3455" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
        <a id="3474" class="Symbol">→</a> <a id="3476" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3482" class="Symbol">(</a><a id="3483" href="Ledger.Core.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="3492" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3494" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3499" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="3504" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3506" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="3514" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3516" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="3525" class="Symbol">)</a>
      <a id="3533" href="Ledger.Conway.Specification.Script.Validation.html#3415" class="Function">toScriptInput</a> <a id="3547" href="Ledger.Conway.Specification.Script.Validation.html#3547" class="Bound">sp</a> <a id="3550" href="Ledger.Conway.Specification.Script.Validation.html#3550" class="Bound">sh</a> <a id="3553" class="Symbol">=</a>
        <a id="3563" class="Keyword">do</a> <a id="3566" href="Ledger.Conway.Specification.Script.Validation.html#3566" class="Bound">s</a> <a id="3568" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3570" href="Ledger.Conway.Specification.Transaction.html#2893" class="Function">lookupScriptHash</a> <a id="3587" href="Ledger.Conway.Specification.Script.Validation.html#3550" class="Bound">sh</a> <a id="3590" href="Ledger.Conway.Specification.Script.Validation.html#3176" class="Bound">tx</a> <a id="3593" href="Ledger.Conway.Specification.Script.Validation.html#3179" class="Bound">utxo</a>
           <a id="3609" href="Ledger.Conway.Specification.Script.Validation.html#3609" class="Bound">p2s</a> <a id="3613" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3615" href="Ledger.Core.Specification.Script.Base.html#3218" class="Function">toP2Script</a> <a id="3626" href="Ledger.Conway.Specification.Script.Validation.html#3566" class="Bound">s</a>
           <a id="3639" class="Symbol">(</a><a id="3640" href="Ledger.Conway.Specification.Script.Validation.html#3640" class="Bound">rdmr</a> <a id="3645" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3647" href="Ledger.Conway.Specification.Script.Validation.html#3647" class="Bound">exunits</a><a id="3654" class="Symbol">)</a> <a id="3656" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3658" href="Ledger.Conway.Specification.Script.Validation.html#1088" class="Function">indexedRdmrs</a> <a id="3671" href="Ledger.Conway.Specification.Script.Validation.html#3176" class="Bound">tx</a> <a id="3674" href="Ledger.Conway.Specification.Script.Validation.html#3547" class="Bound">sp</a>
           <a id="3688" class="Keyword">let</a> <a id="3692" href="Ledger.Conway.Specification.Script.Validation.html#3692" class="Bound">data&#39;</a>     <a id="3702" class="Symbol">=</a> <a id="3704" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="3710" href="Data.List.Base.html#4907" class="Function Operator">[_]</a> <a id="3714" class="InductiveConstructor">[]</a> <a id="3717" class="Symbol">(</a><a id="3718" href="Ledger.Conway.Specification.Script.Validation.html#1272" class="Function">getDatum</a> <a id="3727" href="Ledger.Conway.Specification.Script.Validation.html#3176" class="Bound">tx</a> <a id="3730" href="Ledger.Conway.Specification.Script.Validation.html#3179" class="Bound">utxo</a> <a id="3735" href="Ledger.Conway.Specification.Script.Validation.html#3547" class="Bound">sp</a><a id="3737" class="Symbol">)</a> <a id="3739" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="3742" href="Ledger.Conway.Specification.Script.Validation.html#3640" class="Bound">rdmr</a> <a id="3747" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3749" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="3751" href="Ledger.Core.Specification.Abstract.html#1096" class="Field">valContext</a> <a id="3762" class="Symbol">(</a><a id="3763" href="Ledger.Conway.Specification.Script.Validation.html#1690" class="Function">txInfo</a> <a id="3770" class="Symbol">(</a><a id="3771" href="Ledger.Core.Specification.Script.Base.html#1962" class="Function">language</a> <a id="3780" href="Ledger.Conway.Specification.Script.Validation.html#3609" class="Bound">p2s</a><a id="3783" class="Symbol">)</a> <a id="3785" href="Ledger.Conway.Specification.Script.Validation.html#3173" class="Bound">pp</a> <a id="3788" href="Ledger.Conway.Specification.Script.Validation.html#3179" class="Bound">utxo</a> <a id="3793" href="Ledger.Conway.Specification.Script.Validation.html#3176" class="Bound">tx</a><a id="3795" class="Symbol">)</a> <a id="3797" href="Ledger.Conway.Specification.Script.Validation.html#3547" class="Bound">sp</a> <a id="3800" href="Data.List.Base.html#4907" class="Function Operator">]</a>
               <a id="3817" href="Ledger.Conway.Specification.Script.Validation.html#3817" class="Bound">costModel</a> <a id="3827" class="Symbol">=</a> <a id="3829" href="Ledger.Conway.Specification.PParams.html#3066" class="Field">PParams.costmdls</a> <a id="3846" href="Ledger.Conway.Specification.Script.Validation.html#3173" class="Bound">pp</a>
           <a id="3860" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3865" class="Symbol">(</a><a id="3866" href="Ledger.Conway.Specification.Script.Validation.html#3609" class="Bound">p2s</a> <a id="3870" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3872" href="Ledger.Conway.Specification.Script.Validation.html#3692" class="Bound">data&#39;</a> <a id="3878" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3880" href="Ledger.Conway.Specification.Script.Validation.html#3647" class="Bound">exunits</a> <a id="3888" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3890" href="Ledger.Conway.Specification.Script.Validation.html#3817" class="Bound">costModel</a><a id="3899" class="Symbol">)</a>

<a id="evalP2Scripts"></a><a id="3902" href="Ledger.Conway.Specification.Script.Validation.html#3902" class="Function">evalP2Scripts</a> <a id="3916" class="Symbol">:</a> <a id="3918" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3923" class="Symbol">(</a><a id="3924" href="Ledger.Core.Specification.Script.Base.html#2365" class="Function">P2Script</a> <a id="3933" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3935" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3940" href="Ledger.Core.Specification.Script.Base.html#1706" class="Function">Data</a> <a id="3945" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3947" href="Ledger.Core.Specification.Script.Base.html#1016" class="Function">ExUnits</a> <a id="3955" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3957" href="Ledger.Core.Specification.Script.Base.html#987" class="Function">CostModel</a><a id="3966" class="Symbol">)</a> <a id="3968" class="Symbol">→</a> <a id="3970" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="3975" href="Ledger.Conway.Specification.Script.Validation.html#3902" class="Function">evalP2Scripts</a> <a id="3989" class="Symbol">=</a> <a id="3991" href="Data.Bool.ListAction.html#927" class="Function">all</a> <a id="3995" class="Symbol">(λ</a> <a id="3998" class="Symbol">(</a><a id="3999" href="Ledger.Conway.Specification.Script.Validation.html#3999" class="Bound">s</a> <a id="4001" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4003" href="Ledger.Conway.Specification.Script.Validation.html#4003" class="Bound">d</a> <a id="4005" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4007" href="Ledger.Conway.Specification.Script.Validation.html#4007" class="Bound">eu</a> <a id="4010" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4012" href="Ledger.Conway.Specification.Script.Validation.html#4012" class="Bound">cm</a><a id="4014" class="Symbol">)</a> <a id="4016" class="Symbol">→</a> <a id="4018" href="Ledger.Core.Specification.Abstract.html#989" class="Field">runPLCScript</a> <a id="4031" href="Ledger.Conway.Specification.Script.Validation.html#4012" class="Bound">cm</a> <a id="4034" href="Ledger.Conway.Specification.Script.Validation.html#3999" class="Bound">s</a> <a id="4036" href="Ledger.Conway.Specification.Script.Validation.html#4007" class="Bound">eu</a> <a id="4039" href="Ledger.Conway.Specification.Script.Validation.html#4003" class="Bound">d</a><a id="4040" class="Symbol">)</a>

</pre></body></html>