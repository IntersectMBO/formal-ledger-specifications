<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Conformance.Properties</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Ledger.Abstract.html" class="Module">Ledger.Abstract</a>
<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a>

<a id="112" class="Keyword">module</a> <a id="119" href="Ledger.Conway.Conformance.Properties.html" class="Module">Ledger.Conway.Conformance.Properties</a>
  <a id="158" class="Symbol">(</a><a id="159" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a> <a id="163" class="Symbol">:</a> <a id="165" class="Symbol">_)</a> <a id="168" class="Symbol">(</a><a id="169" class="Keyword">open</a> <a id="174" href="Ledger.Transaction.html#840" class="Module">TransactionStructure</a> <a id="195" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a><a id="198" class="Symbol">)</a>
  <a id="202" class="Symbol">(</a><a id="203" href="Ledger.Conway.Conformance.Properties.html#203" class="Bound">abs</a> <a id="207" class="Symbol">:</a> <a id="209" href="Ledger.Abstract.html#578" class="Record">AbstractFunctions</a> <a id="227" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a><a id="230" class="Symbol">)</a> <a id="232" class="Symbol">(</a><a id="233" class="Keyword">open</a> <a id="238" href="Ledger.Abstract.html#578" class="Module">AbstractFunctions</a> <a id="256" href="Ledger.Conway.Conformance.Properties.html#203" class="Bound">abs</a><a id="259" class="Symbol">)</a>
  <a id="263" class="Keyword">where</a>

<a id="270" class="Keyword">open</a> <a id="275" class="Keyword">import</a> <a id="282" href="Ledger.Conway.Conformance.Chain.html" class="Module">Ledger.Conway.Conformance.Chain</a> <a id="314" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a> <a id="318" href="Ledger.Conway.Conformance.Properties.html#203" class="Bound">abs</a>
<a id="322" class="Keyword">open</a> <a id="327" class="Keyword">import</a> <a id="334" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="365" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a> <a id="369" href="Ledger.Conway.Conformance.Properties.html#203" class="Bound">abs</a>
<a id="373" class="Keyword">open</a> <a id="378" class="Keyword">import</a> <a id="385" href="Ledger.Conway.Conformance.Epoch.html" class="Module">Ledger.Conway.Conformance.Epoch</a> <a id="417" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a> <a id="421" href="Ledger.Conway.Conformance.Properties.html#203" class="Bound">abs</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Ledger.Conway.Conformance.Ledger.html" class="Module">Ledger.Conway.Conformance.Ledger</a> <a id="470" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a> <a id="474" href="Ledger.Conway.Conformance.Properties.html#203" class="Bound">abs</a>
<a id="478" class="Keyword">open</a> <a id="483" class="Keyword">import</a> <a id="490" href="Ledger.Enact.html" class="Module">Ledger.Enact</a> <a id="503" href="Ledger.Transaction.html#1782" class="Function">govStructure</a>
<a id="516" class="Keyword">open</a> <a id="521" class="Keyword">import</a> <a id="528" href="Ledger.Gov.html" class="Module">Ledger.Gov</a> <a id="539" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a>
<a id="543" class="Keyword">open</a> <a id="548" class="Keyword">import</a> <a id="555" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="587" href="Ledger.Transaction.html#1782" class="Function">govStructure</a>

<a id="isCredDeposit"></a><a id="601" href="Ledger.Conway.Conformance.Properties.html#601" class="Function">isCredDeposit</a> <a id="615" class="Symbol">:</a> <a id="617" href="Ledger.Certs.html#332" class="Datatype">DepositPurpose</a> <a id="632" class="Symbol">→</a> <a id="634" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="639" href="Ledger.Conway.Conformance.Properties.html#601" class="Function">isCredDeposit</a> <a id="653" class="Symbol">(</a><a id="654" href="Ledger.Certs.html#362" class="InductiveConstructor">CredentialDeposit</a> <a id="672" href="Ledger.Conway.Conformance.Properties.html#672" class="Bound">x</a><a id="673" class="Symbol">)</a> <a id="675" class="Symbol">=</a> <a id="677" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="679" href="Ledger.Conway.Conformance.Properties.html#601" class="CatchallClause Function">isCredDeposit</a><a id="692" class="CatchallClause"> </a><a id="693" class="CatchallClause Symbol">_</a> <a id="695" class="Symbol">=</a> <a id="697" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="700" class="Keyword">instance</a>
  <a id="isCredDeposit?"></a><a id="711" href="Ledger.Conway.Conformance.Properties.html#711" class="Function">isCredDeposit?</a> <a id="726" class="Symbol">:</a> <a id="728" href="Ledger.Conway.Conformance.Properties.html#601" class="Function">isCredDeposit</a> <a id="742" href="Class.Decidable.Core.html#762" class="Function Operator">⁇¹</a>
  <a id="747" href="Ledger.Conway.Conformance.Properties.html#711" class="Function">isCredDeposit?</a> <a id="762" class="Symbol">{</a><a id="763" href="Ledger.Certs.html#362" class="InductiveConstructor">CredentialDeposit</a> <a id="781" href="Ledger.Conway.Conformance.Properties.html#781" class="Bound">x</a><a id="782" class="Symbol">}</a> <a id="784" class="Symbol">=</a> <a id="786" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="788" class="Symbol">(</a><a id="789" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="793" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="795" class="Symbol">)</a>
  <a id="799" href="Ledger.Conway.Conformance.Properties.html#711" class="Function">isCredDeposit?</a> <a id="814" class="Symbol">{</a><a id="815" href="Ledger.Certs.html#415" class="InductiveConstructor">PoolDeposit</a> <a id="827" href="Ledger.Conway.Conformance.Properties.html#827" class="Bound">x</a><a id="828" class="Symbol">}</a> <a id="830" class="Symbol">=</a> <a id="832" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="834" class="Symbol">(</a><a id="835" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="838" class="Symbol">λ</a> <a id="840" class="Symbol">())</a>
  <a id="846" href="Ledger.Conway.Conformance.Properties.html#711" class="Function">isCredDeposit?</a> <a id="861" class="Symbol">{</a><a id="862" href="Ledger.Certs.html#468" class="InductiveConstructor">DRepDeposit</a> <a id="874" href="Ledger.Conway.Conformance.Properties.html#874" class="Bound">x</a><a id="875" class="Symbol">}</a> <a id="877" class="Symbol">=</a> <a id="879" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="881" class="Symbol">(</a><a id="882" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="885" class="Symbol">λ</a> <a id="887" class="Symbol">())</a>
  <a id="893" href="Ledger.Conway.Conformance.Properties.html#711" class="Function">isCredDeposit?</a> <a id="908" class="Symbol">{</a><a id="909" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="926" href="Ledger.Conway.Conformance.Properties.html#926" class="Bound">x</a><a id="927" class="Symbol">}</a> <a id="929" class="Symbol">=</a> <a id="931" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="933" class="Symbol">(</a><a id="934" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="937" class="Symbol">λ</a> <a id="939" class="Symbol">())</a>

<a id="isGADeposit"></a><a id="944" href="Ledger.Conway.Conformance.Properties.html#944" class="Function">isGADeposit</a> <a id="956" class="Symbol">:</a> <a id="958" href="Ledger.Certs.html#332" class="Datatype">DepositPurpose</a> <a id="973" class="Symbol">→</a> <a id="975" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="980" href="Ledger.Conway.Conformance.Properties.html#944" class="Function">isGADeposit</a> <a id="992" class="Symbol">(</a><a id="993" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="1010" href="Ledger.Conway.Conformance.Properties.html#1010" class="Bound">x</a><a id="1011" class="Symbol">)</a> <a id="1013" class="Symbol">=</a> <a id="1015" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1017" href="Ledger.Conway.Conformance.Properties.html#944" class="CatchallClause Function">isGADeposit</a><a id="1028" class="CatchallClause"> </a><a id="1029" class="CatchallClause Symbol">_</a> <a id="1031" class="Symbol">=</a> <a id="1033" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="1036" class="Keyword">instance</a>
  <a id="isGADeposit?"></a><a id="1047" href="Ledger.Conway.Conformance.Properties.html#1047" class="Function">isGADeposit?</a> <a id="1060" class="Symbol">:</a> <a id="1062" href="Ledger.Conway.Conformance.Properties.html#944" class="Function">isGADeposit</a> <a id="1074" href="Class.Decidable.Core.html#762" class="Function Operator">⁇¹</a>
  <a id="1079" href="Ledger.Conway.Conformance.Properties.html#1047" class="Function">isGADeposit?</a> <a id="1092" class="Symbol">{</a><a id="1093" href="Ledger.Certs.html#362" class="InductiveConstructor">CredentialDeposit</a> <a id="1111" href="Ledger.Conway.Conformance.Properties.html#1111" class="Bound">x</a><a id="1112" class="Symbol">}</a> <a id="1114" class="Symbol">=</a> <a id="1116" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1118" class="Symbol">(</a><a id="1119" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1122" class="Symbol">λ</a> <a id="1124" class="Symbol">())</a>
  <a id="1130" href="Ledger.Conway.Conformance.Properties.html#1047" class="Function">isGADeposit?</a> <a id="1143" class="Symbol">{</a><a id="1144" href="Ledger.Certs.html#415" class="InductiveConstructor">PoolDeposit</a> <a id="1156" href="Ledger.Conway.Conformance.Properties.html#1156" class="Bound">x</a><a id="1157" class="Symbol">}</a> <a id="1159" class="Symbol">=</a> <a id="1161" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1163" class="Symbol">(</a><a id="1164" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1167" class="Symbol">λ</a> <a id="1169" class="Symbol">())</a>
  <a id="1175" href="Ledger.Conway.Conformance.Properties.html#1047" class="Function">isGADeposit?</a> <a id="1188" class="Symbol">{</a><a id="1189" href="Ledger.Certs.html#468" class="InductiveConstructor">DRepDeposit</a> <a id="1201" href="Ledger.Conway.Conformance.Properties.html#1201" class="Bound">x</a><a id="1202" class="Symbol">}</a> <a id="1204" class="Symbol">=</a> <a id="1206" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1208" class="Symbol">(</a><a id="1209" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1212" class="Symbol">λ</a> <a id="1214" class="Symbol">())</a>
  <a id="1220" href="Ledger.Conway.Conformance.Properties.html#1047" class="Function">isGADeposit?</a> <a id="1233" class="Symbol">{</a><a id="1234" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="1251" href="Ledger.Conway.Conformance.Properties.html#1251" class="Bound">x</a><a id="1252" class="Symbol">}</a> <a id="1254" class="Symbol">=</a> <a id="1256" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1258" class="Symbol">(</a><a id="1259" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="1263" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="1265" class="Symbol">)</a>

<a id="getLState"></a><a id="1268" href="Ledger.Conway.Conformance.Properties.html#1268" class="Function">getLState</a> <a id="1278" class="Symbol">:</a> <a id="1280" href="Ledger.Conway.Conformance.Epoch.html#1258" class="Record">NewEpochState</a> <a id="1294" class="Symbol">→</a> <a id="1296" href="Ledger.Conway.Conformance.Ledger.html#695" class="Record">LState</a>
<a id="1303" href="Ledger.Conway.Conformance.Properties.html#1268" class="Function">getLState</a> <a id="1313" class="Symbol">=</a> <a id="1315" href="Ledger.Conway.Conformance.Epoch.html#1173" class="Field">EpochState.ls</a> <a id="1329" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1331" href="Ledger.Conway.Conformance.Epoch.html#1321" class="Field">NewEpochState.epochState</a>

<a id="getRewards"></a><a id="1357" href="Ledger.Conway.Conformance.Properties.html#1357" class="Function">getRewards</a> <a id="1368" class="Symbol">:</a> <a id="1370" href="Ledger.Conway.Conformance.Epoch.html#1258" class="Record">NewEpochState</a> <a id="1384" class="Symbol">→</a> <a id="1386" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="1397" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1399" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="1404" href="Ledger.Conway.Conformance.Properties.html#1357" class="Function">getRewards</a> <a id="1415" class="Symbol">=</a> <a id="1417" href="Ledger.Conway.Conformance.Certs.html#697" class="Field">DState.rewards</a> <a id="1432" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1434" href="Ledger.Conway.Conformance.Certs.html#993" class="Field">CertState.dState</a> <a id="1451" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1453" href="Ledger.Conway.Conformance.Ledger.html#803" class="Field">LState.certState</a> <a id="1470" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1472" href="Ledger.Conway.Conformance.Properties.html#1268" class="Function">getLState</a>

<a id="allDReps"></a><a id="1483" href="Ledger.Conway.Conformance.Properties.html#1483" class="Function">allDReps</a> <a id="1492" class="Symbol">:</a> <a id="1494" href="Ledger.Conway.Conformance.Epoch.html#1258" class="Record">NewEpochState</a> <a id="1508" class="Symbol">→</a> <a id="1510" href="Ledger.Certs.html#637" class="Function">DReps</a>
<a id="1516" href="Ledger.Conway.Conformance.Properties.html#1483" class="Function">allDReps</a> <a id="1525" class="Symbol">=</a> <a id="1527" href="Ledger.Conway.Conformance.Certs.html#821" class="Field">GState.dreps</a> <a id="1540" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1542" href="Ledger.Conway.Conformance.Certs.html#1033" class="Field">CertState.gState</a> <a id="1559" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1561" href="Ledger.Conway.Conformance.Ledger.html#803" class="Field">LState.certState</a> <a id="1578" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1580" href="Ledger.Conway.Conformance.Properties.html#1268" class="Function">getLState</a>

<a id="activeDReps"></a><a id="1591" href="Ledger.Conway.Conformance.Properties.html#1591" class="Function">activeDReps</a> <a id="1603" class="Symbol">:</a> <a id="1605" href="Ledger.Types.Epoch.html#543" class="Function">Epoch</a> <a id="1611" class="Symbol">→</a> <a id="1613" href="Ledger.Conway.Conformance.Epoch.html#1258" class="Record">NewEpochState</a> <a id="1627" class="Symbol">→</a> <a id="1629" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="1631" href="Ledger.Address.html#273" class="Datatype">Credential</a>
<a id="1642" href="Ledger.Conway.Conformance.Properties.html#1591" class="Function">activeDReps</a> <a id="1654" href="Ledger.Conway.Conformance.Properties.html#1654" class="Bound">currentEpoch</a> <a id="1667" href="Ledger.Conway.Conformance.Properties.html#1667" class="Bound">s</a> <a id="1669" class="Symbol">=</a> <a id="1671" href="Class.IsSet.html#916" class="Function">dom</a> <a id="1675" class="Symbol">(</a><a id="1676" href="abstract-set-theory.FiniteSetTheory.html#2895" class="Function">filterᵐ</a> <a id="1684" class="Symbol">(λ</a> <a id="1687" class="Symbol">(_</a> <a id="1690" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1692" href="Ledger.Conway.Conformance.Properties.html#1692" class="Bound">e</a><a id="1693" class="Symbol">)</a> <a id="1695" class="Symbol">→</a> <a id="1697" href="Ledger.Conway.Conformance.Properties.html#1654" class="Bound">currentEpoch</a> <a id="1710" href="Class.HasOrder.Core.html#608" class="Field Operator">≤</a> <a id="1712" href="Ledger.Conway.Conformance.Properties.html#1692" class="Bound">e</a><a id="1713" class="Symbol">)</a> <a id="1715" class="Symbol">(</a><a id="1716" href="Ledger.Conway.Conformance.Properties.html#1483" class="Function">allDReps</a> <a id="1725" href="Ledger.Conway.Conformance.Properties.html#1667" class="Bound">s</a><a id="1726" class="Symbol">))</a>

<a id="getGovState"></a><a id="1730" href="Ledger.Conway.Conformance.Properties.html#1730" class="Function">getGovState</a> <a id="1742" class="Symbol">:</a> <a id="1744" href="Ledger.Conway.Conformance.Epoch.html#1258" class="Record">NewEpochState</a> <a id="1758" class="Symbol">→</a> <a id="1760" href="Ledger.Gov.html#1348" class="Function">GovState</a>
<a id="1769" href="Ledger.Conway.Conformance.Properties.html#1730" class="Function">getGovState</a> <a id="1781" class="Symbol">=</a> <a id="1783" href="Ledger.Conway.Conformance.Ledger.html#777" class="Field">LState.govSt</a> <a id="1796" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1798" href="Ledger.Conway.Conformance.Properties.html#1268" class="Function">getLState</a>

<a id="1809" class="Keyword">instance</a>
  <a id="1820" href="Ledger.Conway.Conformance.Properties.html#1820" class="Function">_</a> <a id="1822" class="Symbol">:</a> <a id="1824" href="Class.IsSet.html#375" class="Record">IsSet</a> <a id="1830" href="Ledger.Conway.Conformance.Chain.html#722" class="Record">Block</a> <a id="1836" href="Ledger.Transaction.html#4194" class="Record">Tx</a>
  <a id="1841" class="Symbol">_</a> <a id="1843" class="Symbol">=</a> <a id="1845" class="Keyword">record</a> <a id="1852" class="Symbol">{</a> <a id="1854" href="Class.IsSet.html#419" class="Field">toSet</a> <a id="1860" class="Symbol">=</a> <a id="1862" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1871" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1873" href="Ledger.Conway.Conformance.Chain.html#755" class="Field">Block.ts</a> <a id="1882" class="Symbol">}</a>

  <a id="1887" href="Ledger.Conway.Conformance.Properties.html#1887" class="Function">_</a> <a id="1889" class="Symbol">:</a> <a id="1891" href="Class.IsSet.html#375" class="Record">IsSet</a> <a id="1897" href="Ledger.Transaction.html#2650" class="Record">TxBody</a> <a id="1904" href="Ledger.GovernanceActions.html#2524" class="Record">GovProposal</a>
  <a id="1918" class="Symbol">_</a> <a id="1920" class="Symbol">=</a> <a id="1922" class="Keyword">record</a> <a id="1929" class="Symbol">{</a> <a id="1931" href="Class.IsSet.html#419" class="Field">toSet</a> <a id="1937" class="Symbol">=</a> <a id="1939" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1948" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1950" href="Ledger.Transaction.html#2982" class="Field">TxBody.txprop</a> <a id="1964" class="Symbol">}</a>

<a id="validBlockIn"></a><a id="1967" href="Ledger.Conway.Conformance.Properties.html#1967" class="Function">validBlockIn</a> <a id="1980" class="Symbol">:</a> <a id="1982" href="Ledger.Conway.Conformance.Chain.html#645" class="Record">ChainState</a> <a id="1993" class="Symbol">→</a> <a id="1995" href="Ledger.Conway.Conformance.Chain.html#722" class="Record">Block</a> <a id="2001" class="Symbol">→</a> <a id="2003" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="2008" href="Ledger.Conway.Conformance.Properties.html#1967" class="Function">validBlockIn</a> <a id="2021" href="Ledger.Conway.Conformance.Properties.html#2021" class="Bound">s</a> <a id="2023" href="Ledger.Conway.Conformance.Properties.html#2023" class="Bound">b</a> <a id="2025" class="Symbol">=</a> <a id="2027" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2030" href="Ledger.Conway.Conformance.Properties.html#2030" class="Bound">s&#39;</a> <a id="2033" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2035" class="Symbol">_</a> <a id="2037" href="Ledger.Conway.Conformance.Chain.html#2596" class="Datatype Operator">⊢</a> <a id="2039" href="Ledger.Conway.Conformance.Properties.html#2021" class="Bound">s</a> <a id="2041" href="Ledger.Conway.Conformance.Chain.html#2596" class="Datatype Operator">⇀⦇</a> <a id="2044" href="Ledger.Conway.Conformance.Properties.html#2023" class="Bound">b</a> <a id="2046" href="Ledger.Conway.Conformance.Chain.html#2596" class="Datatype Operator">,CHAIN⦈</a> <a id="2054" href="Ledger.Conway.Conformance.Properties.html#2030" class="Bound">s&#39;</a>

<a id="validBlock"></a><a id="2058" href="Ledger.Conway.Conformance.Properties.html#2058" class="Function">validBlock</a> <a id="2069" class="Symbol">:</a> <a id="2071" href="Ledger.Conway.Conformance.Chain.html#722" class="Record">Block</a> <a id="2077" class="Symbol">→</a> <a id="2079" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="2084" href="Ledger.Conway.Conformance.Properties.html#2058" class="Function">validBlock</a> <a id="2095" href="Ledger.Conway.Conformance.Properties.html#2095" class="Bound">b</a> <a id="2097" class="Symbol">=</a> <a id="2099" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2102" href="Ledger.Conway.Conformance.Properties.html#2102" class="Bound">s</a> <a id="2104" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2106" href="Ledger.Conway.Conformance.Properties.html#1967" class="Function">validBlockIn</a> <a id="2119" href="Ledger.Conway.Conformance.Properties.html#2102" class="Bound">s</a> <a id="2121" href="Ledger.Conway.Conformance.Properties.html#2095" class="Bound">b</a>

<a id="2124" class="Comment">-- Transaction validity is complicated. In the truest sense, a</a>
<a id="2187" class="Comment">-- transaction is valid if it is part of a valid block,</a>
<a id="2243" class="Comment">-- i.e. `validTxIn₁`. However, a transaction can also be seen as valid</a>
<a id="2314" class="Comment">-- if it could be applied at a certain slot (with no knowledge of an</a>
<a id="2383" class="Comment">-- actual block). This is closer to how the mempool sees transaction</a>
<a id="2452" class="Comment">-- validity and is expressed by `validTxIn₂`.</a>

<a id="2499" class="Comment">-- Note that these two are not equivalent and in fact there is no</a>
<a id="2565" class="Comment">-- implication between the two in either direction. `2 =&gt; 1` would</a>
<a id="2632" class="Comment">-- require one to come up with a block, which we can&#39;t, but `1 =&gt; 2`</a>
<a id="2701" class="Comment">-- is also not true, since the transaction might depend on a previous</a>
<a id="2771" class="Comment">-- transaction in the same block. Maybe this means that `validTxIn₂`</a>
<a id="2840" class="Comment">-- should be changed so that it allows for applying a list of</a>
<a id="2902" class="Comment">-- transactions before the final transaction? However, the downside</a>
<a id="2970" class="Comment">-- then becomes that the transaction isn&#39;t applied to the given state</a>
<a id="3040" class="Comment">-- but to some intermediate one. Maybe we&#39;ll gain some insight on this</a>
<a id="3111" class="Comment">-- matter once we have proven more theorems.</a>

<a id="validTxIn₁"></a><a id="3157" href="Ledger.Conway.Conformance.Properties.html#3157" class="Function">validTxIn₁</a> <a id="3168" class="Symbol">:</a> <a id="3170" href="Ledger.Conway.Conformance.Chain.html#645" class="Record">ChainState</a> <a id="3181" class="Symbol">→</a> <a id="3183" href="Ledger.Transaction.html#4194" class="Record">Tx</a> <a id="3186" class="Symbol">→</a> <a id="3188" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3193" href="Ledger.Conway.Conformance.Properties.html#3157" class="Function">validTxIn₁</a> <a id="3204" href="Ledger.Conway.Conformance.Properties.html#3204" class="Bound">s</a> <a id="3206" href="Ledger.Conway.Conformance.Properties.html#3206" class="Bound">tx</a> <a id="3209" class="Symbol">=</a> <a id="3211" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3214" href="Ledger.Conway.Conformance.Properties.html#3214" class="Bound">b</a> <a id="3216" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3218" href="Ledger.Conway.Conformance.Properties.html#3206" class="Bound">tx</a> <a id="3221" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="3223" href="Ledger.Conway.Conformance.Properties.html#3214" class="Bound">b</a> <a id="3225" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3227" href="Ledger.Conway.Conformance.Properties.html#1967" class="Function">validBlockIn</a> <a id="3240" href="Ledger.Conway.Conformance.Properties.html#3204" class="Bound">s</a> <a id="3242" href="Ledger.Conway.Conformance.Properties.html#3214" class="Bound">b</a>

<a id="3245" class="Keyword">module</a> <a id="3252" href="Ledger.Conway.Conformance.Properties.html#3252" class="Module">_</a> <a id="3254" class="Symbol">(</a><a id="3255" href="Ledger.Conway.Conformance.Properties.html#3255" class="Bound">s</a> <a id="3257" class="Symbol">:</a> <a id="3259" href="Ledger.Conway.Conformance.Chain.html#645" class="Record">ChainState</a><a id="3269" class="Symbol">)</a> <a id="3271" class="Symbol">(</a><a id="3272" href="Ledger.Conway.Conformance.Properties.html#3272" class="Bound">slot</a> <a id="3277" class="Symbol">:</a> <a id="3279" href="Ledger.Types.Epoch.html#619" class="Function">Slot</a><a id="3283" class="Symbol">)</a> <a id="3285" class="Keyword">where</a>

  <a id="3294" class="Keyword">open</a> <a id="3299" href="Ledger.Conway.Conformance.Chain.html#645" class="Module">ChainState</a> <a id="3310" href="Ledger.Conway.Conformance.Properties.html#3255" class="Bound">s</a><a id="3311" class="Symbol">;</a> <a id="3313" class="Keyword">open</a> <a id="3318" href="Ledger.Conway.Conformance.Epoch.html#1258" class="Module">NewEpochState</a> <a id="3332" href="Ledger.Conway.Conformance.Chain.html#683" class="Function">newEpochState</a>
  <a id="3348" class="Keyword">open</a> <a id="3353" href="Ledger.Conway.Conformance.Epoch.html#1060" class="Module">EpochState</a> <a id="3364" href="Ledger.Conway.Conformance.Epoch.html#1321" class="Function">epochState</a><a id="3374" class="Symbol">;</a> <a id="3376" class="Keyword">open</a> <a id="3381" href="Ledger.Enact.html#397" class="Module">EnactState</a> <a id="3392" href="Ledger.Conway.Conformance.Epoch.html#1197" class="Function">es</a>

  <a id="3398" class="Keyword">private</a>
    <a id="3410" href="Ledger.Conway.Conformance.Properties.html#3410" class="Function">ledgerEnv</a> <a id="3420" class="Symbol">=</a> <a id="3422" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="3424" href="Ledger.Conway.Conformance.Properties.html#3272" class="Bound">slot</a> <a id="3429" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3431" href="Ledger.Enact.html#502" class="Function">constitution</a> <a id="3444" class="Symbol">.</a><a id="3445" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3451" class="Symbol">.</a><a id="3452" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3458" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3460" href="Ledger.Enact.html#607" class="Function">pparams</a> <a id="3468" class="Symbol">.</a><a id="3469" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3475" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3477" href="Ledger.Conway.Conformance.Epoch.html#1197" class="Function">es</a> <a id="3480" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3482" href="Ledger.PParams.html#729" class="Field">Acnt.treasury</a> <a id="3496" href="Ledger.Conway.Conformance.Epoch.html#1124" class="Function">acnt</a> <a id="3501" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

  <a id="3506" href="Ledger.Conway.Conformance.Properties.html#3506" class="Function">validTxIn₂</a> <a id="3517" class="Symbol">:</a> <a id="3519" href="Ledger.Transaction.html#4194" class="Record">Tx</a> <a id="3522" class="Symbol">→</a> <a id="3524" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="3531" href="Ledger.Conway.Conformance.Properties.html#3506" class="Function">validTxIn₂</a> <a id="3542" href="Ledger.Conway.Conformance.Properties.html#3542" class="Bound">tx</a> <a id="3545" class="Symbol">=</a> <a id="3547" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3550" href="Ledger.Conway.Conformance.Properties.html#3550" class="Bound">ls&#39;</a> <a id="3554" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3556" href="Ledger.Conway.Conformance.Properties.html#3410" class="Function">ledgerEnv</a> <a id="3566" href="Ledger.Conway.Conformance.Ledger.html#1073" class="Datatype Operator">⊢</a> <a id="3568" href="Ledger.Conway.Conformance.Epoch.html#1173" class="Function">ls</a> <a id="3571" href="Ledger.Conway.Conformance.Ledger.html#1073" class="Datatype Operator">⇀⦇</a> <a id="3574" href="Ledger.Conway.Conformance.Properties.html#3542" class="Bound">tx</a> <a id="3577" href="Ledger.Conway.Conformance.Ledger.html#1073" class="Datatype Operator">,LEDGER⦈</a> <a id="3586" href="Ledger.Conway.Conformance.Properties.html#3550" class="Bound">ls&#39;</a>

<a id="validTx₁"></a><a id="3591" href="Ledger.Conway.Conformance.Properties.html#3591" class="Function">validTx₁</a> <a id="3600" class="Symbol">:</a> <a id="3602" href="Ledger.Transaction.html#4194" class="Record">Tx</a> <a id="3605" class="Symbol">→</a> <a id="3607" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3612" href="Ledger.Conway.Conformance.Properties.html#3591" class="Function">validTx₁</a> <a id="3621" href="Ledger.Conway.Conformance.Properties.html#3621" class="Bound">tx</a> <a id="3624" class="Symbol">=</a> <a id="3626" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3629" href="Ledger.Conway.Conformance.Properties.html#3629" class="Bound">s</a> <a id="3631" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3633" href="Ledger.Conway.Conformance.Properties.html#3157" class="Function">validTxIn₁</a> <a id="3644" href="Ledger.Conway.Conformance.Properties.html#3629" class="Bound">s</a> <a id="3646" href="Ledger.Conway.Conformance.Properties.html#3621" class="Bound">tx</a>

<a id="ChainInvariant"></a><a id="3650" href="Ledger.Conway.Conformance.Properties.html#3650" class="Function">ChainInvariant</a> <a id="3665" class="Symbol">:</a> <a id="3667" class="Symbol">∀</a> <a id="3669" class="Symbol">{</a><a id="3670" href="Ledger.Conway.Conformance.Properties.html#3670" class="Bound">a</a><a id="3671" class="Symbol">}</a> <a id="3673" class="Symbol">→</a> <a id="3675" class="Symbol">(</a><a id="3676" href="Ledger.Conway.Conformance.Chain.html#645" class="Record">ChainState</a> <a id="3687" class="Symbol">→</a> <a id="3689" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3694" href="Ledger.Conway.Conformance.Properties.html#3670" class="Bound">a</a><a id="3695" class="Symbol">)</a> <a id="3697" class="Symbol">→</a> <a id="3699" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3704" href="Ledger.Conway.Conformance.Properties.html#3670" class="Bound">a</a>
<a id="3706" href="Ledger.Conway.Conformance.Properties.html#3650" class="Function">ChainInvariant</a> <a id="3721" href="Ledger.Conway.Conformance.Properties.html#3721" class="Bound">P</a> <a id="3723" class="Symbol">=</a> <a id="3725" class="Symbol">∀</a> <a id="3727" href="Ledger.Conway.Conformance.Properties.html#3727" class="Bound">b</a> <a id="3729" href="Ledger.Conway.Conformance.Properties.html#3729" class="Bound">s</a> <a id="3731" href="Ledger.Conway.Conformance.Properties.html#3731" class="Bound">s&#39;</a> <a id="3734" class="Symbol">→</a> <a id="3736" class="Symbol">_</a> <a id="3738" href="Ledger.Conway.Conformance.Chain.html#2596" class="Datatype Operator">⊢</a> <a id="3740" href="Ledger.Conway.Conformance.Properties.html#3729" class="Bound">s</a> <a id="3742" href="Ledger.Conway.Conformance.Chain.html#2596" class="Datatype Operator">⇀⦇</a> <a id="3745" href="Ledger.Conway.Conformance.Properties.html#3727" class="Bound">b</a> <a id="3747" href="Ledger.Conway.Conformance.Chain.html#2596" class="Datatype Operator">,CHAIN⦈</a> <a id="3755" href="Ledger.Conway.Conformance.Properties.html#3731" class="Bound">s&#39;</a> <a id="3758" class="Symbol">→</a> <a id="3760" href="Ledger.Conway.Conformance.Properties.html#3721" class="Bound">P</a> <a id="3762" href="Ledger.Conway.Conformance.Properties.html#3729" class="Bound">s</a> <a id="3764" class="Symbol">→</a> <a id="3766" href="Ledger.Conway.Conformance.Properties.html#3721" class="Bound">P</a> <a id="3768" href="Ledger.Conway.Conformance.Properties.html#3731" class="Bound">s&#39;</a>

<a id="3772" class="Keyword">module</a> <a id="3779" href="Ledger.Conway.Conformance.Properties.html#3779" class="Module">_</a> <a id="3781" class="Symbol">(</a><a id="3782" href="Ledger.Conway.Conformance.Properties.html#3782" class="Bound">s</a> <a id="3784" class="Symbol">:</a> <a id="3786" href="Ledger.Conway.Conformance.Chain.html#645" class="Record">ChainState</a><a id="3796" class="Symbol">)</a> <a id="3798" class="Keyword">where</a>
  <a id="3806" class="Keyword">open</a> <a id="3811" href="Ledger.Conway.Conformance.Chain.html#645" class="Module">ChainState</a> <a id="3822" href="Ledger.Conway.Conformance.Properties.html#3782" class="Bound">s</a><a id="3823" class="Symbol">;</a> <a id="3825" class="Keyword">open</a> <a id="3830" href="Ledger.Conway.Conformance.Epoch.html#1258" class="Module">NewEpochState</a> <a id="3844" href="Ledger.Conway.Conformance.Chain.html#683" class="Field">newEpochState</a><a id="3857" class="Symbol">;</a> <a id="3859" class="Keyword">open</a> <a id="3864" href="Ledger.Conway.Conformance.Epoch.html#1060" class="Module">EpochState</a> <a id="3875" href="Ledger.Conway.Conformance.Epoch.html#1321" class="Function">epochState</a>
  <a id="3888" class="Keyword">open</a> <a id="3893" href="Ledger.Conway.Conformance.Ledger.html#695" class="Module">LState</a> <a id="3900" href="Ledger.Conway.Conformance.Epoch.html#1173" class="Function">ls</a>
  <a id="3905" class="Keyword">open</a> <a id="3910" href="Ledger.Enact.html#397" class="Module">EnactState</a> <a id="3921" href="Ledger.Conway.Conformance.Epoch.html#1197" class="Function">es</a> <a id="3924" class="Keyword">renaming</a> <a id="3933" class="Symbol">(</a><a id="3934" href="Ledger.Enact.html#607" class="Field">pparams</a> <a id="3942" class="Symbol">to</a> <a id="3945" class="Field">pparams&#39;</a><a id="3953" class="Symbol">)</a>
  <a id="3957" class="Keyword">open</a> <a id="3962" href="Ledger.Conway.Conformance.Certs.html#934" class="Module">CertState</a> <a id="3972" href="Ledger.Conway.Conformance.Ledger.html#803" class="Function">certState</a><a id="3981" class="Symbol">;</a> <a id="3983" class="Keyword">open</a> <a id="3988" href="Ledger.Conway.Conformance.Certs.html#561" class="Module">DState</a> <a id="3995" href="Ledger.Conway.Conformance.Certs.html#993" class="Function">dState</a>
  <a id="4004" href="Ledger.Conway.Conformance.Properties.html#4004" class="Function">pparams</a> <a id="4012" class="Symbol">=</a> <a id="4014" href="Ledger.Prelude.html#2543" class="Function Operator">∣</a> <a id="4016" href="Ledger.Conway.Conformance.Properties.html#3945" class="Function">pparams&#39;</a> <a id="4025" href="Ledger.Prelude.html#2543" class="Function Operator">∣</a>
  <a id="4029" class="Keyword">open</a> <a id="4034" href="Ledger.PParams.html#1570" class="Module">PParams</a> <a id="4042" href="Ledger.Conway.Conformance.Properties.html#4004" class="Function">pparams</a>
  <a id="4052" class="Keyword">open</a> <a id="4057" href="Ledger.Transaction.html#4194" class="Module">Tx</a><a id="4059" class="Symbol">;</a> <a id="4061" class="Keyword">open</a> <a id="4066" href="Ledger.Transaction.html#2650" class="Module">TxBody</a>

  <a id="4076" class="Comment">-- Transaction properties</a>

  <a id="4105" class="Keyword">module</a> <a id="4112" href="Ledger.Conway.Conformance.Properties.html#4112" class="Module">_</a> <a id="4114" class="Symbol">{</a><a id="4115" href="Ledger.Conway.Conformance.Properties.html#4115" class="Bound">slot</a><a id="4119" class="Symbol">}</a> <a id="4121" class="Symbol">{</a><a id="4122" href="Ledger.Conway.Conformance.Properties.html#4122" class="Bound">tx</a><a id="4124" class="Symbol">}</a> <a id="4126" class="Symbol">(</a><a id="4127" class="Keyword">let</a> <a id="4131" href="Ledger.Conway.Conformance.Properties.html#4131" class="Bound">txb</a> <a id="4135" class="Symbol">=</a> <a id="4137" href="Ledger.Transaction.html#4226" class="Field">body</a> <a id="4142" href="Ledger.Conway.Conformance.Properties.html#4122" class="Bound">tx</a><a id="4144" class="Symbol">)</a> <a id="4146" class="Symbol">(</a><a id="4147" href="Ledger.Conway.Conformance.Properties.html#4147" class="Bound">valid</a> <a id="4153" class="Symbol">:</a> <a id="4155" href="Ledger.Conway.Conformance.Properties.html#3506" class="Function">validTxIn₂</a> <a id="4166" href="Ledger.Conway.Conformance.Properties.html#3782" class="Bound">s</a> <a id="4168" href="Ledger.Conway.Conformance.Properties.html#4115" class="Bound">slot</a> <a id="4173" href="Ledger.Conway.Conformance.Properties.html#4122" class="Bound">tx</a><a id="4175" class="Symbol">)</a>
    <a id="4181" class="Symbol">(</a><a id="4182" href="Ledger.Conway.Conformance.Properties.html#4182" class="Bound">indexedSum-∪⁺-hom</a> <a id="4200" class="Symbol">:</a> <a id="4202" class="Symbol">∀</a> <a id="4204" class="Symbol">{</a><a id="4205" href="Ledger.Conway.Conformance.Properties.html#4205" class="Bound">A</a> <a id="4207" href="Ledger.Conway.Conformance.Properties.html#4207" class="Bound">V</a> <a id="4209" class="Symbol">:</a> <a id="4211" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="4215" class="Symbol">}</a> <a id="4217" class="Symbol">⦃</a> <a id="4219" href="Ledger.Conway.Conformance.Properties.html#4219" class="Bound">_</a> <a id="4221" class="Symbol">:</a> <a id="4223" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="4229" href="Ledger.Conway.Conformance.Properties.html#4205" class="Bound">A</a> <a id="4231" class="Symbol">⦄</a> <a id="4233" class="Symbol">⦃</a> <a id="4235" href="Ledger.Conway.Conformance.Properties.html#4235" class="Bound">_</a> <a id="4237" class="Symbol">:</a> <a id="4239" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="4245" href="Ledger.Conway.Conformance.Properties.html#4207" class="Bound">V</a> <a id="4247" class="Symbol">⦄</a> <a id="4249" class="Symbol">⦃</a> <a id="4251" href="Ledger.Conway.Conformance.Properties.html#4251" class="Bound">mon</a> <a id="4255" class="Symbol">:</a> <a id="4257" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="4275" href="Level.html#521" class="Function">0ℓ</a> <a id="4278" href="Level.html#521" class="Function">0ℓ</a> <a id="4281" href="Ledger.Conway.Conformance.Properties.html#4207" class="Bound">V</a> <a id="4283" class="Symbol">⦄</a>
      <a id="4291" class="Symbol">→</a> <a id="4293" class="Symbol">(</a><a id="4294" href="Ledger.Conway.Conformance.Properties.html#4294" class="Bound">d₁</a> <a id="4297" href="Ledger.Conway.Conformance.Properties.html#4297" class="Bound">d₂</a> <a id="4300" class="Symbol">:</a> <a id="4302" href="Ledger.Conway.Conformance.Properties.html#4205" class="Bound">A</a> <a id="4304" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="4306" href="Ledger.Conway.Conformance.Properties.html#4207" class="Bound">V</a><a id="4307" class="Symbol">)</a> <a id="4309" class="Symbol">→</a> <a id="4311" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4324" href="Function.Base.html#704" class="Function">id</a> <a id="4327" class="Symbol">(</a><a id="4328" href="Ledger.Conway.Conformance.Properties.html#4294" class="Bound">d₁</a> <a id="4331" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="4334" href="Ledger.Conway.Conformance.Properties.html#4297" class="Bound">d₂</a><a id="4336" class="Symbol">)</a> <a id="4338" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4340" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4353" href="Function.Base.html#704" class="Function">id</a> <a id="4356" href="Ledger.Conway.Conformance.Properties.html#4294" class="Bound">d₁</a> <a id="4359" href="Class.Semigroup.Core.html#173" class="Field Operator">◇</a> <a id="4361" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4374" href="Function.Base.html#704" class="Function">id</a> <a id="4377" href="Ledger.Conway.Conformance.Properties.html#4297" class="Bound">d₂</a><a id="4379" class="Symbol">)</a>
    <a id="4385" class="Symbol">(</a><a id="4386" href="Ledger.Conway.Conformance.Properties.html#4386" class="Bound">indexedSum-⊆</a> <a id="4399" class="Symbol">:</a> <a id="4401" class="Symbol">∀</a> <a id="4403" class="Symbol">{</a><a id="4404" href="Ledger.Conway.Conformance.Properties.html#4404" class="Bound">A</a> <a id="4406" class="Symbol">:</a> <a id="4408" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="4412" class="Symbol">}</a> <a id="4414" class="Symbol">⦃</a> <a id="4416" href="Ledger.Conway.Conformance.Properties.html#4416" class="Bound">_</a> <a id="4418" class="Symbol">:</a> <a id="4420" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="4426" href="Ledger.Conway.Conformance.Properties.html#4404" class="Bound">A</a> <a id="4428" class="Symbol">⦄</a> <a id="4430" class="Symbol">(</a><a id="4431" href="Ledger.Conway.Conformance.Properties.html#4431" class="Bound">d</a> <a id="4433" href="Ledger.Conway.Conformance.Properties.html#4433" class="Bound">d&#39;</a> <a id="4436" class="Symbol">:</a> <a id="4438" href="Ledger.Conway.Conformance.Properties.html#4404" class="Bound">A</a> <a id="4440" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="4442" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4443" class="Symbol">)</a> <a id="4445" class="Symbol">→</a> <a id="4447" href="Ledger.Conway.Conformance.Properties.html#4431" class="Bound">d</a> <a id="4449" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a> <a id="4451" href="Interface.HasSubset.html#158" class="Field Operator">⊆</a> <a id="4453" href="Ledger.Conway.Conformance.Properties.html#4433" class="Bound">d&#39;</a> <a id="4456" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a>
      <a id="4464" class="Symbol">→</a> <a id="4466" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4479" href="Function.Base.html#704" class="Function">id</a> <a id="4482" href="Ledger.Conway.Conformance.Properties.html#4431" class="Bound">d</a> <a id="4484" href="Class.HasOrder.Core.html#608" class="Field Operator">≤</a> <a id="4486" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4499" href="Function.Base.html#704" class="Function">id</a> <a id="4502" href="Ledger.Conway.Conformance.Properties.html#4433" class="Bound">d&#39;</a><a id="4504" class="Symbol">)</a> <a id="4506" class="Comment">-- technically we could use an ordered monoid instead of ℕ</a>
    <a id="4569" class="Keyword">where</a>
    <a id="4579" class="Keyword">open</a> <a id="4584" class="Keyword">import</a> <a id="4591" href="Ledger.Conway.Conformance.Utxow.html" class="Module">Ledger.Conway.Conformance.Utxow</a> <a id="4623" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a> <a id="4627" href="Ledger.Conway.Conformance.Properties.html#203" class="Bound">abs</a>
    <a id="4635" class="Keyword">open</a> <a id="4640" class="Keyword">import</a> <a id="4647" href="Ledger.Conway.Conformance.Utxo.Properties.html" class="Module">Ledger.Conway.Conformance.Utxo.Properties</a> <a id="4689" href="Ledger.Conway.Conformance.Properties.html#159" class="Bound">txs</a> <a id="4693" href="Ledger.Conway.Conformance.Properties.html#203" class="Bound">abs</a>

  <a id="4700" class="Comment">--   propose-ChangePP-hasGroup : ∀ {up prop}</a>
  <a id="4747" class="Comment">--     → prop ∈ txb → prop .GovProposal.action ≡ ChangePParams up → updateGroups up ≢ ∅</a>
  <a id="4837" class="Comment">--   propose-ChangePP-hasGroup = {!!}</a>

  <a id="4878" class="Comment">-- Block properties</a>

  <a id="4901" class="Keyword">module</a> <a id="4908" href="Ledger.Conway.Conformance.Properties.html#4908" class="Module">_</a> <a id="4910" class="Symbol">{</a><a id="4911" href="Ledger.Conway.Conformance.Properties.html#4911" class="Bound">b</a><a id="4912" class="Symbol">}</a> <a id="4914" class="Symbol">(</a><a id="4915" href="Ledger.Conway.Conformance.Properties.html#4915" class="Bound">valid</a> <a id="4921" class="Symbol">:</a> <a id="4923" href="Ledger.Conway.Conformance.Properties.html#1967" class="Function">validBlockIn</a> <a id="4936" href="Ledger.Conway.Conformance.Properties.html#3782" class="Bound">s</a> <a id="4938" href="Ledger.Conway.Conformance.Properties.html#4911" class="Bound">b</a><a id="4939" class="Symbol">)</a> <a id="4941" class="Symbol">(</a><a id="4942" class="Keyword">let</a> <a id="4946" class="Keyword">open</a> <a id="4951" href="Ledger.Conway.Conformance.Chain.html#722" class="Module">Block</a> <a id="4957" href="Ledger.Conway.Conformance.Properties.html#4911" class="Bound">b</a><a id="4958" class="Symbol">)</a> <a id="4960" class="Keyword">where</a>
    <a id="4970" href="Ledger.Conway.Conformance.Properties.html#4970" class="Function">isNewEpochBlock</a> <a id="4986" class="Symbol">:</a> <a id="4988" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="4997" href="Ledger.Conway.Conformance.Properties.html#4970" class="Function">isNewEpochBlock</a> <a id="5013" class="Symbol">=</a> <a id="5015" href="Ledger.Types.Epoch.html#755" class="Function">epoch</a> <a id="5021" href="Ledger.Conway.Conformance.Chain.html#775" class="Function">slot</a> <a id="5026" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5028" href="Ledger.Types.Epoch.html#864" class="Function">sucᵉ</a> <a id="5033" href="Ledger.Conway.Conformance.Epoch.html#1297" class="Function">lastEpoch</a>

    <a id="5048" href="Ledger.Conway.Conformance.Properties.html#5048" class="Function">newChainState</a> <a id="5062" class="Symbol">:</a> <a id="5064" href="Ledger.Conway.Conformance.Chain.html#645" class="Record">ChainState</a>
    <a id="5079" href="Ledger.Conway.Conformance.Properties.html#5048" class="Function">newChainState</a> <a id="5093" class="Symbol">=</a> <a id="5095" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5101" href="Ledger.Conway.Conformance.Properties.html#4915" class="Bound">valid</a>

    <a id="5112" class="Comment">-- enact-change⇒newEpoch : es ≢ getEnactState newChainState → isNewEpochBlock</a>
    <a id="5194" class="Comment">-- enact-change⇒newEpoch = {!!}</a>

  <a id="5229" class="Comment">-- Invariant properties</a>

  <a id="5256" href="Ledger.Conway.Conformance.Properties.html#5256" class="Function">action-deposits≡actions-prop</a> <a id="5285" class="Symbol">:</a> <a id="5287" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5294" href="Ledger.Conway.Conformance.Properties.html#5256" class="Function">action-deposits≡actions-prop</a> <a id="5323" class="Symbol">=</a> <a id="5325" href="abstract-set-theory.FiniteSetTheory.html#2813" class="Function">filterˢ</a> <a id="5333" href="Ledger.Conway.Conformance.Properties.html#944" class="Function">isGADeposit</a> <a id="5345" class="Symbol">(</a><a id="5346" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5350" class="Symbol">(</a><a id="5351" href="Ledger.Utxo.html#2813" class="Field">UTxOState.deposits</a> <a id="5370" href="Ledger.Conway.Conformance.Ledger.html#750" class="Function">utxoSt</a><a id="5376" class="Symbol">))</a>
    <a id="5383" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5385" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="5394" class="Symbol">(</a><a id="5395" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="5399" class="Symbol">(λ</a> <a id="5402" class="Keyword">where</a> <a id="5408" class="Symbol">(</a><a id="5409" href="Ledger.Conway.Conformance.Properties.html#5409" class="Bound">id</a> <a id="5412" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5414" class="Symbol">_)</a> <a id="5417" class="Symbol">→</a> <a id="5419" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="5436" href="Ledger.Conway.Conformance.Properties.html#5409" class="Bound">id</a><a id="5438" class="Symbol">)</a> <a id="5440" href="Ledger.Conway.Conformance.Ledger.html#777" class="Function">govSt</a><a id="5445" class="Symbol">)</a>

  <a id="5450" href="Ledger.Conway.Conformance.Properties.html#5450" class="Function">dom-rwds≡credDeposits</a> <a id="5472" class="Symbol">:</a> <a id="5474" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5481" href="Ledger.Conway.Conformance.Properties.html#5450" class="Function">dom-rwds≡credDeposits</a> <a id="5503" class="Symbol">=</a> <a id="5505" href="abstract-set-theory.FiniteSetTheory.html#2813" class="Function">filterˢ</a> <a id="5513" href="Ledger.Conway.Conformance.Properties.html#601" class="Function">isCredDeposit</a> <a id="5527" class="Symbol">(</a><a id="5528" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5532" class="Symbol">(</a><a id="5533" href="Ledger.Utxo.html#2813" class="Field">UTxOState.deposits</a> <a id="5552" href="Ledger.Conway.Conformance.Ledger.html#750" class="Function">utxoSt</a><a id="5558" class="Symbol">))</a>
    <a id="5565" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5567" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5572" href="Ledger.Certs.html#362" class="InductiveConstructor">CredentialDeposit</a> <a id="5590" class="Symbol">(</a><a id="5591" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5595" href="Ledger.Conway.Conformance.Certs.html#697" class="Function">rewards</a><a id="5602" class="Symbol">)</a>

  <a id="5607" href="Ledger.Conway.Conformance.Properties.html#5607" class="Function">pp-wellFormed</a> <a id="5621" class="Symbol">:</a> <a id="5623" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5630" href="Ledger.Conway.Conformance.Properties.html#5607" class="Function">pp-wellFormed</a> <a id="5644" class="Symbol">=</a> <a id="5646" href="Ledger.PParams.html#4255" class="Function">paramsWellFormed</a> <a id="5663" href="Ledger.Conway.Conformance.Properties.html#4004" class="Function">pparams</a>

<a id="5672" class="Comment">-- action-deposits≡actions-inv : ChainInvariant action-deposits≡actions-prop</a>
<a id="5749" class="Comment">-- action-deposits≡actions-inv = {!!}</a>

<a id="5788" class="Comment">-- dom-rwds≡credDeposits-inv : ChainInvariant dom-rwds≡credDeposits</a>
<a id="5856" class="Comment">-- dom-rwds≡credDeposits-inv = {!!}</a>

<a id="5893" class="Comment">-- pp-wellFormed-inv : ChainInvariant pp-wellFormed</a>
<a id="5945" class="Comment">-- pp-wellFormed-inv = {!!}</a>

<a id="5974" class="Comment">-- Epoch boundary properties</a>

<a id="6004" class="Comment">-- module _ {Γ es e es&#39;} (step : Γ ⊢ es ⇀⦇ e ,NEWEPOCH⦈ es&#39;) where</a>
<a id="6071" class="Comment">--   dom-rwds-const : dom (getRewards es) ≡ dom (getRewards es&#39;)</a>
<a id="6136" class="Comment">--   dom-rwds-const = {!!}</a>

<a id="6164" class="Comment">--   prop≡∅⇒activeDReps-const : getGovState es ≡ [] → activeDReps e es ≡ᵉ activeDReps (sucᵉ e) es&#39;</a>
<a id="6263" class="Comment">--   prop≡∅⇒activeDReps-const = {!!}</a>
</pre></body></html>