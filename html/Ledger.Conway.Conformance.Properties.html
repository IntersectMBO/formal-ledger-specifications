<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Conformance.Properties</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>

<a id="125" class="Keyword">module</a> <a id="132" href="Ledger.Conway.Conformance.Properties.html" class="Module">Ledger.Conway.Conformance.Properties</a>
  <a id="171" class="Symbol">(</a><a id="172" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a> <a id="176" class="Symbol">:</a> <a id="178" href="Ledger.Conway.Specification.Transaction.html#991" class="Record">TransactionStructure</a><a id="198" class="Symbol">)</a> <a id="200" class="Symbol">(</a><a id="201" class="Keyword">open</a> <a id="206" href="Ledger.Conway.Specification.Transaction.html#991" class="Module">TransactionStructure</a> <a id="227" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a><a id="230" class="Symbol">)</a>
  <a id="234" class="Symbol">(</a><a id="235" href="Ledger.Conway.Conformance.Properties.html#235" class="Bound">abs</a> <a id="239" class="Symbol">:</a> <a id="241" href="Ledger.Core.Specification.Abstract.html#828" class="Record">AbstractFunctions</a> <a id="259" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a><a id="262" class="Symbol">)</a>
  <a id="266" class="Keyword">where</a>

<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="345" href="Ledger.Conway.Specification.Transaction.html#2065" class="Function">govStructure</a>
<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="Ledger.Conway.Conformance.Chain.html" class="Module">Ledger.Conway.Conformance.Chain</a> <a id="402" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a> <a id="406" href="Ledger.Conway.Conformance.Properties.html#235" class="Bound">abs</a>
<a id="410" class="Keyword">open</a> <a id="415" class="Keyword">import</a> <a id="422" href="Ledger.Conway.Conformance.Epoch.html" class="Module">Ledger.Conway.Conformance.Epoch</a> <a id="454" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a> <a id="458" href="Ledger.Conway.Conformance.Properties.html#235" class="Bound">abs</a>
<a id="462" class="Keyword">open</a> <a id="467" class="Keyword">import</a> <a id="474" href="Ledger.Conway.Conformance.Ledger.html" class="Module">Ledger.Conway.Conformance.Ledger</a> <a id="507" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a> <a id="511" href="Ledger.Conway.Conformance.Properties.html#235" class="Bound">abs</a>
<a id="515" class="Keyword">open</a> <a id="520" class="Keyword">import</a> <a id="527" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="558" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a> <a id="562" href="Ledger.Conway.Conformance.Properties.html#235" class="Bound">abs</a>

<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="613" href="Ledger.Conway.Specification.Transaction.html#2065" class="Function">govStructure</a>
<a id="626" class="Keyword">open</a> <a id="631" class="Keyword">import</a> <a id="638" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="670" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a>
<a id="674" class="Keyword">open</a> <a id="679" class="Keyword">import</a> <a id="686" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>


<a id="isCredDeposit"></a><a id="728" href="Ledger.Conway.Conformance.Properties.html#728" class="Function">isCredDeposit</a> <a id="742" class="Symbol">:</a> <a id="744" href="Ledger.Core.Specification.Certs.html#534" class="Datatype">DepositPurpose</a> <a id="759" class="Symbol">→</a> <a id="761" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="766" href="Ledger.Conway.Conformance.Properties.html#728" class="Function">isCredDeposit</a> <a id="780" class="Symbol">(</a><a id="781" href="Ledger.Core.Specification.Certs.html#564" class="InductiveConstructor">CredentialDeposit</a> <a id="799" href="Ledger.Conway.Conformance.Properties.html#799" class="Bound">x</a><a id="800" class="Symbol">)</a> <a id="802" class="Symbol">=</a> <a id="804" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="806" href="Ledger.Conway.Conformance.Properties.html#728" class="CatchallClause Function">isCredDeposit</a><a id="819" class="CatchallClause"> </a><a id="820" class="CatchallClause Symbol">_</a> <a id="822" class="Symbol">=</a> <a id="824" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="827" class="Keyword">instance</a>
  <a id="isCredDeposit?"></a><a id="838" href="Ledger.Conway.Conformance.Properties.html#838" class="Function">isCredDeposit?</a> <a id="853" class="Symbol">:</a> <a id="855" href="Ledger.Conway.Conformance.Properties.html#728" class="Function">isCredDeposit</a> <a id="869" href="Class.Decidable.Core.html#579" class="Function Operator">⁇¹</a>
  <a id="874" href="Ledger.Conway.Conformance.Properties.html#838" class="Function">isCredDeposit?</a> <a id="889" class="Symbol">{</a><a id="890" href="Ledger.Core.Specification.Certs.html#564" class="InductiveConstructor">CredentialDeposit</a> <a id="908" href="Ledger.Conway.Conformance.Properties.html#908" class="Bound">x</a><a id="909" class="Symbol">}</a> <a id="911" class="Symbol">=</a> <a id="913" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="915" class="Symbol">(</a><a id="916" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="920" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="922" class="Symbol">)</a>
  <a id="926" href="Ledger.Conway.Conformance.Properties.html#838" class="Function">isCredDeposit?</a> <a id="941" class="Symbol">{</a><a id="942" href="Ledger.Core.Specification.Certs.html#617" class="InductiveConstructor">PoolDeposit</a> <a id="954" href="Ledger.Conway.Conformance.Properties.html#954" class="Bound">x</a><a id="955" class="Symbol">}</a> <a id="957" class="Symbol">=</a> <a id="959" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="961" class="Symbol">(</a><a id="962" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="965" class="Symbol">λ</a> <a id="967" class="Symbol">())</a>
  <a id="973" href="Ledger.Conway.Conformance.Properties.html#838" class="Function">isCredDeposit?</a> <a id="988" class="Symbol">{</a><a id="989" href="Ledger.Core.Specification.Certs.html#670" class="InductiveConstructor">DRepDeposit</a> <a id="1001" href="Ledger.Conway.Conformance.Properties.html#1001" class="Bound">x</a><a id="1002" class="Symbol">}</a> <a id="1004" class="Symbol">=</a> <a id="1006" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="1008" class="Symbol">(</a><a id="1009" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1012" class="Symbol">λ</a> <a id="1014" class="Symbol">())</a>
  <a id="1020" href="Ledger.Conway.Conformance.Properties.html#838" class="Function">isCredDeposit?</a> <a id="1035" class="Symbol">{</a><a id="1036" href="Ledger.Core.Specification.Certs.html#723" class="InductiveConstructor">GovActionDeposit</a> <a id="1053" href="Ledger.Conway.Conformance.Properties.html#1053" class="Bound">x</a><a id="1054" class="Symbol">}</a> <a id="1056" class="Symbol">=</a> <a id="1058" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="1060" class="Symbol">(</a><a id="1061" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1064" class="Symbol">λ</a> <a id="1066" class="Symbol">())</a>

<a id="isGADeposit"></a><a id="1071" href="Ledger.Conway.Conformance.Properties.html#1071" class="Function">isGADeposit</a> <a id="1083" class="Symbol">:</a> <a id="1085" href="Ledger.Core.Specification.Certs.html#534" class="Datatype">DepositPurpose</a> <a id="1100" class="Symbol">→</a> <a id="1102" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1107" href="Ledger.Conway.Conformance.Properties.html#1071" class="Function">isGADeposit</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Ledger.Core.Specification.Certs.html#723" class="InductiveConstructor">GovActionDeposit</a> <a id="1137" href="Ledger.Conway.Conformance.Properties.html#1137" class="Bound">x</a><a id="1138" class="Symbol">)</a> <a id="1140" class="Symbol">=</a> <a id="1142" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1144" href="Ledger.Conway.Conformance.Properties.html#1071" class="CatchallClause Function">isGADeposit</a><a id="1155" class="CatchallClause"> </a><a id="1156" class="CatchallClause Symbol">_</a> <a id="1158" class="Symbol">=</a> <a id="1160" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="1163" class="Keyword">instance</a>
  <a id="isGADeposit?"></a><a id="1174" href="Ledger.Conway.Conformance.Properties.html#1174" class="Function">isGADeposit?</a> <a id="1187" class="Symbol">:</a> <a id="1189" href="Ledger.Conway.Conformance.Properties.html#1071" class="Function">isGADeposit</a> <a id="1201" href="Class.Decidable.Core.html#579" class="Function Operator">⁇¹</a>
  <a id="1206" href="Ledger.Conway.Conformance.Properties.html#1174" class="Function">isGADeposit?</a> <a id="1219" class="Symbol">{</a><a id="1220" href="Ledger.Core.Specification.Certs.html#564" class="InductiveConstructor">CredentialDeposit</a> <a id="1238" href="Ledger.Conway.Conformance.Properties.html#1238" class="Bound">x</a><a id="1239" class="Symbol">}</a> <a id="1241" class="Symbol">=</a> <a id="1243" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="1245" class="Symbol">(</a><a id="1246" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1249" class="Symbol">λ</a> <a id="1251" class="Symbol">())</a>
  <a id="1257" href="Ledger.Conway.Conformance.Properties.html#1174" class="Function">isGADeposit?</a> <a id="1270" class="Symbol">{</a><a id="1271" href="Ledger.Core.Specification.Certs.html#617" class="InductiveConstructor">PoolDeposit</a> <a id="1283" href="Ledger.Conway.Conformance.Properties.html#1283" class="Bound">x</a><a id="1284" class="Symbol">}</a> <a id="1286" class="Symbol">=</a> <a id="1288" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="1290" class="Symbol">(</a><a id="1291" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1294" class="Symbol">λ</a> <a id="1296" class="Symbol">())</a>
  <a id="1302" href="Ledger.Conway.Conformance.Properties.html#1174" class="Function">isGADeposit?</a> <a id="1315" class="Symbol">{</a><a id="1316" href="Ledger.Core.Specification.Certs.html#670" class="InductiveConstructor">DRepDeposit</a> <a id="1328" href="Ledger.Conway.Conformance.Properties.html#1328" class="Bound">x</a><a id="1329" class="Symbol">}</a> <a id="1331" class="Symbol">=</a> <a id="1333" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="1335" class="Symbol">(</a><a id="1336" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1339" class="Symbol">λ</a> <a id="1341" class="Symbol">())</a>
  <a id="1347" href="Ledger.Conway.Conformance.Properties.html#1174" class="Function">isGADeposit?</a> <a id="1360" class="Symbol">{</a><a id="1361" href="Ledger.Core.Specification.Certs.html#723" class="InductiveConstructor">GovActionDeposit</a> <a id="1378" href="Ledger.Conway.Conformance.Properties.html#1378" class="Bound">x</a><a id="1379" class="Symbol">}</a> <a id="1381" class="Symbol">=</a> <a id="1383" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="1385" class="Symbol">(</a><a id="1386" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1390" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="1392" class="Symbol">)</a>

<a id="getLState"></a><a id="1395" href="Ledger.Conway.Conformance.Properties.html#1395" class="Function">getLState</a> <a id="1405" class="Symbol">:</a> <a id="1407" href="Ledger.Conway.Conformance.Epoch.html#1390" class="Record">NewEpochState</a> <a id="1421" class="Symbol">→</a> <a id="1423" href="Ledger.Conway.Conformance.Ledger.html#732" class="Record">LState</a>
<a id="1430" href="Ledger.Conway.Conformance.Properties.html#1395" class="Function">getLState</a> <a id="1440" class="Symbol">=</a> <a id="1442" href="Ledger.Conway.Conformance.Epoch.html#1242" class="Field">EpochState.ls</a> <a id="1456" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1458" href="Ledger.Conway.Conformance.Epoch.html#1511" class="Field">NewEpochState.epochState</a>

<a id="getRewards"></a><a id="1484" href="Ledger.Conway.Conformance.Properties.html#1484" class="Function">getRewards</a> <a id="1495" class="Symbol">:</a> <a id="1497" href="Ledger.Conway.Conformance.Epoch.html#1390" class="Record">NewEpochState</a> <a id="1511" class="Symbol">→</a> <a id="1513" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="1524" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1526" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
<a id="1531" href="Ledger.Conway.Conformance.Properties.html#1484" class="Function">getRewards</a> <a id="1542" class="Symbol">=</a> <a id="1544" href="Ledger.Conway.Conformance.Certs.html#731" class="Field">DState.rewards</a> <a id="1559" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1561" href="Ledger.Conway.Conformance.Certs.html#1017" class="Field">CertState.dState</a> <a id="1578" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1580" href="Ledger.Conway.Conformance.Ledger.html#840" class="Field">LState.certState</a> <a id="1597" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1599" href="Ledger.Conway.Conformance.Properties.html#1395" class="Function">getLState</a>

<a id="allDReps"></a><a id="1610" href="Ledger.Conway.Conformance.Properties.html#1610" class="Function">allDReps</a> <a id="1619" class="Symbol">:</a> <a id="1621" href="Ledger.Conway.Conformance.Epoch.html#1390" class="Record">NewEpochState</a> <a id="1635" class="Symbol">→</a> <a id="1637" href="Ledger.Core.Specification.Gov.Actions.html#6996" class="Function">DReps</a>
<a id="1643" href="Ledger.Conway.Conformance.Properties.html#1610" class="Function">allDReps</a> <a id="1652" class="Symbol">=</a> <a id="1654" href="Ledger.Conway.Conformance.Certs.html#845" class="Field">GState.dreps</a> <a id="1667" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1669" href="Ledger.Conway.Conformance.Certs.html#1057" class="Field">CertState.gState</a> <a id="1686" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1688" href="Ledger.Conway.Conformance.Ledger.html#840" class="Field">LState.certState</a> <a id="1705" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1707" href="Ledger.Conway.Conformance.Properties.html#1395" class="Function">getLState</a>

<a id="getGovState"></a><a id="1718" href="Ledger.Conway.Conformance.Properties.html#1718" class="Function">getGovState</a> <a id="1730" class="Symbol">:</a> <a id="1732" href="Ledger.Conway.Conformance.Epoch.html#1390" class="Record">NewEpochState</a> <a id="1746" class="Symbol">→</a> <a id="1748" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
<a id="1757" href="Ledger.Conway.Conformance.Properties.html#1718" class="Function">getGovState</a> <a id="1769" class="Symbol">=</a> <a id="1771" href="Ledger.Conway.Conformance.Ledger.html#814" class="Field">LState.govSt</a> <a id="1784" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1786" href="Ledger.Conway.Conformance.Properties.html#1395" class="Function">getLState</a>

<a id="1797" class="Keyword">instance</a>
  <a id="1808" href="Ledger.Conway.Conformance.Properties.html#1808" class="Function">_</a> <a id="1810" class="Symbol">:</a> <a id="1812" href="Class.IsSet.html#375" class="Record">IsSet</a> <a id="1818" href="Ledger.Conway.Conformance.Chain.html#777" class="Record">Block</a> <a id="1824" href="Ledger.Conway.Specification.Transaction.html#4668" class="Record">Tx</a>
  <a id="1829" class="Symbol">_</a> <a id="1831" class="Symbol">=</a> <a id="1833" class="Keyword">record</a> <a id="1840" class="Symbol">{</a> <a id="1842" href="Class.IsSet.html#419" class="Field">toSet</a> <a id="1848" class="Symbol">=</a> <a id="1850" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="1859" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1861" href="Ledger.Conway.Conformance.Chain.html#810" class="Field">Block.ts</a> <a id="1870" class="Symbol">}</a>

  <a id="1875" href="Ledger.Conway.Conformance.Properties.html#1875" class="Function">_</a> <a id="1877" class="Symbol">:</a> <a id="1879" href="Class.IsSet.html#375" class="Record">IsSet</a> <a id="1885" href="Ledger.Conway.Specification.Transaction.html#2982" class="Record">TxBody</a> <a id="1892" href="Ledger.Core.Specification.Gov.Actions.html#3599" class="Record">GovProposal</a>
  <a id="1906" class="Symbol">_</a> <a id="1908" class="Symbol">=</a> <a id="1910" class="Keyword">record</a> <a id="1917" class="Symbol">{</a> <a id="1919" href="Class.IsSet.html#419" class="Field">toSet</a> <a id="1925" class="Symbol">=</a> <a id="1927" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="1936" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1938" href="Ledger.Conway.Specification.Transaction.html#3491" class="Field">TxBody.txGovProposals</a> <a id="1960" class="Symbol">}</a>

<a id="validBlockIn"></a><a id="1963" href="Ledger.Conway.Conformance.Properties.html#1963" class="Function">validBlockIn</a> <a id="1976" class="Symbol">:</a> <a id="1978" href="Ledger.Conway.Conformance.Chain.html#700" class="Record">ChainState</a> <a id="1989" class="Symbol">→</a> <a id="1991" href="Ledger.Conway.Conformance.Chain.html#777" class="Record">Block</a> <a id="1997" class="Symbol">→</a> <a id="1999" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="2004" href="Ledger.Conway.Conformance.Properties.html#1963" class="Function">validBlockIn</a> <a id="2017" href="Ledger.Conway.Conformance.Properties.html#2017" class="Bound">s</a> <a id="2019" href="Ledger.Conway.Conformance.Properties.html#2019" class="Bound">b</a> <a id="2021" class="Symbol">=</a> <a id="2023" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2026" href="Ledger.Conway.Conformance.Properties.html#2026" class="Bound">s&#39;</a> <a id="2029" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2031" class="Symbol">_</a> <a id="2033" href="Ledger.Conway.Conformance.Chain.html#2347" class="Datatype Operator">⊢</a> <a id="2035" href="Ledger.Conway.Conformance.Properties.html#2017" class="Bound">s</a> <a id="2037" href="Ledger.Conway.Conformance.Chain.html#2347" class="Datatype Operator">⇀⦇</a> <a id="2040" href="Ledger.Conway.Conformance.Properties.html#2019" class="Bound">b</a> <a id="2042" href="Ledger.Conway.Conformance.Chain.html#2347" class="Datatype Operator">,CHAIN⦈</a> <a id="2050" href="Ledger.Conway.Conformance.Properties.html#2026" class="Bound">s&#39;</a>

<a id="validBlock"></a><a id="2054" href="Ledger.Conway.Conformance.Properties.html#2054" class="Function">validBlock</a> <a id="2065" class="Symbol">:</a> <a id="2067" href="Ledger.Conway.Conformance.Chain.html#777" class="Record">Block</a> <a id="2073" class="Symbol">→</a> <a id="2075" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="2080" href="Ledger.Conway.Conformance.Properties.html#2054" class="Function">validBlock</a> <a id="2091" href="Ledger.Conway.Conformance.Properties.html#2091" class="Bound">b</a> <a id="2093" class="Symbol">=</a> <a id="2095" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2098" href="Ledger.Conway.Conformance.Properties.html#2098" class="Bound">s</a> <a id="2100" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2102" href="Ledger.Conway.Conformance.Properties.html#1963" class="Function">validBlockIn</a> <a id="2115" href="Ledger.Conway.Conformance.Properties.html#2098" class="Bound">s</a> <a id="2117" href="Ledger.Conway.Conformance.Properties.html#2091" class="Bound">b</a>

<a id="2120" class="Comment">-- Transaction validity is complicated. In the truest sense, a</a>
<a id="2183" class="Comment">-- transaction is valid if it is part of a valid block,</a>
<a id="2239" class="Comment">-- i.e. `validTxIn₁`. However, a transaction can also be seen as valid</a>
<a id="2310" class="Comment">-- if it could be applied at a certain slot (with no knowledge of an</a>
<a id="2379" class="Comment">-- actual block). This is closer to how the mempool sees transaction</a>
<a id="2448" class="Comment">-- validity and is expressed by `validTxIn₂`.</a>

<a id="2495" class="Comment">-- Note that these two are not equivalent and in fact there is no</a>
<a id="2561" class="Comment">-- implication between the two in either direction. `2 =&gt; 1` would</a>
<a id="2628" class="Comment">-- require one to come up with a block, which we can&#39;t, but `1 =&gt; 2`</a>
<a id="2697" class="Comment">-- is also not true, since the transaction might depend on a previous</a>
<a id="2767" class="Comment">-- transaction in the same block. Maybe this means that `validTxIn₂`</a>
<a id="2836" class="Comment">-- should be changed so that it allows for applying a list of</a>
<a id="2898" class="Comment">-- transactions before the final transaction? However, the downside</a>
<a id="2966" class="Comment">-- then becomes that the transaction isn&#39;t applied to the given state</a>
<a id="3036" class="Comment">-- but to some intermediate one. Maybe we&#39;ll gain some insight on this</a>
<a id="3107" class="Comment">-- matter once we have proven more theorems.</a>

<a id="validTxIn₁"></a><a id="3153" href="Ledger.Conway.Conformance.Properties.html#3153" class="Function">validTxIn₁</a> <a id="3164" class="Symbol">:</a> <a id="3166" href="Ledger.Conway.Conformance.Chain.html#700" class="Record">ChainState</a> <a id="3177" class="Symbol">→</a> <a id="3179" href="Ledger.Conway.Specification.Transaction.html#4668" class="Record">Tx</a> <a id="3182" class="Symbol">→</a> <a id="3184" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3189" href="Ledger.Conway.Conformance.Properties.html#3153" class="Function">validTxIn₁</a> <a id="3200" href="Ledger.Conway.Conformance.Properties.html#3200" class="Bound">s</a> <a id="3202" href="Ledger.Conway.Conformance.Properties.html#3202" class="Bound">tx</a> <a id="3205" class="Symbol">=</a> <a id="3207" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3210" href="Ledger.Conway.Conformance.Properties.html#3210" class="Bound">b</a> <a id="3212" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3214" href="Ledger.Conway.Conformance.Properties.html#3202" class="Bound">tx</a> <a id="3217" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="3219" href="Ledger.Conway.Conformance.Properties.html#3210" class="Bound">b</a> <a id="3221" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3223" href="Ledger.Conway.Conformance.Properties.html#1963" class="Function">validBlockIn</a> <a id="3236" href="Ledger.Conway.Conformance.Properties.html#3200" class="Bound">s</a> <a id="3238" href="Ledger.Conway.Conformance.Properties.html#3210" class="Bound">b</a>

<a id="3241" class="Keyword">module</a> <a id="3248" href="Ledger.Conway.Conformance.Properties.html#3248" class="Module">_</a> <a id="3250" class="Symbol">(</a><a id="3251" href="Ledger.Conway.Conformance.Properties.html#3251" class="Bound">s</a> <a id="3253" class="Symbol">:</a> <a id="3255" href="Ledger.Conway.Conformance.Chain.html#700" class="Record">ChainState</a><a id="3265" class="Symbol">)</a> <a id="3267" class="Symbol">(</a><a id="3268" href="Ledger.Conway.Conformance.Properties.html#3268" class="Bound">slot</a> <a id="3273" class="Symbol">:</a> <a id="3275" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a><a id="3279" class="Symbol">)</a> <a id="3281" class="Keyword">where</a>

  <a id="3290" class="Keyword">open</a> <a id="3295" href="Ledger.Conway.Conformance.Chain.html#700" class="Module">ChainState</a> <a id="3306" href="Ledger.Conway.Conformance.Properties.html#3251" class="Bound">s</a><a id="3307" class="Symbol">;</a> <a id="3309" class="Keyword">open</a> <a id="3314" href="Ledger.Conway.Conformance.Epoch.html#1390" class="Module">NewEpochState</a> <a id="3328" href="Ledger.Conway.Conformance.Chain.html#738" class="Function">newEpochState</a>
  <a id="3344" class="Keyword">open</a> <a id="3349" href="Ledger.Conway.Conformance.Epoch.html#1129" class="Module">EpochState</a> <a id="3360" href="Ledger.Conway.Conformance.Epoch.html#1511" class="Function">epochState</a><a id="3370" class="Symbol">;</a> <a id="3372" class="Keyword">open</a> <a id="3377" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a> <a id="3388" href="Ledger.Conway.Conformance.Epoch.html#1266" class="Function">es</a>

  <a id="3394" class="Keyword">private</a>
    <a id="3406" href="Ledger.Conway.Conformance.Properties.html#3406" class="Function">ledgerEnv</a> <a id="3416" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Properties.html#3268}{\htmlId{3420}{\htmlClass{Bound}{\text{slot}}}}\, \\ \,\href{Ledger.Conway.Specification.Enact.html#549}{\htmlId{3427}{\htmlClass{Function}{\text{constitution}}}}\, \,\htmlId{3440}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Data.Product.Base.html#636}{\htmlId{3441}{\htmlClass{Field}{\text{proj₁}}}}\, \,\htmlId{3447}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Data.Product.Base.html#650}{\htmlId{3448}{\htmlClass{Field}{\text{proj₂}}}}\, \\ \,\href{Ledger.Conway.Specification.Enact.html#654}{\htmlId{3456}{\htmlClass{Function}{\text{pparams}}}}\, \,\htmlId{3464}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Data.Product.Base.html#636}{\htmlId{3465}{\htmlClass{Field}{\text{proj₁}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#1266}{\htmlId{3473}{\htmlClass{Function}{\text{es}}}}\, \\ \,\href{Ledger.Conway.Specification.PParams.html#773}{\htmlId{3478}{\htmlClass{Field}{\text{Acnt.treasury}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#1193}{\htmlId{3492}{\htmlClass{Function}{\text{acnt}}}}\, \end{pmatrix}$</a>

  <a id="3502" href="Ledger.Conway.Conformance.Properties.html#3502" class="Function">validTxIn₂</a> <a id="3513" class="Symbol">:</a> <a id="3515" href="Ledger.Conway.Specification.Transaction.html#4668" class="Record">Tx</a> <a id="3518" class="Symbol">→</a> <a id="3520" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="3527" href="Ledger.Conway.Conformance.Properties.html#3502" class="Function">validTxIn₂</a> <a id="3538" href="Ledger.Conway.Conformance.Properties.html#3538" class="Bound">tx</a> <a id="3541" class="Symbol">=</a> <a id="3543" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3546" href="Ledger.Conway.Conformance.Properties.html#3546" class="Bound">ls&#39;</a> <a id="3550" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3552" href="Ledger.Conway.Conformance.Properties.html#3406" class="Function">ledgerEnv</a> <a id="3562" href="Ledger.Conway.Conformance.Ledger.html#1110" class="Datatype Operator">⊢</a> <a id="3564" href="Ledger.Conway.Conformance.Epoch.html#1242" class="Function">ls</a> <a id="3567" href="Ledger.Conway.Conformance.Ledger.html#1110" class="Datatype Operator">⇀⦇</a> <a id="3570" href="Ledger.Conway.Conformance.Properties.html#3538" class="Bound">tx</a> <a id="3573" href="Ledger.Conway.Conformance.Ledger.html#1110" class="Datatype Operator">,LEDGER⦈</a> <a id="3582" href="Ledger.Conway.Conformance.Properties.html#3546" class="Bound">ls&#39;</a>

<a id="validTx₁"></a><a id="3587" href="Ledger.Conway.Conformance.Properties.html#3587" class="Function">validTx₁</a> <a id="3596" class="Symbol">:</a> <a id="3598" href="Ledger.Conway.Specification.Transaction.html#4668" class="Record">Tx</a> <a id="3601" class="Symbol">→</a> <a id="3603" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3608" href="Ledger.Conway.Conformance.Properties.html#3587" class="Function">validTx₁</a> <a id="3617" href="Ledger.Conway.Conformance.Properties.html#3617" class="Bound">tx</a> <a id="3620" class="Symbol">=</a> <a id="3622" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3625" href="Ledger.Conway.Conformance.Properties.html#3625" class="Bound">s</a> <a id="3627" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3629" href="Ledger.Conway.Conformance.Properties.html#3153" class="Function">validTxIn₁</a> <a id="3640" href="Ledger.Conway.Conformance.Properties.html#3625" class="Bound">s</a> <a id="3642" href="Ledger.Conway.Conformance.Properties.html#3617" class="Bound">tx</a>

<a id="ChainInvariant"></a><a id="3646" href="Ledger.Conway.Conformance.Properties.html#3646" class="Function">ChainInvariant</a> <a id="3661" class="Symbol">:</a> <a id="3663" class="Symbol">∀</a> <a id="3665" class="Symbol">{</a><a id="3666" href="Ledger.Conway.Conformance.Properties.html#3666" class="Bound">a</a><a id="3667" class="Symbol">}</a> <a id="3669" class="Symbol">→</a> <a id="3671" class="Symbol">(</a><a id="3672" href="Ledger.Conway.Conformance.Chain.html#700" class="Record">ChainState</a> <a id="3683" class="Symbol">→</a> <a id="3685" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3690" href="Ledger.Conway.Conformance.Properties.html#3666" class="Bound">a</a><a id="3691" class="Symbol">)</a> <a id="3693" class="Symbol">→</a> <a id="3695" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3700" href="Ledger.Conway.Conformance.Properties.html#3666" class="Bound">a</a>
<a id="3702" href="Ledger.Conway.Conformance.Properties.html#3646" class="Function">ChainInvariant</a> <a id="3717" href="Ledger.Conway.Conformance.Properties.html#3717" class="Bound">P</a> <a id="3719" class="Symbol">=</a> <a id="3721" class="Symbol">∀</a> <a id="3723" href="Ledger.Conway.Conformance.Properties.html#3723" class="Bound">b</a> <a id="3725" href="Ledger.Conway.Conformance.Properties.html#3725" class="Bound">s</a> <a id="3727" href="Ledger.Conway.Conformance.Properties.html#3727" class="Bound">s&#39;</a> <a id="3730" class="Symbol">→</a> <a id="3732" class="Symbol">_</a> <a id="3734" href="Ledger.Conway.Conformance.Chain.html#2347" class="Datatype Operator">⊢</a> <a id="3736" href="Ledger.Conway.Conformance.Properties.html#3725" class="Bound">s</a> <a id="3738" href="Ledger.Conway.Conformance.Chain.html#2347" class="Datatype Operator">⇀⦇</a> <a id="3741" href="Ledger.Conway.Conformance.Properties.html#3723" class="Bound">b</a> <a id="3743" href="Ledger.Conway.Conformance.Chain.html#2347" class="Datatype Operator">,CHAIN⦈</a> <a id="3751" href="Ledger.Conway.Conformance.Properties.html#3727" class="Bound">s&#39;</a> <a id="3754" class="Symbol">→</a> <a id="3756" href="Ledger.Conway.Conformance.Properties.html#3717" class="Bound">P</a> <a id="3758" href="Ledger.Conway.Conformance.Properties.html#3725" class="Bound">s</a> <a id="3760" class="Symbol">→</a> <a id="3762" href="Ledger.Conway.Conformance.Properties.html#3717" class="Bound">P</a> <a id="3764" href="Ledger.Conway.Conformance.Properties.html#3727" class="Bound">s&#39;</a>

<a id="3768" class="Keyword">module</a> <a id="3775" href="Ledger.Conway.Conformance.Properties.html#3775" class="Module">_</a> <a id="3777" class="Symbol">(</a><a id="3778" href="Ledger.Conway.Conformance.Properties.html#3778" class="Bound">s</a> <a id="3780" class="Symbol">:</a> <a id="3782" href="Ledger.Conway.Conformance.Chain.html#700" class="Record">ChainState</a><a id="3792" class="Symbol">)</a> <a id="3794" class="Keyword">where</a>
  <a id="3802" class="Keyword">open</a> <a id="3807" href="Ledger.Conway.Conformance.Chain.html#700" class="Module">ChainState</a> <a id="3818" href="Ledger.Conway.Conformance.Properties.html#3778" class="Bound">s</a><a id="3819" class="Symbol">;</a> <a id="3821" class="Keyword">open</a> <a id="3826" href="Ledger.Conway.Conformance.Epoch.html#1390" class="Module">NewEpochState</a> <a id="3840" href="Ledger.Conway.Conformance.Chain.html#738" class="Field">newEpochState</a><a id="3853" class="Symbol">;</a> <a id="3855" class="Keyword">open</a> <a id="3860" href="Ledger.Conway.Conformance.Epoch.html#1129" class="Module">EpochState</a> <a id="3871" href="Ledger.Conway.Conformance.Epoch.html#1511" class="Function">epochState</a>
  <a id="3884" class="Keyword">open</a> <a id="3889" href="Ledger.Conway.Conformance.Ledger.html#732" class="Module">LState</a> <a id="3896" href="Ledger.Conway.Conformance.Epoch.html#1242" class="Function">ls</a>
  <a id="3901" class="Keyword">open</a> <a id="3906" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a> <a id="3917" href="Ledger.Conway.Conformance.Epoch.html#1266" class="Function">es</a> <a id="3920" class="Keyword">renaming</a> <a id="3929" class="Symbol">(</a><a id="3930" href="Ledger.Conway.Specification.Enact.html#654" class="Field">pparams</a> <a id="3938" class="Symbol">to</a> <a id="3941" class="Field">pparams&#39;</a><a id="3949" class="Symbol">)</a>
  <a id="3953" class="Keyword">open</a> <a id="3958" href="Ledger.Conway.Conformance.Certs.html#958" class="Module">CertState</a> <a id="3968" href="Ledger.Conway.Conformance.Ledger.html#840" class="Function">certState</a><a id="3977" class="Symbol">;</a> <a id="3979" class="Keyword">open</a> <a id="3984" href="Ledger.Conway.Conformance.Certs.html#604" class="Module">DState</a> <a id="3991" href="Ledger.Conway.Conformance.Certs.html#1017" class="Function">dState</a>
  <a id="4000" href="Ledger.Conway.Conformance.Properties.html#4000" class="Function">pparams</a> <a id="4008" class="Symbol">=</a> <a id="4010" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="4012" href="Ledger.Conway.Conformance.Properties.html#3941" class="Function">pparams&#39;</a> <a id="4021" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a>
  <a id="4025" class="Keyword">open</a> <a id="4030" href="Ledger.Conway.Specification.PParams.html#1687" class="Module">PParams</a> <a id="4038" href="Ledger.Conway.Conformance.Properties.html#4000" class="Function">pparams</a>
  <a id="4048" class="Keyword">open</a> <a id="4053" href="Ledger.Conway.Specification.Transaction.html#4668" class="Module">Tx</a><a id="4055" class="Symbol">;</a> <a id="4057" class="Keyword">open</a> <a id="4062" href="Ledger.Conway.Specification.Transaction.html#2982" class="Module">TxBody</a>

  <a id="4072" class="Comment">-- Transaction properties</a>

  <a id="4101" class="Keyword">module</a> <a id="4108" href="Ledger.Conway.Conformance.Properties.html#4108" class="Module">_</a> <a id="4110" class="Symbol">{</a><a id="4111" href="Ledger.Conway.Conformance.Properties.html#4111" class="Bound">slot</a><a id="4115" class="Symbol">}</a> <a id="4117" class="Symbol">{</a><a id="4118" href="Ledger.Conway.Conformance.Properties.html#4118" class="Bound">tx</a><a id="4120" class="Symbol">}</a> <a id="4122" class="Symbol">(</a><a id="4123" class="Keyword">let</a> <a id="4127" href="Ledger.Conway.Conformance.Properties.html#4127" class="Bound">txb</a> <a id="4131" class="Symbol">=</a> <a id="4133" href="Ledger.Conway.Specification.Transaction.html#4700" class="Field">body</a> <a id="4138" href="Ledger.Conway.Conformance.Properties.html#4118" class="Bound">tx</a><a id="4140" class="Symbol">)</a> <a id="4142" class="Symbol">(</a><a id="4143" href="Ledger.Conway.Conformance.Properties.html#4143" class="Bound">valid</a> <a id="4149" class="Symbol">:</a> <a id="4151" href="Ledger.Conway.Conformance.Properties.html#3502" class="Function">validTxIn₂</a> <a id="4162" href="Ledger.Conway.Conformance.Properties.html#3778" class="Bound">s</a> <a id="4164" href="Ledger.Conway.Conformance.Properties.html#4111" class="Bound">slot</a> <a id="4169" href="Ledger.Conway.Conformance.Properties.html#4118" class="Bound">tx</a><a id="4171" class="Symbol">)</a>
    <a id="4177" class="Symbol">(</a><a id="4178" href="Ledger.Conway.Conformance.Properties.html#4178" class="Bound">indexedSum-∪⁺-hom</a> <a id="4196" class="Symbol">:</a> <a id="4198" class="Symbol">∀</a> <a id="4200" class="Symbol">{</a><a id="4201" href="Ledger.Conway.Conformance.Properties.html#4201" class="Bound">A</a> <a id="4203" href="Ledger.Conway.Conformance.Properties.html#4203" class="Bound">V</a> <a id="4205" class="Symbol">:</a> <a id="4207" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="4211" class="Symbol">}</a> <a id="4213" class="Symbol">⦃</a> <a id="4215" href="Ledger.Conway.Conformance.Properties.html#4215" class="Bound">_</a> <a id="4217" class="Symbol">:</a> <a id="4219" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="4225" href="Ledger.Conway.Conformance.Properties.html#4201" class="Bound">A</a> <a id="4227" class="Symbol">⦄</a> <a id="4229" class="Symbol">⦃</a> <a id="4231" href="Ledger.Conway.Conformance.Properties.html#4231" class="Bound">_</a> <a id="4233" class="Symbol">:</a> <a id="4235" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="4241" href="Ledger.Conway.Conformance.Properties.html#4203" class="Bound">V</a> <a id="4243" class="Symbol">⦄</a> <a id="4245" class="Symbol">⦃</a> <a id="4247" href="Ledger.Conway.Conformance.Properties.html#4247" class="Bound">mon</a> <a id="4251" class="Symbol">:</a> <a id="4253" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="4271" href="Level.html#521" class="Function">0ℓ</a> <a id="4274" href="Level.html#521" class="Function">0ℓ</a> <a id="4277" href="Ledger.Conway.Conformance.Properties.html#4203" class="Bound">V</a> <a id="4279" class="Symbol">⦄</a>
      <a id="4287" class="Symbol">→</a> <a id="4289" class="Symbol">(</a><a id="4290" href="Ledger.Conway.Conformance.Properties.html#4290" class="Bound">d₁</a> <a id="4293" href="Ledger.Conway.Conformance.Properties.html#4293" class="Bound">d₂</a> <a id="4296" class="Symbol">:</a> <a id="4298" href="Ledger.Conway.Conformance.Properties.html#4201" class="Bound">A</a> <a id="4300" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="4302" href="Ledger.Conway.Conformance.Properties.html#4203" class="Bound">V</a><a id="4303" class="Symbol">)</a> <a id="4305" class="Symbol">→</a> <a id="4307" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">indexedSumᵛ&#39;</a> <a id="4320" href="Function.Base.html#704" class="Function">id</a> <a id="4323" class="Symbol">(</a><a id="4324" href="Ledger.Conway.Conformance.Properties.html#4290" class="Bound">d₁</a> <a id="4327" href="Axiom.Set.Map.Dec.html#2149" class="Function Operator">∪⁺</a> <a id="4330" href="Ledger.Conway.Conformance.Properties.html#4293" class="Bound">d₂</a><a id="4332" class="Symbol">)</a> <a id="4334" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4336" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">indexedSumᵛ&#39;</a> <a id="4349" href="Function.Base.html#704" class="Function">id</a> <a id="4352" href="Ledger.Conway.Conformance.Properties.html#4290" class="Bound">d₁</a> <a id="4355" href="Class.Semigroup.Core.html#203" class="Field Operator">◇</a> <a id="4357" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">indexedSumᵛ&#39;</a> <a id="4370" href="Function.Base.html#704" class="Function">id</a> <a id="4373" href="Ledger.Conway.Conformance.Properties.html#4293" class="Bound">d₂</a><a id="4375" class="Symbol">)</a>
    <a id="4381" class="Symbol">(</a><a id="4382" href="Ledger.Conway.Conformance.Properties.html#4382" class="Bound">indexedSum-⊆</a> <a id="4395" class="Symbol">:</a> <a id="4397" class="Symbol">∀</a> <a id="4399" class="Symbol">{</a><a id="4400" href="Ledger.Conway.Conformance.Properties.html#4400" class="Bound">A</a> <a id="4402" class="Symbol">:</a> <a id="4404" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="4408" class="Symbol">}</a> <a id="4410" class="Symbol">⦃</a> <a id="4412" href="Ledger.Conway.Conformance.Properties.html#4412" class="Bound">_</a> <a id="4414" class="Symbol">:</a> <a id="4416" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="4422" href="Ledger.Conway.Conformance.Properties.html#4400" class="Bound">A</a> <a id="4424" class="Symbol">⦄</a> <a id="4426" class="Symbol">(</a><a id="4427" href="Ledger.Conway.Conformance.Properties.html#4427" class="Bound">d</a> <a id="4429" href="Ledger.Conway.Conformance.Properties.html#4429" class="Bound">d&#39;</a> <a id="4432" class="Symbol">:</a> <a id="4434" href="Ledger.Conway.Conformance.Properties.html#4400" class="Bound">A</a> <a id="4436" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="4438" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4439" class="Symbol">)</a> <a id="4441" class="Symbol">→</a> <a id="4443" href="Ledger.Conway.Conformance.Properties.html#4427" class="Bound">d</a> <a id="4445" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a> <a id="4447" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="4449" href="Ledger.Conway.Conformance.Properties.html#4429" class="Bound">d&#39;</a> <a id="4452" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a>
      <a id="4460" class="Symbol">→</a> <a id="4462" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">indexedSumᵛ&#39;</a> <a id="4475" href="Function.Base.html#704" class="Function">id</a> <a id="4478" href="Ledger.Conway.Conformance.Properties.html#4427" class="Bound">d</a> <a id="4480" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="4482" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">indexedSumᵛ&#39;</a> <a id="4495" href="Function.Base.html#704" class="Function">id</a> <a id="4498" href="Ledger.Conway.Conformance.Properties.html#4429" class="Bound">d&#39;</a><a id="4500" class="Symbol">)</a> <a id="4502" class="Comment">-- technically we could use an ordered monoid instead of ℕ</a>
    <a id="4565" class="Keyword">where</a>
    <a id="4575" class="Keyword">open</a> <a id="4580" class="Keyword">import</a> <a id="4587" href="Ledger.Conway.Conformance.Utxow.html" class="Module">Ledger.Conway.Conformance.Utxow</a> <a id="4619" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a> <a id="4623" href="Ledger.Conway.Conformance.Properties.html#235" class="Bound">abs</a>
    <a id="4631" class="Keyword">open</a> <a id="4636" class="Keyword">import</a> <a id="4643" href="Ledger.Conway.Conformance.Utxo.Properties.html" class="Module">Ledger.Conway.Conformance.Utxo.Properties</a> <a id="4685" href="Ledger.Conway.Conformance.Properties.html#172" class="Bound">txs</a> <a id="4689" href="Ledger.Conway.Conformance.Properties.html#235" class="Bound">abs</a>

  <a id="4696" class="Comment">--   propose-ChangePP-hasGroup : ∀ {up prop}</a>
  <a id="4743" class="Comment">--     → prop ∈ txb → prop .GovProposal.action ≡ ChangePParams up → updateGroups up ≢ ∅</a>
  <a id="4833" class="Comment">--   propose-ChangePP-hasGroup = {!!}</a>

  <a id="4874" class="Comment">-- Block properties</a>

  <a id="4897" class="Keyword">module</a> <a id="4904" href="Ledger.Conway.Conformance.Properties.html#4904" class="Module">_</a> <a id="4906" class="Symbol">{</a><a id="4907" href="Ledger.Conway.Conformance.Properties.html#4907" class="Bound">b</a><a id="4908" class="Symbol">}</a> <a id="4910" class="Symbol">(</a><a id="4911" href="Ledger.Conway.Conformance.Properties.html#4911" class="Bound">valid</a> <a id="4917" class="Symbol">:</a> <a id="4919" href="Ledger.Conway.Conformance.Properties.html#1963" class="Function">validBlockIn</a> <a id="4932" href="Ledger.Conway.Conformance.Properties.html#3778" class="Bound">s</a> <a id="4934" href="Ledger.Conway.Conformance.Properties.html#4907" class="Bound">b</a><a id="4935" class="Symbol">)</a> <a id="4937" class="Symbol">(</a><a id="4938" class="Keyword">let</a> <a id="4942" class="Keyword">open</a> <a id="4947" href="Ledger.Conway.Conformance.Chain.html#777" class="Module">Block</a> <a id="4953" href="Ledger.Conway.Conformance.Properties.html#4907" class="Bound">b</a><a id="4954" class="Symbol">)</a> <a id="4956" class="Keyword">where</a>
    <a id="4966" href="Ledger.Conway.Conformance.Properties.html#4966" class="Function">isNewEpochBlock</a> <a id="4982" class="Symbol">:</a> <a id="4984" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="4993" href="Ledger.Conway.Conformance.Properties.html#4966" class="Function">isNewEpochBlock</a> <a id="5009" class="Symbol">=</a> <a id="5011" href="Ledger.Core.Specification.Epoch.html#858" class="Function">epoch</a> <a id="5017" href="Ledger.Conway.Conformance.Chain.html#830" class="Function">slot</a> <a id="5022" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5024" href="Ledger.Core.Specification.Epoch.html#1054" class="Function">sucᵉ</a> <a id="5029" href="Ledger.Conway.Conformance.Epoch.html#1429" class="Function">lastEpoch</a>

    <a id="5044" href="Ledger.Conway.Conformance.Properties.html#5044" class="Function">newChainState</a> <a id="5058" class="Symbol">:</a> <a id="5060" href="Ledger.Conway.Conformance.Chain.html#700" class="Record">ChainState</a>
    <a id="5075" href="Ledger.Conway.Conformance.Properties.html#5044" class="Function">newChainState</a> <a id="5089" class="Symbol">=</a> <a id="5091" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5097" href="Ledger.Conway.Conformance.Properties.html#4911" class="Bound">valid</a>

    <a id="5108" class="Comment">-- enact-change⇒newEpoch : es ≢ getEnactState newChainState → isNewEpochBlock</a>
    <a id="5190" class="Comment">-- enact-change⇒newEpoch = {!!}</a>

  <a id="5225" class="Comment">-- Invariant properties</a>

  <a id="5252" href="Ledger.Conway.Conformance.Properties.html#5252" class="Function">action-deposits≡actions-prop</a> <a id="5281" class="Symbol">:</a> <a id="5283" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5290" href="Ledger.Conway.Conformance.Properties.html#5252" class="Function">action-deposits≡actions-prop</a> <a id="5319" class="Symbol">=</a> <a id="5321" href="abstract-set-theory.FiniteSetTheory.html#2967" class="Function">filterˢ</a> <a id="5329" href="Ledger.Conway.Conformance.Properties.html#1071" class="Function">isGADeposit</a> <a id="5341" class="Symbol">(</a><a id="5342" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5346" class="Symbol">(</a><a id="5347" href="Ledger.Conway.Specification.Utxo.html#1408" class="Field">UTxOState.deposits</a> <a id="5366" href="Ledger.Conway.Conformance.Ledger.html#787" class="Function">utxoSt</a><a id="5372" class="Symbol">))</a>
    <a id="5379" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5381" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="5390" class="Symbol">(</a><a id="5391" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="5395" class="Symbol">(λ</a> <a id="5398" class="Keyword">where</a> <a id="5404" class="Symbol">(</a><a id="5405" href="Ledger.Conway.Conformance.Properties.html#5405" class="Bound">id</a> <a id="5408" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5410" class="Symbol">_)</a> <a id="5413" class="Symbol">→</a> <a id="5415" href="Ledger.Core.Specification.Certs.html#723" class="InductiveConstructor">GovActionDeposit</a> <a id="5432" href="Ledger.Conway.Conformance.Properties.html#5405" class="Bound">id</a><a id="5434" class="Symbol">)</a> <a id="5436" href="Ledger.Conway.Conformance.Ledger.html#814" class="Function">govSt</a><a id="5441" class="Symbol">)</a>

  <a id="5446" href="Ledger.Conway.Conformance.Properties.html#5446" class="Function">dom-rwds≡credDeposits</a> <a id="5468" class="Symbol">:</a> <a id="5470" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5477" href="Ledger.Conway.Conformance.Properties.html#5446" class="Function">dom-rwds≡credDeposits</a> <a id="5499" class="Symbol">=</a> <a id="5501" href="abstract-set-theory.FiniteSetTheory.html#2967" class="Function">filterˢ</a> <a id="5509" href="Ledger.Conway.Conformance.Properties.html#728" class="Function">isCredDeposit</a> <a id="5523" class="Symbol">(</a><a id="5524" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5528" class="Symbol">(</a><a id="5529" href="Ledger.Conway.Specification.Utxo.html#1408" class="Field">UTxOState.deposits</a> <a id="5548" href="Ledger.Conway.Conformance.Ledger.html#787" class="Function">utxoSt</a><a id="5554" class="Symbol">))</a>
    <a id="5561" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5563" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5568" href="Ledger.Core.Specification.Certs.html#564" class="InductiveConstructor">CredentialDeposit</a> <a id="5586" class="Symbol">(</a><a id="5587" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5591" href="Ledger.Conway.Conformance.Certs.html#731" class="Function">rewards</a><a id="5598" class="Symbol">)</a>

  <a id="5603" href="Ledger.Conway.Conformance.Properties.html#5603" class="Function">pp-wellFormed</a> <a id="5617" class="Symbol">:</a> <a id="5619" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5626" href="Ledger.Conway.Conformance.Properties.html#5603" class="Function">pp-wellFormed</a> <a id="5640" class="Symbol">=</a> <a id="5642" href="Ledger.Conway.Specification.PParams.html#4068" class="Function">paramsWellFormed</a> <a id="5659" href="Ledger.Conway.Conformance.Properties.html#4000" class="Function">pparams</a>

<a id="5668" class="Comment">-- action-deposits≡actions-inv : ChainInvariant action-deposits≡actions-prop</a>
<a id="5745" class="Comment">-- action-deposits≡actions-inv = {!!}</a>

<a id="5784" class="Comment">-- dom-rwds≡credDeposits-inv : ChainInvariant dom-rwds≡credDeposits</a>
<a id="5852" class="Comment">-- dom-rwds≡credDeposits-inv = {!!}</a>

<a id="5889" class="Comment">-- pp-wellFormed-inv : ChainInvariant pp-wellFormed</a>
<a id="5941" class="Comment">-- pp-wellFormed-inv = {!!}</a>

<a id="5970" class="Comment">-- Epoch boundary properties</a>

<a id="6000" class="Comment">-- module _ {Γ es e es&#39;} (step : Γ ⊢ es ⇀⦇ e ,NEWEPOCH⦈ es&#39;) where</a>
<a id="6067" class="Comment">--   dom-rwds-const : dom (getRewards es) ≡ dom (getRewards es&#39;)</a>
<a id="6132" class="Comment">--   dom-rwds-const = {!!}</a>

<a id="6160" class="Comment">--   prop≡∅⇒activeDReps-const : getGovState es ≡ [] → activeDReps e es ≡ᵉ activeDReps (sucᵉ e) es&#39;</a>
<a id="6259" class="Comment">--   prop≡∅⇒activeDReps-const = {!!}</a>
</pre></body></html>