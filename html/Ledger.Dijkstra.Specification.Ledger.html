<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Dijkstra.Specification.Ledger</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">import</a> <a id="33" href="Data.List.html" class="Module">Data.List</a> <a id="43" class="Symbol">as</a> <a id="46" class="Module">L</a>

<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="76" class="Keyword">open</a> <a id="81" class="Keyword">import</a> <a id="88" href="Ledger.Dijkstra.Specification.Abstract.html" class="Module">Ledger.Dijkstra.Specification.Abstract</a>
<a id="127" class="Keyword">open</a> <a id="132" class="Keyword">import</a> <a id="139" href="Ledger.Dijkstra.Specification.Transaction.html" class="Module">Ledger.Dijkstra.Specification.Transaction</a> <a id="181" class="Keyword">using</a> <a id="187" class="Symbol">(</a><a id="188" href="Ledger.Dijkstra.Specification.Transaction.html#1279" class="Record">TransactionStructure</a><a id="208" class="Symbol">)</a>

<a id="211" class="Keyword">module</a> <a id="218" href="Ledger.Dijkstra.Specification.Ledger.html" class="Module">Ledger.Dijkstra.Specification.Ledger</a>
  <a id="257" class="Symbol">(</a><a id="258" href="Ledger.Dijkstra.Specification.Ledger.html#258" class="Bound">txs</a> <a id="262" class="Symbol">:</a> <a id="264" class="Symbol">_)</a> <a id="267" class="Symbol">(</a><a id="268" class="Keyword">open</a> <a id="273" href="Ledger.Dijkstra.Specification.Transaction.html#1279" class="Module">TransactionStructure</a> <a id="294" href="Ledger.Dijkstra.Specification.Ledger.html#258" class="Bound">txs</a><a id="297" class="Symbol">)</a>
  <a id="301" class="Symbol">(</a><a id="302" href="Ledger.Dijkstra.Specification.Ledger.html#302" class="Bound">abs</a> <a id="306" class="Symbol">:</a> <a id="308" href="Ledger.Dijkstra.Specification.Abstract.html#912" class="Record">AbstractFunctions</a> <a id="326" href="Ledger.Dijkstra.Specification.Ledger.html#258" class="Bound">txs</a><a id="329" class="Symbol">)</a> <a id="331" class="Symbol">(</a><a id="332" class="Keyword">open</a> <a id="337" href="Ledger.Dijkstra.Specification.Abstract.html#912" class="Module">AbstractFunctions</a> <a id="355" href="Ledger.Dijkstra.Specification.Ledger.html#302" class="Bound">abs</a><a id="358" class="Symbol">)</a>
  <a id="362" class="Keyword">where</a>

<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Ledger.Dijkstra.Specification.Enact.html" class="Module">Ledger.Dijkstra.Specification.Enact</a> <a id="417" href="Ledger.Dijkstra.Specification.Transaction.html#2455" class="Function">govStructure</a>
<a id="430" class="Keyword">open</a> <a id="435" class="Keyword">import</a> <a id="442" href="Ledger.Dijkstra.Specification.Gov.html" class="Module">Ledger.Dijkstra.Specification.Gov</a> <a id="476" href="Ledger.Dijkstra.Specification.Transaction.html#2455" class="Function">govStructure</a>
<a id="489" class="Keyword">open</a> <a id="494" class="Keyword">import</a> <a id="501" href="Ledger.Dijkstra.Specification.Utxo.html" class="Module">Ledger.Dijkstra.Specification.Utxo</a> <a id="536" href="Ledger.Dijkstra.Specification.Ledger.html#258" class="Bound">txs</a> <a id="540" href="Ledger.Dijkstra.Specification.Ledger.html#302" class="Bound">abs</a>
<a id="544" class="Keyword">open</a> <a id="549" class="Keyword">import</a> <a id="556" href="Ledger.Dijkstra.Specification.Utxow.html" class="Module">Ledger.Dijkstra.Specification.Utxow</a> <a id="592" href="Ledger.Dijkstra.Specification.Ledger.html#258" class="Bound">txs</a> <a id="596" href="Ledger.Dijkstra.Specification.Ledger.html#302" class="Bound">abs</a>
<a id="600" class="Keyword">open</a> <a id="605" class="Keyword">import</a> <a id="612" href="Ledger.Dijkstra.Specification.Certs.html" class="Module">Ledger.Dijkstra.Specification.Certs</a> <a id="648" href="Ledger.Dijkstra.Specification.Transaction.html#2455" class="Function">govStructure</a>

<a id="662" class="Keyword">open</a> <a id="667" href="Ledger.Dijkstra.Specification.Enact.html#582" class="Module">EnactState</a> <a id="678" class="Keyword">using</a> <a id="684" class="Symbol">(</a><a id="685" href="Ledger.Dijkstra.Specification.Enact.html#618" class="Field">cc</a><a id="687" class="Symbol">)</a>


<a id="691" class="Keyword">record</a> <a id="SubLedgerEnv"></a><a id="698" href="Ledger.Dijkstra.Specification.Ledger.html#698" class="Record">SubLedgerEnv</a> <a id="711" class="Symbol">:</a> <a id="713" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="718" class="Keyword">where</a>
  <a id="726" class="Keyword">field</a>
    <a id="SubLedgerEnv.slot"></a><a id="736" href="Ledger.Dijkstra.Specification.Ledger.html#736" class="Field">slot</a>        <a id="748" class="Symbol">:</a> <a id="750" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a>
    <a id="SubLedgerEnv.ppolicy"></a><a id="759" href="Ledger.Dijkstra.Specification.Ledger.html#759" class="Field">ppolicy</a>     <a id="771" class="Symbol">:</a> <a id="773" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="779" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
    <a id="SubLedgerEnv.pparams"></a><a id="794" href="Ledger.Dijkstra.Specification.Ledger.html#794" class="Field">pparams</a>     <a id="806" class="Symbol">:</a> <a id="808" href="Ledger.Dijkstra.Specification.PParams.html#1884" class="Record">PParams</a>
    <a id="SubLedgerEnv.enactState"></a><a id="820" href="Ledger.Dijkstra.Specification.Ledger.html#820" class="Field">enactState</a>  <a id="832" class="Symbol">:</a> <a id="834" href="Ledger.Dijkstra.Specification.Enact.html#582" class="Record">EnactState</a>
    <a id="SubLedgerEnv.treasury"></a><a id="849" href="Ledger.Dijkstra.Specification.Ledger.html#849" class="Field">treasury</a>    <a id="861" class="Symbol">:</a> <a id="863" href="Ledger.Prelude.Base.html#200" class="Function">Treasury</a>
    <a id="SubLedgerEnv.utxo₀"></a><a id="876" href="Ledger.Dijkstra.Specification.Ledger.html#876" class="Field">utxo₀</a>            <a id="893" class="Symbol">:</a> <a id="895" href="Ledger.Dijkstra.Specification.Transaction.html#3108" class="Function">UTxO</a>
    <a id="SubLedgerEnv.isTopLevelValid"></a><a id="904" href="Ledger.Dijkstra.Specification.Ledger.html#904" class="Field">isTopLevelValid</a>  <a id="921" class="Symbol">:</a> <a id="923" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
    <a id="SubLedgerEnv.allScripts"></a><a id="932" href="Ledger.Dijkstra.Specification.Ledger.html#932" class="Field">allScripts</a>    <a id="946" class="Symbol">:</a> <a id="948" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="950" href="Ledger.Dijkstra.Specification.Script.Base.html#647" class="Function">P1Script</a> <a id="959" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="961" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="963" href="Ledger.Dijkstra.Specification.Script.Base.html#2379" class="Function">P2Script</a>
    <a id="SubLedgerEnv.allData"></a><a id="976" href="Ledger.Dijkstra.Specification.Ledger.html#976" class="Field">allData</a>       <a id="990" class="Symbol">:</a> <a id="992" href="Ledger.Dijkstra.Specification.Script.Base.html#1735" class="Function">DataHash</a> <a id="1001" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1003" href="Ledger.Dijkstra.Specification.Script.Base.html#1782" class="Function">Datum</a>

<a id="1010" class="Keyword">record</a> <a id="LedgerEnv"></a><a id="1017" href="Ledger.Dijkstra.Specification.Ledger.html#1017" class="Record">LedgerEnv</a> <a id="1027" class="Symbol">:</a> <a id="1029" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1034" class="Keyword">where</a>
  <a id="1042" class="Keyword">field</a>
    <a id="LedgerEnv.slot"></a><a id="1052" href="Ledger.Dijkstra.Specification.Ledger.html#1052" class="Field">slot</a>        <a id="1064" class="Symbol">:</a> <a id="1066" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a>
    <a id="LedgerEnv.ppolicy"></a><a id="1075" href="Ledger.Dijkstra.Specification.Ledger.html#1075" class="Field">ppolicy</a>     <a id="1087" class="Symbol">:</a> <a id="1089" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1095" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
    <a id="LedgerEnv.pparams"></a><a id="1110" href="Ledger.Dijkstra.Specification.Ledger.html#1110" class="Field">pparams</a>     <a id="1122" class="Symbol">:</a> <a id="1124" href="Ledger.Dijkstra.Specification.PParams.html#1884" class="Record">PParams</a>
    <a id="LedgerEnv.enactState"></a><a id="1136" href="Ledger.Dijkstra.Specification.Ledger.html#1136" class="Field">enactState</a>  <a id="1148" class="Symbol">:</a> <a id="1150" href="Ledger.Dijkstra.Specification.Enact.html#582" class="Record">EnactState</a>
    <a id="LedgerEnv.treasury"></a><a id="1165" href="Ledger.Dijkstra.Specification.Ledger.html#1165" class="Field">treasury</a>    <a id="1177" class="Symbol">:</a> <a id="1179" href="Ledger.Prelude.Base.html#200" class="Function">Treasury</a>


<a id="1190" class="Keyword">instance</a>
  <a id="1201" class="Keyword">unquoteDecl</a> <a id="HasCast-LedgerEnv"></a><a id="1213" href="Ledger.Dijkstra.Specification.Ledger.html#1213" class="Function">HasCast-LedgerEnv</a> <a id="HasCast-SubLedgerEnv"></a><a id="1231" href="Ledger.Dijkstra.Specification.Ledger.html#1231" class="Function">HasCast-SubLedgerEnv</a> <a id="1252" class="Symbol">=</a> <a id="1254" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="1273" class="Symbol">((</a><a id="1275" class="Keyword">quote</a> <a id="1281" href="Ledger.Dijkstra.Specification.Ledger.html#1017" class="Record">LedgerEnv</a> <a id="1291" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1293" href="Ledger.Dijkstra.Specification.Ledger.html#1213" class="Function">HasCast-LedgerEnv</a><a id="1310" class="Symbol">)</a> <a id="1312" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1314" class="Symbol">(</a><a id="1315" class="Keyword">quote</a> <a id="1321" href="Ledger.Dijkstra.Specification.Ledger.html#698" class="Record">SubLedgerEnv</a> <a id="1334" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1336" href="Ledger.Dijkstra.Specification.Ledger.html#1231" class="Function">HasCast-SubLedgerEnv</a><a id="1356" class="Symbol">)</a> <a id="1358" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1360" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1362" class="Symbol">)</a>

  <a id="HasPParams-LedgerEnv"></a><a id="1367" href="Ledger.Dijkstra.Specification.Ledger.html#1367" class="Function">HasPParams-LedgerEnv</a> <a id="1388" class="Symbol">:</a> <a id="1390" href="Ledger.Dijkstra.Specification.PParams.html#4274" class="Record">HasPParams</a> <a id="1401" href="Ledger.Dijkstra.Specification.Ledger.html#1017" class="Record">LedgerEnv</a>
  <a id="1413" href="Ledger.Dijkstra.Specification.Ledger.html#1367" class="Function">HasPParams-LedgerEnv</a> <a id="1434" class="Symbol">.</a><a id="1435" href="Ledger.Dijkstra.Specification.PParams.html#4325" class="Field">PParamsOf</a> <a id="1445" class="Symbol">=</a> <a id="1447" href="Ledger.Dijkstra.Specification.Ledger.html#1110" class="Field">LedgerEnv.pparams</a>

  <a id="HasPParams-SubLedgerEnv"></a><a id="1468" href="Ledger.Dijkstra.Specification.Ledger.html#1468" class="Function">HasPParams-SubLedgerEnv</a> <a id="1492" class="Symbol">:</a> <a id="1494" href="Ledger.Dijkstra.Specification.PParams.html#4274" class="Record">HasPParams</a> <a id="1505" href="Ledger.Dijkstra.Specification.Ledger.html#1017" class="Record">LedgerEnv</a>
  <a id="1517" href="Ledger.Dijkstra.Specification.Ledger.html#1468" class="Function">HasPParams-SubLedgerEnv</a> <a id="1541" class="Symbol">.</a><a id="1542" href="Ledger.Dijkstra.Specification.PParams.html#4325" class="Field">PParamsOf</a> <a id="1552" class="Symbol">=</a> <a id="1554" href="Ledger.Dijkstra.Specification.Ledger.html#1110" class="Field">LedgerEnv.pparams</a>


<a id="1574" class="Keyword">record</a> <a id="LState"></a><a id="1581" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a> <a id="1588" class="Symbol">:</a> <a id="1590" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1595" class="Keyword">where</a>


  <a id="1605" class="Keyword">constructor</a> <a id="⟦_,_,_⟧ˡ"></a><a id="1617" href="Ledger.Dijkstra.Specification.Ledger.html#1617" class="InductiveConstructor Operator">⟦_,_,_⟧ˡ</a>


  <a id="1630" class="Keyword">field</a>
    <a id="LState.utxoSt"></a><a id="1640" href="Ledger.Dijkstra.Specification.Ledger.html#1640" class="Field">utxoSt</a>     <a id="1651" class="Symbol">:</a> <a id="1653" href="Ledger.Dijkstra.Specification.Utxo.html#725" class="Record">UTxOState</a>
    <a id="LState.govSt"></a><a id="1667" href="Ledger.Dijkstra.Specification.Ledger.html#1667" class="Field">govSt</a>      <a id="1678" class="Symbol">:</a> <a id="1680" href="Ledger.Dijkstra.Specification.Gov.html#1510" class="Function">GovState</a>
    <a id="LState.certState"></a><a id="1693" href="Ledger.Dijkstra.Specification.Ledger.html#1693" class="Field">certState</a>  <a id="1704" class="Symbol">:</a> <a id="1706" href="Ledger.Dijkstra.Specification.Certs.html#3352" class="Record">CertState</a>


<a id="1718" class="Keyword">record</a> <a id="HasLState"></a><a id="1725" href="Ledger.Dijkstra.Specification.Ledger.html#1725" class="Record">HasLState</a> <a id="1735" class="Symbol">{</a><a id="1736" href="Ledger.Dijkstra.Specification.Ledger.html#1736" class="Bound">a</a><a id="1737" class="Symbol">}</a> <a id="1739" class="Symbol">(</a><a id="1740" href="Ledger.Dijkstra.Specification.Ledger.html#1740" class="Bound">A</a> <a id="1742" class="Symbol">:</a> <a id="1744" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1749" href="Ledger.Dijkstra.Specification.Ledger.html#1736" class="Bound">a</a><a id="1750" class="Symbol">)</a> <a id="1752" class="Symbol">:</a> <a id="1754" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1759" href="Ledger.Dijkstra.Specification.Ledger.html#1736" class="Bound">a</a> <a id="1761" class="Keyword">where</a>
  <a id="1769" class="Keyword">field</a> <a id="HasLState.LStateOf"></a><a id="1775" href="Ledger.Dijkstra.Specification.Ledger.html#1775" class="Field">LStateOf</a> <a id="1784" class="Symbol">:</a> <a id="1786" href="Ledger.Dijkstra.Specification.Ledger.html#1740" class="Bound">A</a> <a id="1788" class="Symbol">→</a> <a id="1790" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a>
<a id="1797" class="Keyword">open</a> <a id="1802" href="Ledger.Dijkstra.Specification.Ledger.html#1725" class="Module">HasLState</a> <a id="1812" class="Symbol">⦃...⦄</a> <a id="1818" class="Keyword">public</a>

<a id="1826" class="Comment">-- instance</a>
<a id="1838" class="Comment">--   HasUTxOState-LState : HasUTxOState LState</a>
<a id="1885" class="Comment">--   HasUTxOState-LState .UTxOStateOf = LState.utxoSt</a>

<a id="1940" class="Comment">--   HasUTxO-LState : HasUTxO LState</a>
<a id="1977" class="Comment">--   HasUTxO-LState .UTxOOf = UTxOOf ∘ UTxOStateOf</a>

<a id="2029" class="Comment">--   HasGovState-LState : HasGovState LState</a>
<a id="2074" class="Comment">--   HasGovState-LState .GovStateOf = LState.govSt</a>

<a id="2126" class="Comment">--   HasCertState-LState : HasCertState LState</a>
<a id="2173" class="Comment">--   HasCertState-LState .CertStateOf = LState.certState</a>

<a id="2231" class="Comment">--   HasDeposits-LState : HasDeposits LState</a>
<a id="2276" class="Comment">--   HasDeposits-LState .DepositsOf = DepositsOf ∘ UTxOStateOf</a>

<a id="2340" class="Comment">--   HasPools-LState : HasPools LState</a>
<a id="2379" class="Comment">--   HasPools-LState .PoolsOf = PoolsOf ∘ CertStateOf</a>

<a id="2434" class="Comment">--   HasGState-LState : HasGState LState</a>
<a id="2475" class="Comment">--   HasGState-LState .GStateOf = GStateOf ∘ CertStateOf</a>

<a id="2533" class="Comment">--   HasDState-LState : HasDState LState</a>
<a id="2574" class="Comment">--   HasDState-LState .DStateOf = DStateOf ∘ CertStateOf</a>

<a id="2632" class="Comment">--   HasPState-LState : HasPState LState</a>
<a id="2673" class="Comment">--   HasPState-LState .PStateOf = PStateOf ∘ CertStateOf</a>

<a id="2731" class="Comment">--   HasVoteDelegs-LState : HasVoteDelegs LState</a>
<a id="2780" class="Comment">--   HasVoteDelegs-LState .VoteDelegsOf = VoteDelegsOf ∘ DStateOf ∘ CertStateOf</a>

<a id="2861" class="Comment">--   HasDonations-LState : HasDonations LState</a>
<a id="2908" class="Comment">--   HasDonations-LState .DonationsOf = DonationsOf ∘ UTxOStateOf</a>

<a id="2975" class="Comment">--   HasFees-LState : HasFees LState</a>
<a id="3012" class="Comment">--   HasFees-LState .FeesOf = FeesOf ∘ UTxOStateOf</a>

<a id="3064" class="Comment">--   HasCCHotKeys-LState : HasCCHotKeys LState</a>
<a id="3111" class="Comment">--   HasCCHotKeys-LState .CCHotKeysOf = CCHotKeysOf ∘ GStateOf</a>

<a id="3175" class="Comment">--   HasDReps-LState : HasDReps LState</a>
<a id="3214" class="Comment">--   HasDReps-LState .DRepsOf = DRepsOf ∘ CertStateOf</a>

<a id="3269" class="Comment">-- open CertState</a>
<a id="3287" class="Comment">-- open DState</a>
<a id="3302" class="Comment">-- open GovVotes</a>

<a id="3320" class="Keyword">instance</a>
  <a id="3331" class="Keyword">unquoteDecl</a> <a id="HasCast-LState"></a><a id="3343" href="Ledger.Dijkstra.Specification.Ledger.html#3343" class="Function">HasCast-LState</a> <a id="3358" class="Symbol">=</a> <a id="3360" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="3379" class="Symbol">((</a><a id="3381" class="Keyword">quote</a> <a id="3387" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a> <a id="3394" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3396" href="Ledger.Dijkstra.Specification.Ledger.html#3343" class="Function">HasCast-LState</a><a id="3410" class="Symbol">)</a> <a id="3412" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3414" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3416" class="Symbol">)</a>


<a id="txgov"></a><a id="3420" href="Ledger.Dijkstra.Specification.Ledger.html#3420" class="Function">txgov</a> <a id="3426" class="Symbol">:</a> <a id="3428" class="Symbol">∀</a> <a id="3430" class="Symbol">{</a><a id="3431" href="Ledger.Dijkstra.Specification.Ledger.html#3431" class="Bound">ℓ</a><a id="3432" class="Symbol">}</a> <a id="3434" class="Symbol">→</a> <a id="3436" href="Ledger.Dijkstra.Specification.Transaction.html#3719" class="Record">TxBody</a> <a id="3443" href="Ledger.Dijkstra.Specification.Ledger.html#3431" class="Bound">ℓ</a> <a id="3445" class="Symbol">→</a> <a id="3447" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3452" class="Symbol">(</a><a id="3453" href="Ledger.Dijkstra.Specification.Gov.Actions.html#1858" class="Record">GovVote</a> <a id="3461" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3463" href="Ledger.Dijkstra.Specification.Gov.Actions.html#2849" class="Record">GovProposal</a><a id="3474" class="Symbol">)</a>
<a id="3476" href="Ledger.Dijkstra.Specification.Ledger.html#3420" class="Function">txgov</a> <a id="3482" href="Ledger.Dijkstra.Specification.Ledger.html#3482" class="Bound">txb</a> <a id="3486" class="Symbol">=</a> <a id="3488" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3492" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3497" href="Ledger.Dijkstra.Specification.Transaction.html#4332" class="Field">txGovProposals</a> <a id="3512" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="3515" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3519" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3524" href="Ledger.Dijkstra.Specification.Transaction.html#4288" class="Field">txGovVotes</a>
  <a id="3537" class="Keyword">where</a> <a id="3543" class="Keyword">open</a> <a id="3548" href="Ledger.Dijkstra.Specification.Transaction.html#3719" class="Module">TxBody</a> <a id="3555" href="Ledger.Dijkstra.Specification.Ledger.html#3482" class="Bound">txb</a>

<a id="GovProposals+Votes"></a><a id="3560" href="Ledger.Dijkstra.Specification.Ledger.html#3560" class="Function">GovProposals+Votes</a> <a id="3579" class="Symbol">:</a> <a id="3581" class="Symbol">∀</a> <a id="3583" class="Symbol">{</a><a id="3584" href="Ledger.Dijkstra.Specification.Ledger.html#3584" class="Bound">ℓ</a><a id="3585" class="Symbol">}</a> <a id="3587" class="Symbol">→</a> <a id="3589" href="Ledger.Dijkstra.Specification.Transaction.html#3472" class="Record">Tx</a> <a id="3592" href="Ledger.Dijkstra.Specification.Ledger.html#3584" class="Bound">ℓ</a> <a id="3594" class="Symbol">→</a> <a id="3596" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3601" class="Symbol">(</a><a id="3602" href="Ledger.Dijkstra.Specification.Gov.Actions.html#1858" class="Record">GovVote</a> <a id="3610" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3612" href="Ledger.Dijkstra.Specification.Gov.Actions.html#2849" class="Record">GovProposal</a><a id="3623" class="Symbol">)</a>
<a id="3625" href="Ledger.Dijkstra.Specification.Ledger.html#3560" class="Function">GovProposals+Votes</a> <a id="3644" href="Ledger.Dijkstra.Specification.Ledger.html#3644" class="Bound">tx</a> <a id="3647" class="Symbol">=</a> <a id="3649" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3653" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3658" class="Symbol">(</a><a id="3659" href="Ledger.Dijkstra.Specification.Transaction.html#7831" class="Field">ListOfGovProposalsOf</a> <a id="3680" href="Ledger.Dijkstra.Specification.Ledger.html#3644" class="Bound">tx</a><a id="3682" class="Symbol">)</a> <a id="3684" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="3687" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3691" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3696" class="Symbol">(</a><a id="3697" href="Ledger.Dijkstra.Specification.Transaction.html#7987" class="Field">ListOfGovVotesOf</a> <a id="3714" href="Ledger.Dijkstra.Specification.Ledger.html#3644" class="Bound">tx</a><a id="3716" class="Symbol">)</a>

<a id="rmOrphanDRepVotes"></a><a id="3719" href="Ledger.Dijkstra.Specification.Ledger.html#3719" class="Function">rmOrphanDRepVotes</a> <a id="3737" class="Symbol">:</a> <a id="3739" href="Ledger.Dijkstra.Specification.Certs.html#3352" class="Record">CertState</a> <a id="3749" class="Symbol">→</a> <a id="3751" href="Ledger.Dijkstra.Specification.Gov.html#1510" class="Function">GovState</a> <a id="3760" class="Symbol">→</a> <a id="3762" href="Ledger.Dijkstra.Specification.Gov.html#1510" class="Function">GovState</a>
<a id="3771" href="Ledger.Dijkstra.Specification.Ledger.html#3719" class="Function">rmOrphanDRepVotes</a> <a id="3789" href="Ledger.Dijkstra.Specification.Ledger.html#3789" class="Bound">cs</a> <a id="3792" href="Ledger.Dijkstra.Specification.Ledger.html#3792" class="Bound">govSt</a> <a id="3798" class="Symbol">=</a> <a id="3800" href="Data.List.Base.html#1612" class="Function">L.map</a> <a id="3806" class="Symbol">(</a><a id="3807" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="3812" href="Ledger.Dijkstra.Specification.Ledger.html#3919" class="Function">go</a><a id="3814" class="Symbol">)</a> <a id="3816" href="Ledger.Dijkstra.Specification.Ledger.html#3792" class="Bound">govSt</a>
  <a id="3824" class="Keyword">where</a>
   <a id="3833" href="Ledger.Dijkstra.Specification.Ledger.html#3833" class="Function">ifDRepRegistered</a> <a id="3850" class="Symbol">:</a> <a id="3852" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="3863" class="Symbol">→</a> <a id="3865" href="Agda.Primitive.html#388" class="Primitive">Type</a>
   <a id="3873" href="Ledger.Dijkstra.Specification.Ledger.html#3833" class="Function">ifDRepRegistered</a> <a id="3890" href="Ledger.Dijkstra.Specification.Ledger.html#3890" class="Bound">c</a> <a id="3892" class="Symbol">=</a> <a id="3894" href="Ledger.Dijkstra.Specification.Ledger.html#3890" class="Bound">c</a> <a id="3896" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="3898" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3902" class="Symbol">(</a><a id="3903" href="Ledger.Dijkstra.Specification.Gov.Actions.html#4927" class="Field">DRepsOf</a> <a id="3911" href="Ledger.Dijkstra.Specification.Ledger.html#3789" class="Bound">cs</a><a id="3913" class="Symbol">)</a>

   <a id="3919" href="Ledger.Dijkstra.Specification.Ledger.html#3919" class="Function">go</a> <a id="3922" class="Symbol">:</a> <a id="3924" href="Ledger.Dijkstra.Specification.Gov.Actions.html#3406" class="Record">GovActionState</a> <a id="3939" class="Symbol">→</a> <a id="3941" href="Ledger.Dijkstra.Specification.Gov.Actions.html#3406" class="Record">GovActionState</a>
   <a id="3959" href="Ledger.Dijkstra.Specification.Ledger.html#3919" class="Function">go</a> <a id="3962" href="Ledger.Dijkstra.Specification.Ledger.html#3962" class="Bound">gas</a> <a id="3966" class="Symbol">=</a> <a id="3968" class="Keyword">record</a> <a id="3975" href="Ledger.Dijkstra.Specification.Ledger.html#3962" class="Bound">gas</a> <a id="3979" class="Symbol">{</a> <a id="3981" href="Ledger.Dijkstra.Specification.Gov.Actions.html#3446" class="Field">votes</a> <a id="3987" class="Symbol">=</a> <a id="3989" class="Keyword">record</a> <a id="3996" class="Symbol">(</a><a id="3997" href="Ledger.Dijkstra.Specification.Gov.Actions.html#4606" class="Field">GovVotesOf</a> <a id="4008" href="Ledger.Dijkstra.Specification.Ledger.html#3962" class="Bound">gas</a><a id="4011" class="Symbol">)</a> <a id="4013" class="Symbol">{</a> <a id="4015" href="Ledger.Dijkstra.Specification.Gov.Actions.html#2139" class="Field">gvDRep</a> <a id="4022" class="Symbol">=</a> <a id="4024" href="abstract-set-theory.FiniteSetTheory.html#4196" class="Function">filterKeys</a> <a id="4035" href="Ledger.Dijkstra.Specification.Ledger.html#3833" class="Function">ifDRepRegistered</a> <a id="4052" class="Symbol">(</a><a id="4053" href="Ledger.Dijkstra.Specification.Gov.Actions.html#2139" class="Field">GovVotes.gvDRep</a> <a id="4069" class="Symbol">(</a><a id="4070" href="Ledger.Dijkstra.Specification.Gov.Actions.html#4606" class="Field">GovVotesOf</a> <a id="4081" href="Ledger.Dijkstra.Specification.Ledger.html#3962" class="Bound">gas</a><a id="4084" class="Symbol">))</a> <a id="4087" class="Symbol">}</a> <a id="4089" class="Symbol">}</a>

<a id="allColdCreds"></a><a id="4092" href="Ledger.Dijkstra.Specification.Ledger.html#4092" class="Function">allColdCreds</a> <a id="4105" class="Symbol">:</a> <a id="4107" href="Ledger.Dijkstra.Specification.Gov.html#1510" class="Function">GovState</a> <a id="4116" class="Symbol">→</a> <a id="4118" href="Ledger.Dijkstra.Specification.Enact.html#582" class="Record">EnactState</a> <a id="4129" class="Symbol">→</a> <a id="4131" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="4133" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
<a id="4144" href="Ledger.Dijkstra.Specification.Ledger.html#4092" class="Function">allColdCreds</a> <a id="4157" href="Ledger.Dijkstra.Specification.Ledger.html#4157" class="Bound">govSt</a> <a id="4163" href="Ledger.Dijkstra.Specification.Ledger.html#4163" class="Bound">es</a> <a id="4166" class="Symbol">=</a>
  <a id="4170" href="Ledger.Dijkstra.Specification.Enact.html#1500" class="Function">ccCreds</a> <a id="4178" class="Symbol">(</a><a id="4179" href="Ledger.Dijkstra.Specification.Ledger.html#4163" class="Bound">es</a> <a id="4182" class="Symbol">.</a><a id="4183" href="Ledger.Dijkstra.Specification.Enact.html#618" class="Field">cc</a><a id="4185" class="Symbol">)</a> <a id="4187" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="4189" href="Axiom.Set.html#7207" class="Function">concatMapˢ</a> <a id="4200" class="Symbol">(λ</a> <a id="4203" class="Symbol">(_</a> <a id="4206" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4208" href="Ledger.Dijkstra.Specification.Ledger.html#4208" class="Bound">st</a><a id="4210" class="Symbol">)</a> <a id="4212" class="Symbol">→</a> <a id="4214" href="Ledger.Dijkstra.Specification.Gov.Actions.html#3914" class="Function">proposedCC</a> <a id="4225" class="Symbol">(</a><a id="4226" href="Ledger.Dijkstra.Specification.Gov.Actions.html#4371" class="Field">GovActionOf</a> <a id="4238" href="Ledger.Dijkstra.Specification.Ledger.html#4208" class="Bound">st</a><a id="4240" class="Symbol">))</a> <a id="4243" class="Symbol">(</a><a id="4244" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="4253" href="Ledger.Dijkstra.Specification.Ledger.html#4157" class="Bound">govSt</a><a id="4258" class="Symbol">)</a>


<a id="4262" class="Keyword">private</a> <a id="4270" class="Keyword">variable</a>
  <a id="4281" href="Ledger.Dijkstra.Specification.Ledger.html#4281" class="Generalizable">Γ</a>                     <a id="4303" class="Symbol">:</a> <a id="4305" href="Ledger.Dijkstra.Specification.Ledger.html#1017" class="Record">LedgerEnv</a>
  <a id="4317" href="Ledger.Dijkstra.Specification.Ledger.html#4317" class="Generalizable">s</a> <a id="4319" href="Ledger.Dijkstra.Specification.Ledger.html#4319" class="Generalizable">s&#39;</a> <a id="4322" href="Ledger.Dijkstra.Specification.Ledger.html#4322" class="Generalizable">s&#39;&#39;</a>              <a id="4339" class="Symbol">:</a> <a id="4341" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a>
  <a id="4350" href="Ledger.Dijkstra.Specification.Ledger.html#4350" class="Generalizable">utxoState</a> <a id="4360" href="Ledger.Dijkstra.Specification.Ledger.html#4360" class="Generalizable">utxoState&#39;</a>  <a id="4372" class="Symbol">:</a> <a id="4374" href="Ledger.Dijkstra.Specification.Utxo.html#725" class="Record">UTxOState</a>
  <a id="4386" href="Ledger.Dijkstra.Specification.Ledger.html#4386" class="Generalizable">utxo₀</a>                 <a id="4408" class="Symbol">:</a> <a id="4410" href="Ledger.Dijkstra.Specification.Transaction.html#3108" class="Function">UTxO</a>
  <a id="4417" href="Ledger.Dijkstra.Specification.Ledger.html#4417" class="Generalizable">govState</a> <a id="4426" href="Ledger.Dijkstra.Specification.Ledger.html#4426" class="Generalizable">govState&#39;</a>    <a id="4439" class="Symbol">:</a> <a id="4441" href="Ledger.Dijkstra.Specification.Gov.html#1510" class="Function">GovState</a>
  <a id="4452" href="Ledger.Dijkstra.Specification.Ledger.html#4452" class="Generalizable">certState</a> <a id="4462" href="Ledger.Dijkstra.Specification.Ledger.html#4462" class="Generalizable">certState&#39;</a>  <a id="4474" class="Symbol">:</a> <a id="4476" href="Ledger.Dijkstra.Specification.Certs.html#3352" class="Record">CertState</a>
  <a id="4488" href="Ledger.Dijkstra.Specification.Ledger.html#4488" class="Generalizable">stx</a>                   <a id="4510" class="Symbol">:</a> <a id="4512" href="Ledger.Dijkstra.Specification.Transaction.html#5285" class="Function">SubLevelTx</a>
  <a id="4525" href="Ledger.Dijkstra.Specification.Ledger.html#4525" class="Generalizable">slot</a>                  <a id="4547" class="Symbol">:</a> <a id="4549" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a>
  <a id="4556" href="Ledger.Dijkstra.Specification.Ledger.html#4556" class="Generalizable">ppolicy</a>               <a id="4578" class="Symbol">:</a> <a id="4580" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4586" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
  <a id="4599" href="Ledger.Dijkstra.Specification.Ledger.html#4599" class="Generalizable">pp</a>                    <a id="4621" class="Symbol">:</a> <a id="4623" href="Ledger.Dijkstra.Specification.PParams.html#1884" class="Record">PParams</a>
  <a id="4633" href="Ledger.Dijkstra.Specification.Ledger.html#4633" class="Generalizable">enactState</a>            <a id="4655" class="Symbol">:</a> <a id="4657" href="Ledger.Dijkstra.Specification.Enact.html#582" class="Record">EnactState</a>
  <a id="4670" href="Ledger.Dijkstra.Specification.Ledger.html#4670" class="Generalizable">treasury</a>              <a id="4692" class="Symbol">:</a> <a id="4694" href="Ledger.Prelude.Base.html#200" class="Function">Treasury</a>
  <a id="4705" href="Ledger.Dijkstra.Specification.Ledger.html#4705" class="Generalizable">isTopLevelValid</a>       <a id="4727" class="Symbol">:</a> <a id="4729" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="4736" href="Ledger.Dijkstra.Specification.Ledger.html#4736" class="Generalizable">allScripts</a>         <a id="4755" class="Symbol">:</a> <a id="4757" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="4759" href="Ledger.Dijkstra.Specification.Script.Base.html#647" class="Function">P1Script</a> <a id="4768" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4770" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="4772" href="Ledger.Dijkstra.Specification.Script.Base.html#2379" class="Function">P2Script</a>
  <a id="4783" href="Ledger.Dijkstra.Specification.Ledger.html#4783" class="Generalizable">allData</a>            <a id="4802" class="Symbol">:</a> <a id="4804" href="Ledger.Dijkstra.Specification.Script.Base.html#1735" class="Function">DataHash</a> <a id="4813" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="4815" href="Ledger.Dijkstra.Specification.Script.Base.html#1782" class="Function">Datum</a>


<a id="4823" class="Keyword">data</a> <a id="_⊢_⇀⦇_,SUBLEDGER⦈_"></a><a id="4828" href="Ledger.Dijkstra.Specification.Ledger.html#4828" class="Datatype Operator">_⊢_⇀⦇_,SUBLEDGER⦈_</a> <a id="4847" class="Symbol">:</a> <a id="4849" href="Ledger.Dijkstra.Specification.Ledger.html#698" class="Record">SubLedgerEnv</a> <a id="4862" class="Symbol">→</a> <a id="4864" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a> <a id="4871" class="Symbol">→</a> <a id="4873" href="Ledger.Dijkstra.Specification.Transaction.html#5285" class="Function">SubLevelTx</a> <a id="4884" class="Symbol">→</a> <a id="4886" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a> <a id="4893" class="Symbol">→</a> <a id="4895" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4900" class="Keyword">where</a>
  <a id="_⊢_⇀⦇_,SUBLEDGER⦈_.SUBLEDGER-V"></a><a id="4908" href="Ledger.Dijkstra.Specification.Ledger.html#4908" class="InductiveConstructor">SUBLEDGER-V</a> <a id="4920" class="Symbol">:</a>
      <a id="4928" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="4930" href="Ledger.Dijkstra.Specification.Ledger.html#4705" class="Generalizable">isTopLevelValid</a> <a id="4946" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4948" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
      <a id="4959" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{4963}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{4970}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{4975}{\htmlClass{Generalizable}{\text{treasury}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4386}{\htmlId{4986}{\htmlClass{Generalizable}{\text{utxo₀}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4705}{\htmlId{4994}{\htmlClass{Generalizable}{\text{isTopLevelValid}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4736}{\htmlId{5012}{\htmlClass{Generalizable}{\text{allScripts}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4783}{\htmlId{5025}{\htmlClass{Generalizable}{\text{allData}}}}\, \end{pmatrix}$</a>  <a id="5036" href="Ledger.Dijkstra.Specification.Utxow.html#700" class="Datatype Operator">⊢</a> <a id="5038" href="Ledger.Dijkstra.Specification.Ledger.html#4350" class="Generalizable">utxoState</a> <a id="5048" href="Ledger.Dijkstra.Specification.Utxow.html#700" class="Datatype Operator">⇀⦇</a> <a id="5051" href="Ledger.Dijkstra.Specification.Ledger.html#4488" class="Generalizable">stx</a> <a id="5055" href="Ledger.Dijkstra.Specification.Utxow.html#700" class="Datatype Operator">,SUBUTXOW⦈</a> <a id="5066" href="Ledger.Dijkstra.Specification.Ledger.html#4360" class="Generalizable">utxoState&#39;</a>
      <a id="5083" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Core.Specification.Epoch.html#858}{\htmlId{5087}{\htmlClass{Function}{\text{epoch}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{5093}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{5100}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Transaction.html#7987}{\htmlId{5105}{\htmlClass{Field}{\text{ListOfGovVotesOf}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4488}{\htmlId{5122}{\htmlClass{Generalizable}{\text{stx}}}}\, \\ \,\href{Ledger.Core.Specification.Address.html#1700}{\htmlId{5128}{\htmlClass{Field}{\text{WithdrawalsOf}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4488}{\htmlId{5142}{\htmlClass{Generalizable}{\text{stx}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4092}{\htmlId{5148}{\htmlClass{Function}{\text{allColdCreds}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{5161}{\htmlClass{Generalizable}{\text{govState}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{5170}{\htmlClass{Generalizable}{\text{enactState}}}}\, \end{pmatrix}$</a> <a id="5183" href="Ledger.Dijkstra.Specification.Certs.html#12707" class="Function Operator">⊢</a> <a id="5185" href="Ledger.Dijkstra.Specification.Ledger.html#4452" class="Generalizable">certState</a> <a id="5195" href="Ledger.Dijkstra.Specification.Certs.html#12707" class="Function Operator">⇀⦇</a> <a id="5198" href="Ledger.Dijkstra.Specification.Transaction.html#7592" class="Field">DCertsOf</a> <a id="5207" href="Ledger.Dijkstra.Specification.Ledger.html#4488" class="Generalizable">stx</a> <a id="5211" href="Ledger.Dijkstra.Specification.Certs.html#12707" class="Function Operator">,CERTS⦈</a> <a id="5219" href="Ledger.Dijkstra.Specification.Ledger.html#4462" class="Generalizable">certState&#39;</a>
      <a id="5236" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Transaction.html#6726}{\htmlId{5240}{\htmlClass{Field}{\text{TxIdOf}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4488}{\htmlId{5247}{\htmlClass{Generalizable}{\text{stx}}}}\, \\ \,\href{Ledger.Core.Specification.Epoch.html#858}{\htmlId{5253}{\htmlClass{Function}{\text{epoch}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{5259}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{5266}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4556}{\htmlId{5271}{\htmlClass{Generalizable}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{5281}{\htmlClass{Generalizable}{\text{enactState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4462}{\htmlId{5294}{\htmlClass{Generalizable}{\text{certState&#39;}}}}\, \\ \,\href{Class.IsSet.html#916}{\htmlId{5307}{\htmlClass{Function}{\text{dom}}}}\, \,\htmlId{5311}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Dijkstra.Specification.Certs.html#4225}{\htmlId{5312}{\htmlClass{Field}{\text{RewardsOf}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{5322}{\htmlClass{Generalizable}{\text{certState}}}}\,\,\htmlId{5331}{\htmlClass{Symbol}{\text{)}}}\, \end{pmatrix}$</a> <a id="5335" href="Ledger.Dijkstra.Specification.Gov.html#17187" class="Function Operator">⊢</a> <a id="5337" href="Ledger.Dijkstra.Specification.Ledger.html#3719" class="Function">rmOrphanDRepVotes</a> <a id="5355" href="Ledger.Dijkstra.Specification.Ledger.html#4462" class="Generalizable">certState&#39;</a> <a id="5366" href="Ledger.Dijkstra.Specification.Ledger.html#4417" class="Generalizable">govState</a> <a id="5375" href="Ledger.Dijkstra.Specification.Gov.html#17187" class="Function Operator">⇀⦇</a> <a id="5378" href="Ledger.Dijkstra.Specification.Ledger.html#3560" class="Function">GovProposals+Votes</a> <a id="5397" href="Ledger.Dijkstra.Specification.Ledger.html#4488" class="Generalizable">stx</a> <a id="5401" href="Ledger.Dijkstra.Specification.Gov.html#17187" class="Function Operator">,GOVS⦈</a> <a id="5408" href="Ledger.Dijkstra.Specification.Ledger.html#4426" class="Generalizable">govState&#39;</a>
      <a id="5424" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{5465}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4556}{\htmlId{5472}{\htmlClass{Generalizable}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{5482}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{5487}{\htmlClass{Generalizable}{\text{enactState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{5500}{\htmlClass{Generalizable}{\text{treasury}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4386}{\htmlId{5511}{\htmlClass{Generalizable}{\text{utxo₀}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4705}{\htmlId{5519}{\htmlClass{Generalizable}{\text{isTopLevelValid}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4736}{\htmlId{5537}{\htmlClass{Generalizable}{\text{allScripts}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4783}{\htmlId{5550}{\htmlClass{Generalizable}{\text{allData}}}}\, \end{pmatrix}$</a> <a id="5560" href="Ledger.Dijkstra.Specification.Ledger.html#4828" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4350}{\htmlId{5564}{\htmlClass{Generalizable}{\text{utxoState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{5576}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{5587}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a> <a id="5599" href="Ledger.Dijkstra.Specification.Ledger.html#4828" class="Datatype Operator">⇀⦇</a> <a id="5602" href="Ledger.Dijkstra.Specification.Ledger.html#4488" class="Generalizable">stx</a> <a id="5606" href="Ledger.Dijkstra.Specification.Ledger.html#4828" class="Datatype Operator">,SUBLEDGER⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4360}{\htmlId{5620}{\htmlClass{Generalizable}{\text{utxoState&#39;}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4426}{\htmlId{5633}{\htmlClass{Generalizable}{\text{govState&#39;}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4462}{\htmlId{5645}{\htmlClass{Generalizable}{\text{certState&#39;}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,SUBLEDGER⦈_.SUBLEDGER-I"></a><a id="5661" href="Ledger.Dijkstra.Specification.Ledger.html#5661" class="InductiveConstructor">SUBLEDGER-I</a> <a id="5673" class="Symbol">:</a>
      <a id="5681" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="5683" href="Ledger.Dijkstra.Specification.Ledger.html#4705" class="Generalizable">isTopLevelValid</a> <a id="5699" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5701" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
      <a id="5713" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{5717}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{5724}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{5729}{\htmlClass{Generalizable}{\text{treasury}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4386}{\htmlId{5740}{\htmlClass{Generalizable}{\text{utxo₀}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4705}{\htmlId{5748}{\htmlClass{Generalizable}{\text{isTopLevelValid}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4736}{\htmlId{5766}{\htmlClass{Generalizable}{\text{allScripts}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4783}{\htmlId{5779}{\htmlClass{Generalizable}{\text{allData}}}}\, \end{pmatrix}$</a> <a id="5789" href="Ledger.Dijkstra.Specification.Utxow.html#700" class="Datatype Operator">⊢</a> <a id="5791" href="Ledger.Dijkstra.Specification.Ledger.html#4350" class="Generalizable">utxoState</a> <a id="5801" href="Ledger.Dijkstra.Specification.Utxow.html#700" class="Datatype Operator">⇀⦇</a> <a id="5804" href="Ledger.Dijkstra.Specification.Ledger.html#4488" class="Generalizable">stx</a> <a id="5808" href="Ledger.Dijkstra.Specification.Utxow.html#700" class="Datatype Operator">,SUBUTXOW⦈</a> <a id="5819" href="Ledger.Dijkstra.Specification.Ledger.html#4350" class="Generalizable">utxoState</a>
      <a id="5835" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{5876}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4556}{\htmlId{5883}{\htmlClass{Generalizable}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{5893}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{5898}{\htmlClass{Generalizable}{\text{enactState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{5911}{\htmlClass{Generalizable}{\text{treasury}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4386}{\htmlId{5922}{\htmlClass{Generalizable}{\text{utxo₀}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4705}{\htmlId{5930}{\htmlClass{Generalizable}{\text{isTopLevelValid}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4736}{\htmlId{5948}{\htmlClass{Generalizable}{\text{allScripts}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4783}{\htmlId{5961}{\htmlClass{Generalizable}{\text{allData}}}}\, \end{pmatrix}$</a> <a id="5971" href="Ledger.Dijkstra.Specification.Ledger.html#4828" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4350}{\htmlId{5975}{\htmlClass{Generalizable}{\text{utxoState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{5987}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{5998}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a> <a id="6010" href="Ledger.Dijkstra.Specification.Ledger.html#4828" class="Datatype Operator">⇀⦇</a> <a id="6013" href="Ledger.Dijkstra.Specification.Ledger.html#4488" class="Generalizable">stx</a> <a id="6017" href="Ledger.Dijkstra.Specification.Ledger.html#4828" class="Datatype Operator">,SUBLEDGER⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4350}{\htmlId{6031}{\htmlClass{Generalizable}{\text{utxoState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{6043}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{6054}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a>

<a id="_⊢_⇀⦇_,SUBLEDGERS⦈_"></a><a id="6067" href="Ledger.Dijkstra.Specification.Ledger.html#6067" class="Function Operator">_⊢_⇀⦇_,SUBLEDGERS⦈_</a> <a id="6087" class="Symbol">:</a> <a id="6089" href="Ledger.Dijkstra.Specification.Ledger.html#698" class="Record">SubLedgerEnv</a> <a id="6102" class="Symbol">→</a> <a id="6104" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a> <a id="6111" class="Symbol">→</a> <a id="6113" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6118" href="Ledger.Dijkstra.Specification.Transaction.html#5285" class="Function">SubLevelTx</a> <a id="6129" class="Symbol">→</a> <a id="6131" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a> <a id="6138" class="Symbol">→</a> <a id="6140" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="6145" href="Ledger.Dijkstra.Specification.Ledger.html#6067" class="Function Operator">_⊢_⇀⦇_,SUBLEDGERS⦈_</a> <a id="6165" class="Symbol">=</a> <a id="6167" href="Interface.STS.html#2048" class="Function">ReflexiveTransitiveClosure</a> <a id="6194" class="Symbol">{</a><a id="6195" class="Argument">sts</a> <a id="6199" class="Symbol">=</a> <a id="6201" href="Ledger.Dijkstra.Specification.Ledger.html#4828" class="Datatype Operator">_⊢_⇀⦇_,SUBLEDGER⦈_</a><a id="6219" class="Symbol">}</a>


<a id="6223" class="Keyword">private</a> <a id="6231" class="Keyword">variable</a>
  <a id="6242" href="Ledger.Dijkstra.Specification.Ledger.html#6242" class="Generalizable">utxoState&#39;&#39;</a> <a id="6254" class="Symbol">:</a> <a id="6256" href="Ledger.Dijkstra.Specification.Utxo.html#725" class="Record">UTxOState</a>
  <a id="6268" href="Ledger.Dijkstra.Specification.Ledger.html#6268" class="Generalizable">govState&#39;&#39;</a>  <a id="6280" class="Symbol">:</a> <a id="6282" href="Ledger.Dijkstra.Specification.Gov.html#1510" class="Function">GovState</a>
  <a id="6293" href="Ledger.Dijkstra.Specification.Ledger.html#6293" class="Generalizable">certState&#39;&#39;</a> <a id="6305" class="Symbol">:</a> <a id="6307" href="Ledger.Dijkstra.Specification.Certs.html#3352" class="Record">CertState</a>
  <a id="6319" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a>          <a id="6331" class="Symbol">:</a> <a id="6333" href="Ledger.Dijkstra.Specification.Transaction.html#5235" class="Function">TopLevelTx</a>


<a id="6346" class="Keyword">data</a> <a id="_⊢_⇀⦇_,LEDGER⦈_"></a><a id="6351" href="Ledger.Dijkstra.Specification.Ledger.html#6351" class="Datatype Operator">_⊢_⇀⦇_,LEDGER⦈_</a> <a id="6367" class="Symbol">:</a> <a id="6369" href="Ledger.Dijkstra.Specification.Ledger.html#1017" class="Record">LedgerEnv</a> <a id="6379" class="Symbol">→</a> <a id="6381" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a> <a id="6388" class="Symbol">→</a> <a id="6390" href="Ledger.Dijkstra.Specification.Transaction.html#5235" class="Function">TopLevelTx</a> <a id="6401" class="Symbol">→</a> <a id="6403" href="Ledger.Dijkstra.Specification.Ledger.html#1581" class="Record">LState</a> <a id="6410" class="Symbol">→</a> <a id="6412" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="6417" class="Keyword">where</a>
  <a id="_⊢_⇀⦇_,LEDGER⦈_.LEDGER-V"></a><a id="6425" href="Ledger.Dijkstra.Specification.Ledger.html#6425" class="InductiveConstructor">LEDGER-V</a> <a id="6434" class="Symbol">:</a>
    <a id="6440" class="Keyword">let</a>  <a id="6445" href="Ledger.Dijkstra.Specification.Ledger.html#6445" class="Bound">utxo₀</a> <a id="6451" class="Symbol">=</a> <a id="6453" href="Ledger.Dijkstra.Specification.Transaction.html#3404" class="Field">UTxOOf</a> <a id="6460" href="Ledger.Dijkstra.Specification.Ledger.html#4350" class="Generalizable">utxoState</a>

         <a id="6480" href="Ledger.Dijkstra.Specification.Ledger.html#6480" class="Bound">allScripts</a> <a id="6491" class="Symbol">:</a> <a id="6493" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="6495" href="Ledger.Dijkstra.Specification.Script.Base.html#647" class="Function">P1Script</a> <a id="6504" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6506" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="6508" href="Ledger.Dijkstra.Specification.Script.Base.html#2379" class="Function">P2Script</a>
         <a id="6526" href="Ledger.Dijkstra.Specification.Ledger.html#6480" class="Bound">allScripts</a> <a id="6537" class="Symbol">=</a> <a id="6539" href="Ledger.Dijkstra.Specification.Transaction.html#14135" class="Function">getAllScripts</a> <a id="6553" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="6556" href="Ledger.Dijkstra.Specification.Ledger.html#6445" class="Bound">utxo₀</a>

         <a id="6572" href="Ledger.Dijkstra.Specification.Ledger.html#6572" class="Bound">allData</a> <a id="6580" class="Symbol">:</a> <a id="6582" href="Ledger.Dijkstra.Specification.Script.Base.html#1735" class="Function">DataHash</a> <a id="6591" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="6593" href="Ledger.Dijkstra.Specification.Script.Base.html#1782" class="Function">Datum</a>
         <a id="6608" href="Ledger.Dijkstra.Specification.Ledger.html#6572" class="Bound">allData</a> <a id="6616" class="Symbol">=</a> <a id="6618" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="6627" class="Symbol">(</a><a id="6628" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="6633" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="6635" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="6640" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="6642" href="Function.Base.html#704" class="Function">id</a> <a id="6645" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="6647" class="Symbol">(</a><a id="6648" href="Ledger.Dijkstra.Specification.Transaction.html#15245" class="Function">getAllData</a> <a id="6659" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="6662" href="Ledger.Dijkstra.Specification.Ledger.html#6445" class="Bound">utxo₀</a><a id="6667" class="Symbol">))</a>
    <a id="6674" class="Keyword">in</a>
      <a id="6683" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="6685" href="Ledger.Dijkstra.Specification.Transaction.html#3625" class="Field">Tx.isValid</a> <a id="6696" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="6699" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6701" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
      <a id="6712" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{6716}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4556}{\htmlId{6723}{\htmlClass{Generalizable}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{6733}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{6738}{\htmlClass{Generalizable}{\text{enactState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{6751}{\htmlClass{Generalizable}{\text{treasury}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#6445}{\htmlId{6762}{\htmlClass{Bound}{\text{utxo₀}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Transaction.html#3625}{\htmlId{6770}{\htmlClass{Field}{\text{Tx.isValid}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#6319}{\htmlId{6781}{\htmlClass{Generalizable}{\text{tx}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#6480}{\htmlId{6786}{\htmlClass{Bound}{\text{allScripts}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#6572}{\htmlId{6799}{\htmlClass{Bound}{\text{allData}}}}\, \end{pmatrix}$</a> <a id="6809" href="Ledger.Dijkstra.Specification.Ledger.html#6067" class="Function Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4350}{\htmlId{6813}{\htmlClass{Generalizable}{\text{utxoState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{6825}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{6836}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a> <a id="6848" href="Ledger.Dijkstra.Specification.Ledger.html#6067" class="Function Operator">⇀⦇</a> <a id="6851" href="Ledger.Dijkstra.Specification.Transaction.html#6305" class="Field">SubTransactionsOf</a> <a id="6869" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="6872" href="Ledger.Dijkstra.Specification.Ledger.html#6067" class="Function Operator">,SUBLEDGERS⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4360}{\htmlId{6887}{\htmlClass{Generalizable}{\text{utxoState&#39;}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4426}{\htmlId{6900}{\htmlClass{Generalizable}{\text{govState&#39;}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4462}{\htmlId{6912}{\htmlClass{Generalizable}{\text{certState&#39;}}}}\, \end{pmatrix}$</a>
      <a id="6931" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{6935}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{6942}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{6947}{\htmlClass{Generalizable}{\text{treasury}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#6445}{\htmlId{6958}{\htmlClass{Bound}{\text{utxo₀}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Transaction.html#3625}{\htmlId{6966}{\htmlClass{Field}{\text{Tx.isValid}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#6319}{\htmlId{6977}{\htmlClass{Generalizable}{\text{tx}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#6480}{\htmlId{6982}{\htmlClass{Bound}{\text{allScripts}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#6572}{\htmlId{6995}{\htmlClass{Bound}{\text{allData}}}}\, \end{pmatrix}$</a>  <a id="7006" href="Ledger.Dijkstra.Specification.Utxow.html#2422" class="Datatype Operator">⊢</a> <a id="7008" href="Ledger.Dijkstra.Specification.Ledger.html#4360" class="Generalizable">utxoState&#39;</a> <a id="7019" href="Ledger.Dijkstra.Specification.Utxow.html#2422" class="Datatype Operator">⇀⦇</a> <a id="7022" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="7025" href="Ledger.Dijkstra.Specification.Utxow.html#2422" class="Datatype Operator">,UTXOW⦈</a> <a id="7033" href="Ledger.Dijkstra.Specification.Ledger.html#6242" class="Generalizable">utxoState&#39;&#39;</a>
      <a id="7051" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Core.Specification.Epoch.html#858}{\htmlId{7055}{\htmlClass{Function}{\text{epoch}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{7061}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{7068}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Transaction.html#7987}{\htmlId{7073}{\htmlClass{Field}{\text{ListOfGovVotesOf}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#6319}{\htmlId{7090}{\htmlClass{Generalizable}{\text{tx}}}}\, \\ \,\href{Ledger.Core.Specification.Address.html#1700}{\htmlId{7095}{\htmlClass{Field}{\text{WithdrawalsOf}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#6319}{\htmlId{7109}{\htmlClass{Generalizable}{\text{tx}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4092}{\htmlId{7114}{\htmlClass{Function}{\text{allColdCreds}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{7127}{\htmlClass{Generalizable}{\text{govState}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{7136}{\htmlClass{Generalizable}{\text{enactState}}}}\, \end{pmatrix}$</a> <a id="7149" href="Ledger.Dijkstra.Specification.Certs.html#12707" class="Function Operator">⊢</a> <a id="7151" href="Ledger.Dijkstra.Specification.Ledger.html#4462" class="Generalizable">certState&#39;</a> <a id="7162" href="Ledger.Dijkstra.Specification.Certs.html#12707" class="Function Operator">⇀⦇</a> <a id="7165" href="Ledger.Dijkstra.Specification.Transaction.html#7592" class="Field">DCertsOf</a> <a id="7174" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="7177" href="Ledger.Dijkstra.Specification.Certs.html#12707" class="Function Operator">,CERTS⦈</a> <a id="7185" href="Ledger.Dijkstra.Specification.Ledger.html#6293" class="Generalizable">certState&#39;&#39;</a>
      <a id="7203" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Transaction.html#6726}{\htmlId{7207}{\htmlClass{Field}{\text{TxIdOf}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#6319}{\htmlId{7214}{\htmlClass{Generalizable}{\text{tx}}}}\, \\ \,\href{Ledger.Core.Specification.Epoch.html#858}{\htmlId{7219}{\htmlClass{Function}{\text{epoch}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{7225}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{7232}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4556}{\htmlId{7237}{\htmlClass{Generalizable}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{7247}{\htmlClass{Generalizable}{\text{enactState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4462}{\htmlId{7260}{\htmlClass{Generalizable}{\text{certState&#39;}}}}\, \\ \,\href{Class.IsSet.html#916}{\htmlId{7273}{\htmlClass{Function}{\text{dom}}}}\, \,\htmlId{7277}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Dijkstra.Specification.Certs.html#4225}{\htmlId{7278}{\htmlClass{Field}{\text{RewardsOf}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{7288}{\htmlClass{Generalizable}{\text{certState}}}}\,\,\htmlId{7297}{\htmlClass{Symbol}{\text{)}}}\, \end{pmatrix}$</a> <a id="7301" href="Ledger.Dijkstra.Specification.Gov.html#17187" class="Function Operator">⊢</a> <a id="7303" href="Ledger.Dijkstra.Specification.Ledger.html#3719" class="Function">rmOrphanDRepVotes</a> <a id="7321" href="Ledger.Dijkstra.Specification.Ledger.html#4462" class="Generalizable">certState&#39;</a> <a id="7332" href="Ledger.Dijkstra.Specification.Ledger.html#4417" class="Generalizable">govState</a> <a id="7341" href="Ledger.Dijkstra.Specification.Gov.html#17187" class="Function Operator">⇀⦇</a> <a id="7344" href="Ledger.Dijkstra.Specification.Ledger.html#3560" class="Function">GovProposals+Votes</a> <a id="7363" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="7366" href="Ledger.Dijkstra.Specification.Gov.html#17187" class="Function Operator">,GOVS⦈</a> <a id="7373" href="Ledger.Dijkstra.Specification.Ledger.html#4426" class="Generalizable">govState&#39;</a>
      <a id="7389" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{7430}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4556}{\htmlId{7437}{\htmlClass{Generalizable}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{7447}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{7452}{\htmlClass{Generalizable}{\text{enactState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{7465}{\htmlClass{Generalizable}{\text{treasury}}}}\, \end{pmatrix}$</a> <a id="7476" href="Ledger.Dijkstra.Specification.Ledger.html#6351" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4350}{\htmlId{7480}{\htmlClass{Generalizable}{\text{utxoState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{7492}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{7503}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a> <a id="7515" href="Ledger.Dijkstra.Specification.Ledger.html#6351" class="Datatype Operator">⇀⦇</a> <a id="7518" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="7521" href="Ledger.Dijkstra.Specification.Ledger.html#6351" class="Datatype Operator">,LEDGER⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#6242}{\htmlId{7532}{\htmlClass{Generalizable}{\text{utxoState&#39;&#39;}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#6268}{\htmlId{7546}{\htmlClass{Generalizable}{\text{govState&#39;&#39;}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#6293}{\htmlId{7559}{\htmlClass{Generalizable}{\text{certState&#39;&#39;}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,LEDGER⦈_.LEDGER-I"></a><a id="7576" href="Ledger.Dijkstra.Specification.Ledger.html#7576" class="InductiveConstructor">LEDGER-I</a> <a id="7585" class="Symbol">:</a>
    <a id="7591" class="Keyword">let</a>  <a id="7596" href="Ledger.Dijkstra.Specification.Ledger.html#7596" class="Bound">utxo₀</a> <a id="7602" class="Symbol">=</a> <a id="7604" href="Ledger.Dijkstra.Specification.Transaction.html#3404" class="Field">UTxOOf</a> <a id="7611" href="Ledger.Dijkstra.Specification.Ledger.html#4350" class="Generalizable">utxoState</a>

         <a id="7631" href="Ledger.Dijkstra.Specification.Ledger.html#7631" class="Bound">allScripts</a> <a id="7642" class="Symbol">:</a> <a id="7644" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="7646" href="Ledger.Dijkstra.Specification.Script.Base.html#647" class="Function">P1Script</a> <a id="7655" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="7657" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="7659" href="Ledger.Dijkstra.Specification.Script.Base.html#2379" class="Function">P2Script</a>
         <a id="7677" href="Ledger.Dijkstra.Specification.Ledger.html#7631" class="Bound">allScripts</a> <a id="7688" class="Symbol">=</a> <a id="7690" href="Ledger.Dijkstra.Specification.Transaction.html#14135" class="Function">getAllScripts</a> <a id="7704" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="7707" href="Ledger.Dijkstra.Specification.Ledger.html#7596" class="Bound">utxo₀</a>

         <a id="7723" href="Ledger.Dijkstra.Specification.Ledger.html#7723" class="Bound">allData</a> <a id="7731" class="Symbol">:</a> <a id="7733" href="Ledger.Dijkstra.Specification.Script.Base.html#1735" class="Function">DataHash</a> <a id="7742" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="7744" href="Ledger.Dijkstra.Specification.Script.Base.html#1782" class="Function">Datum</a>
         <a id="7759" href="Ledger.Dijkstra.Specification.Ledger.html#7723" class="Bound">allData</a> <a id="7767" class="Symbol">=</a> <a id="7769" href="Ledger.Prelude.html#1789" class="Function">setToMap</a> <a id="7778" class="Symbol">(</a><a id="7779" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="7784" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="7786" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="7791" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="7793" href="Function.Base.html#704" class="Function">id</a> <a id="7796" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a> <a id="7798" class="Symbol">(</a><a id="7799" href="Ledger.Dijkstra.Specification.Transaction.html#15245" class="Function">getAllData</a> <a id="7810" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="7813" href="Ledger.Dijkstra.Specification.Ledger.html#7596" class="Bound">utxo₀</a><a id="7818" class="Symbol">))</a>
    <a id="7825" class="Keyword">in</a>
      <a id="7834" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="7836" href="Ledger.Dijkstra.Specification.Transaction.html#3625" class="Field">Tx.isValid</a> <a id="7847" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="7850" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7852" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
      <a id="7864" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{7868}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4556}{\htmlId{7875}{\htmlClass{Generalizable}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{7885}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{7890}{\htmlClass{Generalizable}{\text{enactState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{7903}{\htmlClass{Generalizable}{\text{treasury}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#7596}{\htmlId{7914}{\htmlClass{Bound}{\text{utxo₀}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Transaction.html#3625}{\htmlId{7922}{\htmlClass{Field}{\text{Tx.isValid}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#6319}{\htmlId{7933}{\htmlClass{Generalizable}{\text{tx}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#7631}{\htmlId{7938}{\htmlClass{Bound}{\text{allScripts}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#7723}{\htmlId{7951}{\htmlClass{Bound}{\text{allData}}}}\, \end{pmatrix}$</a> <a id="7961" href="Ledger.Dijkstra.Specification.Ledger.html#6067" class="Function Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4350}{\htmlId{7965}{\htmlClass{Generalizable}{\text{utxoState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{7977}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{7988}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a> <a id="8000" href="Ledger.Dijkstra.Specification.Ledger.html#6067" class="Function Operator">⇀⦇</a> <a id="8003" href="Ledger.Dijkstra.Specification.Transaction.html#6305" class="Field">SubTransactionsOf</a> <a id="8021" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a>  <a id="8025" href="Ledger.Dijkstra.Specification.Ledger.html#6067" class="Function Operator">,SUBLEDGERS⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4350}{\htmlId{8040}{\htmlClass{Generalizable}{\text{utxoState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{8052}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{8063}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a>
      <a id="8081" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{8085}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{8092}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{8097}{\htmlClass{Generalizable}{\text{treasury}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#7596}{\htmlId{8108}{\htmlClass{Bound}{\text{utxo₀}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Transaction.html#3625}{\htmlId{8116}{\htmlClass{Field}{\text{Tx.isValid}}}}\, \,\href{Ledger.Dijkstra.Specification.Ledger.html#6319}{\htmlId{8127}{\htmlClass{Generalizable}{\text{tx}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#7631}{\htmlId{8132}{\htmlClass{Bound}{\text{allScripts}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#7723}{\htmlId{8145}{\htmlClass{Bound}{\text{allData}}}}\, \end{pmatrix}$</a> <a id="8155" href="Ledger.Dijkstra.Specification.Utxow.html#2422" class="Datatype Operator">⊢</a> <a id="8157" href="Ledger.Dijkstra.Specification.Ledger.html#4350" class="Generalizable">utxoState</a> <a id="8167" href="Ledger.Dijkstra.Specification.Utxow.html#2422" class="Datatype Operator">⇀⦇</a> <a id="8170" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="8173" href="Ledger.Dijkstra.Specification.Utxow.html#2422" class="Datatype Operator">,UTXOW⦈</a> <a id="8181" href="Ledger.Dijkstra.Specification.Ledger.html#4360" class="Generalizable">utxoState&#39;</a>
      <a id="8198" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4525}{\htmlId{8239}{\htmlClass{Generalizable}{\text{slot}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4556}{\htmlId{8246}{\htmlClass{Generalizable}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4599}{\htmlId{8256}{\htmlClass{Generalizable}{\text{pp}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4633}{\htmlId{8261}{\htmlClass{Generalizable}{\text{enactState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4670}{\htmlId{8274}{\htmlClass{Generalizable}{\text{treasury}}}}\, \end{pmatrix}$</a> <a id="8285" href="Ledger.Dijkstra.Specification.Ledger.html#6351" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4350}{\htmlId{8289}{\htmlClass{Generalizable}{\text{utxoState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{8301}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{8312}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a> <a id="8324" href="Ledger.Dijkstra.Specification.Ledger.html#6351" class="Datatype Operator">⇀⦇</a> <a id="8327" href="Ledger.Dijkstra.Specification.Ledger.html#6319" class="Generalizable">tx</a> <a id="8330" href="Ledger.Dijkstra.Specification.Ledger.html#6351" class="Datatype Operator">,LEDGER⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Dijkstra.Specification.Ledger.html#4360}{\htmlId{8341}{\htmlClass{Generalizable}{\text{utxoState&#39;}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4417}{\htmlId{8354}{\htmlClass{Generalizable}{\text{govState}}}}\, \\ \,\href{Ledger.Dijkstra.Specification.Ledger.html#4452}{\htmlId{8365}{\htmlClass{Generalizable}{\text{certState}}}}\, \end{pmatrix}$</a>

</pre></body></html>