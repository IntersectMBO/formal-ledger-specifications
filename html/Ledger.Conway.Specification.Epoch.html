<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Epoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>
<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>

<a id="128" class="Keyword">module</a> <a id="135" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a>
  <a id="171" class="Symbol">(</a><a id="172" href="Ledger.Conway.Specification.Epoch.html#172" class="Bound">txs</a> <a id="176" class="Symbol">:</a> <a id="178" class="Symbol">_)</a> <a id="181" class="Symbol">(</a><a id="182" class="Keyword">open</a> <a id="187" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="208" href="Ledger.Conway.Specification.Epoch.html#172" class="Bound">txs</a><a id="211" class="Symbol">)</a>
  <a id="215" class="Symbol">(</a><a id="216" href="Ledger.Conway.Specification.Epoch.html#216" class="Bound">abs</a> <a id="220" class="Symbol">:</a> <a id="222" href="Ledger.Conway.Specification.Abstract.html#830" class="Record">AbstractFunctions</a> <a id="240" href="Ledger.Conway.Specification.Epoch.html#172" class="Bound">txs</a><a id="243" class="Symbol">)</a> <a id="245" class="Symbol">(</a><a id="246" class="Keyword">open</a> <a id="251" href="Ledger.Conway.Specification.Abstract.html#830" class="Module">AbstractFunctions</a> <a id="269" href="Ledger.Conway.Specification.Epoch.html#216" class="Bound">abs</a><a id="272" class="Symbol">)</a>
  <a id="276" class="Keyword">where</a>

<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="317" class="Keyword">import</a>      <a id="329" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="342" class="Symbol">as</a> <a id="345" class="Module">ℤ</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Data.Integer.html" class="Module">Data.Integer</a>                    <a id="391" class="Keyword">using</a> <a id="397" class="Symbol">()</a> <a id="400" class="Keyword">renaming</a> <a id="409" class="Symbol">(</a><a id="410" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a> <a id="413" class="Symbol">to</a> <a id="416" class="InductiveConstructor">pos</a><a id="419" class="Symbol">)</a>
<a id="421" class="Keyword">open</a> <a id="426" class="Keyword">import</a> <a id="433" href="Data.Integer.Properties.html" class="Module">Data.Integer.Properties</a>         <a id="465" class="Keyword">using</a> <a id="471" class="Symbol">(</a><a id="472" class="Keyword">module</a> <a id="479" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a><a id="490" class="Symbol">;</a> <a id="492" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a><a id="500" class="Symbol">;</a> <a id="502" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a><a id="512" class="Symbol">;</a> <a id="514" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a><a id="525" class="Symbol">)</a>
                                            <a id="571" class="Keyword">renaming</a> <a id="580" class="Symbol">(</a><a id="581" href="Data.Integer.Properties.html#12508" class="Function">nonNegative⁻¹</a> <a id="595" class="Symbol">to</a> <a id="598" class="Function">nonNegative⁻¹ℤ</a><a id="612" class="Symbol">)</a>
<a id="614" class="Keyword">open</a> <a id="619" class="Keyword">import</a> <a id="626" href="Data.Integer.Tactic.RingSolver.html" class="Module">Data.Integer.Tactic.RingSolver</a>  <a id="658" class="Keyword">using</a> <a id="664" class="Symbol">(</a><a id="665" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a><a id="672" class="Symbol">)</a>
<a id="674" class="Keyword">open</a> <a id="679" class="Keyword">import</a> <a id="686" href="Data.Maybe.html" class="Module">Data.Maybe</a>                      <a id="718" class="Keyword">using</a> <a id="724" class="Symbol">(</a><a id="725" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a><a id="734" class="Symbol">)</a>
<a id="736" class="Keyword">open</a> <a id="741" class="Keyword">import</a> <a id="748" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a>  <a id="780" class="Keyword">using</a> <a id="786" class="Symbol">(</a><a id="787" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a><a id="794" class="Symbol">)</a>
<a id="796" class="Keyword">open</a> <a id="801" class="Keyword">import</a> <a id="808" href="Data.Rational.html" class="Module">Data.Rational</a>                   <a id="840" class="Keyword">using</a> <a id="846" class="Symbol">(</a><a id="847" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="848" class="Symbol">;</a> <a id="850" href="Data.Rational.Base.html#7195" class="Function">floor</a><a id="855" class="Symbol">;</a> <a id="857" href="Data.Rational.Base.html#6394" class="Function Operator">_*_</a><a id="860" class="Symbol">;</a> <a id="862" href="Data.Rational.Base.html#6787" class="Function Operator">_÷_</a><a id="865" class="Symbol">;</a> <a id="867" href="Data.Rational.Base.html#3963" class="Function Operator">_/_</a><a id="870" class="Symbol">;</a> <a id="872" href="Data.Rational.Base.html#6933" class="Function Operator">_⊓_</a><a id="875" class="Symbol">;</a> <a id="877" href="Data.Rational.Properties.html#4152" class="Function Operator">_≟_</a><a id="880" class="Symbol">;</a> <a id="882" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a><a id="891" class="Symbol">)</a>
<a id="893" class="Keyword">open</a> <a id="898" class="Keyword">import</a> <a id="905" href="Data.Rational.Literals.html" class="Module">Data.Rational.Literals</a>          <a id="937" class="Keyword">using</a> <a id="943" class="Symbol">(</a><a id="944" href="Data.Rational.Literals.html#740" class="Function">number</a><a id="950" class="Symbol">;</a> <a id="952" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a><a id="957" class="Symbol">)</a>
<a id="959" class="Keyword">open</a> <a id="964" class="Keyword">import</a> <a id="971" href="Data.Rational.Properties.html" class="Module">Data.Rational.Properties</a>        <a id="1003" class="Keyword">using</a> <a id="1009" class="Symbol">(</a><a id="1010" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a><a id="1023" class="Symbol">;</a> <a id="1025" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a><a id="1035" class="Symbol">;</a> <a id="1037" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a><a id="1042" class="Symbol">)</a>

<a id="1045" class="Keyword">open</a> <a id="1050" class="Keyword">import</a> <a id="1057" href="stdlib.Data.Rational.Properties.html" class="Module">stdlib.Data.Rational.Properties</a> <a id="1089" class="Keyword">using</a> <a id="1095" class="Symbol">(</a><a id="1096" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a><a id="1106" class="Symbol">;</a> <a id="1108" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a><a id="1115" class="Symbol">;</a> <a id="1117" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a><a id="1125" class="Symbol">;</a> <a id="1127" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a><a id="1134" class="Symbol">;</a> <a id="1136" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a><a id="1144" class="Symbol">)</a>

<a id="1147" class="Keyword">open</a> <a id="1152" class="Keyword">import</a> <a id="1159" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="1174" class="Keyword">hiding</a> <a id="1181" class="Symbol">(</a><a id="1182" href="Data.List.Base.html#5114" class="Function">iterate</a><a id="1189" class="Symbol">;</a> <a id="1191" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="1194" class="Symbol">;</a> <a id="1196" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="1199" class="Symbol">;</a> <a id="1201" href="Data.Nat.Base.html#5851" class="Function Operator">_⊓_</a><a id="1204" class="Symbol">;</a> <a id="1206" href="Class.DecEq.Core.html#168" class="Field Operator">_≟_</a><a id="1209" class="Symbol">;</a> <a id="1211" href="Data.Nat.Base.html#3425" class="Function">≢-nonZero</a><a id="1220" class="Symbol">)</a>
<a id="1222" class="Keyword">open</a> <a id="1227" class="Keyword">import</a> <a id="1234" href="Ledger.Prelude.Numeric.UnitInterval.html" class="Module">Ledger.Prelude.Numeric.UnitInterval</a> <a id="1270" class="Keyword">using</a> <a id="1276" class="Symbol">(</a><a id="1277" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a><a id="1293" class="Symbol">;</a> <a id="1295" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a><a id="1312" class="Symbol">)</a>

<a id="1315" class="Keyword">open</a> <a id="1320" class="Keyword">import</a> <a id="1327" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="1361" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="1374" class="Keyword">open</a> <a id="1379" class="Keyword">import</a> <a id="1386" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="1420" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="1433" class="Keyword">open</a> <a id="1438" class="Keyword">import</a> <a id="1445" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="1477" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="1490" class="Keyword">open</a> <a id="1495" class="Keyword">import</a> <a id="1502" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="1537" href="Ledger.Conway.Specification.Epoch.html#172" class="Bound">txs</a> <a id="1541" href="Ledger.Conway.Specification.Epoch.html#216" class="Bound">abs</a>
<a id="1545" class="Keyword">open</a> <a id="1550" class="Keyword">import</a> <a id="1557" href="Ledger.Conway.Specification.PoolReap.html" class="Module">Ledger.Conway.Specification.PoolReap</a> <a id="1594" href="Ledger.Conway.Specification.Epoch.html#172" class="Bound">txs</a> <a id="1598" href="Ledger.Conway.Specification.Epoch.html#216" class="Bound">abs</a>
<a id="1602" class="Keyword">open</a> <a id="1607" class="Keyword">import</a> <a id="1614" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="1649" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="1662" class="Keyword">open</a> <a id="1667" class="Keyword">import</a> <a id="1674" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="1710" href="Ledger.Conway.Specification.Epoch.html#172" class="Bound">txs</a> <a id="1714" href="Ledger.Conway.Specification.Epoch.html#216" class="Bound">abs</a>
<a id="1718" class="Keyword">open</a> <a id="1723" class="Keyword">import</a> <a id="1730" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="1763" href="Ledger.Conway.Specification.Epoch.html#172" class="Bound">txs</a> <a id="1767" href="Ledger.Conway.Specification.Epoch.html#216" class="Bound">abs</a>

<a id="1772" class="Keyword">open</a> <a id="1777" href="Ledger.Prelude.html#2436" class="Module">Filter</a> <a id="1784" class="Keyword">using</a> <a id="1790" class="Symbol">(</a><a id="1791" href="Ledger.Prelude.html#2451" class="Function">filter</a><a id="1797" class="Symbol">)</a>
<a id="1799" class="Keyword">open</a> <a id="1804" href="Agda.Builtin.FromNat.html#196" class="Module">Number</a> <a id="1811" href="Data.Rational.Literals.html#740" class="Function">number</a> <a id="1818" class="Keyword">renaming</a> <a id="1827" class="Symbol">(</a><a id="1828" href="Agda.Builtin.FromNat.html#281" class="Field">fromNat</a> <a id="1836" class="Symbol">to</a> <a id="1839" class="Field">fromℕ</a><a id="1844" class="Symbol">)</a>


<a id="1848" class="Keyword">record</a> <a id="EpochState"></a><a id="1855" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a> <a id="1866" class="Symbol">:</a> <a id="1868" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1873" class="Keyword">where</a>


  <a id="1883" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1895" href="Ledger.Conway.Specification.Epoch.html#1895" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>


  <a id="1913" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1923" href="Ledger.Conway.Specification.Epoch.html#1923" class="Field">acnt</a>       <a id="1934" class="Symbol">:</a> <a id="1936" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1945" href="Ledger.Conway.Specification.Epoch.html#1945" class="Field">ss</a>         <a id="1956" class="Symbol">:</a> <a id="1958" href="Ledger.Conway.Specification.Rewards.html#7719" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1972" href="Ledger.Conway.Specification.Epoch.html#1972" class="Field">ls</a>         <a id="1983" class="Symbol">:</a> <a id="1985" href="Ledger.Conway.Specification.Ledger.html#988" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1996" href="Ledger.Conway.Specification.Epoch.html#1996" class="Field">es</a>         <a id="2007" class="Symbol">:</a> <a id="2009" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="2024" href="Ledger.Conway.Specification.Epoch.html#2024" class="Field">fut</a>        <a id="2035" class="Symbol">:</a> <a id="2037" href="Ledger.Conway.Specification.Ratify.html#3537" class="Record">RatifyState</a>


<a id="2051" class="Keyword">record</a> <a id="HasEpochState"></a><a id="2058" href="Ledger.Conway.Specification.Epoch.html#2058" class="Record">HasEpochState</a> <a id="2072" class="Symbol">{</a><a id="2073" href="Ledger.Conway.Specification.Epoch.html#2073" class="Bound">a</a><a id="2074" class="Symbol">}</a> <a id="2076" class="Symbol">(</a><a id="2077" href="Ledger.Conway.Specification.Epoch.html#2077" class="Bound">A</a> <a id="2079" class="Symbol">:</a> <a id="2081" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2086" href="Ledger.Conway.Specification.Epoch.html#2073" class="Bound">a</a><a id="2087" class="Symbol">)</a> <a id="2089" class="Symbol">:</a> <a id="2091" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2096" href="Ledger.Conway.Specification.Epoch.html#2073" class="Bound">a</a> <a id="2098" class="Keyword">where</a>
  <a id="2106" class="Keyword">field</a> <a id="HasEpochState.EpochStateOf"></a><a id="2112" href="Ledger.Conway.Specification.Epoch.html#2112" class="Field">EpochStateOf</a> <a id="2125" class="Symbol">:</a> <a id="2127" href="Ledger.Conway.Specification.Epoch.html#2077" class="Bound">A</a> <a id="2129" class="Symbol">→</a> <a id="2131" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
<a id="2142" class="Keyword">open</a> <a id="2147" href="Ledger.Conway.Specification.Epoch.html#2058" class="Module">HasEpochState</a> <a id="2161" class="Symbol">⦃...⦄</a> <a id="2167" class="Keyword">public</a>

<a id="2175" class="Keyword">instance</a>
  <a id="HasSnapshots-EpochState"></a><a id="2186" href="Ledger.Conway.Specification.Epoch.html#2186" class="Function">HasSnapshots-EpochState</a> <a id="2210" class="Symbol">:</a> <a id="2212" href="Ledger.Conway.Specification.Rewards.html#7810" class="Record">HasSnapshots</a> <a id="2225" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="2238" href="Ledger.Conway.Specification.Epoch.html#2186" class="Function">HasSnapshots-EpochState</a> <a id="2262" class="Symbol">.</a><a id="2263" href="Ledger.Conway.Specification.Rewards.html#7863" class="Field">SnapshotsOf</a> <a id="2275" class="Symbol">=</a> <a id="2277" href="Ledger.Conway.Specification.Epoch.html#1945" class="Field">EpochState.ss</a>

  <a id="HasLState-EpochState"></a><a id="2294" href="Ledger.Conway.Specification.Epoch.html#2294" class="Function">HasLState-EpochState</a> <a id="2315" class="Symbol">:</a> <a id="2317" href="Ledger.Conway.Specification.Ledger.html#1132" class="Record">HasLState</a> <a id="2327" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="2340" href="Ledger.Conway.Specification.Epoch.html#2294" class="Function">HasLState-EpochState</a> <a id="2361" class="Symbol">.</a><a id="2362" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a> <a id="2371" class="Symbol">=</a> <a id="2373" href="Ledger.Conway.Specification.Epoch.html#1972" class="Field">EpochState.ls</a>

  <a id="HasGovState-EpochState"></a><a id="2390" href="Ledger.Conway.Specification.Epoch.html#2390" class="Function">HasGovState-EpochState</a> <a id="2413" class="Symbol">:</a> <a id="2415" href="Ledger.Conway.Specification.Gov.html#1473" class="Record">HasGovState</a> <a id="2427" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="2440" href="Ledger.Conway.Specification.Epoch.html#2390" class="Function">HasGovState-EpochState</a> <a id="2463" class="Symbol">.</a><a id="2464" href="Ledger.Conway.Specification.Gov.html#1525" class="Field">GovStateOf</a> <a id="2475" class="Symbol">=</a> <a id="2477" href="Ledger.Conway.Specification.Gov.html#1525" class="Field">GovStateOf</a> <a id="2488" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2490" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a>

  <a id="HasEnactState-EpochState"></a><a id="2502" href="Ledger.Conway.Specification.Epoch.html#2502" class="Function">HasEnactState-EpochState</a> <a id="2527" class="Symbol">:</a> <a id="2529" href="Ledger.Conway.Specification.Enact.html#737" class="Record">HasEnactState</a> <a id="2543" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="2556" href="Ledger.Conway.Specification.Epoch.html#2502" class="Function">HasEnactState-EpochState</a> <a id="2581" class="Symbol">.</a><a id="2582" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="2595" class="Symbol">=</a> <a id="2597" href="Ledger.Conway.Specification.Epoch.html#1996" class="Field">EpochState.es</a>

  <a id="HasDeposits-EpochState"></a><a id="2614" href="Ledger.Conway.Specification.Epoch.html#2614" class="Function">HasDeposits-EpochState</a> <a id="2637" class="Symbol">:</a> <a id="2639" href="Ledger.Conway.Specification.Certs.html#870" class="Record">HasDeposits</a> <a id="2651" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="2664" href="Ledger.Conway.Specification.Epoch.html#2614" class="Function">HasDeposits-EpochState</a> <a id="2687" class="Symbol">.</a><a id="2688" href="Ledger.Conway.Specification.Certs.html#922" class="Field">DepositsOf</a> <a id="2699" class="Symbol">=</a> <a id="2701" href="Ledger.Conway.Specification.Certs.html#922" class="Field">DepositsOf</a> <a id="2712" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2714" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a>

  <a id="HasDReps-EpochState"></a><a id="2726" href="Ledger.Conway.Specification.Epoch.html#2726" class="Function">HasDReps-EpochState</a> <a id="2746" class="Symbol">:</a> <a id="2748" href="Ledger.Conway.Specification.Gov.Actions.html#7047" class="Record">HasDReps</a> <a id="2757" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="2770" href="Ledger.Conway.Specification.Epoch.html#2726" class="Function">HasDReps-EpochState</a> <a id="2790" class="Symbol">.</a><a id="2791" href="Ledger.Conway.Specification.Gov.Actions.html#7096" class="Field">DRepsOf</a> <a id="2799" class="Symbol">=</a> <a id="2801" href="Ledger.Conway.Specification.Gov.Actions.html#7096" class="Field">DRepsOf</a> <a id="2809" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2811" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a> <a id="2823" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2825" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a>

  <a id="HasTreasury-EpochState"></a><a id="2837" href="Ledger.Conway.Specification.Epoch.html#2837" class="Function">HasTreasury-EpochState</a> <a id="2860" class="Symbol">:</a> <a id="2862" href="Ledger.Prelude.Base.html#837" class="Record">HasTreasury</a> <a id="2874" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="2887" href="Ledger.Conway.Specification.Epoch.html#2837" class="Function">HasTreasury-EpochState</a> <a id="2910" class="Symbol">.</a><a id="2911" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="2922" class="Symbol">=</a> <a id="2924" href="Ledger.Conway.Specification.PParams.html#775" class="Field">Acnt.treasury</a> <a id="2938" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2940" href="Ledger.Conway.Specification.Epoch.html#1923" class="Field">EpochState.acnt</a>

  <a id="HasReserves-EpochState"></a><a id="2959" href="Ledger.Conway.Specification.Epoch.html#2959" class="Function">HasReserves-EpochState</a> <a id="2982" class="Symbol">:</a> <a id="2984" href="Ledger.Prelude.Base.html#721" class="Record">HasReserves</a> <a id="2996" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="3009" href="Ledger.Conway.Specification.Epoch.html#2959" class="Function">HasReserves-EpochState</a> <a id="3032" class="Symbol">.</a><a id="3033" href="Ledger.Prelude.Base.html#773" class="Field">ReservesOf</a> <a id="3044" class="Symbol">=</a> <a id="3046" href="Ledger.Conway.Specification.PParams.html#784" class="Field">Acnt.reserves</a> <a id="3060" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3062" href="Ledger.Conway.Specification.Epoch.html#1923" class="Field">EpochState.acnt</a>

  <a id="HasPParams-EpochState"></a><a id="3081" href="Ledger.Conway.Specification.Epoch.html#3081" class="Function">HasPParams-EpochState</a> <a id="3103" class="Symbol">:</a> <a id="3105" href="Ledger.Conway.Specification.PParams.html#3493" class="Record">HasPParams</a> <a id="3116" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="3129" href="Ledger.Conway.Specification.Epoch.html#3081" class="Function">HasPParams-EpochState</a> <a id="3151" class="Symbol">.</a><a id="3152" href="Ledger.Conway.Specification.PParams.html#3544" class="Field">PParamsOf</a> <a id="3162" class="Symbol">=</a> <a id="3164" href="Ledger.Conway.Specification.PParams.html#3544" class="Field">PParamsOf</a> <a id="3174" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3176" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a>

  <a id="HasRatifyState-EpochState"></a><a id="3192" href="Ledger.Conway.Specification.Epoch.html#3192" class="Function">HasRatifyState-EpochState</a> <a id="3218" class="Symbol">:</a> <a id="3220" href="Ledger.Conway.Specification.Ratify.html#3673" class="Record">HasRatifyState</a> <a id="3235" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="3248" href="Ledger.Conway.Specification.Epoch.html#3192" class="Function">HasRatifyState-EpochState</a> <a id="3274" class="Symbol">.</a><a id="3275" href="Ledger.Conway.Specification.Ratify.html#3728" class="Field">RatifyStateOf</a> <a id="3289" class="Symbol">=</a> <a id="3291" href="Ledger.Conway.Specification.Epoch.html#2024" class="Field">EpochState.fut</a>

  <a id="HasPState-EpochState"></a><a id="3309" href="Ledger.Conway.Specification.Epoch.html#3309" class="Function">HasPState-EpochState</a> <a id="3330" class="Symbol">:</a> <a id="3332" href="Ledger.Conway.Specification.Certs.html#4513" class="Record">HasPState</a> <a id="3342" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="3355" href="Ledger.Conway.Specification.Epoch.html#3309" class="Function">HasPState-EpochState</a> <a id="3376" class="Symbol">.</a><a id="3377" href="Ledger.Conway.Specification.Certs.html#4563" class="Field">PStateOf</a> <a id="3386" class="Symbol">=</a> <a id="3388" href="Ledger.Conway.Specification.Certs.html#4563" class="Field">PStateOf</a> <a id="3397" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3399" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a> <a id="3411" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3413" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a>

  <a id="HasRetiring-EpochState"></a><a id="3425" href="Ledger.Conway.Specification.Epoch.html#3425" class="Function">HasRetiring-EpochState</a> <a id="3448" class="Symbol">:</a> <a id="3450" href="Ledger.Conway.Specification.Certs.html#1596" class="Record">HasRetiring</a> <a id="3462" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="3475" href="Ledger.Conway.Specification.Epoch.html#3425" class="Function">HasRetiring-EpochState</a> <a id="3498" class="Symbol">.</a><a id="3499" href="Ledger.Conway.Specification.Certs.html#1648" class="Field">RetiringOf</a> <a id="3510" class="Symbol">=</a> <a id="3512" href="Ledger.Conway.Specification.Certs.html#1648" class="Field">RetiringOf</a> <a id="3523" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3525" href="Ledger.Conway.Specification.Certs.html#4563" class="Field">PStateOf</a>


<a id="PoolDelegatedStake"></a><a id="3536" href="Ledger.Conway.Specification.Epoch.html#3536" class="Function">PoolDelegatedStake</a> <a id="3555" class="Symbol">:</a> <a id="3557" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3562" href="Ledger.Conway.Specification.Epoch.html#3536" class="Function">PoolDelegatedStake</a> <a id="3581" class="Symbol">=</a> <a id="3583" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="3591" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3593" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>

<a id="3599" class="Keyword">record</a> <a id="NewEpochState"></a><a id="3606" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a> <a id="3620" class="Symbol">:</a> <a id="3622" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3627" class="Keyword">where</a>
  <a id="3635" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="3645" href="Ledger.Conway.Specification.Epoch.html#3645" class="Field">lastEpoch</a>   <a id="3657" class="Symbol">:</a> <a id="3659" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
    <a id="NewEpochState.bprev"></a><a id="3669" href="Ledger.Conway.Specification.Epoch.html#3669" class="Field">bprev</a>       <a id="3681" class="Symbol">:</a> <a id="3683" href="Ledger.Conway.Specification.Rewards.html#4906" class="Function">BlocksMade</a>
    <a id="NewEpochState.bcur"></a><a id="3698" href="Ledger.Conway.Specification.Epoch.html#3698" class="Field">bcur</a>        <a id="3710" class="Symbol">:</a> <a id="3712" href="Ledger.Conway.Specification.Rewards.html#4906" class="Function">BlocksMade</a>
    <a id="NewEpochState.epochState"></a><a id="3727" href="Ledger.Conway.Specification.Epoch.html#3727" class="Field">epochState</a>  <a id="3739" class="Symbol">:</a> <a id="3741" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="3756" href="Ledger.Conway.Specification.Epoch.html#3756" class="Field">ru</a>          <a id="3768" class="Symbol">:</a> <a id="3770" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3776" href="Ledger.Conway.Specification.Rewards.html#6249" class="Record">RewardUpdate</a>
    <a id="NewEpochState.pd"></a><a id="3793" href="Ledger.Conway.Specification.Epoch.html#3793" class="Field">pd</a>          <a id="3805" class="Symbol">:</a> <a id="3807" href="Ledger.Conway.Specification.Epoch.html#3536" class="Function">PoolDelegatedStake</a>


<a id="3828" class="Keyword">record</a> <a id="HasNewEpochState"></a><a id="3835" href="Ledger.Conway.Specification.Epoch.html#3835" class="Record">HasNewEpochState</a> <a id="3852" class="Symbol">{</a><a id="3853" href="Ledger.Conway.Specification.Epoch.html#3853" class="Bound">a</a><a id="3854" class="Symbol">}</a> <a id="3856" class="Symbol">(</a><a id="3857" href="Ledger.Conway.Specification.Epoch.html#3857" class="Bound">A</a> <a id="3859" class="Symbol">:</a> <a id="3861" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3866" href="Ledger.Conway.Specification.Epoch.html#3853" class="Bound">a</a><a id="3867" class="Symbol">)</a> <a id="3869" class="Symbol">:</a> <a id="3871" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3876" href="Ledger.Conway.Specification.Epoch.html#3853" class="Bound">a</a> <a id="3878" class="Keyword">where</a>
  <a id="3886" class="Keyword">field</a> <a id="HasNewEpochState.NewEpochStateOf"></a><a id="3892" href="Ledger.Conway.Specification.Epoch.html#3892" class="Field">NewEpochStateOf</a> <a id="3908" class="Symbol">:</a> <a id="3910" href="Ledger.Conway.Specification.Epoch.html#3857" class="Bound">A</a> <a id="3912" class="Symbol">→</a> <a id="3914" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
<a id="3928" class="Keyword">open</a> <a id="3933" href="Ledger.Conway.Specification.Epoch.html#3835" class="Module">HasNewEpochState</a> <a id="3950" class="Symbol">⦃...⦄</a> <a id="3956" class="Keyword">public</a>
<a id="3963" class="Keyword">record</a> <a id="HasLastEpoch"></a><a id="3970" href="Ledger.Conway.Specification.Epoch.html#3970" class="Record">HasLastEpoch</a>     <a id="3987" class="Symbol">{</a><a id="3988" href="Ledger.Conway.Specification.Epoch.html#3988" class="Bound">a</a><a id="3989" class="Symbol">}</a> <a id="3991" class="Symbol">(</a><a id="3992" href="Ledger.Conway.Specification.Epoch.html#3992" class="Bound">A</a> <a id="3994" class="Symbol">:</a> <a id="3996" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4001" href="Ledger.Conway.Specification.Epoch.html#3988" class="Bound">a</a><a id="4002" class="Symbol">)</a> <a id="4004" class="Symbol">:</a> <a id="4006" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4011" href="Ledger.Conway.Specification.Epoch.html#3988" class="Bound">a</a> <a id="4013" class="Keyword">where</a> <a id="4019" class="Keyword">field</a> <a id="HasLastEpoch.LastEpochOf"></a><a id="4025" href="Ledger.Conway.Specification.Epoch.html#4025" class="Field">LastEpochOf</a>     <a id="4041" class="Symbol">:</a> <a id="4043" href="Ledger.Conway.Specification.Epoch.html#3992" class="Bound">A</a> <a id="4045" class="Symbol">→</a> <a id="4047" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
<a id="4053" class="Keyword">open</a> <a id="4058" href="Ledger.Conway.Specification.Epoch.html#3970" class="Module">HasLastEpoch</a>     <a id="4075" class="Symbol">⦃...⦄</a> <a id="4081" class="Keyword">public</a>

<a id="4089" class="Keyword">instance</a>
  <a id="HasLastEpoch-NewEpochState"></a><a id="4100" href="Ledger.Conway.Specification.Epoch.html#4100" class="Function">HasLastEpoch-NewEpochState</a> <a id="4127" class="Symbol">:</a> <a id="4129" href="Ledger.Conway.Specification.Epoch.html#3970" class="Record">HasLastEpoch</a> <a id="4142" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="4158" href="Ledger.Conway.Specification.Epoch.html#4100" class="Function">HasLastEpoch-NewEpochState</a> <a id="4185" class="Symbol">.</a><a id="4186" href="Ledger.Conway.Specification.Epoch.html#4025" class="Field">LastEpochOf</a> <a id="4198" class="Symbol">=</a> <a id="4200" href="Ledger.Conway.Specification.Epoch.html#3645" class="Field">NewEpochState.lastEpoch</a>

  <a id="HasEpochState-NewEpochState"></a><a id="4227" href="Ledger.Conway.Specification.Epoch.html#4227" class="Function">HasEpochState-NewEpochState</a> <a id="4255" class="Symbol">:</a> <a id="4257" href="Ledger.Conway.Specification.Epoch.html#2058" class="Record">HasEpochState</a> <a id="4271" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="4287" href="Ledger.Conway.Specification.Epoch.html#4227" class="Function">HasEpochState-NewEpochState</a> <a id="4315" class="Symbol">.</a><a id="4316" href="Ledger.Conway.Specification.Epoch.html#2112" class="Field">EpochStateOf</a> <a id="4329" class="Symbol">=</a> <a id="4331" href="Ledger.Conway.Specification.Epoch.html#3727" class="Field">NewEpochState.epochState</a>

  <a id="HasEnactState-NewEpochState"></a><a id="4359" href="Ledger.Conway.Specification.Epoch.html#4359" class="Function">HasEnactState-NewEpochState</a> <a id="4387" class="Symbol">:</a> <a id="4389" href="Ledger.Conway.Specification.Enact.html#737" class="Record">HasEnactState</a> <a id="4403" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="4419" href="Ledger.Conway.Specification.Epoch.html#4359" class="Function">HasEnactState-NewEpochState</a> <a id="4447" class="Symbol">.</a><a id="4448" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="4461" class="Symbol">=</a> <a id="4463" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="4476" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4478" href="Ledger.Conway.Specification.Epoch.html#2112" class="Field">EpochStateOf</a>

  <a id="Hastreasury-NewEpochState"></a><a id="4494" href="Ledger.Conway.Specification.Epoch.html#4494" class="Function">Hastreasury-NewEpochState</a> <a id="4520" class="Symbol">:</a> <a id="4522" href="Ledger.Prelude.Base.html#837" class="Record">HasTreasury</a> <a id="4534" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="4550" href="Ledger.Conway.Specification.Epoch.html#4494" class="Function">Hastreasury-NewEpochState</a> <a id="4576" class="Symbol">.</a><a id="4577" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="4588" class="Symbol">=</a> <a id="4590" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="4601" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4603" href="Ledger.Conway.Specification.Epoch.html#2112" class="Field">EpochStateOf</a>

  <a id="HasLState-NewEpochState"></a><a id="4619" href="Ledger.Conway.Specification.Epoch.html#4619" class="Function">HasLState-NewEpochState</a> <a id="4643" class="Symbol">:</a> <a id="4645" href="Ledger.Conway.Specification.Ledger.html#1132" class="Record">HasLState</a> <a id="4655" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="4671" href="Ledger.Conway.Specification.Epoch.html#4619" class="Function">HasLState-NewEpochState</a> <a id="4695" class="Symbol">.</a><a id="4696" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a> <a id="4705" class="Symbol">=</a> <a id="4707" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a> <a id="4716" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4718" href="Ledger.Conway.Specification.Epoch.html#2112" class="Field">EpochStateOf</a>

  <a id="HasGovState-NewEpochState"></a><a id="4734" href="Ledger.Conway.Specification.Epoch.html#4734" class="Function">HasGovState-NewEpochState</a> <a id="4760" class="Symbol">:</a> <a id="4762" href="Ledger.Conway.Specification.Gov.html#1473" class="Record">HasGovState</a> <a id="4774" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="4790" href="Ledger.Conway.Specification.Epoch.html#4734" class="Function">HasGovState-NewEpochState</a> <a id="4816" class="Symbol">.</a><a id="4817" href="Ledger.Conway.Specification.Gov.html#1525" class="Field">GovStateOf</a> <a id="4828" class="Symbol">=</a> <a id="4830" href="Ledger.Conway.Specification.Gov.html#1525" class="Field">GovStateOf</a> <a id="4841" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4843" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a>

  <a id="HasCertState-NewEpochState"></a><a id="4855" href="Ledger.Conway.Specification.Epoch.html#4855" class="Function">HasCertState-NewEpochState</a> <a id="4882" class="Symbol">:</a> <a id="4884" href="Ledger.Conway.Specification.Certs.html#4729" class="Record">HasCertState</a> <a id="4897" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="4913" href="Ledger.Conway.Specification.Epoch.html#4855" class="Function">HasCertState-NewEpochState</a> <a id="4940" class="Symbol">.</a><a id="4941" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a> <a id="4953" class="Symbol">=</a> <a id="4955" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a> <a id="4967" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4969" href="Ledger.Conway.Specification.Ledger.html#1182" class="Field">LStateOf</a>

  <a id="HasDReps-NewEpochState"></a><a id="4981" href="Ledger.Conway.Specification.Epoch.html#4981" class="Function">HasDReps-NewEpochState</a> <a id="5004" class="Symbol">:</a> <a id="5006" href="Ledger.Conway.Specification.Gov.Actions.html#7047" class="Record">HasDReps</a> <a id="5015" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="5031" href="Ledger.Conway.Specification.Epoch.html#4981" class="Function">HasDReps-NewEpochState</a> <a id="5054" class="Symbol">.</a><a id="5055" href="Ledger.Conway.Specification.Gov.Actions.html#7096" class="Field">DRepsOf</a> <a id="5063" class="Symbol">=</a> <a id="5065" href="Ledger.Conway.Specification.Gov.Actions.html#7096" class="Field">DRepsOf</a> <a id="5073" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5075" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a>

  <a id="HasRewards-NewEpochState"></a><a id="5090" href="Ledger.Conway.Specification.Epoch.html#5090" class="Function">HasRewards-NewEpochState</a> <a id="5115" class="Symbol">:</a> <a id="5117" href="Ledger.Conway.Specification.Certs.html#1682" class="Record">HasRewards</a> <a id="5128" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="5144" href="Ledger.Conway.Specification.Epoch.html#5090" class="Function">HasRewards-NewEpochState</a> <a id="5169" class="Symbol">.</a><a id="5170" href="Ledger.Conway.Specification.Certs.html#1733" class="Field">RewardsOf</a> <a id="5180" class="Symbol">=</a> <a id="5182" href="Ledger.Conway.Specification.Certs.html#1733" class="Field">RewardsOf</a> <a id="5192" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5194" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a>

  <a id="HasPParams-NewEpochState"></a><a id="5209" href="Ledger.Conway.Specification.Epoch.html#5209" class="Function">HasPParams-NewEpochState</a> <a id="5234" class="Symbol">:</a> <a id="5236" href="Ledger.Conway.Specification.PParams.html#3493" class="Record">HasPParams</a> <a id="5247" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>
  <a id="5263" href="Ledger.Conway.Specification.Epoch.html#5209" class="Function">HasPParams-NewEpochState</a> <a id="5288" class="Symbol">.</a><a id="5289" href="Ledger.Conway.Specification.PParams.html#3544" class="Field">PParamsOf</a> <a id="5299" class="Symbol">=</a> <a id="5301" href="Ledger.Conway.Specification.PParams.html#3544" class="Field">PParamsOf</a> <a id="5311" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5313" href="Ledger.Conway.Specification.Epoch.html#2112" class="Field">EpochStateOf</a>

  <a id="5329" class="Keyword">unquoteDecl</a> <a id="HasCast-EpochState"></a><a id="5341" href="Ledger.Conway.Specification.Epoch.html#5341" class="Function">HasCast-EpochState</a> <a id="HasCast-NewEpochState"></a><a id="5360" href="Ledger.Conway.Specification.Epoch.html#5360" class="Function">HasCast-NewEpochState</a> <a id="5382" class="Symbol">=</a> <a id="5384" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="5403" class="Symbol">(</a> <a id="5405" class="Symbol">(</a><a id="5406" class="Keyword">quote</a> <a id="5412" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>     <a id="5427" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5429" href="Ledger.Conway.Specification.Epoch.html#5341" class="Function">HasCast-EpochState</a><a id="5447" class="Symbol">)</a>
    <a id="5453" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5455" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="5457" class="Symbol">(</a><a id="5458" class="Keyword">quote</a> <a id="5464" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a>  <a id="5479" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5481" href="Ledger.Conway.Specification.Epoch.html#5360" class="Function">HasCast-NewEpochState</a><a id="5502" class="Symbol">)</a><a id="5503" href="Data.List.Base.html#4907" class="Function Operator">]</a><a id="5504" class="Symbol">)</a>

<a id="toRewardAddress"></a><a id="5507" href="Ledger.Conway.Specification.Epoch.html#5507" class="Function">toRewardAddress</a> <a id="5523" class="Symbol">:</a> <a id="5525" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="5536" class="Symbol">→</a> <a id="5538" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a>
<a id="5552" href="Ledger.Conway.Specification.Epoch.html#5507" class="Function">toRewardAddress</a> <a id="5568" href="Ledger.Conway.Specification.Epoch.html#5568" class="Bound">x</a> <a id="5570" class="Symbol">=</a> <a id="5572" class="Keyword">record</a> <a id="5579" class="Symbol">{</a> <a id="5581" href="Ledger.Core.Specification.Address.html#1352" class="Field">net</a> <a id="5585" class="Symbol">=</a> <a id="5587" href="Ledger.Core.Specification.Epoch.html#2703" class="Function">NetworkId</a> <a id="5597" class="Symbol">;</a> <a id="5599" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a> <a id="5605" class="Symbol">=</a> <a id="5607" href="Ledger.Conway.Specification.Epoch.html#5568" class="Bound">x</a> <a id="5609" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="5612" href="Ledger.Conway.Specification.Epoch.html#5612" class="Function">getStakeCred</a> <a id="5625" class="Symbol">:</a> <a id="5627" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="5633" class="Symbol">→</a> <a id="5635" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5641" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
<a id="5652" href="Ledger.Conway.Specification.Epoch.html#5612" class="Function">getStakeCred</a> <a id="5665" class="Symbol">(</a><a id="5666" href="Ledger.Conway.Specification.Epoch.html#5666" class="Bound">a</a> <a id="5668" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5670" class="Symbol">_</a> <a id="5672" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5674" class="Symbol">_</a> <a id="5676" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5678" class="Symbol">_)</a> <a id="5681" class="Symbol">=</a> <a id="5683" href="Ledger.Core.Specification.Address.html#2719" class="Function">stakeCred</a> <a id="5693" href="Ledger.Conway.Specification.Epoch.html#5666" class="Bound">a</a>

<a id="5696" class="Keyword">open</a> <a id="5701" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Module">GovActionState</a> <a id="5716" class="Keyword">using</a> <a id="5722" class="Symbol">(</a><a id="5723" href="Ledger.Conway.Specification.Gov.Actions.html#3889" class="Field">returnAddr</a><a id="5733" class="Symbol">)</a>

<a id="5736" class="Keyword">opaque</a>


  <a id="createRUpd"></a><a id="5747" href="Ledger.Conway.Specification.Epoch.html#5747" class="Function">createRUpd</a> <a id="5758" class="Symbol">:</a> <a id="5760" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5762" class="Symbol">→</a> <a id="5764" href="Ledger.Conway.Specification.Rewards.html#4906" class="Function">BlocksMade</a> <a id="5775" class="Symbol">→</a> <a id="5777" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a> <a id="5788" class="Symbol">→</a> <a id="5790" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a> <a id="5795" class="Symbol">→</a> <a id="5797" href="Ledger.Conway.Specification.Rewards.html#6249" class="Record">RewardUpdate</a>
  <a id="5812" href="Ledger.Conway.Specification.Epoch.html#5747" class="Function">createRUpd</a> <a id="5823" href="Ledger.Conway.Specification.Epoch.html#5823" class="Bound">slotsPerEpoch</a> <a id="5837" href="Ledger.Conway.Specification.Epoch.html#5837" class="Bound">b</a> <a id="5839" href="Ledger.Conway.Specification.Epoch.html#5839" class="Bound">es</a> <a id="5842" href="Ledger.Conway.Specification.Epoch.html#5842" class="Bound">total</a> <a id="5848" class="Symbol">=</a>
    <a id="5854" class="Keyword">record</a>  <a id="5862" class="Symbol">{</a> <a id="5864" href="Ledger.Conway.Specification.Rewards.html#6286" class="Field">Δt</a> <a id="5867" class="Symbol">=</a> <a id="5869" href="Ledger.Conway.Specification.Epoch.html#6825" class="Function">Δt₁</a>
            <a id="5885" class="Symbol">;</a> <a id="5887" href="Ledger.Conway.Specification.Rewards.html#6289" class="Field">Δr</a> <a id="5890" class="Symbol">=</a> <a id="5892" class="Number">0</a> <a id="5894" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="5896" href="Ledger.Conway.Specification.Epoch.html#6811" class="Function">Δr₁</a> <a id="5900" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5902" href="Ledger.Conway.Specification.Epoch.html#7147" class="Function">Δr₂</a>
            <a id="5918" class="Symbol">;</a> <a id="5920" href="Ledger.Conway.Specification.Rewards.html#6292" class="Field">Δf</a> <a id="5923" class="Symbol">=</a> <a id="5925" class="Number">0</a> <a id="5927" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="5929" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="5933" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a>
            <a id="5951" class="Symbol">;</a> <a id="5953" href="Ledger.Conway.Specification.Rewards.html#6312" class="Field">rs</a> <a id="5956" class="Symbol">=</a> <a id="5958" href="Ledger.Conway.Specification.Epoch.html#7052" class="Function">rs</a>


            <a id="5975" class="Symbol">;</a> <a id="5977" href="Ledger.Conway.Specification.Rewards.html#6342" class="Field">flowConservation</a> <a id="5994" class="Symbol">=</a> <a id="5996" href="Ledger.Conway.Specification.Epoch.html#7440" class="Function">flowConservation</a>
            <a id="6025" class="Symbol">;</a> <a id="6027" href="Ledger.Conway.Specification.Rewards.html#6405" class="Field">Δt-nonnegative</a> <a id="6042" class="Symbol">=</a> <a id="6044" href="Ledger.Conway.Specification.Epoch.html#8578" class="Function">Δt-nonneg</a>
            <a id="6066" class="Symbol">;</a> <a id="6068" href="Ledger.Conway.Specification.Rewards.html#6436" class="Field">Δf-nonpositive</a> <a id="6083" class="Symbol">=</a> <a id="6085" href="Ledger.Conway.Specification.Epoch.html#8760" class="Function">Δf-nonpos</a>


            <a id="6109" class="Symbol">}</a>
    <a id="6115" class="Keyword">where</a>
      <a id="6127" href="Ledger.Conway.Specification.Epoch.html#6127" class="Function">prevPp</a> <a id="6134" class="Symbol">:</a> <a id="6136" href="Ledger.Conway.Specification.PParams.html#1689" class="Record">PParams</a>
      <a id="6150" href="Ledger.Conway.Specification.Epoch.html#6127" class="Function">prevPp</a> <a id="6157" class="Symbol">=</a> <a id="6159" href="Ledger.Conway.Specification.PParams.html#3544" class="Field">PParamsOf</a> <a id="6169" href="Ledger.Conway.Specification.Epoch.html#5839" class="Bound">es</a>

      <a id="6179" href="Ledger.Conway.Specification.Epoch.html#6179" class="Function">reserves</a> <a id="6188" class="Symbol">:</a> <a id="6190" href="Ledger.Prelude.Base.html#191" class="Function">Reserves</a>
      <a id="6205" href="Ledger.Conway.Specification.Epoch.html#6179" class="Function">reserves</a> <a id="6214" class="Symbol">=</a> <a id="6216" href="Ledger.Prelude.Base.html#773" class="Field">ReservesOf</a> <a id="6227" href="Ledger.Conway.Specification.Epoch.html#5839" class="Bound">es</a>

      <a id="6237" href="Ledger.Conway.Specification.Epoch.html#6237" class="Function">pstakego</a> <a id="6246" class="Symbol">:</a> <a id="6248" href="Ledger.Conway.Specification.Rewards.html#6472" class="Record">Snapshot</a>
      <a id="6263" href="Ledger.Conway.Specification.Epoch.html#6237" class="Function">pstakego</a> <a id="6272" class="Symbol">=</a> <a id="6274" class="Symbol">(</a><a id="6275" href="Ledger.Conway.Specification.Rewards.html#7863" class="Field">SnapshotsOf</a> <a id="6287" href="Ledger.Conway.Specification.Epoch.html#5839" class="Bound">es</a><a id="6289" class="Symbol">)</a> <a id="6291" class="Symbol">.</a><a id="6292" href="Ledger.Conway.Specification.Rewards.html#7762" class="Field">Snapshots.go</a>

      <a id="6312" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a> <a id="6318" class="Symbol">:</a> <a id="6320" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
      <a id="6331" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a> <a id="6337" class="Symbol">=</a> <a id="6339" href="Ledger.Prelude.Base.html#669" class="Field">FeesOf</a> <a id="6346" class="Symbol">(</a><a id="6347" href="Ledger.Conway.Specification.Rewards.html#7863" class="Field">SnapshotsOf</a> <a id="6359" href="Ledger.Conway.Specification.Epoch.html#5839" class="Bound">es</a><a id="6361" class="Symbol">)</a>

      <a id="6370" href="Ledger.Conway.Specification.Epoch.html#6370" class="Function">stake</a> <a id="6376" class="Symbol">:</a> <a id="6378" href="Ledger.Conway.Specification.Certs.html#1327" class="Function">Stake</a>
      <a id="6390" href="Ledger.Conway.Specification.Epoch.html#6370" class="Function">stake</a> <a id="6396" class="Symbol">=</a> <a id="6398" href="Ledger.Conway.Specification.Certs.html#1814" class="Field">StakeOf</a> <a id="6406" href="Ledger.Conway.Specification.Epoch.html#6237" class="Function">pstakego</a>

      <a id="6422" href="Ledger.Conway.Specification.Epoch.html#6422" class="Function">delegs</a> <a id="6429" class="Symbol">:</a> <a id="6431" href="Ledger.Conway.Specification.Certs.html#1367" class="Function">StakeDelegs</a>
      <a id="6449" href="Ledger.Conway.Specification.Epoch.html#6422" class="Function">delegs</a> <a id="6456" class="Symbol">=</a> <a id="6458" href="Ledger.Conway.Specification.Certs.html#1898" class="Field">StakeDelegsOf</a> <a id="6472" href="Ledger.Conway.Specification.Epoch.html#6237" class="Function">pstakego</a>

      <a id="6488" href="Ledger.Conway.Specification.Epoch.html#6488" class="Function">poolParams</a> <a id="6499" class="Symbol">:</a> <a id="6501" href="Ledger.Conway.Specification.Certs.html#1191" class="Function">Pools</a>
      <a id="6513" href="Ledger.Conway.Specification.Epoch.html#6488" class="Function">poolParams</a> <a id="6524" class="Symbol">=</a> <a id="6526" href="Ledger.Conway.Specification.Certs.html#1568" class="Field">PoolsOf</a> <a id="6534" href="Ledger.Conway.Specification.Epoch.html#6237" class="Function">pstakego</a>

      <a id="6550" href="Ledger.Conway.Specification.Epoch.html#6550" class="Function">blocksMade</a> <a id="6561" class="Symbol">:</a> <a id="6563" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
      <a id="6571" href="Ledger.Conway.Specification.Epoch.html#6550" class="Function">blocksMade</a> <a id="6582" class="Symbol">=</a> <a id="6584" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="6587" href="Ledger.Conway.Specification.Epoch.html#6587" class="Bound">m</a> <a id="6589" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="6591" href="Ledger.Conway.Specification.Epoch.html#5837" class="Bound">b</a> <a id="6593" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="6595" href="Ledger.Conway.Specification.Epoch.html#6587" class="Bound">m</a>

      <a id="6604" href="Ledger.Conway.Specification.Epoch.html#6604" class="Function">ρ</a> <a id="6606" href="Ledger.Conway.Specification.Epoch.html#6606" class="Function">η</a> <a id="6608" href="Ledger.Conway.Specification.Epoch.html#6608" class="Function">τ</a> <a id="6610" class="Symbol">:</a> <a id="6612" href="Data.Rational.Base.html#1421" class="Record">ℚ</a>
      <a id="6620" href="Ledger.Conway.Specification.Epoch.html#6604" class="Function">ρ</a> <a id="6622" class="Symbol">=</a> <a id="6624" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a> <a id="6641" class="Symbol">(</a><a id="6642" href="Ledger.Conway.Specification.Epoch.html#6127" class="Function">prevPp</a> <a id="6649" class="Symbol">.</a><a id="6650" href="Ledger.Conway.Specification.PParams.html#2285" class="Field">PParams.monetaryExpansion</a><a id="6675" class="Symbol">)</a>
      <a id="6683" href="Ledger.Conway.Specification.Epoch.html#6606" class="Function">η</a> <a id="6685" class="Symbol">=</a> <a id="6687" href="Ledger.Conway.Specification.Epoch.html#1839" class="Function">fromℕ</a> <a id="6693" href="Ledger.Conway.Specification.Epoch.html#6550" class="Function">blocksMade</a> <a id="6704" href="Ledger.Prelude.html#2064" class="Function Operator">÷₀</a> <a id="6707" class="Symbol">(</a><a id="6708" href="Ledger.Conway.Specification.Epoch.html#1839" class="Function">fromℕ</a> <a id="6714" href="Ledger.Conway.Specification.Epoch.html#5823" class="Bound">slotsPerEpoch</a> <a id="6728" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6730" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a><a id="6745" class="Symbol">)</a>
      <a id="6753" href="Ledger.Conway.Specification.Epoch.html#6608" class="Function">τ</a> <a id="6755" class="Symbol">=</a> <a id="6757" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a> <a id="6774" class="Symbol">(</a><a id="6775" href="Ledger.Conway.Specification.Epoch.html#6127" class="Function">prevPp</a> <a id="6782" class="Symbol">.</a><a id="6783" href="Ledger.Conway.Specification.PParams.html#2355" class="Field">PParams.treasuryCut</a><a id="6802" class="Symbol">)</a>

      <a id="6811" href="Ledger.Conway.Specification.Epoch.html#6811" class="Function">Δr₁</a> <a id="6815" href="Ledger.Conway.Specification.Epoch.html#6815" class="Function">rewardPot</a> <a id="6825" href="Ledger.Conway.Specification.Epoch.html#6825" class="Function">Δt₁</a> <a id="6829" href="Ledger.Conway.Specification.Epoch.html#6829" class="Function">R</a> <a id="6831" class="Symbol">:</a> <a id="6833" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
      <a id="6841" href="Ledger.Conway.Specification.Epoch.html#6811" class="Function">Δr₁</a> <a id="6845" class="Symbol">=</a> <a id="6847" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="6853" class="Symbol">(</a><a id="6854" class="Number">1</a> <a id="6856" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="6858" href="Ledger.Conway.Specification.Epoch.html#6606" class="Function">η</a> <a id="6860" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6862" href="Ledger.Conway.Specification.Epoch.html#6604" class="Function">ρ</a> <a id="6864" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6866" href="Ledger.Conway.Specification.Epoch.html#1839" class="Function">fromℕ</a> <a id="6872" href="Ledger.Conway.Specification.Epoch.html#6179" class="Function">reserves</a><a id="6880" class="Symbol">)</a>
      <a id="6888" href="Ledger.Conway.Specification.Epoch.html#6815" class="Function">rewardPot</a> <a id="6898" class="Symbol">=</a> <a id="6900" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="6904" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a> <a id="6910" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6912" href="Ledger.Conway.Specification.Epoch.html#6811" class="Function">Δr₁</a>
      <a id="6922" href="Ledger.Conway.Specification.Epoch.html#6825" class="Function">Δt₁</a> <a id="6926" class="Symbol">=</a> <a id="6928" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="6934" class="Symbol">(</a><a id="6935" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="6941" href="Ledger.Conway.Specification.Epoch.html#6815" class="Function">rewardPot</a> <a id="6951" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6953" href="Ledger.Conway.Specification.Epoch.html#6608" class="Function">τ</a><a id="6954" class="Symbol">)</a>
      <a id="6962" href="Ledger.Conway.Specification.Epoch.html#6829" class="Function">R</a> <a id="6964" class="Symbol">=</a> <a id="6966" href="Ledger.Conway.Specification.Epoch.html#6815" class="Function">rewardPot</a> <a id="6976" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="6978" href="Ledger.Conway.Specification.Epoch.html#6825" class="Function">Δt₁</a>

      <a id="6989" href="Ledger.Conway.Specification.Epoch.html#6989" class="Function">circulation</a> <a id="7001" class="Symbol">:</a> <a id="7003" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="7014" href="Ledger.Conway.Specification.Epoch.html#6989" class="Function">circulation</a> <a id="7026" class="Symbol">=</a> <a id="7028" href="Ledger.Conway.Specification.Epoch.html#5842" class="Bound">total</a> <a id="7034" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7036" href="Ledger.Conway.Specification.Epoch.html#6179" class="Function">reserves</a>

      <a id="7052" href="Ledger.Conway.Specification.Epoch.html#7052" class="Function">rs</a> <a id="7055" class="Symbol">:</a> <a id="7057" href="Ledger.Conway.Specification.Certs.html#1283" class="Function">Rewards</a>
      <a id="7071" href="Ledger.Conway.Specification.Epoch.html#7052" class="Function">rs</a> <a id="7074" class="Symbol">=</a> <a id="7076" href="Ledger.Conway.Specification.Rewards.html#5397" class="Function">reward</a> <a id="7083" href="Ledger.Conway.Specification.Epoch.html#6127" class="Function">prevPp</a> <a id="7090" href="Ledger.Conway.Specification.Epoch.html#5837" class="Bound">b</a> <a id="7092" class="Symbol">(</a><a id="7093" href="Prelude.html#3280" class="Function">posPart</a> <a id="7101" href="Ledger.Conway.Specification.Epoch.html#6829" class="Function">R</a><a id="7102" class="Symbol">)</a> <a id="7104" href="Ledger.Conway.Specification.Epoch.html#6488" class="Function">poolParams</a> <a id="7115" href="Ledger.Conway.Specification.Epoch.html#6370" class="Function">stake</a> <a id="7121" href="Ledger.Conway.Specification.Epoch.html#6422" class="Function">delegs</a> <a id="7128" href="Ledger.Conway.Specification.Epoch.html#6989" class="Function">circulation</a>

      <a id="7147" href="Ledger.Conway.Specification.Epoch.html#7147" class="Function">Δr₂</a> <a id="7151" class="Symbol">:</a> <a id="7153" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
      <a id="7161" href="Ledger.Conway.Specification.Epoch.html#7147" class="Function">Δr₂</a> <a id="7165" class="Symbol">=</a> <a id="7167" href="Ledger.Conway.Specification.Epoch.html#6829" class="Function">R</a> <a id="7169" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7171" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="7175" class="Symbol">(</a><a id="7176" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7179" href="Ledger.Conway.Specification.Epoch.html#7179" class="Bound">c</a> <a id="7181" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7183" href="Ledger.Conway.Specification.Epoch.html#7052" class="Function">rs</a> <a id="7186" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7188" href="Ledger.Conway.Specification.Epoch.html#7179" class="Bound">c</a><a id="7189" class="Symbol">)</a>


      <a id="7199" class="Comment">-- Proofs</a>
      <a id="7215" class="Comment">-- Note: Overloading of + and - seems to interfere with the ring solver.</a>
      <a id="7294" href="Ledger.Conway.Specification.Epoch.html#7294" class="Function">lemmaFlow</a> <a id="7304" class="Symbol">:</a> <a id="7306" class="Symbol">∀</a> <a id="7308" class="Symbol">(</a><a id="7309" href="Ledger.Conway.Specification.Epoch.html#7309" class="Bound">t₁</a> <a id="7312" href="Ledger.Conway.Specification.Epoch.html#7312" class="Bound">r₁</a> <a id="7315" href="Ledger.Conway.Specification.Epoch.html#7315" class="Bound">f</a> <a id="7317" href="Ledger.Conway.Specification.Epoch.html#7317" class="Bound">z</a> <a id="7319" class="Symbol">:</a> <a id="7321" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="7322" class="Symbol">)</a>
        <a id="7332" class="Symbol">→</a> <a id="7334" class="Symbol">(</a><a id="7335" href="Ledger.Conway.Specification.Epoch.html#7309" class="Bound">t₁</a> <a id="7338" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7342" class="Symbol">(</a><a id="7343" class="Number">0</a> <a id="7345" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7349" href="Ledger.Conway.Specification.Epoch.html#7312" class="Bound">r₁</a> <a id="7352" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7356" class="Symbol">((</a><a id="7358" href="Ledger.Conway.Specification.Epoch.html#7315" class="Bound">f</a> <a id="7360" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7364" href="Ledger.Conway.Specification.Epoch.html#7312" class="Bound">r₁</a> <a id="7367" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7371" href="Ledger.Conway.Specification.Epoch.html#7309" class="Bound">t₁</a><a id="7373" class="Symbol">)</a> <a id="7375" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7379" href="Ledger.Conway.Specification.Epoch.html#7317" class="Bound">z</a><a id="7380" class="Symbol">))</a> <a id="7383" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7387" class="Symbol">(</a><a id="7388" class="Number">0</a> <a id="7390" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7394" href="Ledger.Conway.Specification.Epoch.html#7315" class="Bound">f</a><a id="7395" class="Symbol">)</a> <a id="7397" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7401" href="Ledger.Conway.Specification.Epoch.html#7317" class="Bound">z</a><a id="7402" class="Symbol">)</a> <a id="7404" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7406" class="Number">0</a>
      <a id="7414" href="Ledger.Conway.Specification.Epoch.html#7294" class="Function">lemmaFlow</a> <a id="7424" class="Symbol">=</a> <a id="7426" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a>
      <a id="7440" href="Ledger.Conway.Specification.Epoch.html#7440" class="Function">flowConservation</a> <a id="7457" class="Symbol">:</a>
        <a id="7467" class="Keyword">let</a> <a id="7471" href="Ledger.Conway.Specification.Epoch.html#7471" class="Bound">t₁</a> <a id="7474" class="Symbol">=</a> <a id="7476" href="Ledger.Conway.Specification.Epoch.html#6825" class="Function">Δt₁</a>
            <a id="7492" href="Ledger.Conway.Specification.Epoch.html#7492" class="Bound">r₁</a> <a id="7495" class="Symbol">=</a> <a id="7497" href="Ledger.Conway.Specification.Epoch.html#6811" class="Function">Δr₁</a>
            <a id="7513" href="Ledger.Conway.Specification.Epoch.html#7513" class="Bound">f</a>  <a id="7516" class="Symbol">=</a> <a id="7518" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="7522" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a>
            <a id="7540" href="Ledger.Conway.Specification.Epoch.html#7540" class="Bound">z</a>  <a id="7543" class="Symbol">=</a> <a id="7545" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="7549" class="Symbol">(</a><a id="7550" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7553" href="Ledger.Conway.Specification.Epoch.html#7553" class="Bound">c</a> <a id="7555" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7557" href="Ledger.Conway.Specification.Epoch.html#7052" class="Function">rs</a> <a id="7560" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7562" href="Ledger.Conway.Specification.Epoch.html#7553" class="Bound">c</a><a id="7563" class="Symbol">)</a>
         <a id="7574" class="Keyword">in</a>
            <a id="7589" class="Symbol">(</a><a id="7590" href="Ledger.Conway.Specification.Epoch.html#7471" class="Bound">t₁</a> <a id="7593" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7597" class="Symbol">(</a><a id="7598" class="Number">0</a> <a id="7600" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7604" href="Ledger.Conway.Specification.Epoch.html#7492" class="Bound">r₁</a> <a id="7607" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7611" class="Symbol">((</a><a id="7613" href="Ledger.Conway.Specification.Epoch.html#7513" class="Bound">f</a> <a id="7615" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7619" href="Ledger.Conway.Specification.Epoch.html#7492" class="Bound">r₁</a> <a id="7622" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7626" href="Ledger.Conway.Specification.Epoch.html#7471" class="Bound">t₁</a><a id="7628" class="Symbol">)</a> <a id="7630" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7634" href="Ledger.Conway.Specification.Epoch.html#7540" class="Bound">z</a><a id="7635" class="Symbol">))</a> <a id="7638" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7642" class="Symbol">(</a><a id="7643" class="Number">0</a> <a id="7645" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7649" href="Ledger.Conway.Specification.Epoch.html#7513" class="Bound">f</a><a id="7650" class="Symbol">)</a> <a id="7652" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7656" href="Ledger.Conway.Specification.Epoch.html#7540" class="Bound">z</a><a id="7657" class="Symbol">)</a> <a id="7659" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7661" class="Number">0</a>
      <a id="7669" href="Ledger.Conway.Specification.Epoch.html#7440" class="Function">flowConservation</a> <a id="7686" class="Symbol">=</a> <a id="7688" href="Ledger.Conway.Specification.Epoch.html#7294" class="Function">lemmaFlow</a> <a id="7698" href="Ledger.Conway.Specification.Epoch.html#6825" class="Function">Δt₁</a> <a id="7702" href="Ledger.Conway.Specification.Epoch.html#6811" class="Function">Δr₁</a> <a id="7706" class="Symbol">(</a><a id="7707" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="7711" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a><a id="7716" class="Symbol">)</a> <a id="7718" class="Symbol">(</a><a id="7719" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="7723" class="Symbol">(</a><a id="7724" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7727" href="Ledger.Conway.Specification.Epoch.html#7727" class="Bound">c</a> <a id="7729" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7731" href="Ledger.Conway.Specification.Epoch.html#7052" class="Function">rs</a> <a id="7734" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7736" href="Ledger.Conway.Specification.Epoch.html#7727" class="Bound">c</a><a id="7737" class="Symbol">))</a>

      <a id="7747" href="Ledger.Conway.Specification.Epoch.html#7747" class="Function">÷₀-0≤⇒0≤</a> <a id="7756" class="Symbol">:</a> <a id="7758" class="Symbol">∀</a> <a id="7760" class="Symbol">(</a><a id="7761" href="Ledger.Conway.Specification.Epoch.html#7761" class="Bound">x</a> <a id="7763" href="Ledger.Conway.Specification.Epoch.html#7763" class="Bound">y</a> <a id="7765" class="Symbol">:</a> <a id="7767" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="7768" class="Symbol">)</a> <a id="7770" class="Symbol">→</a> <a id="7772" class="Number">0</a> <a id="7774" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7776" href="Ledger.Conway.Specification.Epoch.html#7761" class="Bound">x</a> <a id="7778" class="Symbol">→</a> <a id="7780" class="Number">0</a> <a id="7782" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7784" href="Ledger.Conway.Specification.Epoch.html#7763" class="Bound">y</a> <a id="7786" class="Symbol">→</a> <a id="7788" class="Number">0</a> <a id="7790" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7792" class="Symbol">(</a><a id="7793" href="Ledger.Conway.Specification.Epoch.html#7761" class="Bound">x</a> <a id="7795" href="Ledger.Prelude.html#2064" class="Function Operator">÷₀</a> <a id="7798" href="Ledger.Conway.Specification.Epoch.html#7763" class="Bound">y</a><a id="7799" class="Symbol">)</a>
      <a id="7807" href="Ledger.Conway.Specification.Epoch.html#7747" class="Function">÷₀-0≤⇒0≤</a> <a id="7816" href="Ledger.Conway.Specification.Epoch.html#7816" class="Bound">x</a> <a id="7818" href="Ledger.Conway.Specification.Epoch.html#7818" class="Bound">y</a> <a id="7820" href="Ledger.Conway.Specification.Epoch.html#7820" class="Bound">0≤x</a> <a id="7824" href="Ledger.Conway.Specification.Epoch.html#7824" class="Bound">0≤y</a> <a id="7828" class="Keyword">with</a> <a id="7833" href="Ledger.Conway.Specification.Epoch.html#7818" class="Bound">y</a> <a id="7835" href="Data.Rational.Properties.html#4152" class="Function Operator">≟</a> <a id="7837" class="Number">0</a>
      <a id="7845" class="Symbol">...</a> <a id="7849" class="Symbol">|</a> <a id="7851" class="Symbol">(</a><a id="7852" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="7856" href="Ledger.Conway.Specification.Epoch.html#7856" class="Bound">y≡0</a><a id="7859" class="Symbol">)</a> <a id="7861" class="Symbol">=</a> <a id="7863" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="7877" class="Number">0</a>
      <a id="7885" class="Symbol">...</a> <a id="7889" class="Symbol">|</a> <a id="7891" class="Symbol">(</a><a id="7892" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="7895" href="Ledger.Conway.Specification.Epoch.html#7895" class="Bound">y≢0</a><a id="7898" class="Symbol">)</a>  <a id="7901" class="Symbol">=</a> <a id="7903" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a> <a id="7911" class="Bound">x</a> <a id="7913" class="Bound">y</a> <a id="7915" class="Symbol">{{</a><a id="7917" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a> <a id="7927" href="Ledger.Conway.Specification.Epoch.html#7895" class="Bound">y≢0</a><a id="7930" class="Symbol">}}</a> <a id="7933" class="Bound">0≤x</a> <a id="7937" class="Bound">0≤y</a>

      <a id="7948" href="Ledger.Conway.Specification.Epoch.html#7948" class="Function">η-nonneg</a> <a id="7957" class="Symbol">:</a> <a id="7959" class="Number">0</a> <a id="7961" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7963" href="Ledger.Conway.Specification.Epoch.html#6606" class="Function">η</a>
      <a id="7971" href="Ledger.Conway.Specification.Epoch.html#7948" class="Function">η-nonneg</a> <a id="7980" class="Symbol">=</a> <a id="7982" href="Ledger.Conway.Specification.Epoch.html#7747" class="Function">÷₀-0≤⇒0≤</a> <a id="7991" class="Symbol">_</a> <a id="7993" class="Symbol">_</a> <a id="7995" class="Symbol">(</a><a id="7996" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="8005" href="Ledger.Conway.Specification.Epoch.html#6550" class="Function">blocksMade</a><a id="8015" class="Symbol">)</a>
        <a id="8025" class="Symbol">(</a><a id="8026" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="8034" class="Symbol">_</a> <a id="8036" class="Symbol">_</a>
          <a id="8048" class="Symbol">(</a><a id="8049" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="8058" href="Ledger.Conway.Specification.Epoch.html#5823" class="Bound">slotsPerEpoch</a><a id="8071" class="Symbol">)</a>
          <a id="8083" class="Symbol">(</a><a id="8084" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="8098" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a> <a id="8114" class="Symbol">{{</a><a id="8116" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a> <a id="8127" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a><a id="8142" class="Symbol">}}))</a>

      <a id="8154" href="Ledger.Conway.Specification.Epoch.html#8154" class="Function">min1η-nonneg</a> <a id="8167" class="Symbol">:</a> <a id="8169" class="Number">0</a> <a id="8171" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8173" class="Number">1</a> <a id="8175" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8177" href="Ledger.Conway.Specification.Epoch.html#6606" class="Function">η</a>
      <a id="8185" href="Ledger.Conway.Specification.Epoch.html#8154" class="Function">min1η-nonneg</a> <a id="8198" class="Symbol">=</a> <a id="8200" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a> <a id="8206" class="Symbol">(</a><a id="8207" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="8221" class="Number">1</a><a id="8222" class="Symbol">)</a> <a id="8224" href="Ledger.Conway.Specification.Epoch.html#7948" class="Function">η-nonneg</a>

      <a id="8240" href="Ledger.Conway.Specification.Epoch.html#8240" class="Function">Δr₁-nonneg</a> <a id="8251" class="Symbol">:</a> <a id="8253" class="Number">0</a> <a id="8255" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8257" href="Ledger.Conway.Specification.Epoch.html#6811" class="Function">Δr₁</a>
      <a id="8267" href="Ledger.Conway.Specification.Epoch.html#8240" class="Function">Δr₁-nonneg</a> <a id="8278" class="Symbol">=</a> <a id="8280" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="8291" class="Symbol">_</a>
        <a id="8301" class="Symbol">(</a><a id="8302" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="8310" class="Symbol">(</a><a id="8311" class="Number">1</a> <a id="8313" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8315" href="Ledger.Conway.Specification.Epoch.html#6606" class="Function">η</a> <a id="8317" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="8319" href="Ledger.Conway.Specification.Epoch.html#6604" class="Function">ρ</a><a id="8320" class="Symbol">)</a> <a id="8322" class="Symbol">(</a><a id="8323" href="Ledger.Conway.Specification.Epoch.html#1839" class="Function">fromℕ</a> <a id="8329" href="Ledger.Conway.Specification.Epoch.html#6179" class="Function">reserves</a><a id="8337" class="Symbol">)</a>
          <a id="8349" class="Symbol">(</a><a id="8350" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a> <a id="8368" class="Symbol">(</a><a id="8369" class="Number">1</a> <a id="8371" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8373" href="Ledger.Conway.Specification.Epoch.html#6606" class="Function">η</a><a id="8374" class="Symbol">)</a> <a id="8376" class="Symbol">(</a><a id="8377" href="Ledger.Conway.Specification.Epoch.html#6127" class="Function">prevPp</a> <a id="8384" class="Symbol">.</a><a id="8385" href="Ledger.Conway.Specification.PParams.html#2285" class="Field">PParams.monetaryExpansion</a><a id="8410" class="Symbol">)</a> <a id="8412" href="Ledger.Conway.Specification.Epoch.html#8154" class="Function">min1η-nonneg</a><a id="8424" class="Symbol">)</a>
          <a id="8436" class="Symbol">(</a><a id="8437" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="8446" href="Ledger.Conway.Specification.Epoch.html#6179" class="Function">reserves</a><a id="8454" class="Symbol">))</a>

      <a id="8464" href="Ledger.Conway.Specification.Epoch.html#8464" class="Function">rewardPot-nonneg</a> <a id="8481" class="Symbol">:</a> <a id="8483" class="Number">0</a> <a id="8485" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8487" href="Ledger.Conway.Specification.Epoch.html#6815" class="Function">rewardPot</a>
      <a id="8503" href="Ledger.Conway.Specification.Epoch.html#8464" class="Function">rewardPot-nonneg</a> <a id="8520" class="Symbol">=</a> <a id="8522" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a> <a id="8531" class="Symbol">(</a><a id="8532" href="Ledger.Conway.Specification.Epoch.html#598" class="Function">nonNegative⁻¹ℤ</a> <a id="8547" class="Symbol">(</a><a id="8548" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="8552" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a><a id="8557" class="Symbol">))</a> <a id="8560" href="Ledger.Conway.Specification.Epoch.html#8240" class="Function">Δr₁-nonneg</a>

      <a id="8578" href="Ledger.Conway.Specification.Epoch.html#8578" class="Function">Δt-nonneg</a> <a id="8588" class="Symbol">:</a> <a id="8590" class="Number">0</a> <a id="8592" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8594" href="Ledger.Conway.Specification.Epoch.html#6825" class="Function">Δt₁</a>
      <a id="8604" href="Ledger.Conway.Specification.Epoch.html#8578" class="Function">Δt-nonneg</a> <a id="8614" class="Symbol">=</a> <a id="8616" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="8627" class="Symbol">_</a>
        <a id="8637" class="Symbol">(</a><a id="8638" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a> <a id="8656" class="Symbol">(</a><a id="8657" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="8663" href="Ledger.Conway.Specification.Epoch.html#6815" class="Function">rewardPot</a><a id="8672" class="Symbol">)</a> <a id="8674" class="Symbol">(</a><a id="8675" href="Ledger.Conway.Specification.Epoch.html#6127" class="Function">prevPp</a> <a id="8682" class="Symbol">.</a><a id="8683" href="Ledger.Conway.Specification.PParams.html#2355" class="Field">PParams.treasuryCut</a><a id="8702" class="Symbol">)</a>
          <a id="8714" class="Symbol">(</a><a id="8715" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a> <a id="8724" href="Ledger.Conway.Specification.Epoch.html#6815" class="Function">rewardPot</a> <a id="8734" href="Ledger.Conway.Specification.Epoch.html#8464" class="Function">rewardPot-nonneg</a><a id="8750" class="Symbol">))</a>

      <a id="8760" href="Ledger.Conway.Specification.Epoch.html#8760" class="Function">Δf-nonpos</a> <a id="8770" class="Symbol">:</a> <a id="8772" class="Symbol">(</a><a id="8773" class="Number">0</a> <a id="8775" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="8777" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="8781" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a><a id="8786" class="Symbol">)</a> <a id="8788" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8790" class="Number">0</a>
      <a id="8798" href="Ledger.Conway.Specification.Epoch.html#8760" class="Function">Δf-nonpos</a> <a id="8808" class="Symbol">=</a> <a id="8810" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
          <a id="8826" class="Number">0</a> <a id="8828" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="8830" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="8834" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a> <a id="8840" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="8843" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a> <a id="8855" class="Symbol">_</a> <a id="8857" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
          <a id="8869" href="Data.Integer.Base.html#4719" class="Function Operator">ℤ.-</a> <a id="8873" href="Ledger.Conway.Specification.Epoch.html#416" class="InductiveConstructor">pos</a> <a id="8877" href="Ledger.Conway.Specification.Epoch.html#6312" class="Function">feeSS</a> <a id="8883" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="8886" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a> <a id="8897" class="Symbol">(</a><a id="8898" href="Data.Integer.Base.html#2106" class="InductiveConstructor">ℤ.+≤+</a> <a id="8904" href="Data.Nat.Base.html#1720" class="InductiveConstructor">z≤n</a><a id="8907" class="Symbol">)</a> <a id="8909" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
          <a id="8921" class="Number">0</a>             <a id="8935" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="8945" class="Keyword">where</a> <a id="8951" class="Keyword">open</a> <a id="8956" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a>


<a id="applyRUpd"></a><a id="8970" href="Ledger.Conway.Specification.Epoch.html#8970" class="Function">applyRUpd</a> <a id="8980" class="Symbol">:</a> <a id="8982" href="Ledger.Conway.Specification.Rewards.html#6249" class="Record">RewardUpdate</a> <a id="8995" class="Symbol">→</a> <a id="8997" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a> <a id="9008" class="Symbol">→</a> <a id="9010" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
<a id="9021" href="Ledger.Conway.Specification.Epoch.html#8970" class="Function">applyRUpd</a> <a id="9031" href="Ledger.Conway.Specification.Epoch.html#9031" class="Bound">rewardUpdate</a> <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9048}{\htmlId{9048}{\htmlClass{Bound}{\text{treasury}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9059}{\htmlId{9059}{\htmlClass{Bound}{\text{reserves}}}}\, \end{pmatrix}
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9096}{\htmlId{9096}{\htmlClass{Bound}{\text{ss}}}}\,
                       \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9128}{\htmlId{9128}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9135}{\htmlId{9135}{\htmlClass{Bound}{\text{fees}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9142}{\htmlId{9142}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9153}{\htmlId{9153}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
                         \\ \,\href{Ledger.Conway.Specification.Epoch.html#9193}{\htmlId{9193}{\htmlClass{Bound}{\text{govSt}}}}\,
                         \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9230}{\htmlId{9230}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9243}{\htmlId{9243}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9257}{\htmlId{9257}{\htmlClass{Bound}{\text{rewards}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#9270}{\htmlId{9270}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9279}{\htmlId{9279}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9318}{\htmlId{9318}{\htmlClass{Bound}{\text{es}}}}\,
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9346}{\htmlId{9346}{\htmlClass{Bound}{\text{fut}}}}\,
                       \end{pmatrix}$</a> <a id="9377" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Prelude.html#3280}{\htmlId{9383}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9391}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#416}{\htmlId{9392}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9048}{\htmlId{9396}{\htmlClass{Bound}{\text{treasury}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9405}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6286}{\htmlId{9407}{\htmlClass{Function}{\text{Δt}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9410}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#416}{\htmlId{9412}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9967}{\htmlId{9416}{\htmlClass{Function}{\text{unregRU&#39;}}}}\,\,\htmlId{9424}{\htmlClass{Symbol}{\text{)}}}\,
                               \\ \,\href{Prelude.html#3280}{\htmlId{9459}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9467}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#416}{\htmlId{9468}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9059}{\htmlId{9472}{\htmlClass{Bound}{\text{reserves}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9481}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6289}{\htmlId{9483}{\htmlClass{Function}{\text{Δr}}}}\,\,\htmlId{9485}{\htmlClass{Symbol}{\text{)}}}\, \end{pmatrix}
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9096}{\htmlId{9520}{\htmlClass{Bound}{\text{ss}}}}\,
                             \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9128}{\htmlId{9558}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Prelude.html#3280}{\htmlId{9565}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9573}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#416}{\htmlId{9574}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9135}{\htmlId{9578}{\htmlClass{Bound}{\text{fees}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9583}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6292}{\htmlId{9585}{\htmlClass{Function}{\text{Δf}}}}\,\,\htmlId{9587}{\htmlClass{Symbol}{\text{)}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9142}{\htmlId{9591}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9153}{\htmlId{9602}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
                               \\ \,\href{Ledger.Conway.Specification.Epoch.html#9193}{\htmlId{9647}{\htmlClass{Bound}{\text{govSt}}}}\,
                               \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9230}{\htmlId{9690}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9243}{\htmlId{9703}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9257}{\htmlId{9717}{\htmlClass{Bound}{\text{rewards}}}}\, \,\href{Axiom.Set.Map.Dec.html#2149}{\htmlId{9725}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9899}{\htmlId{9728}{\htmlClass{Function}{\text{regRU}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#9270}{\htmlId{9738}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9279}{\htmlId{9747}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9318}{\htmlId{9789}{\htmlClass{Bound}{\text{es}}}}\,
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9346}{\htmlId{9823}{\htmlClass{Bound}{\text{fut}}}}\, \end{pmatrix}$</a>
  <a id="9831" class="Keyword">where</a>
    <a id="9841" class="Keyword">open</a> <a id="9846" href="Ledger.Conway.Specification.Rewards.html#6249" class="Module">RewardUpdate</a> <a id="9859" href="Ledger.Conway.Specification.Epoch.html#9031" class="Bound">rewardUpdate</a> <a id="9872" class="Keyword">using</a> <a id="9878" class="Symbol">(</a><a id="9879" href="Ledger.Conway.Specification.Rewards.html#6286" class="Field">Δt</a><a id="9881" class="Symbol">;</a> <a id="9883" href="Ledger.Conway.Specification.Rewards.html#6289" class="Field">Δr</a><a id="9885" class="Symbol">;</a> <a id="9887" href="Ledger.Conway.Specification.Rewards.html#6292" class="Field">Δf</a><a id="9889" class="Symbol">;</a> <a id="9891" href="Ledger.Conway.Specification.Rewards.html#6312" class="Field">rs</a><a id="9893" class="Symbol">)</a>
    <a id="9899" href="Ledger.Conway.Specification.Epoch.html#9899" class="Function">regRU</a>     <a id="9909" class="Symbol">=</a> <a id="9911" href="Ledger.Conway.Specification.Rewards.html#6312" class="Function">rs</a> <a id="9914" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="9916" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9920" href="Ledger.Conway.Specification.Epoch.html#9257" class="Bound">rewards</a>
    <a id="9932" href="Ledger.Conway.Specification.Epoch.html#9932" class="Function">unregRU</a>   <a id="9942" class="Symbol">=</a> <a id="9944" href="Ledger.Conway.Specification.Rewards.html#6312" class="Function">rs</a> <a id="9947" href="Axiom.Set.Map.html#13606" class="Function Operator">∣</a> <a id="9949" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9953" href="Ledger.Conway.Specification.Epoch.html#9257" class="Bound">rewards</a> <a id="9961" href="Axiom.Set.Map.html#13606" class="Function Operator">ᶜ</a>
    <a id="9967" href="Ledger.Conway.Specification.Epoch.html#9967" class="Function">unregRU&#39;</a>  <a id="9977" class="Symbol">=</a> <a id="9979" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="9982" href="Ledger.Conway.Specification.Epoch.html#9982" class="Bound">x</a> <a id="9984" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="9986" href="Ledger.Conway.Specification.Epoch.html#9932" class="Function">unregRU</a> <a id="9994" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="9996" href="Ledger.Conway.Specification.Epoch.html#9982" class="Bound">x</a>


<a id="10000" class="Keyword">open</a> <a id="10005" href="Ledger.Core.Specification.Address.html#1313" class="Module">RewardAddress</a> <a id="10019" class="Keyword">using</a> <a id="10025" class="Symbol">(</a><a id="10026" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a><a id="10031" class="Symbol">)</a>
<a id="10033" class="Keyword">opaque</a>


  <a id="calculatePoolDelegatedStake"></a><a id="10044" href="Ledger.Conway.Specification.Epoch.html#10044" class="Function">calculatePoolDelegatedStake</a>
    <a id="10076" class="Symbol">:</a> <a id="10078" href="Ledger.Conway.Specification.Rewards.html#6472" class="Record">Snapshot</a>
    <a id="10091" class="Symbol">→</a> <a id="10093" href="Ledger.Conway.Specification.Epoch.html#3536" class="Function">PoolDelegatedStake</a>
  <a id="10114" href="Ledger.Conway.Specification.Epoch.html#10044" class="Function">calculatePoolDelegatedStake</a> <a id="10142" href="Ledger.Conway.Specification.Epoch.html#10142" class="Bound">ss</a> <a id="10145" class="Symbol">=</a>
      <a id="10153" class="Comment">-- Shelley spec: the output map must contain keys appearing in both</a>
      <a id="10227" class="Comment">-- sd and the pool parameters.</a>
      <a id="10264" href="Ledger.Conway.Specification.Epoch.html#10500" class="Function">sd</a> <a id="10267" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="10269" href="Class.IsSet.html#916" class="Function">dom</a> <a id="10273" class="Symbol">(</a><a id="10274" href="Ledger.Conway.Specification.Certs.html#1568" class="Field">PoolsOf</a> <a id="10282" href="Ledger.Conway.Specification.Epoch.html#10142" class="Bound">ss</a><a id="10284" class="Symbol">)</a>
    <a id="10290" class="Keyword">where</a>
      <a id="10302" class="Comment">-- stake credentials delegating to each pool</a>
      <a id="10353" href="Ledger.Conway.Specification.Epoch.html#10353" class="Function">stakeCredentialsPerPool</a> <a id="10377" class="Symbol">:</a> <a id="10379" href="Axiom.Set.Rel.html#1312" class="Function">Rel</a> <a id="10383" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="10391" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
      <a id="10408" href="Ledger.Conway.Specification.Epoch.html#10353" class="Function">stakeCredentialsPerPool</a> <a id="10432" class="Symbol">=</a> <a id="10434" class="Symbol">(</a><a id="10435" href="Ledger.Conway.Specification.Certs.html#1898" class="Field">StakeDelegsOf</a> <a id="10449" href="Ledger.Conway.Specification.Epoch.html#10142" class="Bound">ss</a> <a id="10452" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10453" class="Symbol">)</a> <a id="10455" href="Axiom.Set.Rel.html#1608" class="Function Operator">⁻¹ʳ</a>

      <a id="10466" class="Comment">-- delegated stake per pool</a>
      <a id="10500" href="Ledger.Conway.Specification.Epoch.html#10500" class="Function">sd</a> <a id="10503" class="Symbol">:</a> <a id="10505" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="10513" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="10515" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="10526" href="Ledger.Conway.Specification.Epoch.html#10500" class="Function">sd</a> <a id="10529" class="Symbol">=</a> <a id="10531" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="10542" class="Symbol">((</a><a id="10544" href="Ledger.Conway.Specification.Epoch.html#10353" class="Function">stakeCredentialsPerPool</a> <a id="10568" href="abstract-set-theory.FiniteSetTheory.html#3111" class="Function Operator">∘ʳ</a> <a id="10571" class="Symbol">(</a><a id="10572" href="Ledger.Conway.Specification.Certs.html#1814" class="Field">StakeOf</a> <a id="10580" href="Ledger.Conway.Specification.Epoch.html#10142" class="Bound">ss</a> <a id="10583" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10584" class="Symbol">))</a> <a id="10587" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="10589" class="Symbol">)</a>


  <a id="stakeFromGADeposits"></a><a id="10595" href="Ledger.Conway.Specification.Epoch.html#10595" class="Function">stakeFromGADeposits</a>
    <a id="10619" class="Symbol">:</a> <a id="10621" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
    <a id="10634" class="Symbol">→</a> <a id="10636" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
    <a id="10650" class="Symbol">→</a> <a id="10652" href="Ledger.Conway.Specification.Certs.html#1327" class="Function">Stake</a>
  <a id="10660" href="Ledger.Conway.Specification.Epoch.html#10595" class="Function">stakeFromGADeposits</a> <a id="10680" href="Ledger.Conway.Specification.Epoch.html#10680" class="Bound">govSt</a> <a id="10686" href="Ledger.Conway.Specification.Epoch.html#10686" class="Bound">utxoSt</a> <a id="10693" class="Symbol">=</a> <a id="10695" href="abstract-set-theory.FiniteSetTheory.html#4855" class="Function">aggregateBy</a>
     <a id="10712" class="Symbol">(</a><a id="10713" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10718" class="Symbol">(λ</a> <a id="10721" class="Symbol">(</a><a id="10722" href="Ledger.Conway.Specification.Epoch.html#10722" class="Bound">gaid</a> <a id="10727" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10729" href="Ledger.Conway.Specification.Epoch.html#10729" class="Bound">addr</a><a id="10733" class="Symbol">)</a> <a id="10735" class="Symbol">→</a> <a id="10737" class="Symbol">(</a><a id="10738" href="Ledger.Conway.Specification.Epoch.html#10722" class="Bound">gaid</a> <a id="10743" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10745" href="Ledger.Conway.Specification.Epoch.html#10729" class="Bound">addr</a><a id="10749" class="Symbol">)</a> <a id="10751" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10753" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a> <a id="10759" href="Ledger.Conway.Specification.Epoch.html#10729" class="Bound">addr</a><a id="10763" class="Symbol">)</a> <a id="10765" href="Ledger.Conway.Specification.Epoch.html#10912" class="Function">govSt&#39;</a><a id="10771" class="Symbol">)</a>
     <a id="10778" class="Symbol">(</a><a id="10779" href="Axiom.Set.Map.html#13318" class="Function">mapFromPartialFun</a> <a id="10797" class="Symbol">(λ</a> <a id="10800" class="Symbol">(</a><a id="10801" href="Ledger.Conway.Specification.Epoch.html#10801" class="Bound">gaid</a> <a id="10806" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10808" class="Symbol">_)</a> <a id="10811" class="Symbol">→</a> <a id="10813" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="10822" href="Ledger.Conway.Specification.Utxo.html#1338" class="Field">deposits</a> <a id="10831" class="Symbol">(</a><a id="10832" href="Ledger.Conway.Specification.Certs.html#760" class="InductiveConstructor">GovActionDeposit</a> <a id="10849" href="Ledger.Conway.Specification.Epoch.html#10801" class="Bound">gaid</a><a id="10853" class="Symbol">))</a> <a id="10856" href="Ledger.Conway.Specification.Epoch.html#10912" class="Function">govSt&#39;</a><a id="10862" class="Symbol">)</a>
     <a id="10869" class="Keyword">where</a>
       <a id="10882" class="Keyword">open</a> <a id="10887" href="Ledger.Conway.Specification.Utxo.html#1230" class="Module">UTxOState</a> <a id="10897" href="Ledger.Conway.Specification.Epoch.html#10686" class="Bound">utxoSt</a>

       <a id="10912" href="Ledger.Conway.Specification.Epoch.html#10912" class="Function">govSt&#39;</a> <a id="10919" class="Symbol">:</a> <a id="10921" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="10923" class="Symbol">(</a><a id="10924" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a> <a id="10936" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10938" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a><a id="10951" class="Symbol">)</a>
       <a id="10960" href="Ledger.Conway.Specification.Epoch.html#10912" class="Function">govSt&#39;</a> <a id="10967" class="Symbol">=</a> <a id="10969" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10974" class="Symbol">(</a><a id="10975" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="10980" href="Ledger.Conway.Specification.Gov.Actions.html#3889" class="Field">returnAddr</a><a id="10990" class="Symbol">)</a> <a id="10992" class="Symbol">(</a><a id="10993" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="11002" href="Ledger.Conway.Specification.Epoch.html#10680" class="Bound">govSt</a><a id="11007" class="Symbol">)</a>


<a id="11011" class="Keyword">module</a> <a id="VDelegDelegatedStake"></a><a id="11018" href="Ledger.Conway.Specification.Epoch.html#11018" class="Module">VDelegDelegatedStake</a>
  <a id="11041" class="Symbol">(</a><a id="11042" href="Ledger.Conway.Specification.Epoch.html#11042" class="Bound">currentEpoch</a> <a id="11055" class="Symbol">:</a> <a id="11057" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a><a id="11062" class="Symbol">)</a>
  <a id="11066" class="Symbol">(</a><a id="11067" href="Ledger.Conway.Specification.Epoch.html#11067" class="Bound">utxoSt</a>       <a id="11080" class="Symbol">:</a> <a id="11082" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a><a id="11091" class="Symbol">)</a>
  <a id="11095" class="Symbol">(</a><a id="11096" href="Ledger.Conway.Specification.Epoch.html#11096" class="Bound">govSt</a>        <a id="11109" class="Symbol">:</a> <a id="11111" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a><a id="11119" class="Symbol">)</a>
  <a id="11123" class="Symbol">(</a><a id="11124" href="Ledger.Conway.Specification.Epoch.html#11124" class="Bound">gState</a>       <a id="11137" class="Symbol">:</a> <a id="11139" href="Ledger.Conway.Specification.Certs.html#4021" class="Record">GState</a><a id="11145" class="Symbol">)</a>
  <a id="11149" class="Symbol">(</a><a id="11150" href="Ledger.Conway.Specification.Epoch.html#11150" class="Bound">dState</a>       <a id="11163" class="Symbol">:</a> <a id="11165" href="Ledger.Conway.Specification.Certs.html#3758" class="Record">DState</a><a id="11171" class="Symbol">)</a>
  <a id="11175" class="Keyword">where</a>

  <a id="VDelegDelegatedStake.activeDReps"></a><a id="11184" href="Ledger.Conway.Specification.Epoch.html#11184" class="Function">activeDReps</a> <a id="11196" class="Symbol">:</a> <a id="11198" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="11200" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
  <a id="11213" href="Ledger.Conway.Specification.Epoch.html#11184" class="Function">activeDReps</a> <a id="11225" class="Symbol">=</a> <a id="11227" href="Class.IsSet.html#916" class="Function">dom</a> <a id="11231" class="Symbol">(</a><a id="11232" href="Ledger.Conway.Specification.Gov.Actions.html#7242" class="Function">activeDRepsOf</a> <a id="11246" href="Ledger.Conway.Specification.Epoch.html#11124" class="Bound">gState</a> <a id="11253" href="Ledger.Conway.Specification.Epoch.html#11042" class="Bound">currentEpoch</a><a id="11265" class="Symbol">)</a>

  <a id="VDelegDelegatedStake.activeVDelegs"></a><a id="11270" href="Ledger.Conway.Specification.Epoch.html#11270" class="Function">activeVDelegs</a> <a id="11284" class="Symbol">:</a> <a id="11286" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="11288" href="Ledger.Conway.Specification.Gov.Actions.html#2570" class="Datatype">VDeleg</a>
  <a id="11297" href="Ledger.Conway.Specification.Epoch.html#11270" class="Function">activeVDelegs</a> <a id="11311" class="Symbol">=</a> <a id="11313" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="11318" href="Ledger.Conway.Specification.Gov.Actions.html#2592" class="InductiveConstructor">vDelegCredential</a> <a id="11335" href="Ledger.Conway.Specification.Epoch.html#11184" class="Function">activeDReps</a> <a id="11347" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="11349" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="11351" href="Ledger.Conway.Specification.Gov.Actions.html#2665" class="InductiveConstructor">vDelegNoConfidence</a> <a id="11370" href="Class.HasSingleton.html#288" class="Field Operator">❵</a> <a id="11372" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="11374" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="11376" href="Ledger.Conway.Specification.Gov.Actions.html#2635" class="InductiveConstructor">vDelegAbstain</a> <a id="11390" href="Class.HasSingleton.html#288" class="Field Operator">❵</a>

  <a id="11395" class="Comment">-- compute the stake for a credential</a>
  <a id="VDelegDelegatedStake.stakePerCredential"></a><a id="11435" href="Ledger.Conway.Specification.Epoch.html#11435" class="Function">stakePerCredential</a> <a id="11454" class="Symbol">:</a> <a id="11456" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="11467" class="Symbol">→</a> <a id="11469" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11476" href="Ledger.Conway.Specification.Epoch.html#11435" class="Function">stakePerCredential</a> <a id="11495" href="Ledger.Conway.Specification.Epoch.html#11495" class="Bound">c</a> <a id="11497" class="Symbol">=</a> <a id="11499" href="Ledger.Conway.Specification.Utxo.html#2456" class="Function">cbalance</a> <a id="11508" class="Symbol">((</a><a id="11510" href="Ledger.Conway.Specification.Transaction.html#2939" class="Field">UTxOOf</a> <a id="11517" href="Ledger.Conway.Specification.Epoch.html#11067" class="Bound">utxoSt</a><a id="11523" class="Symbol">)</a> <a id="11525" href="abstract-set-theory.FiniteSetTheory.html#4295" class="Function Operator">∣^&#39;</a> <a id="11529" class="Symbol">λ</a> <a id="11531" href="Ledger.Conway.Specification.Epoch.html#11531" class="Bound">txout</a> <a id="11537" class="Symbol">→</a> <a id="11539" href="Ledger.Conway.Specification.Epoch.html#5612" class="Function">getStakeCred</a> <a id="11552" href="Ledger.Conway.Specification.Epoch.html#11531" class="Bound">txout</a> <a id="11558" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="11560" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="11565" href="Ledger.Conway.Specification.Epoch.html#11495" class="Bound">c</a><a id="11566" class="Symbol">)</a>
                         <a id="11593" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="11595" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="11605" class="Number">0</a> <a id="11607" class="Symbol">(</a><a id="11608" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="11617" class="Symbol">(</a><a id="11618" href="Ledger.Conway.Specification.Epoch.html#10595" class="Function">stakeFromGADeposits</a> <a id="11638" href="Ledger.Conway.Specification.Epoch.html#11096" class="Bound">govSt</a> <a id="11644" href="Ledger.Conway.Specification.Epoch.html#11067" class="Bound">utxoSt</a><a id="11650" class="Symbol">)</a> <a id="11652" href="Ledger.Conway.Specification.Epoch.html#11495" class="Bound">c</a><a id="11653" class="Symbol">)</a>
                         <a id="11680" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="11682" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="11692" class="Number">0</a> <a id="11694" class="Symbol">(</a><a id="11695" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="11704" class="Symbol">(</a><a id="11705" href="Ledger.Conway.Specification.Certs.html#1733" class="Field">RewardsOf</a> <a id="11715" href="Ledger.Conway.Specification.Epoch.html#11150" class="Bound">dState</a><a id="11721" class="Symbol">)</a> <a id="11723" href="Ledger.Conway.Specification.Epoch.html#11495" class="Bound">c</a><a id="11724" class="Symbol">)</a>

  <a id="VDelegDelegatedStake.calculate"></a><a id="11729" href="Ledger.Conway.Specification.Epoch.html#11729" class="Function">calculate</a> <a id="11739" class="Symbol">:</a> <a id="11741" href="Ledger.Conway.Specification.Gov.Actions.html#2570" class="Datatype">VDeleg</a> <a id="11748" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11750" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11757" href="Ledger.Conway.Specification.Epoch.html#11729" class="Function">calculate</a> <a id="11767" class="Symbol">=</a> <a id="11769" href="Axiom.Set.Map.html#10462" class="Function">mapFromFun</a> <a id="11780" class="Symbol">(λ</a> <a id="11783" href="Ledger.Conway.Specification.Epoch.html#11783" class="Bound">vd</a> <a id="11786" class="Symbol">→</a> <a id="11788" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">∑ˢ[</a> <a id="11792" href="Ledger.Conway.Specification.Epoch.html#11792" class="Bound">c</a> <a id="11794" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">←</a> <a id="11796" class="Symbol">(</a><a id="11797" href="Ledger.Conway.Specification.Gov.Actions.html#2810" class="Field">VoteDelegsOf</a> <a id="11810" href="Ledger.Conway.Specification.Epoch.html#11150" class="Bound">dState</a><a id="11816" class="Symbol">)</a> <a id="11818" href="Axiom.Set.Map.html#17957" class="Function Operator">⁻¹</a> <a id="11821" href="Ledger.Conway.Specification.Epoch.html#11783" class="Bound">vd</a> <a id="11824" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">]</a> <a id="11826" class="Symbol">(</a><a id="11827" href="Ledger.Conway.Specification.Epoch.html#11435" class="Function">stakePerCredential</a> <a id="11846" href="Ledger.Conway.Specification.Epoch.html#11792" class="Bound">c</a><a id="11847" class="Symbol">))</a>
                         <a id="11875" href="Ledger.Conway.Specification.Epoch.html#11270" class="Function">activeVDelegs</a>


<a id="11891" class="Keyword">opaque</a>


  <a id="calculateVDelegDelegatedStake"></a><a id="11902" href="Ledger.Conway.Specification.Epoch.html#11902" class="Function">calculateVDelegDelegatedStake</a>
    <a id="11936" class="Symbol">:</a> <a id="11938" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
    <a id="11948" class="Symbol">→</a> <a id="11950" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
    <a id="11964" class="Symbol">→</a> <a id="11966" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
    <a id="11979" class="Symbol">→</a> <a id="11981" href="Ledger.Conway.Specification.Certs.html#4021" class="Record">GState</a>
    <a id="11992" class="Symbol">→</a> <a id="11994" href="Ledger.Conway.Specification.Certs.html#3758" class="Record">DState</a>
    <a id="12005" class="Symbol">→</a> <a id="12007" href="Ledger.Conway.Specification.Gov.Actions.html#2570" class="Datatype">VDeleg</a> <a id="12014" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12016" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="12023" href="Ledger.Conway.Specification.Epoch.html#11902" class="Function">calculateVDelegDelegatedStake</a> <a id="12053" class="Symbol">=</a> <a id="12055" href="Ledger.Conway.Specification.Epoch.html#11729" class="Function">VDelegDelegatedStake.calculate</a>


<a id="12088" class="Keyword">opaque</a>


  <a id="calculatePoolDelegatedStakeForVoting"></a><a id="12099" href="Ledger.Conway.Specification.Epoch.html#12099" class="Function">calculatePoolDelegatedStakeForVoting</a>
    <a id="12140" class="Symbol">:</a> <a id="12142" href="Ledger.Conway.Specification.Rewards.html#6472" class="Record">Snapshot</a>
    <a id="12155" class="Symbol">→</a> <a id="12157" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
    <a id="12171" class="Symbol">→</a> <a id="12173" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
    <a id="12186" class="Symbol">→</a> <a id="12188" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="12196" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12198" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="12205" href="Ledger.Conway.Specification.Epoch.html#12099" class="Function">calculatePoolDelegatedStakeForVoting</a> <a id="12242" href="Ledger.Conway.Specification.Epoch.html#12242" class="Bound">ss</a> <a id="12245" href="Ledger.Conway.Specification.Epoch.html#12245" class="Bound">utxoSt</a> <a id="12252" href="Ledger.Conway.Specification.Epoch.html#12252" class="Bound">govSt</a>
    <a id="12262" class="Symbol">=</a> <a id="12264" href="Ledger.Conway.Specification.Epoch.html#10044" class="Function">calculatePoolDelegatedStake</a> <a id="12292" href="Ledger.Conway.Specification.Epoch.html#12242" class="Bound">ss</a> <a id="12295" href="Axiom.Set.Map.Dec.html#2149" class="Function Operator">∪⁺</a> <a id="12298" class="Symbol">(</a><a id="12299" href="Ledger.Conway.Specification.Epoch.html#12353" class="Function">stakeFromDeposits</a> <a id="12317" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="12319" href="Class.IsSet.html#916" class="Function">dom</a> <a id="12323" class="Symbol">(</a><a id="12324" href="Ledger.Conway.Specification.Certs.html#1568" class="Field">PoolsOf</a> <a id="12332" href="Ledger.Conway.Specification.Epoch.html#12242" class="Bound">ss</a><a id="12334" class="Symbol">))</a>
    <a id="12341" class="Keyword">where</a>
      <a id="12353" href="Ledger.Conway.Specification.Epoch.html#12353" class="Function">stakeFromDeposits</a> <a id="12371" class="Symbol">:</a> <a id="12373" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="12381" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12383" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="12394" href="Ledger.Conway.Specification.Epoch.html#12353" class="Function">stakeFromDeposits</a> <a id="12412" class="Symbol">=</a> <a id="12414" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="12425" class="Symbol">(((</a><a id="12428" href="Ledger.Conway.Specification.Certs.html#1898" class="Field">StakeDelegsOf</a> <a id="12442" href="Ledger.Conway.Specification.Epoch.html#12242" class="Bound">ss</a> <a id="12445" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="12446" class="Symbol">)</a> <a id="12448" href="Axiom.Set.Rel.html#1608" class="Function Operator">⁻¹ʳ</a>
                                      <a id="12490" href="abstract-set-theory.FiniteSetTheory.html#3111" class="Function Operator">∘ʳ</a> <a id="12493" class="Symbol">(</a><a id="12494" href="Ledger.Conway.Specification.Epoch.html#10595" class="Function">stakeFromGADeposits</a> <a id="12514" href="Ledger.Conway.Specification.Epoch.html#12252" class="Bound">govSt</a> <a id="12520" href="Ledger.Conway.Specification.Epoch.html#12245" class="Bound">utxoSt</a> <a id="12527" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="12528" class="Symbol">))</a> <a id="12531" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="12533" class="Symbol">)</a>


<a id="mkStakeDistrs"></a><a id="12537" href="Ledger.Conway.Specification.Epoch.html#12537" class="Function">mkStakeDistrs</a>
  <a id="12553" class="Symbol">:</a> <a id="12555" href="Ledger.Conway.Specification.Rewards.html#6472" class="Record">Snapshot</a>
  <a id="12566" class="Symbol">→</a> <a id="12568" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
  <a id="12576" class="Symbol">→</a> <a id="12578" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
  <a id="12590" class="Symbol">→</a> <a id="12592" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
  <a id="12603" class="Symbol">→</a> <a id="12605" href="Ledger.Conway.Specification.Certs.html#4021" class="Record">GState</a>
  <a id="12614" class="Symbol">→</a> <a id="12616" href="Ledger.Conway.Specification.Certs.html#3758" class="Record">DState</a>
  <a id="12625" class="Symbol">→</a> <a id="12627" href="Ledger.Conway.Specification.Ratify.html#3126" class="Record">StakeDistrs</a>
<a id="12639" href="Ledger.Conway.Specification.Epoch.html#12537" class="Function">mkStakeDistrs</a> <a id="12653" href="Ledger.Conway.Specification.Epoch.html#12653" class="Bound">ss</a> <a id="12656" href="Ledger.Conway.Specification.Epoch.html#12656" class="Bound">currentEpoch</a> <a id="12669" href="Ledger.Conway.Specification.Epoch.html#12669" class="Bound">utxoSt</a> <a id="12676" href="Ledger.Conway.Specification.Epoch.html#12676" class="Bound">govSt</a> <a id="12682" href="Ledger.Conway.Specification.Epoch.html#12682" class="Bound">gState</a> <a id="12689" href="Ledger.Conway.Specification.Epoch.html#12689" class="Bound">dState</a> <a id="12696" class="Symbol">=</a>
  <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#11902}{\htmlId{12702}{\htmlClass{Function}{\text{calculateVDelegDelegatedStake}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12656}{\htmlId{12732}{\htmlClass{Bound}{\text{currentEpoch}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12669}{\htmlId{12745}{\htmlClass{Bound}{\text{utxoSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12676}{\htmlId{12752}{\htmlClass{Bound}{\text{govSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12682}{\htmlId{12758}{\htmlClass{Bound}{\text{gState}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12689}{\htmlId{12765}{\htmlClass{Bound}{\text{dState}}}}\,
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#12099}{\htmlId{12776}{\htmlClass{Function}{\text{calculatePoolDelegatedStakeForVoting}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12653}{\htmlId{12813}{\htmlClass{Bound}{\text{ss}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12669}{\htmlId{12816}{\htmlClass{Bound}{\text{utxoSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12676}{\htmlId{12823}{\htmlClass{Bound}{\text{govSt}}}}\, \end{pmatrix}$</a>


<a id="12833" class="Keyword">private</a> <a id="12841" class="Keyword">variable</a>
  <a id="12852" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="12854" href="Ledger.Conway.Specification.Epoch.html#12854" class="Generalizable">lastEpoch</a> <a id="12864" class="Symbol">:</a> <a id="12866" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
  <a id="12874" href="Ledger.Conway.Specification.Epoch.html#12874" class="Generalizable">fut</a> <a id="12878" href="Ledger.Conway.Specification.Epoch.html#12878" class="Generalizable">fut&#39;</a> <a id="12883" class="Symbol">:</a> <a id="12885" href="Ledger.Conway.Specification.Ratify.html#3537" class="Record">RatifyState</a>
  <a id="12899" href="Ledger.Conway.Specification.Epoch.html#12899" class="Generalizable">poolReapState</a> <a id="12913" class="Symbol">:</a> <a id="12915" href="Ledger.Conway.Specification.PoolReap.html#404" class="Record">PoolReapState</a>
  <a id="12931" href="Ledger.Conway.Specification.Epoch.html#12931" class="Generalizable">eps</a> <a id="12935" href="Ledger.Conway.Specification.Epoch.html#12935" class="Generalizable">eps&#39;</a> <a id="12940" href="Ledger.Conway.Specification.Epoch.html#12940" class="Generalizable">eps&#39;&#39;</a> <a id="12946" class="Symbol">:</a> <a id="12948" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a>
  <a id="12961" href="Ledger.Conway.Specification.Epoch.html#12961" class="Generalizable">ls</a> <a id="12964" class="Symbol">:</a> <a id="12966" href="Ledger.Conway.Specification.Ledger.html#988" class="Record">LState</a>
  <a id="12975" href="Ledger.Conway.Specification.Epoch.html#12975" class="Generalizable">es₀</a> <a id="12979" class="Symbol">:</a> <a id="12981" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a>
  <a id="12994" href="Ledger.Conway.Specification.Epoch.html#12994" class="Generalizable">mark</a> <a id="12999" href="Ledger.Conway.Specification.Epoch.html#12999" class="Generalizable">set</a> <a id="13003" href="Ledger.Conway.Specification.Epoch.html#13003" class="Generalizable">go</a> <a id="13006" class="Symbol">:</a> <a id="13008" href="Ledger.Conway.Specification.Rewards.html#6472" class="Record">Snapshot</a>
  <a id="13019" href="Ledger.Conway.Specification.Epoch.html#13019" class="Generalizable">feeSS</a> <a id="13025" class="Symbol">:</a> <a id="13027" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
  <a id="13034" href="Ledger.Conway.Specification.Epoch.html#13034" class="Generalizable">lstate</a> <a id="13041" class="Symbol">:</a> <a id="13043" href="Ledger.Conway.Specification.Ledger.html#988" class="Record">LState</a>
  <a id="13052" href="Ledger.Conway.Specification.Epoch.html#13052" class="Generalizable">pState&#39;&#39;</a> <a id="13061" class="Symbol">:</a> <a id="13063" href="Ledger.Conway.Specification.Certs.html#3909" class="Record">PState</a>
  <a id="13072" href="Ledger.Conway.Specification.Epoch.html#13072" class="Generalizable">dState&#39;</a> <a id="13080" class="Symbol">:</a> <a id="13082" href="Ledger.Conway.Specification.Certs.html#3758" class="Record">DState</a>
  <a id="13091" href="Ledger.Conway.Specification.Epoch.html#13091" class="Generalizable">acnt</a> <a id="13096" href="Ledger.Conway.Specification.Epoch.html#13096" class="Generalizable">acnt&#39;</a> <a id="13102" class="Symbol">:</a> <a id="13104" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
  <a id="13111" href="Ledger.Conway.Specification.Epoch.html#13111" class="Generalizable">utxoSt&#39;&#39;</a> <a id="13120" class="Symbol">:</a> <a id="13122" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
  <a id="13134" href="Ledger.Conway.Specification.Epoch.html#13134" class="Generalizable">ss</a> <a id="13137" href="Ledger.Conway.Specification.Epoch.html#13137" class="Generalizable">ss&#39;</a> <a id="13141" class="Symbol">:</a> <a id="13143" href="Ledger.Conway.Specification.Rewards.html#7719" class="Record">Snapshots</a>
  <a id="13155" href="Ledger.Conway.Specification.Epoch.html#13155" class="Generalizable">ru</a> <a id="13158" class="Symbol">:</a> <a id="13160" href="Ledger.Conway.Specification.Rewards.html#6249" class="Record">RewardUpdate</a>
  <a id="13175" href="Ledger.Conway.Specification.Epoch.html#13175" class="Generalizable">mru</a> <a id="13179" class="Symbol">:</a> <a id="13181" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="13187" href="Ledger.Conway.Specification.Rewards.html#6249" class="Record">RewardUpdate</a>
  <a id="13202" href="Ledger.Conway.Specification.Epoch.html#13202" class="Generalizable">pd</a> <a id="13205" class="Symbol">:</a> <a id="13207" href="Ledger.Conway.Specification.Epoch.html#3536" class="Function">PoolDelegatedStake</a>


<a id="getOrphans"></a><a id="13228" href="Ledger.Conway.Specification.Epoch.html#13228" class="Function">getOrphans</a> <a id="13239" class="Symbol">:</a> <a id="13241" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a> <a id="13252" class="Symbol">→</a> <a id="13254" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a> <a id="13263" class="Symbol">→</a> <a id="13265" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
<a id="13274" href="Ledger.Conway.Specification.Epoch.html#13228" class="Function">getOrphans</a> <a id="13285" href="Ledger.Conway.Specification.Epoch.html#13285" class="Bound">es</a> <a id="13288" href="Ledger.Conway.Specification.Epoch.html#13288" class="Bound">govSt</a> <a id="13294" class="Symbol">=</a> <a id="13296" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="13302" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="13304" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a> <a id="13312" href="Ledger.Conway.Specification.Epoch.html#13357" class="Function">step</a> <a id="13317" class="Symbol">(</a><a id="13318" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="13321" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13323" href="Ledger.Conway.Specification.Epoch.html#13288" class="Bound">govSt</a><a id="13328" class="Symbol">)</a> <a id="13330" class="Symbol">(</a><a id="13331" href="Data.List.Base.html#4746" class="Function">length</a> <a id="13338" href="Ledger.Conway.Specification.Epoch.html#13288" class="Bound">govSt</a><a id="13343" class="Symbol">)</a>
  <a id="13347" class="Keyword">where</a>
    <a id="13357" href="Ledger.Conway.Specification.Epoch.html#13357" class="Function">step</a> <a id="13362" class="Symbol">:</a> <a id="13364" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a> <a id="13373" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13375" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a> <a id="13384" class="Symbol">→</a> <a id="13386" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a> <a id="13395" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13397" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
    <a id="13410" href="Ledger.Conway.Specification.Epoch.html#13357" class="Function">step</a> <a id="13415" class="Symbol">(</a><a id="13416" href="Ledger.Conway.Specification.Epoch.html#13416" class="Bound">orps</a> <a id="13421" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13423" href="Ledger.Conway.Specification.Epoch.html#13423" class="Bound">govSt</a><a id="13428" class="Symbol">)</a> <a id="13430" class="Symbol">=</a>
      <a id="13438" class="Keyword">let</a>
        <a id="13450" href="Ledger.Conway.Specification.Epoch.html#13450" class="Bound">isOrphan?</a> <a id="13460" href="Ledger.Conway.Specification.Epoch.html#13460" class="Bound">a</a> <a id="13462" href="Ledger.Conway.Specification.Epoch.html#13462" class="Bound">prev</a> <a id="13467" class="Symbol">=</a> <a id="13469" href="Relation.Nullary.Decidable.Core.html#3277" class="Function">¬?</a> <a id="13472" class="Symbol">(</a><a id="13473" href="Ledger.Conway.Specification.Gov.html#9785" class="Function">hasParent?</a> <a id="13484" href="Ledger.Conway.Specification.Epoch.html#13285" class="Bound">es</a> <a id="13487" href="Ledger.Conway.Specification.Epoch.html#13423" class="Bound">govSt</a> <a id="13493" href="Ledger.Conway.Specification.Epoch.html#13460" class="Bound">a</a> <a id="13495" href="Ledger.Conway.Specification.Epoch.html#13462" class="Bound">prev</a><a id="13499" class="Symbol">)</a>
        <a id="13509" class="Symbol">(</a><a id="13510" href="Ledger.Conway.Specification.Epoch.html#13510" class="Bound">orps&#39;</a> <a id="13516" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13518" href="Ledger.Conway.Specification.Epoch.html#13518" class="Bound">govSt&#39;</a><a id="13524" class="Symbol">)</a> <a id="13526" class="Symbol">=</a> <a id="13528" href="Data.List.Base.html#10628" class="Function">partition</a>
          <a id="13548" class="Symbol">(λ</a> <a id="13551" class="Symbol">(_</a> <a id="13554" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13556" class="Keyword">record</a> <a id="13563" class="Symbol">{</a><a id="13564" href="Ledger.Conway.Specification.Gov.Actions.html#3945" class="Field">action</a> <a id="13571" class="Symbol">=</a> <a id="13573" href="Ledger.Conway.Specification.Epoch.html#13573" class="Bound">a</a> <a id="13575" class="Symbol">;</a> <a id="13577" href="Ledger.Conway.Specification.Gov.Actions.html#3973" class="Field">prevAction</a> <a id="13588" class="Symbol">=</a> <a id="13590" href="Ledger.Conway.Specification.Epoch.html#13590" class="Bound">prev</a><a id="13594" class="Symbol">})</a> <a id="13597" class="Symbol">→</a> <a id="13599" href="Ledger.Conway.Specification.Epoch.html#13450" class="Bound">isOrphan?</a> <a id="13609" class="Symbol">(</a><a id="13610" href="Ledger.Conway.Specification.Epoch.html#13573" class="Bound">a</a> <a id="13612" class="Symbol">.</a><a id="13613" href="Ledger.Conway.Specification.Gov.Actions.html#1515" class="Field">gaType</a><a id="13619" class="Symbol">)</a> <a id="13621" href="Ledger.Conway.Specification.Epoch.html#13590" class="Bound">prev</a><a id="13625" class="Symbol">)</a>
          <a id="13637" href="Ledger.Conway.Specification.Epoch.html#13423" class="Bound">govSt</a>
      <a id="13649" class="Keyword">in</a>
        <a id="13660" class="Symbol">(</a><a id="13661" href="Ledger.Conway.Specification.Epoch.html#13416" class="Bound">orps</a> <a id="13666" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="13669" href="Ledger.Conway.Specification.Epoch.html#13510" class="Bound">orps&#39;</a> <a id="13675" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13677" href="Ledger.Conway.Specification.Epoch.html#13518" class="Bound">govSt&#39;</a><a id="13683" class="Symbol">)</a>

<a id="13686" class="Keyword">record</a> <a id="Governance-Update"></a><a id="13693" href="Ledger.Conway.Specification.Epoch.html#13693" class="Record">Governance-Update</a> <a id="13711" class="Symbol">:</a> <a id="13713" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="13718" class="Keyword">where</a>
  <a id="13726" class="Keyword">constructor</a> <a id="GovernanceUpdate"></a><a id="13738" href="Ledger.Conway.Specification.Epoch.html#13738" class="InductiveConstructor">GovernanceUpdate</a>
  <a id="13757" class="Keyword">field</a>
    <a id="Governance-Update.removedGovActions"></a><a id="13767" href="Ledger.Conway.Specification.Epoch.html#13767" class="Field">removedGovActions</a> <a id="13785" class="Symbol">:</a> <a id="13787" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="13789" class="Symbol">(</a><a id="13790" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="13804" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13806" href="Ledger.Conway.Specification.Certs.html#571" class="Datatype">DepositPurpose</a> <a id="13821" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13823" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a><a id="13827" class="Symbol">)</a>
    <a id="Governance-Update.govSt&#39;"></a><a id="13833" href="Ledger.Conway.Specification.Epoch.html#13833" class="Field">govSt&#39;</a>            <a id="13851" class="Symbol">:</a> <a id="13853" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>

<a id="13863" class="Keyword">module</a> <a id="GovernanceUpdate"></a><a id="13870" href="Ledger.Conway.Specification.Epoch.html#13870" class="Module">GovernanceUpdate</a> <a id="13887" class="Symbol">(</a><a id="13888" href="Ledger.Conway.Specification.Epoch.html#13888" class="Bound">ls</a> <a id="13891" class="Symbol">:</a> <a id="13893" href="Ledger.Conway.Specification.Ledger.html#988" class="Record">LState</a><a id="13899" class="Symbol">)</a>
                        <a id="13925" class="Symbol">(</a><a id="13926" href="Ledger.Conway.Specification.Epoch.html#13926" class="Bound">fut</a> <a id="13930" class="Symbol">:</a> <a id="13932" href="Ledger.Conway.Specification.Ratify.html#3537" class="Record">RatifyState</a><a id="13943" class="Symbol">)</a>
                        <a id="13969" class="Keyword">where</a>


  <a id="13979" class="Keyword">open</a> <a id="13984" href="Ledger.Conway.Specification.Ledger.html#988" class="Module">LState</a> <a id="13991" href="Ledger.Conway.Specification.Epoch.html#13888" class="Bound">ls</a>
  <a id="13996" class="Keyword">open</a> <a id="14001" href="Ledger.Conway.Specification.Ratify.html#3537" class="Module">RatifyState</a> <a id="14013" href="Ledger.Conway.Specification.Epoch.html#13926" class="Bound">fut</a>


  <a id="GovernanceUpdate.tmpGovSt"></a><a id="14021" href="Ledger.Conway.Specification.Epoch.html#14021" class="Function">tmpGovSt</a> <a id="14030" class="Symbol">:</a> <a id="14032" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
  <a id="14043" href="Ledger.Conway.Specification.Epoch.html#14021" class="Function">tmpGovSt</a> <a id="14052" class="Symbol">=</a> <a id="14054" href="Ledger.Prelude.html#2451" class="Function">filter</a> <a id="14061" class="Symbol">(λ</a> <a id="14064" href="Ledger.Conway.Specification.Epoch.html#14064" class="Bound">x</a> <a id="14066" class="Symbol">→</a> <a id="14068" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14074" href="Ledger.Conway.Specification.Epoch.html#14064" class="Bound">x</a> <a id="14076" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="14078" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14083" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14089" href="Ledger.Conway.Specification.Ratify.html#3600" class="Field">removed</a><a id="14096" class="Symbol">)</a> <a id="14098" href="Ledger.Conway.Specification.Ledger.html#1074" class="Function">govSt</a>

  <a id="GovernanceUpdate.orphans"></a><a id="14107" href="Ledger.Conway.Specification.Epoch.html#14107" class="Function">orphans</a> <a id="14115" class="Symbol">:</a> <a id="14117" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14119" class="Symbol">(</a><a id="14120" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a> <a id="14132" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14134" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Record">GovActionState</a><a id="14148" class="Symbol">)</a>
  <a id="14152" href="Ledger.Conway.Specification.Epoch.html#14107" class="Function">orphans</a>  <a id="14161" class="Symbol">=</a> <a id="14163" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="14172" class="Symbol">(</a><a id="14173" href="Ledger.Conway.Specification.Epoch.html#13228" class="Function">getOrphans</a> <a id="14184" href="Ledger.Conway.Specification.Ratify.html#3574" class="Field">es</a> <a id="14187" href="Ledger.Conway.Specification.Epoch.html#14021" class="Function">tmpGovSt</a><a id="14195" class="Symbol">)</a>

  <a id="GovernanceUpdate.removed&#39;"></a><a id="14200" href="Ledger.Conway.Specification.Epoch.html#14200" class="Function">removed&#39;</a> <a id="14209" class="Symbol">:</a> <a id="14211" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14213" class="Symbol">(</a><a id="14214" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a> <a id="14226" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14228" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Record">GovActionState</a><a id="14242" class="Symbol">)</a>
  <a id="14246" href="Ledger.Conway.Specification.Epoch.html#14200" class="Function">removed&#39;</a> <a id="14255" class="Symbol">=</a> <a id="14257" href="Ledger.Conway.Specification.Ratify.html#3600" class="Field">removed</a> <a id="14265" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="14267" href="Ledger.Conway.Specification.Epoch.html#14107" class="Function">orphans</a>

  <a id="GovernanceUpdate.removedGovActions"></a><a id="14278" href="Ledger.Conway.Specification.Epoch.html#14278" class="Function">removedGovActions</a> <a id="14296" class="Symbol">:</a> <a id="14298" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14300" class="Symbol">(</a><a id="14301" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="14315" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14317" href="Ledger.Conway.Specification.Certs.html#571" class="Datatype">DepositPurpose</a> <a id="14332" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14334" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a><a id="14338" class="Symbol">)</a>
  <a id="14342" href="Ledger.Conway.Specification.Epoch.html#14278" class="Function">removedGovActions</a> <a id="14360" class="Symbol">=</a>
    <a id="14366" href="Function.Base.html#1657" class="Function">flip</a> <a id="14371" href="Axiom.Set.html#7207" class="Function">concatMapˢ</a> <a id="14382" href="Ledger.Conway.Specification.Epoch.html#14200" class="Function">removed&#39;</a> <a id="14391" class="Symbol">λ</a> <a id="14393" class="Symbol">(</a><a id="14394" href="Ledger.Conway.Specification.Epoch.html#14394" class="Bound">gaid</a> <a id="14399" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="14401" href="Ledger.Conway.Specification.Epoch.html#14401" class="Bound">gaSt</a><a id="14405" class="Symbol">)</a> <a id="14407" class="Symbol">→</a>
      <a id="14415" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
        <a id="14428" class="Symbol">(</a><a id="14429" href="Ledger.Conway.Specification.Gov.Actions.html#3889" class="Field">returnAddr</a> <a id="14440" href="Ledger.Conway.Specification.Epoch.html#14401" class="Bound">gaSt</a> <a id="14445" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="14447" class="Symbol">)</a>
        <a id="14457" class="Symbol">((</a><a id="14459" href="Ledger.Conway.Specification.Certs.html#922" class="Field">DepositsOf</a> <a id="14470" href="Ledger.Conway.Specification.Ledger.html#1047" class="Function">utxoSt</a> <a id="14477" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="14479" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="14481" href="Ledger.Conway.Specification.Certs.html#760" class="InductiveConstructor">GovActionDeposit</a> <a id="14498" href="Ledger.Conway.Specification.Epoch.html#14394" class="Bound">gaid</a> <a id="14503" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="14504" class="Symbol">)</a> <a id="14506" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="14507" class="Symbol">)</a>

  <a id="GovernanceUpdate.govSt&#39;"></a><a id="14512" href="Ledger.Conway.Specification.Epoch.html#14512" class="Function">govSt&#39;</a> <a id="14519" class="Symbol">:</a> <a id="14521" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
  <a id="14532" href="Ledger.Conway.Specification.Epoch.html#14512" class="Function">govSt&#39;</a> <a id="14539" class="Symbol">=</a> <a id="14541" href="Ledger.Prelude.html#2451" class="Function">filter</a> <a id="14548" class="Symbol">(λ</a> <a id="14551" href="Ledger.Conway.Specification.Epoch.html#14551" class="Bound">x</a> <a id="14553" class="Symbol">→</a> <a id="14555" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14561" href="Ledger.Conway.Specification.Epoch.html#14551" class="Bound">x</a> <a id="14563" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="14565" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14570" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14576" href="Ledger.Conway.Specification.Epoch.html#14200" class="Function">removed&#39;</a><a id="14584" class="Symbol">)</a> <a id="14586" href="Ledger.Conway.Specification.Ledger.html#1074" class="Function">govSt</a>

  <a id="GovernanceUpdate.updates"></a><a id="14595" href="Ledger.Conway.Specification.Epoch.html#14595" class="Function">updates</a> <a id="14603" class="Symbol">:</a> <a id="14605" href="Ledger.Conway.Specification.Epoch.html#13693" class="Record">Governance-Update</a>
  <a id="14625" href="Ledger.Conway.Specification.Epoch.html#14595" class="Function">updates</a> <a id="14633" class="Symbol">=</a> <a id="14635" href="Ledger.Conway.Specification.Epoch.html#13738" class="InductiveConstructor">GovernanceUpdate</a> <a id="14652" href="Ledger.Conway.Specification.Epoch.html#14278" class="Function">removedGovActions</a> <a id="14670" href="Ledger.Conway.Specification.Epoch.html#14512" class="Function">govSt&#39;</a>

<a id="14678" class="Keyword">record</a> <a id="Pre-POOLREAP-Update"></a><a id="14685" href="Ledger.Conway.Specification.Epoch.html#14685" class="Record">Pre-POOLREAP-Update</a> <a id="14705" class="Symbol">:</a> <a id="14707" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="14712" class="Keyword">where</a>
  <a id="14720" class="Keyword">inductive</a>
  <a id="14732" class="Keyword">constructor</a> <a id="Pre-POOLREAPUpdate"></a><a id="14744" href="Ledger.Conway.Specification.Epoch.html#14744" class="InductiveConstructor">Pre-POOLREAPUpdate</a>
  <a id="14765" class="Keyword">field</a>
    <a id="Pre-POOLREAP-Update.pState&#39;"></a><a id="14775" href="Ledger.Conway.Specification.Epoch.html#14775" class="Field">pState&#39;</a> <a id="14783" class="Symbol">:</a> <a id="14785" href="Ledger.Conway.Specification.Certs.html#3909" class="Record">PState</a>
    <a id="Pre-POOLREAP-Update.gState&#39;"></a><a id="14796" href="Ledger.Conway.Specification.Epoch.html#14796" class="Field">gState&#39;</a> <a id="14804" class="Symbol">:</a> <a id="14806" href="Ledger.Conway.Specification.Certs.html#4021" class="Record">GState</a>
    <a id="Pre-POOLREAP-Update.utxoSt&#39;"></a><a id="14817" href="Ledger.Conway.Specification.Epoch.html#14817" class="Field">utxoSt&#39;</a> <a id="14825" class="Symbol">:</a> <a id="14827" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>

<a id="14838" class="Keyword">module</a> <a id="Pre-POOLREAPUpdate"></a><a id="14845" href="Ledger.Conway.Specification.Epoch.html#14845" class="Module">Pre-POOLREAPUpdate</a> <a id="14864" class="Symbol">(</a><a id="14865" href="Ledger.Conway.Specification.Epoch.html#14865" class="Bound">ls</a> <a id="14868" class="Symbol">:</a> <a id="14870" href="Ledger.Conway.Specification.Ledger.html#988" class="Record">LState</a><a id="14876" class="Symbol">)</a>
                          <a id="14904" class="Symbol">(</a><a id="14905" href="Ledger.Conway.Specification.Epoch.html#14905" class="Bound">es</a> <a id="14908" class="Symbol">:</a> <a id="14910" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a><a id="14920" class="Symbol">)</a>
                          <a id="14948" class="Symbol">(</a><a id="14949" href="Ledger.Conway.Specification.Epoch.html#14949" class="Bound">govUpdate</a> <a id="14959" class="Symbol">:</a> <a id="14961" href="Ledger.Conway.Specification.Epoch.html#13693" class="Record">Governance-Update</a><a id="14978" class="Symbol">)</a>
                          <a id="15006" class="Keyword">where</a>


  <a id="15016" class="Keyword">open</a> <a id="15021" href="Ledger.Conway.Specification.Ledger.html#988" class="Module">LState</a> <a id="15028" href="Ledger.Conway.Specification.Epoch.html#14865" class="Bound">ls</a>
  <a id="15033" class="Keyword">open</a> <a id="15038" href="Ledger.Conway.Specification.Certs.html#4152" class="Module">CertState</a> <a id="15048" href="Ledger.Conway.Specification.Ledger.html#1100" class="Function">certState</a> <a id="15058" class="Keyword">using</a> <a id="15064" class="Symbol">(</a><a id="15065" href="Ledger.Conway.Specification.Certs.html#4235" class="Field">pState</a><a id="15071" class="Symbol">;</a> <a id="15073" href="Ledger.Conway.Specification.Certs.html#4255" class="Field">gState</a><a id="15079" class="Symbol">)</a>
  <a id="15083" class="Keyword">open</a> <a id="15088" href="Ledger.Conway.Specification.Certs.html#3909" class="Module">PState</a> <a id="15095" href="Ledger.Conway.Specification.Certs.html#4235" class="Function">pState</a>
  <a id="15104" class="Keyword">open</a> <a id="15109" href="Ledger.Conway.Specification.Epoch.html#13693" class="Module">Governance-Update</a> <a id="15127" href="Ledger.Conway.Specification.Epoch.html#14949" class="Bound">govUpdate</a>


  <a id="Pre-POOLREAPUpdate.utxoSt&#39;"></a><a id="15141" href="Ledger.Conway.Specification.Epoch.html#15141" class="Function">utxoSt&#39;</a> <a id="15149" class="Symbol">:</a> <a id="15151" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
  <a id="15163" href="Ledger.Conway.Specification.Epoch.html#15141" class="Function">utxoSt&#39;</a> <a id="15171" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Transaction.html#2939}{\htmlId{15175}{\htmlClass{Field}{\text{UTxOOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1047}{\htmlId{15182}{\htmlClass{Function}{\text{utxoSt}}}}\, \\ \,\href{Ledger.Prelude.Base.html#669}{\htmlId{15191}{\htmlClass{Field}{\text{FeesOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1047}{\htmlId{15198}{\htmlClass{Function}{\text{utxoSt}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#922}{\htmlId{15207}{\htmlClass{Field}{\text{DepositsOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1047}{\htmlId{15218}{\htmlClass{Function}{\text{utxoSt}}}}\, \,\href{Axiom.Set.Map.html#13606}{\htmlId{15225}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{abstract-set-theory.FiniteSetTheory.html#519}{\htmlId{15227}{\htmlClass{Function}{\text{mapˢ}}}}\, \,\htmlId{15232}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Data.Product.Base.html#636}{\htmlId{15233}{\htmlClass{Field}{\text{proj₁}}}}\, \,\href{Function.Base.html#1134}{\htmlId{15239}{\htmlClass{Function Operator}{\text{∘}}}}\, \,\href{Data.Product.Base.html#650}{\htmlId{15241}{\htmlClass{Field}{\text{proj₂}}}}\,\,\htmlId{15246}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13767}{\htmlId{15248}{\htmlClass{Field}{\text{removedGovActions}}}}\, \,\href{Axiom.Set.Map.html#13606}{\htmlId{15266}{\htmlClass{Function Operator}{\text{ᶜ}}}}\, \\ \,\htmlId{15270}{\htmlClass{Number}{\text{0}}}\, \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.pState&#39;"></a><a id="15277" href="Ledger.Conway.Specification.Epoch.html#15277" class="Function">pState&#39;</a> <a id="15285" class="Symbol">:</a> <a id="15287" href="Ledger.Conway.Specification.Certs.html#3909" class="Record">PState</a>
  <a id="15296" href="Ledger.Conway.Specification.Epoch.html#15277" class="Function">pState&#39;</a> <a id="15304" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Certs.html#3963}{\htmlId{15308}{\htmlClass{Function}{\text{fPools}}}}\, \,\href{Axiom.Set.Map.html#7640}{\htmlId{15315}{\htmlClass{Function Operator}{\text{∪ˡ}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#3941}{\htmlId{15318}{\htmlClass{Function}{\text{pools}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{15326}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#3985}{\htmlId{15330}{\htmlClass{Function}{\text{retiring}}}}\, \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.gState&#39;"></a><a id="15344" href="Ledger.Conway.Specification.Epoch.html#15344" class="Function">gState&#39;</a> <a id="15352" class="Symbol">:</a> <a id="15354" href="Ledger.Conway.Specification.Certs.html#4021" class="Record">GState</a>
  <a id="15363" href="Ledger.Conway.Specification.Epoch.html#15344" class="Function">gState&#39;</a> <a id="15371" class="Symbol">=</a>
    <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{15379}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Class.ToBool.html#342}{\htmlId{15380}{\htmlClass{Function Operator}{\text{if}}}}\, \,\href{Data.List.Base.html#4681}{\htmlId{15383}{\htmlClass{Function}{\text{null}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13833}{\htmlId{15388}{\htmlClass{Field}{\text{govSt&#39;}}}}\, \,\href{Class.ToBool.html#342}{\htmlId{15395}{\htmlClass{Function Operator}{\text{then}}}}\, \,\href{Axiom.Set.Map.html#7108}{\htmlId{15400}{\htmlClass{Function}{\text{mapValues}}}}\, \,\href{Ledger.Core.Specification.Epoch.html#1054}{\htmlId{15410}{\htmlClass{Function}{\text{sucᵉ}}}}\, \,\htmlId{15415}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Gov.Actions.html#7096}{\htmlId{15416}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4255}{\htmlId{15424}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{15430}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Class.ToBool.html#342}{\htmlId{15432}{\htmlClass{Function Operator}{\text{else}}}}\, \,\href{Ledger.Conway.Specification.Gov.Actions.html#7096}{\htmlId{15437}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4255}{\htmlId{15445}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{15451}{\htmlClass{Symbol}{\text{)}}}\,
    \\ \,\href{Ledger.Conway.Specification.Certs.html#1483}{\htmlId{15459}{\htmlClass{Field}{\text{CCHotKeysOf}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4255}{\htmlId{15471}{\htmlClass{Function}{\text{gState}}}}\, \,\href{Axiom.Set.Map.html#13536}{\htmlId{15478}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Specification.Enact.html#1366}{\htmlId{15480}{\htmlClass{Function}{\text{ccCreds}}}}\, \,\htmlId{15488}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Enact.html#484}{\htmlId{15489}{\htmlClass{Field}{\text{EnactState.cc}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#14905}{\htmlId{15503}{\htmlClass{Bound}{\text{es}}}}\,\,\htmlId{15505}{\htmlClass{Symbol}{\text{)}}}\,
    \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.updates"></a><a id="15516" href="Ledger.Conway.Specification.Epoch.html#15516" class="Function">updates</a> <a id="15524" class="Symbol">:</a> <a id="15526" href="Ledger.Conway.Specification.Epoch.html#14685" class="Record">Pre-POOLREAP-Update</a>
  <a id="15548" href="Ledger.Conway.Specification.Epoch.html#15516" class="Function">updates</a> <a id="15556" class="Symbol">=</a> <a id="15558" href="Ledger.Conway.Specification.Epoch.html#14744" class="InductiveConstructor">Pre-POOLREAPUpdate</a> <a id="15577" href="Ledger.Conway.Specification.Epoch.html#15277" class="Function">pState&#39;</a> <a id="15585" href="Ledger.Conway.Specification.Epoch.html#15344" class="Function">gState&#39;</a> <a id="15593" href="Ledger.Conway.Specification.Epoch.html#15141" class="Function">utxoSt&#39;</a>

<a id="15602" class="Keyword">record</a> <a id="Post-POOLREAP-Update"></a><a id="15609" href="Ledger.Conway.Specification.Epoch.html#15609" class="Record">Post-POOLREAP-Update</a> <a id="15630" class="Symbol">:</a> <a id="15632" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="15637" class="Keyword">where</a>
  <a id="15645" class="Keyword">inductive</a>
  <a id="15657" class="Keyword">constructor</a> <a id="Post-POOLREAPUpdate"></a><a id="15669" href="Ledger.Conway.Specification.Epoch.html#15669" class="InductiveConstructor">Post-POOLREAPUpdate</a>
  <a id="15691" class="Keyword">field</a>
    <a id="Post-POOLREAP-Update.dState&#39;&#39;"></a><a id="15701" href="Ledger.Conway.Specification.Epoch.html#15701" class="Field">dState&#39;&#39;</a>       <a id="15716" class="Symbol">:</a> <a id="15718" href="Ledger.Conway.Specification.Certs.html#3758" class="Record">DState</a>
    <a id="Post-POOLREAP-Update.acnt&#39;&#39;"></a><a id="15729" href="Ledger.Conway.Specification.Epoch.html#15729" class="Field">acnt&#39;&#39;</a>         <a id="15744" class="Symbol">:</a> <a id="15746" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>

<a id="15752" class="Keyword">module</a> <a id="Post-POOLREAPUpdate"></a><a id="15759" href="Ledger.Conway.Specification.Epoch.html#15759" class="Module">Post-POOLREAPUpdate</a> <a id="15779" class="Symbol">(</a><a id="15780" href="Ledger.Conway.Specification.Epoch.html#15780" class="Bound">es</a> <a id="15783" class="Symbol">:</a> <a id="15785" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a><a id="15795" class="Symbol">)</a>
                           <a id="15824" class="Symbol">(</a><a id="15825" href="Ledger.Conway.Specification.Epoch.html#15825" class="Bound">ls</a> <a id="15828" class="Symbol">:</a> <a id="15830" href="Ledger.Conway.Specification.Ledger.html#988" class="Record">LState</a><a id="15836" class="Symbol">)</a>
                           <a id="15865" class="Symbol">(</a><a id="15866" href="Ledger.Conway.Specification.Epoch.html#15866" class="Bound">dState&#39;</a> <a id="15874" class="Symbol">:</a> <a id="15876" href="Ledger.Conway.Specification.Certs.html#3758" class="Record">DState</a><a id="15882" class="Symbol">)</a>
                           <a id="15911" class="Symbol">(</a><a id="15912" href="Ledger.Conway.Specification.Epoch.html#15912" class="Bound">acnt&#39;</a> <a id="15918" class="Symbol">:</a> <a id="15920" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a><a id="15924" class="Symbol">)</a>
                           <a id="15953" class="Symbol">(</a><a id="15954" href="Ledger.Conway.Specification.Epoch.html#15954" class="Bound">govUpd</a> <a id="15961" class="Symbol">:</a> <a id="15963" href="Ledger.Conway.Specification.Epoch.html#13693" class="Record">Governance-Update</a><a id="15980" class="Symbol">)</a>
                           <a id="16009" class="Keyword">where</a>


  <a id="16019" class="Keyword">open</a> <a id="16024" href="Ledger.Conway.Specification.Ledger.html#988" class="Module">LState</a>
  <a id="16033" class="Keyword">open</a> <a id="16038" href="Ledger.Conway.Specification.Epoch.html#13693" class="Module">Governance-Update</a> <a id="16056" href="Ledger.Conway.Specification.Epoch.html#15954" class="Bound">govUpd</a>


  <a id="16067" class="Keyword">opaque</a>
    <a id="Post-POOLREAPUpdate.govActionReturns"></a><a id="16078" href="Ledger.Conway.Specification.Epoch.html#16078" class="Function">govActionReturns</a> <a id="16095" class="Symbol">:</a> <a id="16097" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="16111" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16113" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16122" href="Ledger.Conway.Specification.Epoch.html#16078" class="Function">govActionReturns</a> <a id="16139" class="Symbol">=</a>
      <a id="16147" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="16158" class="Symbol">(</a><a id="16159" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="16164" class="Symbol">(λ</a> <a id="16167" class="Symbol">(</a><a id="16168" href="Ledger.Conway.Specification.Epoch.html#16168" class="Bound">a</a> <a id="16170" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16172" class="Symbol">_</a> <a id="16174" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16176" href="Ledger.Conway.Specification.Epoch.html#16176" class="Bound">d</a><a id="16177" class="Symbol">)</a> <a id="16179" class="Symbol">→</a> <a id="16181" href="Ledger.Conway.Specification.Epoch.html#16168" class="Bound">a</a> <a id="16183" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16185" href="Ledger.Conway.Specification.Epoch.html#16176" class="Bound">d</a><a id="16186" class="Symbol">)</a> <a id="16188" href="Ledger.Conway.Specification.Epoch.html#13767" class="Field">removedGovActions</a> <a id="16206" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="16208" class="Symbol">)</a>

    <a id="Post-POOLREAPUpdate.payout"></a><a id="16215" href="Ledger.Conway.Specification.Epoch.html#16215" class="Function">payout</a> <a id="16222" class="Symbol">:</a> <a id="16224" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="16238" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16240" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16249" href="Ledger.Conway.Specification.Epoch.html#16215" class="Function">payout</a> <a id="16256" class="Symbol">=</a> <a id="16258" href="Ledger.Conway.Specification.Epoch.html#16078" class="Function">govActionReturns</a> <a id="16275" href="Axiom.Set.Map.Dec.html#2149" class="Function Operator">∪⁺</a> <a id="16278" href="Ledger.Core.Specification.Address.html#1700" class="Field">WithdrawalsOf</a> <a id="16292" href="Ledger.Conway.Specification.Epoch.html#15780" class="Bound">es</a>

  <a id="16298" class="Keyword">opaque</a>
    <a id="Post-POOLREAPUpdate.refunds"></a><a id="16309" href="Ledger.Conway.Specification.Epoch.html#16309" class="Function">refunds</a> <a id="16317" class="Symbol">:</a> <a id="16319" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="16330" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16332" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16341" href="Ledger.Conway.Specification.Epoch.html#16309" class="Function">refunds</a> <a id="16349" class="Symbol">=</a> <a id="16351" href="Axiom.Set.Map.html#17518" class="Function">pullbackMap</a> <a id="16363" href="Ledger.Conway.Specification.Epoch.html#16215" class="Function">payout</a> <a id="16370" href="Ledger.Conway.Specification.Epoch.html#5507" class="Function">toRewardAddress</a> <a id="16386" class="Symbol">(</a><a id="16387" href="Class.IsSet.html#916" class="Function">dom</a> <a id="16391" class="Symbol">(</a><a id="16392" href="Ledger.Conway.Specification.Certs.html#1733" class="Field">RewardsOf</a> <a id="16402" href="Ledger.Conway.Specification.Epoch.html#15866" class="Bound">dState&#39;</a><a id="16409" class="Symbol">))</a>

  <a id="Post-POOLREAPUpdate.dState&#39;&#39;"></a><a id="16415" href="Ledger.Conway.Specification.Epoch.html#16415" class="Function">dState&#39;&#39;</a> <a id="16424" class="Symbol">:</a> <a id="16426" href="Ledger.Conway.Specification.Certs.html#3758" class="Record">DState</a>
  <a id="16435" href="Ledger.Conway.Specification.Epoch.html#16415" class="Function">dState&#39;&#39;</a> <a id="16444" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Gov.Actions.html#2810}{\htmlId{16448}{\htmlClass{Field}{\text{VoteDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15866}{\htmlId{16461}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#1898}{\htmlId{16471}{\htmlClass{Field}{\text{StakeDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15866}{\htmlId{16485}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#1733}{\htmlId{16495}{\htmlClass{Field}{\text{RewardsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15866}{\htmlId{16505}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \,\href{Axiom.Set.Map.Dec.html#2149}{\htmlId{16513}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16309}{\htmlId{16516}{\htmlClass{Function}{\text{refunds}}}}\, \end{pmatrix}$</a>

  <a id="Post-POOLREAPUpdate.unclaimed"></a><a id="16529" href="Ledger.Conway.Specification.Epoch.html#16529" class="Function">unclaimed</a> <a id="16539" class="Symbol">:</a> <a id="16541" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="16548" href="Ledger.Conway.Specification.Epoch.html#16529" class="Function">unclaimed</a> <a id="16558" class="Symbol">=</a> <a id="16560" href="Ledger.Prelude.HasCoin.html#171" class="Field">getCoin</a> <a id="16568" href="Ledger.Conway.Specification.Epoch.html#16215" class="Function">payout</a> <a id="16575" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="16577" href="Ledger.Prelude.HasCoin.html#171" class="Field">getCoin</a> <a id="16585" href="Ledger.Conway.Specification.Epoch.html#16309" class="Function">refunds</a>

  <a id="Post-POOLREAPUpdate.totWithdrawals"></a><a id="16596" href="Ledger.Conway.Specification.Epoch.html#16596" class="Function">totWithdrawals</a> <a id="16611" class="Symbol">:</a> <a id="16613" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="16620" href="Ledger.Conway.Specification.Epoch.html#16596" class="Function">totWithdrawals</a> <a id="16635" class="Symbol">=</a> <a id="16637" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="16640" href="Ledger.Conway.Specification.Epoch.html#16640" class="Bound">x</a> <a id="16642" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="16644" href="Ledger.Core.Specification.Address.html#1700" class="Field">WithdrawalsOf</a> <a id="16658" href="Ledger.Conway.Specification.Epoch.html#15780" class="Bound">es</a> <a id="16661" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="16663" href="Ledger.Conway.Specification.Epoch.html#16640" class="Bound">x</a>

  <a id="Post-POOLREAPUpdate.acnt&#39;&#39;"></a><a id="16668" href="Ledger.Conway.Specification.Epoch.html#16668" class="Function">acnt&#39;&#39;</a> <a id="16675" class="Symbol">:</a> <a id="16677" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
  <a id="16684" href="Ledger.Conway.Specification.Epoch.html#16668" class="Function">acnt&#39;&#39;</a> <a id="16691" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Prelude.Base.html#889}{\htmlId{16695}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15912}{\htmlId{16706}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \,\href{Data.Nat.Base.html#4462}{\htmlId{16712}{\htmlClass{Primitive Operator}{\text{∸}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16596}{\htmlId{16714}{\htmlClass{Function}{\text{totWithdrawals}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{16729}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Prelude.Base.html#554}{\htmlId{16731}{\htmlClass{Field}{\text{DonationsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15825}{\htmlId{16743}{\htmlClass{Bound}{\text{ls}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{16746}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16529}{\htmlId{16748}{\htmlClass{Function}{\text{unclaimed}}}}\, \\ \,\href{Ledger.Prelude.Base.html#773}{\htmlId{16760}{\htmlClass{Field}{\text{ReservesOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15912}{\htmlId{16771}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \end{pmatrix}$</a>

  <a id="Post-POOLREAPUpdate.updates"></a><a id="16782" href="Ledger.Conway.Specification.Epoch.html#16782" class="Function">updates</a> <a id="16790" class="Symbol">:</a> <a id="16792" href="Ledger.Conway.Specification.Epoch.html#15609" class="Record">Post-POOLREAP-Update</a>
  <a id="16815" href="Ledger.Conway.Specification.Epoch.html#16782" class="Function">updates</a> <a id="16823" class="Symbol">=</a> <a id="16825" href="Ledger.Conway.Specification.Epoch.html#15669" class="InductiveConstructor">Post-POOLREAPUpdate</a> <a id="16845" href="Ledger.Conway.Specification.Epoch.html#16415" class="Function">dState&#39;&#39;</a> <a id="16854" href="Ledger.Conway.Specification.Epoch.html#16668" class="Function">acnt&#39;&#39;</a>


<a id="16863" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="16868" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="16883" class="Symbol">:</a> <a id="16885" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="16887" class="Symbol">→</a> <a id="16889" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a> <a id="16900" class="Symbol">→</a> <a id="16902" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a> <a id="16908" class="Symbol">→</a> <a id="16910" href="Ledger.Conway.Specification.Epoch.html#1855" class="Record">EpochState</a> <a id="16921" class="Symbol">→</a> <a id="16923" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="16928" class="Keyword">where</a>


  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="16938" href="Ledger.Conway.Specification.Epoch.html#16938" class="InductiveConstructor">EPOCH</a> <a id="16944" class="Symbol">:</a>
    <a id="16950" class="Keyword">let</a>
      <a id="16960" href="Ledger.Conway.Specification.Epoch.html#16960" class="Bound">es</a> <a id="16963" class="Symbol">=</a> <a id="16965" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="16978" href="Ledger.Conway.Specification.Epoch.html#12874" class="Generalizable">fut</a>

      <a id="16989" href="Ledger.Conway.Specification.Epoch.html#16989" class="Bound">govUpd</a> <a id="16996" class="Symbol">:</a> <a id="16998" href="Ledger.Conway.Specification.Epoch.html#13693" class="Record">Governance-Update</a>
      <a id="17022" href="Ledger.Conway.Specification.Epoch.html#16989" class="Bound">govUpd</a> <a id="17029" class="Symbol">=</a> <a id="17031" href="Ledger.Conway.Specification.Epoch.html#14595" class="Function">GovernanceUpdate.updates</a> <a id="17056" href="Ledger.Conway.Specification.Epoch.html#12961" class="Generalizable">ls</a> <a id="17059" href="Ledger.Conway.Specification.Epoch.html#12874" class="Generalizable">fut</a>

      <a id="17070" href="Ledger.Conway.Specification.Epoch.html#14744" class="InductiveConstructor">Pre-POOLREAPUpdate</a> <a id="17089" href="Ledger.Conway.Specification.Epoch.html#17089" class="Bound">pState&#39;</a> <a id="17097" href="Ledger.Conway.Specification.Epoch.html#17097" class="Bound">gState&#39;</a> <a id="17105" href="Ledger.Conway.Specification.Epoch.html#17105" class="Bound">utxoSt&#39;</a> <a id="17113" class="Symbol">=</a> <a id="17115" href="Ledger.Conway.Specification.Epoch.html#15516" class="Function">Pre-POOLREAPUpdate.updates</a> <a id="17142" href="Ledger.Conway.Specification.Epoch.html#12961" class="Generalizable">ls</a> <a id="17145" href="Ledger.Conway.Specification.Epoch.html#16960" class="Bound">es</a> <a id="17148" href="Ledger.Conway.Specification.Epoch.html#16989" class="Bound">govUpd</a>
      <a id="17161" href="Ledger.Conway.Specification.Epoch.html#15669" class="InductiveConstructor">Post-POOLREAPUpdate</a> <a id="17181" href="Ledger.Conway.Specification.Epoch.html#17181" class="Bound">dState&#39;&#39;</a> <a id="17190" href="Ledger.Conway.Specification.Epoch.html#17190" class="Bound">acnt&#39;&#39;</a> <a id="17197" class="Symbol">=</a> <a id="17199" href="Ledger.Conway.Specification.Epoch.html#16782" class="Function">Post-POOLREAPUpdate.updates</a> <a id="17227" href="Ledger.Conway.Specification.Epoch.html#16960" class="Bound">es</a> <a id="17230" href="Ledger.Conway.Specification.Epoch.html#12961" class="Generalizable">ls</a> <a id="17233" href="Ledger.Conway.Specification.Epoch.html#13072" class="Generalizable">dState&#39;</a> <a id="17241" href="Ledger.Conway.Specification.Epoch.html#13096" class="Generalizable">acnt&#39;</a> <a id="17247" href="Ledger.Conway.Specification.Epoch.html#16989" class="Bound">govUpd</a>

      <a id="17261" href="Ledger.Conway.Specification.Epoch.html#17261" class="Bound">es&#39;</a> <a id="17265" class="Symbol">:</a> <a id="17267" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a>
      <a id="17284" href="Ledger.Conway.Specification.Epoch.html#17261" class="Bound">es&#39;</a> <a id="17288" class="Symbol">=</a> <a id="17290" class="Keyword">record</a> <a id="17297" href="Ledger.Conway.Specification.Epoch.html#16960" class="Bound">es</a> <a id="17300" class="Symbol">{</a> <a id="17302" href="Ledger.Conway.Specification.Enact.html#700" class="Field">withdrawals</a> <a id="17314" class="Symbol">=</a> <a id="17316" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="17318" class="Symbol">}</a>

      <a id="17327" href="Ledger.Conway.Specification.Epoch.html#17327" class="Bound">govSt&#39;</a> <a id="17334" class="Symbol">:</a> <a id="17336" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a>
      <a id="17351" href="Ledger.Conway.Specification.Epoch.html#17327" class="Bound">govSt&#39;</a> <a id="17358" class="Symbol">=</a> <a id="17360" href="Ledger.Conway.Specification.Epoch.html#13833" class="Field">Governance-Update.govSt&#39;</a> <a id="17385" href="Ledger.Conway.Specification.Epoch.html#16989" class="Bound">govUpd</a>

      <a id="17399" href="Ledger.Conway.Specification.Epoch.html#17399" class="Bound">stakeDistrs</a> <a id="17411" class="Symbol">:</a> <a id="17413" href="Ledger.Conway.Specification.Ratify.html#3126" class="Record">StakeDistrs</a>
      <a id="17431" href="Ledger.Conway.Specification.Epoch.html#17399" class="Bound">stakeDistrs</a> <a id="17443" class="Symbol">=</a> <a id="17445" href="Ledger.Conway.Specification.Epoch.html#12537" class="Function">mkStakeDistrs</a> <a id="17459" class="Symbol">(</a><a id="17460" href="Ledger.Conway.Specification.Rewards.html#7753" class="Field">Snapshots.mark</a> <a id="17475" href="Ledger.Conway.Specification.Epoch.html#13137" class="Generalizable">ss&#39;</a><a id="17478" class="Symbol">)</a> <a id="17480" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="17482" href="Ledger.Conway.Specification.Epoch.html#17105" class="Bound">utxoSt&#39;</a>
                                  <a id="17524" href="Ledger.Conway.Specification.Epoch.html#17327" class="Bound">govSt&#39;</a> <a id="17531" class="Symbol">(</a><a id="17532" href="Ledger.Conway.Specification.Certs.html#4671" class="Field">GStateOf</a> <a id="17541" href="Ledger.Conway.Specification.Epoch.html#12961" class="Generalizable">ls</a><a id="17543" class="Symbol">)</a> <a id="17545" class="Symbol">(</a><a id="17546" href="Ledger.Conway.Specification.Certs.html#4455" class="Field">DStateOf</a> <a id="17555" href="Ledger.Conway.Specification.Epoch.html#12961" class="Generalizable">ls</a><a id="17557" class="Symbol">)</a>

      <a id="17566" href="Ledger.Conway.Specification.Epoch.html#17566" class="Bound">Γ</a> <a id="17568" class="Symbol">:</a> <a id="17570" href="Ledger.Conway.Specification.Ratify.html#3245" class="Record">RatifyEnv</a>
      <a id="17586" href="Ledger.Conway.Specification.Epoch.html#17566" class="Bound">Γ</a> <a id="17588" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17399}{\htmlId{17592}{\htmlClass{Bound}{\text{stakeDistrs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12852}{\htmlId{17606}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Gov.Actions.html#7096}{\htmlId{17610}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12961}{\htmlId{17618}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#1483}{\htmlId{17623}{\htmlClass{Field}{\text{CCHotKeysOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12961}{\htmlId{17635}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Prelude.Base.html#889}{\htmlId{17640}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#17190}{\htmlId{17651}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#1568}{\htmlId{17660}{\htmlClass{Field}{\text{PoolsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12961}{\htmlId{17668}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Gov.Actions.html#2810}{\htmlId{17673}{\htmlClass{Field}{\text{VoteDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12961}{\htmlId{17686}{\htmlClass{Generalizable}{\text{ls}}}}\, \end{pmatrix}$</a>

    <a id="17696" class="Keyword">in</a>
        <a id="17707" href="Ledger.Conway.Specification.Epoch.html#12961" class="Generalizable">ls</a> <a id="17710" href="Ledger.Conway.Specification.Rewards.html#8194" class="Datatype Operator">⊢</a> <a id="17712" href="Ledger.Conway.Specification.Epoch.html#13134" class="Generalizable">ss</a> <a id="17715" href="Ledger.Conway.Specification.Rewards.html#8194" class="Datatype Operator">⇀⦇</a> <a id="17718" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="17721" href="Ledger.Conway.Specification.Rewards.html#8194" class="Datatype Operator">,SNAP⦈</a> <a id="17728" href="Ledger.Conway.Specification.Epoch.html#13137" class="Generalizable">ss&#39;</a>
      <a id="17738" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="17740" class="Symbol">_</a>  <a id="17743" href="Ledger.Conway.Specification.PoolReap.html#870" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17105}{\htmlId{17747}{\htmlClass{Bound}{\text{utxoSt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13091}{\htmlId{17757}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#4455}{\htmlId{17764}{\htmlClass{Field}{\text{DStateOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12961}{\htmlId{17773}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17089}{\htmlId{17778}{\htmlClass{Bound}{\text{pState&#39;}}}}\, \end{pmatrix}$</a> <a id="17788" href="Ledger.Conway.Specification.PoolReap.html#870" class="Datatype Operator">⇀⦇</a> <a id="17791" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="17793" href="Ledger.Conway.Specification.PoolReap.html#870" class="Datatype Operator">,POOLREAP⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13111}{\htmlId{17806}{\htmlClass{Generalizable}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13096}{\htmlId{17817}{\htmlClass{Generalizable}{\text{acnt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13072}{\htmlId{17825}{\htmlClass{Generalizable}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13052}{\htmlId{17835}{\htmlClass{Generalizable}{\text{pState&#39;&#39;}}}}\, \end{pmatrix}$</a>
      <a id="17852" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="17854" href="Ledger.Conway.Specification.Epoch.html#17566" class="Bound">Γ</a>  <a id="17857" href="Ledger.Conway.Specification.Ratify.html#13648" class="Function Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17261}{\htmlId{17861}{\htmlClass{Bound}{\text{es&#39;}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{17867}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Agda.Builtin.Bool.html#192}{\htmlId{17871}{\htmlClass{InductiveConstructor}{\text{false}}}}\, \end{pmatrix}$</a> <a id="17879" href="Ledger.Conway.Specification.Ratify.html#13648" class="Function Operator">⇀⦇</a> <a id="17882" href="Ledger.Conway.Specification.Epoch.html#17327" class="Bound">govSt&#39;</a> <a id="17889" href="Ledger.Conway.Specification.Ratify.html#13648" class="Function Operator">,RATIFIES⦈</a> <a id="17900" href="Ledger.Conway.Specification.Epoch.html#12878" class="Generalizable">fut&#39;</a>
      <a id="17911" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="17964" class="Symbol">_</a> <a id="17966" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13091}{\htmlId{17970}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13134}{\htmlId{17977}{\htmlClass{Generalizable}{\text{ss}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12961}{\htmlId{17982}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12975}{\htmlId{17987}{\htmlClass{Generalizable}{\text{es₀}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12874}{\htmlId{17993}{\htmlClass{Generalizable}{\text{fut}}}}\, \end{pmatrix}$</a> <a id="17999" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">⇀⦇</a> <a id="18002" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="18004" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">,EPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17190}{\htmlId{18014}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13137}{\htmlId{18023}{\htmlClass{Generalizable}{\text{ss&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13111}{\htmlId{18031}{\htmlClass{Generalizable}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17327}{\htmlId{18042}{\htmlClass{Bound}{\text{govSt&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17181}{\htmlId{18053}{\htmlClass{Bound}{\text{dState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13052}{\htmlId{18064}{\htmlClass{Generalizable}{\text{pState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17097}{\htmlId{18075}{\htmlClass{Bound}{\text{gState&#39;}}}}\, \end{pmatrix} \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#17261}{\htmlId{18091}{\htmlClass{Bound}{\text{es&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12878}{\htmlId{18097}{\htmlClass{Generalizable}{\text{fut&#39;}}}}\, \end{pmatrix}$</a>


<a id="18106" class="Keyword">data</a> <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="18111" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="18129" class="Symbol">:</a> <a id="18131" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="18133" class="Symbol">→</a> <a id="18135" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a> <a id="18149" class="Symbol">→</a> <a id="18151" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a> <a id="18157" class="Symbol">→</a> <a id="18159" href="Ledger.Conway.Specification.Epoch.html#3606" class="Record">NewEpochState</a> <a id="18173" class="Symbol">→</a> <a id="18175" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="18180" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="18189" href="Ledger.Conway.Specification.Epoch.html#18189" class="InductiveConstructor">NEWEPOCH-New</a> <a id="18202" class="Symbol">:</a> <a id="18204" class="Symbol">∀</a> <a id="18206" class="Symbol">{</a><a id="18207" href="Ledger.Conway.Specification.Epoch.html#18207" class="Bound">bprev</a> <a id="18213" href="Ledger.Conway.Specification.Epoch.html#18213" class="Bound">bcur</a> <a id="18218" class="Symbol">:</a> <a id="18220" href="Ledger.Conway.Specification.Rewards.html#4906" class="Function">BlocksMade</a><a id="18230" class="Symbol">}</a> <a id="18232" class="Symbol">→</a>
    <a id="18238" class="Keyword">let</a>
      <a id="18248" href="Ledger.Conway.Specification.Epoch.html#18248" class="Bound">eps&#39;</a> <a id="18253" class="Symbol">=</a> <a id="18255" href="Ledger.Conway.Specification.Epoch.html#8970" class="Function">applyRUpd</a> <a id="18265" href="Ledger.Conway.Specification.Epoch.html#13155" class="Generalizable">ru</a> <a id="18268" href="Ledger.Conway.Specification.Epoch.html#12931" class="Generalizable">eps</a>
      <a id="18278" href="Ledger.Conway.Specification.Epoch.html#18278" class="Bound">ss</a>   <a id="18283" class="Symbol">=</a> <a id="18285" href="Ledger.Conway.Specification.Epoch.html#1945" class="Field">EpochState.ss</a> <a id="18299" href="Ledger.Conway.Specification.Epoch.html#12940" class="Generalizable">eps&#39;&#39;</a>
      <a id="18311" href="Ledger.Conway.Specification.Epoch.html#18311" class="Bound">pd&#39;</a>  <a id="18316" class="Symbol">=</a> <a id="18318" href="Ledger.Conway.Specification.Epoch.html#10044" class="Function">calculatePoolDelegatedStake</a> <a id="18346" class="Symbol">(</a><a id="18347" href="Ledger.Conway.Specification.Rewards.html#7758" class="Field">Snapshots.set</a> <a id="18361" href="Ledger.Conway.Specification.Epoch.html#18278" class="Bound">ss</a><a id="18363" class="Symbol">)</a>
    <a id="18369" class="Keyword">in</a>
      <a id="18378" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18380" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="18382" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="18384" href="Ledger.Conway.Specification.Epoch.html#12854" class="Generalizable">lastEpoch</a> <a id="18394" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18396" class="Number">1</a>
      <a id="18404" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="18406" class="Symbol">_</a> <a id="18408" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">⊢</a> <a id="18410" href="Ledger.Conway.Specification.Epoch.html#18248" class="Bound">eps&#39;</a> <a id="18415" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">⇀⦇</a> <a id="18418" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="18420" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">,EPOCH⦈</a> <a id="18428" href="Ledger.Conway.Specification.Epoch.html#12940" class="Generalizable">eps&#39;&#39;</a>
      <a id="18440" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18493" class="Symbol">_</a> <a id="18495" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12854}{\htmlId{18499}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18207}{\htmlId{18511}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18213}{\htmlId{18519}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12931}{\htmlId{18526}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#173}{\htmlId{18532}{\htmlClass{InductiveConstructor}{\text{just}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13155}{\htmlId{18537}{\htmlClass{Generalizable}{\text{ru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13202}{\htmlId{18542}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18547" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">⇀⦇</a> <a id="18550" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="18552" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12852}{\htmlId{18565}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18213}{\htmlId{18569}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Axiom.Set.Map.html#2671}{\htmlId{18576}{\htmlClass{Function}{\text{∅ᵐ}}}}\,  \\ \,\href{Ledger.Conway.Specification.Epoch.html#12940}{\htmlId{18582}{\htmlClass{Generalizable}{\text{eps&#39;&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{18590}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18311}{\htmlId{18600}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="18609" href="Ledger.Conway.Specification.Epoch.html#18609" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="18626" class="Symbol">:</a> <a id="18628" class="Symbol">∀</a> <a id="18630" class="Symbol">{</a><a id="18631" href="Ledger.Conway.Specification.Epoch.html#18631" class="Bound">bprev</a> <a id="18637" href="Ledger.Conway.Specification.Epoch.html#18637" class="Bound">bcur</a> <a id="18642" class="Symbol">:</a> <a id="18644" href="Ledger.Conway.Specification.Rewards.html#4906" class="Function">BlocksMade</a><a id="18654" class="Symbol">}</a> <a id="18656" class="Symbol">→</a>
    <a id="18662" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18664" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="18666" href="Relation.Binary.PropositionalEquality.Core.html#1000" class="Function Operator">≢</a> <a id="18668" href="Ledger.Conway.Specification.Epoch.html#12854" class="Generalizable">lastEpoch</a> <a id="18678" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18680" class="Number">1</a>
      <a id="18688" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18741" class="Symbol">_</a> <a id="18743" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12854}{\htmlId{18747}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18631}{\htmlId{18759}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18637}{\htmlId{18767}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12931}{\htmlId{18774}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13175}{\htmlId{18780}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13202}{\htmlId{18786}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18791" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">⇀⦇</a> <a id="18794" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="18796" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12854}{\htmlId{18809}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18631}{\htmlId{18821}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18637}{\htmlId{18829}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12931}{\htmlId{18836}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13175}{\htmlId{18842}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13202}{\htmlId{18848}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="18856" href="Ledger.Conway.Specification.Epoch.html#18856" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="18882" class="Symbol">:</a> <a id="18884" class="Symbol">∀</a> <a id="18886" class="Symbol">{</a><a id="18887" href="Ledger.Conway.Specification.Epoch.html#18887" class="Bound">bprev</a> <a id="18893" href="Ledger.Conway.Specification.Epoch.html#18893" class="Bound">bcur</a> <a id="18898" class="Symbol">:</a> <a id="18900" href="Ledger.Conway.Specification.Rewards.html#4906" class="Function">BlocksMade</a><a id="18910" class="Symbol">}</a> <a id="18912" class="Symbol">→</a>
    <a id="18918" class="Keyword">let</a>
      <a id="18928" href="Ledger.Conway.Specification.Epoch.html#18928" class="Bound">ss</a>  <a id="18932" class="Symbol">=</a> <a id="18934" href="Ledger.Conway.Specification.Epoch.html#1945" class="Field">EpochState.ss</a> <a id="18948" href="Ledger.Conway.Specification.Epoch.html#12935" class="Generalizable">eps&#39;</a>
      <a id="18959" href="Ledger.Conway.Specification.Epoch.html#18959" class="Bound">pd&#39;</a> <a id="18963" class="Symbol">=</a> <a id="18965" href="Ledger.Conway.Specification.Epoch.html#10044" class="Function">calculatePoolDelegatedStake</a> <a id="18993" class="Symbol">(</a><a id="18994" href="Ledger.Conway.Specification.Rewards.html#7758" class="Field">Snapshots.set</a> <a id="19008" href="Ledger.Conway.Specification.Epoch.html#18928" class="Bound">ss</a><a id="19010" class="Symbol">)</a>
    <a id="19016" class="Keyword">in</a>
      <a id="19025" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="19027" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="19029" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="19031" href="Ledger.Conway.Specification.Epoch.html#12854" class="Generalizable">lastEpoch</a> <a id="19041" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="19043" class="Number">1</a>
      <a id="19051" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="19053" class="Symbol">_</a> <a id="19055" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">⊢</a> <a id="19057" href="Ledger.Conway.Specification.Epoch.html#12931" class="Generalizable">eps</a> <a id="19061" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">⇀⦇</a> <a id="19064" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="19066" href="Ledger.Conway.Specification.Epoch.html#16868" class="Datatype Operator">,EPOCH⦈</a> <a id="19074" href="Ledger.Conway.Specification.Epoch.html#12935" class="Generalizable">eps&#39;</a>
      <a id="19085" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="19138" class="Symbol">_</a> <a id="19140" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12854}{\htmlId{19144}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18887}{\htmlId{19156}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18893}{\htmlId{19164}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12931}{\htmlId{19171}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{19177}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13202}{\htmlId{19187}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="19192" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">⇀⦇</a> <a id="19195" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">e</a> <a id="19197" href="Ledger.Conway.Specification.Epoch.html#18111" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12852}{\htmlId{19210}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18893}{\htmlId{19214}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Axiom.Set.Map.html#2671}{\htmlId{19221}{\htmlClass{Function}{\text{∅ᵐ}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12935}{\htmlId{19226}{\htmlClass{Generalizable}{\text{eps&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{19233}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18959}{\htmlId{19243}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

</pre></body></html>