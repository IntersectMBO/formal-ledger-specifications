<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Epoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="51" class="Keyword">using</a> <a id="57" class="Symbol">()</a> <a id="60" class="Keyword">renaming</a> <a id="69" class="Symbol">(</a><a id="70" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a> <a id="73" class="Symbol">to</a> <a id="76" class="InductiveConstructor">pos</a><a id="79" class="Symbol">)</a>
<a id="81" class="Keyword">import</a>      <a id="93" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="106" class="Symbol">as</a> <a id="109" class="Module">ℤ</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Data.Integer.Properties.html" class="Module">Data.Integer.Properties</a> <a id="147" class="Keyword">using</a> <a id="153" class="Symbol">(</a><a id="154" class="Keyword">module</a> <a id="161" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a><a id="172" class="Symbol">;</a> <a id="174" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a><a id="182" class="Symbol">;</a> <a id="184" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a><a id="194" class="Symbol">;</a> <a id="196" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a><a id="207" class="Symbol">)</a>
                                    <a id="245" class="Keyword">renaming</a> <a id="254" class="Symbol">(</a><a id="255" href="Data.Integer.Properties.html#12508" class="Function">nonNegative⁻¹</a> <a id="269" class="Symbol">to</a> <a id="272" class="Function">nonNegative⁻¹ℤ</a><a id="286" class="Symbol">)</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a><a id="327" class="Symbol">)</a>
<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="372" class="Keyword">using</a> <a id="378" class="Symbol">(</a><a id="379" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a><a id="386" class="Symbol">)</a>
<a id="388" class="Keyword">open</a> <a id="393" class="Keyword">import</a> <a id="400" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="414" class="Keyword">using</a> <a id="420" class="Symbol">(</a><a id="421" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="422" class="Symbol">;</a> <a id="424" href="Data.Rational.Base.html#7195" class="Function">floor</a><a id="429" class="Symbol">;</a> <a id="431" href="Data.Rational.Base.html#6394" class="Function Operator">_*_</a><a id="434" class="Symbol">;</a> <a id="436" href="Data.Rational.Base.html#6787" class="Function Operator">_÷_</a><a id="439" class="Symbol">;</a> <a id="441" href="Data.Rational.Base.html#3963" class="Function Operator">_/_</a><a id="444" class="Symbol">;</a> <a id="446" href="Data.Rational.Base.html#6933" class="Function Operator">_⊓_</a><a id="449" class="Symbol">;</a> <a id="451" href="Data.Rational.Properties.html#4152" class="Function Operator">_≟_</a><a id="454" class="Symbol">;</a> <a id="456" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a><a id="465" class="Symbol">)</a>
<a id="467" class="Keyword">open</a> <a id="472" class="Keyword">import</a> <a id="479" href="Data.Rational.Literals.html" class="Module">Data.Rational.Literals</a> <a id="502" class="Keyword">using</a> <a id="508" class="Symbol">(</a><a id="509" href="Data.Rational.Literals.html#740" class="Function">number</a><a id="515" class="Symbol">;</a> <a id="517" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a><a id="522" class="Symbol">)</a>
<a id="524" class="Keyword">open</a> <a id="529" class="Keyword">import</a> <a id="536" href="Data.Rational.Properties.html" class="Module">Data.Rational.Properties</a> <a id="561" class="Keyword">using</a> <a id="567" class="Symbol">(</a><a id="568" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a><a id="581" class="Symbol">;</a> <a id="583" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a><a id="593" class="Symbol">;</a> <a id="595" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a><a id="600" class="Symbol">)</a>
<a id="602" class="Keyword">open</a> <a id="607" class="Keyword">import</a> <a id="614" href="stdlib.Data.Rational.Properties.html" class="Module">stdlib.Data.Rational.Properties</a> <a id="646" class="Keyword">using</a> <a id="652" class="Symbol">(</a><a id="653" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a><a id="663" class="Symbol">;</a> <a id="665" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a><a id="672" class="Symbol">;</a> <a id="674" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a><a id="682" class="Symbol">;</a> <a id="684" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a><a id="691" class="Symbol">;</a> <a id="693" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a><a id="701" class="Symbol">)</a>

<a id="704" class="Keyword">open</a> <a id="709" class="Keyword">import</a> <a id="716" href="Data.Integer.Tactic.RingSolver.html" class="Module">Data.Integer.Tactic.RingSolver</a> <a id="747" class="Keyword">using</a> <a id="753" class="Symbol">(</a><a id="754" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a><a id="761" class="Symbol">)</a>

<a id="764" class="Keyword">open</a> <a id="769" class="Keyword">import</a> <a id="776" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="798" class="Keyword">open</a> <a id="803" class="Keyword">import</a> <a id="810" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="825" class="Keyword">hiding</a> <a id="832" class="Symbol">(</a><a id="833" href="Data.List.Base.html#5114" class="Function">iterate</a><a id="840" class="Symbol">;</a> <a id="842" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="845" class="Symbol">;</a> <a id="847" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="850" class="Symbol">;</a> <a id="852" href="Data.Nat.Base.html#5851" class="Function Operator">_⊓_</a><a id="855" class="Symbol">;</a> <a id="857" href="Class.DecEq.Core.html#168" class="Field Operator">_≟_</a><a id="860" class="Symbol">;</a> <a id="862" href="Data.Nat.Base.html#3425" class="Function">≢-nonZero</a><a id="871" class="Symbol">)</a>
<a id="873" class="Keyword">open</a> <a id="878" href="Ledger.Prelude.html#2387" class="Module">Filter</a> <a id="885" class="Keyword">using</a> <a id="891" class="Symbol">(</a><a id="892" href="Ledger.Prelude.html#2402" class="Function">filter</a><a id="898" class="Symbol">)</a>
<a id="900" class="Keyword">open</a> <a id="905" class="Keyword">import</a> <a id="912" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>
<a id="949" class="Keyword">open</a> <a id="954" class="Keyword">import</a> <a id="961" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="1001" class="Keyword">open</a> <a id="1006" class="Keyword">import</a> <a id="1013" href="Ledger.Prelude.Numeric.UnitInterval.html" class="Module">Ledger.Prelude.Numeric.UnitInterval</a> <a id="1049" class="Keyword">using</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Ledger.Prelude.Numeric.UnitInterval.html#1988" class="Function">fromUnitInterval</a><a id="1072" class="Symbol">;</a> <a id="1074" href="Ledger.Prelude.Numeric.UnitInterval.html#3336" class="Function">UnitInterval-*-0≤</a><a id="1091" class="Symbol">)</a>

<a id="1094" class="Keyword">open</a> <a id="1099" href="Agda.Builtin.FromNat.html#196" class="Module">Number</a> <a id="1106" href="Data.Rational.Literals.html#740" class="Function">number</a> <a id="1113" class="Keyword">renaming</a> <a id="1122" class="Symbol">(</a><a id="1123" href="Agda.Builtin.FromNat.html#281" class="Field">fromNat</a> <a id="1131" class="Symbol">to</a> <a id="1134" class="Field">fromℕ</a><a id="1139" class="Symbol">)</a>

<a id="1142" class="Keyword">module</a> <a id="1149" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a>
  <a id="1185" class="Symbol">(</a><a id="1186" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a> <a id="1190" class="Symbol">:</a> <a id="1192" class="Symbol">_)</a> <a id="1195" class="Symbol">(</a><a id="1196" class="Keyword">open</a> <a id="1201" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="1222" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a><a id="1225" class="Symbol">)</a>
  <a id="1229" class="Symbol">(</a><a id="1230" href="Ledger.Conway.Specification.Epoch.html#1230" class="Bound">abs</a> <a id="1234" class="Symbol">:</a> <a id="1236" href="Ledger.Conway.Specification.Abstract.html#654" class="Record">AbstractFunctions</a> <a id="1254" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a><a id="1257" class="Symbol">)</a> <a id="1259" class="Symbol">(</a><a id="1260" class="Keyword">open</a> <a id="1265" href="Ledger.Conway.Specification.Abstract.html#654" class="Module">AbstractFunctions</a> <a id="1283" href="Ledger.Conway.Specification.Epoch.html#1230" class="Bound">abs</a><a id="1286" class="Symbol">)</a>
  <a id="1290" class="Keyword">where</a>

<a id="1297" class="Keyword">open</a> <a id="1302" class="Keyword">import</a> <a id="1309" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="1343" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="1356" class="Keyword">open</a> <a id="1361" class="Keyword">import</a> <a id="1368" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="1402" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="1415" class="Keyword">open</a> <a id="1420" class="Keyword">import</a> <a id="1427" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="1459" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a>
<a id="1463" class="Keyword">open</a> <a id="1468" class="Keyword">import</a> <a id="1475" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="1510" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a> <a id="1514" href="Ledger.Conway.Specification.Epoch.html#1230" class="Bound">abs</a>
<a id="1518" class="Keyword">open</a> <a id="1523" class="Keyword">import</a> <a id="1530" href="Ledger.Conway.Specification.PoolReap.html" class="Module">Ledger.Conway.Specification.PoolReap</a> <a id="1567" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a> <a id="1571" href="Ledger.Conway.Specification.Epoch.html#1230" class="Bound">abs</a>
<a id="1575" class="Keyword">open</a> <a id="1580" class="Keyword">import</a> <a id="1587" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="1622" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a>
<a id="1626" class="Keyword">open</a> <a id="1631" class="Keyword">import</a> <a id="1638" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="1674" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a> <a id="1678" href="Ledger.Conway.Specification.Epoch.html#1230" class="Bound">abs</a>
<a id="1682" class="Keyword">open</a> <a id="1687" class="Keyword">import</a> <a id="1694" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="1727" href="Ledger.Conway.Specification.Epoch.html#1186" class="Bound">txs</a> <a id="1731" href="Ledger.Conway.Specification.Epoch.html#1230" class="Bound">abs</a>


<a id="1737" class="Keyword">record</a> <a id="EpochState"></a><a id="1744" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a> <a id="1755" class="Symbol">:</a> <a id="1757" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1762" class="Keyword">where</a>


  <a id="1772" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1784" href="Ledger.Conway.Specification.Epoch.html#1784" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>


  <a id="1802" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1812" href="Ledger.Conway.Specification.Epoch.html#1812" class="Field">acnt</a>       <a id="1823" class="Symbol">:</a> <a id="1825" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1834" href="Ledger.Conway.Specification.Epoch.html#1834" class="Field">ss</a>         <a id="1845" class="Symbol">:</a> <a id="1847" href="Ledger.Conway.Specification.Rewards.html#7745" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1861" href="Ledger.Conway.Specification.Epoch.html#1861" class="Field">ls</a>         <a id="1872" class="Symbol">:</a> <a id="1874" href="Ledger.Conway.Specification.Ledger.html#979" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1885" href="Ledger.Conway.Specification.Epoch.html#1885" class="Field">es</a>         <a id="1896" class="Symbol">:</a> <a id="1898" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="1913" href="Ledger.Conway.Specification.Epoch.html#1913" class="Field">fut</a>        <a id="1924" class="Symbol">:</a> <a id="1926" href="Ledger.Conway.Specification.Ratify.html#3374" class="Record">RatifyState</a>


<a id="1940" class="Keyword">record</a> <a id="HasEpochState"></a><a id="1947" href="Ledger.Conway.Specification.Epoch.html#1947" class="Record">HasEpochState</a> <a id="1961" class="Symbol">{</a><a id="1962" href="Ledger.Conway.Specification.Epoch.html#1962" class="Bound">a</a><a id="1963" class="Symbol">}</a> <a id="1965" class="Symbol">(</a><a id="1966" href="Ledger.Conway.Specification.Epoch.html#1966" class="Bound">A</a> <a id="1968" class="Symbol">:</a> <a id="1970" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1975" href="Ledger.Conway.Specification.Epoch.html#1962" class="Bound">a</a><a id="1976" class="Symbol">)</a> <a id="1978" class="Symbol">:</a> <a id="1980" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1985" href="Ledger.Conway.Specification.Epoch.html#1962" class="Bound">a</a> <a id="1987" class="Keyword">where</a>
  <a id="1995" class="Keyword">field</a> <a id="HasEpochState.EpochStateOf"></a><a id="2001" href="Ledger.Conway.Specification.Epoch.html#2001" class="Field">EpochStateOf</a> <a id="2014" class="Symbol">:</a> <a id="2016" href="Ledger.Conway.Specification.Epoch.html#1966" class="Bound">A</a> <a id="2018" class="Symbol">→</a> <a id="2020" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
<a id="2031" class="Keyword">open</a> <a id="2036" href="Ledger.Conway.Specification.Epoch.html#1947" class="Module">HasEpochState</a> <a id="2050" class="Symbol">⦃...⦄</a> <a id="2056" class="Keyword">public</a>

<a id="2064" class="Keyword">instance</a>
  <a id="HasSnapshots-EpochState"></a><a id="2075" href="Ledger.Conway.Specification.Epoch.html#2075" class="Function">HasSnapshots-EpochState</a> <a id="2099" class="Symbol">:</a> <a id="2101" href="Ledger.Conway.Specification.Rewards.html#7836" class="Record">HasSnapshots</a> <a id="2114" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="2127" href="Ledger.Conway.Specification.Epoch.html#2075" class="Function">HasSnapshots-EpochState</a> <a id="2151" class="Symbol">.</a><a id="2152" href="Ledger.Conway.Specification.Rewards.html#7889" class="Field">SnapshotsOf</a> <a id="2164" class="Symbol">=</a> <a id="2166" href="Ledger.Conway.Specification.Epoch.html#1834" class="Field">EpochState.ss</a>

  <a id="HasLState-EpochState"></a><a id="2183" href="Ledger.Conway.Specification.Epoch.html#2183" class="Function">HasLState-EpochState</a> <a id="2204" class="Symbol">:</a> <a id="2206" href="Ledger.Conway.Specification.Ledger.html#1123" class="Record">HasLState</a> <a id="2216" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="2229" href="Ledger.Conway.Specification.Epoch.html#2183" class="Function">HasLState-EpochState</a> <a id="2250" class="Symbol">.</a><a id="2251" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a> <a id="2260" class="Symbol">=</a> <a id="2262" href="Ledger.Conway.Specification.Epoch.html#1861" class="Field">EpochState.ls</a>

  <a id="HasEnactState-EpochState"></a><a id="2279" href="Ledger.Conway.Specification.Epoch.html#2279" class="Function">HasEnactState-EpochState</a> <a id="2304" class="Symbol">:</a> <a id="2306" href="Ledger.Conway.Specification.Enact.html#737" class="Record">HasEnactState</a> <a id="2320" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="2333" href="Ledger.Conway.Specification.Epoch.html#2279" class="Function">HasEnactState-EpochState</a> <a id="2358" class="Symbol">.</a><a id="2359" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="2372" class="Symbol">=</a> <a id="2374" href="Ledger.Conway.Specification.Epoch.html#1885" class="Field">EpochState.es</a>

  <a id="HasDeposits-EpochState"></a><a id="2391" href="Ledger.Conway.Specification.Epoch.html#2391" class="Function">HasDeposits-EpochState</a> <a id="2414" class="Symbol">:</a> <a id="2416" href="Ledger.Conway.Specification.Certs.html#864" class="Record">HasDeposits</a> <a id="2428" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="2441" href="Ledger.Conway.Specification.Epoch.html#2391" class="Function">HasDeposits-EpochState</a> <a id="2464" class="Symbol">.</a><a id="2465" href="Ledger.Conway.Specification.Certs.html#916" class="Field">DepositsOf</a> <a id="2476" class="Symbol">=</a> <a id="2478" href="Ledger.Conway.Specification.Certs.html#916" class="Field">DepositsOf</a> <a id="2489" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2491" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a>

  <a id="HasDReps-EpochState"></a><a id="2503" href="Ledger.Conway.Specification.Epoch.html#2503" class="Function">HasDReps-EpochState</a> <a id="2523" class="Symbol">:</a> <a id="2525" href="Ledger.Conway.Specification.Certs.html#1554" class="Record">HasDReps</a> <a id="2534" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="2547" href="Ledger.Conway.Specification.Epoch.html#2503" class="Function">HasDReps-EpochState</a> <a id="2567" class="Symbol">.</a><a id="2568" href="Ledger.Conway.Specification.Certs.html#1603" class="Field">DRepsOf</a> <a id="2576" class="Symbol">=</a> <a id="2578" href="Ledger.Conway.Specification.Certs.html#1603" class="Field">DRepsOf</a> <a id="2586" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2588" href="Ledger.Conway.Specification.Certs.html#4921" class="Field">CertStateOf</a> <a id="2600" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2602" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a>

  <a id="HasTreasury-EpochState"></a><a id="2614" href="Ledger.Conway.Specification.Epoch.html#2614" class="Function">HasTreasury-EpochState</a> <a id="2637" class="Symbol">:</a> <a id="2639" href="Ledger.Prelude.Base.html#837" class="Record">HasTreasury</a> <a id="2651" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="2664" href="Ledger.Conway.Specification.Epoch.html#2614" class="Function">HasTreasury-EpochState</a> <a id="2687" class="Symbol">.</a><a id="2688" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="2699" class="Symbol">=</a> <a id="2701" href="Ledger.Conway.Specification.PParams.html#775" class="Field">Acnt.treasury</a> <a id="2715" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2717" href="Ledger.Conway.Specification.Epoch.html#1812" class="Field">EpochState.acnt</a>

  <a id="HasReserves-EpochState"></a><a id="2736" href="Ledger.Conway.Specification.Epoch.html#2736" class="Function">HasReserves-EpochState</a> <a id="2759" class="Symbol">:</a> <a id="2761" href="Ledger.Prelude.Base.html#721" class="Record">HasReserves</a> <a id="2773" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="2786" href="Ledger.Conway.Specification.Epoch.html#2736" class="Function">HasReserves-EpochState</a> <a id="2809" class="Symbol">.</a><a id="2810" href="Ledger.Prelude.Base.html#773" class="Field">ReservesOf</a> <a id="2821" class="Symbol">=</a> <a id="2823" href="Ledger.Conway.Specification.PParams.html#784" class="Field">Acnt.reserves</a> <a id="2837" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2839" href="Ledger.Conway.Specification.Epoch.html#1812" class="Field">EpochState.acnt</a>

  <a id="HasPParams-EpochState"></a><a id="2858" href="Ledger.Conway.Specification.Epoch.html#2858" class="Function">HasPParams-EpochState</a> <a id="2880" class="Symbol">:</a> <a id="2882" href="Ledger.Conway.Specification.PParams.html#3489" class="Record">HasPParams</a> <a id="2893" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="2906" href="Ledger.Conway.Specification.Epoch.html#2858" class="Function">HasPParams-EpochState</a> <a id="2928" class="Symbol">.</a><a id="2929" href="Ledger.Conway.Specification.PParams.html#3540" class="Field">PParamsOf</a> <a id="2939" class="Symbol">=</a> <a id="2941" href="Ledger.Conway.Specification.PParams.html#3540" class="Field">PParamsOf</a> <a id="2951" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2953" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a>

  <a id="HasRatifyState-EpochState"></a><a id="2969" href="Ledger.Conway.Specification.Epoch.html#2969" class="Function">HasRatifyState-EpochState</a> <a id="2995" class="Symbol">:</a> <a id="2997" href="Ledger.Conway.Specification.Ratify.html#3531" class="Record">HasRatifyState</a> <a id="3012" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="3025" href="Ledger.Conway.Specification.Epoch.html#2969" class="Function">HasRatifyState-EpochState</a> <a id="3051" class="Symbol">.</a><a id="3052" href="Ledger.Conway.Specification.Ratify.html#3586" class="Field">RatifyStateOf</a> <a id="3066" class="Symbol">=</a> <a id="3068" href="Ledger.Conway.Specification.Epoch.html#1913" class="Field">EpochState.fut</a>

  <a id="HasPState-EpochState"></a><a id="3086" href="Ledger.Conway.Specification.Epoch.html#3086" class="Function">HasPState-EpochState</a> <a id="3107" class="Symbol">:</a> <a id="3109" href="Ledger.Conway.Specification.Certs.html#4652" class="Record">HasPState</a> <a id="3119" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="3132" href="Ledger.Conway.Specification.Epoch.html#3086" class="Function">HasPState-EpochState</a> <a id="3153" class="Symbol">.</a><a id="3154" href="Ledger.Conway.Specification.Certs.html#4702" class="Field">PStateOf</a> <a id="3163" class="Symbol">=</a> <a id="3165" href="Ledger.Conway.Specification.Certs.html#4702" class="Field">PStateOf</a> <a id="3174" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3176" href="Ledger.Conway.Specification.Certs.html#4921" class="Field">CertStateOf</a> <a id="3188" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3190" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a>


<a id="PoolDelegatedStake"></a><a id="3201" href="Ledger.Conway.Specification.Epoch.html#3201" class="Function">PoolDelegatedStake</a> <a id="3220" class="Symbol">:</a> <a id="3222" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3227" href="Ledger.Conway.Specification.Epoch.html#3201" class="Function">PoolDelegatedStake</a> <a id="3246" class="Symbol">=</a> <a id="3248" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="3256" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3258" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>

<a id="3264" class="Keyword">record</a> <a id="NewEpochState"></a><a id="3271" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a> <a id="3285" class="Symbol">:</a> <a id="3287" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3292" class="Keyword">where</a>
  <a id="3300" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="3310" href="Ledger.Conway.Specification.Epoch.html#3310" class="Field">lastEpoch</a>   <a id="3322" class="Symbol">:</a> <a id="3324" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
    <a id="NewEpochState.bprev"></a><a id="3334" href="Ledger.Conway.Specification.Epoch.html#3334" class="Field">bprev</a>       <a id="3346" class="Symbol">:</a> <a id="3348" href="Ledger.Conway.Specification.Rewards.html#4867" class="Function">BlocksMade</a>
    <a id="NewEpochState.bcur"></a><a id="3363" href="Ledger.Conway.Specification.Epoch.html#3363" class="Field">bcur</a>        <a id="3375" class="Symbol">:</a> <a id="3377" href="Ledger.Conway.Specification.Rewards.html#4867" class="Function">BlocksMade</a>
    <a id="NewEpochState.epochState"></a><a id="3392" href="Ledger.Conway.Specification.Epoch.html#3392" class="Field">epochState</a>  <a id="3404" class="Symbol">:</a> <a id="3406" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="3421" href="Ledger.Conway.Specification.Epoch.html#3421" class="Field">ru</a>          <a id="3433" class="Symbol">:</a> <a id="3435" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3441" href="Ledger.Conway.Specification.Rewards.html#6210" class="Record">RewardUpdate</a>
    <a id="NewEpochState.pd"></a><a id="3458" href="Ledger.Conway.Specification.Epoch.html#3458" class="Field">pd</a>          <a id="3470" class="Symbol">:</a> <a id="3472" href="Ledger.Conway.Specification.Epoch.html#3201" class="Function">PoolDelegatedStake</a>


<a id="3493" class="Keyword">record</a> <a id="HasNewEpochState"></a><a id="3500" href="Ledger.Conway.Specification.Epoch.html#3500" class="Record">HasNewEpochState</a> <a id="3517" class="Symbol">{</a><a id="3518" href="Ledger.Conway.Specification.Epoch.html#3518" class="Bound">a</a><a id="3519" class="Symbol">}</a> <a id="3521" class="Symbol">(</a><a id="3522" href="Ledger.Conway.Specification.Epoch.html#3522" class="Bound">A</a> <a id="3524" class="Symbol">:</a> <a id="3526" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3531" href="Ledger.Conway.Specification.Epoch.html#3518" class="Bound">a</a><a id="3532" class="Symbol">)</a> <a id="3534" class="Symbol">:</a> <a id="3536" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3541" href="Ledger.Conway.Specification.Epoch.html#3518" class="Bound">a</a> <a id="3543" class="Keyword">where</a>
  <a id="3551" class="Keyword">field</a> <a id="HasNewEpochState.NewEpochStateOf"></a><a id="3557" href="Ledger.Conway.Specification.Epoch.html#3557" class="Field">NewEpochStateOf</a> <a id="3573" class="Symbol">:</a> <a id="3575" href="Ledger.Conway.Specification.Epoch.html#3522" class="Bound">A</a> <a id="3577" class="Symbol">→</a> <a id="3579" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
<a id="3593" class="Keyword">open</a> <a id="3598" href="Ledger.Conway.Specification.Epoch.html#3500" class="Module">HasNewEpochState</a> <a id="3615" class="Symbol">⦃...⦄</a> <a id="3621" class="Keyword">public</a>
<a id="3628" class="Keyword">record</a> <a id="HasLastEpoch"></a><a id="3635" href="Ledger.Conway.Specification.Epoch.html#3635" class="Record">HasLastEpoch</a>     <a id="3652" class="Symbol">{</a><a id="3653" href="Ledger.Conway.Specification.Epoch.html#3653" class="Bound">a</a><a id="3654" class="Symbol">}</a> <a id="3656" class="Symbol">(</a><a id="3657" href="Ledger.Conway.Specification.Epoch.html#3657" class="Bound">A</a> <a id="3659" class="Symbol">:</a> <a id="3661" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3666" href="Ledger.Conway.Specification.Epoch.html#3653" class="Bound">a</a><a id="3667" class="Symbol">)</a> <a id="3669" class="Symbol">:</a> <a id="3671" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3676" href="Ledger.Conway.Specification.Epoch.html#3653" class="Bound">a</a> <a id="3678" class="Keyword">where</a> <a id="3684" class="Keyword">field</a> <a id="HasLastEpoch.LastEpochOf"></a><a id="3690" href="Ledger.Conway.Specification.Epoch.html#3690" class="Field">LastEpochOf</a>     <a id="3706" class="Symbol">:</a> <a id="3708" href="Ledger.Conway.Specification.Epoch.html#3657" class="Bound">A</a> <a id="3710" class="Symbol">→</a> <a id="3712" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
<a id="3718" class="Keyword">open</a> <a id="3723" href="Ledger.Conway.Specification.Epoch.html#3635" class="Module">HasLastEpoch</a>     <a id="3740" class="Symbol">⦃...⦄</a> <a id="3746" class="Keyword">public</a>

<a id="3754" class="Keyword">instance</a>
  <a id="HasLastEpoch-NewEpochState"></a><a id="3765" href="Ledger.Conway.Specification.Epoch.html#3765" class="Function">HasLastEpoch-NewEpochState</a> <a id="3792" class="Symbol">:</a> <a id="3794" href="Ledger.Conway.Specification.Epoch.html#3635" class="Record">HasLastEpoch</a> <a id="3807" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="3823" href="Ledger.Conway.Specification.Epoch.html#3765" class="Function">HasLastEpoch-NewEpochState</a> <a id="3850" class="Symbol">.</a><a id="3851" href="Ledger.Conway.Specification.Epoch.html#3690" class="Field">LastEpochOf</a> <a id="3863" class="Symbol">=</a> <a id="3865" href="Ledger.Conway.Specification.Epoch.html#3310" class="Field">NewEpochState.lastEpoch</a>

  <a id="HasEpochState-NewEpochState"></a><a id="3892" href="Ledger.Conway.Specification.Epoch.html#3892" class="Function">HasEpochState-NewEpochState</a> <a id="3920" class="Symbol">:</a> <a id="3922" href="Ledger.Conway.Specification.Epoch.html#1947" class="Record">HasEpochState</a> <a id="3936" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="3952" href="Ledger.Conway.Specification.Epoch.html#3892" class="Function">HasEpochState-NewEpochState</a> <a id="3980" class="Symbol">.</a><a id="3981" href="Ledger.Conway.Specification.Epoch.html#2001" class="Field">EpochStateOf</a> <a id="3994" class="Symbol">=</a> <a id="3996" href="Ledger.Conway.Specification.Epoch.html#3392" class="Field">NewEpochState.epochState</a>

  <a id="HasEnactState-NewEpochState"></a><a id="4024" href="Ledger.Conway.Specification.Epoch.html#4024" class="Function">HasEnactState-NewEpochState</a> <a id="4052" class="Symbol">:</a> <a id="4054" href="Ledger.Conway.Specification.Enact.html#737" class="Record">HasEnactState</a> <a id="4068" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="4084" href="Ledger.Conway.Specification.Epoch.html#4024" class="Function">HasEnactState-NewEpochState</a> <a id="4112" class="Symbol">.</a><a id="4113" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="4126" class="Symbol">=</a> <a id="4128" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="4141" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4143" href="Ledger.Conway.Specification.Epoch.html#2001" class="Field">EpochStateOf</a>

  <a id="Hastreasury-NewEpochState"></a><a id="4159" href="Ledger.Conway.Specification.Epoch.html#4159" class="Function">Hastreasury-NewEpochState</a> <a id="4185" class="Symbol">:</a> <a id="4187" href="Ledger.Prelude.Base.html#837" class="Record">HasTreasury</a> <a id="4199" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="4215" href="Ledger.Conway.Specification.Epoch.html#4159" class="Function">Hastreasury-NewEpochState</a> <a id="4241" class="Symbol">.</a><a id="4242" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="4253" class="Symbol">=</a> <a id="4255" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="4266" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4268" href="Ledger.Conway.Specification.Epoch.html#2001" class="Field">EpochStateOf</a>

  <a id="HasLState-NewEpochState"></a><a id="4284" href="Ledger.Conway.Specification.Epoch.html#4284" class="Function">HasLState-NewEpochState</a> <a id="4308" class="Symbol">:</a> <a id="4310" href="Ledger.Conway.Specification.Ledger.html#1123" class="Record">HasLState</a> <a id="4320" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="4336" href="Ledger.Conway.Specification.Epoch.html#4284" class="Function">HasLState-NewEpochState</a> <a id="4360" class="Symbol">.</a><a id="4361" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a> <a id="4370" class="Symbol">=</a> <a id="4372" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a> <a id="4381" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4383" href="Ledger.Conway.Specification.Epoch.html#2001" class="Field">EpochStateOf</a>

  <a id="HasGovState-NewEpochState"></a><a id="4399" href="Ledger.Conway.Specification.Epoch.html#4399" class="Function">HasGovState-NewEpochState</a> <a id="4425" class="Symbol">:</a> <a id="4427" href="Ledger.Conway.Specification.Gov.html#1551" class="Record">HasGovState</a> <a id="4439" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="4455" href="Ledger.Conway.Specification.Epoch.html#4399" class="Function">HasGovState-NewEpochState</a> <a id="4481" class="Symbol">.</a><a id="4482" href="Ledger.Conway.Specification.Gov.html#1603" class="Field">GovStateOf</a> <a id="4493" class="Symbol">=</a> <a id="4495" href="Ledger.Conway.Specification.Gov.html#1603" class="Field">GovStateOf</a> <a id="4506" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4508" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a>

  <a id="HasCertState-NewEpochState"></a><a id="4520" href="Ledger.Conway.Specification.Epoch.html#4520" class="Function">HasCertState-NewEpochState</a> <a id="4547" class="Symbol">:</a> <a id="4549" href="Ledger.Conway.Specification.Certs.html#4868" class="Record">HasCertState</a> <a id="4562" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="4578" href="Ledger.Conway.Specification.Epoch.html#4520" class="Function">HasCertState-NewEpochState</a> <a id="4605" class="Symbol">.</a><a id="4606" href="Ledger.Conway.Specification.Certs.html#4921" class="Field">CertStateOf</a> <a id="4618" class="Symbol">=</a> <a id="4620" href="Ledger.Conway.Specification.Certs.html#4921" class="Field">CertStateOf</a> <a id="4632" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4634" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a>

  <a id="HasDReps-NewEpochState"></a><a id="4646" href="Ledger.Conway.Specification.Epoch.html#4646" class="Function">HasDReps-NewEpochState</a> <a id="4669" class="Symbol">:</a> <a id="4671" href="Ledger.Conway.Specification.Certs.html#1554" class="Record">HasDReps</a> <a id="4680" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="4696" href="Ledger.Conway.Specification.Epoch.html#4646" class="Function">HasDReps-NewEpochState</a> <a id="4719" class="Symbol">.</a><a id="4720" href="Ledger.Conway.Specification.Certs.html#1603" class="Field">DRepsOf</a> <a id="4728" class="Symbol">=</a> <a id="4730" href="Ledger.Conway.Specification.Certs.html#1603" class="Field">DRepsOf</a> <a id="4738" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4740" href="Ledger.Conway.Specification.Certs.html#4921" class="Field">CertStateOf</a>

  <a id="HasRewards-NewEpochState"></a><a id="4755" href="Ledger.Conway.Specification.Epoch.html#4755" class="Function">HasRewards-NewEpochState</a> <a id="4780" class="Symbol">:</a> <a id="4782" href="Ledger.Conway.Specification.Certs.html#1794" class="Record">HasRewards</a> <a id="4793" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="4809" href="Ledger.Conway.Specification.Epoch.html#4755" class="Function">HasRewards-NewEpochState</a> <a id="4834" class="Symbol">.</a><a id="4835" href="Ledger.Conway.Specification.Certs.html#1845" class="Field">RewardsOf</a> <a id="4845" class="Symbol">=</a> <a id="4847" href="Ledger.Conway.Specification.Certs.html#1845" class="Field">RewardsOf</a> <a id="4857" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4859" href="Ledger.Conway.Specification.Certs.html#4921" class="Field">CertStateOf</a>

  <a id="HasPParams-NewEpochState"></a><a id="4874" href="Ledger.Conway.Specification.Epoch.html#4874" class="Function">HasPParams-NewEpochState</a> <a id="4899" class="Symbol">:</a> <a id="4901" href="Ledger.Conway.Specification.PParams.html#3489" class="Record">HasPParams</a> <a id="4912" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>
  <a id="4928" href="Ledger.Conway.Specification.Epoch.html#4874" class="Function">HasPParams-NewEpochState</a> <a id="4953" class="Symbol">.</a><a id="4954" href="Ledger.Conway.Specification.PParams.html#3540" class="Field">PParamsOf</a> <a id="4964" class="Symbol">=</a> <a id="4966" href="Ledger.Conway.Specification.PParams.html#3540" class="Field">PParamsOf</a> <a id="4976" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4978" href="Ledger.Conway.Specification.Epoch.html#2001" class="Field">EpochStateOf</a>

  <a id="4994" class="Keyword">unquoteDecl</a> <a id="HasCast-EpochState"></a><a id="5006" href="Ledger.Conway.Specification.Epoch.html#5006" class="Function">HasCast-EpochState</a> <a id="HasCast-NewEpochState"></a><a id="5025" href="Ledger.Conway.Specification.Epoch.html#5025" class="Function">HasCast-NewEpochState</a> <a id="5047" class="Symbol">=</a> <a id="5049" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="5068" class="Symbol">(</a> <a id="5070" class="Symbol">(</a><a id="5071" class="Keyword">quote</a> <a id="5077" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>     <a id="5092" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5094" href="Ledger.Conway.Specification.Epoch.html#5006" class="Function">HasCast-EpochState</a><a id="5112" class="Symbol">)</a>
    <a id="5118" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5120" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="5122" class="Symbol">(</a><a id="5123" class="Keyword">quote</a> <a id="5129" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a>  <a id="5144" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5146" href="Ledger.Conway.Specification.Epoch.html#5025" class="Function">HasCast-NewEpochState</a><a id="5167" class="Symbol">)</a><a id="5168" href="Data.List.Base.html#4907" class="Function Operator">]</a><a id="5169" class="Symbol">)</a>

<a id="toRwdAddr"></a><a id="5172" href="Ledger.Conway.Specification.Epoch.html#5172" class="Function">toRwdAddr</a> <a id="5182" class="Symbol">:</a> <a id="5184" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="5195" class="Symbol">→</a> <a id="5197" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
<a id="5205" href="Ledger.Conway.Specification.Epoch.html#5172" class="Function">toRwdAddr</a> <a id="5215" href="Ledger.Conway.Specification.Epoch.html#5215" class="Bound">x</a> <a id="5217" class="Symbol">=</a> <a id="5219" class="Keyword">record</a> <a id="5226" class="Symbol">{</a> <a id="5228" href="Ledger.Core.Specification.Address.html#1353" class="Field">net</a> <a id="5232" class="Symbol">=</a> <a id="5234" href="Ledger.Core.Specification.Epoch.html#2547" class="Function">NetworkId</a> <a id="5244" class="Symbol">;</a> <a id="5246" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="5252" class="Symbol">=</a> <a id="5254" href="Ledger.Conway.Specification.Epoch.html#5215" class="Bound">x</a> <a id="5256" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="5259" href="Ledger.Conway.Specification.Epoch.html#5259" class="Function">getStakeCred</a> <a id="5272" class="Symbol">:</a> <a id="5274" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="5280" class="Symbol">→</a> <a id="5282" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5288" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a>
<a id="5299" href="Ledger.Conway.Specification.Epoch.html#5259" class="Function">getStakeCred</a> <a id="5312" class="Symbol">(</a><a id="5313" href="Ledger.Conway.Specification.Epoch.html#5313" class="Bound">a</a> <a id="5315" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5317" class="Symbol">_</a> <a id="5319" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5321" class="Symbol">_</a> <a id="5323" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5325" class="Symbol">_)</a> <a id="5328" class="Symbol">=</a> <a id="5330" href="Ledger.Core.Specification.Address.html#2673" class="Function">stakeCred</a> <a id="5340" href="Ledger.Conway.Specification.Epoch.html#5313" class="Bound">a</a>

<a id="5343" class="Keyword">open</a> <a id="5348" href="Ledger.Conway.Specification.Gov.Actions.html#3799" class="Module">GovActionState</a> <a id="5363" class="Keyword">using</a> <a id="5369" class="Symbol">(</a><a id="5370" href="Ledger.Conway.Specification.Gov.Actions.html#3866" class="Field">returnAddr</a><a id="5380" class="Symbol">)</a>

<a id="5383" class="Keyword">opaque</a>


  <a id="createRUpd"></a><a id="5394" href="Ledger.Conway.Specification.Epoch.html#5394" class="Function">createRUpd</a> <a id="5405" class="Symbol">:</a> <a id="5407" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5409" class="Symbol">→</a> <a id="5411" href="Ledger.Conway.Specification.Rewards.html#4867" class="Function">BlocksMade</a> <a id="5422" class="Symbol">→</a> <a id="5424" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a> <a id="5435" class="Symbol">→</a> <a id="5437" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a> <a id="5442" class="Symbol">→</a> <a id="5444" href="Ledger.Conway.Specification.Rewards.html#6210" class="Record">RewardUpdate</a>
  <a id="5459" href="Ledger.Conway.Specification.Epoch.html#5394" class="Function">createRUpd</a> <a id="5470" href="Ledger.Conway.Specification.Epoch.html#5470" class="Bound">slotsPerEpoch</a> <a id="5484" href="Ledger.Conway.Specification.Epoch.html#5484" class="Bound">b</a> <a id="5486" href="Ledger.Conway.Specification.Epoch.html#5486" class="Bound">es</a> <a id="5489" href="Ledger.Conway.Specification.Epoch.html#5489" class="Bound">total</a> <a id="5495" class="Symbol">=</a>
    <a id="5501" class="Keyword">record</a>  <a id="5509" class="Symbol">{</a> <a id="5511" href="Ledger.Conway.Specification.Rewards.html#6247" class="Field">Δt</a> <a id="5514" class="Symbol">=</a> <a id="5516" href="Ledger.Conway.Specification.Epoch.html#6472" class="Function">Δt₁</a>
            <a id="5532" class="Symbol">;</a> <a id="5534" href="Ledger.Conway.Specification.Rewards.html#6250" class="Field">Δr</a> <a id="5537" class="Symbol">=</a> <a id="5539" class="Number">0</a> <a id="5541" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="5543" href="Ledger.Conway.Specification.Epoch.html#6458" class="Function">Δr₁</a> <a id="5547" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5549" href="Ledger.Conway.Specification.Epoch.html#6794" class="Function">Δr₂</a>
            <a id="5565" class="Symbol">;</a> <a id="5567" href="Ledger.Conway.Specification.Rewards.html#6253" class="Field">Δf</a> <a id="5570" class="Symbol">=</a> <a id="5572" class="Number">0</a> <a id="5574" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="5576" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="5580" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a>
            <a id="5598" class="Symbol">;</a> <a id="5600" href="Ledger.Conway.Specification.Rewards.html#6273" class="Field">rs</a> <a id="5603" class="Symbol">=</a> <a id="5605" href="Ledger.Conway.Specification.Epoch.html#6699" class="Function">rs</a>


            <a id="5622" class="Symbol">;</a> <a id="5624" href="Ledger.Conway.Specification.Rewards.html#6303" class="Field">flowConservation</a> <a id="5641" class="Symbol">=</a> <a id="5643" href="Ledger.Conway.Specification.Epoch.html#7096" class="Function">flowConservation</a>
            <a id="5672" class="Symbol">;</a> <a id="5674" href="Ledger.Conway.Specification.Rewards.html#6366" class="Field">Δt-nonnegative</a> <a id="5689" class="Symbol">=</a> <a id="5691" href="Ledger.Conway.Specification.Epoch.html#8234" class="Function">Δt-nonneg</a>
            <a id="5713" class="Symbol">;</a> <a id="5715" href="Ledger.Conway.Specification.Rewards.html#6397" class="Field">Δf-nonpositive</a> <a id="5730" class="Symbol">=</a> <a id="5732" href="Ledger.Conway.Specification.Epoch.html#8416" class="Function">Δf-nonpos</a>


            <a id="5756" class="Symbol">}</a>
    <a id="5762" class="Keyword">where</a>
      <a id="5774" href="Ledger.Conway.Specification.Epoch.html#5774" class="Function">prevPp</a> <a id="5781" class="Symbol">:</a> <a id="5783" href="Ledger.Conway.Specification.PParams.html#1685" class="Record">PParams</a>
      <a id="5797" href="Ledger.Conway.Specification.Epoch.html#5774" class="Function">prevPp</a> <a id="5804" class="Symbol">=</a> <a id="5806" href="Ledger.Conway.Specification.PParams.html#3540" class="Field">PParamsOf</a> <a id="5816" href="Ledger.Conway.Specification.Epoch.html#5486" class="Bound">es</a>

      <a id="5826" href="Ledger.Conway.Specification.Epoch.html#5826" class="Function">reserves</a> <a id="5835" class="Symbol">:</a> <a id="5837" href="Ledger.Prelude.Base.html#191" class="Function">Reserves</a>
      <a id="5852" href="Ledger.Conway.Specification.Epoch.html#5826" class="Function">reserves</a> <a id="5861" class="Symbol">=</a> <a id="5863" href="Ledger.Prelude.Base.html#773" class="Field">ReservesOf</a> <a id="5874" href="Ledger.Conway.Specification.Epoch.html#5486" class="Bound">es</a>

      <a id="5884" href="Ledger.Conway.Specification.Epoch.html#5884" class="Function">pstakego</a> <a id="5893" class="Symbol">:</a> <a id="5895" href="Ledger.Conway.Specification.Rewards.html#6433" class="Record">Snapshot</a>
      <a id="5910" href="Ledger.Conway.Specification.Epoch.html#5884" class="Function">pstakego</a> <a id="5919" class="Symbol">=</a> <a id="5921" class="Symbol">(</a><a id="5922" href="Ledger.Conway.Specification.Rewards.html#7889" class="Field">SnapshotsOf</a> <a id="5934" href="Ledger.Conway.Specification.Epoch.html#5486" class="Bound">es</a><a id="5936" class="Symbol">)</a> <a id="5938" class="Symbol">.</a><a id="5939" href="Ledger.Conway.Specification.Rewards.html#7788" class="Field">Snapshots.go</a>

      <a id="5959" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a> <a id="5965" class="Symbol">:</a> <a id="5967" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
      <a id="5978" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a> <a id="5984" class="Symbol">=</a> <a id="5986" href="Ledger.Prelude.Base.html#669" class="Field">FeesOf</a> <a id="5993" class="Symbol">(</a><a id="5994" href="Ledger.Conway.Specification.Rewards.html#7889" class="Field">SnapshotsOf</a> <a id="6006" href="Ledger.Conway.Specification.Epoch.html#5486" class="Bound">es</a><a id="6008" class="Symbol">)</a>

      <a id="6017" href="Ledger.Conway.Specification.Epoch.html#6017" class="Function">stake</a> <a id="6023" class="Symbol">:</a> <a id="6025" href="Ledger.Conway.Specification.Certs.html#1362" class="Function">Stake</a>
      <a id="6037" href="Ledger.Conway.Specification.Epoch.html#6017" class="Function">stake</a> <a id="6043" class="Symbol">=</a> <a id="6045" href="Ledger.Conway.Specification.Certs.html#1926" class="Field">StakeOf</a> <a id="6053" href="Ledger.Conway.Specification.Epoch.html#5884" class="Function">pstakego</a>

      <a id="6069" href="Ledger.Conway.Specification.Epoch.html#6069" class="Function">delegs</a> <a id="6076" class="Symbol">:</a> <a id="6078" href="Ledger.Conway.Specification.Certs.html#1402" class="Function">StakeDelegs</a>
      <a id="6096" href="Ledger.Conway.Specification.Epoch.html#6069" class="Function">delegs</a> <a id="6103" class="Symbol">=</a> <a id="6105" href="Ledger.Conway.Specification.Certs.html#2010" class="Field">StakeDelegsOf</a> <a id="6119" href="Ledger.Conway.Specification.Epoch.html#5884" class="Function">pstakego</a>

      <a id="6135" href="Ledger.Conway.Specification.Epoch.html#6135" class="Function">poolParams</a> <a id="6146" class="Symbol">:</a> <a id="6148" href="Ledger.Conway.Specification.Certs.html#1226" class="Function">Pools</a>
      <a id="6160" href="Ledger.Conway.Specification.Epoch.html#6135" class="Function">poolParams</a> <a id="6171" class="Symbol">=</a> <a id="6173" href="Ledger.Conway.Specification.Certs.html#1680" class="Field">PoolsOf</a> <a id="6181" href="Ledger.Conway.Specification.Epoch.html#5884" class="Function">pstakego</a>

      <a id="6197" href="Ledger.Conway.Specification.Epoch.html#6197" class="Function">blocksMade</a> <a id="6208" class="Symbol">:</a> <a id="6210" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
      <a id="6218" href="Ledger.Conway.Specification.Epoch.html#6197" class="Function">blocksMade</a> <a id="6229" class="Symbol">=</a> <a id="6231" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">∑[</a> <a id="6234" href="Ledger.Conway.Specification.Epoch.html#6234" class="Bound">m</a> <a id="6236" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">←</a> <a id="6238" href="Ledger.Conway.Specification.Epoch.html#5484" class="Bound">b</a> <a id="6240" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">]</a> <a id="6242" href="Ledger.Conway.Specification.Epoch.html#6234" class="Bound">m</a>

      <a id="6251" href="Ledger.Conway.Specification.Epoch.html#6251" class="Function">ρ</a> <a id="6253" href="Ledger.Conway.Specification.Epoch.html#6253" class="Function">η</a> <a id="6255" href="Ledger.Conway.Specification.Epoch.html#6255" class="Function">τ</a> <a id="6257" class="Symbol">:</a> <a id="6259" href="Data.Rational.Base.html#1421" class="Record">ℚ</a>
      <a id="6267" href="Ledger.Conway.Specification.Epoch.html#6251" class="Function">ρ</a> <a id="6269" class="Symbol">=</a> <a id="6271" href="Ledger.Prelude.Numeric.UnitInterval.html#1988" class="Function">fromUnitInterval</a> <a id="6288" class="Symbol">(</a><a id="6289" href="Ledger.Conway.Specification.Epoch.html#5774" class="Function">prevPp</a> <a id="6296" class="Symbol">.</a><a id="6297" href="Ledger.Conway.Specification.PParams.html#2281" class="Field">PParams.monetaryExpansion</a><a id="6322" class="Symbol">)</a>
      <a id="6330" href="Ledger.Conway.Specification.Epoch.html#6253" class="Function">η</a> <a id="6332" class="Symbol">=</a> <a id="6334" href="Ledger.Conway.Specification.Epoch.html#1134" class="Function">fromℕ</a> <a id="6340" href="Ledger.Conway.Specification.Epoch.html#6197" class="Function">blocksMade</a> <a id="6351" href="Ledger.Prelude.html#2015" class="Function Operator">÷₀</a> <a id="6354" class="Symbol">(</a><a id="6355" href="Ledger.Conway.Specification.Epoch.html#1134" class="Function">fromℕ</a> <a id="6361" href="Ledger.Conway.Specification.Epoch.html#5470" class="Bound">slotsPerEpoch</a> <a id="6375" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6377" href="Ledger.Core.Specification.Epoch.html#2329" class="Function">ActiveSlotCoeff</a><a id="6392" class="Symbol">)</a>
      <a id="6400" href="Ledger.Conway.Specification.Epoch.html#6255" class="Function">τ</a> <a id="6402" class="Symbol">=</a> <a id="6404" href="Ledger.Prelude.Numeric.UnitInterval.html#1988" class="Function">fromUnitInterval</a> <a id="6421" class="Symbol">(</a><a id="6422" href="Ledger.Conway.Specification.Epoch.html#5774" class="Function">prevPp</a> <a id="6429" class="Symbol">.</a><a id="6430" href="Ledger.Conway.Specification.PParams.html#2351" class="Field">PParams.treasuryCut</a><a id="6449" class="Symbol">)</a>

      <a id="6458" href="Ledger.Conway.Specification.Epoch.html#6458" class="Function">Δr₁</a> <a id="6462" href="Ledger.Conway.Specification.Epoch.html#6462" class="Function">rewardPot</a> <a id="6472" href="Ledger.Conway.Specification.Epoch.html#6472" class="Function">Δt₁</a> <a id="6476" href="Ledger.Conway.Specification.Epoch.html#6476" class="Function">R</a> <a id="6478" class="Symbol">:</a> <a id="6480" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
      <a id="6488" href="Ledger.Conway.Specification.Epoch.html#6458" class="Function">Δr₁</a> <a id="6492" class="Symbol">=</a> <a id="6494" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="6500" class="Symbol">(</a><a id="6501" class="Number">1</a> <a id="6503" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="6505" href="Ledger.Conway.Specification.Epoch.html#6253" class="Function">η</a> <a id="6507" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6509" href="Ledger.Conway.Specification.Epoch.html#6251" class="Function">ρ</a> <a id="6511" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6513" href="Ledger.Conway.Specification.Epoch.html#1134" class="Function">fromℕ</a> <a id="6519" href="Ledger.Conway.Specification.Epoch.html#5826" class="Function">reserves</a><a id="6527" class="Symbol">)</a>
      <a id="6535" href="Ledger.Conway.Specification.Epoch.html#6462" class="Function">rewardPot</a> <a id="6545" class="Symbol">=</a> <a id="6547" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="6551" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a> <a id="6557" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6559" href="Ledger.Conway.Specification.Epoch.html#6458" class="Function">Δr₁</a>
      <a id="6569" href="Ledger.Conway.Specification.Epoch.html#6472" class="Function">Δt₁</a> <a id="6573" class="Symbol">=</a> <a id="6575" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="6581" class="Symbol">(</a><a id="6582" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="6588" href="Ledger.Conway.Specification.Epoch.html#6462" class="Function">rewardPot</a> <a id="6598" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6600" href="Ledger.Conway.Specification.Epoch.html#6255" class="Function">τ</a><a id="6601" class="Symbol">)</a>
      <a id="6609" href="Ledger.Conway.Specification.Epoch.html#6476" class="Function">R</a> <a id="6611" class="Symbol">=</a> <a id="6613" href="Ledger.Conway.Specification.Epoch.html#6462" class="Function">rewardPot</a> <a id="6623" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="6625" href="Ledger.Conway.Specification.Epoch.html#6472" class="Function">Δt₁</a>

      <a id="6636" href="Ledger.Conway.Specification.Epoch.html#6636" class="Function">circulation</a> <a id="6648" class="Symbol">:</a> <a id="6650" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="6661" href="Ledger.Conway.Specification.Epoch.html#6636" class="Function">circulation</a> <a id="6673" class="Symbol">=</a> <a id="6675" href="Ledger.Conway.Specification.Epoch.html#5489" class="Bound">total</a> <a id="6681" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="6683" href="Ledger.Conway.Specification.Epoch.html#5826" class="Function">reserves</a>

      <a id="6699" href="Ledger.Conway.Specification.Epoch.html#6699" class="Function">rs</a> <a id="6702" class="Symbol">:</a> <a id="6704" href="Ledger.Conway.Specification.Certs.html#1318" class="Function">Rewards</a>
      <a id="6718" href="Ledger.Conway.Specification.Epoch.html#6699" class="Function">rs</a> <a id="6721" class="Symbol">=</a> <a id="6723" href="Ledger.Conway.Specification.Rewards.html#5358" class="Function">reward</a> <a id="6730" href="Ledger.Conway.Specification.Epoch.html#5774" class="Function">prevPp</a> <a id="6737" href="Ledger.Conway.Specification.Epoch.html#5484" class="Bound">b</a> <a id="6739" class="Symbol">(</a><a id="6740" href="Prelude.html#3279" class="Function">posPart</a> <a id="6748" href="Ledger.Conway.Specification.Epoch.html#6476" class="Function">R</a><a id="6749" class="Symbol">)</a> <a id="6751" href="Ledger.Conway.Specification.Epoch.html#6135" class="Function">poolParams</a> <a id="6762" href="Ledger.Conway.Specification.Epoch.html#6017" class="Function">stake</a> <a id="6768" href="Ledger.Conway.Specification.Epoch.html#6069" class="Function">delegs</a> <a id="6775" href="Ledger.Conway.Specification.Epoch.html#6636" class="Function">circulation</a>

      <a id="6794" href="Ledger.Conway.Specification.Epoch.html#6794" class="Function">Δr₂</a> <a id="6798" class="Symbol">:</a> <a id="6800" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
      <a id="6808" href="Ledger.Conway.Specification.Epoch.html#6794" class="Function">Δr₂</a> <a id="6812" class="Symbol">=</a> <a id="6814" href="Ledger.Conway.Specification.Epoch.html#6476" class="Function">R</a> <a id="6816" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="6818" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="6822" class="Symbol">(</a><a id="6823" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">∑[</a> <a id="6826" href="Ledger.Conway.Specification.Epoch.html#6826" class="Bound">c</a> <a id="6828" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">←</a> <a id="6830" href="Ledger.Conway.Specification.Epoch.html#6699" class="Function">rs</a> <a id="6833" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">]</a> <a id="6835" href="Ledger.Conway.Specification.Epoch.html#6826" class="Bound">c</a><a id="6836" class="Symbol">)</a>


      <a id="6846" class="Comment">-- Proofs</a>
      <a id="6862" class="Comment">-- Note: Overloading of + and - seems to interfere with</a>
      <a id="6924" class="Comment">-- the ring solver.</a>
      <a id="6950" href="Ledger.Conway.Specification.Epoch.html#6950" class="Function">lemmaFlow</a> <a id="6960" class="Symbol">:</a> <a id="6962" class="Symbol">∀</a> <a id="6964" class="Symbol">(</a><a id="6965" href="Ledger.Conway.Specification.Epoch.html#6965" class="Bound">t₁</a> <a id="6968" href="Ledger.Conway.Specification.Epoch.html#6968" class="Bound">r₁</a> <a id="6971" href="Ledger.Conway.Specification.Epoch.html#6971" class="Bound">f</a> <a id="6973" href="Ledger.Conway.Specification.Epoch.html#6973" class="Bound">z</a> <a id="6975" class="Symbol">:</a> <a id="6977" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="6978" class="Symbol">)</a>
        <a id="6988" class="Symbol">→</a> <a id="6990" class="Symbol">(</a><a id="6991" href="Ledger.Conway.Specification.Epoch.html#6965" class="Bound">t₁</a> <a id="6994" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="6998" class="Symbol">(</a><a id="6999" class="Number">0</a> <a id="7001" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7005" href="Ledger.Conway.Specification.Epoch.html#6968" class="Bound">r₁</a> <a id="7008" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7012" class="Symbol">((</a><a id="7014" href="Ledger.Conway.Specification.Epoch.html#6971" class="Bound">f</a> <a id="7016" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7020" href="Ledger.Conway.Specification.Epoch.html#6968" class="Bound">r₁</a> <a id="7023" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7027" href="Ledger.Conway.Specification.Epoch.html#6965" class="Bound">t₁</a><a id="7029" class="Symbol">)</a> <a id="7031" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7035" href="Ledger.Conway.Specification.Epoch.html#6973" class="Bound">z</a><a id="7036" class="Symbol">))</a> <a id="7039" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7043" class="Symbol">(</a><a id="7044" class="Number">0</a> <a id="7046" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7050" href="Ledger.Conway.Specification.Epoch.html#6971" class="Bound">f</a><a id="7051" class="Symbol">)</a> <a id="7053" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7057" href="Ledger.Conway.Specification.Epoch.html#6973" class="Bound">z</a><a id="7058" class="Symbol">)</a> <a id="7060" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7062" class="Number">0</a>
      <a id="7070" href="Ledger.Conway.Specification.Epoch.html#6950" class="Function">lemmaFlow</a> <a id="7080" class="Symbol">=</a> <a id="7082" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a>
      <a id="7096" href="Ledger.Conway.Specification.Epoch.html#7096" class="Function">flowConservation</a> <a id="7113" class="Symbol">:</a>
        <a id="7123" class="Keyword">let</a> <a id="7127" href="Ledger.Conway.Specification.Epoch.html#7127" class="Bound">t₁</a> <a id="7130" class="Symbol">=</a> <a id="7132" href="Ledger.Conway.Specification.Epoch.html#6472" class="Function">Δt₁</a>
            <a id="7148" href="Ledger.Conway.Specification.Epoch.html#7148" class="Bound">r₁</a> <a id="7151" class="Symbol">=</a> <a id="7153" href="Ledger.Conway.Specification.Epoch.html#6458" class="Function">Δr₁</a>
            <a id="7169" href="Ledger.Conway.Specification.Epoch.html#7169" class="Bound">f</a>  <a id="7172" class="Symbol">=</a> <a id="7174" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="7178" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a>
            <a id="7196" href="Ledger.Conway.Specification.Epoch.html#7196" class="Bound">z</a>  <a id="7199" class="Symbol">=</a> <a id="7201" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="7205" class="Symbol">(</a><a id="7206" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">∑[</a> <a id="7209" href="Ledger.Conway.Specification.Epoch.html#7209" class="Bound">c</a> <a id="7211" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">←</a> <a id="7213" href="Ledger.Conway.Specification.Epoch.html#6699" class="Function">rs</a> <a id="7216" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">]</a> <a id="7218" href="Ledger.Conway.Specification.Epoch.html#7209" class="Bound">c</a><a id="7219" class="Symbol">)</a>
         <a id="7230" class="Keyword">in</a>
            <a id="7245" class="Symbol">(</a><a id="7246" href="Ledger.Conway.Specification.Epoch.html#7127" class="Bound">t₁</a> <a id="7249" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7253" class="Symbol">(</a><a id="7254" class="Number">0</a> <a id="7256" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7260" href="Ledger.Conway.Specification.Epoch.html#7148" class="Bound">r₁</a> <a id="7263" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7267" class="Symbol">((</a><a id="7269" href="Ledger.Conway.Specification.Epoch.html#7169" class="Bound">f</a> <a id="7271" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7275" href="Ledger.Conway.Specification.Epoch.html#7148" class="Bound">r₁</a> <a id="7278" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7282" href="Ledger.Conway.Specification.Epoch.html#7127" class="Bound">t₁</a><a id="7284" class="Symbol">)</a> <a id="7286" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7290" href="Ledger.Conway.Specification.Epoch.html#7196" class="Bound">z</a><a id="7291" class="Symbol">))</a> <a id="7294" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7298" class="Symbol">(</a><a id="7299" class="Number">0</a> <a id="7301" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7305" href="Ledger.Conway.Specification.Epoch.html#7169" class="Bound">f</a><a id="7306" class="Symbol">)</a> <a id="7308" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7312" href="Ledger.Conway.Specification.Epoch.html#7196" class="Bound">z</a><a id="7313" class="Symbol">)</a> <a id="7315" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7317" class="Number">0</a>
      <a id="7325" href="Ledger.Conway.Specification.Epoch.html#7096" class="Function">flowConservation</a> <a id="7342" class="Symbol">=</a> <a id="7344" href="Ledger.Conway.Specification.Epoch.html#6950" class="Function">lemmaFlow</a> <a id="7354" href="Ledger.Conway.Specification.Epoch.html#6472" class="Function">Δt₁</a> <a id="7358" href="Ledger.Conway.Specification.Epoch.html#6458" class="Function">Δr₁</a> <a id="7362" class="Symbol">(</a><a id="7363" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="7367" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a><a id="7372" class="Symbol">)</a> <a id="7374" class="Symbol">(</a><a id="7375" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="7379" class="Symbol">(</a><a id="7380" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">∑[</a> <a id="7383" href="Ledger.Conway.Specification.Epoch.html#7383" class="Bound">c</a> <a id="7385" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">←</a> <a id="7387" href="Ledger.Conway.Specification.Epoch.html#6699" class="Function">rs</a> <a id="7390" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">]</a> <a id="7392" href="Ledger.Conway.Specification.Epoch.html#7383" class="Bound">c</a><a id="7393" class="Symbol">))</a>

      <a id="7403" href="Ledger.Conway.Specification.Epoch.html#7403" class="Function">÷₀-0≤⇒0≤</a> <a id="7412" class="Symbol">:</a> <a id="7414" class="Symbol">∀</a> <a id="7416" class="Symbol">(</a><a id="7417" href="Ledger.Conway.Specification.Epoch.html#7417" class="Bound">x</a> <a id="7419" href="Ledger.Conway.Specification.Epoch.html#7419" class="Bound">y</a> <a id="7421" class="Symbol">:</a> <a id="7423" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="7424" class="Symbol">)</a> <a id="7426" class="Symbol">→</a> <a id="7428" class="Number">0</a> <a id="7430" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7432" href="Ledger.Conway.Specification.Epoch.html#7417" class="Bound">x</a> <a id="7434" class="Symbol">→</a> <a id="7436" class="Number">0</a> <a id="7438" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7440" href="Ledger.Conway.Specification.Epoch.html#7419" class="Bound">y</a> <a id="7442" class="Symbol">→</a> <a id="7444" class="Number">0</a> <a id="7446" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7448" class="Symbol">(</a><a id="7449" href="Ledger.Conway.Specification.Epoch.html#7417" class="Bound">x</a> <a id="7451" href="Ledger.Prelude.html#2015" class="Function Operator">÷₀</a> <a id="7454" href="Ledger.Conway.Specification.Epoch.html#7419" class="Bound">y</a><a id="7455" class="Symbol">)</a>
      <a id="7463" href="Ledger.Conway.Specification.Epoch.html#7403" class="Function">÷₀-0≤⇒0≤</a> <a id="7472" href="Ledger.Conway.Specification.Epoch.html#7472" class="Bound">x</a> <a id="7474" href="Ledger.Conway.Specification.Epoch.html#7474" class="Bound">y</a> <a id="7476" href="Ledger.Conway.Specification.Epoch.html#7476" class="Bound">0≤x</a> <a id="7480" href="Ledger.Conway.Specification.Epoch.html#7480" class="Bound">0≤y</a> <a id="7484" class="Keyword">with</a> <a id="7489" href="Ledger.Conway.Specification.Epoch.html#7474" class="Bound">y</a> <a id="7491" href="Data.Rational.Properties.html#4152" class="Function Operator">≟</a> <a id="7493" class="Number">0</a>
      <a id="7501" class="Symbol">...</a> <a id="7505" class="Symbol">|</a> <a id="7507" class="Symbol">(</a><a id="7508" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="7512" href="Ledger.Conway.Specification.Epoch.html#7512" class="Bound">y≡0</a><a id="7515" class="Symbol">)</a> <a id="7517" class="Symbol">=</a> <a id="7519" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="7533" class="Number">0</a>
      <a id="7541" class="Symbol">...</a> <a id="7545" class="Symbol">|</a> <a id="7547" class="Symbol">(</a><a id="7548" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="7551" href="Ledger.Conway.Specification.Epoch.html#7551" class="Bound">y≢0</a><a id="7554" class="Symbol">)</a>  <a id="7557" class="Symbol">=</a> <a id="7559" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a> <a id="7567" class="Bound">x</a> <a id="7569" class="Bound">y</a> <a id="7571" class="Symbol">{{</a><a id="7573" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a> <a id="7583" href="Ledger.Conway.Specification.Epoch.html#7551" class="Bound">y≢0</a><a id="7586" class="Symbol">}}</a> <a id="7589" class="Bound">0≤x</a> <a id="7593" class="Bound">0≤y</a>

      <a id="7604" href="Ledger.Conway.Specification.Epoch.html#7604" class="Function">η-nonneg</a> <a id="7613" class="Symbol">:</a> <a id="7615" class="Number">0</a> <a id="7617" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7619" href="Ledger.Conway.Specification.Epoch.html#6253" class="Function">η</a>
      <a id="7627" href="Ledger.Conway.Specification.Epoch.html#7604" class="Function">η-nonneg</a> <a id="7636" class="Symbol">=</a> <a id="7638" href="Ledger.Conway.Specification.Epoch.html#7403" class="Function">÷₀-0≤⇒0≤</a> <a id="7647" class="Symbol">_</a> <a id="7649" class="Symbol">_</a> <a id="7651" class="Symbol">(</a><a id="7652" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="7661" href="Ledger.Conway.Specification.Epoch.html#6197" class="Function">blocksMade</a><a id="7671" class="Symbol">)</a>
        <a id="7681" class="Symbol">(</a><a id="7682" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="7690" class="Symbol">_</a> <a id="7692" class="Symbol">_</a>
          <a id="7704" class="Symbol">(</a><a id="7705" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="7714" href="Ledger.Conway.Specification.Epoch.html#5470" class="Bound">slotsPerEpoch</a><a id="7727" class="Symbol">)</a>
          <a id="7739" class="Symbol">(</a><a id="7740" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="7754" href="Ledger.Core.Specification.Epoch.html#2329" class="Function">ActiveSlotCoeff</a> <a id="7770" class="Symbol">{{</a><a id="7772" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a> <a id="7783" href="Ledger.Core.Specification.Epoch.html#2329" class="Function">ActiveSlotCoeff</a><a id="7798" class="Symbol">}}))</a>

      <a id="7810" href="Ledger.Conway.Specification.Epoch.html#7810" class="Function">min1η-nonneg</a> <a id="7823" class="Symbol">:</a> <a id="7825" class="Number">0</a> <a id="7827" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7829" class="Number">1</a> <a id="7831" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="7833" href="Ledger.Conway.Specification.Epoch.html#6253" class="Function">η</a>
      <a id="7841" href="Ledger.Conway.Specification.Epoch.html#7810" class="Function">min1η-nonneg</a> <a id="7854" class="Symbol">=</a> <a id="7856" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a> <a id="7862" class="Symbol">(</a><a id="7863" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="7877" class="Number">1</a><a id="7878" class="Symbol">)</a> <a id="7880" href="Ledger.Conway.Specification.Epoch.html#7604" class="Function">η-nonneg</a>

      <a id="7896" href="Ledger.Conway.Specification.Epoch.html#7896" class="Function">Δr₁-nonneg</a> <a id="7907" class="Symbol">:</a> <a id="7909" class="Number">0</a> <a id="7911" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7913" href="Ledger.Conway.Specification.Epoch.html#6458" class="Function">Δr₁</a>
      <a id="7923" href="Ledger.Conway.Specification.Epoch.html#7896" class="Function">Δr₁-nonneg</a> <a id="7934" class="Symbol">=</a> <a id="7936" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="7947" class="Symbol">_</a>
        <a id="7957" class="Symbol">(</a><a id="7958" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="7966" class="Symbol">(</a><a id="7967" class="Number">1</a> <a id="7969" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="7971" href="Ledger.Conway.Specification.Epoch.html#6253" class="Function">η</a> <a id="7973" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="7975" href="Ledger.Conway.Specification.Epoch.html#6251" class="Function">ρ</a><a id="7976" class="Symbol">)</a> <a id="7978" class="Symbol">(</a><a id="7979" href="Ledger.Conway.Specification.Epoch.html#1134" class="Function">fromℕ</a> <a id="7985" href="Ledger.Conway.Specification.Epoch.html#5826" class="Function">reserves</a><a id="7993" class="Symbol">)</a>
          <a id="8005" class="Symbol">(</a><a id="8006" href="Ledger.Prelude.Numeric.UnitInterval.html#3336" class="Function">UnitInterval-*-0≤</a> <a id="8024" class="Symbol">(</a><a id="8025" class="Number">1</a> <a id="8027" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8029" href="Ledger.Conway.Specification.Epoch.html#6253" class="Function">η</a><a id="8030" class="Symbol">)</a> <a id="8032" class="Symbol">(</a><a id="8033" href="Ledger.Conway.Specification.Epoch.html#5774" class="Function">prevPp</a> <a id="8040" class="Symbol">.</a><a id="8041" href="Ledger.Conway.Specification.PParams.html#2281" class="Field">PParams.monetaryExpansion</a><a id="8066" class="Symbol">)</a> <a id="8068" href="Ledger.Conway.Specification.Epoch.html#7810" class="Function">min1η-nonneg</a><a id="8080" class="Symbol">)</a>
          <a id="8092" class="Symbol">(</a><a id="8093" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="8102" href="Ledger.Conway.Specification.Epoch.html#5826" class="Function">reserves</a><a id="8110" class="Symbol">))</a>

      <a id="8120" href="Ledger.Conway.Specification.Epoch.html#8120" class="Function">rewardPot-nonneg</a> <a id="8137" class="Symbol">:</a> <a id="8139" class="Number">0</a> <a id="8141" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8143" href="Ledger.Conway.Specification.Epoch.html#6462" class="Function">rewardPot</a>
      <a id="8159" href="Ledger.Conway.Specification.Epoch.html#8120" class="Function">rewardPot-nonneg</a> <a id="8176" class="Symbol">=</a> <a id="8178" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a> <a id="8187" class="Symbol">(</a><a id="8188" href="Ledger.Conway.Specification.Epoch.html#272" class="Function">nonNegative⁻¹ℤ</a> <a id="8203" class="Symbol">(</a><a id="8204" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="8208" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a><a id="8213" class="Symbol">))</a> <a id="8216" href="Ledger.Conway.Specification.Epoch.html#7896" class="Function">Δr₁-nonneg</a>

      <a id="8234" href="Ledger.Conway.Specification.Epoch.html#8234" class="Function">Δt-nonneg</a> <a id="8244" class="Symbol">:</a> <a id="8246" class="Number">0</a> <a id="8248" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8250" href="Ledger.Conway.Specification.Epoch.html#6472" class="Function">Δt₁</a>
      <a id="8260" href="Ledger.Conway.Specification.Epoch.html#8234" class="Function">Δt-nonneg</a> <a id="8270" class="Symbol">=</a> <a id="8272" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="8283" class="Symbol">_</a>
        <a id="8293" class="Symbol">(</a><a id="8294" href="Ledger.Prelude.Numeric.UnitInterval.html#3336" class="Function">UnitInterval-*-0≤</a> <a id="8312" class="Symbol">(</a><a id="8313" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="8319" href="Ledger.Conway.Specification.Epoch.html#6462" class="Function">rewardPot</a><a id="8328" class="Symbol">)</a> <a id="8330" class="Symbol">(</a><a id="8331" href="Ledger.Conway.Specification.Epoch.html#5774" class="Function">prevPp</a> <a id="8338" class="Symbol">.</a><a id="8339" href="Ledger.Conway.Specification.PParams.html#2351" class="Field">PParams.treasuryCut</a><a id="8358" class="Symbol">)</a>
          <a id="8370" class="Symbol">(</a><a id="8371" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a> <a id="8380" href="Ledger.Conway.Specification.Epoch.html#6462" class="Function">rewardPot</a> <a id="8390" href="Ledger.Conway.Specification.Epoch.html#8120" class="Function">rewardPot-nonneg</a><a id="8406" class="Symbol">))</a>

      <a id="8416" href="Ledger.Conway.Specification.Epoch.html#8416" class="Function">Δf-nonpos</a> <a id="8426" class="Symbol">:</a> <a id="8428" class="Symbol">(</a><a id="8429" class="Number">0</a> <a id="8431" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="8433" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="8437" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a><a id="8442" class="Symbol">)</a> <a id="8444" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8446" class="Number">0</a>
      <a id="8454" href="Ledger.Conway.Specification.Epoch.html#8416" class="Function">Δf-nonpos</a> <a id="8464" class="Symbol">=</a> <a id="8466" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
          <a id="8482" class="Number">0</a> <a id="8484" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="8486" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="8490" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a> <a id="8496" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="8499" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a> <a id="8511" class="Symbol">_</a> <a id="8513" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
          <a id="8525" href="Data.Integer.Base.html#4719" class="Function Operator">ℤ.-</a> <a id="8529" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="8533" href="Ledger.Conway.Specification.Epoch.html#5959" class="Function">feeSS</a> <a id="8539" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="8542" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a> <a id="8553" class="Symbol">(</a><a id="8554" href="Data.Integer.Base.html#2106" class="InductiveConstructor">ℤ.+≤+</a> <a id="8560" href="Data.Nat.Base.html#1720" class="InductiveConstructor">z≤n</a><a id="8563" class="Symbol">)</a> <a id="8565" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
          <a id="8577" class="Number">0</a>             <a id="8591" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="8601" class="Keyword">where</a> <a id="8607" class="Keyword">open</a> <a id="8612" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a>


<a id="applyRUpd"></a><a id="8626" href="Ledger.Conway.Specification.Epoch.html#8626" class="Function">applyRUpd</a> <a id="8636" class="Symbol">:</a> <a id="8638" href="Ledger.Conway.Specification.Rewards.html#6210" class="Record">RewardUpdate</a> <a id="8651" class="Symbol">→</a> <a id="8653" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a> <a id="8664" class="Symbol">→</a> <a id="8666" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
<a id="8677" href="Ledger.Conway.Specification.Epoch.html#8626" class="Function">applyRUpd</a> <a id="8687" href="Ledger.Conway.Specification.Epoch.html#8687" class="Bound">rewardUpdate</a> <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#8704}{\htmlId{8704}{\htmlClass{Bound}{\text{treasury}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8715}{\htmlId{8715}{\htmlClass{Bound}{\text{reserves}}}}\, \end{pmatrix}
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#8752}{\htmlId{8752}{\htmlClass{Bound}{\text{ss}}}}\,
                       \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#8784}{\htmlId{8784}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8791}{\htmlId{8791}{\htmlClass{Bound}{\text{fees}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8798}{\htmlId{8798}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8809}{\htmlId{8809}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
                         \\ \,\href{Ledger.Conway.Specification.Epoch.html#8849}{\htmlId{8849}{\htmlClass{Bound}{\text{govSt}}}}\,
                         \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#8886}{\htmlId{8886}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8899}{\htmlId{8899}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8913}{\htmlId{8913}{\htmlClass{Bound}{\text{rewards}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#8926}{\htmlId{8926}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8935}{\htmlId{8935}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#8974}{\htmlId{8974}{\htmlClass{Bound}{\text{es}}}}\,
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9002}{\htmlId{9002}{\htmlClass{Bound}{\text{fut}}}}\,
                       \end{pmatrix}$</a> <a id="9033" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Prelude.html#3279}{\htmlId{9039}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9047}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#76}{\htmlId{9048}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#8704}{\htmlId{9052}{\htmlClass{Bound}{\text{treasury}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9061}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6247}{\htmlId{9063}{\htmlClass{Function}{\text{Δt}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9066}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#76}{\htmlId{9068}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9623}{\htmlId{9072}{\htmlClass{Function}{\text{unregRU&#39;}}}}\,\,\htmlId{9080}{\htmlClass{Symbol}{\text{)}}}\,
                               \\ \,\href{Prelude.html#3279}{\htmlId{9115}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9123}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#76}{\htmlId{9124}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#8715}{\htmlId{9128}{\htmlClass{Bound}{\text{reserves}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9137}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6250}{\htmlId{9139}{\htmlClass{Function}{\text{Δr}}}}\,\,\htmlId{9141}{\htmlClass{Symbol}{\text{)}}}\, \end{pmatrix}
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#8752}{\htmlId{9176}{\htmlClass{Bound}{\text{ss}}}}\,
                             \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#8784}{\htmlId{9214}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Prelude.html#3279}{\htmlId{9221}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9229}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#76}{\htmlId{9230}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#8791}{\htmlId{9234}{\htmlClass{Bound}{\text{fees}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9239}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6253}{\htmlId{9241}{\htmlClass{Function}{\text{Δf}}}}\,\,\htmlId{9243}{\htmlClass{Symbol}{\text{)}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8798}{\htmlId{9247}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8809}{\htmlId{9258}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
                               \\ \,\href{Ledger.Conway.Specification.Epoch.html#8849}{\htmlId{9303}{\htmlClass{Bound}{\text{govSt}}}}\,
                               \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#8886}{\htmlId{9346}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8899}{\htmlId{9359}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8913}{\htmlId{9373}{\htmlClass{Bound}{\text{rewards}}}}\, \,\href{Axiom.Set.Map.Dec.html#2052}{\htmlId{9381}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9555}{\htmlId{9384}{\htmlClass{Function}{\text{regRU}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#8926}{\htmlId{9394}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#8935}{\htmlId{9403}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#8974}{\htmlId{9445}{\htmlClass{Bound}{\text{es}}}}\,
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9002}{\htmlId{9479}{\htmlClass{Bound}{\text{fut}}}}\, \end{pmatrix}$</a>
  <a id="9487" class="Keyword">where</a>
    <a id="9497" class="Keyword">open</a> <a id="9502" href="Ledger.Conway.Specification.Rewards.html#6210" class="Module">RewardUpdate</a> <a id="9515" href="Ledger.Conway.Specification.Epoch.html#8687" class="Bound">rewardUpdate</a> <a id="9528" class="Keyword">using</a> <a id="9534" class="Symbol">(</a><a id="9535" href="Ledger.Conway.Specification.Rewards.html#6247" class="Field">Δt</a><a id="9537" class="Symbol">;</a> <a id="9539" href="Ledger.Conway.Specification.Rewards.html#6250" class="Field">Δr</a><a id="9541" class="Symbol">;</a> <a id="9543" href="Ledger.Conway.Specification.Rewards.html#6253" class="Field">Δf</a><a id="9545" class="Symbol">;</a> <a id="9547" href="Ledger.Conway.Specification.Rewards.html#6273" class="Field">rs</a><a id="9549" class="Symbol">)</a>
    <a id="9555" href="Ledger.Conway.Specification.Epoch.html#9555" class="Function">regRU</a>     <a id="9565" class="Symbol">=</a> <a id="9567" href="Ledger.Conway.Specification.Rewards.html#6273" class="Function">rs</a> <a id="9570" href="Axiom.Set.Map.html#12770" class="Function Operator">∣</a> <a id="9572" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9576" href="Ledger.Conway.Specification.Epoch.html#8913" class="Bound">rewards</a>
    <a id="9588" href="Ledger.Conway.Specification.Epoch.html#9588" class="Function">unregRU</a>   <a id="9598" class="Symbol">=</a> <a id="9600" href="Ledger.Conway.Specification.Rewards.html#6273" class="Function">rs</a> <a id="9603" href="Axiom.Set.Map.html#12840" class="Function Operator">∣</a> <a id="9605" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9609" href="Ledger.Conway.Specification.Epoch.html#8913" class="Bound">rewards</a> <a id="9617" href="Axiom.Set.Map.html#12840" class="Function Operator">ᶜ</a>
    <a id="9623" href="Ledger.Conway.Specification.Epoch.html#9623" class="Function">unregRU&#39;</a>  <a id="9633" class="Symbol">=</a> <a id="9635" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">∑[</a> <a id="9638" href="Ledger.Conway.Specification.Epoch.html#9638" class="Bound">x</a> <a id="9640" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">←</a> <a id="9642" href="Ledger.Conway.Specification.Epoch.html#9588" class="Function">unregRU</a> <a id="9650" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">]</a> <a id="9652" href="Ledger.Conway.Specification.Epoch.html#9638" class="Bound">x</a>


<a id="9656" class="Keyword">open</a> <a id="9661" href="Ledger.Core.Specification.Address.html#1324" class="Module">RwdAddr</a> <a id="9669" class="Keyword">using</a> <a id="9675" class="Symbol">(</a><a id="9676" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a><a id="9681" class="Symbol">)</a>
<a id="9683" class="Keyword">opaque</a>


  <a id="calculatePoolDelegatedStake"></a><a id="9694" href="Ledger.Conway.Specification.Epoch.html#9694" class="Function">calculatePoolDelegatedStake</a>
    <a id="9726" class="Symbol">:</a> <a id="9728" href="Ledger.Conway.Specification.Rewards.html#6433" class="Record">Snapshot</a>
    <a id="9741" class="Symbol">→</a> <a id="9743" href="Ledger.Conway.Specification.Epoch.html#3201" class="Function">PoolDelegatedStake</a>
  <a id="9764" href="Ledger.Conway.Specification.Epoch.html#9694" class="Function">calculatePoolDelegatedStake</a> <a id="9792" href="Ledger.Conway.Specification.Epoch.html#9792" class="Bound">ss</a> <a id="9795" class="Symbol">=</a>
      <a id="9803" class="Comment">-- Shelley spec: the output map must contain keys appearing in both</a>
      <a id="9877" class="Comment">-- sd and the pool parameters.</a>
      <a id="9914" href="Ledger.Conway.Specification.Epoch.html#10150" class="Function">sd</a> <a id="9917" href="Axiom.Set.Map.html#12770" class="Function Operator">∣</a> <a id="9919" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9923" class="Symbol">(</a><a id="9924" href="Ledger.Conway.Specification.Certs.html#1680" class="Field">PoolsOf</a> <a id="9932" href="Ledger.Conway.Specification.Epoch.html#9792" class="Bound">ss</a><a id="9934" class="Symbol">)</a>
    <a id="9940" class="Keyword">where</a>
      <a id="9952" class="Comment">-- stake credentials delegating to each pool</a>
      <a id="10003" href="Ledger.Conway.Specification.Epoch.html#10003" class="Function">stakeCredentialsPerPool</a> <a id="10027" class="Symbol">:</a> <a id="10029" href="Axiom.Set.Rel.html#1312" class="Function">Rel</a> <a id="10033" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="10041" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a>
      <a id="10058" href="Ledger.Conway.Specification.Epoch.html#10003" class="Function">stakeCredentialsPerPool</a> <a id="10082" class="Symbol">=</a> <a id="10084" class="Symbol">(</a><a id="10085" href="Ledger.Conway.Specification.Certs.html#2010" class="Field">StakeDelegsOf</a> <a id="10099" href="Ledger.Conway.Specification.Epoch.html#9792" class="Bound">ss</a> <a id="10102" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10103" class="Symbol">)</a> <a id="10105" href="Axiom.Set.Rel.html#1608" class="Function Operator">⁻¹ʳ</a>

      <a id="10116" class="Comment">-- delegated stake per pool</a>
      <a id="10150" href="Ledger.Conway.Specification.Epoch.html#10150" class="Function">sd</a> <a id="10153" class="Symbol">:</a> <a id="10155" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="10163" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="10165" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="10176" href="Ledger.Conway.Specification.Epoch.html#10150" class="Function">sd</a> <a id="10179" class="Symbol">=</a> <a id="10181" href="Axiom.Set.Map.Dec.html#2130" class="Function">aggregate₊</a> <a id="10192" class="Symbol">((</a><a id="10194" href="Ledger.Conway.Specification.Epoch.html#10003" class="Function">stakeCredentialsPerPool</a> <a id="10218" href="abstract-set-theory.FiniteSetTheory.html#3050" class="Function Operator">∘ʳ</a> <a id="10221" class="Symbol">(</a><a id="10222" href="Ledger.Conway.Specification.Certs.html#1926" class="Field">StakeOf</a> <a id="10230" href="Ledger.Conway.Specification.Epoch.html#9792" class="Bound">ss</a> <a id="10233" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10234" class="Symbol">))</a> <a id="10237" href="abstract-set-theory.FiniteSetTheory.html#2860" class="Function Operator">ᶠˢ</a><a id="10239" class="Symbol">)</a>


  <a id="stakeFromGADeposits"></a><a id="10245" href="Ledger.Conway.Specification.Epoch.html#10245" class="Function">stakeFromGADeposits</a>
    <a id="10269" class="Symbol">:</a> <a id="10271" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
    <a id="10284" class="Symbol">→</a> <a id="10286" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
    <a id="10300" class="Symbol">→</a> <a id="10302" href="Ledger.Conway.Specification.Certs.html#1362" class="Function">Stake</a>
  <a id="10310" href="Ledger.Conway.Specification.Epoch.html#10245" class="Function">stakeFromGADeposits</a> <a id="10330" href="Ledger.Conway.Specification.Epoch.html#10330" class="Bound">govSt</a> <a id="10336" href="Ledger.Conway.Specification.Epoch.html#10336" class="Bound">utxoSt</a> <a id="10343" class="Symbol">=</a> <a id="10345" href="abstract-set-theory.FiniteSetTheory.html#3920" class="Function">aggregateBy</a>
     <a id="10362" class="Symbol">(</a><a id="10363" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10368" class="Symbol">(λ</a> <a id="10371" class="Symbol">(</a><a id="10372" href="Ledger.Conway.Specification.Epoch.html#10372" class="Bound">gaid</a> <a id="10377" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10379" href="Ledger.Conway.Specification.Epoch.html#10379" class="Bound">addr</a><a id="10383" class="Symbol">)</a> <a id="10385" class="Symbol">→</a> <a id="10387" class="Symbol">(</a><a id="10388" href="Ledger.Conway.Specification.Epoch.html#10372" class="Bound">gaid</a> <a id="10393" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10395" href="Ledger.Conway.Specification.Epoch.html#10379" class="Bound">addr</a><a id="10399" class="Symbol">)</a> <a id="10401" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10403" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="10409" href="Ledger.Conway.Specification.Epoch.html#10379" class="Bound">addr</a><a id="10413" class="Symbol">)</a> <a id="10415" href="Ledger.Conway.Specification.Epoch.html#10562" class="Function">govSt&#39;</a><a id="10421" class="Symbol">)</a>
     <a id="10428" class="Symbol">(</a><a id="10429" href="Axiom.Set.Map.html#12552" class="Function">mapFromPartialFun</a> <a id="10447" class="Symbol">(λ</a> <a id="10450" class="Symbol">(</a><a id="10451" href="Ledger.Conway.Specification.Epoch.html#10451" class="Bound">gaid</a> <a id="10456" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10458" class="Symbol">_)</a> <a id="10461" class="Symbol">→</a> <a id="10463" href="Axiom.Set.Map.html#16403" class="Function">lookupᵐ?</a> <a id="10472" href="Ledger.Conway.Specification.Utxo.html#1338" class="Field">deposits</a> <a id="10481" class="Symbol">(</a><a id="10482" href="Ledger.Conway.Specification.Certs.html#754" class="InductiveConstructor">GovActionDeposit</a> <a id="10499" href="Ledger.Conway.Specification.Epoch.html#10451" class="Bound">gaid</a><a id="10503" class="Symbol">))</a> <a id="10506" href="Ledger.Conway.Specification.Epoch.html#10562" class="Function">govSt&#39;</a><a id="10512" class="Symbol">)</a>
     <a id="10519" class="Keyword">where</a>
       <a id="10532" class="Keyword">open</a> <a id="10537" href="Ledger.Conway.Specification.Utxo.html#1230" class="Module">UTxOState</a> <a id="10547" href="Ledger.Conway.Specification.Epoch.html#10336" class="Bound">utxoSt</a>

       <a id="10562" href="Ledger.Conway.Specification.Epoch.html#10562" class="Function">govSt&#39;</a> <a id="10569" class="Symbol">:</a> <a id="10571" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="10573" class="Symbol">(</a><a id="10574" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a> <a id="10586" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10588" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a><a id="10595" class="Symbol">)</a>
       <a id="10604" href="Ledger.Conway.Specification.Epoch.html#10562" class="Function">govSt&#39;</a> <a id="10611" class="Symbol">=</a> <a id="10613" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10618" class="Symbol">(</a><a id="10619" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="10624" href="Ledger.Conway.Specification.Gov.Actions.html#3866" class="Field">returnAddr</a><a id="10634" class="Symbol">)</a> <a id="10636" class="Symbol">(</a><a id="10637" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="10646" href="Ledger.Conway.Specification.Epoch.html#10330" class="Bound">govSt</a><a id="10651" class="Symbol">)</a>


<a id="10655" class="Keyword">module</a> <a id="VDelegDelegatedStake"></a><a id="10662" href="Ledger.Conway.Specification.Epoch.html#10662" class="Module">VDelegDelegatedStake</a>
  <a id="10685" class="Symbol">(</a><a id="10686" href="Ledger.Conway.Specification.Epoch.html#10686" class="Bound">currentEpoch</a> <a id="10699" class="Symbol">:</a> <a id="10701" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a><a id="10706" class="Symbol">)</a>
  <a id="10710" class="Symbol">(</a><a id="10711" href="Ledger.Conway.Specification.Epoch.html#10711" class="Bound">utxoSt</a>       <a id="10724" class="Symbol">:</a> <a id="10726" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a><a id="10735" class="Symbol">)</a>
  <a id="10739" class="Symbol">(</a><a id="10740" href="Ledger.Conway.Specification.Epoch.html#10740" class="Bound">govSt</a>        <a id="10753" class="Symbol">:</a> <a id="10755" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a><a id="10763" class="Symbol">)</a>
  <a id="10767" class="Symbol">(</a><a id="10768" href="Ledger.Conway.Specification.Epoch.html#10768" class="Bound">gState</a>       <a id="10781" class="Symbol">:</a> <a id="10783" href="Ledger.Conway.Specification.Certs.html#4160" class="Record">GState</a><a id="10789" class="Symbol">)</a>
  <a id="10793" class="Symbol">(</a><a id="10794" href="Ledger.Conway.Specification.Epoch.html#10794" class="Bound">dState</a>       <a id="10807" class="Symbol">:</a> <a id="10809" href="Ledger.Conway.Specification.Certs.html#3897" class="Record">DState</a><a id="10815" class="Symbol">)</a>
  <a id="10819" class="Keyword">where</a>


  <a id="10829" class="Keyword">open</a> <a id="10834" href="Ledger.Conway.Specification.Utxo.html#1230" class="Module">UTxOState</a> <a id="10844" href="Ledger.Conway.Specification.Epoch.html#10711" class="Bound">utxoSt</a>
  <a id="10853" class="Keyword">open</a> <a id="10858" href="Ledger.Conway.Specification.Certs.html#3897" class="Module">DState</a> <a id="10865" href="Ledger.Conway.Specification.Epoch.html#10794" class="Bound">dState</a>
  <a id="10874" class="Keyword">open</a> <a id="10879" href="Ledger.Conway.Specification.Certs.html#4160" class="Module">GState</a> <a id="10886" href="Ledger.Conway.Specification.Epoch.html#10768" class="Bound">gState</a>


  <a id="10897" class="Comment">-- active DReps</a>
  <a id="VDelegDelegatedStake.activeDReps"></a><a id="10915" href="Ledger.Conway.Specification.Epoch.html#10915" class="Function">activeDReps</a> <a id="10927" class="Symbol">:</a> <a id="10929" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="10931" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a>
  <a id="10944" href="Ledger.Conway.Specification.Epoch.html#10915" class="Function">activeDReps</a> <a id="10956" class="Symbol">=</a> <a id="10958" href="Class.IsSet.html#916" class="Function">dom</a> <a id="10962" class="Symbol">(</a><a id="10963" href="abstract-set-theory.FiniteSetTheory.html#3216" class="Function">filterᵐ</a> <a id="10971" class="Symbol">(λ</a> <a id="10974" class="Symbol">(_</a> <a id="10977" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10979" href="Ledger.Conway.Specification.Epoch.html#10979" class="Bound">e</a><a id="10980" class="Symbol">)</a> <a id="10982" class="Symbol">→</a> <a id="10984" href="Ledger.Conway.Specification.Epoch.html#10686" class="Bound">currentEpoch</a> <a id="10997" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="10999" href="Ledger.Conway.Specification.Epoch.html#10979" class="Bound">e</a><a id="11000" class="Symbol">)</a> <a id="11002" href="Ledger.Conway.Specification.Certs.html#4217" class="Function">dreps</a><a id="11007" class="Symbol">)</a>

  <a id="11012" class="Comment">-- active vote delegations</a>
  <a id="VDelegDelegatedStake.activeVDelegs"></a><a id="11041" href="Ledger.Conway.Specification.Epoch.html#11041" class="Function">activeVDelegs</a> <a id="11055" class="Symbol">:</a> <a id="11057" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="11059" href="Ledger.Conway.Specification.Gov.Actions.html#674" class="Datatype">VDeleg</a>
  <a id="11068" href="Ledger.Conway.Specification.Epoch.html#11041" class="Function">activeVDelegs</a> <a id="11082" class="Symbol">=</a> <a id="11084" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="11089" href="Ledger.Conway.Specification.Gov.Actions.html#696" class="InductiveConstructor">vDelegCredential</a> <a id="11106" href="Ledger.Conway.Specification.Epoch.html#10915" class="Function">activeDReps</a> <a id="11118" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="11120" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="11122" href="Ledger.Conway.Specification.Gov.Actions.html#769" class="InductiveConstructor">vDelegNoConfidence</a> <a id="11141" href="Class.HasSingleton.html#288" class="Field Operator">❵</a> <a id="11143" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="11145" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="11147" href="Ledger.Conway.Specification.Gov.Actions.html#739" class="InductiveConstructor">vDelegAbstain</a> <a id="11161" href="Class.HasSingleton.html#288" class="Field Operator">❵</a>

  <a id="11166" class="Comment">-- compute the stake for a credential</a>
  <a id="VDelegDelegatedStake.stakePerCredential"></a><a id="11206" href="Ledger.Conway.Specification.Epoch.html#11206" class="Function">stakePerCredential</a> <a id="11225" class="Symbol">:</a> <a id="11227" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="11238" class="Symbol">→</a> <a id="11240" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11247" href="Ledger.Conway.Specification.Epoch.html#11206" class="Function">stakePerCredential</a> <a id="11266" href="Ledger.Conway.Specification.Epoch.html#11266" class="Bound">c</a> <a id="11268" class="Symbol">=</a> <a id="11270" href="Ledger.Conway.Specification.Utxo.html#2456" class="Function">cbalance</a> <a id="11279" class="Symbol">(</a><a id="11280" href="Ledger.Conway.Specification.Utxo.html#1294" class="Function">utxo</a> <a id="11285" href="abstract-set-theory.FiniteSetTheory.html#3409" class="Function Operator">∣^&#39;</a> <a id="11289" class="Symbol">λ</a> <a id="11291" href="Ledger.Conway.Specification.Epoch.html#11291" class="Bound">txout</a> <a id="11297" class="Symbol">→</a> <a id="11299" href="Ledger.Conway.Specification.Epoch.html#5259" class="Function">getStakeCred</a> <a id="11312" href="Ledger.Conway.Specification.Epoch.html#11291" class="Bound">txout</a> <a id="11318" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="11320" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="11325" href="Ledger.Conway.Specification.Epoch.html#11266" class="Bound">c</a><a id="11326" class="Symbol">)</a>
                         <a id="11353" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="11355" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="11365" class="Number">0</a> <a id="11367" class="Symbol">(</a><a id="11368" href="Axiom.Set.Map.html#16403" class="Function">lookupᵐ?</a> <a id="11377" class="Symbol">(</a><a id="11378" href="Ledger.Conway.Specification.Epoch.html#10245" class="Function">stakeFromGADeposits</a> <a id="11398" href="Ledger.Conway.Specification.Epoch.html#10740" class="Bound">govSt</a> <a id="11404" href="Ledger.Conway.Specification.Epoch.html#10711" class="Bound">utxoSt</a><a id="11410" class="Symbol">)</a> <a id="11412" href="Ledger.Conway.Specification.Epoch.html#11266" class="Bound">c</a><a id="11413" class="Symbol">)</a>
                         <a id="11440" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="11442" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="11452" class="Number">0</a> <a id="11454" class="Symbol">(</a><a id="11455" href="Axiom.Set.Map.html#16403" class="Function">lookupᵐ?</a> <a id="11464" class="Symbol">(</a><a id="11465" href="Ledger.Conway.Specification.Certs.html#1845" class="Field">RewardsOf</a> <a id="11475" href="Ledger.Conway.Specification.Epoch.html#10794" class="Bound">dState</a><a id="11481" class="Symbol">)</a> <a id="11483" href="Ledger.Conway.Specification.Epoch.html#11266" class="Bound">c</a><a id="11484" class="Symbol">)</a>

  <a id="VDelegDelegatedStake.calculate"></a><a id="11489" href="Ledger.Conway.Specification.Epoch.html#11489" class="Function">calculate</a> <a id="11499" class="Symbol">:</a> <a id="11501" href="Ledger.Conway.Specification.Gov.Actions.html#674" class="Datatype">VDeleg</a> <a id="11508" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11510" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11517" href="Ledger.Conway.Specification.Epoch.html#11489" class="Function">calculate</a> <a id="11527" class="Symbol">=</a> <a id="11529" href="Axiom.Set.Map.html#10460" class="Function">mapFromFun</a> <a id="11540" class="Symbol">(λ</a> <a id="11543" href="Ledger.Conway.Specification.Epoch.html#11543" class="Bound">vd</a> <a id="11546" class="Symbol">→</a> <a id="11548" href="abstract-set-theory.FiniteSetTheory.html#3623" class="Function">∑ˢ[</a> <a id="11552" href="Ledger.Conway.Specification.Epoch.html#11552" class="Bound">c</a> <a id="11554" href="abstract-set-theory.FiniteSetTheory.html#3623" class="Function">←</a> <a id="11556" href="Ledger.Conway.Specification.Certs.html#3956" class="Field">voteDelegs</a> <a id="11567" href="Axiom.Set.Map.html#17191" class="Function Operator">⁻¹</a> <a id="11570" href="Ledger.Conway.Specification.Epoch.html#11543" class="Bound">vd</a> <a id="11573" href="abstract-set-theory.FiniteSetTheory.html#3623" class="Function">]</a> <a id="11575" class="Symbol">(</a><a id="11576" href="Ledger.Conway.Specification.Epoch.html#11206" class="Function">stakePerCredential</a> <a id="11595" href="Ledger.Conway.Specification.Epoch.html#11552" class="Bound">c</a><a id="11596" class="Symbol">))</a>
                         <a id="11624" href="Ledger.Conway.Specification.Epoch.html#11041" class="Function">activeVDelegs</a>


<a id="11640" class="Keyword">opaque</a>


  <a id="calculateVDelegDelegatedStake"></a><a id="11651" href="Ledger.Conway.Specification.Epoch.html#11651" class="Function">calculateVDelegDelegatedStake</a>
    <a id="11685" class="Symbol">:</a> <a id="11687" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
    <a id="11697" class="Symbol">→</a> <a id="11699" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
    <a id="11713" class="Symbol">→</a> <a id="11715" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
    <a id="11728" class="Symbol">→</a> <a id="11730" href="Ledger.Conway.Specification.Certs.html#4160" class="Record">GState</a>
    <a id="11741" class="Symbol">→</a> <a id="11743" href="Ledger.Conway.Specification.Certs.html#3897" class="Record">DState</a>
    <a id="11754" class="Symbol">→</a> <a id="11756" href="Ledger.Conway.Specification.Gov.Actions.html#674" class="Datatype">VDeleg</a> <a id="11763" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11765" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11772" href="Ledger.Conway.Specification.Epoch.html#11651" class="Function">calculateVDelegDelegatedStake</a> <a id="11802" class="Symbol">=</a> <a id="11804" href="Ledger.Conway.Specification.Epoch.html#11489" class="Function">VDelegDelegatedStake.calculate</a>


<a id="11837" class="Keyword">opaque</a>


  <a id="calculatePoolDelegatedStakeForVoting"></a><a id="11848" href="Ledger.Conway.Specification.Epoch.html#11848" class="Function">calculatePoolDelegatedStakeForVoting</a>
    <a id="11889" class="Symbol">:</a> <a id="11891" href="Ledger.Conway.Specification.Rewards.html#6433" class="Record">Snapshot</a>
    <a id="11904" class="Symbol">→</a> <a id="11906" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
    <a id="11920" class="Symbol">→</a> <a id="11922" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
    <a id="11935" class="Symbol">→</a> <a id="11937" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="11945" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11947" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11954" href="Ledger.Conway.Specification.Epoch.html#11848" class="Function">calculatePoolDelegatedStakeForVoting</a> <a id="11991" href="Ledger.Conway.Specification.Epoch.html#11991" class="Bound">ss</a> <a id="11994" href="Ledger.Conway.Specification.Epoch.html#11994" class="Bound">utxoSt</a> <a id="12001" href="Ledger.Conway.Specification.Epoch.html#12001" class="Bound">govSt</a>
    <a id="12011" class="Symbol">=</a> <a id="12013" href="Ledger.Conway.Specification.Epoch.html#9694" class="Function">calculatePoolDelegatedStake</a> <a id="12041" href="Ledger.Conway.Specification.Epoch.html#11991" class="Bound">ss</a> <a id="12044" href="Axiom.Set.Map.Dec.html#2052" class="Function Operator">∪⁺</a> <a id="12047" class="Symbol">(</a><a id="12048" href="Ledger.Conway.Specification.Epoch.html#12102" class="Function">stakeFromDeposits</a> <a id="12066" href="Axiom.Set.Map.html#12770" class="Function Operator">∣</a> <a id="12068" href="Class.IsSet.html#916" class="Function">dom</a> <a id="12072" class="Symbol">(</a><a id="12073" href="Ledger.Conway.Specification.Certs.html#1680" class="Field">PoolsOf</a> <a id="12081" href="Ledger.Conway.Specification.Epoch.html#11991" class="Bound">ss</a><a id="12083" class="Symbol">))</a>
    <a id="12090" class="Keyword">where</a>
      <a id="12102" href="Ledger.Conway.Specification.Epoch.html#12102" class="Function">stakeFromDeposits</a> <a id="12120" class="Symbol">:</a> <a id="12122" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="12130" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12132" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="12143" href="Ledger.Conway.Specification.Epoch.html#12102" class="Function">stakeFromDeposits</a> <a id="12161" class="Symbol">=</a> <a id="12163" href="Axiom.Set.Map.Dec.html#2130" class="Function">aggregate₊</a> <a id="12174" class="Symbol">(((</a><a id="12177" href="Ledger.Conway.Specification.Certs.html#2010" class="Field">StakeDelegsOf</a> <a id="12191" href="Ledger.Conway.Specification.Epoch.html#11991" class="Bound">ss</a> <a id="12194" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="12195" class="Symbol">)</a> <a id="12197" href="Axiom.Set.Rel.html#1608" class="Function Operator">⁻¹ʳ</a>
                                      <a id="12239" href="abstract-set-theory.FiniteSetTheory.html#3050" class="Function Operator">∘ʳ</a> <a id="12242" class="Symbol">(</a><a id="12243" href="Ledger.Conway.Specification.Epoch.html#10245" class="Function">stakeFromGADeposits</a> <a id="12263" href="Ledger.Conway.Specification.Epoch.html#12001" class="Bound">govSt</a> <a id="12269" href="Ledger.Conway.Specification.Epoch.html#11994" class="Bound">utxoSt</a> <a id="12276" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="12277" class="Symbol">))</a> <a id="12280" href="abstract-set-theory.FiniteSetTheory.html#2860" class="Function Operator">ᶠˢ</a><a id="12282" class="Symbol">)</a>


<a id="mkStakeDistrs"></a><a id="12286" href="Ledger.Conway.Specification.Epoch.html#12286" class="Function">mkStakeDistrs</a>
  <a id="12302" class="Symbol">:</a> <a id="12304" href="Ledger.Conway.Specification.Rewards.html#6433" class="Record">Snapshot</a>
  <a id="12315" class="Symbol">→</a> <a id="12317" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
  <a id="12325" class="Symbol">→</a> <a id="12327" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
  <a id="12339" class="Symbol">→</a> <a id="12341" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
  <a id="12352" class="Symbol">→</a> <a id="12354" href="Ledger.Conway.Specification.Certs.html#4160" class="Record">GState</a>
  <a id="12363" class="Symbol">→</a> <a id="12365" href="Ledger.Conway.Specification.Certs.html#3897" class="Record">DState</a>
  <a id="12374" class="Symbol">→</a> <a id="12376" href="Ledger.Conway.Specification.Ratify.html#2963" class="Record">StakeDistrs</a>
<a id="12388" href="Ledger.Conway.Specification.Epoch.html#12286" class="Function">mkStakeDistrs</a> <a id="12402" href="Ledger.Conway.Specification.Epoch.html#12402" class="Bound">ss</a> <a id="12405" href="Ledger.Conway.Specification.Epoch.html#12405" class="Bound">currentEpoch</a> <a id="12418" href="Ledger.Conway.Specification.Epoch.html#12418" class="Bound">utxoSt</a> <a id="12425" href="Ledger.Conway.Specification.Epoch.html#12425" class="Bound">govSt</a> <a id="12431" href="Ledger.Conway.Specification.Epoch.html#12431" class="Bound">gState</a> <a id="12438" href="Ledger.Conway.Specification.Epoch.html#12438" class="Bound">dState</a> <a id="12445" class="Symbol">=</a>
  <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#11651}{\htmlId{12451}{\htmlClass{Function}{\text{calculateVDelegDelegatedStake}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12405}{\htmlId{12481}{\htmlClass{Bound}{\text{currentEpoch}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12418}{\htmlId{12494}{\htmlClass{Bound}{\text{utxoSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12425}{\htmlId{12501}{\htmlClass{Bound}{\text{govSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12431}{\htmlId{12507}{\htmlClass{Bound}{\text{gState}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12438}{\htmlId{12514}{\htmlClass{Bound}{\text{dState}}}}\,
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#11848}{\htmlId{12525}{\htmlClass{Function}{\text{calculatePoolDelegatedStakeForVoting}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12402}{\htmlId{12562}{\htmlClass{Bound}{\text{ss}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12418}{\htmlId{12565}{\htmlClass{Bound}{\text{utxoSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12425}{\htmlId{12572}{\htmlClass{Bound}{\text{govSt}}}}\, \end{pmatrix}$</a>


<a id="12582" class="Keyword">private</a> <a id="12590" class="Keyword">variable</a>
  <a id="12601" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="12603" href="Ledger.Conway.Specification.Epoch.html#12603" class="Generalizable">lastEpoch</a> <a id="12613" class="Symbol">:</a> <a id="12615" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
  <a id="12623" href="Ledger.Conway.Specification.Epoch.html#12623" class="Generalizable">fut</a> <a id="12627" href="Ledger.Conway.Specification.Epoch.html#12627" class="Generalizable">fut&#39;</a> <a id="12632" class="Symbol">:</a> <a id="12634" href="Ledger.Conway.Specification.Ratify.html#3374" class="Record">RatifyState</a>
  <a id="12648" href="Ledger.Conway.Specification.Epoch.html#12648" class="Generalizable">poolReapState</a> <a id="12662" class="Symbol">:</a> <a id="12664" href="Ledger.Conway.Specification.PoolReap.html#404" class="Record">PoolReapState</a>
  <a id="12680" href="Ledger.Conway.Specification.Epoch.html#12680" class="Generalizable">eps</a> <a id="12684" href="Ledger.Conway.Specification.Epoch.html#12684" class="Generalizable">eps&#39;</a> <a id="12689" href="Ledger.Conway.Specification.Epoch.html#12689" class="Generalizable">eps&#39;&#39;</a> <a id="12695" class="Symbol">:</a> <a id="12697" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a>
  <a id="12710" href="Ledger.Conway.Specification.Epoch.html#12710" class="Generalizable">ls</a> <a id="12713" class="Symbol">:</a> <a id="12715" href="Ledger.Conway.Specification.Ledger.html#979" class="Record">LState</a>
  <a id="12724" href="Ledger.Conway.Specification.Epoch.html#12724" class="Generalizable">es₀</a> <a id="12728" class="Symbol">:</a> <a id="12730" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a>
  <a id="12743" href="Ledger.Conway.Specification.Epoch.html#12743" class="Generalizable">mark</a> <a id="12748" href="Ledger.Conway.Specification.Epoch.html#12748" class="Generalizable">set</a> <a id="12752" href="Ledger.Conway.Specification.Epoch.html#12752" class="Generalizable">go</a> <a id="12755" class="Symbol">:</a> <a id="12757" href="Ledger.Conway.Specification.Rewards.html#6433" class="Record">Snapshot</a>
  <a id="12768" href="Ledger.Conway.Specification.Epoch.html#12768" class="Generalizable">feeSS</a> <a id="12774" class="Symbol">:</a> <a id="12776" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
  <a id="12783" href="Ledger.Conway.Specification.Epoch.html#12783" class="Generalizable">lstate</a> <a id="12790" class="Symbol">:</a> <a id="12792" href="Ledger.Conway.Specification.Ledger.html#979" class="Record">LState</a>
  <a id="12801" href="Ledger.Conway.Specification.Epoch.html#12801" class="Generalizable">pState&#39;&#39;</a> <a id="12810" class="Symbol">:</a> <a id="12812" href="Ledger.Conway.Specification.Certs.html#4048" class="Record">PState</a>
  <a id="12821" href="Ledger.Conway.Specification.Epoch.html#12821" class="Generalizable">dState&#39;</a> <a id="12829" class="Symbol">:</a> <a id="12831" href="Ledger.Conway.Specification.Certs.html#3897" class="Record">DState</a>
  <a id="12840" href="Ledger.Conway.Specification.Epoch.html#12840" class="Generalizable">acnt</a> <a id="12845" href="Ledger.Conway.Specification.Epoch.html#12845" class="Generalizable">acnt&#39;</a> <a id="12851" class="Symbol">:</a> <a id="12853" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
  <a id="12860" href="Ledger.Conway.Specification.Epoch.html#12860" class="Generalizable">utxoSt&#39;&#39;</a> <a id="12869" class="Symbol">:</a> <a id="12871" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
  <a id="12883" href="Ledger.Conway.Specification.Epoch.html#12883" class="Generalizable">ss</a> <a id="12886" href="Ledger.Conway.Specification.Epoch.html#12886" class="Generalizable">ss&#39;</a> <a id="12890" class="Symbol">:</a> <a id="12892" href="Ledger.Conway.Specification.Rewards.html#7745" class="Record">Snapshots</a>
  <a id="12904" href="Ledger.Conway.Specification.Epoch.html#12904" class="Generalizable">ru</a> <a id="12907" class="Symbol">:</a> <a id="12909" href="Ledger.Conway.Specification.Rewards.html#6210" class="Record">RewardUpdate</a>
  <a id="12924" href="Ledger.Conway.Specification.Epoch.html#12924" class="Generalizable">mru</a> <a id="12928" class="Symbol">:</a> <a id="12930" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="12936" href="Ledger.Conway.Specification.Rewards.html#6210" class="Record">RewardUpdate</a>
  <a id="12951" href="Ledger.Conway.Specification.Epoch.html#12951" class="Generalizable">pd</a> <a id="12954" class="Symbol">:</a> <a id="12956" href="Ledger.Conway.Specification.Epoch.html#3201" class="Function">PoolDelegatedStake</a>


<a id="getOrphans"></a><a id="12977" href="Ledger.Conway.Specification.Epoch.html#12977" class="Function">getOrphans</a> <a id="12988" class="Symbol">:</a> <a id="12990" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a> <a id="13001" class="Symbol">→</a> <a id="13003" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="13012" class="Symbol">→</a> <a id="13014" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
<a id="13023" href="Ledger.Conway.Specification.Epoch.html#12977" class="Function">getOrphans</a> <a id="13034" href="Ledger.Conway.Specification.Epoch.html#13034" class="Bound">es</a> <a id="13037" href="Ledger.Conway.Specification.Epoch.html#13037" class="Bound">govSt</a> <a id="13043" class="Symbol">=</a> <a id="13045" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="13051" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="13053" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a> <a id="13061" href="Ledger.Conway.Specification.Epoch.html#13106" class="Function">step</a> <a id="13066" class="Symbol">(</a><a id="13067" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="13070" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13072" href="Ledger.Conway.Specification.Epoch.html#13037" class="Bound">govSt</a><a id="13077" class="Symbol">)</a> <a id="13079" class="Symbol">(</a><a id="13080" href="Data.List.Base.html#4746" class="Function">length</a> <a id="13087" href="Ledger.Conway.Specification.Epoch.html#13037" class="Bound">govSt</a><a id="13092" class="Symbol">)</a>
  <a id="13096" class="Keyword">where</a>
    <a id="13106" href="Ledger.Conway.Specification.Epoch.html#13106" class="Function">step</a> <a id="13111" class="Symbol">:</a> <a id="13113" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="13122" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13124" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="13133" class="Symbol">→</a> <a id="13135" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="13144" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13146" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
    <a id="13159" href="Ledger.Conway.Specification.Epoch.html#13106" class="Function">step</a> <a id="13164" class="Symbol">(</a><a id="13165" href="Ledger.Conway.Specification.Epoch.html#13165" class="Bound">orps</a> <a id="13170" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13172" href="Ledger.Conway.Specification.Epoch.html#13172" class="Bound">govSt</a><a id="13177" class="Symbol">)</a> <a id="13179" class="Symbol">=</a>
      <a id="13187" class="Keyword">let</a>
        <a id="13199" href="Ledger.Conway.Specification.Epoch.html#13199" class="Bound">isOrphan?</a> <a id="13209" href="Ledger.Conway.Specification.Epoch.html#13209" class="Bound">a</a> <a id="13211" href="Ledger.Conway.Specification.Epoch.html#13211" class="Bound">prev</a> <a id="13216" class="Symbol">=</a> <a id="13218" href="Relation.Nullary.Decidable.Core.html#3277" class="Function">¬?</a> <a id="13221" class="Symbol">(</a><a id="13222" href="Ledger.Conway.Specification.Gov.html#9845" class="Function">hasParent?</a> <a id="13233" href="Ledger.Conway.Specification.Epoch.html#13034" class="Bound">es</a> <a id="13236" href="Ledger.Conway.Specification.Epoch.html#13172" class="Bound">govSt</a> <a id="13242" href="Ledger.Conway.Specification.Epoch.html#13209" class="Bound">a</a> <a id="13244" href="Ledger.Conway.Specification.Epoch.html#13211" class="Bound">prev</a><a id="13248" class="Symbol">)</a>
        <a id="13258" class="Symbol">(</a><a id="13259" href="Ledger.Conway.Specification.Epoch.html#13259" class="Bound">orps&#39;</a> <a id="13265" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13267" href="Ledger.Conway.Specification.Epoch.html#13267" class="Bound">govSt&#39;</a><a id="13273" class="Symbol">)</a> <a id="13275" class="Symbol">=</a> <a id="13277" href="Data.List.Base.html#10628" class="Function">partition</a>
          <a id="13297" class="Symbol">(λ</a> <a id="13300" class="Symbol">(_</a> <a id="13303" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13305" class="Keyword">record</a> <a id="13312" class="Symbol">{</a><a id="13313" href="Ledger.Conway.Specification.Gov.Actions.html#3916" class="Field">action</a> <a id="13320" class="Symbol">=</a> <a id="13322" href="Ledger.Conway.Specification.Epoch.html#13322" class="Bound">a</a> <a id="13324" class="Symbol">;</a> <a id="13326" href="Ledger.Conway.Specification.Gov.Actions.html#3944" class="Field">prevAction</a> <a id="13337" class="Symbol">=</a> <a id="13339" href="Ledger.Conway.Specification.Epoch.html#13339" class="Bound">prev</a><a id="13343" class="Symbol">})</a> <a id="13346" class="Symbol">→</a> <a id="13348" href="Ledger.Conway.Specification.Epoch.html#13199" class="Bound">isOrphan?</a> <a id="13358" class="Symbol">(</a><a id="13359" href="Ledger.Conway.Specification.Epoch.html#13322" class="Bound">a</a> <a id="13361" class="Symbol">.</a><a id="13362" href="Ledger.Conway.Specification.Gov.Actions.html#1981" class="Field">gaType</a><a id="13368" class="Symbol">)</a> <a id="13370" href="Ledger.Conway.Specification.Epoch.html#13339" class="Bound">prev</a><a id="13374" class="Symbol">)</a>
          <a id="13386" href="Ledger.Conway.Specification.Epoch.html#13172" class="Bound">govSt</a>
      <a id="13398" class="Keyword">in</a>
        <a id="13409" class="Symbol">(</a><a id="13410" href="Ledger.Conway.Specification.Epoch.html#13165" class="Bound">orps</a> <a id="13415" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="13418" href="Ledger.Conway.Specification.Epoch.html#13259" class="Bound">orps&#39;</a> <a id="13424" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13426" href="Ledger.Conway.Specification.Epoch.html#13267" class="Bound">govSt&#39;</a><a id="13432" class="Symbol">)</a>


<a id="13436" class="Keyword">record</a> <a id="Governance-Update"></a><a id="13443" href="Ledger.Conway.Specification.Epoch.html#13443" class="Record">Governance-Update</a> <a id="13461" class="Symbol">:</a> <a id="13463" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="13468" class="Keyword">where</a>
  <a id="13476" class="Keyword">constructor</a> <a id="GovernanceUpdate"></a><a id="13488" href="Ledger.Conway.Specification.Epoch.html#13488" class="InductiveConstructor">GovernanceUpdate</a>
  <a id="13507" class="Keyword">field</a>
    <a id="Governance-Update.removedGovActions"></a><a id="13517" href="Ledger.Conway.Specification.Epoch.html#13517" class="Field">removedGovActions</a> <a id="13535" class="Symbol">:</a> <a id="13537" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="13539" class="Symbol">(</a><a id="13540" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="13548" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13550" href="Ledger.Conway.Specification.Certs.html#565" class="Datatype">DepositPurpose</a> <a id="13565" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13567" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a><a id="13571" class="Symbol">)</a>
    <a id="Governance-Update.govSt&#39;"></a><a id="13577" href="Ledger.Conway.Specification.Epoch.html#13577" class="Field">govSt&#39;</a>            <a id="13595" class="Symbol">:</a> <a id="13597" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>

<a id="13607" class="Keyword">module</a> <a id="GovernanceUpdate"></a><a id="13614" href="Ledger.Conway.Specification.Epoch.html#13614" class="Module">GovernanceUpdate</a> <a id="13631" class="Symbol">(</a><a id="13632" href="Ledger.Conway.Specification.Epoch.html#13632" class="Bound">ls</a> <a id="13635" class="Symbol">:</a> <a id="13637" href="Ledger.Conway.Specification.Ledger.html#979" class="Record">LState</a><a id="13643" class="Symbol">)</a>
                        <a id="13669" class="Symbol">(</a><a id="13670" href="Ledger.Conway.Specification.Epoch.html#13670" class="Bound">fut</a> <a id="13674" class="Symbol">:</a> <a id="13676" href="Ledger.Conway.Specification.Ratify.html#3374" class="Record">RatifyState</a><a id="13687" class="Symbol">)</a>
                        <a id="13713" class="Keyword">where</a>


  <a id="13723" class="Keyword">open</a> <a id="13728" href="Ledger.Conway.Specification.Ledger.html#979" class="Module">LState</a> <a id="13735" href="Ledger.Conway.Specification.Epoch.html#13632" class="Bound">ls</a>
  <a id="13740" class="Keyword">open</a> <a id="13745" href="Ledger.Conway.Specification.Ratify.html#3374" class="Module">RatifyState</a> <a id="13757" href="Ledger.Conway.Specification.Epoch.html#13670" class="Bound">fut</a>


  <a id="GovernanceUpdate.tmpGovSt"></a><a id="13765" href="Ledger.Conway.Specification.Epoch.html#13765" class="Function">tmpGovSt</a> <a id="13774" class="Symbol">:</a> <a id="13776" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
  <a id="13787" href="Ledger.Conway.Specification.Epoch.html#13765" class="Function">tmpGovSt</a> <a id="13796" class="Symbol">=</a> <a id="13798" href="Ledger.Prelude.html#2402" class="Function">filter</a> <a id="13805" class="Symbol">(λ</a> <a id="13808" href="Ledger.Conway.Specification.Epoch.html#13808" class="Bound">x</a> <a id="13810" class="Symbol">→</a> <a id="13812" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="13818" href="Ledger.Conway.Specification.Epoch.html#13808" class="Bound">x</a> <a id="13820" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="13822" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="13827" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="13833" href="Ledger.Conway.Specification.Ratify.html#3444" class="Field">removed</a><a id="13840" class="Symbol">)</a> <a id="13842" href="Ledger.Conway.Specification.Ledger.html#1065" class="Function">govSt</a>

  <a id="GovernanceUpdate.orphans"></a><a id="13851" href="Ledger.Conway.Specification.Epoch.html#13851" class="Function">orphans</a> <a id="13859" class="Symbol">:</a> <a id="13861" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="13863" class="Symbol">(</a><a id="13864" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a> <a id="13876" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13878" href="Ledger.Conway.Specification.Gov.Actions.html#3799" class="Record">GovActionState</a><a id="13892" class="Symbol">)</a>
  <a id="13896" href="Ledger.Conway.Specification.Epoch.html#13851" class="Function">orphans</a>  <a id="13905" class="Symbol">=</a> <a id="13907" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="13916" class="Symbol">(</a><a id="13917" href="Ledger.Conway.Specification.Epoch.html#12977" class="Function">getOrphans</a> <a id="13928" href="Ledger.Conway.Specification.Ratify.html#3411" class="Field">es</a> <a id="13931" href="Ledger.Conway.Specification.Epoch.html#13765" class="Function">tmpGovSt</a><a id="13939" class="Symbol">)</a>

  <a id="GovernanceUpdate.removed&#39;"></a><a id="13944" href="Ledger.Conway.Specification.Epoch.html#13944" class="Function">removed&#39;</a> <a id="13953" class="Symbol">:</a> <a id="13955" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="13957" class="Symbol">(</a><a id="13958" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a> <a id="13970" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13972" href="Ledger.Conway.Specification.Gov.Actions.html#3799" class="Record">GovActionState</a><a id="13986" class="Symbol">)</a>
  <a id="13990" href="Ledger.Conway.Specification.Epoch.html#13944" class="Function">removed&#39;</a> <a id="13999" class="Symbol">=</a> <a id="14001" href="Ledger.Conway.Specification.Ratify.html#3444" class="Field">removed</a> <a id="14009" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="14011" href="Ledger.Conway.Specification.Epoch.html#13851" class="Function">orphans</a>

  <a id="GovernanceUpdate.removedGovActions"></a><a id="14022" href="Ledger.Conway.Specification.Epoch.html#14022" class="Function">removedGovActions</a> <a id="14040" class="Symbol">:</a> <a id="14042" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14044" class="Symbol">(</a><a id="14045" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="14053" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14055" href="Ledger.Conway.Specification.Certs.html#565" class="Datatype">DepositPurpose</a> <a id="14070" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14072" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a><a id="14076" class="Symbol">)</a>
  <a id="14080" href="Ledger.Conway.Specification.Epoch.html#14022" class="Function">removedGovActions</a> <a id="14098" class="Symbol">=</a>
    <a id="14104" href="Function.Base.html#1657" class="Function">flip</a> <a id="14109" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a> <a id="14120" href="Ledger.Conway.Specification.Epoch.html#13944" class="Function">removed&#39;</a> <a id="14129" class="Symbol">λ</a> <a id="14131" class="Symbol">(</a><a id="14132" href="Ledger.Conway.Specification.Epoch.html#14132" class="Bound">gaid</a> <a id="14137" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="14139" href="Ledger.Conway.Specification.Epoch.html#14139" class="Bound">gaSt</a><a id="14143" class="Symbol">)</a> <a id="14145" class="Symbol">→</a>
      <a id="14153" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
        <a id="14166" class="Symbol">(</a><a id="14167" href="Ledger.Conway.Specification.Gov.Actions.html#3866" class="Field">returnAddr</a> <a id="14178" href="Ledger.Conway.Specification.Epoch.html#14139" class="Bound">gaSt</a> <a id="14183" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="14185" class="Symbol">)</a>
        <a id="14195" class="Symbol">((</a><a id="14197" href="Ledger.Conway.Specification.Certs.html#916" class="Field">DepositsOf</a> <a id="14208" href="Ledger.Conway.Specification.Ledger.html#1038" class="Function">utxoSt</a> <a id="14215" href="Axiom.Set.Map.html#12770" class="Function Operator">∣</a> <a id="14217" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="14219" href="Ledger.Conway.Specification.Certs.html#754" class="InductiveConstructor">GovActionDeposit</a> <a id="14236" href="Ledger.Conway.Specification.Epoch.html#14132" class="Bound">gaid</a> <a id="14241" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="14242" class="Symbol">)</a> <a id="14244" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="14245" class="Symbol">)</a>

  <a id="GovernanceUpdate.govSt&#39;"></a><a id="14250" href="Ledger.Conway.Specification.Epoch.html#14250" class="Function">govSt&#39;</a> <a id="14257" class="Symbol">:</a> <a id="14259" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
  <a id="14270" href="Ledger.Conway.Specification.Epoch.html#14250" class="Function">govSt&#39;</a> <a id="14277" class="Symbol">=</a> <a id="14279" href="Ledger.Prelude.html#2402" class="Function">filter</a> <a id="14286" class="Symbol">(λ</a> <a id="14289" href="Ledger.Conway.Specification.Epoch.html#14289" class="Bound">x</a> <a id="14291" class="Symbol">→</a> <a id="14293" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14299" href="Ledger.Conway.Specification.Epoch.html#14289" class="Bound">x</a> <a id="14301" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="14303" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14308" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14314" href="Ledger.Conway.Specification.Epoch.html#13944" class="Function">removed&#39;</a><a id="14322" class="Symbol">)</a> <a id="14324" href="Ledger.Conway.Specification.Ledger.html#1065" class="Function">govSt</a>

  <a id="GovernanceUpdate.updates"></a><a id="14333" href="Ledger.Conway.Specification.Epoch.html#14333" class="Function">updates</a> <a id="14341" class="Symbol">:</a> <a id="14343" href="Ledger.Conway.Specification.Epoch.html#13443" class="Record">Governance-Update</a>
  <a id="14363" href="Ledger.Conway.Specification.Epoch.html#14333" class="Function">updates</a> <a id="14371" class="Symbol">=</a> <a id="14373" href="Ledger.Conway.Specification.Epoch.html#13488" class="InductiveConstructor">GovernanceUpdate</a> <a id="14390" href="Ledger.Conway.Specification.Epoch.html#14022" class="Function">removedGovActions</a> <a id="14408" href="Ledger.Conway.Specification.Epoch.html#14250" class="Function">govSt&#39;</a>

<a id="14416" class="Keyword">record</a> <a id="Pre-POOLREAP-Update"></a><a id="14423" href="Ledger.Conway.Specification.Epoch.html#14423" class="Record">Pre-POOLREAP-Update</a> <a id="14443" class="Symbol">:</a> <a id="14445" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="14450" class="Keyword">where</a>
  <a id="14458" class="Keyword">inductive</a>
  <a id="14470" class="Keyword">constructor</a> <a id="Pre-POOLREAPUpdate"></a><a id="14482" href="Ledger.Conway.Specification.Epoch.html#14482" class="InductiveConstructor">Pre-POOLREAPUpdate</a>
  <a id="14503" class="Keyword">field</a>
    <a id="Pre-POOLREAP-Update.pState&#39;"></a><a id="14513" href="Ledger.Conway.Specification.Epoch.html#14513" class="Field">pState&#39;</a> <a id="14521" class="Symbol">:</a> <a id="14523" href="Ledger.Conway.Specification.Certs.html#4048" class="Record">PState</a>
    <a id="Pre-POOLREAP-Update.gState&#39;"></a><a id="14534" href="Ledger.Conway.Specification.Epoch.html#14534" class="Field">gState&#39;</a> <a id="14542" class="Symbol">:</a> <a id="14544" href="Ledger.Conway.Specification.Certs.html#4160" class="Record">GState</a>
    <a id="Pre-POOLREAP-Update.utxoSt&#39;"></a><a id="14555" href="Ledger.Conway.Specification.Epoch.html#14555" class="Field">utxoSt&#39;</a> <a id="14563" class="Symbol">:</a> <a id="14565" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>

<a id="14576" class="Keyword">module</a> <a id="Pre-POOLREAPUpdate"></a><a id="14583" href="Ledger.Conway.Specification.Epoch.html#14583" class="Module">Pre-POOLREAPUpdate</a> <a id="14602" class="Symbol">(</a><a id="14603" href="Ledger.Conway.Specification.Epoch.html#14603" class="Bound">ls</a> <a id="14606" class="Symbol">:</a> <a id="14608" href="Ledger.Conway.Specification.Ledger.html#979" class="Record">LState</a><a id="14614" class="Symbol">)</a>
                          <a id="14642" class="Symbol">(</a><a id="14643" href="Ledger.Conway.Specification.Epoch.html#14643" class="Bound">es</a> <a id="14646" class="Symbol">:</a> <a id="14648" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a><a id="14658" class="Symbol">)</a>
                          <a id="14686" class="Symbol">(</a><a id="14687" href="Ledger.Conway.Specification.Epoch.html#14687" class="Bound">govUpdate</a> <a id="14697" class="Symbol">:</a> <a id="14699" href="Ledger.Conway.Specification.Epoch.html#13443" class="Record">Governance-Update</a><a id="14716" class="Symbol">)</a>
                          <a id="14744" class="Keyword">where</a>


  <a id="14754" class="Keyword">open</a> <a id="14759" href="Ledger.Conway.Specification.Ledger.html#979" class="Module">LState</a> <a id="14766" href="Ledger.Conway.Specification.Epoch.html#14603" class="Bound">ls</a>
  <a id="14771" class="Keyword">open</a> <a id="14776" href="Ledger.Conway.Specification.Certs.html#4291" class="Module">CertState</a> <a id="14786" href="Ledger.Conway.Specification.Ledger.html#1091" class="Function">certState</a> <a id="14796" class="Keyword">using</a> <a id="14802" class="Symbol">(</a><a id="14803" href="Ledger.Conway.Specification.Certs.html#4374" class="Field">pState</a><a id="14809" class="Symbol">;</a> <a id="14811" href="Ledger.Conway.Specification.Certs.html#4394" class="Field">gState</a><a id="14817" class="Symbol">)</a>
  <a id="14821" class="Keyword">open</a> <a id="14826" href="Ledger.Conway.Specification.Certs.html#4048" class="Module">PState</a> <a id="14833" href="Ledger.Conway.Specification.Certs.html#4374" class="Function">pState</a>
  <a id="14842" class="Keyword">open</a> <a id="14847" href="Ledger.Conway.Specification.Epoch.html#13443" class="Module">Governance-Update</a> <a id="14865" href="Ledger.Conway.Specification.Epoch.html#14687" class="Bound">govUpdate</a>


  <a id="Pre-POOLREAPUpdate.utxoSt&#39;"></a><a id="14879" href="Ledger.Conway.Specification.Epoch.html#14879" class="Function">utxoSt&#39;</a> <a id="14887" class="Symbol">:</a> <a id="14889" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>
  <a id="14901" href="Ledger.Conway.Specification.Epoch.html#14879" class="Function">utxoSt&#39;</a> <a id="14909" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Transaction.html#2939}{\htmlId{14913}{\htmlClass{Field}{\text{UTxOOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1038}{\htmlId{14920}{\htmlClass{Function}{\text{utxoSt}}}}\, \\ \,\href{Ledger.Prelude.Base.html#669}{\htmlId{14929}{\htmlClass{Field}{\text{FeesOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1038}{\htmlId{14936}{\htmlClass{Function}{\text{utxoSt}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#916}{\htmlId{14945}{\htmlClass{Field}{\text{DepositsOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1038}{\htmlId{14956}{\htmlClass{Function}{\text{utxoSt}}}}\, \,\href{Axiom.Set.Map.html#12840}{\htmlId{14963}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{abstract-set-theory.FiniteSetTheory.html#519}{\htmlId{14965}{\htmlClass{Function}{\text{mapˢ}}}}\, \,\htmlId{14970}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Data.Product.Base.html#636}{\htmlId{14971}{\htmlClass{Field}{\text{proj₁}}}}\, \,\href{Function.Base.html#1134}{\htmlId{14977}{\htmlClass{Function Operator}{\text{∘}}}}\, \,\href{Data.Product.Base.html#650}{\htmlId{14979}{\htmlClass{Field}{\text{proj₂}}}}\,\,\htmlId{14984}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13517}{\htmlId{14986}{\htmlClass{Field}{\text{removedGovActions}}}}\, \,\href{Axiom.Set.Map.html#12840}{\htmlId{15004}{\htmlClass{Function Operator}{\text{ᶜ}}}}\, \\ \,\htmlId{15008}{\htmlClass{Number}{\text{0}}}\, \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.pState&#39;"></a><a id="15015" href="Ledger.Conway.Specification.Epoch.html#15015" class="Function">pState&#39;</a> <a id="15023" class="Symbol">:</a> <a id="15025" href="Ledger.Conway.Specification.Certs.html#4048" class="Record">PState</a>
  <a id="15034" href="Ledger.Conway.Specification.Epoch.html#15015" class="Function">pState&#39;</a> <a id="15042" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Certs.html#4102}{\htmlId{15046}{\htmlClass{Function}{\text{fPools}}}}\, \,\href{Axiom.Set.Map.html#7638}{\htmlId{15053}{\htmlClass{Function Operator}{\text{∪ˡ}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4080}{\htmlId{15056}{\htmlClass{Function}{\text{pools}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{15064}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#4124}{\htmlId{15068}{\htmlClass{Function}{\text{retiring}}}}\, \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.gState&#39;"></a><a id="15082" href="Ledger.Conway.Specification.Epoch.html#15082" class="Function">gState&#39;</a> <a id="15090" class="Symbol">:</a> <a id="15092" href="Ledger.Conway.Specification.Certs.html#4160" class="Record">GState</a>
  <a id="15101" href="Ledger.Conway.Specification.Epoch.html#15082" class="Function">gState&#39;</a> <a id="15109" class="Symbol">=</a>
    <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{15117}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Class.ToBool.html#342}{\htmlId{15118}{\htmlClass{Function Operator}{\text{if}}}}\, \,\href{Data.List.Base.html#4681}{\htmlId{15121}{\htmlClass{Function}{\text{null}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13577}{\htmlId{15126}{\htmlClass{Field}{\text{govSt&#39;}}}}\, \,\href{Class.ToBool.html#342}{\htmlId{15133}{\htmlClass{Function Operator}{\text{then}}}}\, \,\href{Axiom.Set.Map.html#7106}{\htmlId{15138}{\htmlClass{Function}{\text{mapValues}}}}\, \,\href{Ledger.Core.Specification.Epoch.html#1006}{\htmlId{15148}{\htmlClass{Function}{\text{sucᵉ}}}}\, \,\htmlId{15153}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Certs.html#1603}{\htmlId{15154}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4394}{\htmlId{15162}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{15168}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Class.ToBool.html#342}{\htmlId{15170}{\htmlClass{Function Operator}{\text{else}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#1603}{\htmlId{15175}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4394}{\htmlId{15183}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{15189}{\htmlClass{Symbol}{\text{)}}}\,
    \\ \,\href{Ledger.Conway.Specification.Certs.html#1518}{\htmlId{15197}{\htmlClass{Field}{\text{CCHotKeysOf}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4394}{\htmlId{15209}{\htmlClass{Function}{\text{gState}}}}\, \,\href{Axiom.Set.Map.html#12770}{\htmlId{15216}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Specification.Enact.html#1366}{\htmlId{15218}{\htmlClass{Function}{\text{ccCreds}}}}\, \,\htmlId{15226}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Enact.html#484}{\htmlId{15227}{\htmlClass{Field}{\text{EnactState.cc}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#14643}{\htmlId{15241}{\htmlClass{Bound}{\text{es}}}}\,\,\htmlId{15243}{\htmlClass{Symbol}{\text{)}}}\,
    \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.updates"></a><a id="15254" href="Ledger.Conway.Specification.Epoch.html#15254" class="Function">updates</a> <a id="15262" class="Symbol">:</a> <a id="15264" href="Ledger.Conway.Specification.Epoch.html#14423" class="Record">Pre-POOLREAP-Update</a>
  <a id="15286" href="Ledger.Conway.Specification.Epoch.html#15254" class="Function">updates</a> <a id="15294" class="Symbol">=</a> <a id="15296" href="Ledger.Conway.Specification.Epoch.html#14482" class="InductiveConstructor">Pre-POOLREAPUpdate</a> <a id="15315" href="Ledger.Conway.Specification.Epoch.html#15015" class="Function">pState&#39;</a> <a id="15323" href="Ledger.Conway.Specification.Epoch.html#15082" class="Function">gState&#39;</a> <a id="15331" href="Ledger.Conway.Specification.Epoch.html#14879" class="Function">utxoSt&#39;</a>

<a id="15340" class="Keyword">record</a> <a id="Post-POOLREAP-Update"></a><a id="15347" href="Ledger.Conway.Specification.Epoch.html#15347" class="Record">Post-POOLREAP-Update</a> <a id="15368" class="Symbol">:</a> <a id="15370" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="15375" class="Keyword">where</a>
  <a id="15383" class="Keyword">inductive</a>
  <a id="15395" class="Keyword">constructor</a> <a id="Post-POOLREAPUpdate"></a><a id="15407" href="Ledger.Conway.Specification.Epoch.html#15407" class="InductiveConstructor">Post-POOLREAPUpdate</a>
  <a id="15429" class="Keyword">field</a>
    <a id="Post-POOLREAP-Update.dState&#39;&#39;"></a><a id="15439" href="Ledger.Conway.Specification.Epoch.html#15439" class="Field">dState&#39;&#39;</a>       <a id="15454" class="Symbol">:</a> <a id="15456" href="Ledger.Conway.Specification.Certs.html#3897" class="Record">DState</a>
    <a id="Post-POOLREAP-Update.acnt&#39;&#39;"></a><a id="15467" href="Ledger.Conway.Specification.Epoch.html#15467" class="Field">acnt&#39;&#39;</a>         <a id="15482" class="Symbol">:</a> <a id="15484" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>

<a id="15490" class="Keyword">module</a> <a id="Post-POOLREAPUpdate"></a><a id="15497" href="Ledger.Conway.Specification.Epoch.html#15497" class="Module">Post-POOLREAPUpdate</a> <a id="15517" class="Symbol">(</a><a id="15518" href="Ledger.Conway.Specification.Epoch.html#15518" class="Bound">es</a> <a id="15521" class="Symbol">:</a> <a id="15523" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a><a id="15533" class="Symbol">)</a>
                           <a id="15562" class="Symbol">(</a><a id="15563" href="Ledger.Conway.Specification.Epoch.html#15563" class="Bound">ls</a> <a id="15566" class="Symbol">:</a> <a id="15568" href="Ledger.Conway.Specification.Ledger.html#979" class="Record">LState</a><a id="15574" class="Symbol">)</a>
                           <a id="15603" class="Symbol">(</a><a id="15604" href="Ledger.Conway.Specification.Epoch.html#15604" class="Bound">dState&#39;</a> <a id="15612" class="Symbol">:</a> <a id="15614" href="Ledger.Conway.Specification.Certs.html#3897" class="Record">DState</a><a id="15620" class="Symbol">)</a>
                           <a id="15649" class="Symbol">(</a><a id="15650" href="Ledger.Conway.Specification.Epoch.html#15650" class="Bound">acnt&#39;</a> <a id="15656" class="Symbol">:</a> <a id="15658" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a><a id="15662" class="Symbol">)</a>
                           <a id="15691" class="Symbol">(</a><a id="15692" href="Ledger.Conway.Specification.Epoch.html#15692" class="Bound">govUpd</a> <a id="15699" class="Symbol">:</a> <a id="15701" href="Ledger.Conway.Specification.Epoch.html#13443" class="Record">Governance-Update</a><a id="15718" class="Symbol">)</a>
                           <a id="15747" class="Keyword">where</a>


  <a id="15757" class="Keyword">open</a> <a id="15762" href="Ledger.Conway.Specification.Ledger.html#979" class="Module">LState</a>
  <a id="15771" class="Keyword">open</a> <a id="15776" href="Ledger.Conway.Specification.Epoch.html#13443" class="Module">Governance-Update</a> <a id="15794" href="Ledger.Conway.Specification.Epoch.html#15692" class="Bound">govUpd</a>
  <a id="15803" class="Keyword">opaque</a>


    <a id="Post-POOLREAPUpdate.govActionReturns"></a><a id="15816" href="Ledger.Conway.Specification.Epoch.html#15816" class="Function">govActionReturns</a> <a id="15833" class="Symbol">:</a> <a id="15835" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="15843" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="15845" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="15854" href="Ledger.Conway.Specification.Epoch.html#15816" class="Function">govActionReturns</a> <a id="15871" class="Symbol">=</a>
      <a id="15879" href="Axiom.Set.Map.Dec.html#2130" class="Function">aggregate₊</a> <a id="15890" class="Symbol">(</a><a id="15891" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="15896" class="Symbol">(λ</a> <a id="15899" class="Symbol">(</a><a id="15900" href="Ledger.Conway.Specification.Epoch.html#15900" class="Bound">a</a> <a id="15902" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="15904" class="Symbol">_</a> <a id="15906" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="15908" href="Ledger.Conway.Specification.Epoch.html#15908" class="Bound">d</a><a id="15909" class="Symbol">)</a> <a id="15911" class="Symbol">→</a> <a id="15913" href="Ledger.Conway.Specification.Epoch.html#15900" class="Bound">a</a> <a id="15915" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="15917" href="Ledger.Conway.Specification.Epoch.html#15908" class="Bound">d</a><a id="15918" class="Symbol">)</a> <a id="15920" href="Ledger.Conway.Specification.Epoch.html#13517" class="Field">removedGovActions</a> <a id="15938" href="abstract-set-theory.FiniteSetTheory.html#2860" class="Function Operator">ᶠˢ</a><a id="15940" class="Symbol">)</a>

    <a id="Post-POOLREAPUpdate.payout"></a><a id="15947" href="Ledger.Conway.Specification.Epoch.html#15947" class="Function">payout</a> <a id="15954" class="Symbol">:</a> <a id="15956" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="15964" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="15966" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="15975" href="Ledger.Conway.Specification.Epoch.html#15947" class="Function">payout</a> <a id="15982" class="Symbol">=</a> <a id="15984" href="Ledger.Conway.Specification.Epoch.html#15816" class="Function">govActionReturns</a> <a id="16001" href="Axiom.Set.Map.Dec.html#2052" class="Function Operator">∪⁺</a> <a id="16004" href="Ledger.Core.Specification.Address.html#1701" class="Field">WithdrawalsOf</a> <a id="16018" href="Ledger.Conway.Specification.Epoch.html#15518" class="Bound">es</a>

    <a id="Post-POOLREAPUpdate.refunds"></a><a id="16026" href="Ledger.Conway.Specification.Epoch.html#16026" class="Function">refunds</a> <a id="16034" class="Symbol">:</a> <a id="16036" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="16047" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16049" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16058" href="Ledger.Conway.Specification.Epoch.html#16026" class="Function">refunds</a> <a id="16066" class="Symbol">=</a> <a id="16068" href="Axiom.Set.Map.html#16752" class="Function">pullbackMap</a> <a id="16080" href="Ledger.Conway.Specification.Epoch.html#15947" class="Function">payout</a> <a id="16087" href="Ledger.Conway.Specification.Epoch.html#5172" class="Function">toRwdAddr</a> <a id="16097" class="Symbol">(</a><a id="16098" href="Class.IsSet.html#916" class="Function">dom</a> <a id="16102" class="Symbol">(</a><a id="16103" href="Ledger.Conway.Specification.Certs.html#1845" class="Field">RewardsOf</a> <a id="16113" href="Ledger.Conway.Specification.Epoch.html#15604" class="Bound">dState&#39;</a><a id="16120" class="Symbol">))</a>

    <a id="Post-POOLREAPUpdate.dState&#39;&#39;"></a><a id="16128" href="Ledger.Conway.Specification.Epoch.html#16128" class="Function">dState&#39;&#39;</a> <a id="16137" class="Symbol">:</a> <a id="16139" href="Ledger.Conway.Specification.Certs.html#3897" class="Record">DState</a>
    <a id="16150" href="Ledger.Conway.Specification.Epoch.html#16128" class="Function">dState&#39;&#39;</a> <a id="16159" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Gov.Actions.html#1325}{\htmlId{16163}{\htmlClass{Field}{\text{VoteDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15604}{\htmlId{16176}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#2010}{\htmlId{16186}{\htmlClass{Field}{\text{StakeDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15604}{\htmlId{16200}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#1845}{\htmlId{16210}{\htmlClass{Field}{\text{RewardsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15604}{\htmlId{16220}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \,\href{Axiom.Set.Map.Dec.html#2052}{\htmlId{16228}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16026}{\htmlId{16231}{\htmlClass{Function}{\text{refunds}}}}\, \end{pmatrix}$</a>

    <a id="Post-POOLREAPUpdate.unclaimed"></a><a id="16246" href="Ledger.Conway.Specification.Epoch.html#16246" class="Function">unclaimed</a> <a id="16256" class="Symbol">:</a> <a id="16258" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16267" href="Ledger.Conway.Specification.Epoch.html#16246" class="Function">unclaimed</a> <a id="16277" class="Symbol">=</a> <a id="16279" href="Ledger.Prelude.HasCoin.html#170" class="Field">getCoin</a> <a id="16287" href="Ledger.Conway.Specification.Epoch.html#15947" class="Function">payout</a> <a id="16294" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="16296" href="Ledger.Prelude.HasCoin.html#170" class="Field">getCoin</a> <a id="16304" href="Ledger.Conway.Specification.Epoch.html#16026" class="Function">refunds</a>

    <a id="Post-POOLREAPUpdate.totWithdrawals"></a><a id="16317" href="Ledger.Conway.Specification.Epoch.html#16317" class="Function">totWithdrawals</a> <a id="16332" class="Symbol">:</a> <a id="16334" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16343" href="Ledger.Conway.Specification.Epoch.html#16317" class="Function">totWithdrawals</a> <a id="16358" class="Symbol">=</a> <a id="16360" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">∑[</a> <a id="16363" href="Ledger.Conway.Specification.Epoch.html#16363" class="Bound">x</a> <a id="16365" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">←</a> <a id="16367" href="Ledger.Core.Specification.Address.html#1701" class="Field">WithdrawalsOf</a> <a id="16381" href="Ledger.Conway.Specification.Epoch.html#15518" class="Bound">es</a> <a id="16384" href="abstract-set-theory.FiniteSetTheory.html#3487" class="Function">]</a> <a id="16386" href="Ledger.Conway.Specification.Epoch.html#16363" class="Bound">x</a>

    <a id="Post-POOLREAPUpdate.acnt&#39;&#39;"></a><a id="16393" href="Ledger.Conway.Specification.Epoch.html#16393" class="Function">acnt&#39;&#39;</a> <a id="16400" class="Symbol">:</a> <a id="16402" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
    <a id="16411" href="Ledger.Conway.Specification.Epoch.html#16393" class="Function">acnt&#39;&#39;</a> <a id="16418" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Prelude.Base.html#889}{\htmlId{16422}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15650}{\htmlId{16433}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \,\href{Data.Nat.Base.html#4462}{\htmlId{16439}{\htmlClass{Primitive Operator}{\text{∸}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16317}{\htmlId{16441}{\htmlClass{Function}{\text{totWithdrawals}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{16456}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Prelude.Base.html#554}{\htmlId{16458}{\htmlClass{Field}{\text{DonationsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15563}{\htmlId{16470}{\htmlClass{Bound}{\text{ls}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{16473}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16246}{\htmlId{16475}{\htmlClass{Function}{\text{unclaimed}}}}\, \\ \,\href{Ledger.Prelude.Base.html#773}{\htmlId{16487}{\htmlClass{Field}{\text{ReservesOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15650}{\htmlId{16498}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \end{pmatrix}$</a>

    <a id="Post-POOLREAPUpdate.updates"></a><a id="16511" href="Ledger.Conway.Specification.Epoch.html#16511" class="Function">updates</a> <a id="16519" class="Symbol">:</a> <a id="16521" href="Ledger.Conway.Specification.Epoch.html#15347" class="Record">Post-POOLREAP-Update</a>
    <a id="16546" href="Ledger.Conway.Specification.Epoch.html#16511" class="Function">updates</a> <a id="16554" class="Symbol">=</a> <a id="16556" href="Ledger.Conway.Specification.Epoch.html#15407" class="InductiveConstructor">Post-POOLREAPUpdate</a> <a id="16576" href="Ledger.Conway.Specification.Epoch.html#16128" class="Function">dState&#39;&#39;</a> <a id="16585" href="Ledger.Conway.Specification.Epoch.html#16393" class="Function">acnt&#39;&#39;</a>


<a id="16594" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="16599" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="16614" class="Symbol">:</a> <a id="16616" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="16618" class="Symbol">→</a> <a id="16620" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a> <a id="16631" class="Symbol">→</a> <a id="16633" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a> <a id="16639" class="Symbol">→</a> <a id="16641" href="Ledger.Conway.Specification.Epoch.html#1744" class="Record">EpochState</a> <a id="16652" class="Symbol">→</a> <a id="16654" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="16659" class="Keyword">where</a>


  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="16669" href="Ledger.Conway.Specification.Epoch.html#16669" class="InductiveConstructor">EPOCH</a> <a id="16675" class="Symbol">:</a>
    <a id="16681" class="Keyword">let</a>
      <a id="16691" href="Ledger.Conway.Specification.Epoch.html#16691" class="Bound">es</a> <a id="16694" class="Symbol">=</a> <a id="16696" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="16709" href="Ledger.Conway.Specification.Epoch.html#12623" class="Generalizable">fut</a>

      <a id="16720" href="Ledger.Conway.Specification.Epoch.html#16720" class="Bound">govUpd</a> <a id="16727" class="Symbol">:</a> <a id="16729" href="Ledger.Conway.Specification.Epoch.html#13443" class="Record">Governance-Update</a>
      <a id="16753" href="Ledger.Conway.Specification.Epoch.html#16720" class="Bound">govUpd</a> <a id="16760" class="Symbol">=</a> <a id="16762" href="Ledger.Conway.Specification.Epoch.html#14333" class="Function">GovernanceUpdate.updates</a> <a id="16787" href="Ledger.Conway.Specification.Epoch.html#12710" class="Generalizable">ls</a> <a id="16790" href="Ledger.Conway.Specification.Epoch.html#12623" class="Generalizable">fut</a>

      <a id="16801" href="Ledger.Conway.Specification.Epoch.html#14482" class="InductiveConstructor">Pre-POOLREAPUpdate</a> <a id="16820" href="Ledger.Conway.Specification.Epoch.html#16820" class="Bound">pState&#39;</a> <a id="16828" href="Ledger.Conway.Specification.Epoch.html#16828" class="Bound">gState&#39;</a> <a id="16836" href="Ledger.Conway.Specification.Epoch.html#16836" class="Bound">utxoSt&#39;</a> <a id="16844" class="Symbol">=</a> <a id="16846" href="Ledger.Conway.Specification.Epoch.html#15254" class="Function">Pre-POOLREAPUpdate.updates</a> <a id="16873" href="Ledger.Conway.Specification.Epoch.html#12710" class="Generalizable">ls</a> <a id="16876" href="Ledger.Conway.Specification.Epoch.html#16691" class="Bound">es</a> <a id="16879" href="Ledger.Conway.Specification.Epoch.html#16720" class="Bound">govUpd</a>
      <a id="16892" href="Ledger.Conway.Specification.Epoch.html#15407" class="InductiveConstructor">Post-POOLREAPUpdate</a> <a id="16912" href="Ledger.Conway.Specification.Epoch.html#16912" class="Bound">dState&#39;&#39;</a> <a id="16921" href="Ledger.Conway.Specification.Epoch.html#16921" class="Bound">acnt&#39;&#39;</a> <a id="16928" class="Symbol">=</a> <a id="16930" href="Ledger.Conway.Specification.Epoch.html#16511" class="Function">Post-POOLREAPUpdate.updates</a> <a id="16958" href="Ledger.Conway.Specification.Epoch.html#16691" class="Bound">es</a> <a id="16961" href="Ledger.Conway.Specification.Epoch.html#12710" class="Generalizable">ls</a> <a id="16964" href="Ledger.Conway.Specification.Epoch.html#12821" class="Generalizable">dState&#39;</a> <a id="16972" href="Ledger.Conway.Specification.Epoch.html#12845" class="Generalizable">acnt&#39;</a> <a id="16978" href="Ledger.Conway.Specification.Epoch.html#16720" class="Bound">govUpd</a>

      <a id="16992" href="Ledger.Conway.Specification.Epoch.html#16992" class="Bound">es&#39;</a> <a id="16996" class="Symbol">:</a> <a id="16998" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a>
      <a id="17015" href="Ledger.Conway.Specification.Epoch.html#16992" class="Bound">es&#39;</a> <a id="17019" class="Symbol">=</a> <a id="17021" class="Keyword">record</a> <a id="17028" href="Ledger.Conway.Specification.Epoch.html#16691" class="Bound">es</a> <a id="17031" class="Symbol">{</a> <a id="17033" href="Ledger.Conway.Specification.Enact.html#700" class="Field">withdrawals</a> <a id="17045" class="Symbol">=</a> <a id="17047" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="17049" class="Symbol">}</a>

      <a id="17058" href="Ledger.Conway.Specification.Epoch.html#17058" class="Bound">govSt&#39;</a> <a id="17065" class="Symbol">:</a> <a id="17067" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
      <a id="17082" href="Ledger.Conway.Specification.Epoch.html#17058" class="Bound">govSt&#39;</a> <a id="17089" class="Symbol">=</a> <a id="17091" href="Ledger.Conway.Specification.Epoch.html#13577" class="Field">Governance-Update.govSt&#39;</a> <a id="17116" href="Ledger.Conway.Specification.Epoch.html#16720" class="Bound">govUpd</a>

      <a id="17130" href="Ledger.Conway.Specification.Epoch.html#17130" class="Bound">stakeDistrs</a> <a id="17142" class="Symbol">:</a> <a id="17144" href="Ledger.Conway.Specification.Ratify.html#2963" class="Record">StakeDistrs</a>
      <a id="17162" href="Ledger.Conway.Specification.Epoch.html#17130" class="Bound">stakeDistrs</a> <a id="17174" class="Symbol">=</a> <a id="17176" href="Ledger.Conway.Specification.Epoch.html#12286" class="Function">mkStakeDistrs</a> <a id="17190" class="Symbol">(</a><a id="17191" href="Ledger.Conway.Specification.Rewards.html#7779" class="Field">Snapshots.mark</a> <a id="17206" href="Ledger.Conway.Specification.Epoch.html#12886" class="Generalizable">ss&#39;</a><a id="17209" class="Symbol">)</a> <a id="17211" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="17213" href="Ledger.Conway.Specification.Epoch.html#16836" class="Bound">utxoSt&#39;</a>
                                  <a id="17255" href="Ledger.Conway.Specification.Epoch.html#17058" class="Bound">govSt&#39;</a> <a id="17262" class="Symbol">(</a><a id="17263" href="Ledger.Conway.Specification.Certs.html#4810" class="Field">GStateOf</a> <a id="17272" href="Ledger.Conway.Specification.Epoch.html#12710" class="Generalizable">ls</a><a id="17274" class="Symbol">)</a> <a id="17276" class="Symbol">(</a><a id="17277" href="Ledger.Conway.Specification.Certs.html#4594" class="Field">DStateOf</a> <a id="17286" href="Ledger.Conway.Specification.Epoch.html#12710" class="Generalizable">ls</a><a id="17288" class="Symbol">)</a>

      <a id="17297" href="Ledger.Conway.Specification.Epoch.html#17297" class="Bound">Γ</a> <a id="17299" class="Symbol">:</a> <a id="17301" href="Ledger.Conway.Specification.Ratify.html#3082" class="Record">RatifyEnv</a>
      <a id="17317" href="Ledger.Conway.Specification.Epoch.html#17297" class="Bound">Γ</a> <a id="17319" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17130}{\htmlId{17323}{\htmlClass{Bound}{\text{stakeDistrs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12601}{\htmlId{17337}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#1603}{\htmlId{17341}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12710}{\htmlId{17349}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#1518}{\htmlId{17354}{\htmlClass{Field}{\text{CCHotKeysOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12710}{\htmlId{17366}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Prelude.Base.html#889}{\htmlId{17371}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16921}{\htmlId{17382}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#1680}{\htmlId{17391}{\htmlClass{Field}{\text{PoolsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12710}{\htmlId{17399}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Gov.Actions.html#1325}{\htmlId{17404}{\htmlClass{Field}{\text{VoteDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12710}{\htmlId{17417}{\htmlClass{Generalizable}{\text{ls}}}}\, \end{pmatrix}$</a>

    <a id="17427" class="Keyword">in</a>
        <a id="17438" href="Ledger.Conway.Specification.Epoch.html#12710" class="Generalizable">ls</a> <a id="17441" href="Ledger.Conway.Specification.Rewards.html#8220" class="Datatype Operator">⊢</a> <a id="17443" href="Ledger.Conway.Specification.Epoch.html#12883" class="Generalizable">ss</a> <a id="17446" href="Ledger.Conway.Specification.Rewards.html#8220" class="Datatype Operator">⇀⦇</a> <a id="17449" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="17452" href="Ledger.Conway.Specification.Rewards.html#8220" class="Datatype Operator">,SNAP⦈</a> <a id="17459" href="Ledger.Conway.Specification.Epoch.html#12886" class="Generalizable">ss&#39;</a>
      <a id="17469" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="17471" class="Symbol">_</a>  <a id="17474" href="Ledger.Conway.Specification.PoolReap.html#870" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#16836}{\htmlId{17478}{\htmlClass{Bound}{\text{utxoSt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12840}{\htmlId{17488}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Specification.Certs.html#4594}{\htmlId{17495}{\htmlClass{Field}{\text{DStateOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12710}{\htmlId{17504}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#16820}{\htmlId{17509}{\htmlClass{Bound}{\text{pState&#39;}}}}\, \end{pmatrix}$</a> <a id="17519" href="Ledger.Conway.Specification.PoolReap.html#870" class="Datatype Operator">⇀⦇</a> <a id="17522" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="17524" href="Ledger.Conway.Specification.PoolReap.html#870" class="Datatype Operator">,POOLREAP⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12860}{\htmlId{17537}{\htmlClass{Generalizable}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12845}{\htmlId{17548}{\htmlClass{Generalizable}{\text{acnt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12821}{\htmlId{17556}{\htmlClass{Generalizable}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12801}{\htmlId{17566}{\htmlClass{Generalizable}{\text{pState&#39;&#39;}}}}\, \end{pmatrix}$</a>
      <a id="17583" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="17585" href="Ledger.Conway.Specification.Epoch.html#17297" class="Bound">Γ</a>  <a id="17588" href="Ledger.Conway.Specification.Ratify.html#11729" class="Function Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#16691}{\htmlId{17592}{\htmlClass{Bound}{\text{es}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{17597}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Agda.Builtin.Bool.html#192}{\htmlId{17601}{\htmlClass{InductiveConstructor}{\text{false}}}}\, \end{pmatrix}$</a> <a id="17609" href="Ledger.Conway.Specification.Ratify.html#11729" class="Function Operator">⇀⦇</a> <a id="17612" href="Ledger.Conway.Specification.Epoch.html#17058" class="Bound">govSt&#39;</a> <a id="17619" href="Ledger.Conway.Specification.Ratify.html#11729" class="Function Operator">,RATIFIES⦈</a> <a id="17630" href="Ledger.Conway.Specification.Epoch.html#12627" class="Generalizable">fut&#39;</a>
      <a id="17641" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="17694" class="Symbol">_</a> <a id="17696" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12840}{\htmlId{17700}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12883}{\htmlId{17707}{\htmlClass{Generalizable}{\text{ss}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12710}{\htmlId{17712}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12724}{\htmlId{17717}{\htmlClass{Generalizable}{\text{es₀}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12623}{\htmlId{17723}{\htmlClass{Generalizable}{\text{fut}}}}\, \end{pmatrix}$</a> <a id="17729" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">⇀⦇</a> <a id="17732" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="17734" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">,EPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#16921}{\htmlId{17744}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12886}{\htmlId{17753}{\htmlClass{Generalizable}{\text{ss&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12860}{\htmlId{17761}{\htmlClass{Generalizable}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17058}{\htmlId{17772}{\htmlClass{Bound}{\text{govSt&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#16912}{\htmlId{17783}{\htmlClass{Bound}{\text{dState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12801}{\htmlId{17794}{\htmlClass{Generalizable}{\text{pState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#16828}{\htmlId{17805}{\htmlClass{Bound}{\text{gState&#39;}}}}\, \end{pmatrix} \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#16992}{\htmlId{17821}{\htmlClass{Bound}{\text{es&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12627}{\htmlId{17827}{\htmlClass{Generalizable}{\text{fut&#39;}}}}\, \end{pmatrix}$</a>


<a id="17836" class="Keyword">data</a> <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="17841" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="17859" class="Symbol">:</a> <a id="17861" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="17863" class="Symbol">→</a> <a id="17865" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a> <a id="17879" class="Symbol">→</a> <a id="17881" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a> <a id="17887" class="Symbol">→</a> <a id="17889" href="Ledger.Conway.Specification.Epoch.html#3271" class="Record">NewEpochState</a> <a id="17903" class="Symbol">→</a> <a id="17905" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="17910" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="17919" href="Ledger.Conway.Specification.Epoch.html#17919" class="InductiveConstructor">NEWEPOCH-New</a> <a id="17932" class="Symbol">:</a> <a id="17934" class="Symbol">∀</a> <a id="17936" class="Symbol">{</a><a id="17937" href="Ledger.Conway.Specification.Epoch.html#17937" class="Bound">bprev</a> <a id="17943" href="Ledger.Conway.Specification.Epoch.html#17943" class="Bound">bcur</a> <a id="17948" class="Symbol">:</a> <a id="17950" href="Ledger.Conway.Specification.Rewards.html#4867" class="Function">BlocksMade</a><a id="17960" class="Symbol">}</a> <a id="17962" class="Symbol">→</a>
    <a id="17968" class="Keyword">let</a>
      <a id="17978" href="Ledger.Conway.Specification.Epoch.html#17978" class="Bound">eps&#39;</a> <a id="17983" class="Symbol">=</a> <a id="17985" href="Ledger.Conway.Specification.Epoch.html#8626" class="Function">applyRUpd</a> <a id="17995" href="Ledger.Conway.Specification.Epoch.html#12904" class="Generalizable">ru</a> <a id="17998" href="Ledger.Conway.Specification.Epoch.html#12680" class="Generalizable">eps</a>
      <a id="18008" href="Ledger.Conway.Specification.Epoch.html#18008" class="Bound">ss</a>   <a id="18013" class="Symbol">=</a> <a id="18015" href="Ledger.Conway.Specification.Epoch.html#1834" class="Field">EpochState.ss</a> <a id="18029" href="Ledger.Conway.Specification.Epoch.html#12689" class="Generalizable">eps&#39;&#39;</a>
      <a id="18041" href="Ledger.Conway.Specification.Epoch.html#18041" class="Bound">pd&#39;</a>  <a id="18046" class="Symbol">=</a> <a id="18048" href="Ledger.Conway.Specification.Epoch.html#9694" class="Function">calculatePoolDelegatedStake</a> <a id="18076" class="Symbol">(</a><a id="18077" href="Ledger.Conway.Specification.Rewards.html#7784" class="Field">Snapshots.set</a> <a id="18091" href="Ledger.Conway.Specification.Epoch.html#18008" class="Bound">ss</a><a id="18093" class="Symbol">)</a>
    <a id="18099" class="Keyword">in</a>
      <a id="18108" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18110" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="18112" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="18114" href="Ledger.Conway.Specification.Epoch.html#12603" class="Generalizable">lastEpoch</a> <a id="18124" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18126" class="Number">1</a>
      <a id="18134" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="18136" class="Symbol">_</a> <a id="18138" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">⊢</a> <a id="18140" href="Ledger.Conway.Specification.Epoch.html#17978" class="Bound">eps&#39;</a> <a id="18145" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">⇀⦇</a> <a id="18148" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="18150" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">,EPOCH⦈</a> <a id="18158" href="Ledger.Conway.Specification.Epoch.html#12689" class="Generalizable">eps&#39;&#39;</a>
      <a id="18170" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18223" class="Symbol">_</a> <a id="18225" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12603}{\htmlId{18229}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17937}{\htmlId{18241}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17943}{\htmlId{18249}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12680}{\htmlId{18256}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#173}{\htmlId{18262}{\htmlClass{InductiveConstructor}{\text{just}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12904}{\htmlId{18267}{\htmlClass{Generalizable}{\text{ru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12951}{\htmlId{18272}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18277" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">⇀⦇</a> <a id="18280" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="18282" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12601}{\htmlId{18295}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17943}{\htmlId{18299}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Axiom.Set.Map.html#2671}{\htmlId{18306}{\htmlClass{Function}{\text{∅ᵐ}}}}\,  \\ \,\href{Ledger.Conway.Specification.Epoch.html#12689}{\htmlId{18312}{\htmlClass{Generalizable}{\text{eps&#39;&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{18320}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18041}{\htmlId{18330}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="18339" href="Ledger.Conway.Specification.Epoch.html#18339" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="18356" class="Symbol">:</a> <a id="18358" class="Symbol">∀</a> <a id="18360" class="Symbol">{</a><a id="18361" href="Ledger.Conway.Specification.Epoch.html#18361" class="Bound">bprev</a> <a id="18367" href="Ledger.Conway.Specification.Epoch.html#18367" class="Bound">bcur</a> <a id="18372" class="Symbol">:</a> <a id="18374" href="Ledger.Conway.Specification.Rewards.html#4867" class="Function">BlocksMade</a><a id="18384" class="Symbol">}</a> <a id="18386" class="Symbol">→</a>
    <a id="18392" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18394" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="18396" href="Relation.Binary.PropositionalEquality.Core.html#1000" class="Function Operator">≢</a> <a id="18398" href="Ledger.Conway.Specification.Epoch.html#12603" class="Generalizable">lastEpoch</a> <a id="18408" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18410" class="Number">1</a>
      <a id="18418" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18471" class="Symbol">_</a> <a id="18473" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12603}{\htmlId{18477}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18361}{\htmlId{18489}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18367}{\htmlId{18497}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12680}{\htmlId{18504}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12924}{\htmlId{18510}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12951}{\htmlId{18516}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18521" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">⇀⦇</a> <a id="18524" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="18526" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12603}{\htmlId{18539}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18361}{\htmlId{18551}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18367}{\htmlId{18559}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12680}{\htmlId{18566}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12924}{\htmlId{18572}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12951}{\htmlId{18578}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="18586" href="Ledger.Conway.Specification.Epoch.html#18586" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="18612" class="Symbol">:</a> <a id="18614" class="Symbol">∀</a> <a id="18616" class="Symbol">{</a><a id="18617" href="Ledger.Conway.Specification.Epoch.html#18617" class="Bound">bprev</a> <a id="18623" href="Ledger.Conway.Specification.Epoch.html#18623" class="Bound">bcur</a> <a id="18628" class="Symbol">:</a> <a id="18630" href="Ledger.Conway.Specification.Rewards.html#4867" class="Function">BlocksMade</a><a id="18640" class="Symbol">}</a> <a id="18642" class="Symbol">→</a>
    <a id="18648" class="Keyword">let</a>
      <a id="18658" href="Ledger.Conway.Specification.Epoch.html#18658" class="Bound">ss</a>  <a id="18662" class="Symbol">=</a> <a id="18664" href="Ledger.Conway.Specification.Epoch.html#1834" class="Field">EpochState.ss</a> <a id="18678" href="Ledger.Conway.Specification.Epoch.html#12684" class="Generalizable">eps&#39;</a>
      <a id="18689" href="Ledger.Conway.Specification.Epoch.html#18689" class="Bound">pd&#39;</a> <a id="18693" class="Symbol">=</a> <a id="18695" href="Ledger.Conway.Specification.Epoch.html#9694" class="Function">calculatePoolDelegatedStake</a> <a id="18723" class="Symbol">(</a><a id="18724" href="Ledger.Conway.Specification.Rewards.html#7784" class="Field">Snapshots.set</a> <a id="18738" href="Ledger.Conway.Specification.Epoch.html#18658" class="Bound">ss</a><a id="18740" class="Symbol">)</a>
    <a id="18746" class="Keyword">in</a>
      <a id="18755" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18757" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="18759" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="18761" href="Ledger.Conway.Specification.Epoch.html#12603" class="Generalizable">lastEpoch</a> <a id="18771" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18773" class="Number">1</a>
      <a id="18781" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="18783" class="Symbol">_</a> <a id="18785" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">⊢</a> <a id="18787" href="Ledger.Conway.Specification.Epoch.html#12680" class="Generalizable">eps</a> <a id="18791" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">⇀⦇</a> <a id="18794" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="18796" href="Ledger.Conway.Specification.Epoch.html#16599" class="Datatype Operator">,EPOCH⦈</a> <a id="18804" href="Ledger.Conway.Specification.Epoch.html#12684" class="Generalizable">eps&#39;</a>
      <a id="18815" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18868" class="Symbol">_</a> <a id="18870" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12603}{\htmlId{18874}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18617}{\htmlId{18886}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18623}{\htmlId{18894}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12680}{\htmlId{18901}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{18907}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12951}{\htmlId{18917}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18922" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">⇀⦇</a> <a id="18925" href="Ledger.Conway.Specification.Epoch.html#12601" class="Generalizable">e</a> <a id="18927" href="Ledger.Conway.Specification.Epoch.html#17841" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12601}{\htmlId{18940}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18623}{\htmlId{18944}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Axiom.Set.Map.html#2671}{\htmlId{18951}{\htmlClass{Function}{\text{∅ᵐ}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12684}{\htmlId{18956}{\htmlClass{Generalizable}{\text{eps&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{18963}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18689}{\htmlId{18973}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

</pre></body></html>