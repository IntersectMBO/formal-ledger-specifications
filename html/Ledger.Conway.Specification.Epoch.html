<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Epoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="51" class="Keyword">using</a> <a id="57" class="Symbol">()</a> <a id="60" class="Keyword">renaming</a> <a id="69" class="Symbol">(</a><a id="70" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a> <a id="73" class="Symbol">to</a> <a id="76" class="InductiveConstructor">pos</a><a id="79" class="Symbol">)</a>
<a id="81" class="Keyword">import</a>      <a id="93" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="106" class="Symbol">as</a> <a id="109" class="Module">ℤ</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Data.Integer.Properties.html" class="Module">Data.Integer.Properties</a> <a id="147" class="Keyword">using</a> <a id="153" class="Symbol">(</a><a id="154" class="Keyword">module</a> <a id="161" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a><a id="172" class="Symbol">;</a> <a id="174" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a><a id="182" class="Symbol">;</a> <a id="184" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a><a id="194" class="Symbol">;</a> <a id="196" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a><a id="207" class="Symbol">)</a>
                                    <a id="245" class="Keyword">renaming</a> <a id="254" class="Symbol">(</a><a id="255" href="Data.Integer.Properties.html#12508" class="Function">nonNegative⁻¹</a> <a id="269" class="Symbol">to</a> <a id="272" class="Function">nonNegative⁻¹ℤ</a><a id="286" class="Symbol">)</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="331" class="Keyword">using</a> <a id="337" class="Symbol">(</a><a id="338" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a><a id="345" class="Symbol">)</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="373" class="Keyword">using</a> <a id="379" class="Symbol">(</a><a id="380" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="381" class="Symbol">;</a> <a id="383" href="Data.Rational.Base.html#7195" class="Function">floor</a><a id="388" class="Symbol">;</a> <a id="390" href="Data.Rational.Base.html#6394" class="Function Operator">_*_</a><a id="393" class="Symbol">;</a> <a id="395" href="Data.Rational.Base.html#6787" class="Function Operator">_÷_</a><a id="398" class="Symbol">;</a> <a id="400" href="Data.Rational.Base.html#3963" class="Function Operator">_/_</a><a id="403" class="Symbol">;</a> <a id="405" href="Data.Rational.Base.html#6933" class="Function Operator">_⊓_</a><a id="408" class="Symbol">;</a> <a id="410" href="Data.Rational.Properties.html#4152" class="Function Operator">_≟_</a><a id="413" class="Symbol">;</a> <a id="415" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a><a id="424" class="Symbol">)</a>
<a id="426" class="Keyword">open</a> <a id="431" class="Keyword">import</a> <a id="438" href="Data.Rational.Literals.html" class="Module">Data.Rational.Literals</a> <a id="461" class="Keyword">using</a> <a id="467" class="Symbol">(</a><a id="468" href="Data.Rational.Literals.html#740" class="Function">number</a><a id="474" class="Symbol">;</a> <a id="476" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a><a id="481" class="Symbol">)</a>
<a id="483" class="Keyword">open</a> <a id="488" class="Keyword">import</a> <a id="495" href="Data.Rational.Properties.html" class="Module">Data.Rational.Properties</a> <a id="520" class="Keyword">using</a> <a id="526" class="Symbol">(</a><a id="527" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a><a id="540" class="Symbol">;</a> <a id="542" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a><a id="552" class="Symbol">;</a> <a id="554" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a><a id="559" class="Symbol">)</a>
<a id="561" class="Keyword">open</a> <a id="566" class="Keyword">import</a> <a id="573" href="stdlib.Data.Rational.Properties.html" class="Module">stdlib.Data.Rational.Properties</a> <a id="605" class="Keyword">using</a> <a id="611" class="Symbol">(</a><a id="612" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a><a id="622" class="Symbol">;</a> <a id="624" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a><a id="631" class="Symbol">;</a> <a id="633" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a><a id="641" class="Symbol">;</a> <a id="643" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a><a id="650" class="Symbol">;</a> <a id="652" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a><a id="660" class="Symbol">)</a>

<a id="663" class="Keyword">open</a> <a id="668" class="Keyword">import</a> <a id="675" href="Data.Integer.Tactic.RingSolver.html" class="Module">Data.Integer.Tactic.RingSolver</a> <a id="706" class="Keyword">using</a> <a id="712" class="Symbol">(</a><a id="713" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a><a id="720" class="Symbol">)</a>

<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="757" class="Keyword">open</a> <a id="762" class="Keyword">import</a> <a id="769" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="784" class="Keyword">hiding</a> <a id="791" class="Symbol">(</a><a id="792" href="Data.List.Base.html#5114" class="Function">iterate</a><a id="799" class="Symbol">;</a> <a id="801" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="804" class="Symbol">;</a> <a id="806" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="809" class="Symbol">;</a> <a id="811" href="Data.Nat.Base.html#5851" class="Function Operator">_⊓_</a><a id="814" class="Symbol">;</a> <a id="816" href="Class.DecEq.Core.html#168" class="Field Operator">_≟_</a><a id="819" class="Symbol">;</a> <a id="821" href="Data.Nat.Base.html#3425" class="Function">≢-nonZero</a><a id="830" class="Symbol">)</a>
<a id="832" class="Keyword">open</a> <a id="837" href="Ledger.Prelude.html#2387" class="Module">Filter</a> <a id="844" class="Keyword">using</a> <a id="850" class="Symbol">(</a><a id="851" href="Ledger.Prelude.html#2402" class="Function">filter</a><a id="857" class="Symbol">)</a>
<a id="859" class="Keyword">open</a> <a id="864" class="Keyword">import</a> <a id="871" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>
<a id="908" class="Keyword">open</a> <a id="913" class="Keyword">import</a> <a id="920" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="960" class="Keyword">open</a> <a id="965" class="Keyword">import</a> <a id="972" href="Ledger.Prelude.Numeric.UnitInterval.html" class="Module">Ledger.Prelude.Numeric.UnitInterval</a> <a id="1008" class="Keyword">using</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Ledger.Prelude.Numeric.UnitInterval.html#1988" class="Function">fromUnitInterval</a><a id="1031" class="Symbol">;</a> <a id="1033" href="Ledger.Prelude.Numeric.UnitInterval.html#3336" class="Function">UnitInterval-*-0≤</a><a id="1050" class="Symbol">)</a>

<a id="1053" class="Keyword">open</a> <a id="1058" href="Agda.Builtin.FromNat.html#196" class="Module">Number</a> <a id="1065" href="Data.Rational.Literals.html#740" class="Function">number</a> <a id="1072" class="Keyword">renaming</a> <a id="1081" class="Symbol">(</a><a id="1082" href="Agda.Builtin.FromNat.html#281" class="Field">fromNat</a> <a id="1090" class="Symbol">to</a> <a id="1093" class="Field">fromℕ</a><a id="1098" class="Symbol">)</a>

<a id="1101" class="Keyword">module</a> <a id="1108" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a>
  <a id="1144" class="Symbol">(</a><a id="1145" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a> <a id="1149" class="Symbol">:</a> <a id="1151" class="Symbol">_)</a> <a id="1154" class="Symbol">(</a><a id="1155" class="Keyword">open</a> <a id="1160" href="Ledger.Conway.Specification.Transaction.html#1000" class="Module">TransactionStructure</a> <a id="1181" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a><a id="1184" class="Symbol">)</a>
  <a id="1188" class="Symbol">(</a><a id="1189" href="Ledger.Conway.Specification.Epoch.html#1189" class="Bound">abs</a> <a id="1193" class="Symbol">:</a> <a id="1195" href="Ledger.Conway.Specification.Abstract.html#641" class="Record">AbstractFunctions</a> <a id="1213" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a><a id="1216" class="Symbol">)</a> <a id="1218" class="Symbol">(</a><a id="1219" class="Keyword">open</a> <a id="1224" href="Ledger.Conway.Specification.Abstract.html#641" class="Module">AbstractFunctions</a> <a id="1242" href="Ledger.Conway.Specification.Epoch.html#1189" class="Bound">abs</a><a id="1245" class="Symbol">)</a>
  <a id="1249" class="Keyword">where</a>

<a id="1256" class="Keyword">open</a> <a id="1261" class="Keyword">import</a> <a id="1268" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="1302" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="1315" class="Keyword">open</a> <a id="1320" class="Keyword">import</a> <a id="1327" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="1361" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="1374" class="Keyword">open</a> <a id="1379" class="Keyword">import</a> <a id="1386" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="1418" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a>
<a id="1422" class="Keyword">open</a> <a id="1427" class="Keyword">import</a> <a id="1434" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="1469" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a> <a id="1473" href="Ledger.Conway.Specification.Epoch.html#1189" class="Bound">abs</a>
<a id="1477" class="Keyword">open</a> <a id="1482" class="Keyword">import</a> <a id="1489" href="Ledger.Conway.Specification.PoolReap.html" class="Module">Ledger.Conway.Specification.PoolReap</a> <a id="1526" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a> <a id="1530" href="Ledger.Conway.Specification.Epoch.html#1189" class="Bound">abs</a>
<a id="1534" class="Keyword">open</a> <a id="1539" class="Keyword">import</a> <a id="1546" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="1581" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a>
<a id="1585" class="Keyword">open</a> <a id="1590" class="Keyword">import</a> <a id="1597" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="1633" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a> <a id="1637" href="Ledger.Conway.Specification.Epoch.html#1189" class="Bound">abs</a>
<a id="1641" class="Keyword">open</a> <a id="1646" class="Keyword">import</a> <a id="1653" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="1686" href="Ledger.Conway.Specification.Epoch.html#1145" class="Bound">txs</a> <a id="1690" href="Ledger.Conway.Specification.Epoch.html#1189" class="Bound">abs</a>




<a id="1698" class="Keyword">record</a> <a id="EpochState"></a><a id="1705" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a> <a id="1716" class="Symbol">:</a> <a id="1718" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1723" class="Keyword">where</a>


  <a id="1733" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1745" href="Ledger.Conway.Specification.Epoch.html#1745" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>


  <a id="1763" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1773" href="Ledger.Conway.Specification.Epoch.html#1773" class="Field">acnt</a>       <a id="1784" class="Symbol">:</a> <a id="1786" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1795" href="Ledger.Conway.Specification.Epoch.html#1795" class="Field">ss</a>         <a id="1806" class="Symbol">:</a> <a id="1808" href="Ledger.Conway.Specification.Rewards.html#7638" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1822" href="Ledger.Conway.Specification.Epoch.html#1822" class="Field">ls</a>         <a id="1833" class="Symbol">:</a> <a id="1835" href="Ledger.Conway.Specification.Ledger.html#977" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1846" href="Ledger.Conway.Specification.Epoch.html#1846" class="Field">es</a>         <a id="1857" class="Symbol">:</a> <a id="1859" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="1874" href="Ledger.Conway.Specification.Epoch.html#1874" class="Field">fut</a>        <a id="1885" class="Symbol">:</a> <a id="1887" href="Ledger.Conway.Specification.Ratify.html#3383" class="Record">RatifyState</a>



<a id="1902" class="Keyword">record</a> <a id="HasEpochState"></a><a id="1909" href="Ledger.Conway.Specification.Epoch.html#1909" class="Record">HasEpochState</a> <a id="1923" class="Symbol">{</a><a id="1924" href="Ledger.Conway.Specification.Epoch.html#1924" class="Bound">a</a><a id="1925" class="Symbol">}</a> <a id="1927" class="Symbol">(</a><a id="1928" href="Ledger.Conway.Specification.Epoch.html#1928" class="Bound">A</a> <a id="1930" class="Symbol">:</a> <a id="1932" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1937" href="Ledger.Conway.Specification.Epoch.html#1924" class="Bound">a</a><a id="1938" class="Symbol">)</a> <a id="1940" class="Symbol">:</a> <a id="1942" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1947" href="Ledger.Conway.Specification.Epoch.html#1924" class="Bound">a</a> <a id="1949" class="Keyword">where</a>
  <a id="1957" class="Keyword">field</a> <a id="HasEpochState.EpochStateOf"></a><a id="1963" href="Ledger.Conway.Specification.Epoch.html#1963" class="Field">EpochStateOf</a> <a id="1976" class="Symbol">:</a> <a id="1978" href="Ledger.Conway.Specification.Epoch.html#1928" class="Bound">A</a> <a id="1980" class="Symbol">→</a> <a id="1982" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
<a id="1993" class="Keyword">open</a> <a id="1998" href="Ledger.Conway.Specification.Epoch.html#1909" class="Module">HasEpochState</a> <a id="2012" class="Symbol">⦃...⦄</a> <a id="2018" class="Keyword">public</a>

<a id="2026" class="Keyword">instance</a>
  <a id="HasLState-EpochState"></a><a id="2037" href="Ledger.Conway.Specification.Epoch.html#2037" class="Function">HasLState-EpochState</a> <a id="2058" class="Symbol">:</a> <a id="2060" href="Ledger.Conway.Specification.Ledger.html#1122" class="Record">HasLState</a> <a id="2070" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
  <a id="2083" href="Ledger.Conway.Specification.Epoch.html#2037" class="Function">HasLState-EpochState</a> <a id="2104" class="Symbol">.</a><a id="2105" href="Ledger.Conway.Specification.Ledger.html#1172" class="Field">LStateOf</a> <a id="2114" class="Symbol">=</a> <a id="2116" href="Ledger.Conway.Specification.Epoch.html#1822" class="Field">EpochState.ls</a>

  <a id="HasEnactState-EpochState"></a><a id="2133" href="Ledger.Conway.Specification.Epoch.html#2133" class="Function">HasEnactState-EpochState</a> <a id="2158" class="Symbol">:</a> <a id="2160" href="Ledger.Conway.Specification.Enact.html#736" class="Record">HasEnactState</a> <a id="2174" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
  <a id="2187" href="Ledger.Conway.Specification.Epoch.html#2133" class="Function">HasEnactState-EpochState</a> <a id="2212" class="Symbol">.</a><a id="2213" href="Ledger.Conway.Specification.Enact.html#790" class="Field">EnactStateOf</a> <a id="2226" class="Symbol">=</a> <a id="2228" href="Ledger.Conway.Specification.Epoch.html#1846" class="Field">EpochState.es</a>

  <a id="HasDeposits-EpochState"></a><a id="2245" href="Ledger.Conway.Specification.Epoch.html#2245" class="Function">HasDeposits-EpochState</a> <a id="2268" class="Symbol">:</a> <a id="2270" href="Ledger.Conway.Specification.Certs.html#694" class="Record">HasDeposits</a> <a id="2282" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
  <a id="2295" href="Ledger.Conway.Specification.Epoch.html#2245" class="Function">HasDeposits-EpochState</a> <a id="2318" class="Symbol">.</a><a id="2319" href="Ledger.Conway.Specification.Certs.html#746" class="Field">DepositsOf</a> <a id="2330" class="Symbol">=</a> <a id="2332" href="Ledger.Conway.Specification.Certs.html#746" class="Field">DepositsOf</a> <a id="2343" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2345" href="Ledger.Conway.Specification.Ledger.html#1172" class="Field">LStateOf</a>

  <a id="Hastreasury-EpochState"></a><a id="2357" href="Ledger.Conway.Specification.Epoch.html#2357" class="Function">Hastreasury-EpochState</a> <a id="2380" class="Symbol">:</a> <a id="2382" href="Ledger.Conway.Specification.PParams.html#808" class="Record">Hastreasury</a> <a id="2394" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
  <a id="2407" href="Ledger.Conway.Specification.Epoch.html#2357" class="Function">Hastreasury-EpochState</a> <a id="2430" class="Symbol">.</a><a id="2431" href="Ledger.Conway.Specification.PParams.html#860" class="Field">treasuryOf</a> <a id="2442" class="Symbol">=</a> <a id="2444" href="Ledger.Conway.Specification.PParams.html#775" class="Field">Acnt.treasury</a> <a id="2458" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2460" href="Ledger.Conway.Specification.Epoch.html#1773" class="Field">EpochState.acnt</a>

  <a id="Hasreserves-EpochState"></a><a id="2479" href="Ledger.Conway.Specification.Epoch.html#2479" class="Function">Hasreserves-EpochState</a> <a id="2502" class="Symbol">:</a> <a id="2504" href="Ledger.Conway.Specification.PParams.html#920" class="Record">Hasreserves</a> <a id="2516" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
  <a id="2529" href="Ledger.Conway.Specification.Epoch.html#2479" class="Function">Hasreserves-EpochState</a> <a id="2552" class="Symbol">.</a><a id="2553" href="Ledger.Conway.Specification.PParams.html#972" class="Field">reservesOf</a> <a id="2564" class="Symbol">=</a> <a id="2566" href="Ledger.Conway.Specification.PParams.html#784" class="Field">Acnt.reserves</a> <a id="2580" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2582" href="Ledger.Conway.Specification.Epoch.html#1773" class="Field">EpochState.acnt</a>

  <a id="HasPParams-EpochState"></a><a id="2601" href="Ledger.Conway.Specification.Epoch.html#2601" class="Function">HasPParams-EpochState</a> <a id="2623" class="Symbol">:</a> <a id="2625" href="Ledger.Conway.Specification.PParams.html#3713" class="Record">HasPParams</a> <a id="2636" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
  <a id="2649" href="Ledger.Conway.Specification.Epoch.html#2601" class="Function">HasPParams-EpochState</a> <a id="2671" class="Symbol">.</a><a id="2672" href="Ledger.Conway.Specification.PParams.html#3764" class="Field">PParamsOf</a> <a id="2682" class="Symbol">=</a> <a id="2684" href="Ledger.Conway.Specification.PParams.html#3764" class="Field">PParamsOf</a> <a id="2694" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2696" href="Ledger.Conway.Specification.Enact.html#790" class="Field">EnactStateOf</a>


<a id="PoolDelegatedStake"></a><a id="2711" href="Ledger.Conway.Specification.Epoch.html#2711" class="Function">PoolDelegatedStake</a> <a id="2730" class="Symbol">=</a> <a id="2732" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="2740" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2742" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

<a id="2748" class="Keyword">record</a> <a id="NewEpochState"></a><a id="2755" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a> <a id="2769" class="Symbol">:</a> <a id="2771" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2776" class="Keyword">where</a>
  <a id="2784" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="2794" href="Ledger.Conway.Specification.Epoch.html#2794" class="Field">lastEpoch</a>   <a id="2806" class="Symbol">:</a> <a id="2808" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
    <a id="NewEpochState.epochState"></a><a id="2818" href="Ledger.Conway.Specification.Epoch.html#2818" class="Field">epochState</a>  <a id="2830" class="Symbol">:</a> <a id="2832" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="2847" href="Ledger.Conway.Specification.Epoch.html#2847" class="Field">ru</a>          <a id="2859" class="Symbol">:</a> <a id="2861" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2867" href="Ledger.Conway.Specification.Rewards.html#6281" class="Record">RewardUpdate</a>
    <a id="NewEpochState.pd"></a><a id="2884" href="Ledger.Conway.Specification.Epoch.html#2884" class="Field">pd</a>          <a id="2896" class="Symbol">:</a> <a id="2898" href="Ledger.Conway.Specification.Epoch.html#2711" class="Function">PoolDelegatedStake</a>


<a id="2919" class="Keyword">record</a> <a id="HasNewEpochState"></a><a id="2926" href="Ledger.Conway.Specification.Epoch.html#2926" class="Record">HasNewEpochState</a> <a id="2943" class="Symbol">{</a><a id="2944" href="Ledger.Conway.Specification.Epoch.html#2944" class="Bound">a</a><a id="2945" class="Symbol">}</a> <a id="2947" class="Symbol">(</a><a id="2948" href="Ledger.Conway.Specification.Epoch.html#2948" class="Bound">A</a> <a id="2950" class="Symbol">:</a> <a id="2952" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2957" href="Ledger.Conway.Specification.Epoch.html#2944" class="Bound">a</a><a id="2958" class="Symbol">)</a> <a id="2960" class="Symbol">:</a> <a id="2962" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2967" href="Ledger.Conway.Specification.Epoch.html#2944" class="Bound">a</a> <a id="2969" class="Keyword">where</a>
  <a id="2977" class="Keyword">field</a> <a id="HasNewEpochState.NewEpochStateOf"></a><a id="2983" href="Ledger.Conway.Specification.Epoch.html#2983" class="Field">NewEpochStateOf</a> <a id="2999" class="Symbol">:</a> <a id="3001" href="Ledger.Conway.Specification.Epoch.html#2948" class="Bound">A</a> <a id="3003" class="Symbol">→</a> <a id="3005" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
<a id="3019" class="Keyword">open</a> <a id="3024" href="Ledger.Conway.Specification.Epoch.html#2926" class="Module">HasNewEpochState</a> <a id="3041" class="Symbol">⦃...⦄</a> <a id="3047" class="Keyword">public</a>
<a id="3054" class="Keyword">record</a> <a id="HasLastEpoch"></a><a id="3061" href="Ledger.Conway.Specification.Epoch.html#3061" class="Record">HasLastEpoch</a>     <a id="3078" class="Symbol">{</a><a id="3079" href="Ledger.Conway.Specification.Epoch.html#3079" class="Bound">a</a><a id="3080" class="Symbol">}</a> <a id="3082" class="Symbol">(</a><a id="3083" href="Ledger.Conway.Specification.Epoch.html#3083" class="Bound">A</a> <a id="3085" class="Symbol">:</a> <a id="3087" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3092" href="Ledger.Conway.Specification.Epoch.html#3079" class="Bound">a</a><a id="3093" class="Symbol">)</a> <a id="3095" class="Symbol">:</a> <a id="3097" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3102" href="Ledger.Conway.Specification.Epoch.html#3079" class="Bound">a</a> <a id="3104" class="Keyword">where</a> <a id="3110" class="Keyword">field</a> <a id="HasLastEpoch.LastEpochOf"></a><a id="3116" href="Ledger.Conway.Specification.Epoch.html#3116" class="Field">LastEpochOf</a>     <a id="3132" class="Symbol">:</a> <a id="3134" href="Ledger.Conway.Specification.Epoch.html#3083" class="Bound">A</a> <a id="3136" class="Symbol">→</a> <a id="3138" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
<a id="3144" class="Keyword">open</a> <a id="3149" href="Ledger.Conway.Specification.Epoch.html#3061" class="Module">HasLastEpoch</a>     <a id="3166" class="Symbol">⦃...⦄</a> <a id="3172" class="Keyword">public</a>

<a id="3180" class="Keyword">instance</a>
  <a id="HasLastEpoch-NewEpochState"></a><a id="3191" href="Ledger.Conway.Specification.Epoch.html#3191" class="Function">HasLastEpoch-NewEpochState</a> <a id="3218" class="Symbol">:</a> <a id="3220" href="Ledger.Conway.Specification.Epoch.html#3061" class="Record">HasLastEpoch</a> <a id="3233" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="3249" href="Ledger.Conway.Specification.Epoch.html#3191" class="Function">HasLastEpoch-NewEpochState</a> <a id="3276" class="Symbol">.</a><a id="3277" href="Ledger.Conway.Specification.Epoch.html#3116" class="Field">LastEpochOf</a> <a id="3289" class="Symbol">=</a> <a id="3291" href="Ledger.Conway.Specification.Epoch.html#2794" class="Field">NewEpochState.lastEpoch</a>

  <a id="HasEpochState-NewEpochState"></a><a id="3318" href="Ledger.Conway.Specification.Epoch.html#3318" class="Function">HasEpochState-NewEpochState</a> <a id="3346" class="Symbol">:</a> <a id="3348" href="Ledger.Conway.Specification.Epoch.html#1909" class="Record">HasEpochState</a> <a id="3362" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="3378" href="Ledger.Conway.Specification.Epoch.html#3318" class="Function">HasEpochState-NewEpochState</a> <a id="3406" class="Symbol">.</a><a id="3407" href="Ledger.Conway.Specification.Epoch.html#1963" class="Field">EpochStateOf</a> <a id="3420" class="Symbol">=</a> <a id="3422" href="Ledger.Conway.Specification.Epoch.html#2818" class="Field">NewEpochState.epochState</a>

  <a id="HasEnactState-NewEpochState"></a><a id="3450" href="Ledger.Conway.Specification.Epoch.html#3450" class="Function">HasEnactState-NewEpochState</a> <a id="3478" class="Symbol">:</a> <a id="3480" href="Ledger.Conway.Specification.Enact.html#736" class="Record">HasEnactState</a> <a id="3494" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="3510" href="Ledger.Conway.Specification.Epoch.html#3450" class="Function">HasEnactState-NewEpochState</a> <a id="3538" class="Symbol">.</a><a id="3539" href="Ledger.Conway.Specification.Enact.html#790" class="Field">EnactStateOf</a> <a id="3552" class="Symbol">=</a> <a id="3554" href="Ledger.Conway.Specification.Enact.html#790" class="Field">EnactStateOf</a> <a id="3567" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3569" href="Ledger.Conway.Specification.Epoch.html#1963" class="Field">EpochStateOf</a>

  <a id="Hastreasury-NewEpochState"></a><a id="3585" href="Ledger.Conway.Specification.Epoch.html#3585" class="Function">Hastreasury-NewEpochState</a> <a id="3611" class="Symbol">:</a> <a id="3613" href="Ledger.Conway.Specification.PParams.html#808" class="Record">Hastreasury</a> <a id="3625" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="3641" href="Ledger.Conway.Specification.Epoch.html#3585" class="Function">Hastreasury-NewEpochState</a> <a id="3667" class="Symbol">.</a><a id="3668" href="Ledger.Conway.Specification.PParams.html#860" class="Field">treasuryOf</a> <a id="3679" class="Symbol">=</a> <a id="3681" href="Ledger.Conway.Specification.PParams.html#860" class="Field">treasuryOf</a> <a id="3692" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3694" href="Ledger.Conway.Specification.Epoch.html#1963" class="Field">EpochStateOf</a>

  <a id="HasLState-NewEpochState"></a><a id="3710" href="Ledger.Conway.Specification.Epoch.html#3710" class="Function">HasLState-NewEpochState</a> <a id="3734" class="Symbol">:</a> <a id="3736" href="Ledger.Conway.Specification.Ledger.html#1122" class="Record">HasLState</a> <a id="3746" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="3762" href="Ledger.Conway.Specification.Epoch.html#3710" class="Function">HasLState-NewEpochState</a> <a id="3786" class="Symbol">.</a><a id="3787" href="Ledger.Conway.Specification.Ledger.html#1172" class="Field">LStateOf</a> <a id="3796" class="Symbol">=</a> <a id="3798" href="Ledger.Conway.Specification.Ledger.html#1172" class="Field">LStateOf</a> <a id="3807" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3809" href="Ledger.Conway.Specification.Epoch.html#1963" class="Field">EpochStateOf</a>

  <a id="HasGovState-NewEpochState"></a><a id="3825" href="Ledger.Conway.Specification.Epoch.html#3825" class="Function">HasGovState-NewEpochState</a> <a id="3851" class="Symbol">:</a> <a id="3853" href="Ledger.Conway.Specification.Gov.html#1553" class="Record">HasGovState</a> <a id="3865" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="3881" href="Ledger.Conway.Specification.Epoch.html#3825" class="Function">HasGovState-NewEpochState</a> <a id="3907" class="Symbol">.</a><a id="3908" href="Ledger.Conway.Specification.Gov.html#1605" class="Field">GovStateOf</a> <a id="3919" class="Symbol">=</a> <a id="3921" href="Ledger.Conway.Specification.Gov.html#1605" class="Field">GovStateOf</a> <a id="3932" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3934" href="Ledger.Conway.Specification.Ledger.html#1172" class="Field">LStateOf</a>

  <a id="HasCertState-NewEpochState"></a><a id="3946" href="Ledger.Conway.Specification.Epoch.html#3946" class="Function">HasCertState-NewEpochState</a> <a id="3973" class="Symbol">:</a> <a id="3975" href="Ledger.Conway.Specification.Certs.html#4487" class="Record">HasCertState</a> <a id="3988" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="4004" href="Ledger.Conway.Specification.Epoch.html#3946" class="Function">HasCertState-NewEpochState</a> <a id="4031" class="Symbol">.</a><a id="4032" href="Ledger.Conway.Specification.Certs.html#4540" class="Field">CertStateOf</a> <a id="4044" class="Symbol">=</a> <a id="4046" href="Ledger.Conway.Specification.Certs.html#4540" class="Field">CertStateOf</a> <a id="4058" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4060" href="Ledger.Conway.Specification.Ledger.html#1172" class="Field">LStateOf</a>

  <a id="HasDReps-NewEpochState"></a><a id="4072" href="Ledger.Conway.Specification.Epoch.html#4072" class="Function">HasDReps-NewEpochState</a> <a id="4095" class="Symbol">:</a> <a id="4097" href="Ledger.Conway.Specification.Certs.html#923" class="Record">HasDReps</a> <a id="4106" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="4122" href="Ledger.Conway.Specification.Epoch.html#4072" class="Function">HasDReps-NewEpochState</a> <a id="4145" class="Symbol">.</a><a id="4146" href="Ledger.Conway.Specification.Certs.html#972" class="Field">DRepsOf</a> <a id="4154" class="Symbol">=</a> <a id="4156" href="Ledger.Conway.Specification.Certs.html#972" class="Field">DRepsOf</a> <a id="4164" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4166" href="Ledger.Conway.Specification.Certs.html#4540" class="Field">CertStateOf</a>

  <a id="HasRewards-NewEpochState"></a><a id="4181" href="Ledger.Conway.Specification.Epoch.html#4181" class="Function">HasRewards-NewEpochState</a> <a id="4206" class="Symbol">:</a> <a id="4208" href="Ledger.Conway.Specification.Certs.html#810" class="Record">HasRewards</a> <a id="4219" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="4235" href="Ledger.Conway.Specification.Epoch.html#4181" class="Function">HasRewards-NewEpochState</a> <a id="4260" class="Symbol">.</a><a id="4261" href="Ledger.Conway.Specification.Certs.html#861" class="Field">RewardsOf</a> <a id="4271" class="Symbol">=</a> <a id="4273" href="Ledger.Conway.Specification.Certs.html#861" class="Field">RewardsOf</a> <a id="4283" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4285" href="Ledger.Conway.Specification.Certs.html#4540" class="Field">CertStateOf</a>

  <a id="HasPParams-NewEpochState"></a><a id="4300" href="Ledger.Conway.Specification.Epoch.html#4300" class="Function">HasPParams-NewEpochState</a> <a id="4325" class="Symbol">:</a> <a id="4327" href="Ledger.Conway.Specification.PParams.html#3713" class="Record">HasPParams</a> <a id="4338" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>
  <a id="4354" href="Ledger.Conway.Specification.Epoch.html#4300" class="Function">HasPParams-NewEpochState</a> <a id="4379" class="Symbol">.</a><a id="4380" href="Ledger.Conway.Specification.PParams.html#3764" class="Field">PParamsOf</a> <a id="4390" class="Symbol">=</a> <a id="4392" href="Ledger.Conway.Specification.PParams.html#3764" class="Field">PParamsOf</a> <a id="4402" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4404" href="Ledger.Conway.Specification.Epoch.html#1963" class="Field">EpochStateOf</a>

  <a id="4420" class="Keyword">unquoteDecl</a> <a id="HasCast-EpochState"></a><a id="4432" href="Ledger.Conway.Specification.Epoch.html#4432" class="Function">HasCast-EpochState</a> <a id="HasCast-NewEpochState"></a><a id="4451" href="Ledger.Conway.Specification.Epoch.html#4451" class="Function">HasCast-NewEpochState</a> <a id="4473" class="Symbol">=</a> <a id="4475" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="4494" class="Symbol">(</a> <a id="4496" class="Symbol">(</a><a id="4497" class="Keyword">quote</a> <a id="4503" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>     <a id="4518" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4520" href="Ledger.Conway.Specification.Epoch.html#4432" class="Function">HasCast-EpochState</a><a id="4538" class="Symbol">)</a>
    <a id="4544" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4546" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="4548" class="Symbol">(</a><a id="4549" class="Keyword">quote</a> <a id="4555" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a>  <a id="4570" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4572" href="Ledger.Conway.Specification.Epoch.html#4451" class="Function">HasCast-NewEpochState</a><a id="4593" class="Symbol">)</a><a id="4594" href="Data.List.Base.html#4907" class="Function Operator">]</a><a id="4595" class="Symbol">)</a>

<a id="toRwdAddr"></a><a id="4598" href="Ledger.Conway.Specification.Epoch.html#4598" class="Function">toRwdAddr</a> <a id="4608" class="Symbol">:</a> <a id="4610" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="4621" class="Symbol">→</a> <a id="4623" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
<a id="4631" href="Ledger.Conway.Specification.Epoch.html#4598" class="Function">toRwdAddr</a> <a id="4641" href="Ledger.Conway.Specification.Epoch.html#4641" class="Bound">x</a> <a id="4643" class="Symbol">=</a> <a id="4645" class="Keyword">record</a> <a id="4652" class="Symbol">{</a> <a id="4654" href="Ledger.Core.Specification.Address.html#1353" class="Field">net</a> <a id="4658" class="Symbol">=</a> <a id="4660" href="Ledger.Core.Specification.Epoch.html#2367" class="Function">NetworkId</a> <a id="4670" class="Symbol">;</a> <a id="4672" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="4678" class="Symbol">=</a> <a id="4680" href="Ledger.Conway.Specification.Epoch.html#4641" class="Bound">x</a> <a id="4682" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="4685" href="Ledger.Conway.Specification.Epoch.html#4685" class="Function">getStakeCred</a> <a id="4698" class="Symbol">:</a> <a id="4700" href="Ledger.Conway.Specification.Transaction.html#2630" class="Function">TxOut</a> <a id="4706" class="Symbol">→</a> <a id="4708" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4714" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a>
<a id="4725" href="Ledger.Conway.Specification.Epoch.html#4685" class="Function">getStakeCred</a> <a id="4738" class="Symbol">(</a><a id="4739" href="Ledger.Conway.Specification.Epoch.html#4739" class="Bound">a</a> <a id="4741" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4743" class="Symbol">_</a> <a id="4745" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4747" class="Symbol">_</a> <a id="4749" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4751" class="Symbol">_)</a> <a id="4754" class="Symbol">=</a> <a id="4756" href="Ledger.Core.Specification.Address.html#2496" class="Function">stakeCred</a> <a id="4766" href="Ledger.Conway.Specification.Epoch.html#4739" class="Bound">a</a>

<a id="4769" class="Keyword">open</a> <a id="4774" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Module">GovActionState</a> <a id="4789" class="Keyword">using</a> <a id="4795" class="Symbol">(</a><a id="4796" href="Ledger.Conway.Specification.Gov.Actions.html#2811" class="Field">returnAddr</a><a id="4806" class="Symbol">)</a>


<a id="createRUpd"></a><a id="4810" href="Ledger.Conway.Specification.Epoch.html#4810" class="Function">createRUpd</a> <a id="4821" class="Symbol">:</a> <a id="4823" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4825" class="Symbol">→</a> <a id="4827" href="Ledger.Conway.Specification.Rewards.html#4896" class="Function">BlocksMade</a> <a id="4838" class="Symbol">→</a> <a id="4840" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a> <a id="4851" class="Symbol">→</a> <a id="4853" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="4858" class="Symbol">→</a> <a id="4860" href="Ledger.Conway.Specification.Rewards.html#6281" class="Record">RewardUpdate</a>
<a id="4873" href="Ledger.Conway.Specification.Epoch.html#4810" class="Function">createRUpd</a> <a id="4884" href="Ledger.Conway.Specification.Epoch.html#4884" class="Bound">slotsPerEpoch</a> <a id="4898" href="Ledger.Conway.Specification.Epoch.html#4898" class="Bound">b</a> <a id="4900" href="Ledger.Conway.Specification.Epoch.html#4900" class="Bound">es</a> <a id="4903" href="Ledger.Conway.Specification.Epoch.html#4903" class="Bound">total</a> <a id="4909" class="Symbol">=</a>
  <a id="4913" class="Keyword">record</a>  <a id="4921" class="Symbol">{</a> <a id="4923" href="Ledger.Conway.Specification.Rewards.html#6318" class="Field">Δt</a> <a id="4926" class="Symbol">=</a> <a id="4928" href="Ledger.Conway.Specification.Epoch.html#5823" class="Function">Δt₁</a>
          <a id="4942" class="Symbol">;</a> <a id="4944" href="Ledger.Conway.Specification.Rewards.html#6321" class="Field">Δr</a> <a id="4947" class="Symbol">=</a> <a id="4949" class="Number">0</a> <a id="4951" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="4953" href="Ledger.Conway.Specification.Epoch.html#5668" class="Function">Δr₁</a> <a id="4957" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="4959" href="Ledger.Conway.Specification.Epoch.html#6024" class="Function">Δr₂</a>
          <a id="4973" class="Symbol">;</a> <a id="4975" href="Ledger.Conway.Specification.Rewards.html#6324" class="Field">Δf</a> <a id="4978" class="Symbol">=</a> <a id="4980" class="Number">0</a> <a id="4982" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="4984" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="4988" href="Ledger.Conway.Specification.Epoch.html#5284" class="Function">feeSS</a>
          <a id="5004" class="Symbol">;</a> <a id="5006" href="Ledger.Conway.Specification.Rewards.html#6344" class="Field">rs</a> <a id="5009" class="Symbol">=</a> <a id="5011" href="Ledger.Conway.Specification.Epoch.html#5941" class="Function">rs</a>


          <a id="5026" class="Symbol">;</a> <a id="5028" href="Ledger.Conway.Specification.Rewards.html#6374" class="Field">flowConservation</a> <a id="5045" class="Symbol">=</a> <a id="5047" href="Ledger.Conway.Specification.Epoch.html#6308" class="Function">flowConservation</a>
          <a id="5074" class="Symbol">;</a> <a id="5076" href="Ledger.Conway.Specification.Rewards.html#6437" class="Field">Δt-nonnegative</a> <a id="5091" class="Symbol">=</a> <a id="5093" href="Ledger.Conway.Specification.Epoch.html#7179" class="Function">Δt-nonneg</a>
          <a id="5113" class="Symbol">;</a> <a id="5115" href="Ledger.Conway.Specification.Rewards.html#6468" class="Field">Δf-nonpositive</a> <a id="5130" class="Symbol">=</a> <a id="5132" href="Ledger.Conway.Specification.Epoch.html#7353" class="Function">Δf-nonpos</a>


          <a id="5154" class="Symbol">}</a>
  <a id="5158" class="Keyword">where</a>
    <a id="5168" href="Ledger.Conway.Specification.Epoch.html#5168" class="Function">prevPp</a>       <a id="5181" class="Symbol">=</a> <a id="5183" href="Ledger.Conway.Specification.PParams.html#3764" class="Field">PParamsOf</a> <a id="5193" href="Ledger.Conway.Specification.Epoch.html#4900" class="Bound">es</a>
    <a id="5200" href="Ledger.Conway.Specification.Epoch.html#5200" class="Function">reserves</a>     <a id="5213" class="Symbol">=</a> <a id="5215" href="Ledger.Conway.Specification.PParams.html#972" class="Field">reservesOf</a> <a id="5226" href="Ledger.Conway.Specification.Epoch.html#4900" class="Bound">es</a>
    <a id="5233" href="Ledger.Conway.Specification.Epoch.html#5233" class="Function">pstakego</a>     <a id="5246" class="Symbol">=</a> <a id="5248" href="Ledger.Conway.Specification.Epoch.html#4900" class="Bound">es</a> <a id="5251" class="Symbol">.</a><a id="5252" href="Ledger.Conway.Specification.Epoch.html#1795" class="Field">EpochState.ss</a> <a id="5266" class="Symbol">.</a><a id="5267" href="Ledger.Conway.Specification.Rewards.html#7681" class="Field">Snapshots.go</a>
    <a id="5284" href="Ledger.Conway.Specification.Epoch.html#5284" class="Function">feeSS</a>        <a id="5297" class="Symbol">=</a> <a id="5299" href="Ledger.Conway.Specification.Epoch.html#4900" class="Bound">es</a> <a id="5302" class="Symbol">.</a><a id="5303" href="Ledger.Conway.Specification.Epoch.html#1795" class="Field">EpochState.ss</a> <a id="5317" class="Symbol">.</a><a id="5318" href="Ledger.Conway.Specification.Rewards.html#7700" class="Field">Snapshots.feeSS</a>
    <a id="5338" href="Ledger.Conway.Specification.Epoch.html#5338" class="Function">stake</a>        <a id="5351" class="Symbol">=</a> <a id="5353" href="Ledger.Conway.Specification.Epoch.html#5233" class="Function">pstakego</a> <a id="5362" class="Symbol">.</a><a id="5363" href="Ledger.Conway.Specification.Rewards.html#6537" class="Field">Snapshot.stake</a>
    <a id="5382" href="Ledger.Conway.Specification.Epoch.html#5382" class="Function">delegs</a>       <a id="5395" class="Symbol">=</a> <a id="5397" href="Ledger.Conway.Specification.Epoch.html#5233" class="Function">pstakego</a> <a id="5406" class="Symbol">.</a><a id="5407" href="Ledger.Conway.Specification.Rewards.html#6565" class="Field">Snapshot.delegations</a>
    <a id="5432" href="Ledger.Conway.Specification.Epoch.html#5432" class="Function">poolParams</a>   <a id="5445" class="Symbol">=</a> <a id="5447" href="Ledger.Conway.Specification.Epoch.html#5233" class="Function">pstakego</a> <a id="5456" class="Symbol">.</a><a id="5457" href="Ledger.Conway.Specification.Rewards.html#6599" class="Field">Snapshot.poolParameters</a>
    <a id="5485" href="Ledger.Conway.Specification.Epoch.html#5485" class="Function">blocksMade</a>   <a id="5498" class="Symbol">=</a> <a id="5500" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="5503" href="Ledger.Conway.Specification.Epoch.html#5503" class="Bound">m</a> <a id="5505" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="5507" href="Ledger.Conway.Specification.Epoch.html#4898" class="Bound">b</a> <a id="5509" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="5511" href="Ledger.Conway.Specification.Epoch.html#5503" class="Bound">m</a>
    <a id="5517" href="Ledger.Conway.Specification.Epoch.html#5517" class="Function">ρ</a>            <a id="5530" class="Symbol">=</a> <a id="5532" href="Ledger.Prelude.Numeric.UnitInterval.html#1988" class="Function">fromUnitInterval</a> <a id="5549" class="Symbol">(</a><a id="5550" href="Ledger.Conway.Specification.Epoch.html#5168" class="Function">prevPp</a> <a id="5557" class="Symbol">.</a><a id="5558" href="Ledger.Conway.Specification.PParams.html#2505" class="Field">PParams.monetaryExpansion</a><a id="5583" class="Symbol">)</a>
    <a id="5589" href="Ledger.Conway.Specification.Epoch.html#5589" class="Function">η</a>            <a id="5602" class="Symbol">=</a> <a id="5604" href="Ledger.Conway.Specification.Epoch.html#1093" class="Function">fromℕ</a> <a id="5610" href="Ledger.Conway.Specification.Epoch.html#5485" class="Function">blocksMade</a> <a id="5621" href="Ledger.Prelude.html#2015" class="Function Operator">÷₀</a> <a id="5624" class="Symbol">(</a><a id="5625" href="Ledger.Conway.Specification.Epoch.html#1093" class="Function">fromℕ</a> <a id="5631" href="Ledger.Conway.Specification.Epoch.html#4884" class="Bound">slotsPerEpoch</a> <a id="5645" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="5647" href="Ledger.Core.Specification.Epoch.html#2228" class="Function">ActiveSlotCoeff</a><a id="5662" class="Symbol">)</a>
    <a id="5668" href="Ledger.Conway.Specification.Epoch.html#5668" class="Function">Δr₁</a>          <a id="5681" class="Symbol">=</a> <a id="5683" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="5689" class="Symbol">(</a><a id="5690" class="Number">1</a> <a id="5692" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="5694" href="Ledger.Conway.Specification.Epoch.html#5589" class="Function">η</a> <a id="5696" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="5698" href="Ledger.Conway.Specification.Epoch.html#5517" class="Function">ρ</a> <a id="5700" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="5702" href="Ledger.Conway.Specification.Epoch.html#1093" class="Function">fromℕ</a> <a id="5708" href="Ledger.Conway.Specification.Epoch.html#5200" class="Function">reserves</a><a id="5716" class="Symbol">)</a>
    <a id="5722" href="Ledger.Conway.Specification.Epoch.html#5722" class="Function">rewardPot</a>    <a id="5735" class="Symbol">=</a> <a id="5737" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="5741" href="Ledger.Conway.Specification.Epoch.html#5284" class="Function">feeSS</a> <a id="5747" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5749" href="Ledger.Conway.Specification.Epoch.html#5668" class="Function">Δr₁</a>
    <a id="5757" href="Ledger.Conway.Specification.Epoch.html#5757" class="Function">τ</a>            <a id="5770" class="Symbol">=</a> <a id="5772" href="Ledger.Prelude.Numeric.UnitInterval.html#1988" class="Function">fromUnitInterval</a> <a id="5789" class="Symbol">(</a><a id="5790" href="Ledger.Conway.Specification.Epoch.html#5168" class="Function">prevPp</a> <a id="5797" class="Symbol">.</a><a id="5798" href="Ledger.Conway.Specification.PParams.html#2575" class="Field">PParams.treasuryCut</a><a id="5817" class="Symbol">)</a>
    <a id="5823" href="Ledger.Conway.Specification.Epoch.html#5823" class="Function">Δt₁</a>          <a id="5836" class="Symbol">=</a> <a id="5838" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="5844" class="Symbol">(</a><a id="5845" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="5851" href="Ledger.Conway.Specification.Epoch.html#5722" class="Function">rewardPot</a> <a id="5861" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="5863" href="Ledger.Conway.Specification.Epoch.html#5757" class="Function">τ</a><a id="5864" class="Symbol">)</a>
    <a id="5870" href="Ledger.Conway.Specification.Epoch.html#5870" class="Function">R</a>            <a id="5883" class="Symbol">=</a> <a id="5885" href="Ledger.Conway.Specification.Epoch.html#5722" class="Function">rewardPot</a> <a id="5895" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="5897" href="Ledger.Conway.Specification.Epoch.html#5823" class="Function">Δt₁</a>
    <a id="5905" href="Ledger.Conway.Specification.Epoch.html#5905" class="Function">circulation</a>  <a id="5918" class="Symbol">=</a> <a id="5920" href="Ledger.Conway.Specification.Epoch.html#4903" class="Bound">total</a> <a id="5926" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="5928" href="Ledger.Conway.Specification.Epoch.html#5200" class="Function">reserves</a>
    <a id="5941" href="Ledger.Conway.Specification.Epoch.html#5941" class="Function">rs</a>           <a id="5954" class="Symbol">=</a> <a id="5956" href="Ledger.Conway.Specification.Rewards.html#5387" class="Function">reward</a> <a id="5963" href="Ledger.Conway.Specification.Epoch.html#5168" class="Function">prevPp</a> <a id="5970" href="Ledger.Conway.Specification.Epoch.html#4898" class="Bound">b</a> <a id="5972" class="Symbol">(</a><a id="5973" href="Prelude.html#3279" class="Function">posPart</a> <a id="5981" href="Ledger.Conway.Specification.Epoch.html#5870" class="Function">R</a><a id="5982" class="Symbol">)</a> <a id="5984" href="Ledger.Conway.Specification.Epoch.html#5432" class="Function">poolParams</a> <a id="5995" href="Ledger.Conway.Specification.Epoch.html#5338" class="Function">stake</a> <a id="6001" href="Ledger.Conway.Specification.Epoch.html#5382" class="Function">delegs</a> <a id="6008" href="Ledger.Conway.Specification.Epoch.html#5905" class="Function">circulation</a>
    <a id="6024" href="Ledger.Conway.Specification.Epoch.html#6024" class="Function">Δr₂</a>          <a id="6037" class="Symbol">=</a> <a id="6039" href="Ledger.Conway.Specification.Epoch.html#5870" class="Function">R</a> <a id="6041" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="6043" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="6047" class="Symbol">(</a><a id="6048" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="6051" href="Ledger.Conway.Specification.Epoch.html#6051" class="Bound">c</a> <a id="6053" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="6055" href="Ledger.Conway.Specification.Epoch.html#5941" class="Function">rs</a> <a id="6058" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="6060" href="Ledger.Conway.Specification.Epoch.html#6051" class="Bound">c</a><a id="6061" class="Symbol">)</a>



    <a id="6070" class="Comment">-- Proofs</a>
    <a id="6084" class="Comment">-- Note: Overloading of + and - seems to interfere with</a>
    <a id="6144" class="Comment">-- the ring solver.</a>
    <a id="6168" href="Ledger.Conway.Specification.Epoch.html#6168" class="Function">lemmaFlow</a> <a id="6178" class="Symbol">:</a> <a id="6180" class="Symbol">∀</a> <a id="6182" class="Symbol">(</a><a id="6183" href="Ledger.Conway.Specification.Epoch.html#6183" class="Bound">t₁</a> <a id="6186" href="Ledger.Conway.Specification.Epoch.html#6186" class="Bound">r₁</a> <a id="6189" href="Ledger.Conway.Specification.Epoch.html#6189" class="Bound">f</a> <a id="6191" href="Ledger.Conway.Specification.Epoch.html#6191" class="Bound">z</a> <a id="6193" class="Symbol">:</a> <a id="6195" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="6196" class="Symbol">)</a>
      <a id="6204" class="Symbol">→</a> <a id="6206" class="Symbol">(</a><a id="6207" href="Ledger.Conway.Specification.Epoch.html#6183" class="Bound">t₁</a> <a id="6210" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="6214" class="Symbol">(</a><a id="6215" class="Number">0</a> <a id="6217" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="6221" href="Ledger.Conway.Specification.Epoch.html#6186" class="Bound">r₁</a> <a id="6224" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="6228" class="Symbol">((</a><a id="6230" href="Ledger.Conway.Specification.Epoch.html#6189" class="Bound">f</a> <a id="6232" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="6236" href="Ledger.Conway.Specification.Epoch.html#6186" class="Bound">r₁</a> <a id="6239" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="6243" href="Ledger.Conway.Specification.Epoch.html#6183" class="Bound">t₁</a><a id="6245" class="Symbol">)</a> <a id="6247" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="6251" href="Ledger.Conway.Specification.Epoch.html#6191" class="Bound">z</a><a id="6252" class="Symbol">))</a> <a id="6255" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="6259" class="Symbol">(</a><a id="6260" class="Number">0</a> <a id="6262" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="6266" href="Ledger.Conway.Specification.Epoch.html#6189" class="Bound">f</a><a id="6267" class="Symbol">)</a> <a id="6269" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="6273" href="Ledger.Conway.Specification.Epoch.html#6191" class="Bound">z</a><a id="6274" class="Symbol">)</a> <a id="6276" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6278" class="Number">0</a>
    <a id="6284" href="Ledger.Conway.Specification.Epoch.html#6168" class="Function">lemmaFlow</a> <a id="6294" class="Symbol">=</a> <a id="6296" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a>
    <a id="6308" href="Ledger.Conway.Specification.Epoch.html#6308" class="Function">flowConservation</a> <a id="6325" class="Symbol">=</a> <a id="6327" href="Ledger.Conway.Specification.Epoch.html#6168" class="Function">lemmaFlow</a> <a id="6337" href="Ledger.Conway.Specification.Epoch.html#5823" class="Function">Δt₁</a> <a id="6341" href="Ledger.Conway.Specification.Epoch.html#5668" class="Function">Δr₁</a> <a id="6345" class="Symbol">(</a><a id="6346" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="6350" href="Ledger.Conway.Specification.Epoch.html#5284" class="Function">feeSS</a><a id="6355" class="Symbol">)</a> <a id="6357" class="Symbol">(</a><a id="6358" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="6362" class="Symbol">(</a><a id="6363" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="6366" href="Ledger.Conway.Specification.Epoch.html#6366" class="Bound">c</a> <a id="6368" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="6370" href="Ledger.Conway.Specification.Epoch.html#5941" class="Function">rs</a> <a id="6373" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="6375" href="Ledger.Conway.Specification.Epoch.html#6366" class="Bound">c</a><a id="6376" class="Symbol">))</a>

    <a id="6384" href="Ledger.Conway.Specification.Epoch.html#6384" class="Function">÷₀-0≤⇒0≤</a> <a id="6393" class="Symbol">:</a> <a id="6395" class="Symbol">∀</a> <a id="6397" class="Symbol">(</a><a id="6398" href="Ledger.Conway.Specification.Epoch.html#6398" class="Bound">x</a> <a id="6400" href="Ledger.Conway.Specification.Epoch.html#6400" class="Bound">y</a> <a id="6402" class="Symbol">:</a> <a id="6404" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="6405" class="Symbol">)</a> <a id="6407" class="Symbol">→</a> <a id="6409" class="Number">0</a> <a id="6411" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="6413" href="Ledger.Conway.Specification.Epoch.html#6398" class="Bound">x</a> <a id="6415" class="Symbol">→</a> <a id="6417" class="Number">0</a> <a id="6419" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="6421" href="Ledger.Conway.Specification.Epoch.html#6400" class="Bound">y</a> <a id="6423" class="Symbol">→</a> <a id="6425" class="Number">0</a> <a id="6427" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="6429" class="Symbol">(</a><a id="6430" href="Ledger.Conway.Specification.Epoch.html#6398" class="Bound">x</a> <a id="6432" href="Ledger.Prelude.html#2015" class="Function Operator">÷₀</a> <a id="6435" href="Ledger.Conway.Specification.Epoch.html#6400" class="Bound">y</a><a id="6436" class="Symbol">)</a>
    <a id="6442" href="Ledger.Conway.Specification.Epoch.html#6384" class="Function">÷₀-0≤⇒0≤</a> <a id="6451" href="Ledger.Conway.Specification.Epoch.html#6451" class="Bound">x</a> <a id="6453" href="Ledger.Conway.Specification.Epoch.html#6453" class="Bound">y</a> <a id="6455" href="Ledger.Conway.Specification.Epoch.html#6455" class="Bound">0≤x</a> <a id="6459" href="Ledger.Conway.Specification.Epoch.html#6459" class="Bound">0≤y</a> <a id="6463" class="Keyword">with</a> <a id="6468" href="Ledger.Conway.Specification.Epoch.html#6453" class="Bound">y</a> <a id="6470" href="Data.Rational.Properties.html#4152" class="Function Operator">≟</a> <a id="6472" class="Number">0</a>
    <a id="6478" class="Symbol">...</a> <a id="6482" class="Symbol">|</a> <a id="6484" class="Symbol">(</a><a id="6485" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="6489" href="Ledger.Conway.Specification.Epoch.html#6489" class="Bound">y≡0</a><a id="6492" class="Symbol">)</a> <a id="6494" class="Symbol">=</a> <a id="6496" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="6510" class="Number">0</a>
    <a id="6516" class="Symbol">...</a> <a id="6520" class="Symbol">|</a> <a id="6522" class="Symbol">(</a><a id="6523" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="6526" href="Ledger.Conway.Specification.Epoch.html#6526" class="Bound">y≢0</a><a id="6529" class="Symbol">)</a>  <a id="6532" class="Symbol">=</a> <a id="6534" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a> <a id="6542" class="Bound">x</a> <a id="6544" class="Bound">y</a> <a id="6546" class="Symbol">{{</a><a id="6548" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a> <a id="6558" href="Ledger.Conway.Specification.Epoch.html#6526" class="Bound">y≢0</a><a id="6561" class="Symbol">}}</a> <a id="6564" class="Bound">0≤x</a> <a id="6568" class="Bound">0≤y</a>

    <a id="6577" href="Ledger.Conway.Specification.Epoch.html#6577" class="Function">η-nonneg</a> <a id="6586" class="Symbol">:</a> <a id="6588" class="Number">0</a> <a id="6590" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="6592" href="Ledger.Conway.Specification.Epoch.html#5589" class="Function">η</a>
    <a id="6598" href="Ledger.Conway.Specification.Epoch.html#6577" class="Function">η-nonneg</a> <a id="6607" class="Symbol">=</a> <a id="6609" href="Ledger.Conway.Specification.Epoch.html#6384" class="Function">÷₀-0≤⇒0≤</a> <a id="6618" class="Symbol">_</a> <a id="6620" class="Symbol">_</a> <a id="6622" class="Symbol">(</a><a id="6623" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="6632" href="Ledger.Conway.Specification.Epoch.html#5485" class="Function">blocksMade</a><a id="6642" class="Symbol">)</a>
      <a id="6650" class="Symbol">(</a><a id="6651" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="6659" class="Symbol">_</a> <a id="6661" class="Symbol">_</a>
        <a id="6671" class="Symbol">(</a><a id="6672" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="6681" href="Ledger.Conway.Specification.Epoch.html#4884" class="Bound">slotsPerEpoch</a><a id="6694" class="Symbol">)</a>
        <a id="6704" class="Symbol">(</a><a id="6705" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="6719" href="Ledger.Core.Specification.Epoch.html#2228" class="Function">ActiveSlotCoeff</a> <a id="6735" class="Symbol">{{</a><a id="6737" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a> <a id="6748" href="Ledger.Core.Specification.Epoch.html#2228" class="Function">ActiveSlotCoeff</a><a id="6763" class="Symbol">}}))</a>

    <a id="6773" href="Ledger.Conway.Specification.Epoch.html#6773" class="Function">min1η-nonneg</a> <a id="6786" class="Symbol">:</a> <a id="6788" class="Number">0</a> <a id="6790" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="6792" class="Number">1</a> <a id="6794" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="6796" href="Ledger.Conway.Specification.Epoch.html#5589" class="Function">η</a>
    <a id="6802" href="Ledger.Conway.Specification.Epoch.html#6773" class="Function">min1η-nonneg</a> <a id="6815" class="Symbol">=</a> <a id="6817" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a> <a id="6823" class="Symbol">(</a><a id="6824" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="6838" class="Number">1</a><a id="6839" class="Symbol">)</a> <a id="6841" href="Ledger.Conway.Specification.Epoch.html#6577" class="Function">η-nonneg</a>

    <a id="6855" href="Ledger.Conway.Specification.Epoch.html#6855" class="Function">Δr₁-nonneg</a> <a id="6866" class="Symbol">:</a> <a id="6868" class="Number">0</a> <a id="6870" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="6872" href="Ledger.Conway.Specification.Epoch.html#5668" class="Function">Δr₁</a>
    <a id="6880" href="Ledger.Conway.Specification.Epoch.html#6855" class="Function">Δr₁-nonneg</a> <a id="6891" class="Symbol">=</a> <a id="6893" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="6904" class="Symbol">_</a>
      <a id="6912" class="Symbol">(</a><a id="6913" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="6921" class="Symbol">(</a><a id="6922" class="Number">1</a> <a id="6924" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="6926" href="Ledger.Conway.Specification.Epoch.html#5589" class="Function">η</a> <a id="6928" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6930" href="Ledger.Conway.Specification.Epoch.html#5517" class="Function">ρ</a><a id="6931" class="Symbol">)</a> <a id="6933" class="Symbol">(</a><a id="6934" href="Ledger.Conway.Specification.Epoch.html#1093" class="Function">fromℕ</a> <a id="6940" href="Ledger.Conway.Specification.Epoch.html#5200" class="Function">reserves</a><a id="6948" class="Symbol">)</a>
        <a id="6958" class="Symbol">(</a><a id="6959" href="Ledger.Prelude.Numeric.UnitInterval.html#3336" class="Function">UnitInterval-*-0≤</a> <a id="6977" class="Symbol">(</a><a id="6978" class="Number">1</a> <a id="6980" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="6982" href="Ledger.Conway.Specification.Epoch.html#5589" class="Function">η</a><a id="6983" class="Symbol">)</a> <a id="6985" class="Symbol">(</a><a id="6986" href="Ledger.Conway.Specification.Epoch.html#5168" class="Function">prevPp</a> <a id="6993" class="Symbol">.</a><a id="6994" href="Ledger.Conway.Specification.PParams.html#2505" class="Field">PParams.monetaryExpansion</a><a id="7019" class="Symbol">)</a> <a id="7021" href="Ledger.Conway.Specification.Epoch.html#6773" class="Function">min1η-nonneg</a><a id="7033" class="Symbol">)</a>
        <a id="7043" class="Symbol">(</a><a id="7044" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="7053" href="Ledger.Conway.Specification.Epoch.html#5200" class="Function">reserves</a><a id="7061" class="Symbol">))</a>

    <a id="7069" href="Ledger.Conway.Specification.Epoch.html#7069" class="Function">rewardPot-nonneg</a> <a id="7086" class="Symbol">:</a> <a id="7088" class="Number">0</a> <a id="7090" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7092" href="Ledger.Conway.Specification.Epoch.html#5722" class="Function">rewardPot</a>
    <a id="7106" href="Ledger.Conway.Specification.Epoch.html#7069" class="Function">rewardPot-nonneg</a> <a id="7123" class="Symbol">=</a> <a id="7125" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a> <a id="7134" class="Symbol">(</a><a id="7135" href="Ledger.Conway.Specification.Epoch.html#272" class="Function">nonNegative⁻¹ℤ</a> <a id="7150" class="Symbol">(</a><a id="7151" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="7155" href="Ledger.Conway.Specification.Epoch.html#5284" class="Function">feeSS</a><a id="7160" class="Symbol">))</a> <a id="7163" href="Ledger.Conway.Specification.Epoch.html#6855" class="Function">Δr₁-nonneg</a>

    <a id="7179" href="Ledger.Conway.Specification.Epoch.html#7179" class="Function">Δt-nonneg</a> <a id="7189" class="Symbol">:</a> <a id="7191" class="Number">0</a> <a id="7193" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7195" href="Ledger.Conway.Specification.Epoch.html#5823" class="Function">Δt₁</a>
    <a id="7203" href="Ledger.Conway.Specification.Epoch.html#7179" class="Function">Δt-nonneg</a> <a id="7213" class="Symbol">=</a> <a id="7215" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="7226" class="Symbol">_</a>
      <a id="7234" class="Symbol">(</a><a id="7235" href="Ledger.Prelude.Numeric.UnitInterval.html#3336" class="Function">UnitInterval-*-0≤</a> <a id="7253" class="Symbol">(</a><a id="7254" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="7260" href="Ledger.Conway.Specification.Epoch.html#5722" class="Function">rewardPot</a><a id="7269" class="Symbol">)</a> <a id="7271" class="Symbol">(</a><a id="7272" href="Ledger.Conway.Specification.Epoch.html#5168" class="Function">prevPp</a> <a id="7279" class="Symbol">.</a><a id="7280" href="Ledger.Conway.Specification.PParams.html#2575" class="Field">PParams.treasuryCut</a><a id="7299" class="Symbol">)</a>
        <a id="7309" class="Symbol">(</a><a id="7310" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a> <a id="7319" href="Ledger.Conway.Specification.Epoch.html#5722" class="Function">rewardPot</a> <a id="7329" href="Ledger.Conway.Specification.Epoch.html#7069" class="Function">rewardPot-nonneg</a><a id="7345" class="Symbol">))</a>

    <a id="7353" href="Ledger.Conway.Specification.Epoch.html#7353" class="Function">Δf-nonpos</a> <a id="7363" class="Symbol">:</a> <a id="7365" class="Symbol">(</a><a id="7366" class="Number">0</a> <a id="7368" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="7370" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="7374" href="Ledger.Conway.Specification.Epoch.html#5284" class="Function">feeSS</a><a id="7379" class="Symbol">)</a> <a id="7381" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7383" class="Number">0</a>
    <a id="7389" href="Ledger.Conway.Specification.Epoch.html#7353" class="Function">Δf-nonpos</a> <a id="7399" class="Symbol">=</a> <a id="7401" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
        <a id="7415" class="Number">0</a> <a id="7417" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="7419" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="7423" href="Ledger.Conway.Specification.Epoch.html#5284" class="Function">feeSS</a> <a id="7429" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="7432" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a> <a id="7444" class="Symbol">_</a> <a id="7446" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
        <a id="7456" href="Data.Integer.Base.html#4719" class="Function Operator">ℤ.-</a> <a id="7460" href="Ledger.Conway.Specification.Epoch.html#76" class="InductiveConstructor">pos</a> <a id="7464" href="Ledger.Conway.Specification.Epoch.html#5284" class="Function">feeSS</a> <a id="7470" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="7473" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a> <a id="7484" class="Symbol">(</a><a id="7485" href="Data.Integer.Base.html#2106" class="InductiveConstructor">ℤ.+≤+</a> <a id="7491" href="Data.Nat.Base.html#1720" class="InductiveConstructor">z≤n</a><a id="7494" class="Symbol">)</a> <a id="7496" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
        <a id="7506" class="Number">0</a>             <a id="7520" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
      <a id="7528" class="Keyword">where</a> <a id="7534" class="Keyword">open</a> <a id="7539" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a>


<a id="applyRUpd"></a><a id="7553" href="Ledger.Conway.Specification.Epoch.html#7553" class="Function">applyRUpd</a> <a id="7563" class="Symbol">:</a> <a id="7565" href="Ledger.Conway.Specification.Rewards.html#6281" class="Record">RewardUpdate</a> <a id="7578" class="Symbol">→</a> <a id="7580" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a> <a id="7591" class="Symbol">→</a> <a id="7593" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
<a id="7604" href="Ledger.Conway.Specification.Epoch.html#7553" class="Function">applyRUpd</a> <a id="7614" href="Ledger.Conway.Specification.Epoch.html#7614" class="Bound">rewardUpdate</a>
  <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#7633}{\htmlId{7633}{\htmlClass{Bound}{\text{treasury}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7644}{\htmlId{7644}{\htmlClass{Bound}{\text{reserves}}}}\, \end{pmatrix}
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#7660}{\htmlId{7660}{\htmlClass{Bound}{\text{ss}}}}\,
  \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#7671}{\htmlId{7671}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7678}{\htmlId{7678}{\htmlClass{Bound}{\text{fees}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7685}{\htmlId{7685}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7696}{\htmlId{7696}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
    \\ \,\href{Ledger.Conway.Specification.Epoch.html#7715}{\htmlId{7715}{\htmlClass{Bound}{\text{govSt}}}}\,
    \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#7731}{\htmlId{7731}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7744}{\htmlId{7744}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7758}{\htmlId{7758}{\htmlClass{Bound}{\text{rewards}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#7771}{\htmlId{7771}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7780}{\htmlId{7780}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#7798}{\htmlId{7798}{\htmlClass{Bound}{\text{es}}}}\,
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#7805}{\htmlId{7805}{\htmlClass{Bound}{\text{fut}}}}\,
  \end{pmatrix}$</a> <a id="7815" class="Symbol">=</a>
  <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Prelude.html#3279}{\htmlId{7823}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{7831}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#76}{\htmlId{7832}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#7633}{\htmlId{7836}{\htmlClass{Bound}{\text{treasury}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{7845}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6318}{\htmlId{7847}{\htmlClass{Function}{\text{Δt}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{7850}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#76}{\htmlId{7852}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#8218}{\htmlId{7856}{\htmlClass{Function}{\text{unregRU&#39;}}}}\,\,\htmlId{7864}{\htmlClass{Symbol}{\text{)}}}\,
    \\ \,\href{Prelude.html#3279}{\htmlId{7872}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{7880}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#76}{\htmlId{7881}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#7644}{\htmlId{7885}{\htmlClass{Bound}{\text{reserves}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{7894}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6321}{\htmlId{7896}{\htmlClass{Function}{\text{Δr}}}}\,\,\htmlId{7898}{\htmlClass{Symbol}{\text{)}}}\, \end{pmatrix}
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#7660}{\htmlId{7906}{\htmlClass{Bound}{\text{ss}}}}\,
  \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#7671}{\htmlId{7917}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Prelude.html#3279}{\htmlId{7924}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{7932}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#76}{\htmlId{7933}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#7678}{\htmlId{7937}{\htmlClass{Bound}{\text{fees}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{7942}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6324}{\htmlId{7944}{\htmlClass{Function}{\text{Δf}}}}\,\,\htmlId{7946}{\htmlClass{Symbol}{\text{)}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7685}{\htmlId{7950}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7696}{\htmlId{7961}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
    \\ \,\href{Ledger.Conway.Specification.Epoch.html#7715}{\htmlId{7979}{\htmlClass{Bound}{\text{govSt}}}}\,
    \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#7731}{\htmlId{7995}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7744}{\htmlId{8008}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7758}{\htmlId{8022}{\htmlClass{Bound}{\text{rewards}}}}\, \,\href{Axiom.Set.Map.Dec.html#2046}{\htmlId{8030}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#8150}{\htmlId{8033}{\htmlClass{Function}{\text{regRU}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#7771}{\htmlId{8043}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#7780}{\htmlId{8052}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#7798}{\htmlId{8067}{\htmlClass{Bound}{\text{es}}}}\,
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#7805}{\htmlId{8074}{\htmlClass{Bound}{\text{fut}}}}\, \end{pmatrix}$</a>
  <a id="8082" class="Keyword">where</a>
    <a id="8092" class="Keyword">open</a> <a id="8097" href="Ledger.Conway.Specification.Rewards.html#6281" class="Module">RewardUpdate</a> <a id="8110" href="Ledger.Conway.Specification.Epoch.html#7614" class="Bound">rewardUpdate</a> <a id="8123" class="Keyword">using</a> <a id="8129" class="Symbol">(</a><a id="8130" href="Ledger.Conway.Specification.Rewards.html#6318" class="Field">Δt</a><a id="8132" class="Symbol">;</a> <a id="8134" href="Ledger.Conway.Specification.Rewards.html#6321" class="Field">Δr</a><a id="8136" class="Symbol">;</a> <a id="8138" href="Ledger.Conway.Specification.Rewards.html#6324" class="Field">Δf</a><a id="8140" class="Symbol">;</a> <a id="8142" href="Ledger.Conway.Specification.Rewards.html#6344" class="Field">rs</a><a id="8144" class="Symbol">)</a>
    <a id="8150" href="Ledger.Conway.Specification.Epoch.html#8150" class="Function">regRU</a>     <a id="8160" class="Symbol">=</a> <a id="8162" href="Ledger.Conway.Specification.Rewards.html#6344" class="Function">rs</a> <a id="8165" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="8167" href="Class.IsSet.html#916" class="Function">dom</a> <a id="8171" href="Ledger.Conway.Specification.Epoch.html#7758" class="Bound">rewards</a>
    <a id="8183" href="Ledger.Conway.Specification.Epoch.html#8183" class="Function">unregRU</a>   <a id="8193" class="Symbol">=</a> <a id="8195" href="Ledger.Conway.Specification.Rewards.html#6344" class="Function">rs</a> <a id="8198" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="8200" href="Class.IsSet.html#916" class="Function">dom</a> <a id="8204" href="Ledger.Conway.Specification.Epoch.html#7758" class="Bound">rewards</a> <a id="8212" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a>
    <a id="8218" href="Ledger.Conway.Specification.Epoch.html#8218" class="Function">unregRU&#39;</a>  <a id="8228" class="Symbol">=</a> <a id="8230" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="8233" href="Ledger.Conway.Specification.Epoch.html#8233" class="Bound">x</a> <a id="8235" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="8237" href="Ledger.Conway.Specification.Epoch.html#8183" class="Function">unregRU</a> <a id="8245" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="8247" href="Ledger.Conway.Specification.Epoch.html#8233" class="Bound">x</a>

<a id="getOrphans"></a><a id="8250" href="Ledger.Conway.Specification.Epoch.html#8250" class="Function">getOrphans</a> <a id="8261" class="Symbol">:</a> <a id="8263" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a> <a id="8274" class="Symbol">→</a> <a id="8276" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="8285" class="Symbol">→</a> <a id="8287" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
<a id="8296" href="Ledger.Conway.Specification.Epoch.html#8250" class="Function">getOrphans</a> <a id="8307" href="Ledger.Conway.Specification.Epoch.html#8307" class="Bound">es</a> <a id="8310" href="Ledger.Conway.Specification.Epoch.html#8310" class="Bound">govSt</a> <a id="8316" class="Symbol">=</a> <a id="8318" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="8324" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="8326" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a> <a id="8334" href="Ledger.Conway.Specification.Epoch.html#8379" class="Function">step</a> <a id="8339" class="Symbol">(</a><a id="8340" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8343" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8345" href="Ledger.Conway.Specification.Epoch.html#8310" class="Bound">govSt</a><a id="8350" class="Symbol">)</a> <a id="8352" class="Symbol">(</a><a id="8353" href="Data.List.Base.html#4746" class="Function">length</a> <a id="8360" href="Ledger.Conway.Specification.Epoch.html#8310" class="Bound">govSt</a><a id="8365" class="Symbol">)</a>
  <a id="8369" class="Keyword">where</a>
    <a id="8379" href="Ledger.Conway.Specification.Epoch.html#8379" class="Function">step</a> <a id="8384" class="Symbol">:</a> <a id="8386" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="8395" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="8397" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="8406" class="Symbol">→</a> <a id="8408" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="8417" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="8419" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
    <a id="8432" href="Ledger.Conway.Specification.Epoch.html#8379" class="Function">step</a> <a id="8437" class="Symbol">(</a><a id="8438" href="Ledger.Conway.Specification.Epoch.html#8438" class="Bound">orps</a> <a id="8443" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8445" href="Ledger.Conway.Specification.Epoch.html#8445" class="Bound">govSt</a><a id="8450" class="Symbol">)</a> <a id="8452" class="Symbol">=</a>
      <a id="8460" class="Keyword">let</a>
        <a id="8472" href="Ledger.Conway.Specification.Epoch.html#8472" class="Bound">isOrphan?</a> <a id="8482" href="Ledger.Conway.Specification.Epoch.html#8482" class="Bound">a</a> <a id="8484" href="Ledger.Conway.Specification.Epoch.html#8484" class="Bound">prev</a> <a id="8489" class="Symbol">=</a> <a id="8491" href="Relation.Nullary.Decidable.Core.html#3277" class="Function">¬?</a> <a id="8494" class="Symbol">(</a><a id="8495" href="Ledger.Conway.Specification.Gov.html#8819" class="Function">hasParent?</a> <a id="8506" href="Ledger.Conway.Specification.Epoch.html#8307" class="Bound">es</a> <a id="8509" href="Ledger.Conway.Specification.Epoch.html#8445" class="Bound">govSt</a> <a id="8515" href="Ledger.Conway.Specification.Epoch.html#8482" class="Bound">a</a> <a id="8517" href="Ledger.Conway.Specification.Epoch.html#8484" class="Bound">prev</a><a id="8521" class="Symbol">)</a>
        <a id="8531" class="Symbol">(</a><a id="8532" href="Ledger.Conway.Specification.Epoch.html#8532" class="Bound">orps&#39;</a> <a id="8538" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8540" href="Ledger.Conway.Specification.Epoch.html#8540" class="Bound">govSt&#39;</a><a id="8546" class="Symbol">)</a> <a id="8548" class="Symbol">=</a> <a id="8550" href="Data.List.Base.html#10628" class="Function">partition</a>
          <a id="8570" class="Symbol">(λ</a> <a id="8573" class="Symbol">(_</a> <a id="8576" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8578" class="Keyword">record</a> <a id="8585" class="Symbol">{</a><a id="8586" href="Ledger.Conway.Specification.Gov.Actions.html#2861" class="Field">action</a> <a id="8593" class="Symbol">=</a> <a id="8595" href="Ledger.Conway.Specification.Epoch.html#8595" class="Bound">a</a> <a id="8597" class="Symbol">;</a> <a id="8599" href="Ledger.Conway.Specification.Gov.Actions.html#2889" class="Field">prevAction</a> <a id="8610" class="Symbol">=</a> <a id="8612" href="Ledger.Conway.Specification.Epoch.html#8612" class="Bound">prev</a><a id="8616" class="Symbol">})</a> <a id="8619" class="Symbol">→</a> <a id="8621" href="Ledger.Conway.Specification.Epoch.html#8472" class="Bound">isOrphan?</a> <a id="8631" class="Symbol">(</a><a id="8632" href="Ledger.Conway.Specification.Epoch.html#8595" class="Bound">a</a> <a id="8634" class="Symbol">.</a><a id="8635" href="Ledger.Conway.Specification.Gov.Actions.html#1427" class="Field">gaType</a><a id="8641" class="Symbol">)</a> <a id="8643" href="Ledger.Conway.Specification.Epoch.html#8612" class="Bound">prev</a><a id="8647" class="Symbol">)</a> <a id="8649" href="Ledger.Conway.Specification.Epoch.html#8445" class="Bound">govSt</a>
      <a id="8661" class="Keyword">in</a>
        <a id="8672" class="Symbol">(</a><a id="8673" href="Ledger.Conway.Specification.Epoch.html#8438" class="Bound">orps</a> <a id="8678" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="8681" href="Ledger.Conway.Specification.Epoch.html#8532" class="Bound">orps&#39;</a> <a id="8687" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8689" href="Ledger.Conway.Specification.Epoch.html#8540" class="Bound">govSt&#39;</a><a id="8695" class="Symbol">)</a>


<a id="8699" class="Keyword">open</a> <a id="8704" href="Ledger.Core.Specification.Address.html#1324" class="Module">RwdAddr</a> <a id="8712" class="Keyword">using</a> <a id="8718" class="Symbol">(</a><a id="8719" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a><a id="8724" class="Symbol">)</a>


<a id="gaDepositStake"></a><a id="8728" href="Ledger.Conway.Specification.Epoch.html#8728" class="Function">gaDepositStake</a> <a id="8743" class="Symbol">:</a> <a id="8745" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="8754" class="Symbol">→</a> <a id="8756" href="Ledger.Conway.Specification.Certs.html#590" class="Function">Deposits</a> <a id="8765" class="Symbol">→</a> <a id="8767" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="8778" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="8780" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="8785" href="Ledger.Conway.Specification.Epoch.html#8728" class="Function">gaDepositStake</a> <a id="8800" href="Ledger.Conway.Specification.Epoch.html#8800" class="Bound">govSt</a> <a id="8806" href="Ledger.Conway.Specification.Epoch.html#8806" class="Bound">ds</a> <a id="8809" class="Symbol">=</a> <a id="8811" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a>
  <a id="8825" class="Symbol">(</a><a id="8826" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="8831" class="Symbol">(λ</a> <a id="8834" class="Symbol">(</a><a id="8835" href="Ledger.Conway.Specification.Epoch.html#8835" class="Bound">gaid</a> <a id="8840" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8842" href="Ledger.Conway.Specification.Epoch.html#8842" class="Bound">addr</a><a id="8846" class="Symbol">)</a> <a id="8848" class="Symbol">→</a> <a id="8850" class="Symbol">(</a><a id="8851" href="Ledger.Conway.Specification.Epoch.html#8835" class="Bound">gaid</a> <a id="8856" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8858" href="Ledger.Conway.Specification.Epoch.html#8842" class="Bound">addr</a><a id="8862" class="Symbol">)</a> <a id="8864" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8866" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="8872" href="Ledger.Conway.Specification.Epoch.html#8842" class="Bound">addr</a><a id="8876" class="Symbol">)</a> <a id="8878" href="Ledger.Conway.Specification.Epoch.html#8976" class="Function">govSt&#39;</a><a id="8884" class="Symbol">)</a>
  <a id="8888" class="Symbol">(</a><a id="8889" href="Axiom.Set.Map.html#10460" class="Function">mapFromPartialFun</a> <a id="8907" class="Symbol">(λ</a> <a id="8910" class="Symbol">(</a><a id="8911" href="Ledger.Conway.Specification.Epoch.html#8911" class="Bound">gaid</a> <a id="8916" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8918" class="Symbol">_)</a> <a id="8921" class="Symbol">→</a> <a id="8923" href="Axiom.Set.Map.html#13828" class="Function">lookupᵐ?</a> <a id="8932" href="Ledger.Conway.Specification.Epoch.html#8806" class="Bound">ds</a> <a id="8935" class="Symbol">(</a><a id="8936" href="Ledger.Conway.Specification.Certs.html#538" class="InductiveConstructor">GovActionDeposit</a> <a id="8953" href="Ledger.Conway.Specification.Epoch.html#8911" class="Bound">gaid</a><a id="8957" class="Symbol">))</a> <a id="8960" href="Ledger.Conway.Specification.Epoch.html#8976" class="Function">govSt&#39;</a><a id="8966" class="Symbol">)</a>
  <a id="8970" class="Keyword">where</a> <a id="8976" href="Ledger.Conway.Specification.Epoch.html#8976" class="Function">govSt&#39;</a> <a id="8983" class="Symbol">=</a> <a id="8985" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="8990" class="Symbol">(</a><a id="8991" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="8996" href="Ledger.Conway.Specification.Gov.Actions.html#2811" class="Field">returnAddr</a><a id="9006" class="Symbol">)</a> <a id="9008" class="Symbol">(</a><a id="9009" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="9018" href="Ledger.Conway.Specification.Epoch.html#8800" class="Bound">govSt</a><a id="9023" class="Symbol">)</a>



<a id="9028" class="Keyword">opaque</a>


  <a id="mkStakeDistrs"></a><a id="9039" href="Ledger.Conway.Specification.Epoch.html#9039" class="Function">mkStakeDistrs</a> <a id="9053" class="Symbol">:</a> <a id="9055" href="Ledger.Conway.Specification.Rewards.html#6504" class="Record">Snapshot</a> <a id="9064" class="Symbol">→</a> <a id="9066" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="9075" class="Symbol">→</a> <a id="9077" href="Ledger.Conway.Specification.Certs.html#590" class="Function">Deposits</a> <a id="9086" class="Symbol">→</a> <a id="9088" class="Symbol">(</a><a id="9089" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="9100" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="9102" href="Ledger.Conway.Specification.Gov.Actions.html#452" class="Datatype">VDeleg</a><a id="9108" class="Symbol">)</a> <a id="9110" class="Symbol">→</a> <a id="9112" href="Ledger.Conway.Specification.Ratify.html#3013" class="Record">StakeDistrs</a>
  <a id="9126" href="Ledger.Conway.Specification.Epoch.html#9039" class="Function">mkStakeDistrs</a> <a id="9140" href="Ledger.Conway.Specification.Epoch.html#9140" class="Bound">ss</a> <a id="9143" href="Ledger.Conway.Specification.Epoch.html#9143" class="Bound">govSt</a> <a id="9149" href="Ledger.Conway.Specification.Epoch.html#9149" class="Bound">ds</a> <a id="9152" href="Ledger.Conway.Specification.Epoch.html#9152" class="Bound">delegations</a> <a id="9164" class="Symbol">.</a><a id="9165" href="Ledger.Conway.Specification.Ratify.html#3050" class="Field">StakeDistrs.stakeDistr</a> <a id="9188" class="Symbol">=</a>
    <a id="9194" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a> <a id="9206" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="9208" href="Ledger.Conway.Specification.Epoch.html#9152" class="Bound">delegations</a> <a id="9220" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="9222" class="Symbol">(</a><a id="9223" href="Ledger.Conway.Specification.Rewards.html#6537" class="Field">Snapshot.stake</a> <a id="9238" href="Ledger.Conway.Specification.Epoch.html#9140" class="Bound">ss</a> <a id="9241" href="Axiom.Set.Map.Dec.html#2046" class="Function Operator">∪⁺</a> <a id="9244" href="Ledger.Conway.Specification.Epoch.html#8728" class="Function">gaDepositStake</a> <a id="9259" href="Ledger.Conway.Specification.Epoch.html#9143" class="Bound">govSt</a> <a id="9265" href="Ledger.Conway.Specification.Epoch.html#9149" class="Bound">ds</a><a id="9267" class="Symbol">)</a>


<a id="9271" class="Keyword">private</a> <a id="9279" class="Keyword">variable</a>
  <a id="9290" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="9292" href="Ledger.Conway.Specification.Epoch.html#9292" class="Generalizable">lastEpoch</a> <a id="9302" class="Symbol">:</a> <a id="9304" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
  <a id="9312" href="Ledger.Conway.Specification.Epoch.html#9312" class="Generalizable">fut</a> <a id="9316" href="Ledger.Conway.Specification.Epoch.html#9316" class="Generalizable">fut&#39;</a> <a id="9321" class="Symbol">:</a> <a id="9323" href="Ledger.Conway.Specification.Ratify.html#3383" class="Record">RatifyState</a>
  <a id="9337" href="Ledger.Conway.Specification.Epoch.html#9337" class="Generalizable">poolReapState</a> <a id="9351" class="Symbol">:</a> <a id="9353" href="Ledger.Conway.Specification.PoolReap.html#404" class="Record">PoolReapState</a>
  <a id="9369" href="Ledger.Conway.Specification.Epoch.html#9369" class="Generalizable">eps</a> <a id="9373" href="Ledger.Conway.Specification.Epoch.html#9373" class="Generalizable">eps&#39;</a> <a id="9378" href="Ledger.Conway.Specification.Epoch.html#9378" class="Generalizable">eps&#39;&#39;</a> <a id="9384" class="Symbol">:</a> <a id="9386" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a>
  <a id="9399" href="Ledger.Conway.Specification.Epoch.html#9399" class="Generalizable">ls</a> <a id="9402" class="Symbol">:</a> <a id="9404" href="Ledger.Conway.Specification.Ledger.html#977" class="Record">LState</a>
  <a id="9413" href="Ledger.Conway.Specification.Epoch.html#9413" class="Generalizable">es₀</a> <a id="9417" class="Symbol">:</a> <a id="9419" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
  <a id="9432" href="Ledger.Conway.Specification.Epoch.html#9432" class="Generalizable">mark</a> <a id="9437" href="Ledger.Conway.Specification.Epoch.html#9437" class="Generalizable">set</a> <a id="9441" href="Ledger.Conway.Specification.Epoch.html#9441" class="Generalizable">go</a> <a id="9444" class="Symbol">:</a> <a id="9446" href="Ledger.Conway.Specification.Rewards.html#6504" class="Record">Snapshot</a>
  <a id="9457" href="Ledger.Conway.Specification.Epoch.html#9457" class="Generalizable">feeSS</a> <a id="9463" class="Symbol">:</a> <a id="9465" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="9472" href="Ledger.Conway.Specification.Epoch.html#9472" class="Generalizable">lstate</a> <a id="9479" class="Symbol">:</a> <a id="9481" href="Ledger.Conway.Specification.Ledger.html#977" class="Record">LState</a>
  <a id="9490" href="Ledger.Conway.Specification.Epoch.html#9490" class="Generalizable">ss</a> <a id="9493" href="Ledger.Conway.Specification.Epoch.html#9493" class="Generalizable">ss&#39;</a> <a id="9497" class="Symbol">:</a> <a id="9499" href="Ledger.Conway.Specification.Rewards.html#7638" class="Record">Snapshots</a>
  <a id="9511" href="Ledger.Conway.Specification.Epoch.html#9511" class="Generalizable">ru</a> <a id="9514" class="Symbol">:</a> <a id="9516" href="Ledger.Conway.Specification.Rewards.html#6281" class="Record">RewardUpdate</a>
  <a id="9531" href="Ledger.Conway.Specification.Epoch.html#9531" class="Generalizable">mru</a> <a id="9535" class="Symbol">:</a> <a id="9537" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="9543" href="Ledger.Conway.Specification.Rewards.html#6281" class="Record">RewardUpdate</a>
  <a id="9558" href="Ledger.Conway.Specification.Epoch.html#9558" class="Generalizable">pd</a> <a id="9561" class="Symbol">:</a> <a id="9563" href="Ledger.Conway.Specification.Epoch.html#2711" class="Function">PoolDelegatedStake</a>


<a id="9584" class="Keyword">record</a> <a id="EPOCH-Updates0"></a><a id="9591" href="Ledger.Conway.Specification.Epoch.html#9591" class="Record">EPOCH-Updates0</a> <a id="9606" class="Symbol">:</a> <a id="9608" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="9613" class="Keyword">where</a>
  <a id="9621" class="Keyword">constructor</a> <a id="EPOCHUpdates0"></a><a id="9633" href="Ledger.Conway.Specification.Epoch.html#9633" class="InductiveConstructor">EPOCHUpdates0</a>
  <a id="9649" class="Keyword">field</a>
    <a id="EPOCH-Updates0.es"></a><a id="9659" href="Ledger.Conway.Specification.Epoch.html#9659" class="Field">es</a>             <a id="9674" class="Symbol">:</a> <a id="9676" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
    <a id="EPOCH-Updates0.govSt&#39;"></a><a id="9691" href="Ledger.Conway.Specification.Epoch.html#9691" class="Field">govSt&#39;</a>         <a id="9706" class="Symbol">:</a> <a id="9708" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9713" class="Symbol">(</a><a id="9714" href="Ledger.Conway.Specification.Gov.Actions.html#422" class="Function">GovActionID</a> <a id="9726" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="9728" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Record">GovActionState</a><a id="9742" class="Symbol">)</a>
    <a id="EPOCH-Updates0.payout"></a><a id="9748" href="Ledger.Conway.Specification.Epoch.html#9748" class="Field">payout</a>         <a id="9763" class="Symbol">:</a> <a id="9765" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="9773" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="9775" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="EPOCH-Updates0.gState&#39;"></a><a id="9784" href="Ledger.Conway.Specification.Epoch.html#9784" class="Field">gState&#39;</a>        <a id="9799" class="Symbol">:</a> <a id="9801" href="Ledger.Conway.Specification.Certs.html#4029" class="Record">GState</a>
    <a id="EPOCH-Updates0.utxoSt&#39;"></a><a id="9812" href="Ledger.Conway.Specification.Epoch.html#9812" class="Field">utxoSt&#39;</a>        <a id="9827" class="Symbol">:</a> <a id="9829" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a>
    <a id="EPOCH-Updates0.totWithdrawals"></a><a id="9843" href="Ledger.Conway.Specification.Epoch.html#9843" class="Field">totWithdrawals</a> <a id="9858" class="Symbol">:</a> <a id="9860" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

<a id="EPOCH-updates0"></a><a id="9866" href="Ledger.Conway.Specification.Epoch.html#9866" class="Function">EPOCH-updates0</a> <a id="9881" class="Symbol">:</a> <a id="9883" href="Ledger.Conway.Specification.Ratify.html#3383" class="Record">RatifyState</a> <a id="9895" class="Symbol">→</a> <a id="9897" href="Ledger.Conway.Specification.Ledger.html#977" class="Record">LState</a> <a id="9904" class="Symbol">→</a> <a id="9906" href="Ledger.Conway.Specification.Epoch.html#9591" class="Record">EPOCH-Updates0</a>
<a id="9921" href="Ledger.Conway.Specification.Epoch.html#9866" class="Function">EPOCH-updates0</a> <a id="9936" href="Ledger.Conway.Specification.Epoch.html#9936" class="Bound">fut</a> <a id="9940" href="Ledger.Conway.Specification.Epoch.html#9940" class="Bound">ls</a> <a id="9943" class="Symbol">=</a>
    <a id="9949" href="Ledger.Conway.Specification.Epoch.html#9633" class="InductiveConstructor">EPOCHUpdates0</a> <a id="9963" href="Ledger.Conway.Specification.Epoch.html#10132" class="Function">es</a> <a id="9966" href="Ledger.Conway.Specification.Epoch.html#10462" class="Function">govSt&#39;</a> <a id="9973" href="Ledger.Conway.Specification.Epoch.html#11030" class="Function">payout</a> <a id="9980" href="Ledger.Conway.Specification.Epoch.html#11106" class="Function">gState&#39;</a> <a id="9988" href="Ledger.Conway.Specification.Epoch.html#11295" class="Function">utxoSt&#39;</a> <a id="9996" href="Ledger.Conway.Specification.Epoch.html#11458" class="Function">totWithdrawals</a>
  <a id="10013" class="Keyword">where</a>
    <a id="10023" class="Keyword">open</a> <a id="10028" href="Ledger.Conway.Specification.Ledger.html#977" class="Module">LState</a> <a id="10035" href="Ledger.Conway.Specification.Epoch.html#9940" class="Bound">ls</a> <a id="10038" class="Keyword">public</a>
    <a id="10049" class="Keyword">open</a> <a id="10054" href="Ledger.Conway.Specification.Certs.html#4359" class="Module">CertState</a> <a id="10064" href="Ledger.Conway.Specification.Ledger.html#1089" class="Field">certState</a> <a id="10074" class="Keyword">public</a>
    <a id="10085" class="Keyword">open</a> <a id="10090" href="Ledger.Conway.Specification.Ratify.html#3383" class="Module">RatifyState</a> <a id="10102" href="Ledger.Conway.Specification.Epoch.html#9936" class="Bound">fut</a> <a id="10106" class="Keyword">renaming</a> <a id="10115" class="Symbol">(</a><a id="10116" href="Ledger.Conway.Specification.Ratify.html#3420" class="Field">es</a> <a id="10119" class="Symbol">to</a> <a id="10122" class="Field">esW</a><a id="10125" class="Symbol">)</a>

    <a id="10132" href="Ledger.Conway.Specification.Epoch.html#10132" class="Function">es</a> <a id="10135" class="Symbol">:</a> <a id="10137" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
    <a id="10152" href="Ledger.Conway.Specification.Epoch.html#10132" class="Function">es</a> <a id="10155" class="Symbol">=</a> <a id="10157" class="Keyword">record</a> <a id="10164" href="Ledger.Conway.Specification.Epoch.html#10122" class="Function">esW</a> <a id="10168" class="Symbol">{</a> <a id="10170" href="Ledger.Conway.Specification.Enact.html#696" class="Field">withdrawals</a> <a id="10182" class="Symbol">=</a> <a id="10184" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="10186" class="Symbol">}</a>

    <a id="10193" href="Ledger.Conway.Specification.Epoch.html#10193" class="Function">tmpGovSt</a> <a id="10202" class="Symbol">:</a> <a id="10204" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
    <a id="10217" href="Ledger.Conway.Specification.Epoch.html#10193" class="Function">tmpGovSt</a> <a id="10226" class="Symbol">=</a> <a id="10228" href="Ledger.Prelude.html#2402" class="Function">filter</a> <a id="10235" class="Symbol">(λ</a> <a id="10238" href="Ledger.Conway.Specification.Epoch.html#10238" class="Bound">x</a> <a id="10240" class="Symbol">→</a> <a id="10242" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="10248" href="Ledger.Conway.Specification.Epoch.html#10238" class="Bound">x</a> <a id="10250" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="10252" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10257" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="10263" href="Ledger.Conway.Specification.Ratify.html#3453" class="Function">removed</a><a id="10270" class="Symbol">)</a> <a id="10272" href="Ledger.Conway.Specification.Ledger.html#1063" class="Field">govSt</a>

    <a id="10283" href="Ledger.Conway.Specification.Epoch.html#10283" class="Function">orphans</a> <a id="10291" class="Symbol">:</a> <a id="10293" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="10295" class="Symbol">(</a><a id="10296" href="Ledger.Conway.Specification.Gov.Actions.html#422" class="Function">GovActionID</a> <a id="10308" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10310" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Record">GovActionState</a><a id="10324" class="Symbol">)</a>
    <a id="10330" href="Ledger.Conway.Specification.Epoch.html#10283" class="Function">orphans</a>  <a id="10339" class="Symbol">=</a> <a id="10341" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="10350" class="Symbol">(</a><a id="10351" href="Ledger.Conway.Specification.Epoch.html#8250" class="Function">getOrphans</a> <a id="10362" href="Ledger.Conway.Specification.Epoch.html#10132" class="Function">es</a> <a id="10365" href="Ledger.Conway.Specification.Epoch.html#10193" class="Function">tmpGovSt</a><a id="10373" class="Symbol">)</a>

    <a id="10380" href="Ledger.Conway.Specification.Epoch.html#10380" class="Function">removed&#39;</a> <a id="10389" class="Symbol">:</a> <a id="10391" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="10393" class="Symbol">(</a><a id="10394" href="Ledger.Conway.Specification.Gov.Actions.html#422" class="Function">GovActionID</a> <a id="10406" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10408" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Record">GovActionState</a><a id="10422" class="Symbol">)</a>
    <a id="10428" href="Ledger.Conway.Specification.Epoch.html#10380" class="Function">removed&#39;</a> <a id="10437" class="Symbol">=</a> <a id="10439" href="Ledger.Conway.Specification.Ratify.html#3453" class="Function">removed</a> <a id="10447" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="10449" href="Ledger.Conway.Specification.Epoch.html#10283" class="Function">orphans</a>

    <a id="10462" href="Ledger.Conway.Specification.Epoch.html#10462" class="Function">govSt&#39;</a> <a id="10469" class="Symbol">:</a> <a id="10471" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="10476" class="Symbol">(</a><a id="10477" href="Ledger.Conway.Specification.Gov.Actions.html#422" class="Function">GovActionID</a> <a id="10489" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10491" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Record">GovActionState</a><a id="10505" class="Symbol">)</a>
    <a id="10511" href="Ledger.Conway.Specification.Epoch.html#10462" class="Function">govSt&#39;</a> <a id="10518" class="Symbol">=</a> <a id="10520" href="Ledger.Prelude.html#2402" class="Function">filter</a> <a id="10527" class="Symbol">(λ</a> <a id="10530" href="Ledger.Conway.Specification.Epoch.html#10530" class="Bound">x</a> <a id="10532" class="Symbol">→</a> <a id="10534" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="10540" href="Ledger.Conway.Specification.Epoch.html#10530" class="Bound">x</a> <a id="10542" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="10544" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10549" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="10555" href="Ledger.Conway.Specification.Epoch.html#10380" class="Function">removed&#39;</a><a id="10563" class="Symbol">)</a> <a id="10565" href="Ledger.Conway.Specification.Ledger.html#1063" class="Field">govSt</a>

    <a id="10576" href="Ledger.Conway.Specification.Epoch.html#10576" class="Function">removedGovActions</a> <a id="10594" class="Symbol">:</a> <a id="10596" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="10598" class="Symbol">(</a><a id="10599" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="10607" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10609" href="Ledger.Conway.Specification.Certs.html#349" class="Datatype">DepositPurpose</a> <a id="10624" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10626" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a><a id="10630" class="Symbol">)</a>
    <a id="10636" href="Ledger.Conway.Specification.Epoch.html#10576" class="Function">removedGovActions</a> <a id="10654" class="Symbol">=</a>
      <a id="10662" href="Function.Base.html#1657" class="Function">flip</a> <a id="10667" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a> <a id="10678" href="Ledger.Conway.Specification.Epoch.html#10380" class="Function">removed&#39;</a> <a id="10687" class="Symbol">λ</a> <a id="10689" class="Symbol">(</a><a id="10690" href="Ledger.Conway.Specification.Epoch.html#10690" class="Bound">gaid</a> <a id="10695" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10697" href="Ledger.Conway.Specification.Epoch.html#10697" class="Bound">gaSt</a><a id="10701" class="Symbol">)</a> <a id="10703" class="Symbol">→</a>
        <a id="10713" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
          <a id="10728" class="Symbol">(</a><a id="10729" href="Ledger.Conway.Specification.Gov.Actions.html#2811" class="Field">returnAddr</a> <a id="10740" href="Ledger.Conway.Specification.Epoch.html#10697" class="Bound">gaSt</a> <a id="10745" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="10747" class="Symbol">)</a>
          <a id="10759" class="Symbol">((</a><a id="10761" href="Ledger.Conway.Specification.Certs.html#746" class="Field">DepositsOf</a> <a id="10772" href="Ledger.Conway.Specification.Ledger.html#1036" class="Field">utxoSt</a> <a id="10779" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="10781" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="10783" href="Ledger.Conway.Specification.Certs.html#538" class="InductiveConstructor">GovActionDeposit</a> <a id="10800" href="Ledger.Conway.Specification.Epoch.html#10690" class="Bound">gaid</a> <a id="10805" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="10806" class="Symbol">)</a> <a id="10808" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10809" class="Symbol">)</a>

    <a id="10816" href="Ledger.Conway.Specification.Epoch.html#10816" class="Function">govActionReturns</a> <a id="10833" class="Symbol">:</a> <a id="10835" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="10843" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="10845" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="10854" href="Ledger.Conway.Specification.Epoch.html#10816" class="Function">govActionReturns</a> <a id="10871" class="Symbol">=</a>
      <a id="10879" href="Axiom.Set.Map.Dec.html#2124" class="Function">aggregate₊</a> <a id="10890" class="Symbol">(</a><a id="10891" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10896" class="Symbol">(λ</a> <a id="10899" class="Symbol">(</a><a id="10900" href="Ledger.Conway.Specification.Epoch.html#10900" class="Bound">a</a> <a id="10902" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10904" class="Symbol">_</a> <a id="10906" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10908" href="Ledger.Conway.Specification.Epoch.html#10908" class="Bound">d</a><a id="10909" class="Symbol">)</a> <a id="10911" class="Symbol">→</a> <a id="10913" href="Ledger.Conway.Specification.Epoch.html#10900" class="Bound">a</a> <a id="10915" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10917" href="Ledger.Conway.Specification.Epoch.html#10908" class="Bound">d</a><a id="10918" class="Symbol">)</a> <a id="10920" href="Ledger.Conway.Specification.Epoch.html#10576" class="Function">removedGovActions</a> <a id="10938" href="abstract-set-theory.FiniteSetTheory.html#2767" class="Function Operator">ᶠˢ</a><a id="10940" class="Symbol">)</a>

    <a id="10947" href="Ledger.Conway.Specification.Epoch.html#10947" class="Function">trWithdrawals</a> <a id="10961" class="Symbol">:</a> <a id="10963" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="10971" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="10973" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="10982" href="Ledger.Conway.Specification.Epoch.html#10947" class="Function">trWithdrawals</a> <a id="10996" class="Symbol">=</a> <a id="10998" href="Ledger.Conway.Specification.Enact.html#696" class="Field">EnactState.withdrawals</a> <a id="11021" href="Ledger.Conway.Specification.Epoch.html#10122" class="Function">esW</a>

    <a id="11030" href="Ledger.Conway.Specification.Epoch.html#11030" class="Function">payout</a> <a id="11037" class="Symbol">:</a> <a id="11039" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a> <a id="11047" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11049" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="11058" href="Ledger.Conway.Specification.Epoch.html#11030" class="Function">payout</a> <a id="11065" class="Symbol">=</a> <a id="11067" href="Ledger.Conway.Specification.Epoch.html#10816" class="Function">govActionReturns</a> <a id="11084" href="Axiom.Set.Map.Dec.html#2046" class="Function Operator">∪⁺</a> <a id="11087" href="Ledger.Conway.Specification.Epoch.html#10947" class="Function">trWithdrawals</a>

    <a id="11106" href="Ledger.Conway.Specification.Epoch.html#11106" class="Function">gState&#39;</a> <a id="11114" class="Symbol">:</a> <a id="11116" href="Ledger.Conway.Specification.Certs.html#4029" class="Record">GState</a>
    <a id="11127" href="Ledger.Conway.Specification.Epoch.html#11106" class="Function">gState&#39;</a> <a id="11135" class="Symbol">=</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{11145}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Class.ToBool.html#342}{\htmlId{11146}{\htmlClass{Function Operator}{\text{if}}}}\, \,\href{Data.List.Base.html#4681}{\htmlId{11149}{\htmlClass{Function}{\text{null}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#10462}{\htmlId{11154}{\htmlClass{Function}{\text{govSt&#39;}}}}\, \,\href{Class.ToBool.html#342}{\htmlId{11161}{\htmlClass{Function Operator}{\text{then}}}}\, \,\href{Axiom.Set.Map.html#6068}{\htmlId{11166}{\htmlClass{Function}{\text{mapValues}}}}\, \,\htmlId{11176}{\htmlClass{Symbol}{\text{(}}}\,\,\htmlId{11177}{\htmlClass{Number}{\text{1}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{11179}{\htmlClass{Field Operator}{\text{+\_}}}}\,\,\htmlId{11181}{\htmlClass{Symbol}{\text{)}}}\, \,\htmlId{11183}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Certs.html#972}{\htmlId{11184}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4462}{\htmlId{11192}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{11198}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Class.ToBool.html#342}{\htmlId{11200}{\htmlClass{Function Operator}{\text{else}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#972}{\htmlId{11205}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4462}{\htmlId{11213}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{11219}{\htmlClass{Symbol}{\text{)}}}\,
      \\ \,\href{Ledger.Conway.Specification.Certs.html#4109}{\htmlId{11229}{\htmlClass{Field}{\text{GState.ccHotKeys}}}}\, \,\href{Ledger.Conway.Specification.Certs.html#4462}{\htmlId{11246}{\htmlClass{Function}{\text{gState}}}}\, \,\href{Axiom.Set.Map.html#10678}{\htmlId{11253}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Specification.Enact.html#1241}{\htmlId{11255}{\htmlClass{Function}{\text{ccCreds}}}}\, \,\htmlId{11263}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Enact.html#480}{\htmlId{11264}{\htmlClass{Field}{\text{EnactState.cc}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#10132}{\htmlId{11278}{\htmlClass{Function}{\text{es}}}}\,\,\htmlId{11280}{\htmlClass{Symbol}{\text{)}}}\,
      \end{pmatrix}$</a>

    <a id="11295" href="Ledger.Conway.Specification.Epoch.html#11295" class="Function">utxoSt&#39;</a> <a id="11303" class="Symbol">:</a> <a id="11305" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a>
    <a id="11319" href="Ledger.Conway.Specification.Epoch.html#11295" class="Function">utxoSt&#39;</a> <a id="11327" class="Symbol">=</a> <a id="11329" class="Keyword">record</a> <a id="11336" href="Ledger.Conway.Specification.Ledger.html#1036" class="Field">utxoSt</a>
      <a id="11349" class="Symbol">{</a> <a id="11351" href="Ledger.Conway.Specification.Utxo.html#1581" class="Field">deposits</a> <a id="11360" class="Symbol">=</a> <a id="11362" href="Ledger.Conway.Specification.Certs.html#746" class="Field">DepositsOf</a> <a id="11373" href="Ledger.Conway.Specification.Ledger.html#1036" class="Field">utxoSt</a> <a id="11380" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="11382" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="11387" class="Symbol">(</a><a id="11388" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="11394" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="11396" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="11401" class="Symbol">)</a> <a id="11403" href="Ledger.Conway.Specification.Epoch.html#10576" class="Function">removedGovActions</a> <a id="11421" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a>
      <a id="11429" class="Symbol">;</a> <a id="11431" href="Ledger.Conway.Specification.Utxo.html#1607" class="Field">donations</a> <a id="11441" class="Symbol">=</a> <a id="11443" class="Number">0</a>
      <a id="11451" class="Symbol">}</a>

    <a id="11458" href="Ledger.Conway.Specification.Epoch.html#11458" class="Function">totWithdrawals</a> <a id="11473" class="Symbol">:</a> <a id="11475" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="11484" href="Ledger.Conway.Specification.Epoch.html#11458" class="Function">totWithdrawals</a> <a id="11499" class="Symbol">=</a> <a id="11501" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="11504" href="Ledger.Conway.Specification.Epoch.html#11504" class="Bound">x</a> <a id="11506" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="11508" href="Ledger.Conway.Specification.Epoch.html#10947" class="Function">trWithdrawals</a> <a id="11522" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="11524" href="Ledger.Conway.Specification.Epoch.html#11504" class="Bound">x</a>

<a id="11527" class="Keyword">record</a> <a id="EPOCH-Updates"></a><a id="11534" href="Ledger.Conway.Specification.Epoch.html#11534" class="Record">EPOCH-Updates</a> <a id="11548" class="Symbol">:</a> <a id="11550" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="11555" class="Keyword">where</a>
  <a id="11563" class="Keyword">constructor</a> <a id="EPOCHUpdates"></a><a id="11575" href="Ledger.Conway.Specification.Epoch.html#11575" class="InductiveConstructor">EPOCHUpdates</a>
  <a id="11590" class="Keyword">field</a>
    <a id="EPOCH-Updates.es"></a><a id="11600" href="Ledger.Conway.Specification.Epoch.html#11600" class="Field">es</a>             <a id="11615" class="Symbol">:</a> <a id="11617" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
    <a id="EPOCH-Updates.govSt&#39;"></a><a id="11632" href="Ledger.Conway.Specification.Epoch.html#11632" class="Field">govSt&#39;</a>         <a id="11647" class="Symbol">:</a> <a id="11649" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a>
    <a id="EPOCH-Updates.dState&#39;&#39;"></a><a id="11662" href="Ledger.Conway.Specification.Epoch.html#11662" class="Field">dState&#39;&#39;</a>       <a id="11677" class="Symbol">:</a> <a id="11679" href="Ledger.Conway.Specification.Certs.html#3198" class="Record">DState</a>
    <a id="EPOCH-Updates.gState&#39;"></a><a id="11690" href="Ledger.Conway.Specification.Epoch.html#11690" class="Field">gState&#39;</a>        <a id="11705" class="Symbol">:</a> <a id="11707" href="Ledger.Conway.Specification.Certs.html#4029" class="Record">GState</a>
    <a id="EPOCH-Updates.utxoSt&#39;"></a><a id="11718" href="Ledger.Conway.Specification.Epoch.html#11718" class="Field">utxoSt&#39;</a>        <a id="11733" class="Symbol">:</a> <a id="11735" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a>
    <a id="EPOCH-Updates.acnt&#39;&#39;"></a><a id="11749" href="Ledger.Conway.Specification.Epoch.html#11749" class="Field">acnt&#39;&#39;</a>         <a id="11764" class="Symbol">:</a> <a id="11766" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>

<a id="EPOCH-updates"></a><a id="11772" href="Ledger.Conway.Specification.Epoch.html#11772" class="Function">EPOCH-updates</a>
  <a id="11788" class="Symbol">:</a> <a id="11790" href="Ledger.Conway.Specification.Ratify.html#3383" class="Record">RatifyState</a> <a id="11802" class="Symbol">→</a> <a id="11804" href="Ledger.Conway.Specification.Ledger.html#977" class="Record">LState</a> <a id="11811" class="Symbol">→</a> <a id="11813" href="Ledger.Conway.Specification.Certs.html#3198" class="Record">DState</a> <a id="11820" class="Symbol">→</a> <a id="11822" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a> <a id="11827" class="Symbol">→</a> <a id="11829" href="Ledger.Conway.Specification.Epoch.html#11534" class="Record">EPOCH-Updates</a>
<a id="11843" href="Ledger.Conway.Specification.Epoch.html#11772" class="Function">EPOCH-updates</a> <a id="11857" href="Ledger.Conway.Specification.Epoch.html#11857" class="Bound">fut</a> <a id="11861" href="Ledger.Conway.Specification.Epoch.html#11861" class="Bound">ls</a> <a id="11864" href="Ledger.Conway.Specification.Epoch.html#11864" class="Bound">dState&#39;</a> <a id="11872" href="Ledger.Conway.Specification.Epoch.html#11872" class="Bound">acnt&#39;</a> <a id="11878" class="Symbol">=</a>
    <a id="11884" href="Ledger.Conway.Specification.Epoch.html#11575" class="InductiveConstructor">EPOCHUpdates</a> <a id="11897" class="Symbol">(</a><a id="11898" href="Ledger.Conway.Specification.Epoch.html#12051" class="Function">u0</a> <a id="11901" class="Symbol">.</a><a id="11902" href="Ledger.Conway.Specification.Epoch.html#9659" class="Field">es</a><a id="11904" class="Symbol">)</a> <a id="11906" class="Symbol">(</a><a id="11907" href="Ledger.Conway.Specification.Epoch.html#12051" class="Function">u0</a> <a id="11910" class="Symbol">.</a><a id="11911" href="Ledger.Conway.Specification.Epoch.html#9691" class="Field">govSt&#39;</a><a id="11917" class="Symbol">)</a> <a id="11919" href="Ledger.Conway.Specification.Epoch.html#12190" class="Function">dState&#39;&#39;</a> <a id="11928" class="Symbol">(</a><a id="11929" href="Ledger.Conway.Specification.Epoch.html#12051" class="Function">u0</a> <a id="11932" class="Symbol">.</a><a id="11933" href="Ledger.Conway.Specification.Epoch.html#9784" class="Field">gState&#39;</a><a id="11940" class="Symbol">)</a> <a id="11942" class="Symbol">(</a><a id="11943" href="Ledger.Conway.Specification.Epoch.html#12051" class="Function">u0</a> <a id="11946" class="Symbol">.</a><a id="11947" href="Ledger.Conway.Specification.Epoch.html#9812" class="Field">utxoSt&#39;</a><a id="11954" class="Symbol">)</a> <a id="11956" href="Ledger.Conway.Specification.Epoch.html#12362" class="Function">acnt&#39;&#39;</a>
  <a id="11965" class="Keyword">where</a>
    <a id="11975" class="Keyword">open</a> <a id="11980" href="Ledger.Conway.Specification.Ledger.html#977" class="Module">LState</a>
    <a id="11991" class="Keyword">open</a> <a id="11996" href="Ledger.Conway.Specification.Utxo.html#1473" class="Module">UTxOState</a>
    <a id="12010" class="Keyword">open</a> <a id="12015" href="Ledger.Conway.Specification.Certs.html#3198" class="Module">DState</a>
    <a id="12026" class="Keyword">open</a> <a id="12031" href="Ledger.Conway.Specification.Epoch.html#9591" class="Module">EPOCH-Updates0</a>

    <a id="12051" href="Ledger.Conway.Specification.Epoch.html#12051" class="Function">u0</a> <a id="12054" class="Symbol">=</a> <a id="12056" href="Ledger.Conway.Specification.Epoch.html#9866" class="Function">EPOCH-updates0</a> <a id="12071" href="Ledger.Conway.Specification.Epoch.html#11857" class="Bound">fut</a> <a id="12075" href="Ledger.Conway.Specification.Epoch.html#11861" class="Bound">ls</a>

    <a id="12083" href="Ledger.Conway.Specification.Epoch.html#12083" class="Function">refunds</a> <a id="12091" class="Symbol">:</a> <a id="12093" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="12104" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12106" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="12115" href="Ledger.Conway.Specification.Epoch.html#12083" class="Function">refunds</a> <a id="12123" class="Symbol">=</a> <a id="12125" href="Axiom.Set.Map.html#14177" class="Function">pullbackMap</a> <a id="12137" class="Symbol">(</a><a id="12138" href="Ledger.Conway.Specification.Epoch.html#12051" class="Function">u0</a> <a id="12141" class="Symbol">.</a><a id="12142" href="Ledger.Conway.Specification.Epoch.html#9748" class="Field">payout</a><a id="12148" class="Symbol">)</a> <a id="12150" href="Ledger.Conway.Specification.Epoch.html#4598" class="Function">toRwdAddr</a> <a id="12160" class="Symbol">(</a><a id="12161" href="Class.IsSet.html#916" class="Function">dom</a> <a id="12165" class="Symbol">(</a><a id="12166" href="Ledger.Conway.Specification.Epoch.html#11864" class="Bound">dState&#39;</a> <a id="12174" class="Symbol">.</a><a id="12175" href="Ledger.Conway.Specification.Certs.html#3336" class="Field">rewards</a><a id="12182" class="Symbol">))</a>

    <a id="12190" href="Ledger.Conway.Specification.Epoch.html#12190" class="Function">dState&#39;&#39;</a> <a id="12199" class="Symbol">:</a> <a id="12201" href="Ledger.Conway.Specification.Certs.html#3198" class="Record">DState</a>
    <a id="12212" href="Ledger.Conway.Specification.Epoch.html#12190" class="Function">dState&#39;&#39;</a> <a id="12221" class="Symbol">=</a> <a id="12223" class="Keyword">record</a> <a id="12230" href="Ledger.Conway.Specification.Epoch.html#11864" class="Bound">dState&#39;</a> <a id="12238" class="Symbol">{</a> <a id="12240" href="Ledger.Conway.Specification.Certs.html#3336" class="Field">rewards</a> <a id="12248" class="Symbol">=</a> <a id="12250" href="Ledger.Conway.Specification.Epoch.html#11864" class="Bound">dState&#39;</a> <a id="12258" class="Symbol">.</a><a id="12259" href="Ledger.Conway.Specification.Certs.html#3336" class="Field">rewards</a> <a id="12267" href="Axiom.Set.Map.Dec.html#2046" class="Function Operator">∪⁺</a> <a id="12270" href="Ledger.Conway.Specification.Epoch.html#12083" class="Function">refunds</a> <a id="12278" class="Symbol">}</a>

    <a id="12285" href="Ledger.Conway.Specification.Epoch.html#12285" class="Function">unclaimed</a> <a id="12295" class="Symbol">:</a> <a id="12297" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="12306" href="Ledger.Conway.Specification.Epoch.html#12285" class="Function">unclaimed</a> <a id="12316" class="Symbol">=</a> <a id="12318" href="Ledger.Prelude.HasCoin.html#170" class="Field">getCoin</a> <a id="12326" class="Symbol">(</a><a id="12327" href="Ledger.Conway.Specification.Epoch.html#12051" class="Function">u0</a> <a id="12330" class="Symbol">.</a><a id="12331" href="Ledger.Conway.Specification.Epoch.html#9748" class="Field">payout</a><a id="12337" class="Symbol">)</a> <a id="12339" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="12341" href="Ledger.Prelude.HasCoin.html#170" class="Field">getCoin</a> <a id="12349" href="Ledger.Conway.Specification.Epoch.html#12083" class="Function">refunds</a>

    <a id="12362" href="Ledger.Conway.Specification.Epoch.html#12362" class="Function">acnt&#39;&#39;</a> <a id="12369" class="Symbol">:</a> <a id="12371" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
    <a id="12380" href="Ledger.Conway.Specification.Epoch.html#12362" class="Function">acnt&#39;&#39;</a> <a id="12387" class="Symbol">=</a> <a id="12389" class="Keyword">record</a> <a id="12396" href="Ledger.Conway.Specification.Epoch.html#11872" class="Bound">acnt&#39;</a>
      <a id="12408" class="Symbol">{</a> <a id="12410" href="Ledger.Conway.Specification.PParams.html#775" class="Field">treasury</a> <a id="12419" class="Symbol">=</a>
          <a id="12431" href="Ledger.Conway.Specification.PParams.html#775" class="Field">Acnt.treasury</a> <a id="12445" href="Ledger.Conway.Specification.Epoch.html#11872" class="Bound">acnt&#39;</a> <a id="12451" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="12453" href="Ledger.Conway.Specification.Epoch.html#12051" class="Function">u0</a> <a id="12456" class="Symbol">.</a><a id="12457" href="Ledger.Conway.Specification.Epoch.html#9843" class="Field">totWithdrawals</a> <a id="12472" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="12474" href="Ledger.Conway.Specification.Epoch.html#11861" class="Bound">ls</a> <a id="12477" class="Symbol">.</a><a id="12478" href="Ledger.Conway.Specification.Ledger.html#1036" class="Field">utxoSt</a> <a id="12485" class="Symbol">.</a><a id="12486" href="Ledger.Conway.Specification.Utxo.html#1607" class="Field">donations</a> <a id="12496" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="12498" href="Ledger.Conway.Specification.Epoch.html#12285" class="Function">unclaimed</a>
      <a id="12514" class="Symbol">}</a>


<a id="12518" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="12523" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="12538" class="Symbol">:</a> <a id="12540" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="12542" class="Symbol">→</a> <a id="12544" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a> <a id="12555" class="Symbol">→</a> <a id="12557" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a> <a id="12563" class="Symbol">→</a> <a id="12565" href="Ledger.Conway.Specification.Epoch.html#1705" class="Record">EpochState</a> <a id="12576" class="Symbol">→</a> <a id="12578" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="12583" class="Keyword">where</a>


  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="12593" href="Ledger.Conway.Specification.Epoch.html#12593" class="InductiveConstructor">EPOCH</a> <a id="12599" class="Symbol">:</a> <a id="12601" class="Symbol">∀</a> <a id="12603" class="Symbol">{</a><a id="12604" href="Ledger.Conway.Specification.Epoch.html#12604" class="Bound">acnt</a> <a id="12609" class="Symbol">:</a> <a id="12611" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a><a id="12615" class="Symbol">}</a> <a id="12617" class="Symbol">{</a><a id="12618" href="Ledger.Conway.Specification.Epoch.html#12618" class="Bound">utxoSt&#39;&#39;</a> <a id="12627" class="Symbol">:</a> <a id="12629" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a><a id="12638" class="Symbol">}</a> <a id="12640" class="Symbol">{</a><a id="12641" href="Ledger.Conway.Specification.Epoch.html#12641" class="Bound">acnt&#39;</a> <a id="12647" href="Ledger.Conway.Specification.Epoch.html#12647" class="Bound">dState&#39;</a> <a id="12655" href="Ledger.Conway.Specification.Epoch.html#12655" class="Bound">pState&#39;</a><a id="12662" class="Symbol">}</a> <a id="12664" class="Symbol">→</a>
    <a id="12670" class="Keyword">let</a>
      <a id="12680" class="Keyword">open</a> <a id="12685" href="Ledger.Conway.Specification.Ledger.html#977" class="Module">LState</a>
      <a id="12698" class="Keyword">open</a> <a id="12703" href="Ledger.Conway.Specification.Certs.html#4359" class="Module">CertState</a>

      <a id="12720" href="Ledger.Conway.Specification.Epoch.html#12720" class="Bound">cs</a> <a id="12723" class="Symbol">=</a> <a id="12725" href="Ledger.Conway.Specification.Epoch.html#9399" class="Generalizable">ls</a> <a id="12728" class="Symbol">.</a><a id="12729" href="Ledger.Conway.Specification.Ledger.html#1089" class="Field">certState</a>

      <a id="12746" href="Ledger.Conway.Specification.Epoch.html#11575" class="InductiveConstructor">EPOCHUpdates</a> <a id="12759" href="Ledger.Conway.Specification.Epoch.html#12759" class="Bound">es</a> <a id="12762" href="Ledger.Conway.Specification.Epoch.html#12762" class="Bound">govSt&#39;</a> <a id="12769" href="Ledger.Conway.Specification.Epoch.html#12769" class="Bound">dState&#39;&#39;</a> <a id="12778" href="Ledger.Conway.Specification.Epoch.html#12778" class="Bound">gState&#39;</a> <a id="12786" href="Ledger.Conway.Specification.Epoch.html#12786" class="Bound">utxoSt&#39;</a> <a id="12794" href="Ledger.Conway.Specification.Epoch.html#12794" class="Bound">acnt&#39;&#39;</a> <a id="12801" class="Symbol">=</a>
        <a id="12811" href="Ledger.Conway.Specification.Epoch.html#11772" class="Function">EPOCH-updates</a> <a id="12825" href="Ledger.Conway.Specification.Epoch.html#9312" class="Generalizable">fut</a> <a id="12829" href="Ledger.Conway.Specification.Epoch.html#9399" class="Generalizable">ls</a> <a id="12832" href="Ledger.Conway.Specification.Epoch.html#12647" class="Bound">dState&#39;</a> <a id="12840" href="Ledger.Conway.Specification.Epoch.html#12641" class="Bound">acnt&#39;</a>

      <a id="12853" href="Ledger.Conway.Specification.Epoch.html#12853" class="Bound">certState&#39;</a> <a id="12864" class="Symbol">:</a> <a id="12866" href="Ledger.Conway.Specification.Certs.html#4359" class="Record">CertState</a>
      <a id="12882" href="Ledger.Conway.Specification.Epoch.html#12853" class="Bound">certState&#39;</a> <a id="12893" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12769}{\htmlId{12897}{\htmlClass{Bound}{\text{dState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12655}{\htmlId{12908}{\htmlClass{Bound}{\text{pState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12778}{\htmlId{12918}{\htmlClass{Bound}{\text{gState&#39;}}}}\, \end{pmatrix}$</a>

    <a id="12935" class="Keyword">in</a>
      <a id="12944" class="Keyword">record</a> <a id="12951" class="Symbol">{</a> <a id="12953" href="Ledger.Conway.Specification.Ratify.html#3153" class="Field">currentEpoch</a> <a id="12966" class="Symbol">=</a> <a id="12968" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a>
             <a id="12983" class="Symbol">;</a> <a id="12985" href="Ledger.Conway.Specification.Ratify.html#3121" class="Field">stakeDistrs</a> <a id="12997" class="Symbol">=</a> <a id="12999" href="Ledger.Conway.Specification.Epoch.html#9039" class="Function">mkStakeDistrs</a>
                               <a id="13044" class="Symbol">(</a><a id="13045" href="Ledger.Conway.Specification.Rewards.html#7672" class="Field">Snapshots.mark</a> <a id="13060" href="Ledger.Conway.Specification.Epoch.html#9493" class="Generalizable">ss&#39;</a><a id="13063" class="Symbol">)</a>
                               <a id="13096" href="Ledger.Conway.Specification.Epoch.html#12762" class="Bound">govSt&#39;</a>
                               <a id="13134" class="Symbol">(</a><a id="13135" href="Ledger.Conway.Specification.Certs.html#746" class="Field">DepositsOf</a> <a id="13146" href="Ledger.Conway.Specification.Epoch.html#12786" class="Bound">utxoSt&#39;</a><a id="13153" class="Symbol">)</a>
                               <a id="13186" class="Symbol">(</a><a id="13187" href="Ledger.Conway.Specification.Certs.html#3537" class="Field">voteDelegsOf</a> <a id="13200" class="Symbol">(</a><a id="13201" href="Ledger.Conway.Specification.Epoch.html#12720" class="Bound">cs</a> <a id="13204" class="Symbol">.</a><a id="13205" href="Ledger.Conway.Specification.Certs.html#4422" class="Field">dState</a><a id="13211" class="Symbol">))</a>
             <a id="13227" class="Symbol">;</a> <a id="13229" href="Ledger.Conway.Specification.Ratify.html#3268" class="Field">treasury</a> <a id="13238" class="Symbol">=</a> <a id="13240" href="Ledger.Conway.Specification.PParams.html#860" class="Field">treasuryOf</a> <a id="13251" href="Ledger.Conway.Specification.Epoch.html#12604" class="Bound">acnt</a>
             <a id="13269" class="Symbol">;</a> <a id="13271" href="Ledger.Conway.Specification.Epoch.html#13271" class="Module">GState</a> <a id="13278" class="Symbol">(</a><a id="13279" href="Ledger.Conway.Specification.Epoch.html#12720" class="Bound">cs</a> <a id="13282" class="Symbol">.</a><a id="13283" href="Ledger.Conway.Specification.Certs.html#4462" class="Field">gState</a><a id="13289" class="Symbol">)</a>
             <a id="13304" class="Symbol">;</a> <a id="13306" href="Ledger.Conway.Specification.Ratify.html#3293" class="Field">pools</a> <a id="13312" class="Symbol">=</a> <a id="13314" href="Ledger.Conway.Specification.Certs.html#3840" class="Field">PState.pools</a> <a id="13327" class="Symbol">(</a><a id="13328" href="Ledger.Conway.Specification.Epoch.html#12720" class="Bound">cs</a> <a id="13331" class="Symbol">.</a><a id="13332" href="Ledger.Conway.Specification.Certs.html#4442" class="Field">pState</a><a id="13338" class="Symbol">)</a>
             <a id="13353" class="Symbol">;</a> <a id="13355" href="Ledger.Conway.Specification.Ratify.html#3339" class="Field">delegatees</a> <a id="13366" class="Symbol">=</a> <a id="13368" href="Ledger.Conway.Specification.Certs.html#3537" class="Field">voteDelegsOf</a> <a id="13381" class="Symbol">(</a><a id="13382" href="Ledger.Conway.Specification.Epoch.html#12720" class="Bound">cs</a> <a id="13385" class="Symbol">.</a><a id="13386" href="Ledger.Conway.Specification.Certs.html#4422" class="Field">dState</a><a id="13392" class="Symbol">)</a>
             <a id="13407" class="Symbol">}</a>
          <a id="13419" href="Ledger.Conway.Specification.Ratify.html#11181" class="Function Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12759}{\htmlId{13423}{\htmlClass{Bound}{\text{es}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{13428}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Agda.Builtin.Bool.html#192}{\htmlId{13432}{\htmlClass{InductiveConstructor}{\text{false}}}}\, \end{pmatrix}$</a> <a id="13440" href="Ledger.Conway.Specification.Ratify.html#11181" class="Function Operator">⇀⦇</a> <a id="13443" href="Ledger.Conway.Specification.Epoch.html#12762" class="Bound">govSt&#39;</a> <a id="13450" href="Ledger.Conway.Specification.Ratify.html#11181" class="Function Operator">,RATIFIES⦈</a> <a id="13461" href="Ledger.Conway.Specification.Epoch.html#9316" class="Generalizable">fut&#39;</a>
        <a id="13474" class="Symbol">→</a> <a id="13476" href="Ledger.Conway.Specification.Epoch.html#9399" class="Generalizable">ls</a> <a id="13479" href="Ledger.Conway.Specification.Rewards.html#7910" class="Datatype Operator">⊢</a> <a id="13481" href="Ledger.Conway.Specification.Epoch.html#9490" class="Generalizable">ss</a> <a id="13484" href="Ledger.Conway.Specification.Rewards.html#7910" class="Datatype Operator">⇀⦇</a> <a id="13487" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="13490" href="Ledger.Conway.Specification.Rewards.html#7910" class="Datatype Operator">,SNAP⦈</a> <a id="13497" href="Ledger.Conway.Specification.Epoch.html#9493" class="Generalizable">ss&#39;</a>
        <a id="13509" class="Symbol">→</a> <a id="13511" class="Symbol">_</a> <a id="13513" href="Ledger.Conway.Specification.PoolReap.html#858" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12786}{\htmlId{13517}{\htmlClass{Bound}{\text{utxoSt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12604}{\htmlId{13527}{\htmlClass{Bound}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12720}{\htmlId{13534}{\htmlClass{Bound}{\text{cs}}}}\, \,\htmlId{13537}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Certs.html#4422}{\htmlId{13538}{\htmlClass{Field}{\text{dState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12720}{\htmlId{13547}{\htmlClass{Bound}{\text{cs}}}}\, \,\htmlId{13550}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Certs.html#4442}{\htmlId{13551}{\htmlClass{Field}{\text{pState}}}}\, \end{pmatrix}$</a> <a id="13560" href="Ledger.Conway.Specification.PoolReap.html#858" class="Datatype Operator">⇀⦇</a> <a id="13563" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="13565" href="Ledger.Conway.Specification.PoolReap.html#858" class="Datatype Operator">,POOLREAP⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12618}{\htmlId{13578}{\htmlClass{Bound}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12641}{\htmlId{13589}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12647}{\htmlId{13597}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12655}{\htmlId{13607}{\htmlClass{Bound}{\text{pState&#39;}}}}\, \end{pmatrix}$</a>
      <a id="13623" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="13662" class="Symbol">_</a> <a id="13664" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12604}{\htmlId{13668}{\htmlClass{Bound}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9490}{\htmlId{13675}{\htmlClass{Generalizable}{\text{ss}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9399}{\htmlId{13680}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9413}{\htmlId{13685}{\htmlClass{Generalizable}{\text{es₀}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9312}{\htmlId{13691}{\htmlClass{Generalizable}{\text{fut}}}}\, \end{pmatrix}$</a> <a id="13697" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">⇀⦇</a> <a id="13700" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="13702" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">,EPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12794}{\htmlId{13712}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9493}{\htmlId{13721}{\htmlClass{Generalizable}{\text{ss&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12618}{\htmlId{13729}{\htmlClass{Bound}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12762}{\htmlId{13740}{\htmlClass{Bound}{\text{govSt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12853}{\htmlId{13749}{\htmlClass{Bound}{\text{certState&#39;}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#12759}{\htmlId{13764}{\htmlClass{Bound}{\text{es}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9316}{\htmlId{13769}{\htmlClass{Generalizable}{\text{fut&#39;}}}}\, \end{pmatrix}$</a>


<a id="13778" class="Keyword">opaque</a>
  <a id="calculatePoolDelegatedStake"></a><a id="13787" href="Ledger.Conway.Specification.Epoch.html#13787" class="Function">calculatePoolDelegatedStake</a> <a id="13815" class="Symbol">:</a> <a id="13817" href="Ledger.Conway.Specification.Rewards.html#6504" class="Record">Snapshot</a> <a id="13826" class="Symbol">→</a> <a id="13828" href="Ledger.Conway.Specification.Epoch.html#2711" class="Function">PoolDelegatedStake</a>
  <a id="13849" href="Ledger.Conway.Specification.Epoch.html#13787" class="Function">calculatePoolDelegatedStake</a> <a id="13877" href="Ledger.Conway.Specification.Epoch.html#13877" class="Bound">ss</a> <a id="13880" class="Symbol">=</a>
      <a id="13888" class="Comment">-- Shelley spec: the output map must contain keys appearing in both</a>
      <a id="13962" class="Comment">-- sd and the pool parameters.</a>
      <a id="13999" href="Ledger.Conway.Specification.Epoch.html#14100" class="Function">sd</a> <a id="14002" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="14004" href="Class.IsSet.html#916" class="Function">dom</a> <a id="14008" class="Symbol">(</a><a id="14009" href="Ledger.Conway.Specification.Epoch.html#13877" class="Bound">ss</a> <a id="14012" class="Symbol">.</a><a id="14013" href="Ledger.Conway.Specification.Rewards.html#6599" class="Field">poolParameters</a><a id="14027" class="Symbol">)</a>
    <a id="14033" class="Keyword">where</a>
      <a id="14045" class="Keyword">open</a> <a id="14050" href="Ledger.Conway.Specification.Rewards.html#6504" class="Module">Snapshot</a>

      <a id="14066" class="Comment">-- delegated stake per pool</a>
      <a id="14100" href="Ledger.Conway.Specification.Epoch.html#14100" class="Function">sd</a> <a id="14103" class="Symbol">:</a> <a id="14105" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="14113" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="14115" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
      <a id="14126" href="Ledger.Conway.Specification.Epoch.html#14100" class="Function">sd</a> <a id="14129" class="Symbol">=</a> <a id="14131" href="Axiom.Set.Map.Dec.html#2124" class="Function">aggregate₊</a> <a id="14142" class="Symbol">((</a><a id="14144" href="Ledger.Conway.Specification.Epoch.html#14276" class="Function">stakeCredentialsPerPool</a> <a id="14168" href="Ledger.Conway.Specification.Epoch.html#14636" class="Function Operator">∘ʳ</a> <a id="14171" class="Symbol">(</a><a id="14172" href="Ledger.Conway.Specification.Epoch.html#13877" class="Bound">ss</a> <a id="14175" class="Symbol">.</a><a id="14176" href="Ledger.Conway.Specification.Rewards.html#6537" class="Field">stake</a> <a id="14182" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="14183" class="Symbol">))</a> <a id="14186" href="abstract-set-theory.FiniteSetTheory.html#2767" class="Function Operator">ᶠˢ</a><a id="14188" class="Symbol">)</a>
        <a id="14198" class="Keyword">where</a> <a id="14204" class="Keyword">mutual</a>
          <a id="14221" class="Comment">-- stake credentials delegating to each pool</a>
          <a id="14276" href="Ledger.Conway.Specification.Epoch.html#14276" class="Function">stakeCredentialsPerPool</a> <a id="14300" class="Symbol">:</a> <a id="14302" href="Axiom.Set.Rel.html#1297" class="Function">Rel</a> <a id="14306" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="14314" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a>
          <a id="14335" href="Ledger.Conway.Specification.Epoch.html#14276" class="Function">stakeCredentialsPerPool</a> <a id="14359" class="Symbol">=</a> <a id="14361" class="Symbol">(</a><a id="14362" href="Ledger.Conway.Specification.Epoch.html#13877" class="Bound">ss</a> <a id="14365" class="Symbol">.</a><a id="14366" href="Ledger.Conway.Specification.Rewards.html#6565" class="Field">delegations</a> <a id="14378" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="14379" class="Symbol">)</a> <a id="14381" href="Ledger.Conway.Specification.Epoch.html#14499" class="Function Operator">⁻¹ʳ</a>

          <a id="14396" class="Comment">-- TODO: Move to agda-sets</a>
          <a id="14433" class="Comment">-- https://github.com/input-output-hk/agda-sets/pull/13</a>
          <a id="14499" href="Ledger.Conway.Specification.Epoch.html#14499" class="Function Operator">_⁻¹ʳ</a> <a id="14504" class="Symbol">:</a> <a id="14506" class="Symbol">{</a><a id="14507" href="Ledger.Conway.Specification.Epoch.html#14507" class="Bound">A</a> <a id="14509" href="Ledger.Conway.Specification.Epoch.html#14509" class="Bound">B</a> <a id="14511" class="Symbol">:</a> <a id="14513" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="14517" class="Symbol">}</a> <a id="14519" class="Symbol">→</a> <a id="14521" href="Axiom.Set.Rel.html#1297" class="Function">Rel</a> <a id="14525" href="Ledger.Conway.Specification.Epoch.html#14507" class="Bound">A</a> <a id="14527" href="Ledger.Conway.Specification.Epoch.html#14509" class="Bound">B</a> <a id="14529" class="Symbol">→</a> <a id="14531" href="Axiom.Set.Rel.html#1297" class="Function">Rel</a> <a id="14535" href="Ledger.Conway.Specification.Epoch.html#14509" class="Bound">B</a> <a id="14537" href="Ledger.Conway.Specification.Epoch.html#14507" class="Bound">A</a>
          <a id="14549" href="Ledger.Conway.Specification.Epoch.html#14549" class="Bound">R</a> <a id="14551" href="Ledger.Conway.Specification.Epoch.html#14499" class="Function Operator">⁻¹ʳ</a> <a id="14555" class="Symbol">=</a> <a id="14557" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14562" href="Data.Product.Base.html#5054" class="Function">swap</a> <a id="14567" href="Ledger.Conway.Specification.Epoch.html#14549" class="Bound">R</a>
            <a id="14581" class="Keyword">where</a> <a id="14587" class="Keyword">open</a> <a id="14592" class="Keyword">import</a> <a id="14599" href="Data.Product.html" class="Module">Data.Product</a> <a id="14612" class="Keyword">using</a> <a id="14618" class="Symbol">(</a><a id="14619" href="Data.Product.Base.html#5054" class="Function">swap</a><a id="14623" class="Symbol">)</a>

          <a id="14636" href="Ledger.Conway.Specification.Epoch.html#14636" class="Function Operator">_∘ʳ_</a> <a id="14641" class="Symbol">:</a> <a id="14643" class="Symbol">{</a><a id="14644" href="Ledger.Conway.Specification.Epoch.html#14644" class="Bound">A</a> <a id="14646" href="Ledger.Conway.Specification.Epoch.html#14646" class="Bound">B</a> <a id="14648" href="Ledger.Conway.Specification.Epoch.html#14648" class="Bound">C</a> <a id="14650" class="Symbol">:</a> <a id="14652" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="14656" class="Symbol">}</a> <a id="14658" class="Symbol">⦃</a> <a id="14660" href="Ledger.Conway.Specification.Epoch.html#14660" class="Bound">_</a> <a id="14662" class="Symbol">:</a> <a id="14664" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="14670" href="Ledger.Conway.Specification.Epoch.html#14646" class="Bound">B</a> <a id="14672" class="Symbol">⦄</a> <a id="14674" class="Symbol">→</a> <a id="14676" href="Axiom.Set.Rel.html#1297" class="Function">Rel</a> <a id="14680" href="Ledger.Conway.Specification.Epoch.html#14644" class="Bound">A</a> <a id="14682" href="Ledger.Conway.Specification.Epoch.html#14646" class="Bound">B</a> <a id="14684" class="Symbol">→</a> <a id="14686" href="Axiom.Set.Rel.html#1297" class="Function">Rel</a> <a id="14690" href="Ledger.Conway.Specification.Epoch.html#14646" class="Bound">B</a> <a id="14692" href="Ledger.Conway.Specification.Epoch.html#14648" class="Bound">C</a> <a id="14694" class="Symbol">→</a> <a id="14696" href="Axiom.Set.Rel.html#1297" class="Function">Rel</a> <a id="14700" href="Ledger.Conway.Specification.Epoch.html#14644" class="Bound">A</a> <a id="14702" href="Ledger.Conway.Specification.Epoch.html#14648" class="Bound">C</a>
          <a id="14714" href="Ledger.Conway.Specification.Epoch.html#14714" class="Bound">R</a> <a id="14716" href="Ledger.Conway.Specification.Epoch.html#14636" class="Function Operator">∘ʳ</a> <a id="14719" href="Ledger.Conway.Specification.Epoch.html#14719" class="Bound">S</a> <a id="14721" class="Symbol">=</a>
            <a id="14735" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a>
              <a id="14760" class="Symbol">(λ</a> <a id="14763" class="Symbol">(</a><a id="14764" href="Ledger.Conway.Specification.Epoch.html#14764" class="Bound">a</a> <a id="14766" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="14768" href="Ledger.Conway.Specification.Epoch.html#14768" class="Bound">b</a><a id="14769" class="Symbol">)</a> <a id="14771" class="Symbol">→</a> <a id="14773" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14778" class="Symbol">((</a><a id="14780" href="Ledger.Conway.Specification.Epoch.html#14764" class="Bound">a</a> <a id="14782" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="14784" class="Symbol">)</a> <a id="14786" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="14788" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="14793" class="Symbol">)</a> <a id="14795" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="14797" href="abstract-set-theory.FiniteSetTheory.html#2813" class="Function">filterˢ</a> <a id="14805" class="Symbol">((</a><a id="14807" href="Ledger.Conway.Specification.Epoch.html#14768" class="Bound">b</a> <a id="14809" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡_</a><a id="14811" class="Symbol">)</a> <a id="14813" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="14815" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="14820" class="Symbol">)</a> <a id="14822" href="Ledger.Conway.Specification.Epoch.html#14719" class="Bound">S</a><a id="14823" class="Symbol">)</a>
              <a id="14839" href="Ledger.Conway.Specification.Epoch.html#14714" class="Bound">R</a>


<a id="14843" class="Keyword">data</a>


  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="14852" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="14870" class="Symbol">:</a> <a id="14872" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="14874" class="Symbol">→</a> <a id="14876" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a> <a id="14890" class="Symbol">→</a> <a id="14892" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a> <a id="14898" class="Symbol">→</a> <a id="14900" href="Ledger.Conway.Specification.Epoch.html#2755" class="Record">NewEpochState</a> <a id="14914" class="Symbol">→</a> <a id="14916" href="Agda.Primitive.html#388" class="Primitive">Type</a>


  <a id="14925" class="Keyword">where</a>


  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="14935" href="Ledger.Conway.Specification.Epoch.html#14935" class="InductiveConstructor">NEWEPOCH-New</a> <a id="14948" class="Symbol">:</a> <a id="14950" class="Keyword">let</a>
      <a id="14960" href="Ledger.Conway.Specification.Epoch.html#14960" class="Bound">eps&#39;</a> <a id="14965" class="Symbol">=</a> <a id="14967" href="Ledger.Conway.Specification.Epoch.html#7553" class="Function">applyRUpd</a> <a id="14977" href="Ledger.Conway.Specification.Epoch.html#9511" class="Generalizable">ru</a> <a id="14980" href="Ledger.Conway.Specification.Epoch.html#9369" class="Generalizable">eps</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{14992}{\htmlClass{Symbol}{\text{\_}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#14996}{\htmlId{14996}{\htmlClass{Bound}{\text{ss}}}}\, \\ \,\htmlId{15001}{\htmlClass{Symbol}{\text{\_}}}\, \\ \,\htmlId{15005}{\htmlClass{Symbol}{\text{\_}}}\, \\ \,\htmlId{15009}{\htmlClass{Symbol}{\text{\_}}}\, \end{pmatrix}$</a> <a id="15015" class="Symbol">=</a> <a id="15017" href="Ledger.Conway.Specification.Epoch.html#9378" class="Generalizable">eps&#39;&#39;</a>
      <a id="15029" href="Ledger.Conway.Specification.Epoch.html#15029" class="Bound">pd&#39;</a> <a id="15033" class="Symbol">=</a> <a id="15035" href="Ledger.Conway.Specification.Epoch.html#13787" class="Function">calculatePoolDelegatedStake</a> <a id="15063" class="Symbol">(</a><a id="15064" href="Ledger.Conway.Specification.Rewards.html#7677" class="Field">Snapshots.set</a> <a id="15078" href="Ledger.Conway.Specification.Epoch.html#14996" class="Bound">ss</a><a id="15080" class="Symbol">)</a>
    <a id="15086" class="Keyword">in</a>
    <a id="15093" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="15095" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="15097" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="15099" href="Ledger.Conway.Specification.Epoch.html#9292" class="Generalizable">lastEpoch</a> <a id="15109" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="15111" class="Number">1</a>
    <a id="15117" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="15119" class="Symbol">_</a> <a id="15121" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">⊢</a> <a id="15123" href="Ledger.Conway.Specification.Epoch.html#14960" class="Bound">eps&#39;</a> <a id="15128" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">⇀⦇</a> <a id="15131" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="15133" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">,EPOCH⦈</a> <a id="15141" href="Ledger.Conway.Specification.Epoch.html#9378" class="Generalizable">eps&#39;&#39;</a>
      <a id="15153" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="15192" class="Symbol">_</a> <a id="15194" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9292}{\htmlId{15198}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9369}{\htmlId{15210}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#173}{\htmlId{15216}{\htmlClass{InductiveConstructor}{\text{just}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9511}{\htmlId{15221}{\htmlClass{Generalizable}{\text{ru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9558}{\htmlId{15226}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="15231" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">⇀⦇</a> <a id="15234" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="15236" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9290}{\htmlId{15249}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9378}{\htmlId{15253}{\htmlClass{Generalizable}{\text{eps&#39;&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{15261}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#15029}{\htmlId{15271}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="15280" href="Ledger.Conway.Specification.Epoch.html#15280" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="15297" class="Symbol">:</a>
    <a id="15303" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="15305" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="15307" href="Relation.Binary.PropositionalEquality.Core.html#1000" class="Function Operator">≢</a> <a id="15309" href="Ledger.Conway.Specification.Epoch.html#9292" class="Generalizable">lastEpoch</a> <a id="15319" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="15321" class="Number">1</a>
      <a id="15329" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="15368" class="Symbol">_</a> <a id="15370" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9292}{\htmlId{15374}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9369}{\htmlId{15386}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9531}{\htmlId{15392}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9558}{\htmlId{15398}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="15403" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">⇀⦇</a> <a id="15406" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="15408" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9292}{\htmlId{15421}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9369}{\htmlId{15433}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9531}{\htmlId{15439}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9558}{\htmlId{15445}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="15453" href="Ledger.Conway.Specification.Epoch.html#15453" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="15479" class="Symbol">:</a> <a id="15481" class="Keyword">let</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{15493}{\htmlClass{Symbol}{\text{\_}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#15497}{\htmlId{15497}{\htmlClass{Bound}{\text{ss}}}}\, \\ \,\htmlId{15502}{\htmlClass{Symbol}{\text{\_}}}\, \\ \,\htmlId{15506}{\htmlClass{Symbol}{\text{\_}}}\, \\ \,\htmlId{15510}{\htmlClass{Symbol}{\text{\_}}}\, \end{pmatrix}$</a> <a id="15516" class="Symbol">=</a> <a id="15518" href="Ledger.Conway.Specification.Epoch.html#9373" class="Generalizable">eps&#39;</a>
      <a id="15529" href="Ledger.Conway.Specification.Epoch.html#15529" class="Bound">pd&#39;</a> <a id="15533" class="Symbol">=</a> <a id="15535" href="Ledger.Conway.Specification.Epoch.html#13787" class="Function">calculatePoolDelegatedStake</a> <a id="15563" class="Symbol">(</a><a id="15564" href="Ledger.Conway.Specification.Rewards.html#7677" class="Field">Snapshots.set</a> <a id="15578" href="Ledger.Conway.Specification.Epoch.html#15497" class="Bound">ss</a><a id="15580" class="Symbol">)</a>
    <a id="15586" class="Keyword">in</a>
    <a id="15593" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="15595" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="15597" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="15599" href="Ledger.Conway.Specification.Epoch.html#9292" class="Generalizable">lastEpoch</a> <a id="15609" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="15611" class="Number">1</a>
    <a id="15617" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="15619" class="Symbol">_</a> <a id="15621" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">⊢</a> <a id="15623" href="Ledger.Conway.Specification.Epoch.html#9369" class="Generalizable">eps</a> <a id="15627" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">⇀⦇</a> <a id="15630" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="15632" href="Ledger.Conway.Specification.Epoch.html#12523" class="Datatype Operator">,EPOCH⦈</a> <a id="15640" href="Ledger.Conway.Specification.Epoch.html#9373" class="Generalizable">eps&#39;</a>
      <a id="15651" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="15690" class="Symbol">_</a> <a id="15692" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9292}{\htmlId{15696}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9369}{\htmlId{15708}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{15714}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9558}{\htmlId{15724}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="15729" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">⇀⦇</a> <a id="15732" href="Ledger.Conway.Specification.Epoch.html#9290" class="Generalizable">e</a> <a id="15734" href="Ledger.Conway.Specification.Epoch.html#14852" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9290}{\htmlId{15747}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9373}{\htmlId{15751}{\htmlClass{Generalizable}{\text{eps&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{15758}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#15529}{\htmlId{15768}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

</pre></body></html>