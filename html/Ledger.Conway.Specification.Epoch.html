<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Epoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="124" class="Keyword">module</a> <a id="131" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a>
  <a id="167" class="Symbol">(</a><a id="168" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a> <a id="172" class="Symbol">:</a> <a id="174" class="Symbol">_)</a> <a id="177" class="Symbol">(</a><a id="178" class="Keyword">open</a> <a id="183" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="204" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a><a id="207" class="Symbol">)</a>
  <a id="211" class="Symbol">(</a><a id="212" href="Ledger.Conway.Specification.Epoch.html#212" class="Bound">abs</a> <a id="216" class="Symbol">:</a> <a id="218" href="Ledger.Core.Specification.Abstract.html#826" class="Record">AbstractFunctions</a> <a id="236" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a><a id="239" class="Symbol">)</a> <a id="241" class="Symbol">(</a><a id="242" class="Keyword">open</a> <a id="247" href="Ledger.Core.Specification.Abstract.html#826" class="Module">AbstractFunctions</a> <a id="265" href="Ledger.Conway.Specification.Epoch.html#212" class="Bound">abs</a><a id="268" class="Symbol">)</a>
  <a id="272" class="Keyword">where</a>

<a id="279" class="Keyword">open</a> <a id="284" class="Keyword">import</a> <a id="291" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="313" class="Keyword">import</a>      <a id="325" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="338" class="Symbol">as</a> <a id="341" class="Module">ℤ</a>
<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Data.Integer.html" class="Module">Data.Integer</a>                    <a id="387" class="Keyword">using</a> <a id="393" class="Symbol">()</a> <a id="396" class="Keyword">renaming</a> <a id="405" class="Symbol">(</a><a id="406" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a> <a id="409" class="Symbol">to</a> <a id="412" class="InductiveConstructor">pos</a><a id="415" class="Symbol">)</a>
<a id="417" class="Keyword">open</a> <a id="422" class="Keyword">import</a> <a id="429" href="Data.Integer.Properties.html" class="Module">Data.Integer.Properties</a>         <a id="461" class="Keyword">using</a> <a id="467" class="Symbol">(</a><a id="468" class="Keyword">module</a> <a id="475" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a><a id="486" class="Symbol">;</a> <a id="488" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a><a id="496" class="Symbol">;</a> <a id="498" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a><a id="508" class="Symbol">;</a> <a id="510" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a><a id="521" class="Symbol">)</a>
                                            <a id="567" class="Keyword">renaming</a> <a id="576" class="Symbol">(</a><a id="577" href="Data.Integer.Properties.html#12508" class="Function">nonNegative⁻¹</a> <a id="591" class="Symbol">to</a> <a id="594" class="Function">nonNegative⁻¹ℤ</a><a id="608" class="Symbol">)</a>
<a id="610" class="Keyword">open</a> <a id="615" class="Keyword">import</a> <a id="622" href="Data.Integer.Tactic.RingSolver.html" class="Module">Data.Integer.Tactic.RingSolver</a>  <a id="654" class="Keyword">using</a> <a id="660" class="Symbol">(</a><a id="661" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a><a id="668" class="Symbol">)</a>
<a id="670" class="Keyword">open</a> <a id="675" class="Keyword">import</a> <a id="682" href="Data.Maybe.html" class="Module">Data.Maybe</a>                      <a id="714" class="Keyword">using</a> <a id="720" class="Symbol">(</a><a id="721" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a><a id="730" class="Symbol">)</a>
<a id="732" class="Keyword">open</a> <a id="737" class="Keyword">import</a> <a id="744" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a>  <a id="776" class="Keyword">using</a> <a id="782" class="Symbol">(</a><a id="783" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a><a id="790" class="Symbol">)</a>
<a id="792" class="Keyword">open</a> <a id="797" class="Keyword">import</a> <a id="804" href="Data.Rational.html" class="Module">Data.Rational</a>                   <a id="836" class="Keyword">using</a> <a id="842" class="Symbol">(</a><a id="843" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="844" class="Symbol">;</a> <a id="846" href="Data.Rational.Base.html#7195" class="Function">floor</a><a id="851" class="Symbol">;</a> <a id="853" href="Data.Rational.Base.html#6394" class="Function Operator">_*_</a><a id="856" class="Symbol">;</a> <a id="858" href="Data.Rational.Base.html#6787" class="Function Operator">_÷_</a><a id="861" class="Symbol">;</a> <a id="863" href="Data.Rational.Base.html#3963" class="Function Operator">_/_</a><a id="866" class="Symbol">;</a> <a id="868" href="Data.Rational.Base.html#6933" class="Function Operator">_⊓_</a><a id="871" class="Symbol">;</a> <a id="873" href="Data.Rational.Properties.html#4152" class="Function Operator">_≟_</a><a id="876" class="Symbol">;</a> <a id="878" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a><a id="887" class="Symbol">)</a>
<a id="889" class="Keyword">open</a> <a id="894" class="Keyword">import</a> <a id="901" href="Data.Rational.Literals.html" class="Module">Data.Rational.Literals</a>          <a id="933" class="Keyword">using</a> <a id="939" class="Symbol">(</a><a id="940" href="Data.Rational.Literals.html#740" class="Function">number</a><a id="946" class="Symbol">;</a> <a id="948" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a><a id="953" class="Symbol">)</a>
<a id="955" class="Keyword">open</a> <a id="960" class="Keyword">import</a> <a id="967" href="Data.Rational.Properties.html" class="Module">Data.Rational.Properties</a>        <a id="999" class="Keyword">using</a> <a id="1005" class="Symbol">(</a><a id="1006" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a><a id="1019" class="Symbol">;</a> <a id="1021" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a><a id="1031" class="Symbol">;</a> <a id="1033" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a><a id="1038" class="Symbol">)</a>

<a id="1041" class="Keyword">open</a> <a id="1046" class="Keyword">import</a> <a id="1053" href="stdlib.Data.Rational.Properties.html" class="Module">stdlib.Data.Rational.Properties</a> <a id="1085" class="Keyword">using</a> <a id="1091" class="Symbol">(</a><a id="1092" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a><a id="1102" class="Symbol">;</a> <a id="1104" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a><a id="1111" class="Symbol">;</a> <a id="1113" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a><a id="1121" class="Symbol">;</a> <a id="1123" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a><a id="1130" class="Symbol">;</a> <a id="1132" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a><a id="1140" class="Symbol">)</a>

<a id="1143" class="Keyword">open</a> <a id="1148" class="Keyword">import</a> <a id="1155" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="1170" class="Keyword">hiding</a> <a id="1177" class="Symbol">(</a><a id="1178" href="Data.List.Base.html#5114" class="Function">iterate</a><a id="1185" class="Symbol">;</a> <a id="1187" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="1190" class="Symbol">;</a> <a id="1192" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="1195" class="Symbol">;</a> <a id="1197" href="Data.Nat.Base.html#5851" class="Function Operator">_⊓_</a><a id="1200" class="Symbol">;</a> <a id="1202" href="Class.DecEq.Core.html#168" class="Field Operator">_≟_</a><a id="1205" class="Symbol">;</a> <a id="1207" href="Data.Nat.Base.html#3425" class="Function">≢-nonZero</a><a id="1216" class="Symbol">)</a>
<a id="1218" class="Keyword">open</a> <a id="1223" class="Keyword">import</a> <a id="1230" href="Ledger.Prelude.Numeric.UnitInterval.html" class="Module">Ledger.Prelude.Numeric.UnitInterval</a> <a id="1266" class="Keyword">using</a> <a id="1272" class="Symbol">(</a><a id="1273" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a><a id="1289" class="Symbol">;</a> <a id="1291" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a><a id="1308" class="Symbol">)</a>

<a id="1311" class="Keyword">open</a> <a id="1316" class="Keyword">import</a> <a id="1323" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="1357" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="1370" class="Keyword">open</a> <a id="1375" class="Keyword">import</a> <a id="1382" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="1416" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="1429" class="Keyword">open</a> <a id="1434" class="Keyword">import</a> <a id="1441" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="1473" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a>
<a id="1477" class="Keyword">open</a> <a id="1482" class="Keyword">import</a> <a id="1489" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="1524" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a> <a id="1528" href="Ledger.Conway.Specification.Epoch.html#212" class="Bound">abs</a>
<a id="1532" class="Keyword">open</a> <a id="1537" class="Keyword">import</a> <a id="1544" href="Ledger.Conway.Specification.PoolReap.html" class="Module">Ledger.Conway.Specification.PoolReap</a> <a id="1581" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a> <a id="1585" href="Ledger.Conway.Specification.Epoch.html#212" class="Bound">abs</a>
<a id="1589" class="Keyword">open</a> <a id="1594" class="Keyword">import</a> <a id="1601" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="1636" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a>
<a id="1640" class="Keyword">open</a> <a id="1645" class="Keyword">import</a> <a id="1652" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="1688" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a> <a id="1692" href="Ledger.Conway.Specification.Epoch.html#212" class="Bound">abs</a>
<a id="1696" class="Keyword">open</a> <a id="1701" class="Keyword">import</a> <a id="1708" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="1741" href="Ledger.Conway.Specification.Epoch.html#168" class="Bound">txs</a> <a id="1745" href="Ledger.Conway.Specification.Epoch.html#212" class="Bound">abs</a>

<a id="1750" class="Keyword">open</a> <a id="1755" href="Ledger.Prelude.html#2436" class="Module">Filter</a> <a id="1762" class="Keyword">using</a> <a id="1768" class="Symbol">(</a><a id="1769" href="Ledger.Prelude.html#2451" class="Function">filter</a><a id="1775" class="Symbol">)</a>
<a id="1777" class="Keyword">open</a> <a id="1782" href="Agda.Builtin.FromNat.html#196" class="Module">Number</a> <a id="1789" href="Data.Rational.Literals.html#740" class="Function">number</a> <a id="1796" class="Keyword">renaming</a> <a id="1805" class="Symbol">(</a><a id="1806" href="Agda.Builtin.FromNat.html#281" class="Field">fromNat</a> <a id="1814" class="Symbol">to</a> <a id="1817" class="Field">fromℕ</a><a id="1822" class="Symbol">)</a>


<a id="1826" class="Keyword">record</a> <a id="EpochState"></a><a id="1833" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a> <a id="1844" class="Symbol">:</a> <a id="1846" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1851" class="Keyword">where</a>


  <a id="1861" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1873" href="Ledger.Conway.Specification.Epoch.html#1873" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>


  <a id="1891" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1901" href="Ledger.Conway.Specification.Epoch.html#1901" class="Field">acnt</a>       <a id="1912" class="Symbol">:</a> <a id="1914" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1923" href="Ledger.Conway.Specification.Epoch.html#1923" class="Field">ss</a>         <a id="1934" class="Symbol">:</a> <a id="1936" href="Ledger.Conway.Specification.Rewards.html#7734" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1950" href="Ledger.Conway.Specification.Epoch.html#1950" class="Field">ls</a>         <a id="1961" class="Symbol">:</a> <a id="1963" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1974" href="Ledger.Conway.Specification.Epoch.html#1974" class="Field">es</a>         <a id="1985" class="Symbol">:</a> <a id="1987" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="2002" href="Ledger.Conway.Specification.Epoch.html#2002" class="Field">fut</a>        <a id="2013" class="Symbol">:</a> <a id="2015" href="Ledger.Conway.Specification.Ratify.html#3527" class="Record">RatifyState</a>


<a id="2029" class="Keyword">record</a> <a id="HasEpochState"></a><a id="2036" href="Ledger.Conway.Specification.Epoch.html#2036" class="Record">HasEpochState</a> <a id="2050" class="Symbol">{</a><a id="2051" href="Ledger.Conway.Specification.Epoch.html#2051" class="Bound">a</a><a id="2052" class="Symbol">}</a> <a id="2054" class="Symbol">(</a><a id="2055" href="Ledger.Conway.Specification.Epoch.html#2055" class="Bound">A</a> <a id="2057" class="Symbol">:</a> <a id="2059" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2064" href="Ledger.Conway.Specification.Epoch.html#2051" class="Bound">a</a><a id="2065" class="Symbol">)</a> <a id="2067" class="Symbol">:</a> <a id="2069" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2074" href="Ledger.Conway.Specification.Epoch.html#2051" class="Bound">a</a> <a id="2076" class="Keyword">where</a>
  <a id="2084" class="Keyword">field</a> <a id="HasEpochState.EpochStateOf"></a><a id="2090" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a> <a id="2103" class="Symbol">:</a> <a id="2105" href="Ledger.Conway.Specification.Epoch.html#2055" class="Bound">A</a> <a id="2107" class="Symbol">→</a> <a id="2109" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
<a id="2120" class="Keyword">open</a> <a id="2125" href="Ledger.Conway.Specification.Epoch.html#2036" class="Module">HasEpochState</a> <a id="2139" class="Symbol">⦃...⦄</a> <a id="2145" class="Keyword">public</a>

<a id="2153" class="Keyword">instance</a>
  <a id="HasSnapshots-EpochState"></a><a id="2164" href="Ledger.Conway.Specification.Epoch.html#2164" class="Function">HasSnapshots-EpochState</a> <a id="2188" class="Symbol">:</a> <a id="2190" href="Ledger.Conway.Specification.Rewards.html#7825" class="Record">HasSnapshots</a> <a id="2203" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="2216" href="Ledger.Conway.Specification.Epoch.html#2164" class="Function">HasSnapshots-EpochState</a> <a id="2240" class="Symbol">.</a><a id="2241" href="Ledger.Conway.Specification.Rewards.html#7878" class="Field">SnapshotsOf</a> <a id="2253" class="Symbol">=</a> <a id="2255" href="Ledger.Conway.Specification.Epoch.html#1923" class="Field">EpochState.ss</a>

  <a id="HasLState-EpochState"></a><a id="2272" href="Ledger.Conway.Specification.Epoch.html#2272" class="Function">HasLState-EpochState</a> <a id="2293" class="Symbol">:</a> <a id="2295" href="Ledger.Conway.Specification.Ledger.html#1141" class="Record">HasLState</a> <a id="2305" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="2318" href="Ledger.Conway.Specification.Epoch.html#2272" class="Function">HasLState-EpochState</a> <a id="2339" class="Symbol">.</a><a id="2340" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a> <a id="2349" class="Symbol">=</a> <a id="2351" href="Ledger.Conway.Specification.Epoch.html#1950" class="Field">EpochState.ls</a>

  <a id="HasGovState-EpochState"></a><a id="2368" href="Ledger.Conway.Specification.Epoch.html#2368" class="Function">HasGovState-EpochState</a> <a id="2391" class="Symbol">:</a> <a id="2393" href="Ledger.Conway.Specification.Gov.html#1531" class="Record">HasGovState</a> <a id="2405" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="2418" href="Ledger.Conway.Specification.Epoch.html#2368" class="Function">HasGovState-EpochState</a> <a id="2441" class="Symbol">.</a><a id="2442" href="Ledger.Conway.Specification.Gov.html#1583" class="Field">GovStateOf</a> <a id="2453" class="Symbol">=</a> <a id="2455" href="Ledger.Conway.Specification.Gov.html#1583" class="Field">GovStateOf</a> <a id="2466" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2468" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a>

  <a id="HasEnactState-EpochState"></a><a id="2480" href="Ledger.Conway.Specification.Epoch.html#2480" class="Function">HasEnactState-EpochState</a> <a id="2505" class="Symbol">:</a> <a id="2507" href="Ledger.Conway.Specification.Enact.html#733" class="Record">HasEnactState</a> <a id="2521" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="2534" href="Ledger.Conway.Specification.Epoch.html#2480" class="Function">HasEnactState-EpochState</a> <a id="2559" class="Symbol">.</a><a id="2560" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="2573" class="Symbol">=</a> <a id="2575" href="Ledger.Conway.Specification.Epoch.html#1974" class="Field">EpochState.es</a>

  <a id="HasDeposits-EpochState"></a><a id="2592" href="Ledger.Conway.Specification.Epoch.html#2592" class="Function">HasDeposits-EpochState</a> <a id="2615" class="Symbol">:</a> <a id="2617" href="Ledger.Core.Specification.Certs.html#833" class="Record">HasDeposits</a> <a id="2629" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="2642" href="Ledger.Conway.Specification.Epoch.html#2592" class="Function">HasDeposits-EpochState</a> <a id="2665" class="Symbol">.</a><a id="2666" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="2677" class="Symbol">=</a> <a id="2679" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="2690" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2692" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a>

  <a id="HasDReps-EpochState"></a><a id="2704" href="Ledger.Conway.Specification.Epoch.html#2704" class="Function">HasDReps-EpochState</a> <a id="2724" class="Symbol">:</a> <a id="2726" href="Ledger.Core.Specification.Gov.Actions.html#7045" class="Record">HasDReps</a> <a id="2735" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="2748" href="Ledger.Conway.Specification.Epoch.html#2704" class="Function">HasDReps-EpochState</a> <a id="2768" class="Symbol">.</a><a id="2769" href="Ledger.Core.Specification.Gov.Actions.html#7094" class="Field">DRepsOf</a> <a id="2777" class="Symbol">=</a> <a id="2779" href="Ledger.Core.Specification.Gov.Actions.html#7094" class="Field">DRepsOf</a> <a id="2787" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2789" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="2801" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2803" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a>

  <a id="HasTreasury-EpochState"></a><a id="2815" href="Ledger.Conway.Specification.Epoch.html#2815" class="Function">HasTreasury-EpochState</a> <a id="2838" class="Symbol">:</a> <a id="2840" href="Ledger.Prelude.Base.html#837" class="Record">HasTreasury</a> <a id="2852" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="2865" href="Ledger.Conway.Specification.Epoch.html#2815" class="Function">HasTreasury-EpochState</a> <a id="2888" class="Symbol">.</a><a id="2889" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="2900" class="Symbol">=</a> <a id="2902" href="Ledger.Conway.Specification.PParams.html#773" class="Field">Acnt.treasury</a> <a id="2916" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2918" href="Ledger.Conway.Specification.Epoch.html#1901" class="Field">EpochState.acnt</a>

  <a id="HasReserves-EpochState"></a><a id="2937" href="Ledger.Conway.Specification.Epoch.html#2937" class="Function">HasReserves-EpochState</a> <a id="2960" class="Symbol">:</a> <a id="2962" href="Ledger.Prelude.Base.html#721" class="Record">HasReserves</a> <a id="2974" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="2987" href="Ledger.Conway.Specification.Epoch.html#2937" class="Function">HasReserves-EpochState</a> <a id="3010" class="Symbol">.</a><a id="3011" href="Ledger.Prelude.Base.html#773" class="Field">ReservesOf</a> <a id="3022" class="Symbol">=</a> <a id="3024" href="Ledger.Conway.Specification.PParams.html#782" class="Field">Acnt.reserves</a> <a id="3038" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3040" href="Ledger.Conway.Specification.Epoch.html#1901" class="Field">EpochState.acnt</a>

  <a id="HasPParams-EpochState"></a><a id="3059" href="Ledger.Conway.Specification.Epoch.html#3059" class="Function">HasPParams-EpochState</a> <a id="3081" class="Symbol">:</a> <a id="3083" href="Ledger.Conway.Specification.PParams.html#3491" class="Record">HasPParams</a> <a id="3094" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="3107" href="Ledger.Conway.Specification.Epoch.html#3059" class="Function">HasPParams-EpochState</a> <a id="3129" class="Symbol">.</a><a id="3130" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="3140" class="Symbol">=</a> <a id="3142" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="3152" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3154" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a>

  <a id="HasRatifyState-EpochState"></a><a id="3170" href="Ledger.Conway.Specification.Epoch.html#3170" class="Function">HasRatifyState-EpochState</a> <a id="3196" class="Symbol">:</a> <a id="3198" href="Ledger.Conway.Specification.Ratify.html#3663" class="Record">HasRatifyState</a> <a id="3213" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="3226" href="Ledger.Conway.Specification.Epoch.html#3170" class="Function">HasRatifyState-EpochState</a> <a id="3252" class="Symbol">.</a><a id="3253" href="Ledger.Conway.Specification.Ratify.html#3718" class="Field">RatifyStateOf</a> <a id="3267" class="Symbol">=</a> <a id="3269" href="Ledger.Conway.Specification.Epoch.html#2002" class="Field">EpochState.fut</a>

  <a id="HasPState-EpochState"></a><a id="3287" href="Ledger.Conway.Specification.Epoch.html#3287" class="Function">HasPState-EpochState</a> <a id="3308" class="Symbol">:</a> <a id="3310" href="Ledger.Core.Specification.Certs.html#4476" class="Record">HasPState</a> <a id="3320" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="3333" href="Ledger.Conway.Specification.Epoch.html#3287" class="Function">HasPState-EpochState</a> <a id="3354" class="Symbol">.</a><a id="3355" href="Ledger.Core.Specification.Certs.html#4526" class="Field">PStateOf</a> <a id="3364" class="Symbol">=</a> <a id="3366" href="Ledger.Core.Specification.Certs.html#4526" class="Field">PStateOf</a> <a id="3375" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3377" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="3389" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3391" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a>

  <a id="HasRetiring-EpochState"></a><a id="3403" href="Ledger.Conway.Specification.Epoch.html#3403" class="Function">HasRetiring-EpochState</a> <a id="3426" class="Symbol">:</a> <a id="3428" href="Ledger.Core.Specification.Certs.html#1559" class="Record">HasRetiring</a> <a id="3440" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="3453" href="Ledger.Conway.Specification.Epoch.html#3403" class="Function">HasRetiring-EpochState</a> <a id="3476" class="Symbol">.</a><a id="3477" href="Ledger.Core.Specification.Certs.html#1611" class="Field">RetiringOf</a> <a id="3488" class="Symbol">=</a> <a id="3490" href="Ledger.Core.Specification.Certs.html#1611" class="Field">RetiringOf</a> <a id="3501" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3503" href="Ledger.Core.Specification.Certs.html#4526" class="Field">PStateOf</a>


<a id="PoolDelegatedStake"></a><a id="3514" href="Ledger.Conway.Specification.Epoch.html#3514" class="Function">PoolDelegatedStake</a> <a id="3533" class="Symbol">:</a> <a id="3535" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3540" href="Ledger.Conway.Specification.Epoch.html#3514" class="Function">PoolDelegatedStake</a> <a id="3559" class="Symbol">=</a> <a id="3561" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="3569" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3571" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>

<a id="3577" class="Keyword">record</a> <a id="NewEpochState"></a><a id="3584" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a> <a id="3598" class="Symbol">:</a> <a id="3600" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3605" class="Keyword">where</a>
  <a id="3613" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="3623" href="Ledger.Conway.Specification.Epoch.html#3623" class="Field">lastEpoch</a>   <a id="3635" class="Symbol">:</a> <a id="3637" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
    <a id="NewEpochState.bprev"></a><a id="3647" href="Ledger.Conway.Specification.Epoch.html#3647" class="Field">bprev</a>       <a id="3659" class="Symbol">:</a> <a id="3661" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a>
    <a id="NewEpochState.bcur"></a><a id="3676" href="Ledger.Conway.Specification.Epoch.html#3676" class="Field">bcur</a>        <a id="3688" class="Symbol">:</a> <a id="3690" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a>
    <a id="NewEpochState.epochState"></a><a id="3705" href="Ledger.Conway.Specification.Epoch.html#3705" class="Field">epochState</a>  <a id="3717" class="Symbol">:</a> <a id="3719" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="3734" href="Ledger.Conway.Specification.Epoch.html#3734" class="Field">ru</a>          <a id="3746" class="Symbol">:</a> <a id="3748" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3754" href="Ledger.Conway.Specification.Rewards.html#6264" class="Record">RewardUpdate</a>
    <a id="NewEpochState.pd"></a><a id="3771" href="Ledger.Conway.Specification.Epoch.html#3771" class="Field">pd</a>          <a id="3783" class="Symbol">:</a> <a id="3785" href="Ledger.Conway.Specification.Epoch.html#3514" class="Function">PoolDelegatedStake</a>


<a id="3806" class="Keyword">record</a> <a id="HasNewEpochState"></a><a id="3813" href="Ledger.Conway.Specification.Epoch.html#3813" class="Record">HasNewEpochState</a> <a id="3830" class="Symbol">{</a><a id="3831" href="Ledger.Conway.Specification.Epoch.html#3831" class="Bound">a</a><a id="3832" class="Symbol">}</a> <a id="3834" class="Symbol">(</a><a id="3835" href="Ledger.Conway.Specification.Epoch.html#3835" class="Bound">A</a> <a id="3837" class="Symbol">:</a> <a id="3839" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3844" href="Ledger.Conway.Specification.Epoch.html#3831" class="Bound">a</a><a id="3845" class="Symbol">)</a> <a id="3847" class="Symbol">:</a> <a id="3849" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3854" href="Ledger.Conway.Specification.Epoch.html#3831" class="Bound">a</a> <a id="3856" class="Keyword">where</a>
  <a id="3864" class="Keyword">field</a> <a id="HasNewEpochState.NewEpochStateOf"></a><a id="3870" href="Ledger.Conway.Specification.Epoch.html#3870" class="Field">NewEpochStateOf</a> <a id="3886" class="Symbol">:</a> <a id="3888" href="Ledger.Conway.Specification.Epoch.html#3835" class="Bound">A</a> <a id="3890" class="Symbol">→</a> <a id="3892" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
<a id="3906" class="Keyword">open</a> <a id="3911" href="Ledger.Conway.Specification.Epoch.html#3813" class="Module">HasNewEpochState</a> <a id="3928" class="Symbol">⦃...⦄</a> <a id="3934" class="Keyword">public</a>
<a id="3941" class="Keyword">record</a> <a id="HasLastEpoch"></a><a id="3948" href="Ledger.Conway.Specification.Epoch.html#3948" class="Record">HasLastEpoch</a>     <a id="3965" class="Symbol">{</a><a id="3966" href="Ledger.Conway.Specification.Epoch.html#3966" class="Bound">a</a><a id="3967" class="Symbol">}</a> <a id="3969" class="Symbol">(</a><a id="3970" href="Ledger.Conway.Specification.Epoch.html#3970" class="Bound">A</a> <a id="3972" class="Symbol">:</a> <a id="3974" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3979" href="Ledger.Conway.Specification.Epoch.html#3966" class="Bound">a</a><a id="3980" class="Symbol">)</a> <a id="3982" class="Symbol">:</a> <a id="3984" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3989" href="Ledger.Conway.Specification.Epoch.html#3966" class="Bound">a</a> <a id="3991" class="Keyword">where</a> <a id="3997" class="Keyword">field</a> <a id="HasLastEpoch.LastEpochOf"></a><a id="4003" href="Ledger.Conway.Specification.Epoch.html#4003" class="Field">LastEpochOf</a>     <a id="4019" class="Symbol">:</a> <a id="4021" href="Ledger.Conway.Specification.Epoch.html#3970" class="Bound">A</a> <a id="4023" class="Symbol">→</a> <a id="4025" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
<a id="4031" class="Keyword">open</a> <a id="4036" href="Ledger.Conway.Specification.Epoch.html#3948" class="Module">HasLastEpoch</a>     <a id="4053" class="Symbol">⦃...⦄</a> <a id="4059" class="Keyword">public</a>

<a id="4067" class="Keyword">instance</a>
  <a id="HasLastEpoch-NewEpochState"></a><a id="4078" href="Ledger.Conway.Specification.Epoch.html#4078" class="Function">HasLastEpoch-NewEpochState</a> <a id="4105" class="Symbol">:</a> <a id="4107" href="Ledger.Conway.Specification.Epoch.html#3948" class="Record">HasLastEpoch</a> <a id="4120" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="4136" href="Ledger.Conway.Specification.Epoch.html#4078" class="Function">HasLastEpoch-NewEpochState</a> <a id="4163" class="Symbol">.</a><a id="4164" href="Ledger.Conway.Specification.Epoch.html#4003" class="Field">LastEpochOf</a> <a id="4176" class="Symbol">=</a> <a id="4178" href="Ledger.Conway.Specification.Epoch.html#3623" class="Field">NewEpochState.lastEpoch</a>

  <a id="HasEpochState-NewEpochState"></a><a id="4205" href="Ledger.Conway.Specification.Epoch.html#4205" class="Function">HasEpochState-NewEpochState</a> <a id="4233" class="Symbol">:</a> <a id="4235" href="Ledger.Conway.Specification.Epoch.html#2036" class="Record">HasEpochState</a> <a id="4249" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="4265" href="Ledger.Conway.Specification.Epoch.html#4205" class="Function">HasEpochState-NewEpochState</a> <a id="4293" class="Symbol">.</a><a id="4294" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a> <a id="4307" class="Symbol">=</a> <a id="4309" href="Ledger.Conway.Specification.Epoch.html#3705" class="Field">NewEpochState.epochState</a>

  <a id="HasEnactState-NewEpochState"></a><a id="4337" href="Ledger.Conway.Specification.Epoch.html#4337" class="Function">HasEnactState-NewEpochState</a> <a id="4365" class="Symbol">:</a> <a id="4367" href="Ledger.Conway.Specification.Enact.html#733" class="Record">HasEnactState</a> <a id="4381" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="4397" href="Ledger.Conway.Specification.Epoch.html#4337" class="Function">HasEnactState-NewEpochState</a> <a id="4425" class="Symbol">.</a><a id="4426" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="4439" class="Symbol">=</a> <a id="4441" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="4454" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4456" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a>

  <a id="Hastreasury-NewEpochState"></a><a id="4472" href="Ledger.Conway.Specification.Epoch.html#4472" class="Function">Hastreasury-NewEpochState</a> <a id="4498" class="Symbol">:</a> <a id="4500" href="Ledger.Prelude.Base.html#837" class="Record">HasTreasury</a> <a id="4512" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="4528" href="Ledger.Conway.Specification.Epoch.html#4472" class="Function">Hastreasury-NewEpochState</a> <a id="4554" class="Symbol">.</a><a id="4555" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="4566" class="Symbol">=</a> <a id="4568" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="4579" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4581" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a>

  <a id="HasLState-NewEpochState"></a><a id="4597" href="Ledger.Conway.Specification.Epoch.html#4597" class="Function">HasLState-NewEpochState</a> <a id="4621" class="Symbol">:</a> <a id="4623" href="Ledger.Conway.Specification.Ledger.html#1141" class="Record">HasLState</a> <a id="4633" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="4649" href="Ledger.Conway.Specification.Epoch.html#4597" class="Function">HasLState-NewEpochState</a> <a id="4673" class="Symbol">.</a><a id="4674" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a> <a id="4683" class="Symbol">=</a> <a id="4685" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a> <a id="4694" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4696" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a>

  <a id="HasGovState-NewEpochState"></a><a id="4712" href="Ledger.Conway.Specification.Epoch.html#4712" class="Function">HasGovState-NewEpochState</a> <a id="4738" class="Symbol">:</a> <a id="4740" href="Ledger.Conway.Specification.Gov.html#1531" class="Record">HasGovState</a> <a id="4752" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="4768" href="Ledger.Conway.Specification.Epoch.html#4712" class="Function">HasGovState-NewEpochState</a> <a id="4794" class="Symbol">.</a><a id="4795" href="Ledger.Conway.Specification.Gov.html#1583" class="Field">GovStateOf</a> <a id="4806" class="Symbol">=</a> <a id="4808" href="Ledger.Conway.Specification.Gov.html#1583" class="Field">GovStateOf</a> <a id="4819" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4821" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a>

  <a id="HasCertState-NewEpochState"></a><a id="4833" href="Ledger.Conway.Specification.Epoch.html#4833" class="Function">HasCertState-NewEpochState</a> <a id="4860" class="Symbol">:</a> <a id="4862" href="Ledger.Core.Specification.Certs.html#4692" class="Record">HasCertState</a> <a id="4875" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="4891" href="Ledger.Conway.Specification.Epoch.html#4833" class="Function">HasCertState-NewEpochState</a> <a id="4918" class="Symbol">.</a><a id="4919" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="4931" class="Symbol">=</a> <a id="4933" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="4945" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4947" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a>

  <a id="HasDReps-NewEpochState"></a><a id="4959" href="Ledger.Conway.Specification.Epoch.html#4959" class="Function">HasDReps-NewEpochState</a> <a id="4982" class="Symbol">:</a> <a id="4984" href="Ledger.Core.Specification.Gov.Actions.html#7045" class="Record">HasDReps</a> <a id="4993" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="5009" href="Ledger.Conway.Specification.Epoch.html#4959" class="Function">HasDReps-NewEpochState</a> <a id="5032" class="Symbol">.</a><a id="5033" href="Ledger.Core.Specification.Gov.Actions.html#7094" class="Field">DRepsOf</a> <a id="5041" class="Symbol">=</a> <a id="5043" href="Ledger.Core.Specification.Gov.Actions.html#7094" class="Field">DRepsOf</a> <a id="5051" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5053" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a>

  <a id="HasRewards-NewEpochState"></a><a id="5068" href="Ledger.Conway.Specification.Epoch.html#5068" class="Function">HasRewards-NewEpochState</a> <a id="5093" class="Symbol">:</a> <a id="5095" href="Ledger.Core.Specification.Certs.html#1645" class="Record">HasRewards</a> <a id="5106" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="5122" href="Ledger.Conway.Specification.Epoch.html#5068" class="Function">HasRewards-NewEpochState</a> <a id="5147" class="Symbol">.</a><a id="5148" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="5158" class="Symbol">=</a> <a id="5160" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="5170" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5172" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a>

  <a id="HasPParams-NewEpochState"></a><a id="5187" href="Ledger.Conway.Specification.Epoch.html#5187" class="Function">HasPParams-NewEpochState</a> <a id="5212" class="Symbol">:</a> <a id="5214" href="Ledger.Conway.Specification.PParams.html#3491" class="Record">HasPParams</a> <a id="5225" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>
  <a id="5241" href="Ledger.Conway.Specification.Epoch.html#5187" class="Function">HasPParams-NewEpochState</a> <a id="5266" class="Symbol">.</a><a id="5267" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="5277" class="Symbol">=</a> <a id="5279" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="5289" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5291" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a>

  <a id="5307" class="Keyword">unquoteDecl</a> <a id="HasCast-EpochState"></a><a id="5319" href="Ledger.Conway.Specification.Epoch.html#5319" class="Function">HasCast-EpochState</a> <a id="HasCast-NewEpochState"></a><a id="5338" href="Ledger.Conway.Specification.Epoch.html#5338" class="Function">HasCast-NewEpochState</a> <a id="5360" class="Symbol">=</a> <a id="5362" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="5381" class="Symbol">(</a> <a id="5383" class="Symbol">(</a><a id="5384" class="Keyword">quote</a> <a id="5390" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>     <a id="5405" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5407" href="Ledger.Conway.Specification.Epoch.html#5319" class="Function">HasCast-EpochState</a><a id="5425" class="Symbol">)</a>
    <a id="5431" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5433" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="5435" class="Symbol">(</a><a id="5436" class="Keyword">quote</a> <a id="5442" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a>  <a id="5457" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5459" href="Ledger.Conway.Specification.Epoch.html#5338" class="Function">HasCast-NewEpochState</a><a id="5480" class="Symbol">)</a><a id="5481" href="Data.List.Base.html#4907" class="Function Operator">]</a><a id="5482" class="Symbol">)</a>

<a id="toRewardAddress"></a><a id="5485" href="Ledger.Conway.Specification.Epoch.html#5485" class="Function">toRewardAddress</a> <a id="5501" class="Symbol">:</a> <a id="5503" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="5514" class="Symbol">→</a> <a id="5516" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a>
<a id="5530" href="Ledger.Conway.Specification.Epoch.html#5485" class="Function">toRewardAddress</a> <a id="5546" href="Ledger.Conway.Specification.Epoch.html#5546" class="Bound">x</a> <a id="5548" class="Symbol">=</a> <a id="5550" class="Keyword">record</a> <a id="5557" class="Symbol">{</a> <a id="5559" href="Ledger.Core.Specification.Address.html#1352" class="Field">net</a> <a id="5563" class="Symbol">=</a> <a id="5565" href="Ledger.Core.Specification.Epoch.html#2703" class="Function">NetworkId</a> <a id="5575" class="Symbol">;</a> <a id="5577" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a> <a id="5583" class="Symbol">=</a> <a id="5585" href="Ledger.Conway.Specification.Epoch.html#5546" class="Bound">x</a> <a id="5587" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="5590" href="Ledger.Conway.Specification.Epoch.html#5590" class="Function">getStakeCred</a> <a id="5603" class="Symbol">:</a> <a id="5605" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="5611" class="Symbol">→</a> <a id="5613" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5619" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
<a id="5630" href="Ledger.Conway.Specification.Epoch.html#5590" class="Function">getStakeCred</a> <a id="5643" class="Symbol">(</a><a id="5644" href="Ledger.Conway.Specification.Epoch.html#5644" class="Bound">a</a> <a id="5646" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5648" class="Symbol">_</a> <a id="5650" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5652" class="Symbol">_</a> <a id="5654" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5656" class="Symbol">_)</a> <a id="5659" class="Symbol">=</a> <a id="5661" href="Ledger.Core.Specification.Address.html#2719" class="Function">stakeCred</a> <a id="5671" href="Ledger.Conway.Specification.Epoch.html#5644" class="Bound">a</a>

<a id="5674" class="Keyword">open</a> <a id="5679" href="Ledger.Core.Specification.Gov.Actions.html#3818" class="Module">GovActionState</a> <a id="5694" class="Keyword">using</a> <a id="5700" class="Symbol">(</a><a id="5701" href="Ledger.Core.Specification.Gov.Actions.html#3885" class="Field">returnAddr</a><a id="5711" class="Symbol">)</a>

<a id="5714" class="Keyword">opaque</a>


  <a id="createRUpd"></a><a id="5725" href="Ledger.Conway.Specification.Epoch.html#5725" class="Function">createRUpd</a> <a id="5736" class="Symbol">:</a> <a id="5738" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5740" class="Symbol">→</a> <a id="5742" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a> <a id="5753" class="Symbol">→</a> <a id="5755" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a> <a id="5766" class="Symbol">→</a> <a id="5768" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a> <a id="5773" class="Symbol">→</a> <a id="5775" href="Ledger.Conway.Specification.Rewards.html#6264" class="Record">RewardUpdate</a>
  <a id="5790" href="Ledger.Conway.Specification.Epoch.html#5725" class="Function">createRUpd</a> <a id="5801" href="Ledger.Conway.Specification.Epoch.html#5801" class="Bound">slotsPerEpoch</a> <a id="5815" href="Ledger.Conway.Specification.Epoch.html#5815" class="Bound">b</a> <a id="5817" href="Ledger.Conway.Specification.Epoch.html#5817" class="Bound">es</a> <a id="5820" href="Ledger.Conway.Specification.Epoch.html#5820" class="Bound">total</a> <a id="5826" class="Symbol">=</a>
    <a id="5832" class="Keyword">record</a>  <a id="5840" class="Symbol">{</a> <a id="5842" href="Ledger.Conway.Specification.Rewards.html#6301" class="Field">Δt</a> <a id="5845" class="Symbol">=</a> <a id="5847" href="Ledger.Conway.Specification.Epoch.html#6803" class="Function">Δt₁</a>
            <a id="5863" class="Symbol">;</a> <a id="5865" href="Ledger.Conway.Specification.Rewards.html#6304" class="Field">Δr</a> <a id="5868" class="Symbol">=</a> <a id="5870" class="Number">0</a> <a id="5872" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="5874" href="Ledger.Conway.Specification.Epoch.html#6789" class="Function">Δr₁</a> <a id="5878" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5880" href="Ledger.Conway.Specification.Epoch.html#7125" class="Function">Δr₂</a>
            <a id="5896" class="Symbol">;</a> <a id="5898" href="Ledger.Conway.Specification.Rewards.html#6307" class="Field">Δf</a> <a id="5901" class="Symbol">=</a> <a id="5903" class="Number">0</a> <a id="5905" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="5907" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="5911" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a>
            <a id="5929" class="Symbol">;</a> <a id="5931" href="Ledger.Conway.Specification.Rewards.html#6327" class="Field">rs</a> <a id="5934" class="Symbol">=</a> <a id="5936" href="Ledger.Conway.Specification.Epoch.html#7030" class="Function">rs</a>


            <a id="5953" class="Symbol">;</a> <a id="5955" href="Ledger.Conway.Specification.Rewards.html#6357" class="Field">flowConservation</a> <a id="5972" class="Symbol">=</a> <a id="5974" href="Ledger.Conway.Specification.Epoch.html#7418" class="Function">flowConservation</a>
            <a id="6003" class="Symbol">;</a> <a id="6005" href="Ledger.Conway.Specification.Rewards.html#6420" class="Field">Δt-nonnegative</a> <a id="6020" class="Symbol">=</a> <a id="6022" href="Ledger.Conway.Specification.Epoch.html#8556" class="Function">Δt-nonneg</a>
            <a id="6044" class="Symbol">;</a> <a id="6046" href="Ledger.Conway.Specification.Rewards.html#6451" class="Field">Δf-nonpositive</a> <a id="6061" class="Symbol">=</a> <a id="6063" href="Ledger.Conway.Specification.Epoch.html#8738" class="Function">Δf-nonpos</a>


            <a id="6087" class="Symbol">}</a>
    <a id="6093" class="Keyword">where</a>
      <a id="6105" href="Ledger.Conway.Specification.Epoch.html#6105" class="Function">prevPp</a> <a id="6112" class="Symbol">:</a> <a id="6114" href="Ledger.Conway.Specification.PParams.html#1687" class="Record">PParams</a>
      <a id="6128" href="Ledger.Conway.Specification.Epoch.html#6105" class="Function">prevPp</a> <a id="6135" class="Symbol">=</a> <a id="6137" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="6147" href="Ledger.Conway.Specification.Epoch.html#5817" class="Bound">es</a>

      <a id="6157" href="Ledger.Conway.Specification.Epoch.html#6157" class="Function">reserves</a> <a id="6166" class="Symbol">:</a> <a id="6168" href="Ledger.Prelude.Base.html#191" class="Function">Reserves</a>
      <a id="6183" href="Ledger.Conway.Specification.Epoch.html#6157" class="Function">reserves</a> <a id="6192" class="Symbol">=</a> <a id="6194" href="Ledger.Prelude.Base.html#773" class="Field">ReservesOf</a> <a id="6205" href="Ledger.Conway.Specification.Epoch.html#5817" class="Bound">es</a>

      <a id="6215" href="Ledger.Conway.Specification.Epoch.html#6215" class="Function">pstakego</a> <a id="6224" class="Symbol">:</a> <a id="6226" href="Ledger.Conway.Specification.Rewards.html#6487" class="Record">Snapshot</a>
      <a id="6241" href="Ledger.Conway.Specification.Epoch.html#6215" class="Function">pstakego</a> <a id="6250" class="Symbol">=</a> <a id="6252" class="Symbol">(</a><a id="6253" href="Ledger.Conway.Specification.Rewards.html#7878" class="Field">SnapshotsOf</a> <a id="6265" href="Ledger.Conway.Specification.Epoch.html#5817" class="Bound">es</a><a id="6267" class="Symbol">)</a> <a id="6269" class="Symbol">.</a><a id="6270" href="Ledger.Conway.Specification.Rewards.html#7777" class="Field">Snapshots.go</a>

      <a id="6290" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a> <a id="6296" class="Symbol">:</a> <a id="6298" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
      <a id="6309" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a> <a id="6315" class="Symbol">=</a> <a id="6317" href="Ledger.Prelude.Base.html#669" class="Field">FeesOf</a> <a id="6324" class="Symbol">(</a><a id="6325" href="Ledger.Conway.Specification.Rewards.html#7878" class="Field">SnapshotsOf</a> <a id="6337" href="Ledger.Conway.Specification.Epoch.html#5817" class="Bound">es</a><a id="6339" class="Symbol">)</a>

      <a id="6348" href="Ledger.Conway.Specification.Epoch.html#6348" class="Function">stake</a> <a id="6354" class="Symbol">:</a> <a id="6356" href="Ledger.Core.Specification.Certs.html#1290" class="Function">Stake</a>
      <a id="6368" href="Ledger.Conway.Specification.Epoch.html#6348" class="Function">stake</a> <a id="6374" class="Symbol">=</a> <a id="6376" href="Ledger.Core.Specification.Certs.html#1777" class="Field">StakeOf</a> <a id="6384" href="Ledger.Conway.Specification.Epoch.html#6215" class="Function">pstakego</a>

      <a id="6400" href="Ledger.Conway.Specification.Epoch.html#6400" class="Function">delegs</a> <a id="6407" class="Symbol">:</a> <a id="6409" href="Ledger.Core.Specification.Certs.html#1330" class="Function">StakeDelegs</a>
      <a id="6427" href="Ledger.Conway.Specification.Epoch.html#6400" class="Function">delegs</a> <a id="6434" class="Symbol">=</a> <a id="6436" href="Ledger.Core.Specification.Certs.html#1861" class="Field">StakeDelegsOf</a> <a id="6450" href="Ledger.Conway.Specification.Epoch.html#6215" class="Function">pstakego</a>

      <a id="6466" href="Ledger.Conway.Specification.Epoch.html#6466" class="Function">poolParams</a> <a id="6477" class="Symbol">:</a> <a id="6479" href="Ledger.Core.Specification.Certs.html#1154" class="Function">Pools</a>
      <a id="6491" href="Ledger.Conway.Specification.Epoch.html#6466" class="Function">poolParams</a> <a id="6502" class="Symbol">=</a> <a id="6504" href="Ledger.Core.Specification.Certs.html#1531" class="Field">PoolsOf</a> <a id="6512" href="Ledger.Conway.Specification.Epoch.html#6215" class="Function">pstakego</a>

      <a id="6528" href="Ledger.Conway.Specification.Epoch.html#6528" class="Function">blocksMade</a> <a id="6539" class="Symbol">:</a> <a id="6541" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
      <a id="6549" href="Ledger.Conway.Specification.Epoch.html#6528" class="Function">blocksMade</a> <a id="6560" class="Symbol">=</a> <a id="6562" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="6565" href="Ledger.Conway.Specification.Epoch.html#6565" class="Bound">m</a> <a id="6567" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="6569" href="Ledger.Conway.Specification.Epoch.html#5815" class="Bound">b</a> <a id="6571" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="6573" href="Ledger.Conway.Specification.Epoch.html#6565" class="Bound">m</a>

      <a id="6582" href="Ledger.Conway.Specification.Epoch.html#6582" class="Function">ρ</a> <a id="6584" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">η</a> <a id="6586" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">τ</a> <a id="6588" class="Symbol">:</a> <a id="6590" href="Data.Rational.Base.html#1421" class="Record">ℚ</a>
      <a id="6598" href="Ledger.Conway.Specification.Epoch.html#6582" class="Function">ρ</a> <a id="6600" class="Symbol">=</a> <a id="6602" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a> <a id="6619" class="Symbol">(</a><a id="6620" href="Ledger.Conway.Specification.Epoch.html#6105" class="Function">prevPp</a> <a id="6627" class="Symbol">.</a><a id="6628" href="Ledger.Conway.Specification.PParams.html#2283" class="Field">PParams.monetaryExpansion</a><a id="6653" class="Symbol">)</a>
      <a id="6661" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">η</a> <a id="6663" class="Symbol">=</a> <a id="6665" href="Ledger.Conway.Specification.Epoch.html#1817" class="Function">fromℕ</a> <a id="6671" href="Ledger.Conway.Specification.Epoch.html#6528" class="Function">blocksMade</a> <a id="6682" href="Ledger.Prelude.html#2064" class="Function Operator">÷₀</a> <a id="6685" class="Symbol">(</a><a id="6686" href="Ledger.Conway.Specification.Epoch.html#1817" class="Function">fromℕ</a> <a id="6692" href="Ledger.Conway.Specification.Epoch.html#5801" class="Bound">slotsPerEpoch</a> <a id="6706" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6708" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a><a id="6723" class="Symbol">)</a>
      <a id="6731" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">τ</a> <a id="6733" class="Symbol">=</a> <a id="6735" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a> <a id="6752" class="Symbol">(</a><a id="6753" href="Ledger.Conway.Specification.Epoch.html#6105" class="Function">prevPp</a> <a id="6760" class="Symbol">.</a><a id="6761" href="Ledger.Conway.Specification.PParams.html#2353" class="Field">PParams.treasuryCut</a><a id="6780" class="Symbol">)</a>

      <a id="6789" href="Ledger.Conway.Specification.Epoch.html#6789" class="Function">Δr₁</a> <a id="6793" href="Ledger.Conway.Specification.Epoch.html#6793" class="Function">rewardPot</a> <a id="6803" href="Ledger.Conway.Specification.Epoch.html#6803" class="Function">Δt₁</a> <a id="6807" href="Ledger.Conway.Specification.Epoch.html#6807" class="Function">R</a> <a id="6809" class="Symbol">:</a> <a id="6811" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
      <a id="6819" href="Ledger.Conway.Specification.Epoch.html#6789" class="Function">Δr₁</a> <a id="6823" class="Symbol">=</a> <a id="6825" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="6831" class="Symbol">(</a><a id="6832" class="Number">1</a> <a id="6834" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="6836" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">η</a> <a id="6838" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6840" href="Ledger.Conway.Specification.Epoch.html#6582" class="Function">ρ</a> <a id="6842" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6844" href="Ledger.Conway.Specification.Epoch.html#1817" class="Function">fromℕ</a> <a id="6850" href="Ledger.Conway.Specification.Epoch.html#6157" class="Function">reserves</a><a id="6858" class="Symbol">)</a>
      <a id="6866" href="Ledger.Conway.Specification.Epoch.html#6793" class="Function">rewardPot</a> <a id="6876" class="Symbol">=</a> <a id="6878" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="6882" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a> <a id="6888" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6890" href="Ledger.Conway.Specification.Epoch.html#6789" class="Function">Δr₁</a>
      <a id="6900" href="Ledger.Conway.Specification.Epoch.html#6803" class="Function">Δt₁</a> <a id="6904" class="Symbol">=</a> <a id="6906" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="6912" class="Symbol">(</a><a id="6913" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="6919" href="Ledger.Conway.Specification.Epoch.html#6793" class="Function">rewardPot</a> <a id="6929" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6931" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">τ</a><a id="6932" class="Symbol">)</a>
      <a id="6940" href="Ledger.Conway.Specification.Epoch.html#6807" class="Function">R</a> <a id="6942" class="Symbol">=</a> <a id="6944" href="Ledger.Conway.Specification.Epoch.html#6793" class="Function">rewardPot</a> <a id="6954" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="6956" href="Ledger.Conway.Specification.Epoch.html#6803" class="Function">Δt₁</a>

      <a id="6967" href="Ledger.Conway.Specification.Epoch.html#6967" class="Function">circulation</a> <a id="6979" class="Symbol">:</a> <a id="6981" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="6992" href="Ledger.Conway.Specification.Epoch.html#6967" class="Function">circulation</a> <a id="7004" class="Symbol">=</a> <a id="7006" href="Ledger.Conway.Specification.Epoch.html#5820" class="Bound">total</a> <a id="7012" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7014" href="Ledger.Conway.Specification.Epoch.html#6157" class="Function">reserves</a>

      <a id="7030" href="Ledger.Conway.Specification.Epoch.html#7030" class="Function">rs</a> <a id="7033" class="Symbol">:</a> <a id="7035" href="Ledger.Core.Specification.Certs.html#1246" class="Function">Rewards</a>
      <a id="7049" href="Ledger.Conway.Specification.Epoch.html#7030" class="Function">rs</a> <a id="7052" class="Symbol">=</a> <a id="7054" href="Ledger.Conway.Specification.Rewards.html#5412" class="Function">reward</a> <a id="7061" href="Ledger.Conway.Specification.Epoch.html#6105" class="Function">prevPp</a> <a id="7068" href="Ledger.Conway.Specification.Epoch.html#5815" class="Bound">b</a> <a id="7070" class="Symbol">(</a><a id="7071" href="Prelude.html#3280" class="Function">posPart</a> <a id="7079" href="Ledger.Conway.Specification.Epoch.html#6807" class="Function">R</a><a id="7080" class="Symbol">)</a> <a id="7082" href="Ledger.Conway.Specification.Epoch.html#6466" class="Function">poolParams</a> <a id="7093" href="Ledger.Conway.Specification.Epoch.html#6348" class="Function">stake</a> <a id="7099" href="Ledger.Conway.Specification.Epoch.html#6400" class="Function">delegs</a> <a id="7106" href="Ledger.Conway.Specification.Epoch.html#6967" class="Function">circulation</a>

      <a id="7125" href="Ledger.Conway.Specification.Epoch.html#7125" class="Function">Δr₂</a> <a id="7129" class="Symbol">:</a> <a id="7131" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
      <a id="7139" href="Ledger.Conway.Specification.Epoch.html#7125" class="Function">Δr₂</a> <a id="7143" class="Symbol">=</a> <a id="7145" href="Ledger.Conway.Specification.Epoch.html#6807" class="Function">R</a> <a id="7147" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7149" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="7153" class="Symbol">(</a><a id="7154" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7157" href="Ledger.Conway.Specification.Epoch.html#7157" class="Bound">c</a> <a id="7159" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7161" href="Ledger.Conway.Specification.Epoch.html#7030" class="Function">rs</a> <a id="7164" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7166" href="Ledger.Conway.Specification.Epoch.html#7157" class="Bound">c</a><a id="7167" class="Symbol">)</a>


      <a id="7177" class="Comment">-- Proofs</a>
      <a id="7193" class="Comment">-- Note: Overloading of + and - seems to interfere with the ring solver.</a>
      <a id="7272" href="Ledger.Conway.Specification.Epoch.html#7272" class="Function">lemmaFlow</a> <a id="7282" class="Symbol">:</a> <a id="7284" class="Symbol">∀</a> <a id="7286" class="Symbol">(</a><a id="7287" href="Ledger.Conway.Specification.Epoch.html#7287" class="Bound">t₁</a> <a id="7290" href="Ledger.Conway.Specification.Epoch.html#7290" class="Bound">r₁</a> <a id="7293" href="Ledger.Conway.Specification.Epoch.html#7293" class="Bound">f</a> <a id="7295" href="Ledger.Conway.Specification.Epoch.html#7295" class="Bound">z</a> <a id="7297" class="Symbol">:</a> <a id="7299" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="7300" class="Symbol">)</a>
        <a id="7310" class="Symbol">→</a> <a id="7312" class="Symbol">(</a><a id="7313" href="Ledger.Conway.Specification.Epoch.html#7287" class="Bound">t₁</a> <a id="7316" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7320" class="Symbol">(</a><a id="7321" class="Number">0</a> <a id="7323" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7327" href="Ledger.Conway.Specification.Epoch.html#7290" class="Bound">r₁</a> <a id="7330" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7334" class="Symbol">((</a><a id="7336" href="Ledger.Conway.Specification.Epoch.html#7293" class="Bound">f</a> <a id="7338" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7342" href="Ledger.Conway.Specification.Epoch.html#7290" class="Bound">r₁</a> <a id="7345" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7349" href="Ledger.Conway.Specification.Epoch.html#7287" class="Bound">t₁</a><a id="7351" class="Symbol">)</a> <a id="7353" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7357" href="Ledger.Conway.Specification.Epoch.html#7295" class="Bound">z</a><a id="7358" class="Symbol">))</a> <a id="7361" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7365" class="Symbol">(</a><a id="7366" class="Number">0</a> <a id="7368" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7372" href="Ledger.Conway.Specification.Epoch.html#7293" class="Bound">f</a><a id="7373" class="Symbol">)</a> <a id="7375" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7379" href="Ledger.Conway.Specification.Epoch.html#7295" class="Bound">z</a><a id="7380" class="Symbol">)</a> <a id="7382" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7384" class="Number">0</a>
      <a id="7392" href="Ledger.Conway.Specification.Epoch.html#7272" class="Function">lemmaFlow</a> <a id="7402" class="Symbol">=</a> <a id="7404" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a>
      <a id="7418" href="Ledger.Conway.Specification.Epoch.html#7418" class="Function">flowConservation</a> <a id="7435" class="Symbol">:</a>
        <a id="7445" class="Keyword">let</a> <a id="7449" href="Ledger.Conway.Specification.Epoch.html#7449" class="Bound">t₁</a> <a id="7452" class="Symbol">=</a> <a id="7454" href="Ledger.Conway.Specification.Epoch.html#6803" class="Function">Δt₁</a>
            <a id="7470" href="Ledger.Conway.Specification.Epoch.html#7470" class="Bound">r₁</a> <a id="7473" class="Symbol">=</a> <a id="7475" href="Ledger.Conway.Specification.Epoch.html#6789" class="Function">Δr₁</a>
            <a id="7491" href="Ledger.Conway.Specification.Epoch.html#7491" class="Bound">f</a>  <a id="7494" class="Symbol">=</a> <a id="7496" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="7500" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a>
            <a id="7518" href="Ledger.Conway.Specification.Epoch.html#7518" class="Bound">z</a>  <a id="7521" class="Symbol">=</a> <a id="7523" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="7527" class="Symbol">(</a><a id="7528" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7531" href="Ledger.Conway.Specification.Epoch.html#7531" class="Bound">c</a> <a id="7533" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7535" href="Ledger.Conway.Specification.Epoch.html#7030" class="Function">rs</a> <a id="7538" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7540" href="Ledger.Conway.Specification.Epoch.html#7531" class="Bound">c</a><a id="7541" class="Symbol">)</a>
         <a id="7552" class="Keyword">in</a>
            <a id="7567" class="Symbol">(</a><a id="7568" href="Ledger.Conway.Specification.Epoch.html#7449" class="Bound">t₁</a> <a id="7571" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7575" class="Symbol">(</a><a id="7576" class="Number">0</a> <a id="7578" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7582" href="Ledger.Conway.Specification.Epoch.html#7470" class="Bound">r₁</a> <a id="7585" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7589" class="Symbol">((</a><a id="7591" href="Ledger.Conway.Specification.Epoch.html#7491" class="Bound">f</a> <a id="7593" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7597" href="Ledger.Conway.Specification.Epoch.html#7470" class="Bound">r₁</a> <a id="7600" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7604" href="Ledger.Conway.Specification.Epoch.html#7449" class="Bound">t₁</a><a id="7606" class="Symbol">)</a> <a id="7608" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7612" href="Ledger.Conway.Specification.Epoch.html#7518" class="Bound">z</a><a id="7613" class="Symbol">))</a> <a id="7616" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7620" class="Symbol">(</a><a id="7621" class="Number">0</a> <a id="7623" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7627" href="Ledger.Conway.Specification.Epoch.html#7491" class="Bound">f</a><a id="7628" class="Symbol">)</a> <a id="7630" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7634" href="Ledger.Conway.Specification.Epoch.html#7518" class="Bound">z</a><a id="7635" class="Symbol">)</a> <a id="7637" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7639" class="Number">0</a>
      <a id="7647" href="Ledger.Conway.Specification.Epoch.html#7418" class="Function">flowConservation</a> <a id="7664" class="Symbol">=</a> <a id="7666" href="Ledger.Conway.Specification.Epoch.html#7272" class="Function">lemmaFlow</a> <a id="7676" href="Ledger.Conway.Specification.Epoch.html#6803" class="Function">Δt₁</a> <a id="7680" href="Ledger.Conway.Specification.Epoch.html#6789" class="Function">Δr₁</a> <a id="7684" class="Symbol">(</a><a id="7685" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="7689" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a><a id="7694" class="Symbol">)</a> <a id="7696" class="Symbol">(</a><a id="7697" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="7701" class="Symbol">(</a><a id="7702" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7705" href="Ledger.Conway.Specification.Epoch.html#7705" class="Bound">c</a> <a id="7707" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7709" href="Ledger.Conway.Specification.Epoch.html#7030" class="Function">rs</a> <a id="7712" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7714" href="Ledger.Conway.Specification.Epoch.html#7705" class="Bound">c</a><a id="7715" class="Symbol">))</a>

      <a id="7725" href="Ledger.Conway.Specification.Epoch.html#7725" class="Function">÷₀-0≤⇒0≤</a> <a id="7734" class="Symbol">:</a> <a id="7736" class="Symbol">∀</a> <a id="7738" class="Symbol">(</a><a id="7739" href="Ledger.Conway.Specification.Epoch.html#7739" class="Bound">x</a> <a id="7741" href="Ledger.Conway.Specification.Epoch.html#7741" class="Bound">y</a> <a id="7743" class="Symbol">:</a> <a id="7745" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="7746" class="Symbol">)</a> <a id="7748" class="Symbol">→</a> <a id="7750" class="Number">0</a> <a id="7752" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7754" href="Ledger.Conway.Specification.Epoch.html#7739" class="Bound">x</a> <a id="7756" class="Symbol">→</a> <a id="7758" class="Number">0</a> <a id="7760" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7762" href="Ledger.Conway.Specification.Epoch.html#7741" class="Bound">y</a> <a id="7764" class="Symbol">→</a> <a id="7766" class="Number">0</a> <a id="7768" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7770" class="Symbol">(</a><a id="7771" href="Ledger.Conway.Specification.Epoch.html#7739" class="Bound">x</a> <a id="7773" href="Ledger.Prelude.html#2064" class="Function Operator">÷₀</a> <a id="7776" href="Ledger.Conway.Specification.Epoch.html#7741" class="Bound">y</a><a id="7777" class="Symbol">)</a>
      <a id="7785" href="Ledger.Conway.Specification.Epoch.html#7725" class="Function">÷₀-0≤⇒0≤</a> <a id="7794" href="Ledger.Conway.Specification.Epoch.html#7794" class="Bound">x</a> <a id="7796" href="Ledger.Conway.Specification.Epoch.html#7796" class="Bound">y</a> <a id="7798" href="Ledger.Conway.Specification.Epoch.html#7798" class="Bound">0≤x</a> <a id="7802" href="Ledger.Conway.Specification.Epoch.html#7802" class="Bound">0≤y</a> <a id="7806" class="Keyword">with</a> <a id="7811" href="Ledger.Conway.Specification.Epoch.html#7796" class="Bound">y</a> <a id="7813" href="Data.Rational.Properties.html#4152" class="Function Operator">≟</a> <a id="7815" class="Number">0</a>
      <a id="7823" class="Symbol">...</a> <a id="7827" class="Symbol">|</a> <a id="7829" class="Symbol">(</a><a id="7830" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="7834" href="Ledger.Conway.Specification.Epoch.html#7834" class="Bound">y≡0</a><a id="7837" class="Symbol">)</a> <a id="7839" class="Symbol">=</a> <a id="7841" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="7855" class="Number">0</a>
      <a id="7863" class="Symbol">...</a> <a id="7867" class="Symbol">|</a> <a id="7869" class="Symbol">(</a><a id="7870" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="7873" href="Ledger.Conway.Specification.Epoch.html#7873" class="Bound">y≢0</a><a id="7876" class="Symbol">)</a>  <a id="7879" class="Symbol">=</a> <a id="7881" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a> <a id="7889" class="Bound">x</a> <a id="7891" class="Bound">y</a> <a id="7893" class="Symbol">{{</a><a id="7895" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a> <a id="7905" href="Ledger.Conway.Specification.Epoch.html#7873" class="Bound">y≢0</a><a id="7908" class="Symbol">}}</a> <a id="7911" class="Bound">0≤x</a> <a id="7915" class="Bound">0≤y</a>

      <a id="7926" href="Ledger.Conway.Specification.Epoch.html#7926" class="Function">η-nonneg</a> <a id="7935" class="Symbol">:</a> <a id="7937" class="Number">0</a> <a id="7939" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7941" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">η</a>
      <a id="7949" href="Ledger.Conway.Specification.Epoch.html#7926" class="Function">η-nonneg</a> <a id="7958" class="Symbol">=</a> <a id="7960" href="Ledger.Conway.Specification.Epoch.html#7725" class="Function">÷₀-0≤⇒0≤</a> <a id="7969" class="Symbol">_</a> <a id="7971" class="Symbol">_</a> <a id="7973" class="Symbol">(</a><a id="7974" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="7983" href="Ledger.Conway.Specification.Epoch.html#6528" class="Function">blocksMade</a><a id="7993" class="Symbol">)</a>
        <a id="8003" class="Symbol">(</a><a id="8004" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="8012" class="Symbol">_</a> <a id="8014" class="Symbol">_</a>
          <a id="8026" class="Symbol">(</a><a id="8027" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="8036" href="Ledger.Conway.Specification.Epoch.html#5801" class="Bound">slotsPerEpoch</a><a id="8049" class="Symbol">)</a>
          <a id="8061" class="Symbol">(</a><a id="8062" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="8076" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a> <a id="8092" class="Symbol">{{</a><a id="8094" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a> <a id="8105" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a><a id="8120" class="Symbol">}}))</a>

      <a id="8132" href="Ledger.Conway.Specification.Epoch.html#8132" class="Function">min1η-nonneg</a> <a id="8145" class="Symbol">:</a> <a id="8147" class="Number">0</a> <a id="8149" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8151" class="Number">1</a> <a id="8153" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8155" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">η</a>
      <a id="8163" href="Ledger.Conway.Specification.Epoch.html#8132" class="Function">min1η-nonneg</a> <a id="8176" class="Symbol">=</a> <a id="8178" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a> <a id="8184" class="Symbol">(</a><a id="8185" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="8199" class="Number">1</a><a id="8200" class="Symbol">)</a> <a id="8202" href="Ledger.Conway.Specification.Epoch.html#7926" class="Function">η-nonneg</a>

      <a id="8218" href="Ledger.Conway.Specification.Epoch.html#8218" class="Function">Δr₁-nonneg</a> <a id="8229" class="Symbol">:</a> <a id="8231" class="Number">0</a> <a id="8233" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8235" href="Ledger.Conway.Specification.Epoch.html#6789" class="Function">Δr₁</a>
      <a id="8245" href="Ledger.Conway.Specification.Epoch.html#8218" class="Function">Δr₁-nonneg</a> <a id="8256" class="Symbol">=</a> <a id="8258" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="8269" class="Symbol">_</a>
        <a id="8279" class="Symbol">(</a><a id="8280" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="8288" class="Symbol">(</a><a id="8289" class="Number">1</a> <a id="8291" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8293" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">η</a> <a id="8295" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="8297" href="Ledger.Conway.Specification.Epoch.html#6582" class="Function">ρ</a><a id="8298" class="Symbol">)</a> <a id="8300" class="Symbol">(</a><a id="8301" href="Ledger.Conway.Specification.Epoch.html#1817" class="Function">fromℕ</a> <a id="8307" href="Ledger.Conway.Specification.Epoch.html#6157" class="Function">reserves</a><a id="8315" class="Symbol">)</a>
          <a id="8327" class="Symbol">(</a><a id="8328" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a> <a id="8346" class="Symbol">(</a><a id="8347" class="Number">1</a> <a id="8349" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8351" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">η</a><a id="8352" class="Symbol">)</a> <a id="8354" class="Symbol">(</a><a id="8355" href="Ledger.Conway.Specification.Epoch.html#6105" class="Function">prevPp</a> <a id="8362" class="Symbol">.</a><a id="8363" href="Ledger.Conway.Specification.PParams.html#2283" class="Field">PParams.monetaryExpansion</a><a id="8388" class="Symbol">)</a> <a id="8390" href="Ledger.Conway.Specification.Epoch.html#8132" class="Function">min1η-nonneg</a><a id="8402" class="Symbol">)</a>
          <a id="8414" class="Symbol">(</a><a id="8415" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="8424" href="Ledger.Conway.Specification.Epoch.html#6157" class="Function">reserves</a><a id="8432" class="Symbol">))</a>

      <a id="8442" href="Ledger.Conway.Specification.Epoch.html#8442" class="Function">rewardPot-nonneg</a> <a id="8459" class="Symbol">:</a> <a id="8461" class="Number">0</a> <a id="8463" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8465" href="Ledger.Conway.Specification.Epoch.html#6793" class="Function">rewardPot</a>
      <a id="8481" href="Ledger.Conway.Specification.Epoch.html#8442" class="Function">rewardPot-nonneg</a> <a id="8498" class="Symbol">=</a> <a id="8500" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a> <a id="8509" class="Symbol">(</a><a id="8510" href="Ledger.Conway.Specification.Epoch.html#594" class="Function">nonNegative⁻¹ℤ</a> <a id="8525" class="Symbol">(</a><a id="8526" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="8530" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a><a id="8535" class="Symbol">))</a> <a id="8538" href="Ledger.Conway.Specification.Epoch.html#8218" class="Function">Δr₁-nonneg</a>

      <a id="8556" href="Ledger.Conway.Specification.Epoch.html#8556" class="Function">Δt-nonneg</a> <a id="8566" class="Symbol">:</a> <a id="8568" class="Number">0</a> <a id="8570" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8572" href="Ledger.Conway.Specification.Epoch.html#6803" class="Function">Δt₁</a>
      <a id="8582" href="Ledger.Conway.Specification.Epoch.html#8556" class="Function">Δt-nonneg</a> <a id="8592" class="Symbol">=</a> <a id="8594" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="8605" class="Symbol">_</a>
        <a id="8615" class="Symbol">(</a><a id="8616" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a> <a id="8634" class="Symbol">(</a><a id="8635" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="8641" href="Ledger.Conway.Specification.Epoch.html#6793" class="Function">rewardPot</a><a id="8650" class="Symbol">)</a> <a id="8652" class="Symbol">(</a><a id="8653" href="Ledger.Conway.Specification.Epoch.html#6105" class="Function">prevPp</a> <a id="8660" class="Symbol">.</a><a id="8661" href="Ledger.Conway.Specification.PParams.html#2353" class="Field">PParams.treasuryCut</a><a id="8680" class="Symbol">)</a>
          <a id="8692" class="Symbol">(</a><a id="8693" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a> <a id="8702" href="Ledger.Conway.Specification.Epoch.html#6793" class="Function">rewardPot</a> <a id="8712" href="Ledger.Conway.Specification.Epoch.html#8442" class="Function">rewardPot-nonneg</a><a id="8728" class="Symbol">))</a>

      <a id="8738" href="Ledger.Conway.Specification.Epoch.html#8738" class="Function">Δf-nonpos</a> <a id="8748" class="Symbol">:</a> <a id="8750" class="Symbol">(</a><a id="8751" class="Number">0</a> <a id="8753" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="8755" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="8759" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a><a id="8764" class="Symbol">)</a> <a id="8766" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8768" class="Number">0</a>
      <a id="8776" href="Ledger.Conway.Specification.Epoch.html#8738" class="Function">Δf-nonpos</a> <a id="8786" class="Symbol">=</a> <a id="8788" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
          <a id="8804" class="Number">0</a> <a id="8806" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="8808" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="8812" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a> <a id="8818" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="8821" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a> <a id="8833" class="Symbol">_</a> <a id="8835" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
          <a id="8847" href="Data.Integer.Base.html#4719" class="Function Operator">ℤ.-</a> <a id="8851" href="Ledger.Conway.Specification.Epoch.html#412" class="InductiveConstructor">pos</a> <a id="8855" href="Ledger.Conway.Specification.Epoch.html#6290" class="Function">feeSS</a> <a id="8861" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="8864" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a> <a id="8875" class="Symbol">(</a><a id="8876" href="Data.Integer.Base.html#2106" class="InductiveConstructor">ℤ.+≤+</a> <a id="8882" href="Data.Nat.Base.html#1720" class="InductiveConstructor">z≤n</a><a id="8885" class="Symbol">)</a> <a id="8887" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
          <a id="8899" class="Number">0</a>             <a id="8913" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="8923" class="Keyword">where</a> <a id="8929" class="Keyword">open</a> <a id="8934" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a>


<a id="applyRUpd"></a><a id="8948" href="Ledger.Conway.Specification.Epoch.html#8948" class="Function">applyRUpd</a> <a id="8958" class="Symbol">:</a> <a id="8960" href="Ledger.Conway.Specification.Rewards.html#6264" class="Record">RewardUpdate</a> <a id="8973" class="Symbol">→</a> <a id="8975" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a> <a id="8986" class="Symbol">→</a> <a id="8988" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
<a id="8999" href="Ledger.Conway.Specification.Epoch.html#8948" class="Function">applyRUpd</a> <a id="9009" href="Ledger.Conway.Specification.Epoch.html#9009" class="Bound">rewardUpdate</a> <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9026}{\htmlId{9026}{\htmlClass{Bound}{\text{treasury}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9037}{\htmlId{9037}{\htmlClass{Bound}{\text{reserves}}}}\, \end{pmatrix}
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9074}{\htmlId{9074}{\htmlClass{Bound}{\text{ss}}}}\,
                       \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9106}{\htmlId{9106}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9113}{\htmlId{9113}{\htmlClass{Bound}{\text{fees}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9120}{\htmlId{9120}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9131}{\htmlId{9131}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
                         \\ \,\href{Ledger.Conway.Specification.Epoch.html#9171}{\htmlId{9171}{\htmlClass{Bound}{\text{govSt}}}}\,
                         \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9208}{\htmlId{9208}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9221}{\htmlId{9221}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9235}{\htmlId{9235}{\htmlClass{Bound}{\text{rewards}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#9248}{\htmlId{9248}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9257}{\htmlId{9257}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9296}{\htmlId{9296}{\htmlClass{Bound}{\text{es}}}}\,
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9324}{\htmlId{9324}{\htmlClass{Bound}{\text{fut}}}}\,
                       \end{pmatrix}$</a> <a id="9355" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Prelude.html#3280}{\htmlId{9361}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9369}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#412}{\htmlId{9370}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9026}{\htmlId{9374}{\htmlClass{Bound}{\text{treasury}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9383}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6301}{\htmlId{9385}{\htmlClass{Function}{\text{Δt}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9388}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#412}{\htmlId{9390}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9945}{\htmlId{9394}{\htmlClass{Function}{\text{unregRU&#39;}}}}\,\,\htmlId{9402}{\htmlClass{Symbol}{\text{)}}}\,
                               \\ \,\href{Prelude.html#3280}{\htmlId{9437}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9445}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#412}{\htmlId{9446}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9037}{\htmlId{9450}{\htmlClass{Bound}{\text{reserves}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9459}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6304}{\htmlId{9461}{\htmlClass{Function}{\text{Δr}}}}\,\,\htmlId{9463}{\htmlClass{Symbol}{\text{)}}}\, \end{pmatrix}
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9074}{\htmlId{9498}{\htmlClass{Bound}{\text{ss}}}}\,
                             \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9106}{\htmlId{9536}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Prelude.html#3280}{\htmlId{9543}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9551}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#412}{\htmlId{9552}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9113}{\htmlId{9556}{\htmlClass{Bound}{\text{fees}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9561}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6307}{\htmlId{9563}{\htmlClass{Function}{\text{Δf}}}}\,\,\htmlId{9565}{\htmlClass{Symbol}{\text{)}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9120}{\htmlId{9569}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9131}{\htmlId{9580}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
                               \\ \,\href{Ledger.Conway.Specification.Epoch.html#9171}{\htmlId{9625}{\htmlClass{Bound}{\text{govSt}}}}\,
                               \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9208}{\htmlId{9668}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9221}{\htmlId{9681}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9235}{\htmlId{9695}{\htmlClass{Bound}{\text{rewards}}}}\, \,\href{Axiom.Set.Map.Dec.html#2149}{\htmlId{9703}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9877}{\htmlId{9706}{\htmlClass{Function}{\text{regRU}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#9248}{\htmlId{9716}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9257}{\htmlId{9725}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9296}{\htmlId{9767}{\htmlClass{Bound}{\text{es}}}}\,
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9324}{\htmlId{9801}{\htmlClass{Bound}{\text{fut}}}}\, \end{pmatrix}$</a>
  <a id="9809" class="Keyword">where</a>
    <a id="9819" class="Keyword">open</a> <a id="9824" href="Ledger.Conway.Specification.Rewards.html#6264" class="Module">RewardUpdate</a> <a id="9837" href="Ledger.Conway.Specification.Epoch.html#9009" class="Bound">rewardUpdate</a> <a id="9850" class="Keyword">using</a> <a id="9856" class="Symbol">(</a><a id="9857" href="Ledger.Conway.Specification.Rewards.html#6301" class="Field">Δt</a><a id="9859" class="Symbol">;</a> <a id="9861" href="Ledger.Conway.Specification.Rewards.html#6304" class="Field">Δr</a><a id="9863" class="Symbol">;</a> <a id="9865" href="Ledger.Conway.Specification.Rewards.html#6307" class="Field">Δf</a><a id="9867" class="Symbol">;</a> <a id="9869" href="Ledger.Conway.Specification.Rewards.html#6327" class="Field">rs</a><a id="9871" class="Symbol">)</a>
    <a id="9877" href="Ledger.Conway.Specification.Epoch.html#9877" class="Function">regRU</a>     <a id="9887" class="Symbol">=</a> <a id="9889" href="Ledger.Conway.Specification.Rewards.html#6327" class="Function">rs</a> <a id="9892" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="9894" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9898" href="Ledger.Conway.Specification.Epoch.html#9235" class="Bound">rewards</a>
    <a id="9910" href="Ledger.Conway.Specification.Epoch.html#9910" class="Function">unregRU</a>   <a id="9920" class="Symbol">=</a> <a id="9922" href="Ledger.Conway.Specification.Rewards.html#6327" class="Function">rs</a> <a id="9925" href="Axiom.Set.Map.html#13606" class="Function Operator">∣</a> <a id="9927" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9931" href="Ledger.Conway.Specification.Epoch.html#9235" class="Bound">rewards</a> <a id="9939" href="Axiom.Set.Map.html#13606" class="Function Operator">ᶜ</a>
    <a id="9945" href="Ledger.Conway.Specification.Epoch.html#9945" class="Function">unregRU&#39;</a>  <a id="9955" class="Symbol">=</a> <a id="9957" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="9960" href="Ledger.Conway.Specification.Epoch.html#9960" class="Bound">x</a> <a id="9962" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="9964" href="Ledger.Conway.Specification.Epoch.html#9910" class="Function">unregRU</a> <a id="9972" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="9974" href="Ledger.Conway.Specification.Epoch.html#9960" class="Bound">x</a>


<a id="9978" class="Keyword">open</a> <a id="9983" href="Ledger.Core.Specification.Address.html#1313" class="Module">RewardAddress</a> <a id="9997" class="Keyword">using</a> <a id="10003" class="Symbol">(</a><a id="10004" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a><a id="10009" class="Symbol">)</a>
<a id="10011" class="Keyword">opaque</a>


  <a id="calculatePoolDelegatedStake"></a><a id="10022" href="Ledger.Conway.Specification.Epoch.html#10022" class="Function">calculatePoolDelegatedStake</a>
    <a id="10054" class="Symbol">:</a> <a id="10056" href="Ledger.Conway.Specification.Rewards.html#6487" class="Record">Snapshot</a>
    <a id="10069" class="Symbol">→</a> <a id="10071" href="Ledger.Conway.Specification.Epoch.html#3514" class="Function">PoolDelegatedStake</a>
  <a id="10092" href="Ledger.Conway.Specification.Epoch.html#10022" class="Function">calculatePoolDelegatedStake</a> <a id="10120" href="Ledger.Conway.Specification.Epoch.html#10120" class="Bound">ss</a> <a id="10123" class="Symbol">=</a>
      <a id="10131" class="Comment">-- Shelley spec: the output map must contain keys appearing in both</a>
      <a id="10205" class="Comment">-- sd and the pool parameters.</a>
      <a id="10242" href="Ledger.Conway.Specification.Epoch.html#10478" class="Function">sd</a> <a id="10245" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="10247" href="Class.IsSet.html#916" class="Function">dom</a> <a id="10251" class="Symbol">(</a><a id="10252" href="Ledger.Core.Specification.Certs.html#1531" class="Field">PoolsOf</a> <a id="10260" href="Ledger.Conway.Specification.Epoch.html#10120" class="Bound">ss</a><a id="10262" class="Symbol">)</a>
    <a id="10268" class="Keyword">where</a>
      <a id="10280" class="Comment">-- stake credentials delegating to each pool</a>
      <a id="10331" href="Ledger.Conway.Specification.Epoch.html#10331" class="Function">stakeCredentialsPerPool</a> <a id="10355" class="Symbol">:</a> <a id="10357" href="Axiom.Set.Rel.html#1312" class="Function">Rel</a> <a id="10361" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="10369" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
      <a id="10386" href="Ledger.Conway.Specification.Epoch.html#10331" class="Function">stakeCredentialsPerPool</a> <a id="10410" class="Symbol">=</a> <a id="10412" class="Symbol">(</a><a id="10413" href="Ledger.Core.Specification.Certs.html#1861" class="Field">StakeDelegsOf</a> <a id="10427" href="Ledger.Conway.Specification.Epoch.html#10120" class="Bound">ss</a> <a id="10430" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10431" class="Symbol">)</a> <a id="10433" href="Axiom.Set.Rel.html#1608" class="Function Operator">⁻¹ʳ</a>

      <a id="10444" class="Comment">-- delegated stake per pool</a>
      <a id="10478" href="Ledger.Conway.Specification.Epoch.html#10478" class="Function">sd</a> <a id="10481" class="Symbol">:</a> <a id="10483" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="10491" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="10493" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="10504" href="Ledger.Conway.Specification.Epoch.html#10478" class="Function">sd</a> <a id="10507" class="Symbol">=</a> <a id="10509" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="10520" class="Symbol">((</a><a id="10522" href="Ledger.Conway.Specification.Epoch.html#10331" class="Function">stakeCredentialsPerPool</a> <a id="10546" href="abstract-set-theory.FiniteSetTheory.html#3111" class="Function Operator">∘ʳ</a> <a id="10549" class="Symbol">(</a><a id="10550" href="Ledger.Core.Specification.Certs.html#1777" class="Field">StakeOf</a> <a id="10558" href="Ledger.Conway.Specification.Epoch.html#10120" class="Bound">ss</a> <a id="10561" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10562" class="Symbol">))</a> <a id="10565" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="10567" class="Symbol">)</a>


  <a id="stakeFromGADeposits"></a><a id="10573" href="Ledger.Conway.Specification.Epoch.html#10573" class="Function">stakeFromGADeposits</a>
    <a id="10597" class="Symbol">:</a> <a id="10599" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
    <a id="10612" class="Symbol">→</a> <a id="10614" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a>
    <a id="10628" class="Symbol">→</a> <a id="10630" href="Ledger.Core.Specification.Certs.html#1290" class="Function">Stake</a>
  <a id="10638" href="Ledger.Conway.Specification.Epoch.html#10573" class="Function">stakeFromGADeposits</a> <a id="10658" href="Ledger.Conway.Specification.Epoch.html#10658" class="Bound">govSt</a> <a id="10664" href="Ledger.Conway.Specification.Epoch.html#10664" class="Bound">utxoSt</a> <a id="10671" class="Symbol">=</a> <a id="10673" href="abstract-set-theory.FiniteSetTheory.html#4855" class="Function">aggregateBy</a>
     <a id="10690" class="Symbol">(</a><a id="10691" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10696" class="Symbol">(λ</a> <a id="10699" class="Symbol">(</a><a id="10700" href="Ledger.Conway.Specification.Epoch.html#10700" class="Bound">gaid</a> <a id="10705" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10707" href="Ledger.Conway.Specification.Epoch.html#10707" class="Bound">addr</a><a id="10711" class="Symbol">)</a> <a id="10713" class="Symbol">→</a> <a id="10715" class="Symbol">(</a><a id="10716" href="Ledger.Conway.Specification.Epoch.html#10700" class="Bound">gaid</a> <a id="10721" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10723" href="Ledger.Conway.Specification.Epoch.html#10707" class="Bound">addr</a><a id="10727" class="Symbol">)</a> <a id="10729" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10731" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a> <a id="10737" href="Ledger.Conway.Specification.Epoch.html#10707" class="Bound">addr</a><a id="10741" class="Symbol">)</a> <a id="10743" href="Ledger.Conway.Specification.Epoch.html#10890" class="Function">govSt&#39;</a><a id="10749" class="Symbol">)</a>
     <a id="10756" class="Symbol">(</a><a id="10757" href="Axiom.Set.Map.html#13318" class="Function">mapFromPartialFun</a> <a id="10775" class="Symbol">(λ</a> <a id="10778" class="Symbol">(</a><a id="10779" href="Ledger.Conway.Specification.Epoch.html#10779" class="Bound">gaid</a> <a id="10784" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10786" class="Symbol">_)</a> <a id="10789" class="Symbol">→</a> <a id="10791" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="10800" href="Ledger.Conway.Specification.Utxo.html#1414" class="Field">deposits</a> <a id="10809" class="Symbol">(</a><a id="10810" href="Ledger.Core.Specification.Certs.html#723" class="InductiveConstructor">GovActionDeposit</a> <a id="10827" href="Ledger.Conway.Specification.Epoch.html#10779" class="Bound">gaid</a><a id="10831" class="Symbol">))</a> <a id="10834" href="Ledger.Conway.Specification.Epoch.html#10890" class="Function">govSt&#39;</a><a id="10840" class="Symbol">)</a>
     <a id="10847" class="Keyword">where</a>
       <a id="10860" class="Keyword">open</a> <a id="10865" href="Ledger.Conway.Specification.Utxo.html#1306" class="Module">UTxOState</a> <a id="10875" href="Ledger.Conway.Specification.Epoch.html#10664" class="Bound">utxoSt</a>

       <a id="10890" href="Ledger.Conway.Specification.Epoch.html#10890" class="Function">govSt&#39;</a> <a id="10897" class="Symbol">:</a> <a id="10899" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="10901" class="Symbol">(</a><a id="10902" href="Ledger.Core.Specification.Gov.Actions.html#1976" class="Function">GovActionID</a> <a id="10914" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10916" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a><a id="10929" class="Symbol">)</a>
       <a id="10938" href="Ledger.Conway.Specification.Epoch.html#10890" class="Function">govSt&#39;</a> <a id="10945" class="Symbol">=</a> <a id="10947" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10952" class="Symbol">(</a><a id="10953" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="10958" href="Ledger.Core.Specification.Gov.Actions.html#3885" class="Field">returnAddr</a><a id="10968" class="Symbol">)</a> <a id="10970" class="Symbol">(</a><a id="10971" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="10980" href="Ledger.Conway.Specification.Epoch.html#10658" class="Bound">govSt</a><a id="10985" class="Symbol">)</a>


<a id="10989" class="Keyword">module</a> <a id="VDelegDelegatedStake"></a><a id="10996" href="Ledger.Conway.Specification.Epoch.html#10996" class="Module">VDelegDelegatedStake</a>
  <a id="11019" class="Symbol">(</a><a id="11020" href="Ledger.Conway.Specification.Epoch.html#11020" class="Bound">currentEpoch</a> <a id="11033" class="Symbol">:</a> <a id="11035" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a><a id="11040" class="Symbol">)</a>
  <a id="11044" class="Symbol">(</a><a id="11045" href="Ledger.Conway.Specification.Epoch.html#11045" class="Bound">utxoSt</a>       <a id="11058" class="Symbol">:</a> <a id="11060" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a><a id="11069" class="Symbol">)</a>
  <a id="11073" class="Symbol">(</a><a id="11074" href="Ledger.Conway.Specification.Epoch.html#11074" class="Bound">govSt</a>        <a id="11087" class="Symbol">:</a> <a id="11089" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a><a id="11097" class="Symbol">)</a>
  <a id="11101" class="Symbol">(</a><a id="11102" href="Ledger.Conway.Specification.Epoch.html#11102" class="Bound">gState</a>       <a id="11115" class="Symbol">:</a> <a id="11117" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a><a id="11123" class="Symbol">)</a>
  <a id="11127" class="Symbol">(</a><a id="11128" href="Ledger.Conway.Specification.Epoch.html#11128" class="Bound">dState</a>       <a id="11141" class="Symbol">:</a> <a id="11143" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a><a id="11149" class="Symbol">)</a>
  <a id="11153" class="Keyword">where</a>

  <a id="VDelegDelegatedStake.activeDReps"></a><a id="11162" href="Ledger.Conway.Specification.Epoch.html#11162" class="Function">activeDReps</a> <a id="11174" class="Symbol">:</a> <a id="11176" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="11178" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
  <a id="11191" href="Ledger.Conway.Specification.Epoch.html#11162" class="Function">activeDReps</a> <a id="11203" class="Symbol">=</a> <a id="11205" href="Class.IsSet.html#916" class="Function">dom</a> <a id="11209" class="Symbol">(</a><a id="11210" href="Ledger.Core.Specification.Gov.Actions.html#7240" class="Function">activeDRepsOf</a> <a id="11224" href="Ledger.Conway.Specification.Epoch.html#11102" class="Bound">gState</a> <a id="11231" href="Ledger.Conway.Specification.Epoch.html#11020" class="Bound">currentEpoch</a><a id="11243" class="Symbol">)</a>

  <a id="VDelegDelegatedStake.activeVDelegs"></a><a id="11248" href="Ledger.Conway.Specification.Epoch.html#11248" class="Function">activeVDelegs</a> <a id="11262" class="Symbol">:</a> <a id="11264" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="11266" href="Ledger.Core.Specification.Gov.Actions.html#2566" class="Datatype">VDeleg</a>
  <a id="11275" href="Ledger.Conway.Specification.Epoch.html#11248" class="Function">activeVDelegs</a> <a id="11289" class="Symbol">=</a> <a id="11291" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="11296" href="Ledger.Core.Specification.Gov.Actions.html#2588" class="InductiveConstructor">vDelegCredential</a> <a id="11313" href="Ledger.Conway.Specification.Epoch.html#11162" class="Function">activeDReps</a> <a id="11325" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="11327" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="11329" href="Ledger.Core.Specification.Gov.Actions.html#2661" class="InductiveConstructor">vDelegNoConfidence</a> <a id="11348" href="Class.HasSingleton.html#288" class="Field Operator">❵</a> <a id="11350" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="11352" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="11354" href="Ledger.Core.Specification.Gov.Actions.html#2631" class="InductiveConstructor">vDelegAbstain</a> <a id="11368" href="Class.HasSingleton.html#288" class="Field Operator">❵</a>

  <a id="11373" class="Comment">-- compute the stake for a credential</a>
  <a id="VDelegDelegatedStake.stakePerCredential"></a><a id="11413" href="Ledger.Conway.Specification.Epoch.html#11413" class="Function">stakePerCredential</a> <a id="11432" class="Symbol">:</a> <a id="11434" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="11445" class="Symbol">→</a> <a id="11447" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11454" href="Ledger.Conway.Specification.Epoch.html#11413" class="Function">stakePerCredential</a> <a id="11473" href="Ledger.Conway.Specification.Epoch.html#11473" class="Bound">c</a> <a id="11475" class="Symbol">=</a> <a id="11477" href="Ledger.Conway.Specification.Utxo.html#2532" class="Function">cbalance</a> <a id="11486" class="Symbol">((</a><a id="11488" href="Ledger.Core.Specification.Transaction.html#2830" class="Field">UTxOOf</a> <a id="11495" href="Ledger.Conway.Specification.Epoch.html#11045" class="Bound">utxoSt</a><a id="11501" class="Symbol">)</a> <a id="11503" href="abstract-set-theory.FiniteSetTheory.html#4295" class="Function Operator">∣^&#39;</a> <a id="11507" class="Symbol">λ</a> <a id="11509" href="Ledger.Conway.Specification.Epoch.html#11509" class="Bound">txout</a> <a id="11515" class="Symbol">→</a> <a id="11517" href="Ledger.Conway.Specification.Epoch.html#5590" class="Function">getStakeCred</a> <a id="11530" href="Ledger.Conway.Specification.Epoch.html#11509" class="Bound">txout</a> <a id="11536" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="11538" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="11543" href="Ledger.Conway.Specification.Epoch.html#11473" class="Bound">c</a><a id="11544" class="Symbol">)</a>
                         <a id="11571" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="11573" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="11583" class="Number">0</a> <a id="11585" class="Symbol">(</a><a id="11586" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="11595" class="Symbol">(</a><a id="11596" href="Ledger.Conway.Specification.Epoch.html#10573" class="Function">stakeFromGADeposits</a> <a id="11616" href="Ledger.Conway.Specification.Epoch.html#11074" class="Bound">govSt</a> <a id="11622" href="Ledger.Conway.Specification.Epoch.html#11045" class="Bound">utxoSt</a><a id="11628" class="Symbol">)</a> <a id="11630" href="Ledger.Conway.Specification.Epoch.html#11473" class="Bound">c</a><a id="11631" class="Symbol">)</a>
                         <a id="11658" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="11660" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="11670" class="Number">0</a> <a id="11672" class="Symbol">(</a><a id="11673" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="11682" class="Symbol">(</a><a id="11683" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="11693" href="Ledger.Conway.Specification.Epoch.html#11128" class="Bound">dState</a><a id="11699" class="Symbol">)</a> <a id="11701" href="Ledger.Conway.Specification.Epoch.html#11473" class="Bound">c</a><a id="11702" class="Symbol">)</a>

  <a id="VDelegDelegatedStake.calculate"></a><a id="11707" href="Ledger.Conway.Specification.Epoch.html#11707" class="Function">calculate</a> <a id="11717" class="Symbol">:</a> <a id="11719" href="Ledger.Core.Specification.Gov.Actions.html#2566" class="Datatype">VDeleg</a> <a id="11726" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11728" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11735" href="Ledger.Conway.Specification.Epoch.html#11707" class="Function">calculate</a> <a id="11745" class="Symbol">=</a> <a id="11747" href="Axiom.Set.Map.html#10462" class="Function">mapFromFun</a> <a id="11758" class="Symbol">(λ</a> <a id="11761" href="Ledger.Conway.Specification.Epoch.html#11761" class="Bound">vd</a> <a id="11764" class="Symbol">→</a> <a id="11766" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">∑ˢ[</a> <a id="11770" href="Ledger.Conway.Specification.Epoch.html#11770" class="Bound">c</a> <a id="11772" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">←</a> <a id="11774" class="Symbol">(</a><a id="11775" href="Ledger.Core.Specification.Gov.Actions.html#2806" class="Field">VoteDelegsOf</a> <a id="11788" href="Ledger.Conway.Specification.Epoch.html#11128" class="Bound">dState</a><a id="11794" class="Symbol">)</a> <a id="11796" href="Axiom.Set.Map.html#17957" class="Function Operator">⁻¹</a> <a id="11799" href="Ledger.Conway.Specification.Epoch.html#11761" class="Bound">vd</a> <a id="11802" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">]</a> <a id="11804" class="Symbol">(</a><a id="11805" href="Ledger.Conway.Specification.Epoch.html#11413" class="Function">stakePerCredential</a> <a id="11824" href="Ledger.Conway.Specification.Epoch.html#11770" class="Bound">c</a><a id="11825" class="Symbol">))</a>
                         <a id="11853" href="Ledger.Conway.Specification.Epoch.html#11248" class="Function">activeVDelegs</a>


<a id="11869" class="Keyword">opaque</a>


  <a id="calculateVDelegDelegatedStake"></a><a id="11880" href="Ledger.Conway.Specification.Epoch.html#11880" class="Function">calculateVDelegDelegatedStake</a>
    <a id="11914" class="Symbol">:</a> <a id="11916" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
    <a id="11926" class="Symbol">→</a> <a id="11928" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a>
    <a id="11942" class="Symbol">→</a> <a id="11944" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
    <a id="11957" class="Symbol">→</a> <a id="11959" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a>
    <a id="11970" class="Symbol">→</a> <a id="11972" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
    <a id="11983" class="Symbol">→</a> <a id="11985" href="Ledger.Core.Specification.Gov.Actions.html#2566" class="Datatype">VDeleg</a> <a id="11992" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11994" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="12001" href="Ledger.Conway.Specification.Epoch.html#11880" class="Function">calculateVDelegDelegatedStake</a> <a id="12031" class="Symbol">=</a> <a id="12033" href="Ledger.Conway.Specification.Epoch.html#11707" class="Function">VDelegDelegatedStake.calculate</a>


<a id="12066" class="Keyword">opaque</a>


  <a id="calculatePoolDelegatedStakeForVoting"></a><a id="12077" href="Ledger.Conway.Specification.Epoch.html#12077" class="Function">calculatePoolDelegatedStakeForVoting</a>
    <a id="12118" class="Symbol">:</a> <a id="12120" href="Ledger.Conway.Specification.Rewards.html#6487" class="Record">Snapshot</a>
    <a id="12133" class="Symbol">→</a> <a id="12135" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a>
    <a id="12149" class="Symbol">→</a> <a id="12151" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
    <a id="12164" class="Symbol">→</a> <a id="12166" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="12174" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12176" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="12183" href="Ledger.Conway.Specification.Epoch.html#12077" class="Function">calculatePoolDelegatedStakeForVoting</a> <a id="12220" href="Ledger.Conway.Specification.Epoch.html#12220" class="Bound">ss</a> <a id="12223" href="Ledger.Conway.Specification.Epoch.html#12223" class="Bound">utxoSt</a> <a id="12230" href="Ledger.Conway.Specification.Epoch.html#12230" class="Bound">govSt</a>
    <a id="12240" class="Symbol">=</a> <a id="12242" href="Ledger.Conway.Specification.Epoch.html#10022" class="Function">calculatePoolDelegatedStake</a> <a id="12270" href="Ledger.Conway.Specification.Epoch.html#12220" class="Bound">ss</a> <a id="12273" href="Axiom.Set.Map.Dec.html#2149" class="Function Operator">∪⁺</a> <a id="12276" class="Symbol">(</a><a id="12277" href="Ledger.Conway.Specification.Epoch.html#12331" class="Function">stakeFromDeposits</a> <a id="12295" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="12297" href="Class.IsSet.html#916" class="Function">dom</a> <a id="12301" class="Symbol">(</a><a id="12302" href="Ledger.Core.Specification.Certs.html#1531" class="Field">PoolsOf</a> <a id="12310" href="Ledger.Conway.Specification.Epoch.html#12220" class="Bound">ss</a><a id="12312" class="Symbol">))</a>
    <a id="12319" class="Keyword">where</a>
      <a id="12331" href="Ledger.Conway.Specification.Epoch.html#12331" class="Function">stakeFromDeposits</a> <a id="12349" class="Symbol">:</a> <a id="12351" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="12359" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12361" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="12372" href="Ledger.Conway.Specification.Epoch.html#12331" class="Function">stakeFromDeposits</a> <a id="12390" class="Symbol">=</a> <a id="12392" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="12403" class="Symbol">(((</a><a id="12406" href="Ledger.Core.Specification.Certs.html#1861" class="Field">StakeDelegsOf</a> <a id="12420" href="Ledger.Conway.Specification.Epoch.html#12220" class="Bound">ss</a> <a id="12423" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="12424" class="Symbol">)</a> <a id="12426" href="Axiom.Set.Rel.html#1608" class="Function Operator">⁻¹ʳ</a>
                                      <a id="12468" href="abstract-set-theory.FiniteSetTheory.html#3111" class="Function Operator">∘ʳ</a> <a id="12471" class="Symbol">(</a><a id="12472" href="Ledger.Conway.Specification.Epoch.html#10573" class="Function">stakeFromGADeposits</a> <a id="12492" href="Ledger.Conway.Specification.Epoch.html#12230" class="Bound">govSt</a> <a id="12498" href="Ledger.Conway.Specification.Epoch.html#12223" class="Bound">utxoSt</a> <a id="12505" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="12506" class="Symbol">))</a> <a id="12509" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="12511" class="Symbol">)</a>


<a id="mkStakeDistrs"></a><a id="12515" href="Ledger.Conway.Specification.Epoch.html#12515" class="Function">mkStakeDistrs</a>
  <a id="12531" class="Symbol">:</a> <a id="12533" href="Ledger.Conway.Specification.Rewards.html#6487" class="Record">Snapshot</a>
  <a id="12544" class="Symbol">→</a> <a id="12546" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
  <a id="12554" class="Symbol">→</a> <a id="12556" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a>
  <a id="12568" class="Symbol">→</a> <a id="12570" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
  <a id="12581" class="Symbol">→</a> <a id="12583" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a>
  <a id="12592" class="Symbol">→</a> <a id="12594" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
  <a id="12603" class="Symbol">→</a> <a id="12605" href="Ledger.Conway.Specification.Ratify.html#3116" class="Record">StakeDistrs</a>
<a id="12617" href="Ledger.Conway.Specification.Epoch.html#12515" class="Function">mkStakeDistrs</a> <a id="12631" href="Ledger.Conway.Specification.Epoch.html#12631" class="Bound">ss</a> <a id="12634" href="Ledger.Conway.Specification.Epoch.html#12634" class="Bound">currentEpoch</a> <a id="12647" href="Ledger.Conway.Specification.Epoch.html#12647" class="Bound">utxoSt</a> <a id="12654" href="Ledger.Conway.Specification.Epoch.html#12654" class="Bound">govSt</a> <a id="12660" href="Ledger.Conway.Specification.Epoch.html#12660" class="Bound">gState</a> <a id="12667" href="Ledger.Conway.Specification.Epoch.html#12667" class="Bound">dState</a> <a id="12674" class="Symbol">=</a>
  <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#11880}{\htmlId{12680}{\htmlClass{Function}{\text{calculateVDelegDelegatedStake}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12634}{\htmlId{12710}{\htmlClass{Bound}{\text{currentEpoch}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12647}{\htmlId{12723}{\htmlClass{Bound}{\text{utxoSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12654}{\htmlId{12730}{\htmlClass{Bound}{\text{govSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12660}{\htmlId{12736}{\htmlClass{Bound}{\text{gState}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12667}{\htmlId{12743}{\htmlClass{Bound}{\text{dState}}}}\,
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#12077}{\htmlId{12754}{\htmlClass{Function}{\text{calculatePoolDelegatedStakeForVoting}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12631}{\htmlId{12791}{\htmlClass{Bound}{\text{ss}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12647}{\htmlId{12794}{\htmlClass{Bound}{\text{utxoSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12654}{\htmlId{12801}{\htmlClass{Bound}{\text{govSt}}}}\, \end{pmatrix}$</a>


<a id="12811" class="Keyword">private</a> <a id="12819" class="Keyword">variable</a>
  <a id="12830" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="12832" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">lastEpoch</a> <a id="12842" class="Symbol">:</a> <a id="12844" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
  <a id="12852" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">fut</a> <a id="12856" href="Ledger.Conway.Specification.Epoch.html#12856" class="Generalizable">fut&#39;</a> <a id="12861" class="Symbol">:</a> <a id="12863" href="Ledger.Conway.Specification.Ratify.html#3527" class="Record">RatifyState</a>
  <a id="12877" href="Ledger.Conway.Specification.Epoch.html#12877" class="Generalizable">poolReapState</a> <a id="12891" class="Symbol">:</a> <a id="12893" href="Ledger.Conway.Specification.PoolReap.html#400" class="Record">PoolReapState</a>
  <a id="12909" href="Ledger.Conway.Specification.Epoch.html#12909" class="Generalizable">eps</a> <a id="12913" href="Ledger.Conway.Specification.Epoch.html#12913" class="Generalizable">eps&#39;</a> <a id="12918" href="Ledger.Conway.Specification.Epoch.html#12918" class="Generalizable">eps&#39;&#39;</a> <a id="12924" class="Symbol">:</a> <a id="12926" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>
  <a id="12939" href="Ledger.Conway.Specification.Epoch.html#12939" class="Generalizable">ls</a> <a id="12942" class="Symbol">:</a> <a id="12944" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a>
  <a id="12953" href="Ledger.Conway.Specification.Epoch.html#12953" class="Generalizable">es₀</a> <a id="12957" class="Symbol">:</a> <a id="12959" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
  <a id="12972" href="Ledger.Conway.Specification.Epoch.html#12972" class="Generalizable">mark</a> <a id="12977" href="Ledger.Conway.Specification.Epoch.html#12977" class="Generalizable">set</a> <a id="12981" href="Ledger.Conway.Specification.Epoch.html#12981" class="Generalizable">go</a> <a id="12984" class="Symbol">:</a> <a id="12986" href="Ledger.Conway.Specification.Rewards.html#6487" class="Record">Snapshot</a>
  <a id="12997" href="Ledger.Conway.Specification.Epoch.html#12997" class="Generalizable">feeSS</a> <a id="13003" class="Symbol">:</a> <a id="13005" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
  <a id="13012" href="Ledger.Conway.Specification.Epoch.html#13012" class="Generalizable">lstate</a> <a id="13019" class="Symbol">:</a> <a id="13021" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a>
  <a id="13030" href="Ledger.Conway.Specification.Epoch.html#13030" class="Generalizable">pState&#39;&#39;</a> <a id="13039" class="Symbol">:</a> <a id="13041" href="Ledger.Core.Specification.Certs.html#3872" class="Record">PState</a>
  <a id="13050" href="Ledger.Conway.Specification.Epoch.html#13050" class="Generalizable">dState&#39;</a> <a id="13058" class="Symbol">:</a> <a id="13060" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
  <a id="13069" href="Ledger.Conway.Specification.Epoch.html#13069" class="Generalizable">acnt</a> <a id="13074" href="Ledger.Conway.Specification.Epoch.html#13074" class="Generalizable">acnt&#39;</a> <a id="13080" class="Symbol">:</a> <a id="13082" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>
  <a id="13089" href="Ledger.Conway.Specification.Epoch.html#13089" class="Generalizable">utxoSt&#39;&#39;</a> <a id="13098" class="Symbol">:</a> <a id="13100" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a>
  <a id="13112" href="Ledger.Conway.Specification.Epoch.html#13112" class="Generalizable">ss</a> <a id="13115" href="Ledger.Conway.Specification.Epoch.html#13115" class="Generalizable">ss&#39;</a> <a id="13119" class="Symbol">:</a> <a id="13121" href="Ledger.Conway.Specification.Rewards.html#7734" class="Record">Snapshots</a>
  <a id="13133" href="Ledger.Conway.Specification.Epoch.html#13133" class="Generalizable">ru</a> <a id="13136" class="Symbol">:</a> <a id="13138" href="Ledger.Conway.Specification.Rewards.html#6264" class="Record">RewardUpdate</a>
  <a id="13153" href="Ledger.Conway.Specification.Epoch.html#13153" class="Generalizable">mru</a> <a id="13157" class="Symbol">:</a> <a id="13159" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="13165" href="Ledger.Conway.Specification.Rewards.html#6264" class="Record">RewardUpdate</a>
  <a id="13180" href="Ledger.Conway.Specification.Epoch.html#13180" class="Generalizable">pd</a> <a id="13183" class="Symbol">:</a> <a id="13185" href="Ledger.Conway.Specification.Epoch.html#3514" class="Function">PoolDelegatedStake</a>


<a id="getOrphans"></a><a id="13206" href="Ledger.Conway.Specification.Epoch.html#13206" class="Function">getOrphans</a> <a id="13217" class="Symbol">:</a> <a id="13219" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a> <a id="13230" class="Symbol">→</a> <a id="13232" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a> <a id="13241" class="Symbol">→</a> <a id="13243" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
<a id="13252" href="Ledger.Conway.Specification.Epoch.html#13206" class="Function">getOrphans</a> <a id="13263" href="Ledger.Conway.Specification.Epoch.html#13263" class="Bound">es</a> <a id="13266" href="Ledger.Conway.Specification.Epoch.html#13266" class="Bound">govSt</a> <a id="13272" class="Symbol">=</a> <a id="13274" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="13280" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="13282" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a> <a id="13290" href="Ledger.Conway.Specification.Epoch.html#13335" class="Function">step</a> <a id="13295" class="Symbol">(</a><a id="13296" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="13299" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13301" href="Ledger.Conway.Specification.Epoch.html#13266" class="Bound">govSt</a><a id="13306" class="Symbol">)</a> <a id="13308" class="Symbol">(</a><a id="13309" href="Data.List.Base.html#4746" class="Function">length</a> <a id="13316" href="Ledger.Conway.Specification.Epoch.html#13266" class="Bound">govSt</a><a id="13321" class="Symbol">)</a>
  <a id="13325" class="Keyword">where</a>
    <a id="13335" href="Ledger.Conway.Specification.Epoch.html#13335" class="Function">step</a> <a id="13340" class="Symbol">:</a> <a id="13342" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a> <a id="13351" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13353" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a> <a id="13362" class="Symbol">→</a> <a id="13364" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a> <a id="13373" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13375" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
    <a id="13388" href="Ledger.Conway.Specification.Epoch.html#13335" class="Function">step</a> <a id="13393" class="Symbol">(</a><a id="13394" href="Ledger.Conway.Specification.Epoch.html#13394" class="Bound">orps</a> <a id="13399" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13401" href="Ledger.Conway.Specification.Epoch.html#13401" class="Bound">govSt</a><a id="13406" class="Symbol">)</a> <a id="13408" class="Symbol">=</a>
      <a id="13416" class="Keyword">let</a>
        <a id="13428" href="Ledger.Conway.Specification.Epoch.html#13428" class="Bound">isOrphan?</a> <a id="13438" href="Ledger.Conway.Specification.Epoch.html#13438" class="Bound">a</a> <a id="13440" href="Ledger.Conway.Specification.Epoch.html#13440" class="Bound">prev</a> <a id="13445" class="Symbol">=</a> <a id="13447" href="Relation.Nullary.Decidable.Core.html#3277" class="Function">¬?</a> <a id="13450" class="Symbol">(</a><a id="13451" href="Ledger.Conway.Specification.Gov.html#9843" class="Function">hasParent?</a> <a id="13462" href="Ledger.Conway.Specification.Epoch.html#13263" class="Bound">es</a> <a id="13465" href="Ledger.Conway.Specification.Epoch.html#13401" class="Bound">govSt</a> <a id="13471" href="Ledger.Conway.Specification.Epoch.html#13438" class="Bound">a</a> <a id="13473" href="Ledger.Conway.Specification.Epoch.html#13440" class="Bound">prev</a><a id="13477" class="Symbol">)</a>
        <a id="13487" class="Symbol">(</a><a id="13488" href="Ledger.Conway.Specification.Epoch.html#13488" class="Bound">orps&#39;</a> <a id="13494" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13496" href="Ledger.Conway.Specification.Epoch.html#13496" class="Bound">govSt&#39;</a><a id="13502" class="Symbol">)</a> <a id="13504" class="Symbol">=</a> <a id="13506" href="Data.List.Base.html#10628" class="Function">partition</a>
          <a id="13526" class="Symbol">(λ</a> <a id="13529" class="Symbol">(_</a> <a id="13532" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13534" class="Keyword">record</a> <a id="13541" class="Symbol">{</a><a id="13542" href="Ledger.Core.Specification.Gov.Actions.html#3941" class="Field">action</a> <a id="13549" class="Symbol">=</a> <a id="13551" href="Ledger.Conway.Specification.Epoch.html#13551" class="Bound">a</a> <a id="13553" class="Symbol">;</a> <a id="13555" href="Ledger.Core.Specification.Gov.Actions.html#3969" class="Field">prevAction</a> <a id="13566" class="Symbol">=</a> <a id="13568" href="Ledger.Conway.Specification.Epoch.html#13568" class="Bound">prev</a><a id="13572" class="Symbol">})</a> <a id="13575" class="Symbol">→</a> <a id="13577" href="Ledger.Conway.Specification.Epoch.html#13428" class="Bound">isOrphan?</a> <a id="13587" class="Symbol">(</a><a id="13588" href="Ledger.Conway.Specification.Epoch.html#13551" class="Bound">a</a> <a id="13590" class="Symbol">.</a><a id="13591" href="Ledger.Core.Specification.Gov.Actions.html#1511" class="Field">gaType</a><a id="13597" class="Symbol">)</a> <a id="13599" href="Ledger.Conway.Specification.Epoch.html#13568" class="Bound">prev</a><a id="13603" class="Symbol">)</a>
          <a id="13615" href="Ledger.Conway.Specification.Epoch.html#13401" class="Bound">govSt</a>
      <a id="13627" class="Keyword">in</a>
        <a id="13638" class="Symbol">(</a><a id="13639" href="Ledger.Conway.Specification.Epoch.html#13394" class="Bound">orps</a> <a id="13644" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="13647" href="Ledger.Conway.Specification.Epoch.html#13488" class="Bound">orps&#39;</a> <a id="13653" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13655" href="Ledger.Conway.Specification.Epoch.html#13496" class="Bound">govSt&#39;</a><a id="13661" class="Symbol">)</a>

<a id="13664" class="Keyword">record</a> <a id="Governance-Update"></a><a id="13671" href="Ledger.Conway.Specification.Epoch.html#13671" class="Record">Governance-Update</a> <a id="13689" class="Symbol">:</a> <a id="13691" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="13696" class="Keyword">where</a>
  <a id="13704" class="Keyword">constructor</a> <a id="GovernanceUpdate"></a><a id="13716" href="Ledger.Conway.Specification.Epoch.html#13716" class="InductiveConstructor">GovernanceUpdate</a>
  <a id="13735" class="Keyword">field</a>
    <a id="Governance-Update.removedGovActions"></a><a id="13745" href="Ledger.Conway.Specification.Epoch.html#13745" class="Field">removedGovActions</a> <a id="13763" class="Symbol">:</a> <a id="13765" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="13767" class="Symbol">(</a><a id="13768" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="13782" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13784" href="Ledger.Core.Specification.Certs.html#534" class="Datatype">DepositPurpose</a> <a id="13799" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13801" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a><a id="13805" class="Symbol">)</a>
    <a id="Governance-Update.govSt&#39;"></a><a id="13811" href="Ledger.Conway.Specification.Epoch.html#13811" class="Field">govSt&#39;</a>            <a id="13829" class="Symbol">:</a> <a id="13831" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>

<a id="13841" class="Keyword">module</a> <a id="GovernanceUpdate"></a><a id="13848" href="Ledger.Conway.Specification.Epoch.html#13848" class="Module">GovernanceUpdate</a> <a id="13865" class="Symbol">(</a><a id="13866" href="Ledger.Conway.Specification.Epoch.html#13866" class="Bound">ls</a> <a id="13869" class="Symbol">:</a> <a id="13871" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a><a id="13877" class="Symbol">)</a>
                        <a id="13903" class="Symbol">(</a><a id="13904" href="Ledger.Conway.Specification.Epoch.html#13904" class="Bound">fut</a> <a id="13908" class="Symbol">:</a> <a id="13910" href="Ledger.Conway.Specification.Ratify.html#3527" class="Record">RatifyState</a><a id="13921" class="Symbol">)</a>
                        <a id="13947" class="Keyword">where</a>


  <a id="13957" class="Keyword">open</a> <a id="13962" href="Ledger.Conway.Specification.Ledger.html#997" class="Module">LState</a> <a id="13969" href="Ledger.Conway.Specification.Epoch.html#13866" class="Bound">ls</a>
  <a id="13974" class="Keyword">open</a> <a id="13979" href="Ledger.Conway.Specification.Ratify.html#3527" class="Module">RatifyState</a> <a id="13991" href="Ledger.Conway.Specification.Epoch.html#13904" class="Bound">fut</a>


  <a id="GovernanceUpdate.tmpGovSt"></a><a id="13999" href="Ledger.Conway.Specification.Epoch.html#13999" class="Function">tmpGovSt</a> <a id="14008" class="Symbol">:</a> <a id="14010" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
  <a id="14021" href="Ledger.Conway.Specification.Epoch.html#13999" class="Function">tmpGovSt</a> <a id="14030" class="Symbol">=</a> <a id="14032" href="Ledger.Prelude.html#2451" class="Function">filter</a> <a id="14039" class="Symbol">(λ</a> <a id="14042" href="Ledger.Conway.Specification.Epoch.html#14042" class="Bound">x</a> <a id="14044" class="Symbol">→</a> <a id="14046" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14052" href="Ledger.Conway.Specification.Epoch.html#14042" class="Bound">x</a> <a id="14054" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="14056" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14061" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14067" href="Ledger.Conway.Specification.Ratify.html#3590" class="Field">removed</a><a id="14074" class="Symbol">)</a> <a id="14076" href="Ledger.Conway.Specification.Ledger.html#1083" class="Function">govSt</a>

  <a id="GovernanceUpdate.orphans"></a><a id="14085" href="Ledger.Conway.Specification.Epoch.html#14085" class="Function">orphans</a> <a id="14093" class="Symbol">:</a> <a id="14095" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14097" class="Symbol">(</a><a id="14098" href="Ledger.Core.Specification.Gov.Actions.html#1976" class="Function">GovActionID</a> <a id="14110" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14112" href="Ledger.Core.Specification.Gov.Actions.html#3818" class="Record">GovActionState</a><a id="14126" class="Symbol">)</a>
  <a id="14130" href="Ledger.Conway.Specification.Epoch.html#14085" class="Function">orphans</a>  <a id="14139" class="Symbol">=</a> <a id="14141" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="14150" class="Symbol">(</a><a id="14151" href="Ledger.Conway.Specification.Epoch.html#13206" class="Function">getOrphans</a> <a id="14162" href="Ledger.Conway.Specification.Ratify.html#3564" class="Field">es</a> <a id="14165" href="Ledger.Conway.Specification.Epoch.html#13999" class="Function">tmpGovSt</a><a id="14173" class="Symbol">)</a>

  <a id="GovernanceUpdate.removed&#39;"></a><a id="14178" href="Ledger.Conway.Specification.Epoch.html#14178" class="Function">removed&#39;</a> <a id="14187" class="Symbol">:</a> <a id="14189" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14191" class="Symbol">(</a><a id="14192" href="Ledger.Core.Specification.Gov.Actions.html#1976" class="Function">GovActionID</a> <a id="14204" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14206" href="Ledger.Core.Specification.Gov.Actions.html#3818" class="Record">GovActionState</a><a id="14220" class="Symbol">)</a>
  <a id="14224" href="Ledger.Conway.Specification.Epoch.html#14178" class="Function">removed&#39;</a> <a id="14233" class="Symbol">=</a> <a id="14235" href="Ledger.Conway.Specification.Ratify.html#3590" class="Field">removed</a> <a id="14243" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="14245" href="Ledger.Conway.Specification.Epoch.html#14085" class="Function">orphans</a>

  <a id="GovernanceUpdate.removedGovActions"></a><a id="14256" href="Ledger.Conway.Specification.Epoch.html#14256" class="Function">removedGovActions</a> <a id="14274" class="Symbol">:</a> <a id="14276" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14278" class="Symbol">(</a><a id="14279" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="14293" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14295" href="Ledger.Core.Specification.Certs.html#534" class="Datatype">DepositPurpose</a> <a id="14310" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14312" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a><a id="14316" class="Symbol">)</a>
  <a id="14320" href="Ledger.Conway.Specification.Epoch.html#14256" class="Function">removedGovActions</a> <a id="14338" class="Symbol">=</a>
    <a id="14344" href="Function.Base.html#1657" class="Function">flip</a> <a id="14349" href="Axiom.Set.html#7207" class="Function">concatMapˢ</a> <a id="14360" href="Ledger.Conway.Specification.Epoch.html#14178" class="Function">removed&#39;</a> <a id="14369" class="Symbol">λ</a> <a id="14371" class="Symbol">(</a><a id="14372" href="Ledger.Conway.Specification.Epoch.html#14372" class="Bound">gaid</a> <a id="14377" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="14379" href="Ledger.Conway.Specification.Epoch.html#14379" class="Bound">gaSt</a><a id="14383" class="Symbol">)</a> <a id="14385" class="Symbol">→</a>
      <a id="14393" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
        <a id="14406" class="Symbol">(</a><a id="14407" href="Ledger.Core.Specification.Gov.Actions.html#3885" class="Field">returnAddr</a> <a id="14418" href="Ledger.Conway.Specification.Epoch.html#14379" class="Bound">gaSt</a> <a id="14423" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="14425" class="Symbol">)</a>
        <a id="14435" class="Symbol">((</a><a id="14437" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="14448" href="Ledger.Conway.Specification.Ledger.html#1056" class="Function">utxoSt</a> <a id="14455" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="14457" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="14459" href="Ledger.Core.Specification.Certs.html#723" class="InductiveConstructor">GovActionDeposit</a> <a id="14476" href="Ledger.Conway.Specification.Epoch.html#14372" class="Bound">gaid</a> <a id="14481" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="14482" class="Symbol">)</a> <a id="14484" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="14485" class="Symbol">)</a>

  <a id="GovernanceUpdate.govSt&#39;"></a><a id="14490" href="Ledger.Conway.Specification.Epoch.html#14490" class="Function">govSt&#39;</a> <a id="14497" class="Symbol">:</a> <a id="14499" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
  <a id="14510" href="Ledger.Conway.Specification.Epoch.html#14490" class="Function">govSt&#39;</a> <a id="14517" class="Symbol">=</a> <a id="14519" href="Ledger.Prelude.html#2451" class="Function">filter</a> <a id="14526" class="Symbol">(λ</a> <a id="14529" href="Ledger.Conway.Specification.Epoch.html#14529" class="Bound">x</a> <a id="14531" class="Symbol">→</a> <a id="14533" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14539" href="Ledger.Conway.Specification.Epoch.html#14529" class="Bound">x</a> <a id="14541" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="14543" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14548" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14554" href="Ledger.Conway.Specification.Epoch.html#14178" class="Function">removed&#39;</a><a id="14562" class="Symbol">)</a> <a id="14564" href="Ledger.Conway.Specification.Ledger.html#1083" class="Function">govSt</a>

  <a id="GovernanceUpdate.updates"></a><a id="14573" href="Ledger.Conway.Specification.Epoch.html#14573" class="Function">updates</a> <a id="14581" class="Symbol">:</a> <a id="14583" href="Ledger.Conway.Specification.Epoch.html#13671" class="Record">Governance-Update</a>
  <a id="14603" href="Ledger.Conway.Specification.Epoch.html#14573" class="Function">updates</a> <a id="14611" class="Symbol">=</a> <a id="14613" href="Ledger.Conway.Specification.Epoch.html#13716" class="InductiveConstructor">GovernanceUpdate</a> <a id="14630" href="Ledger.Conway.Specification.Epoch.html#14256" class="Function">removedGovActions</a> <a id="14648" href="Ledger.Conway.Specification.Epoch.html#14490" class="Function">govSt&#39;</a>

<a id="14656" class="Keyword">record</a> <a id="Pre-POOLREAP-Update"></a><a id="14663" href="Ledger.Conway.Specification.Epoch.html#14663" class="Record">Pre-POOLREAP-Update</a> <a id="14683" class="Symbol">:</a> <a id="14685" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="14690" class="Keyword">where</a>
  <a id="14698" class="Keyword">inductive</a>
  <a id="14710" class="Keyword">constructor</a> <a id="Pre-POOLREAPUpdate"></a><a id="14722" href="Ledger.Conway.Specification.Epoch.html#14722" class="InductiveConstructor">Pre-POOLREAPUpdate</a>
  <a id="14743" class="Keyword">field</a>
    <a id="Pre-POOLREAP-Update.pState&#39;"></a><a id="14753" href="Ledger.Conway.Specification.Epoch.html#14753" class="Field">pState&#39;</a> <a id="14761" class="Symbol">:</a> <a id="14763" href="Ledger.Core.Specification.Certs.html#3872" class="Record">PState</a>
    <a id="Pre-POOLREAP-Update.gState&#39;"></a><a id="14774" href="Ledger.Conway.Specification.Epoch.html#14774" class="Field">gState&#39;</a> <a id="14782" class="Symbol">:</a> <a id="14784" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a>
    <a id="Pre-POOLREAP-Update.utxoSt&#39;"></a><a id="14795" href="Ledger.Conway.Specification.Epoch.html#14795" class="Field">utxoSt&#39;</a> <a id="14803" class="Symbol">:</a> <a id="14805" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a>

<a id="14816" class="Keyword">module</a> <a id="Pre-POOLREAPUpdate"></a><a id="14823" href="Ledger.Conway.Specification.Epoch.html#14823" class="Module">Pre-POOLREAPUpdate</a> <a id="14842" class="Symbol">(</a><a id="14843" href="Ledger.Conway.Specification.Epoch.html#14843" class="Bound">ls</a> <a id="14846" class="Symbol">:</a> <a id="14848" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a><a id="14854" class="Symbol">)</a>
                          <a id="14882" class="Symbol">(</a><a id="14883" href="Ledger.Conway.Specification.Epoch.html#14883" class="Bound">es</a> <a id="14886" class="Symbol">:</a> <a id="14888" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a><a id="14898" class="Symbol">)</a>
                          <a id="14926" class="Symbol">(</a><a id="14927" href="Ledger.Conway.Specification.Epoch.html#14927" class="Bound">govUpdate</a> <a id="14937" class="Symbol">:</a> <a id="14939" href="Ledger.Conway.Specification.Epoch.html#13671" class="Record">Governance-Update</a><a id="14956" class="Symbol">)</a>
                          <a id="14984" class="Keyword">where</a>


  <a id="14994" class="Keyword">open</a> <a id="14999" href="Ledger.Conway.Specification.Ledger.html#997" class="Module">LState</a> <a id="15006" href="Ledger.Conway.Specification.Epoch.html#14843" class="Bound">ls</a>
  <a id="15011" class="Keyword">open</a> <a id="15016" href="Ledger.Core.Specification.Certs.html#4115" class="Module">CertState</a> <a id="15026" href="Ledger.Conway.Specification.Ledger.html#1109" class="Function">certState</a> <a id="15036" class="Keyword">using</a> <a id="15042" class="Symbol">(</a><a id="15043" href="Ledger.Core.Specification.Certs.html#4198" class="Field">pState</a><a id="15049" class="Symbol">;</a> <a id="15051" href="Ledger.Core.Specification.Certs.html#4218" class="Field">gState</a><a id="15057" class="Symbol">)</a>
  <a id="15061" class="Keyword">open</a> <a id="15066" href="Ledger.Core.Specification.Certs.html#3872" class="Module">PState</a> <a id="15073" href="Ledger.Core.Specification.Certs.html#4198" class="Function">pState</a>
  <a id="15082" class="Keyword">open</a> <a id="15087" href="Ledger.Conway.Specification.Epoch.html#13671" class="Module">Governance-Update</a> <a id="15105" href="Ledger.Conway.Specification.Epoch.html#14927" class="Bound">govUpdate</a>


  <a id="Pre-POOLREAPUpdate.utxoSt&#39;"></a><a id="15119" href="Ledger.Conway.Specification.Epoch.html#15119" class="Function">utxoSt&#39;</a> <a id="15127" class="Symbol">:</a> <a id="15129" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a>
  <a id="15141" href="Ledger.Conway.Specification.Epoch.html#15119" class="Function">utxoSt&#39;</a> <a id="15149" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Core.Specification.Transaction.html#2830}{\htmlId{15153}{\htmlClass{Field}{\text{UTxOOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1056}{\htmlId{15160}{\htmlClass{Function}{\text{utxoSt}}}}\, \\ \,\href{Ledger.Prelude.Base.html#669}{\htmlId{15169}{\htmlClass{Field}{\text{FeesOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1056}{\htmlId{15176}{\htmlClass{Function}{\text{utxoSt}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#885}{\htmlId{15185}{\htmlClass{Field}{\text{DepositsOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1056}{\htmlId{15196}{\htmlClass{Function}{\text{utxoSt}}}}\, \,\href{Axiom.Set.Map.html#13606}{\htmlId{15203}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{abstract-set-theory.FiniteSetTheory.html#519}{\htmlId{15205}{\htmlClass{Function}{\text{mapˢ}}}}\, \,\htmlId{15210}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Data.Product.Base.html#636}{\htmlId{15211}{\htmlClass{Field}{\text{proj₁}}}}\, \,\href{Function.Base.html#1134}{\htmlId{15217}{\htmlClass{Function Operator}{\text{∘}}}}\, \,\href{Data.Product.Base.html#650}{\htmlId{15219}{\htmlClass{Field}{\text{proj₂}}}}\,\,\htmlId{15224}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13745}{\htmlId{15226}{\htmlClass{Field}{\text{removedGovActions}}}}\, \,\href{Axiom.Set.Map.html#13606}{\htmlId{15244}{\htmlClass{Function Operator}{\text{ᶜ}}}}\, \\ \,\htmlId{15248}{\htmlClass{Number}{\text{0}}}\, \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.pState&#39;"></a><a id="15255" href="Ledger.Conway.Specification.Epoch.html#15255" class="Function">pState&#39;</a> <a id="15263" class="Symbol">:</a> <a id="15265" href="Ledger.Core.Specification.Certs.html#3872" class="Record">PState</a>
  <a id="15274" href="Ledger.Conway.Specification.Epoch.html#15255" class="Function">pState&#39;</a> <a id="15282" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Core.Specification.Certs.html#3926}{\htmlId{15286}{\htmlClass{Function}{\text{fPools}}}}\, \,\href{Axiom.Set.Map.html#7640}{\htmlId{15293}{\htmlClass{Function Operator}{\text{∪ˡ}}}}\, \,\href{Ledger.Core.Specification.Certs.html#3904}{\htmlId{15296}{\htmlClass{Function}{\text{pools}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{15304}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#3948}{\htmlId{15308}{\htmlClass{Function}{\text{retiring}}}}\, \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.gState&#39;"></a><a id="15322" href="Ledger.Conway.Specification.Epoch.html#15322" class="Function">gState&#39;</a> <a id="15330" class="Symbol">:</a> <a id="15332" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a>
  <a id="15341" href="Ledger.Conway.Specification.Epoch.html#15322" class="Function">gState&#39;</a> <a id="15349" class="Symbol">=</a>
    <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{15357}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Class.ToBool.html#342}{\htmlId{15358}{\htmlClass{Function Operator}{\text{if}}}}\, \,\href{Data.List.Base.html#4681}{\htmlId{15361}{\htmlClass{Function}{\text{null}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13811}{\htmlId{15366}{\htmlClass{Field}{\text{govSt&#39;}}}}\, \,\href{Class.ToBool.html#342}{\htmlId{15373}{\htmlClass{Function Operator}{\text{then}}}}\, \,\href{Axiom.Set.Map.html#7108}{\htmlId{15378}{\htmlClass{Function}{\text{mapValues}}}}\, \,\href{Ledger.Core.Specification.Epoch.html#1054}{\htmlId{15388}{\htmlClass{Function}{\text{sucᵉ}}}}\, \,\htmlId{15393}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Core.Specification.Gov.Actions.html#7094}{\htmlId{15394}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Core.Specification.Certs.html#4218}{\htmlId{15402}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{15408}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Class.ToBool.html#342}{\htmlId{15410}{\htmlClass{Function Operator}{\text{else}}}}\, \,\href{Ledger.Core.Specification.Gov.Actions.html#7094}{\htmlId{15415}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Core.Specification.Certs.html#4218}{\htmlId{15423}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{15429}{\htmlClass{Symbol}{\text{)}}}\,
    \\ \,\href{Ledger.Core.Specification.Certs.html#1446}{\htmlId{15437}{\htmlClass{Field}{\text{CCHotKeysOf}}}}\, \,\href{Ledger.Core.Specification.Certs.html#4218}{\htmlId{15449}{\htmlClass{Function}{\text{gState}}}}\, \,\href{Axiom.Set.Map.html#13536}{\htmlId{15456}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Specification.Enact.html#1362}{\htmlId{15458}{\htmlClass{Function}{\text{ccCreds}}}}\, \,\htmlId{15466}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Enact.html#480}{\htmlId{15467}{\htmlClass{Field}{\text{EnactState.cc}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#14883}{\htmlId{15481}{\htmlClass{Bound}{\text{es}}}}\,\,\htmlId{15483}{\htmlClass{Symbol}{\text{)}}}\,
    \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.updates"></a><a id="15494" href="Ledger.Conway.Specification.Epoch.html#15494" class="Function">updates</a> <a id="15502" class="Symbol">:</a> <a id="15504" href="Ledger.Conway.Specification.Epoch.html#14663" class="Record">Pre-POOLREAP-Update</a>
  <a id="15526" href="Ledger.Conway.Specification.Epoch.html#15494" class="Function">updates</a> <a id="15534" class="Symbol">=</a> <a id="15536" href="Ledger.Conway.Specification.Epoch.html#14722" class="InductiveConstructor">Pre-POOLREAPUpdate</a> <a id="15555" href="Ledger.Conway.Specification.Epoch.html#15255" class="Function">pState&#39;</a> <a id="15563" href="Ledger.Conway.Specification.Epoch.html#15322" class="Function">gState&#39;</a> <a id="15571" href="Ledger.Conway.Specification.Epoch.html#15119" class="Function">utxoSt&#39;</a>

<a id="15580" class="Keyword">record</a> <a id="Post-POOLREAP-Update"></a><a id="15587" href="Ledger.Conway.Specification.Epoch.html#15587" class="Record">Post-POOLREAP-Update</a> <a id="15608" class="Symbol">:</a> <a id="15610" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="15615" class="Keyword">where</a>
  <a id="15623" class="Keyword">inductive</a>
  <a id="15635" class="Keyword">constructor</a> <a id="Post-POOLREAPUpdate"></a><a id="15647" href="Ledger.Conway.Specification.Epoch.html#15647" class="InductiveConstructor">Post-POOLREAPUpdate</a>
  <a id="15669" class="Keyword">field</a>
    <a id="Post-POOLREAP-Update.dState&#39;&#39;"></a><a id="15679" href="Ledger.Conway.Specification.Epoch.html#15679" class="Field">dState&#39;&#39;</a>       <a id="15694" class="Symbol">:</a> <a id="15696" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
    <a id="Post-POOLREAP-Update.acnt&#39;&#39;"></a><a id="15707" href="Ledger.Conway.Specification.Epoch.html#15707" class="Field">acnt&#39;&#39;</a>         <a id="15722" class="Symbol">:</a> <a id="15724" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>

<a id="15730" class="Keyword">module</a> <a id="Post-POOLREAPUpdate"></a><a id="15737" href="Ledger.Conway.Specification.Epoch.html#15737" class="Module">Post-POOLREAPUpdate</a> <a id="15757" class="Symbol">(</a><a id="15758" href="Ledger.Conway.Specification.Epoch.html#15758" class="Bound">es</a> <a id="15761" class="Symbol">:</a> <a id="15763" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a><a id="15773" class="Symbol">)</a>
                           <a id="15802" class="Symbol">(</a><a id="15803" href="Ledger.Conway.Specification.Epoch.html#15803" class="Bound">ls</a> <a id="15806" class="Symbol">:</a> <a id="15808" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a><a id="15814" class="Symbol">)</a>
                           <a id="15843" class="Symbol">(</a><a id="15844" href="Ledger.Conway.Specification.Epoch.html#15844" class="Bound">dState&#39;</a> <a id="15852" class="Symbol">:</a> <a id="15854" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a><a id="15860" class="Symbol">)</a>
                           <a id="15889" class="Symbol">(</a><a id="15890" href="Ledger.Conway.Specification.Epoch.html#15890" class="Bound">acnt&#39;</a> <a id="15896" class="Symbol">:</a> <a id="15898" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a><a id="15902" class="Symbol">)</a>
                           <a id="15931" class="Symbol">(</a><a id="15932" href="Ledger.Conway.Specification.Epoch.html#15932" class="Bound">govUpd</a> <a id="15939" class="Symbol">:</a> <a id="15941" href="Ledger.Conway.Specification.Epoch.html#13671" class="Record">Governance-Update</a><a id="15958" class="Symbol">)</a>
                           <a id="15987" class="Keyword">where</a>


  <a id="15997" class="Keyword">open</a> <a id="16002" href="Ledger.Conway.Specification.Ledger.html#997" class="Module">LState</a>
  <a id="16011" class="Keyword">open</a> <a id="16016" href="Ledger.Conway.Specification.Epoch.html#13671" class="Module">Governance-Update</a> <a id="16034" href="Ledger.Conway.Specification.Epoch.html#15932" class="Bound">govUpd</a>


  <a id="16045" class="Keyword">opaque</a>
    <a id="Post-POOLREAPUpdate.govActionReturns"></a><a id="16056" href="Ledger.Conway.Specification.Epoch.html#16056" class="Function">govActionReturns</a> <a id="16073" class="Symbol">:</a> <a id="16075" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="16089" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16091" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16100" href="Ledger.Conway.Specification.Epoch.html#16056" class="Function">govActionReturns</a> <a id="16117" class="Symbol">=</a>
      <a id="16125" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="16136" class="Symbol">(</a><a id="16137" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="16142" class="Symbol">(λ</a> <a id="16145" class="Symbol">(</a><a id="16146" href="Ledger.Conway.Specification.Epoch.html#16146" class="Bound">a</a> <a id="16148" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16150" class="Symbol">_</a> <a id="16152" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16154" href="Ledger.Conway.Specification.Epoch.html#16154" class="Bound">d</a><a id="16155" class="Symbol">)</a> <a id="16157" class="Symbol">→</a> <a id="16159" href="Ledger.Conway.Specification.Epoch.html#16146" class="Bound">a</a> <a id="16161" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16163" href="Ledger.Conway.Specification.Epoch.html#16154" class="Bound">d</a><a id="16164" class="Symbol">)</a> <a id="16166" href="Ledger.Conway.Specification.Epoch.html#13745" class="Field">removedGovActions</a> <a id="16184" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="16186" class="Symbol">)</a>

    <a id="Post-POOLREAPUpdate.payout"></a><a id="16193" href="Ledger.Conway.Specification.Epoch.html#16193" class="Function">payout</a> <a id="16200" class="Symbol">:</a> <a id="16202" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="16216" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16218" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16227" href="Ledger.Conway.Specification.Epoch.html#16193" class="Function">payout</a> <a id="16234" class="Symbol">=</a> <a id="16236" href="Ledger.Conway.Specification.Epoch.html#16056" class="Function">govActionReturns</a> <a id="16253" href="Axiom.Set.Map.Dec.html#2149" class="Function Operator">∪⁺</a> <a id="16256" href="Ledger.Core.Specification.Address.html#1700" class="Field">WithdrawalsOf</a> <a id="16270" href="Ledger.Conway.Specification.Epoch.html#15758" class="Bound">es</a>

  <a id="16276" class="Keyword">opaque</a>
    <a id="Post-POOLREAPUpdate.refunds"></a><a id="16287" href="Ledger.Conway.Specification.Epoch.html#16287" class="Function">refunds</a> <a id="16295" class="Symbol">:</a> <a id="16297" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="16308" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16310" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16319" href="Ledger.Conway.Specification.Epoch.html#16287" class="Function">refunds</a> <a id="16327" class="Symbol">=</a> <a id="16329" href="Axiom.Set.Map.html#17518" class="Function">pullbackMap</a> <a id="16341" href="Ledger.Conway.Specification.Epoch.html#16193" class="Function">payout</a> <a id="16348" href="Ledger.Conway.Specification.Epoch.html#5485" class="Function">toRewardAddress</a> <a id="16364" class="Symbol">(</a><a id="16365" href="Class.IsSet.html#916" class="Function">dom</a> <a id="16369" class="Symbol">(</a><a id="16370" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="16380" href="Ledger.Conway.Specification.Epoch.html#15844" class="Bound">dState&#39;</a><a id="16387" class="Symbol">))</a>

  <a id="Post-POOLREAPUpdate.dState&#39;&#39;"></a><a id="16393" href="Ledger.Conway.Specification.Epoch.html#16393" class="Function">dState&#39;&#39;</a> <a id="16402" class="Symbol">:</a> <a id="16404" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
  <a id="16413" href="Ledger.Conway.Specification.Epoch.html#16393" class="Function">dState&#39;&#39;</a> <a id="16422" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Core.Specification.Gov.Actions.html#2806}{\htmlId{16426}{\htmlClass{Field}{\text{VoteDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15844}{\htmlId{16439}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#1861}{\htmlId{16449}{\htmlClass{Field}{\text{StakeDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15844}{\htmlId{16463}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#1696}{\htmlId{16473}{\htmlClass{Field}{\text{RewardsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15844}{\htmlId{16483}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \,\href{Axiom.Set.Map.Dec.html#2149}{\htmlId{16491}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16287}{\htmlId{16494}{\htmlClass{Function}{\text{refunds}}}}\, \end{pmatrix}$</a>

  <a id="Post-POOLREAPUpdate.unclaimed"></a><a id="16507" href="Ledger.Conway.Specification.Epoch.html#16507" class="Function">unclaimed</a> <a id="16517" class="Symbol">:</a> <a id="16519" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="16526" href="Ledger.Conway.Specification.Epoch.html#16507" class="Function">unclaimed</a> <a id="16536" class="Symbol">=</a> <a id="16538" href="Ledger.Prelude.HasCoin.html#171" class="Field">getCoin</a> <a id="16546" href="Ledger.Conway.Specification.Epoch.html#16193" class="Function">payout</a> <a id="16553" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="16555" href="Ledger.Prelude.HasCoin.html#171" class="Field">getCoin</a> <a id="16563" href="Ledger.Conway.Specification.Epoch.html#16287" class="Function">refunds</a>

  <a id="Post-POOLREAPUpdate.totWithdrawals"></a><a id="16574" href="Ledger.Conway.Specification.Epoch.html#16574" class="Function">totWithdrawals</a> <a id="16589" class="Symbol">:</a> <a id="16591" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="16598" href="Ledger.Conway.Specification.Epoch.html#16574" class="Function">totWithdrawals</a> <a id="16613" class="Symbol">=</a> <a id="16615" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="16618" href="Ledger.Conway.Specification.Epoch.html#16618" class="Bound">x</a> <a id="16620" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="16622" href="Ledger.Core.Specification.Address.html#1700" class="Field">WithdrawalsOf</a> <a id="16636" href="Ledger.Conway.Specification.Epoch.html#15758" class="Bound">es</a> <a id="16639" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="16641" href="Ledger.Conway.Specification.Epoch.html#16618" class="Bound">x</a>

  <a id="Post-POOLREAPUpdate.acnt&#39;&#39;"></a><a id="16646" href="Ledger.Conway.Specification.Epoch.html#16646" class="Function">acnt&#39;&#39;</a> <a id="16653" class="Symbol">:</a> <a id="16655" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>
  <a id="16662" href="Ledger.Conway.Specification.Epoch.html#16646" class="Function">acnt&#39;&#39;</a> <a id="16669" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Prelude.Base.html#889}{\htmlId{16673}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15890}{\htmlId{16684}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \,\href{Data.Nat.Base.html#4462}{\htmlId{16690}{\htmlClass{Primitive Operator}{\text{∸}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16574}{\htmlId{16692}{\htmlClass{Function}{\text{totWithdrawals}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{16707}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Prelude.Base.html#554}{\htmlId{16709}{\htmlClass{Field}{\text{DonationsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15803}{\htmlId{16721}{\htmlClass{Bound}{\text{ls}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{16724}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16507}{\htmlId{16726}{\htmlClass{Function}{\text{unclaimed}}}}\, \\ \,\href{Ledger.Prelude.Base.html#773}{\htmlId{16738}{\htmlClass{Field}{\text{ReservesOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15890}{\htmlId{16749}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \end{pmatrix}$</a>

  <a id="Post-POOLREAPUpdate.updates"></a><a id="16760" href="Ledger.Conway.Specification.Epoch.html#16760" class="Function">updates</a> <a id="16768" class="Symbol">:</a> <a id="16770" href="Ledger.Conway.Specification.Epoch.html#15587" class="Record">Post-POOLREAP-Update</a>
  <a id="16793" href="Ledger.Conway.Specification.Epoch.html#16760" class="Function">updates</a> <a id="16801" class="Symbol">=</a> <a id="16803" href="Ledger.Conway.Specification.Epoch.html#15647" class="InductiveConstructor">Post-POOLREAPUpdate</a> <a id="16823" href="Ledger.Conway.Specification.Epoch.html#16393" class="Function">dState&#39;&#39;</a> <a id="16832" href="Ledger.Conway.Specification.Epoch.html#16646" class="Function">acnt&#39;&#39;</a>


<a id="16841" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="16846" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="16861" class="Symbol">:</a> <a id="16863" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="16865" class="Symbol">→</a> <a id="16867" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a> <a id="16878" class="Symbol">→</a> <a id="16880" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a> <a id="16886" class="Symbol">→</a> <a id="16888" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a> <a id="16899" class="Symbol">→</a> <a id="16901" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="16906" class="Keyword">where</a>


  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="16916" href="Ledger.Conway.Specification.Epoch.html#16916" class="InductiveConstructor">EPOCH</a> <a id="16922" class="Symbol">:</a>
    <a id="16928" class="Keyword">let</a>
      <a id="16938" href="Ledger.Conway.Specification.Epoch.html#16938" class="Bound">es</a> <a id="16941" class="Symbol">=</a> <a id="16943" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="16956" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">fut</a>

      <a id="16967" href="Ledger.Conway.Specification.Epoch.html#16967" class="Bound">govUpd</a> <a id="16974" class="Symbol">:</a> <a id="16976" href="Ledger.Conway.Specification.Epoch.html#13671" class="Record">Governance-Update</a>
      <a id="17000" href="Ledger.Conway.Specification.Epoch.html#16967" class="Bound">govUpd</a> <a id="17007" class="Symbol">=</a> <a id="17009" href="Ledger.Conway.Specification.Epoch.html#14573" class="Function">GovernanceUpdate.updates</a> <a id="17034" href="Ledger.Conway.Specification.Epoch.html#12939" class="Generalizable">ls</a> <a id="17037" href="Ledger.Conway.Specification.Epoch.html#12852" class="Generalizable">fut</a>

      <a id="17048" href="Ledger.Conway.Specification.Epoch.html#14722" class="InductiveConstructor">Pre-POOLREAPUpdate</a> <a id="17067" href="Ledger.Conway.Specification.Epoch.html#17067" class="Bound">pState&#39;</a> <a id="17075" href="Ledger.Conway.Specification.Epoch.html#17075" class="Bound">gState&#39;</a> <a id="17083" href="Ledger.Conway.Specification.Epoch.html#17083" class="Bound">utxoSt&#39;</a> <a id="17091" class="Symbol">=</a> <a id="17093" href="Ledger.Conway.Specification.Epoch.html#15494" class="Function">Pre-POOLREAPUpdate.updates</a> <a id="17120" href="Ledger.Conway.Specification.Epoch.html#12939" class="Generalizable">ls</a> <a id="17123" href="Ledger.Conway.Specification.Epoch.html#16938" class="Bound">es</a> <a id="17126" href="Ledger.Conway.Specification.Epoch.html#16967" class="Bound">govUpd</a>
      <a id="17139" href="Ledger.Conway.Specification.Epoch.html#15647" class="InductiveConstructor">Post-POOLREAPUpdate</a> <a id="17159" href="Ledger.Conway.Specification.Epoch.html#17159" class="Bound">dState&#39;&#39;</a> <a id="17168" href="Ledger.Conway.Specification.Epoch.html#17168" class="Bound">acnt&#39;&#39;</a> <a id="17175" class="Symbol">=</a> <a id="17177" href="Ledger.Conway.Specification.Epoch.html#16760" class="Function">Post-POOLREAPUpdate.updates</a> <a id="17205" href="Ledger.Conway.Specification.Epoch.html#16938" class="Bound">es</a> <a id="17208" href="Ledger.Conway.Specification.Epoch.html#12939" class="Generalizable">ls</a> <a id="17211" href="Ledger.Conway.Specification.Epoch.html#13050" class="Generalizable">dState&#39;</a> <a id="17219" href="Ledger.Conway.Specification.Epoch.html#13074" class="Generalizable">acnt&#39;</a> <a id="17225" href="Ledger.Conway.Specification.Epoch.html#16967" class="Bound">govUpd</a>

      <a id="17239" href="Ledger.Conway.Specification.Epoch.html#17239" class="Bound">es&#39;</a> <a id="17243" class="Symbol">:</a> <a id="17245" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
      <a id="17262" href="Ledger.Conway.Specification.Epoch.html#17239" class="Bound">es&#39;</a> <a id="17266" class="Symbol">=</a> <a id="17268" class="Keyword">record</a> <a id="17275" href="Ledger.Conway.Specification.Epoch.html#16938" class="Bound">es</a> <a id="17278" class="Symbol">{</a> <a id="17280" href="Ledger.Conway.Specification.Enact.html#696" class="Field">withdrawals</a> <a id="17292" class="Symbol">=</a> <a id="17294" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="17296" class="Symbol">}</a>

      <a id="17305" href="Ledger.Conway.Specification.Epoch.html#17305" class="Bound">govSt&#39;</a> <a id="17312" class="Symbol">:</a> <a id="17314" href="Ledger.Conway.Specification.Gov.html#1459" class="Function">GovState</a>
      <a id="17329" href="Ledger.Conway.Specification.Epoch.html#17305" class="Bound">govSt&#39;</a> <a id="17336" class="Symbol">=</a> <a id="17338" href="Ledger.Conway.Specification.Epoch.html#13811" class="Field">Governance-Update.govSt&#39;</a> <a id="17363" href="Ledger.Conway.Specification.Epoch.html#16967" class="Bound">govUpd</a>

      <a id="17377" href="Ledger.Conway.Specification.Epoch.html#17377" class="Bound">stakeDistrs</a> <a id="17389" class="Symbol">:</a> <a id="17391" href="Ledger.Conway.Specification.Ratify.html#3116" class="Record">StakeDistrs</a>
      <a id="17409" href="Ledger.Conway.Specification.Epoch.html#17377" class="Bound">stakeDistrs</a> <a id="17421" class="Symbol">=</a> <a id="17423" href="Ledger.Conway.Specification.Epoch.html#12515" class="Function">mkStakeDistrs</a> <a id="17437" class="Symbol">(</a><a id="17438" href="Ledger.Conway.Specification.Rewards.html#7768" class="Field">Snapshots.mark</a> <a id="17453" href="Ledger.Conway.Specification.Epoch.html#13115" class="Generalizable">ss&#39;</a><a id="17456" class="Symbol">)</a> <a id="17458" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="17460" href="Ledger.Conway.Specification.Epoch.html#17083" class="Bound">utxoSt&#39;</a>
                                  <a id="17502" href="Ledger.Conway.Specification.Epoch.html#17305" class="Bound">govSt&#39;</a> <a id="17509" class="Symbol">(</a><a id="17510" href="Ledger.Core.Specification.Certs.html#4634" class="Field">GStateOf</a> <a id="17519" href="Ledger.Conway.Specification.Epoch.html#12939" class="Generalizable">ls</a><a id="17521" class="Symbol">)</a> <a id="17523" class="Symbol">(</a><a id="17524" href="Ledger.Core.Specification.Certs.html#4418" class="Field">DStateOf</a> <a id="17533" href="Ledger.Conway.Specification.Epoch.html#12939" class="Generalizable">ls</a><a id="17535" class="Symbol">)</a>

      <a id="17544" href="Ledger.Conway.Specification.Epoch.html#17544" class="Bound">Γ</a> <a id="17546" class="Symbol">:</a> <a id="17548" href="Ledger.Conway.Specification.Ratify.html#3235" class="Record">RatifyEnv</a>
      <a id="17564" href="Ledger.Conway.Specification.Epoch.html#17544" class="Bound">Γ</a> <a id="17566" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17377}{\htmlId{17570}{\htmlClass{Bound}{\text{stakeDistrs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12830}{\htmlId{17584}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Core.Specification.Gov.Actions.html#7094}{\htmlId{17588}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12939}{\htmlId{17596}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#1446}{\htmlId{17601}{\htmlClass{Field}{\text{CCHotKeysOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12939}{\htmlId{17613}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Prelude.Base.html#889}{\htmlId{17618}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#17168}{\htmlId{17629}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#1531}{\htmlId{17638}{\htmlClass{Field}{\text{PoolsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12939}{\htmlId{17646}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Core.Specification.Gov.Actions.html#2806}{\htmlId{17651}{\htmlClass{Field}{\text{VoteDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12939}{\htmlId{17664}{\htmlClass{Generalizable}{\text{ls}}}}\, \end{pmatrix}$</a>

    <a id="17674" class="Keyword">in</a>
        <a id="17685" href="Ledger.Conway.Specification.Epoch.html#12939" class="Generalizable">ls</a> <a id="17688" href="Ledger.Conway.Specification.Rewards.html#8209" class="Datatype Operator">⊢</a> <a id="17690" href="Ledger.Conway.Specification.Epoch.html#13112" class="Generalizable">ss</a> <a id="17693" href="Ledger.Conway.Specification.Rewards.html#8209" class="Datatype Operator">⇀⦇</a> <a id="17696" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="17699" href="Ledger.Conway.Specification.Rewards.html#8209" class="Datatype Operator">,SNAP⦈</a> <a id="17706" href="Ledger.Conway.Specification.Epoch.html#13115" class="Generalizable">ss&#39;</a>
      <a id="17716" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="17718" class="Symbol">_</a>  <a id="17721" href="Ledger.Conway.Specification.PoolReap.html#866" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17083}{\htmlId{17725}{\htmlClass{Bound}{\text{utxoSt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13069}{\htmlId{17735}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#4418}{\htmlId{17742}{\htmlClass{Field}{\text{DStateOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12939}{\htmlId{17751}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17067}{\htmlId{17756}{\htmlClass{Bound}{\text{pState&#39;}}}}\, \end{pmatrix}$</a> <a id="17766" href="Ledger.Conway.Specification.PoolReap.html#866" class="Datatype Operator">⇀⦇</a> <a id="17769" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="17771" href="Ledger.Conway.Specification.PoolReap.html#866" class="Datatype Operator">,POOLREAP⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13089}{\htmlId{17784}{\htmlClass{Generalizable}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13074}{\htmlId{17795}{\htmlClass{Generalizable}{\text{acnt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13050}{\htmlId{17803}{\htmlClass{Generalizable}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13030}{\htmlId{17813}{\htmlClass{Generalizable}{\text{pState&#39;&#39;}}}}\, \end{pmatrix}$</a>
      <a id="17830" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="17832" href="Ledger.Conway.Specification.Epoch.html#17544" class="Bound">Γ</a>  <a id="17835" href="Ledger.Conway.Specification.Ratify.html#13638" class="Function Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17239}{\htmlId{17839}{\htmlClass{Bound}{\text{es&#39;}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{17845}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Agda.Builtin.Bool.html#192}{\htmlId{17849}{\htmlClass{InductiveConstructor}{\text{false}}}}\, \end{pmatrix}$</a> <a id="17857" href="Ledger.Conway.Specification.Ratify.html#13638" class="Function Operator">⇀⦇</a> <a id="17860" href="Ledger.Conway.Specification.Epoch.html#17305" class="Bound">govSt&#39;</a> <a id="17867" href="Ledger.Conway.Specification.Ratify.html#13638" class="Function Operator">,RATIFIES⦈</a> <a id="17878" href="Ledger.Conway.Specification.Epoch.html#12856" class="Generalizable">fut&#39;</a>
      <a id="17889" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="17942" class="Symbol">_</a> <a id="17944" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13069}{\htmlId{17948}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13112}{\htmlId{17955}{\htmlClass{Generalizable}{\text{ss}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12939}{\htmlId{17960}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12953}{\htmlId{17965}{\htmlClass{Generalizable}{\text{es₀}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12852}{\htmlId{17971}{\htmlClass{Generalizable}{\text{fut}}}}\, \end{pmatrix}$</a> <a id="17977" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">⇀⦇</a> <a id="17980" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="17982" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">,EPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17168}{\htmlId{17992}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13115}{\htmlId{18001}{\htmlClass{Generalizable}{\text{ss&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13089}{\htmlId{18009}{\htmlClass{Generalizable}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17305}{\htmlId{18020}{\htmlClass{Bound}{\text{govSt&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17159}{\htmlId{18031}{\htmlClass{Bound}{\text{dState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13030}{\htmlId{18042}{\htmlClass{Generalizable}{\text{pState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17075}{\htmlId{18053}{\htmlClass{Bound}{\text{gState&#39;}}}}\, \end{pmatrix} \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#17239}{\htmlId{18069}{\htmlClass{Bound}{\text{es&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12856}{\htmlId{18075}{\htmlClass{Generalizable}{\text{fut&#39;}}}}\, \end{pmatrix}$</a>


<a id="18084" class="Keyword">data</a> <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="18089" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="18107" class="Symbol">:</a> <a id="18109" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="18111" class="Symbol">→</a> <a id="18113" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a> <a id="18127" class="Symbol">→</a> <a id="18129" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a> <a id="18135" class="Symbol">→</a> <a id="18137" href="Ledger.Conway.Specification.Epoch.html#3584" class="Record">NewEpochState</a> <a id="18151" class="Symbol">→</a> <a id="18153" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="18158" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="18167" href="Ledger.Conway.Specification.Epoch.html#18167" class="InductiveConstructor">NEWEPOCH-New</a> <a id="18180" class="Symbol">:</a> <a id="18182" class="Symbol">∀</a> <a id="18184" class="Symbol">{</a><a id="18185" href="Ledger.Conway.Specification.Epoch.html#18185" class="Bound">bprev</a> <a id="18191" href="Ledger.Conway.Specification.Epoch.html#18191" class="Bound">bcur</a> <a id="18196" class="Symbol">:</a> <a id="18198" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a><a id="18208" class="Symbol">}</a> <a id="18210" class="Symbol">→</a>
    <a id="18216" class="Keyword">let</a>
      <a id="18226" href="Ledger.Conway.Specification.Epoch.html#18226" class="Bound">eps&#39;</a> <a id="18231" class="Symbol">=</a> <a id="18233" href="Ledger.Conway.Specification.Epoch.html#8948" class="Function">applyRUpd</a> <a id="18243" href="Ledger.Conway.Specification.Epoch.html#13133" class="Generalizable">ru</a> <a id="18246" href="Ledger.Conway.Specification.Epoch.html#12909" class="Generalizable">eps</a>
      <a id="18256" href="Ledger.Conway.Specification.Epoch.html#18256" class="Bound">ss</a>   <a id="18261" class="Symbol">=</a> <a id="18263" href="Ledger.Conway.Specification.Epoch.html#1923" class="Field">EpochState.ss</a> <a id="18277" href="Ledger.Conway.Specification.Epoch.html#12918" class="Generalizable">eps&#39;&#39;</a>
      <a id="18289" href="Ledger.Conway.Specification.Epoch.html#18289" class="Bound">pd&#39;</a>  <a id="18294" class="Symbol">=</a> <a id="18296" href="Ledger.Conway.Specification.Epoch.html#10022" class="Function">calculatePoolDelegatedStake</a> <a id="18324" class="Symbol">(</a><a id="18325" href="Ledger.Conway.Specification.Rewards.html#7773" class="Field">Snapshots.set</a> <a id="18339" href="Ledger.Conway.Specification.Epoch.html#18256" class="Bound">ss</a><a id="18341" class="Symbol">)</a>
    <a id="18347" class="Keyword">in</a>
      <a id="18356" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18358" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="18360" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="18362" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">lastEpoch</a> <a id="18372" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18374" class="Number">1</a>
      <a id="18382" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="18384" class="Symbol">_</a> <a id="18386" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">⊢</a> <a id="18388" href="Ledger.Conway.Specification.Epoch.html#18226" class="Bound">eps&#39;</a> <a id="18393" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">⇀⦇</a> <a id="18396" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="18398" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">,EPOCH⦈</a> <a id="18406" href="Ledger.Conway.Specification.Epoch.html#12918" class="Generalizable">eps&#39;&#39;</a>
      <a id="18418" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18471" class="Symbol">_</a> <a id="18473" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12832}{\htmlId{18477}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18185}{\htmlId{18489}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18191}{\htmlId{18497}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12909}{\htmlId{18504}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#173}{\htmlId{18510}{\htmlClass{InductiveConstructor}{\text{just}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13133}{\htmlId{18515}{\htmlClass{Generalizable}{\text{ru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13180}{\htmlId{18520}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18525" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">⇀⦇</a> <a id="18528" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="18530" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12830}{\htmlId{18543}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18191}{\htmlId{18547}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Axiom.Set.Map.html#2671}{\htmlId{18554}{\htmlClass{Function}{\text{∅ᵐ}}}}\,  \\ \,\href{Ledger.Conway.Specification.Epoch.html#12918}{\htmlId{18560}{\htmlClass{Generalizable}{\text{eps&#39;&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{18568}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18289}{\htmlId{18578}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="18587" href="Ledger.Conway.Specification.Epoch.html#18587" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="18604" class="Symbol">:</a> <a id="18606" class="Symbol">∀</a> <a id="18608" class="Symbol">{</a><a id="18609" href="Ledger.Conway.Specification.Epoch.html#18609" class="Bound">bprev</a> <a id="18615" href="Ledger.Conway.Specification.Epoch.html#18615" class="Bound">bcur</a> <a id="18620" class="Symbol">:</a> <a id="18622" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a><a id="18632" class="Symbol">}</a> <a id="18634" class="Symbol">→</a>
    <a id="18640" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18642" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="18644" href="Relation.Binary.PropositionalEquality.Core.html#1000" class="Function Operator">≢</a> <a id="18646" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">lastEpoch</a> <a id="18656" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18658" class="Number">1</a>
      <a id="18666" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18719" class="Symbol">_</a> <a id="18721" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12832}{\htmlId{18725}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18609}{\htmlId{18737}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18615}{\htmlId{18745}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12909}{\htmlId{18752}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13153}{\htmlId{18758}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13180}{\htmlId{18764}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18769" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">⇀⦇</a> <a id="18772" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="18774" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12832}{\htmlId{18787}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18609}{\htmlId{18799}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18615}{\htmlId{18807}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12909}{\htmlId{18814}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13153}{\htmlId{18820}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13180}{\htmlId{18826}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="18834" href="Ledger.Conway.Specification.Epoch.html#18834" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="18860" class="Symbol">:</a> <a id="18862" class="Symbol">∀</a> <a id="18864" class="Symbol">{</a><a id="18865" href="Ledger.Conway.Specification.Epoch.html#18865" class="Bound">bprev</a> <a id="18871" href="Ledger.Conway.Specification.Epoch.html#18871" class="Bound">bcur</a> <a id="18876" class="Symbol">:</a> <a id="18878" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a><a id="18888" class="Symbol">}</a> <a id="18890" class="Symbol">→</a>
    <a id="18896" class="Keyword">let</a>
      <a id="18906" href="Ledger.Conway.Specification.Epoch.html#18906" class="Bound">ss</a>  <a id="18910" class="Symbol">=</a> <a id="18912" href="Ledger.Conway.Specification.Epoch.html#1923" class="Field">EpochState.ss</a> <a id="18926" href="Ledger.Conway.Specification.Epoch.html#12913" class="Generalizable">eps&#39;</a>
      <a id="18937" href="Ledger.Conway.Specification.Epoch.html#18937" class="Bound">pd&#39;</a> <a id="18941" class="Symbol">=</a> <a id="18943" href="Ledger.Conway.Specification.Epoch.html#10022" class="Function">calculatePoolDelegatedStake</a> <a id="18971" class="Symbol">(</a><a id="18972" href="Ledger.Conway.Specification.Rewards.html#7773" class="Field">Snapshots.set</a> <a id="18986" href="Ledger.Conway.Specification.Epoch.html#18906" class="Bound">ss</a><a id="18988" class="Symbol">)</a>
    <a id="18994" class="Keyword">in</a>
      <a id="19003" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="19005" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="19007" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="19009" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">lastEpoch</a> <a id="19019" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="19021" class="Number">1</a>
      <a id="19029" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="19031" class="Symbol">_</a> <a id="19033" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">⊢</a> <a id="19035" href="Ledger.Conway.Specification.Epoch.html#12909" class="Generalizable">eps</a> <a id="19039" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">⇀⦇</a> <a id="19042" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="19044" href="Ledger.Conway.Specification.Epoch.html#16846" class="Datatype Operator">,EPOCH⦈</a> <a id="19052" href="Ledger.Conway.Specification.Epoch.html#12913" class="Generalizable">eps&#39;</a>
      <a id="19063" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="19116" class="Symbol">_</a> <a id="19118" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12832}{\htmlId{19122}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18865}{\htmlId{19134}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18871}{\htmlId{19142}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12909}{\htmlId{19149}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{19155}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13180}{\htmlId{19165}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="19170" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">⇀⦇</a> <a id="19173" href="Ledger.Conway.Specification.Epoch.html#12830" class="Generalizable">e</a> <a id="19175" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12830}{\htmlId{19188}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18871}{\htmlId{19192}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Axiom.Set.Map.html#2671}{\htmlId{19199}{\htmlClass{Function}{\text{∅ᵐ}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12913}{\htmlId{19204}{\htmlClass{Generalizable}{\text{eps&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{19211}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18937}{\htmlId{19221}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

</pre></body></html>