<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Epoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>

<a id="126" class="Keyword">module</a> <a id="133" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a>
  <a id="169" class="Symbol">(</a><a id="170" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a> <a id="174" class="Symbol">:</a> <a id="176" class="Symbol">_)</a> <a id="179" class="Symbol">(</a><a id="180" class="Keyword">open</a> <a id="185" href="Ledger.Conway.Specification.Transaction.html#991" class="Module">TransactionStructure</a> <a id="206" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a><a id="209" class="Symbol">)</a>
  <a id="213" class="Symbol">(</a><a id="214" href="Ledger.Conway.Specification.Epoch.html#214" class="Bound">abs</a> <a id="218" class="Symbol">:</a> <a id="220" href="Ledger.Core.Specification.Abstract.html#828" class="Record">AbstractFunctions</a> <a id="238" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a><a id="241" class="Symbol">)</a> <a id="243" class="Symbol">(</a><a id="244" class="Keyword">open</a> <a id="249" href="Ledger.Core.Specification.Abstract.html#828" class="Module">AbstractFunctions</a> <a id="267" href="Ledger.Conway.Specification.Epoch.html#214" class="Bound">abs</a><a id="270" class="Symbol">)</a>
  <a id="274" class="Keyword">where</a>

<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="315" class="Keyword">import</a>      <a id="327" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="340" class="Symbol">as</a> <a id="343" class="Module">ℤ</a>
<a id="345" class="Keyword">open</a> <a id="350" class="Keyword">import</a> <a id="357" href="Data.Integer.html" class="Module">Data.Integer</a>                    <a id="389" class="Keyword">using</a> <a id="395" class="Symbol">()</a> <a id="398" class="Keyword">renaming</a> <a id="407" class="Symbol">(</a><a id="408" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a> <a id="411" class="Symbol">to</a> <a id="414" class="InductiveConstructor">pos</a><a id="417" class="Symbol">)</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Data.Integer.Properties.html" class="Module">Data.Integer.Properties</a>         <a id="463" class="Keyword">using</a> <a id="469" class="Symbol">(</a><a id="470" class="Keyword">module</a> <a id="477" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a><a id="488" class="Symbol">;</a> <a id="490" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a><a id="498" class="Symbol">;</a> <a id="500" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a><a id="510" class="Symbol">;</a> <a id="512" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a><a id="523" class="Symbol">)</a>
                                            <a id="569" class="Keyword">renaming</a> <a id="578" class="Symbol">(</a><a id="579" href="Data.Integer.Properties.html#12508" class="Function">nonNegative⁻¹</a> <a id="593" class="Symbol">to</a> <a id="596" class="Function">nonNegative⁻¹ℤ</a><a id="610" class="Symbol">)</a>
<a id="612" class="Keyword">open</a> <a id="617" class="Keyword">import</a> <a id="624" href="Data.Integer.Tactic.RingSolver.html" class="Module">Data.Integer.Tactic.RingSolver</a>  <a id="656" class="Keyword">using</a> <a id="662" class="Symbol">(</a><a id="663" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a><a id="670" class="Symbol">)</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Data.Maybe.html" class="Module">Data.Maybe</a>                      <a id="716" class="Keyword">using</a> <a id="722" class="Symbol">(</a><a id="723" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a><a id="732" class="Symbol">)</a>
<a id="734" class="Keyword">open</a> <a id="739" class="Keyword">import</a> <a id="746" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a>  <a id="778" class="Keyword">using</a> <a id="784" class="Symbol">(</a><a id="785" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a><a id="792" class="Symbol">)</a>
<a id="794" class="Keyword">open</a> <a id="799" class="Keyword">import</a> <a id="806" href="Data.Rational.html" class="Module">Data.Rational</a>                   <a id="838" class="Keyword">using</a> <a id="844" class="Symbol">(</a><a id="845" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="846" class="Symbol">;</a> <a id="848" href="Data.Rational.Base.html#7195" class="Function">floor</a><a id="853" class="Symbol">;</a> <a id="855" href="Data.Rational.Base.html#6394" class="Function Operator">_*_</a><a id="858" class="Symbol">;</a> <a id="860" href="Data.Rational.Base.html#6787" class="Function Operator">_÷_</a><a id="863" class="Symbol">;</a> <a id="865" href="Data.Rational.Base.html#3963" class="Function Operator">_/_</a><a id="868" class="Symbol">;</a> <a id="870" href="Data.Rational.Base.html#6933" class="Function Operator">_⊓_</a><a id="873" class="Symbol">;</a> <a id="875" href="Data.Rational.Properties.html#4152" class="Function Operator">_≟_</a><a id="878" class="Symbol">;</a> <a id="880" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a><a id="889" class="Symbol">)</a>
<a id="891" class="Keyword">open</a> <a id="896" class="Keyword">import</a> <a id="903" href="Data.Rational.Literals.html" class="Module">Data.Rational.Literals</a>          <a id="935" class="Keyword">using</a> <a id="941" class="Symbol">(</a><a id="942" href="Data.Rational.Literals.html#740" class="Function">number</a><a id="948" class="Symbol">;</a> <a id="950" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a><a id="955" class="Symbol">)</a>
<a id="957" class="Keyword">open</a> <a id="962" class="Keyword">import</a> <a id="969" href="Data.Rational.Properties.html" class="Module">Data.Rational.Properties</a>        <a id="1001" class="Keyword">using</a> <a id="1007" class="Symbol">(</a><a id="1008" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a><a id="1021" class="Symbol">;</a> <a id="1023" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a><a id="1033" class="Symbol">;</a> <a id="1035" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a><a id="1040" class="Symbol">)</a>

<a id="1043" class="Keyword">open</a> <a id="1048" class="Keyword">import</a> <a id="1055" href="stdlib.Data.Rational.Properties.html" class="Module">stdlib.Data.Rational.Properties</a> <a id="1087" class="Keyword">using</a> <a id="1093" class="Symbol">(</a><a id="1094" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a><a id="1104" class="Symbol">;</a> <a id="1106" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a><a id="1113" class="Symbol">;</a> <a id="1115" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a><a id="1123" class="Symbol">;</a> <a id="1125" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a><a id="1132" class="Symbol">;</a> <a id="1134" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a><a id="1142" class="Symbol">)</a>

<a id="1145" class="Keyword">open</a> <a id="1150" class="Keyword">import</a> <a id="1157" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="1172" class="Keyword">hiding</a> <a id="1179" class="Symbol">(</a><a id="1180" href="Data.List.Base.html#5114" class="Function">iterate</a><a id="1187" class="Symbol">;</a> <a id="1189" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="1192" class="Symbol">;</a> <a id="1194" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="1197" class="Symbol">;</a> <a id="1199" href="Data.Nat.Base.html#5851" class="Function Operator">_⊓_</a><a id="1202" class="Symbol">;</a> <a id="1204" href="Class.DecEq.Core.html#168" class="Field Operator">_≟_</a><a id="1207" class="Symbol">;</a> <a id="1209" href="Data.Nat.Base.html#3425" class="Function">≢-nonZero</a><a id="1218" class="Symbol">)</a>
<a id="1220" class="Keyword">open</a> <a id="1225" class="Keyword">import</a> <a id="1232" href="Ledger.Prelude.Numeric.UnitInterval.html" class="Module">Ledger.Prelude.Numeric.UnitInterval</a> <a id="1268" class="Keyword">using</a> <a id="1274" class="Symbol">(</a><a id="1275" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a><a id="1291" class="Symbol">;</a> <a id="1293" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a><a id="1310" class="Symbol">)</a>

<a id="1313" class="Keyword">open</a> <a id="1318" class="Keyword">import</a> <a id="1325" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="1359" href="Ledger.Conway.Specification.Transaction.html#2065" class="Function">govStructure</a>
<a id="1372" class="Keyword">open</a> <a id="1377" class="Keyword">import</a> <a id="1384" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="1418" href="Ledger.Conway.Specification.Transaction.html#2065" class="Function">govStructure</a>
<a id="1431" class="Keyword">open</a> <a id="1436" class="Keyword">import</a> <a id="1443" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="1475" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a>
<a id="1479" class="Keyword">open</a> <a id="1484" class="Keyword">import</a> <a id="1491" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="1526" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a> <a id="1530" href="Ledger.Conway.Specification.Epoch.html#214" class="Bound">abs</a>
<a id="1534" class="Keyword">open</a> <a id="1539" class="Keyword">import</a> <a id="1546" href="Ledger.Conway.Specification.PoolReap.html" class="Module">Ledger.Conway.Specification.PoolReap</a> <a id="1583" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a> <a id="1587" href="Ledger.Conway.Specification.Epoch.html#214" class="Bound">abs</a>
<a id="1591" class="Keyword">open</a> <a id="1596" class="Keyword">import</a> <a id="1603" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="1638" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a>
<a id="1642" class="Keyword">open</a> <a id="1647" class="Keyword">import</a> <a id="1654" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="1690" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a> <a id="1694" href="Ledger.Conway.Specification.Epoch.html#214" class="Bound">abs</a>
<a id="1698" class="Keyword">open</a> <a id="1703" class="Keyword">import</a> <a id="1710" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="1743" href="Ledger.Conway.Specification.Epoch.html#170" class="Bound">txs</a> <a id="1747" href="Ledger.Conway.Specification.Epoch.html#214" class="Bound">abs</a>

<a id="1752" class="Keyword">open</a> <a id="1757" href="Ledger.Prelude.html#2436" class="Module">Filter</a> <a id="1764" class="Keyword">using</a> <a id="1770" class="Symbol">(</a><a id="1771" href="Ledger.Prelude.html#2451" class="Function">filter</a><a id="1777" class="Symbol">)</a>
<a id="1779" class="Keyword">open</a> <a id="1784" href="Agda.Builtin.FromNat.html#196" class="Module">Number</a> <a id="1791" href="Data.Rational.Literals.html#740" class="Function">number</a> <a id="1798" class="Keyword">renaming</a> <a id="1807" class="Symbol">(</a><a id="1808" href="Agda.Builtin.FromNat.html#281" class="Field">fromNat</a> <a id="1816" class="Symbol">to</a> <a id="1819" class="Field">fromℕ</a><a id="1824" class="Symbol">)</a>


<a id="1828" class="Keyword">record</a> <a id="EpochState"></a><a id="1835" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a> <a id="1846" class="Symbol">:</a> <a id="1848" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1853" class="Keyword">where</a>


  <a id="1863" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1875" href="Ledger.Conway.Specification.Epoch.html#1875" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>


  <a id="1893" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1903" href="Ledger.Conway.Specification.Epoch.html#1903" class="Field">acnt</a>       <a id="1914" class="Symbol">:</a> <a id="1916" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1925" href="Ledger.Conway.Specification.Epoch.html#1925" class="Field">ss</a>         <a id="1936" class="Symbol">:</a> <a id="1938" href="Ledger.Conway.Specification.Rewards.html#7736" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1952" href="Ledger.Conway.Specification.Epoch.html#1952" class="Field">ls</a>         <a id="1963" class="Symbol">:</a> <a id="1965" href="Ledger.Conway.Specification.Ledger.html#991" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1976" href="Ledger.Conway.Specification.Epoch.html#1976" class="Field">es</a>         <a id="1987" class="Symbol">:</a> <a id="1989" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="2004" href="Ledger.Conway.Specification.Epoch.html#2004" class="Field">fut</a>        <a id="2015" class="Symbol">:</a> <a id="2017" href="Ledger.Conway.Specification.Ratify.html#3529" class="Record">RatifyState</a>


<a id="2031" class="Keyword">record</a> <a id="HasEpochState"></a><a id="2038" href="Ledger.Conway.Specification.Epoch.html#2038" class="Record">HasEpochState</a> <a id="2052" class="Symbol">{</a><a id="2053" href="Ledger.Conway.Specification.Epoch.html#2053" class="Bound">a</a><a id="2054" class="Symbol">}</a> <a id="2056" class="Symbol">(</a><a id="2057" href="Ledger.Conway.Specification.Epoch.html#2057" class="Bound">A</a> <a id="2059" class="Symbol">:</a> <a id="2061" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2066" href="Ledger.Conway.Specification.Epoch.html#2053" class="Bound">a</a><a id="2067" class="Symbol">)</a> <a id="2069" class="Symbol">:</a> <a id="2071" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2076" href="Ledger.Conway.Specification.Epoch.html#2053" class="Bound">a</a> <a id="2078" class="Keyword">where</a>
  <a id="2086" class="Keyword">field</a> <a id="HasEpochState.EpochStateOf"></a><a id="2092" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a> <a id="2105" class="Symbol">:</a> <a id="2107" href="Ledger.Conway.Specification.Epoch.html#2057" class="Bound">A</a> <a id="2109" class="Symbol">→</a> <a id="2111" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
<a id="2122" class="Keyword">open</a> <a id="2127" href="Ledger.Conway.Specification.Epoch.html#2038" class="Module">HasEpochState</a> <a id="2141" class="Symbol">⦃...⦄</a> <a id="2147" class="Keyword">public</a>

<a id="2155" class="Keyword">instance</a>
  <a id="HasSnapshots-EpochState"></a><a id="2166" href="Ledger.Conway.Specification.Epoch.html#2166" class="Function">HasSnapshots-EpochState</a> <a id="2190" class="Symbol">:</a> <a id="2192" href="Ledger.Conway.Specification.Rewards.html#7827" class="Record">HasSnapshots</a> <a id="2205" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="2218" href="Ledger.Conway.Specification.Epoch.html#2166" class="Function">HasSnapshots-EpochState</a> <a id="2242" class="Symbol">.</a><a id="2243" href="Ledger.Conway.Specification.Rewards.html#7880" class="Field">SnapshotsOf</a> <a id="2255" class="Symbol">=</a> <a id="2257" href="Ledger.Conway.Specification.Epoch.html#1925" class="Field">EpochState.ss</a>

  <a id="HasLState-EpochState"></a><a id="2274" href="Ledger.Conway.Specification.Epoch.html#2274" class="Function">HasLState-EpochState</a> <a id="2295" class="Symbol">:</a> <a id="2297" href="Ledger.Conway.Specification.Ledger.html#1135" class="Record">HasLState</a> <a id="2307" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="2320" href="Ledger.Conway.Specification.Epoch.html#2274" class="Function">HasLState-EpochState</a> <a id="2341" class="Symbol">.</a><a id="2342" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a> <a id="2351" class="Symbol">=</a> <a id="2353" href="Ledger.Conway.Specification.Epoch.html#1952" class="Field">EpochState.ls</a>

  <a id="HasGovState-EpochState"></a><a id="2370" href="Ledger.Conway.Specification.Epoch.html#2370" class="Function">HasGovState-EpochState</a> <a id="2393" class="Symbol">:</a> <a id="2395" href="Ledger.Conway.Specification.Gov.html#1533" class="Record">HasGovState</a> <a id="2407" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="2420" href="Ledger.Conway.Specification.Epoch.html#2370" class="Function">HasGovState-EpochState</a> <a id="2443" class="Symbol">.</a><a id="2444" href="Ledger.Conway.Specification.Gov.html#1585" class="Field">GovStateOf</a> <a id="2455" class="Symbol">=</a> <a id="2457" href="Ledger.Conway.Specification.Gov.html#1585" class="Field">GovStateOf</a> <a id="2468" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2470" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a>

  <a id="HasEnactState-EpochState"></a><a id="2482" href="Ledger.Conway.Specification.Epoch.html#2482" class="Function">HasEnactState-EpochState</a> <a id="2507" class="Symbol">:</a> <a id="2509" href="Ledger.Conway.Specification.Enact.html#733" class="Record">HasEnactState</a> <a id="2523" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="2536" href="Ledger.Conway.Specification.Epoch.html#2482" class="Function">HasEnactState-EpochState</a> <a id="2561" class="Symbol">.</a><a id="2562" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="2575" class="Symbol">=</a> <a id="2577" href="Ledger.Conway.Specification.Epoch.html#1976" class="Field">EpochState.es</a>

  <a id="HasDeposits-EpochState"></a><a id="2594" href="Ledger.Conway.Specification.Epoch.html#2594" class="Function">HasDeposits-EpochState</a> <a id="2617" class="Symbol">:</a> <a id="2619" href="Ledger.Core.Specification.Certs.html#833" class="Record">HasDeposits</a> <a id="2631" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="2644" href="Ledger.Conway.Specification.Epoch.html#2594" class="Function">HasDeposits-EpochState</a> <a id="2667" class="Symbol">.</a><a id="2668" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="2679" class="Symbol">=</a> <a id="2681" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="2692" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2694" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a>

  <a id="HasDReps-EpochState"></a><a id="2706" href="Ledger.Conway.Specification.Epoch.html#2706" class="Function">HasDReps-EpochState</a> <a id="2726" class="Symbol">:</a> <a id="2728" href="Ledger.Core.Specification.Gov.Actions.html#7045" class="Record">HasDReps</a> <a id="2737" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="2750" href="Ledger.Conway.Specification.Epoch.html#2706" class="Function">HasDReps-EpochState</a> <a id="2770" class="Symbol">.</a><a id="2771" href="Ledger.Core.Specification.Gov.Actions.html#7094" class="Field">DRepsOf</a> <a id="2779" class="Symbol">=</a> <a id="2781" href="Ledger.Core.Specification.Gov.Actions.html#7094" class="Field">DRepsOf</a> <a id="2789" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2791" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="2803" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2805" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a>

  <a id="HasTreasury-EpochState"></a><a id="2817" href="Ledger.Conway.Specification.Epoch.html#2817" class="Function">HasTreasury-EpochState</a> <a id="2840" class="Symbol">:</a> <a id="2842" href="Ledger.Prelude.Base.html#837" class="Record">HasTreasury</a> <a id="2854" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="2867" href="Ledger.Conway.Specification.Epoch.html#2817" class="Function">HasTreasury-EpochState</a> <a id="2890" class="Symbol">.</a><a id="2891" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="2902" class="Symbol">=</a> <a id="2904" href="Ledger.Conway.Specification.PParams.html#773" class="Field">Acnt.treasury</a> <a id="2918" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2920" href="Ledger.Conway.Specification.Epoch.html#1903" class="Field">EpochState.acnt</a>

  <a id="HasReserves-EpochState"></a><a id="2939" href="Ledger.Conway.Specification.Epoch.html#2939" class="Function">HasReserves-EpochState</a> <a id="2962" class="Symbol">:</a> <a id="2964" href="Ledger.Prelude.Base.html#721" class="Record">HasReserves</a> <a id="2976" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="2989" href="Ledger.Conway.Specification.Epoch.html#2939" class="Function">HasReserves-EpochState</a> <a id="3012" class="Symbol">.</a><a id="3013" href="Ledger.Prelude.Base.html#773" class="Field">ReservesOf</a> <a id="3024" class="Symbol">=</a> <a id="3026" href="Ledger.Conway.Specification.PParams.html#782" class="Field">Acnt.reserves</a> <a id="3040" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3042" href="Ledger.Conway.Specification.Epoch.html#1903" class="Field">EpochState.acnt</a>

  <a id="HasPParams-EpochState"></a><a id="3061" href="Ledger.Conway.Specification.Epoch.html#3061" class="Function">HasPParams-EpochState</a> <a id="3083" class="Symbol">:</a> <a id="3085" href="Ledger.Conway.Specification.PParams.html#3491" class="Record">HasPParams</a> <a id="3096" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="3109" href="Ledger.Conway.Specification.Epoch.html#3061" class="Function">HasPParams-EpochState</a> <a id="3131" class="Symbol">.</a><a id="3132" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="3142" class="Symbol">=</a> <a id="3144" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="3154" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3156" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a>

  <a id="HasRatifyState-EpochState"></a><a id="3172" href="Ledger.Conway.Specification.Epoch.html#3172" class="Function">HasRatifyState-EpochState</a> <a id="3198" class="Symbol">:</a> <a id="3200" href="Ledger.Conway.Specification.Ratify.html#3665" class="Record">HasRatifyState</a> <a id="3215" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="3228" href="Ledger.Conway.Specification.Epoch.html#3172" class="Function">HasRatifyState-EpochState</a> <a id="3254" class="Symbol">.</a><a id="3255" href="Ledger.Conway.Specification.Ratify.html#3720" class="Field">RatifyStateOf</a> <a id="3269" class="Symbol">=</a> <a id="3271" href="Ledger.Conway.Specification.Epoch.html#2004" class="Field">EpochState.fut</a>

  <a id="HasPState-EpochState"></a><a id="3289" href="Ledger.Conway.Specification.Epoch.html#3289" class="Function">HasPState-EpochState</a> <a id="3310" class="Symbol">:</a> <a id="3312" href="Ledger.Core.Specification.Certs.html#4476" class="Record">HasPState</a> <a id="3322" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="3335" href="Ledger.Conway.Specification.Epoch.html#3289" class="Function">HasPState-EpochState</a> <a id="3356" class="Symbol">.</a><a id="3357" href="Ledger.Core.Specification.Certs.html#4526" class="Field">PStateOf</a> <a id="3366" class="Symbol">=</a> <a id="3368" href="Ledger.Core.Specification.Certs.html#4526" class="Field">PStateOf</a> <a id="3377" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3379" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="3391" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3393" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a>

  <a id="HasRetiring-EpochState"></a><a id="3405" href="Ledger.Conway.Specification.Epoch.html#3405" class="Function">HasRetiring-EpochState</a> <a id="3428" class="Symbol">:</a> <a id="3430" href="Ledger.Core.Specification.Certs.html#1559" class="Record">HasRetiring</a> <a id="3442" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="3455" href="Ledger.Conway.Specification.Epoch.html#3405" class="Function">HasRetiring-EpochState</a> <a id="3478" class="Symbol">.</a><a id="3479" href="Ledger.Core.Specification.Certs.html#1611" class="Field">RetiringOf</a> <a id="3490" class="Symbol">=</a> <a id="3492" href="Ledger.Core.Specification.Certs.html#1611" class="Field">RetiringOf</a> <a id="3503" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3505" href="Ledger.Core.Specification.Certs.html#4526" class="Field">PStateOf</a>


<a id="PoolDelegatedStake"></a><a id="3516" href="Ledger.Conway.Specification.Epoch.html#3516" class="Function">PoolDelegatedStake</a> <a id="3535" class="Symbol">:</a> <a id="3537" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3542" href="Ledger.Conway.Specification.Epoch.html#3516" class="Function">PoolDelegatedStake</a> <a id="3561" class="Symbol">=</a> <a id="3563" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="3571" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3573" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>

<a id="3579" class="Keyword">record</a> <a id="NewEpochState"></a><a id="3586" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a> <a id="3600" class="Symbol">:</a> <a id="3602" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3607" class="Keyword">where</a>
  <a id="3615" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="3625" href="Ledger.Conway.Specification.Epoch.html#3625" class="Field">lastEpoch</a>   <a id="3637" class="Symbol">:</a> <a id="3639" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
    <a id="NewEpochState.bprev"></a><a id="3649" href="Ledger.Conway.Specification.Epoch.html#3649" class="Field">bprev</a>       <a id="3661" class="Symbol">:</a> <a id="3663" href="Ledger.Conway.Specification.Rewards.html#4923" class="Function">BlocksMade</a>
    <a id="NewEpochState.bcur"></a><a id="3678" href="Ledger.Conway.Specification.Epoch.html#3678" class="Field">bcur</a>        <a id="3690" class="Symbol">:</a> <a id="3692" href="Ledger.Conway.Specification.Rewards.html#4923" class="Function">BlocksMade</a>
    <a id="NewEpochState.epochState"></a><a id="3707" href="Ledger.Conway.Specification.Epoch.html#3707" class="Field">epochState</a>  <a id="3719" class="Symbol">:</a> <a id="3721" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="3736" href="Ledger.Conway.Specification.Epoch.html#3736" class="Field">ru</a>          <a id="3748" class="Symbol">:</a> <a id="3750" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3756" href="Ledger.Conway.Specification.Rewards.html#6266" class="Record">RewardUpdate</a>
    <a id="NewEpochState.pd"></a><a id="3773" href="Ledger.Conway.Specification.Epoch.html#3773" class="Field">pd</a>          <a id="3785" class="Symbol">:</a> <a id="3787" href="Ledger.Conway.Specification.Epoch.html#3516" class="Function">PoolDelegatedStake</a>


<a id="3808" class="Keyword">record</a> <a id="HasNewEpochState"></a><a id="3815" href="Ledger.Conway.Specification.Epoch.html#3815" class="Record">HasNewEpochState</a> <a id="3832" class="Symbol">{</a><a id="3833" href="Ledger.Conway.Specification.Epoch.html#3833" class="Bound">a</a><a id="3834" class="Symbol">}</a> <a id="3836" class="Symbol">(</a><a id="3837" href="Ledger.Conway.Specification.Epoch.html#3837" class="Bound">A</a> <a id="3839" class="Symbol">:</a> <a id="3841" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3846" href="Ledger.Conway.Specification.Epoch.html#3833" class="Bound">a</a><a id="3847" class="Symbol">)</a> <a id="3849" class="Symbol">:</a> <a id="3851" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3856" href="Ledger.Conway.Specification.Epoch.html#3833" class="Bound">a</a> <a id="3858" class="Keyword">where</a>
  <a id="3866" class="Keyword">field</a> <a id="HasNewEpochState.NewEpochStateOf"></a><a id="3872" href="Ledger.Conway.Specification.Epoch.html#3872" class="Field">NewEpochStateOf</a> <a id="3888" class="Symbol">:</a> <a id="3890" href="Ledger.Conway.Specification.Epoch.html#3837" class="Bound">A</a> <a id="3892" class="Symbol">→</a> <a id="3894" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
<a id="3908" class="Keyword">open</a> <a id="3913" href="Ledger.Conway.Specification.Epoch.html#3815" class="Module">HasNewEpochState</a> <a id="3930" class="Symbol">⦃...⦄</a> <a id="3936" class="Keyword">public</a>
<a id="3943" class="Keyword">record</a> <a id="HasLastEpoch"></a><a id="3950" href="Ledger.Conway.Specification.Epoch.html#3950" class="Record">HasLastEpoch</a>     <a id="3967" class="Symbol">{</a><a id="3968" href="Ledger.Conway.Specification.Epoch.html#3968" class="Bound">a</a><a id="3969" class="Symbol">}</a> <a id="3971" class="Symbol">(</a><a id="3972" href="Ledger.Conway.Specification.Epoch.html#3972" class="Bound">A</a> <a id="3974" class="Symbol">:</a> <a id="3976" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3981" href="Ledger.Conway.Specification.Epoch.html#3968" class="Bound">a</a><a id="3982" class="Symbol">)</a> <a id="3984" class="Symbol">:</a> <a id="3986" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3991" href="Ledger.Conway.Specification.Epoch.html#3968" class="Bound">a</a> <a id="3993" class="Keyword">where</a> <a id="3999" class="Keyword">field</a> <a id="HasLastEpoch.LastEpochOf"></a><a id="4005" href="Ledger.Conway.Specification.Epoch.html#4005" class="Field">LastEpochOf</a>     <a id="4021" class="Symbol">:</a> <a id="4023" href="Ledger.Conway.Specification.Epoch.html#3972" class="Bound">A</a> <a id="4025" class="Symbol">→</a> <a id="4027" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
<a id="4033" class="Keyword">open</a> <a id="4038" href="Ledger.Conway.Specification.Epoch.html#3950" class="Module">HasLastEpoch</a>     <a id="4055" class="Symbol">⦃...⦄</a> <a id="4061" class="Keyword">public</a>

<a id="4069" class="Keyword">instance</a>
  <a id="HasLastEpoch-NewEpochState"></a><a id="4080" href="Ledger.Conway.Specification.Epoch.html#4080" class="Function">HasLastEpoch-NewEpochState</a> <a id="4107" class="Symbol">:</a> <a id="4109" href="Ledger.Conway.Specification.Epoch.html#3950" class="Record">HasLastEpoch</a> <a id="4122" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="4138" href="Ledger.Conway.Specification.Epoch.html#4080" class="Function">HasLastEpoch-NewEpochState</a> <a id="4165" class="Symbol">.</a><a id="4166" href="Ledger.Conway.Specification.Epoch.html#4005" class="Field">LastEpochOf</a> <a id="4178" class="Symbol">=</a> <a id="4180" href="Ledger.Conway.Specification.Epoch.html#3625" class="Field">NewEpochState.lastEpoch</a>

  <a id="HasEpochState-NewEpochState"></a><a id="4207" href="Ledger.Conway.Specification.Epoch.html#4207" class="Function">HasEpochState-NewEpochState</a> <a id="4235" class="Symbol">:</a> <a id="4237" href="Ledger.Conway.Specification.Epoch.html#2038" class="Record">HasEpochState</a> <a id="4251" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="4267" href="Ledger.Conway.Specification.Epoch.html#4207" class="Function">HasEpochState-NewEpochState</a> <a id="4295" class="Symbol">.</a><a id="4296" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a> <a id="4309" class="Symbol">=</a> <a id="4311" href="Ledger.Conway.Specification.Epoch.html#3707" class="Field">NewEpochState.epochState</a>

  <a id="HasEnactState-NewEpochState"></a><a id="4339" href="Ledger.Conway.Specification.Epoch.html#4339" class="Function">HasEnactState-NewEpochState</a> <a id="4367" class="Symbol">:</a> <a id="4369" href="Ledger.Conway.Specification.Enact.html#733" class="Record">HasEnactState</a> <a id="4383" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="4399" href="Ledger.Conway.Specification.Epoch.html#4339" class="Function">HasEnactState-NewEpochState</a> <a id="4427" class="Symbol">.</a><a id="4428" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="4441" class="Symbol">=</a> <a id="4443" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="4456" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4458" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a>

  <a id="Hastreasury-NewEpochState"></a><a id="4474" href="Ledger.Conway.Specification.Epoch.html#4474" class="Function">Hastreasury-NewEpochState</a> <a id="4500" class="Symbol">:</a> <a id="4502" href="Ledger.Prelude.Base.html#837" class="Record">HasTreasury</a> <a id="4514" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="4530" href="Ledger.Conway.Specification.Epoch.html#4474" class="Function">Hastreasury-NewEpochState</a> <a id="4556" class="Symbol">.</a><a id="4557" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="4568" class="Symbol">=</a> <a id="4570" href="Ledger.Prelude.Base.html#889" class="Field">TreasuryOf</a> <a id="4581" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4583" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a>

  <a id="HasLState-NewEpochState"></a><a id="4599" href="Ledger.Conway.Specification.Epoch.html#4599" class="Function">HasLState-NewEpochState</a> <a id="4623" class="Symbol">:</a> <a id="4625" href="Ledger.Conway.Specification.Ledger.html#1135" class="Record">HasLState</a> <a id="4635" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="4651" href="Ledger.Conway.Specification.Epoch.html#4599" class="Function">HasLState-NewEpochState</a> <a id="4675" class="Symbol">.</a><a id="4676" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a> <a id="4685" class="Symbol">=</a> <a id="4687" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a> <a id="4696" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4698" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a>

  <a id="HasGovState-NewEpochState"></a><a id="4714" href="Ledger.Conway.Specification.Epoch.html#4714" class="Function">HasGovState-NewEpochState</a> <a id="4740" class="Symbol">:</a> <a id="4742" href="Ledger.Conway.Specification.Gov.html#1533" class="Record">HasGovState</a> <a id="4754" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="4770" href="Ledger.Conway.Specification.Epoch.html#4714" class="Function">HasGovState-NewEpochState</a> <a id="4796" class="Symbol">.</a><a id="4797" href="Ledger.Conway.Specification.Gov.html#1585" class="Field">GovStateOf</a> <a id="4808" class="Symbol">=</a> <a id="4810" href="Ledger.Conway.Specification.Gov.html#1585" class="Field">GovStateOf</a> <a id="4821" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4823" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a>

  <a id="HasCertState-NewEpochState"></a><a id="4835" href="Ledger.Conway.Specification.Epoch.html#4835" class="Function">HasCertState-NewEpochState</a> <a id="4862" class="Symbol">:</a> <a id="4864" href="Ledger.Core.Specification.Certs.html#4692" class="Record">HasCertState</a> <a id="4877" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="4893" href="Ledger.Conway.Specification.Epoch.html#4835" class="Function">HasCertState-NewEpochState</a> <a id="4920" class="Symbol">.</a><a id="4921" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="4933" class="Symbol">=</a> <a id="4935" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="4947" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4949" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a>

  <a id="HasDReps-NewEpochState"></a><a id="4961" href="Ledger.Conway.Specification.Epoch.html#4961" class="Function">HasDReps-NewEpochState</a> <a id="4984" class="Symbol">:</a> <a id="4986" href="Ledger.Core.Specification.Gov.Actions.html#7045" class="Record">HasDReps</a> <a id="4995" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="5011" href="Ledger.Conway.Specification.Epoch.html#4961" class="Function">HasDReps-NewEpochState</a> <a id="5034" class="Symbol">.</a><a id="5035" href="Ledger.Core.Specification.Gov.Actions.html#7094" class="Field">DRepsOf</a> <a id="5043" class="Symbol">=</a> <a id="5045" href="Ledger.Core.Specification.Gov.Actions.html#7094" class="Field">DRepsOf</a> <a id="5053" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5055" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a>

  <a id="HasRewards-NewEpochState"></a><a id="5070" href="Ledger.Conway.Specification.Epoch.html#5070" class="Function">HasRewards-NewEpochState</a> <a id="5095" class="Symbol">:</a> <a id="5097" href="Ledger.Core.Specification.Certs.html#1645" class="Record">HasRewards</a> <a id="5108" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="5124" href="Ledger.Conway.Specification.Epoch.html#5070" class="Function">HasRewards-NewEpochState</a> <a id="5149" class="Symbol">.</a><a id="5150" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="5160" class="Symbol">=</a> <a id="5162" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="5172" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5174" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a>

  <a id="HasPParams-NewEpochState"></a><a id="5189" href="Ledger.Conway.Specification.Epoch.html#5189" class="Function">HasPParams-NewEpochState</a> <a id="5214" class="Symbol">:</a> <a id="5216" href="Ledger.Conway.Specification.PParams.html#3491" class="Record">HasPParams</a> <a id="5227" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>
  <a id="5243" href="Ledger.Conway.Specification.Epoch.html#5189" class="Function">HasPParams-NewEpochState</a> <a id="5268" class="Symbol">.</a><a id="5269" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="5279" class="Symbol">=</a> <a id="5281" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="5291" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5293" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a>

  <a id="5309" class="Keyword">unquoteDecl</a> <a id="HasCast-EpochState"></a><a id="5321" href="Ledger.Conway.Specification.Epoch.html#5321" class="Function">HasCast-EpochState</a> <a id="HasCast-NewEpochState"></a><a id="5340" href="Ledger.Conway.Specification.Epoch.html#5340" class="Function">HasCast-NewEpochState</a> <a id="5362" class="Symbol">=</a> <a id="5364" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="5383" class="Symbol">(</a> <a id="5385" class="Symbol">(</a><a id="5386" class="Keyword">quote</a> <a id="5392" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>     <a id="5407" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5409" href="Ledger.Conway.Specification.Epoch.html#5321" class="Function">HasCast-EpochState</a><a id="5427" class="Symbol">)</a>
    <a id="5433" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5435" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="5437" class="Symbol">(</a><a id="5438" class="Keyword">quote</a> <a id="5444" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>  <a id="5459" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5461" href="Ledger.Conway.Specification.Epoch.html#5340" class="Function">HasCast-NewEpochState</a><a id="5482" class="Symbol">)</a><a id="5483" href="Data.List.Base.html#4907" class="Function Operator">]</a><a id="5484" class="Symbol">)</a>

<a id="toRewardAddress"></a><a id="5487" href="Ledger.Conway.Specification.Epoch.html#5487" class="Function">toRewardAddress</a> <a id="5503" class="Symbol">:</a> <a id="5505" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="5516" class="Symbol">→</a> <a id="5518" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a>
<a id="5532" href="Ledger.Conway.Specification.Epoch.html#5487" class="Function">toRewardAddress</a> <a id="5548" href="Ledger.Conway.Specification.Epoch.html#5548" class="Bound">x</a> <a id="5550" class="Symbol">=</a> <a id="5552" class="Keyword">record</a> <a id="5559" class="Symbol">{</a> <a id="5561" href="Ledger.Core.Specification.Address.html#1352" class="Field">net</a> <a id="5565" class="Symbol">=</a> <a id="5567" href="Ledger.Core.Specification.Epoch.html#2703" class="Function">NetworkId</a> <a id="5577" class="Symbol">;</a> <a id="5579" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a> <a id="5585" class="Symbol">=</a> <a id="5587" href="Ledger.Conway.Specification.Epoch.html#5548" class="Bound">x</a> <a id="5589" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="5592" href="Ledger.Conway.Specification.Epoch.html#5592" class="Function">getStakeCred</a> <a id="5605" class="Symbol">:</a> <a id="5607" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a> <a id="5613" class="Symbol">→</a> <a id="5615" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5621" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
<a id="5632" href="Ledger.Conway.Specification.Epoch.html#5592" class="Function">getStakeCred</a> <a id="5645" class="Symbol">(</a><a id="5646" href="Ledger.Conway.Specification.Epoch.html#5646" class="Bound">a</a> <a id="5648" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5650" class="Symbol">_</a> <a id="5652" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5654" class="Symbol">_</a> <a id="5656" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5658" class="Symbol">_)</a> <a id="5661" class="Symbol">=</a> <a id="5663" href="Ledger.Core.Specification.Address.html#2719" class="Function">stakeCred</a> <a id="5673" href="Ledger.Conway.Specification.Epoch.html#5646" class="Bound">a</a>

<a id="5676" class="Keyword">open</a> <a id="5681" href="Ledger.Core.Specification.Gov.Actions.html#3818" class="Module">GovActionState</a> <a id="5696" class="Keyword">using</a> <a id="5702" class="Symbol">(</a><a id="5703" href="Ledger.Core.Specification.Gov.Actions.html#3885" class="Field">returnAddr</a><a id="5713" class="Symbol">)</a>

<a id="5716" class="Keyword">opaque</a>


  <a id="createRUpd"></a><a id="5727" href="Ledger.Conway.Specification.Epoch.html#5727" class="Function">createRUpd</a> <a id="5738" class="Symbol">:</a> <a id="5740" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5742" class="Symbol">→</a> <a id="5744" href="Ledger.Conway.Specification.Rewards.html#4923" class="Function">BlocksMade</a> <a id="5755" class="Symbol">→</a> <a id="5757" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a> <a id="5768" class="Symbol">→</a> <a id="5770" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a> <a id="5775" class="Symbol">→</a> <a id="5777" href="Ledger.Conway.Specification.Rewards.html#6266" class="Record">RewardUpdate</a>
  <a id="5792" href="Ledger.Conway.Specification.Epoch.html#5727" class="Function">createRUpd</a> <a id="5803" href="Ledger.Conway.Specification.Epoch.html#5803" class="Bound">slotsPerEpoch</a> <a id="5817" href="Ledger.Conway.Specification.Epoch.html#5817" class="Bound">b</a> <a id="5819" href="Ledger.Conway.Specification.Epoch.html#5819" class="Bound">es</a> <a id="5822" href="Ledger.Conway.Specification.Epoch.html#5822" class="Bound">total</a> <a id="5828" class="Symbol">=</a>
    <a id="5834" class="Keyword">record</a>  <a id="5842" class="Symbol">{</a> <a id="5844" href="Ledger.Conway.Specification.Rewards.html#6303" class="Field">Δt</a> <a id="5847" class="Symbol">=</a> <a id="5849" href="Ledger.Conway.Specification.Epoch.html#6805" class="Function">Δt₁</a>
            <a id="5865" class="Symbol">;</a> <a id="5867" href="Ledger.Conway.Specification.Rewards.html#6306" class="Field">Δr</a> <a id="5870" class="Symbol">=</a> <a id="5872" class="Number">0</a> <a id="5874" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="5876" href="Ledger.Conway.Specification.Epoch.html#6791" class="Function">Δr₁</a> <a id="5880" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5882" href="Ledger.Conway.Specification.Epoch.html#7127" class="Function">Δr₂</a>
            <a id="5898" class="Symbol">;</a> <a id="5900" href="Ledger.Conway.Specification.Rewards.html#6309" class="Field">Δf</a> <a id="5903" class="Symbol">=</a> <a id="5905" class="Number">0</a> <a id="5907" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="5909" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="5913" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a>
            <a id="5931" class="Symbol">;</a> <a id="5933" href="Ledger.Conway.Specification.Rewards.html#6329" class="Field">rs</a> <a id="5936" class="Symbol">=</a> <a id="5938" href="Ledger.Conway.Specification.Epoch.html#7032" class="Function">rs</a>


            <a id="5955" class="Symbol">;</a> <a id="5957" href="Ledger.Conway.Specification.Rewards.html#6359" class="Field">flowConservation</a> <a id="5974" class="Symbol">=</a> <a id="5976" href="Ledger.Conway.Specification.Epoch.html#7420" class="Function">flowConservation</a>
            <a id="6005" class="Symbol">;</a> <a id="6007" href="Ledger.Conway.Specification.Rewards.html#6422" class="Field">Δt-nonnegative</a> <a id="6022" class="Symbol">=</a> <a id="6024" href="Ledger.Conway.Specification.Epoch.html#8558" class="Function">Δt-nonneg</a>
            <a id="6046" class="Symbol">;</a> <a id="6048" href="Ledger.Conway.Specification.Rewards.html#6453" class="Field">Δf-nonpositive</a> <a id="6063" class="Symbol">=</a> <a id="6065" href="Ledger.Conway.Specification.Epoch.html#8740" class="Function">Δf-nonpos</a>


            <a id="6089" class="Symbol">}</a>
    <a id="6095" class="Keyword">where</a>
      <a id="6107" href="Ledger.Conway.Specification.Epoch.html#6107" class="Function">prevPp</a> <a id="6114" class="Symbol">:</a> <a id="6116" href="Ledger.Conway.Specification.PParams.html#1687" class="Record">PParams</a>
      <a id="6130" href="Ledger.Conway.Specification.Epoch.html#6107" class="Function">prevPp</a> <a id="6137" class="Symbol">=</a> <a id="6139" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="6149" href="Ledger.Conway.Specification.Epoch.html#5819" class="Bound">es</a>

      <a id="6159" href="Ledger.Conway.Specification.Epoch.html#6159" class="Function">reserves</a> <a id="6168" class="Symbol">:</a> <a id="6170" href="Ledger.Prelude.Base.html#191" class="Function">Reserves</a>
      <a id="6185" href="Ledger.Conway.Specification.Epoch.html#6159" class="Function">reserves</a> <a id="6194" class="Symbol">=</a> <a id="6196" href="Ledger.Prelude.Base.html#773" class="Field">ReservesOf</a> <a id="6207" href="Ledger.Conway.Specification.Epoch.html#5819" class="Bound">es</a>

      <a id="6217" href="Ledger.Conway.Specification.Epoch.html#6217" class="Function">pstakego</a> <a id="6226" class="Symbol">:</a> <a id="6228" href="Ledger.Conway.Specification.Rewards.html#6489" class="Record">Snapshot</a>
      <a id="6243" href="Ledger.Conway.Specification.Epoch.html#6217" class="Function">pstakego</a> <a id="6252" class="Symbol">=</a> <a id="6254" class="Symbol">(</a><a id="6255" href="Ledger.Conway.Specification.Rewards.html#7880" class="Field">SnapshotsOf</a> <a id="6267" href="Ledger.Conway.Specification.Epoch.html#5819" class="Bound">es</a><a id="6269" class="Symbol">)</a> <a id="6271" class="Symbol">.</a><a id="6272" href="Ledger.Conway.Specification.Rewards.html#7779" class="Field">Snapshots.go</a>

      <a id="6292" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a> <a id="6298" class="Symbol">:</a> <a id="6300" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
      <a id="6311" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a> <a id="6317" class="Symbol">=</a> <a id="6319" href="Ledger.Prelude.Base.html#669" class="Field">FeesOf</a> <a id="6326" class="Symbol">(</a><a id="6327" href="Ledger.Conway.Specification.Rewards.html#7880" class="Field">SnapshotsOf</a> <a id="6339" href="Ledger.Conway.Specification.Epoch.html#5819" class="Bound">es</a><a id="6341" class="Symbol">)</a>

      <a id="6350" href="Ledger.Conway.Specification.Epoch.html#6350" class="Function">stake</a> <a id="6356" class="Symbol">:</a> <a id="6358" href="Ledger.Core.Specification.Certs.html#1290" class="Function">Stake</a>
      <a id="6370" href="Ledger.Conway.Specification.Epoch.html#6350" class="Function">stake</a> <a id="6376" class="Symbol">=</a> <a id="6378" href="Ledger.Core.Specification.Certs.html#1777" class="Field">StakeOf</a> <a id="6386" href="Ledger.Conway.Specification.Epoch.html#6217" class="Function">pstakego</a>

      <a id="6402" href="Ledger.Conway.Specification.Epoch.html#6402" class="Function">delegs</a> <a id="6409" class="Symbol">:</a> <a id="6411" href="Ledger.Core.Specification.Certs.html#1330" class="Function">StakeDelegs</a>
      <a id="6429" href="Ledger.Conway.Specification.Epoch.html#6402" class="Function">delegs</a> <a id="6436" class="Symbol">=</a> <a id="6438" href="Ledger.Core.Specification.Certs.html#1861" class="Field">StakeDelegsOf</a> <a id="6452" href="Ledger.Conway.Specification.Epoch.html#6217" class="Function">pstakego</a>

      <a id="6468" href="Ledger.Conway.Specification.Epoch.html#6468" class="Function">poolParams</a> <a id="6479" class="Symbol">:</a> <a id="6481" href="Ledger.Core.Specification.Certs.html#1154" class="Function">Pools</a>
      <a id="6493" href="Ledger.Conway.Specification.Epoch.html#6468" class="Function">poolParams</a> <a id="6504" class="Symbol">=</a> <a id="6506" href="Ledger.Core.Specification.Certs.html#1531" class="Field">PoolsOf</a> <a id="6514" href="Ledger.Conway.Specification.Epoch.html#6217" class="Function">pstakego</a>

      <a id="6530" href="Ledger.Conway.Specification.Epoch.html#6530" class="Function">blocksMade</a> <a id="6541" class="Symbol">:</a> <a id="6543" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
      <a id="6551" href="Ledger.Conway.Specification.Epoch.html#6530" class="Function">blocksMade</a> <a id="6562" class="Symbol">=</a> <a id="6564" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="6567" href="Ledger.Conway.Specification.Epoch.html#6567" class="Bound">m</a> <a id="6569" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="6571" href="Ledger.Conway.Specification.Epoch.html#5817" class="Bound">b</a> <a id="6573" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="6575" href="Ledger.Conway.Specification.Epoch.html#6567" class="Bound">m</a>

      <a id="6584" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">ρ</a> <a id="6586" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">η</a> <a id="6588" href="Ledger.Conway.Specification.Epoch.html#6588" class="Function">τ</a> <a id="6590" class="Symbol">:</a> <a id="6592" href="Data.Rational.Base.html#1421" class="Record">ℚ</a>
      <a id="6600" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">ρ</a> <a id="6602" class="Symbol">=</a> <a id="6604" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a> <a id="6621" class="Symbol">(</a><a id="6622" href="Ledger.Conway.Specification.Epoch.html#6107" class="Function">prevPp</a> <a id="6629" class="Symbol">.</a><a id="6630" href="Ledger.Conway.Specification.PParams.html#2283" class="Field">PParams.monetaryExpansion</a><a id="6655" class="Symbol">)</a>
      <a id="6663" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">η</a> <a id="6665" class="Symbol">=</a> <a id="6667" href="Ledger.Conway.Specification.Epoch.html#1819" class="Function">fromℕ</a> <a id="6673" href="Ledger.Conway.Specification.Epoch.html#6530" class="Function">blocksMade</a> <a id="6684" href="Ledger.Prelude.html#2064" class="Function Operator">÷₀</a> <a id="6687" class="Symbol">(</a><a id="6688" href="Ledger.Conway.Specification.Epoch.html#1819" class="Function">fromℕ</a> <a id="6694" href="Ledger.Conway.Specification.Epoch.html#5803" class="Bound">slotsPerEpoch</a> <a id="6708" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6710" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a><a id="6725" class="Symbol">)</a>
      <a id="6733" href="Ledger.Conway.Specification.Epoch.html#6588" class="Function">τ</a> <a id="6735" class="Symbol">=</a> <a id="6737" href="Ledger.Prelude.Numeric.UnitInterval.html#1989" class="Function">fromUnitInterval</a> <a id="6754" class="Symbol">(</a><a id="6755" href="Ledger.Conway.Specification.Epoch.html#6107" class="Function">prevPp</a> <a id="6762" class="Symbol">.</a><a id="6763" href="Ledger.Conway.Specification.PParams.html#2353" class="Field">PParams.treasuryCut</a><a id="6782" class="Symbol">)</a>

      <a id="6791" href="Ledger.Conway.Specification.Epoch.html#6791" class="Function">Δr₁</a> <a id="6795" href="Ledger.Conway.Specification.Epoch.html#6795" class="Function">rewardPot</a> <a id="6805" href="Ledger.Conway.Specification.Epoch.html#6805" class="Function">Δt₁</a> <a id="6809" href="Ledger.Conway.Specification.Epoch.html#6809" class="Function">R</a> <a id="6811" class="Symbol">:</a> <a id="6813" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
      <a id="6821" href="Ledger.Conway.Specification.Epoch.html#6791" class="Function">Δr₁</a> <a id="6825" class="Symbol">=</a> <a id="6827" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="6833" class="Symbol">(</a><a id="6834" class="Number">1</a> <a id="6836" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="6838" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">η</a> <a id="6840" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6842" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">ρ</a> <a id="6844" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6846" href="Ledger.Conway.Specification.Epoch.html#1819" class="Function">fromℕ</a> <a id="6852" href="Ledger.Conway.Specification.Epoch.html#6159" class="Function">reserves</a><a id="6860" class="Symbol">)</a>
      <a id="6868" href="Ledger.Conway.Specification.Epoch.html#6795" class="Function">rewardPot</a> <a id="6878" class="Symbol">=</a> <a id="6880" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="6884" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a> <a id="6890" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6892" href="Ledger.Conway.Specification.Epoch.html#6791" class="Function">Δr₁</a>
      <a id="6902" href="Ledger.Conway.Specification.Epoch.html#6805" class="Function">Δt₁</a> <a id="6906" class="Symbol">=</a> <a id="6908" href="Data.Rational.Base.html#7195" class="Function">floor</a> <a id="6914" class="Symbol">(</a><a id="6915" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="6921" href="Ledger.Conway.Specification.Epoch.html#6795" class="Function">rewardPot</a> <a id="6931" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="6933" href="Ledger.Conway.Specification.Epoch.html#6588" class="Function">τ</a><a id="6934" class="Symbol">)</a>
      <a id="6942" href="Ledger.Conway.Specification.Epoch.html#6809" class="Function">R</a> <a id="6944" class="Symbol">=</a> <a id="6946" href="Ledger.Conway.Specification.Epoch.html#6795" class="Function">rewardPot</a> <a id="6956" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="6958" href="Ledger.Conway.Specification.Epoch.html#6805" class="Function">Δt₁</a>

      <a id="6969" href="Ledger.Conway.Specification.Epoch.html#6969" class="Function">circulation</a> <a id="6981" class="Symbol">:</a> <a id="6983" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="6994" href="Ledger.Conway.Specification.Epoch.html#6969" class="Function">circulation</a> <a id="7006" class="Symbol">=</a> <a id="7008" href="Ledger.Conway.Specification.Epoch.html#5822" class="Bound">total</a> <a id="7014" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7016" href="Ledger.Conway.Specification.Epoch.html#6159" class="Function">reserves</a>

      <a id="7032" href="Ledger.Conway.Specification.Epoch.html#7032" class="Function">rs</a> <a id="7035" class="Symbol">:</a> <a id="7037" href="Ledger.Core.Specification.Certs.html#1246" class="Function">Rewards</a>
      <a id="7051" href="Ledger.Conway.Specification.Epoch.html#7032" class="Function">rs</a> <a id="7054" class="Symbol">=</a> <a id="7056" href="Ledger.Conway.Specification.Rewards.html#5414" class="Function">reward</a> <a id="7063" href="Ledger.Conway.Specification.Epoch.html#6107" class="Function">prevPp</a> <a id="7070" href="Ledger.Conway.Specification.Epoch.html#5817" class="Bound">b</a> <a id="7072" class="Symbol">(</a><a id="7073" href="Prelude.html#3280" class="Function">posPart</a> <a id="7081" href="Ledger.Conway.Specification.Epoch.html#6809" class="Function">R</a><a id="7082" class="Symbol">)</a> <a id="7084" href="Ledger.Conway.Specification.Epoch.html#6468" class="Function">poolParams</a> <a id="7095" href="Ledger.Conway.Specification.Epoch.html#6350" class="Function">stake</a> <a id="7101" href="Ledger.Conway.Specification.Epoch.html#6402" class="Function">delegs</a> <a id="7108" href="Ledger.Conway.Specification.Epoch.html#6969" class="Function">circulation</a>

      <a id="7127" href="Ledger.Conway.Specification.Epoch.html#7127" class="Function">Δr₂</a> <a id="7131" class="Symbol">:</a> <a id="7133" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
      <a id="7141" href="Ledger.Conway.Specification.Epoch.html#7127" class="Function">Δr₂</a> <a id="7145" class="Symbol">=</a> <a id="7147" href="Ledger.Conway.Specification.Epoch.html#6809" class="Function">R</a> <a id="7149" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7151" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="7155" class="Symbol">(</a><a id="7156" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7159" href="Ledger.Conway.Specification.Epoch.html#7159" class="Bound">c</a> <a id="7161" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7163" href="Ledger.Conway.Specification.Epoch.html#7032" class="Function">rs</a> <a id="7166" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7168" href="Ledger.Conway.Specification.Epoch.html#7159" class="Bound">c</a><a id="7169" class="Symbol">)</a>


      <a id="7179" class="Comment">-- Proofs</a>
      <a id="7195" class="Comment">-- Note: Overloading of + and - seems to interfere with the ring solver.</a>
      <a id="7274" href="Ledger.Conway.Specification.Epoch.html#7274" class="Function">lemmaFlow</a> <a id="7284" class="Symbol">:</a> <a id="7286" class="Symbol">∀</a> <a id="7288" class="Symbol">(</a><a id="7289" href="Ledger.Conway.Specification.Epoch.html#7289" class="Bound">t₁</a> <a id="7292" href="Ledger.Conway.Specification.Epoch.html#7292" class="Bound">r₁</a> <a id="7295" href="Ledger.Conway.Specification.Epoch.html#7295" class="Bound">f</a> <a id="7297" href="Ledger.Conway.Specification.Epoch.html#7297" class="Bound">z</a> <a id="7299" class="Symbol">:</a> <a id="7301" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="7302" class="Symbol">)</a>
        <a id="7312" class="Symbol">→</a> <a id="7314" class="Symbol">(</a><a id="7315" href="Ledger.Conway.Specification.Epoch.html#7289" class="Bound">t₁</a> <a id="7318" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7322" class="Symbol">(</a><a id="7323" class="Number">0</a> <a id="7325" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7329" href="Ledger.Conway.Specification.Epoch.html#7292" class="Bound">r₁</a> <a id="7332" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7336" class="Symbol">((</a><a id="7338" href="Ledger.Conway.Specification.Epoch.html#7295" class="Bound">f</a> <a id="7340" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7344" href="Ledger.Conway.Specification.Epoch.html#7292" class="Bound">r₁</a> <a id="7347" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7351" href="Ledger.Conway.Specification.Epoch.html#7289" class="Bound">t₁</a><a id="7353" class="Symbol">)</a> <a id="7355" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7359" href="Ledger.Conway.Specification.Epoch.html#7297" class="Bound">z</a><a id="7360" class="Symbol">))</a> <a id="7363" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7367" class="Symbol">(</a><a id="7368" class="Number">0</a> <a id="7370" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7374" href="Ledger.Conway.Specification.Epoch.html#7295" class="Bound">f</a><a id="7375" class="Symbol">)</a> <a id="7377" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7381" href="Ledger.Conway.Specification.Epoch.html#7297" class="Bound">z</a><a id="7382" class="Symbol">)</a> <a id="7384" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7386" class="Number">0</a>
      <a id="7394" href="Ledger.Conway.Specification.Epoch.html#7274" class="Function">lemmaFlow</a> <a id="7404" class="Symbol">=</a> <a id="7406" href="Data.Integer.Tactic.RingSolver.html#1200" class="Macro">solve-∀</a>
      <a id="7420" href="Ledger.Conway.Specification.Epoch.html#7420" class="Function">flowConservation</a> <a id="7437" class="Symbol">:</a>
        <a id="7447" class="Keyword">let</a> <a id="7451" href="Ledger.Conway.Specification.Epoch.html#7451" class="Bound">t₁</a> <a id="7454" class="Symbol">=</a> <a id="7456" href="Ledger.Conway.Specification.Epoch.html#6805" class="Function">Δt₁</a>
            <a id="7472" href="Ledger.Conway.Specification.Epoch.html#7472" class="Bound">r₁</a> <a id="7475" class="Symbol">=</a> <a id="7477" href="Ledger.Conway.Specification.Epoch.html#6791" class="Function">Δr₁</a>
            <a id="7493" href="Ledger.Conway.Specification.Epoch.html#7493" class="Bound">f</a>  <a id="7496" class="Symbol">=</a> <a id="7498" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="7502" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a>
            <a id="7520" href="Ledger.Conway.Specification.Epoch.html#7520" class="Bound">z</a>  <a id="7523" class="Symbol">=</a> <a id="7525" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="7529" class="Symbol">(</a><a id="7530" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7533" href="Ledger.Conway.Specification.Epoch.html#7533" class="Bound">c</a> <a id="7535" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7537" href="Ledger.Conway.Specification.Epoch.html#7032" class="Function">rs</a> <a id="7540" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7542" href="Ledger.Conway.Specification.Epoch.html#7533" class="Bound">c</a><a id="7543" class="Symbol">)</a>
         <a id="7554" class="Keyword">in</a>
            <a id="7569" class="Symbol">(</a><a id="7570" href="Ledger.Conway.Specification.Epoch.html#7451" class="Bound">t₁</a> <a id="7573" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7577" class="Symbol">(</a><a id="7578" class="Number">0</a> <a id="7580" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7584" href="Ledger.Conway.Specification.Epoch.html#7472" class="Bound">r₁</a> <a id="7587" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7591" class="Symbol">((</a><a id="7593" href="Ledger.Conway.Specification.Epoch.html#7493" class="Bound">f</a> <a id="7595" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7599" href="Ledger.Conway.Specification.Epoch.html#7472" class="Bound">r₁</a> <a id="7602" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7606" href="Ledger.Conway.Specification.Epoch.html#7451" class="Bound">t₁</a><a id="7608" class="Symbol">)</a> <a id="7610" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7614" href="Ledger.Conway.Specification.Epoch.html#7520" class="Bound">z</a><a id="7615" class="Symbol">))</a> <a id="7618" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7622" class="Symbol">(</a><a id="7623" class="Number">0</a> <a id="7625" href="Data.Integer.Base.html#5245" class="Function Operator">ℤ.-</a> <a id="7629" href="Ledger.Conway.Specification.Epoch.html#7493" class="Bound">f</a><a id="7630" class="Symbol">)</a> <a id="7632" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="7636" href="Ledger.Conway.Specification.Epoch.html#7520" class="Bound">z</a><a id="7637" class="Symbol">)</a> <a id="7639" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7641" class="Number">0</a>
      <a id="7649" href="Ledger.Conway.Specification.Epoch.html#7420" class="Function">flowConservation</a> <a id="7666" class="Symbol">=</a> <a id="7668" href="Ledger.Conway.Specification.Epoch.html#7274" class="Function">lemmaFlow</a> <a id="7678" href="Ledger.Conway.Specification.Epoch.html#6805" class="Function">Δt₁</a> <a id="7682" href="Ledger.Conway.Specification.Epoch.html#6791" class="Function">Δr₁</a> <a id="7686" class="Symbol">(</a><a id="7687" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="7691" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a><a id="7696" class="Symbol">)</a> <a id="7698" class="Symbol">(</a><a id="7699" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="7703" class="Symbol">(</a><a id="7704" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="7707" href="Ledger.Conway.Specification.Epoch.html#7707" class="Bound">c</a> <a id="7709" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="7711" href="Ledger.Conway.Specification.Epoch.html#7032" class="Function">rs</a> <a id="7714" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="7716" href="Ledger.Conway.Specification.Epoch.html#7707" class="Bound">c</a><a id="7717" class="Symbol">))</a>

      <a id="7727" href="Ledger.Conway.Specification.Epoch.html#7727" class="Function">÷₀-0≤⇒0≤</a> <a id="7736" class="Symbol">:</a> <a id="7738" class="Symbol">∀</a> <a id="7740" class="Symbol">(</a><a id="7741" href="Ledger.Conway.Specification.Epoch.html#7741" class="Bound">x</a> <a id="7743" href="Ledger.Conway.Specification.Epoch.html#7743" class="Bound">y</a> <a id="7745" class="Symbol">:</a> <a id="7747" href="Data.Rational.Base.html#1421" class="Record">ℚ</a><a id="7748" class="Symbol">)</a> <a id="7750" class="Symbol">→</a> <a id="7752" class="Number">0</a> <a id="7754" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7756" href="Ledger.Conway.Specification.Epoch.html#7741" class="Bound">x</a> <a id="7758" class="Symbol">→</a> <a id="7760" class="Number">0</a> <a id="7762" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7764" href="Ledger.Conway.Specification.Epoch.html#7743" class="Bound">y</a> <a id="7766" class="Symbol">→</a> <a id="7768" class="Number">0</a> <a id="7770" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7772" class="Symbol">(</a><a id="7773" href="Ledger.Conway.Specification.Epoch.html#7741" class="Bound">x</a> <a id="7775" href="Ledger.Prelude.html#2064" class="Function Operator">÷₀</a> <a id="7778" href="Ledger.Conway.Specification.Epoch.html#7743" class="Bound">y</a><a id="7779" class="Symbol">)</a>
      <a id="7787" href="Ledger.Conway.Specification.Epoch.html#7727" class="Function">÷₀-0≤⇒0≤</a> <a id="7796" href="Ledger.Conway.Specification.Epoch.html#7796" class="Bound">x</a> <a id="7798" href="Ledger.Conway.Specification.Epoch.html#7798" class="Bound">y</a> <a id="7800" href="Ledger.Conway.Specification.Epoch.html#7800" class="Bound">0≤x</a> <a id="7804" href="Ledger.Conway.Specification.Epoch.html#7804" class="Bound">0≤y</a> <a id="7808" class="Keyword">with</a> <a id="7813" href="Ledger.Conway.Specification.Epoch.html#7798" class="Bound">y</a> <a id="7815" href="Data.Rational.Properties.html#4152" class="Function Operator">≟</a> <a id="7817" class="Number">0</a>
      <a id="7825" class="Symbol">...</a> <a id="7829" class="Symbol">|</a> <a id="7831" class="Symbol">(</a><a id="7832" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="7836" href="Ledger.Conway.Specification.Epoch.html#7836" class="Bound">y≡0</a><a id="7839" class="Symbol">)</a> <a id="7841" class="Symbol">=</a> <a id="7843" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="7857" class="Number">0</a>
      <a id="7865" class="Symbol">...</a> <a id="7869" class="Symbol">|</a> <a id="7871" class="Symbol">(</a><a id="7872" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="7875" href="Ledger.Conway.Specification.Epoch.html#7875" class="Bound">y≢0</a><a id="7878" class="Symbol">)</a>  <a id="7881" class="Symbol">=</a> <a id="7883" href="stdlib.Data.Rational.Properties.html#2865" class="Function">÷-0≤⇒0≤</a> <a id="7891" class="Bound">x</a> <a id="7893" class="Bound">y</a> <a id="7895" class="Symbol">{{</a><a id="7897" href="Data.Rational.Base.html#4971" class="Function">≢-nonZero</a> <a id="7907" href="Ledger.Conway.Specification.Epoch.html#7875" class="Bound">y≢0</a><a id="7910" class="Symbol">}}</a> <a id="7913" class="Bound">0≤x</a> <a id="7917" class="Bound">0≤y</a>

      <a id="7928" href="Ledger.Conway.Specification.Epoch.html#7928" class="Function">η-nonneg</a> <a id="7937" class="Symbol">:</a> <a id="7939" class="Number">0</a> <a id="7941" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="7943" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">η</a>
      <a id="7951" href="Ledger.Conway.Specification.Epoch.html#7928" class="Function">η-nonneg</a> <a id="7960" class="Symbol">=</a> <a id="7962" href="Ledger.Conway.Specification.Epoch.html#7727" class="Function">÷₀-0≤⇒0≤</a> <a id="7971" class="Symbol">_</a> <a id="7973" class="Symbol">_</a> <a id="7975" class="Symbol">(</a><a id="7976" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="7985" href="Ledger.Conway.Specification.Epoch.html#6530" class="Function">blocksMade</a><a id="7995" class="Symbol">)</a>
        <a id="8005" class="Symbol">(</a><a id="8006" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="8014" class="Symbol">_</a> <a id="8016" class="Symbol">_</a>
          <a id="8028" class="Symbol">(</a><a id="8029" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="8038" href="Ledger.Conway.Specification.Epoch.html#5803" class="Bound">slotsPerEpoch</a><a id="8051" class="Symbol">)</a>
          <a id="8063" class="Symbol">(</a><a id="8064" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="8078" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a> <a id="8094" class="Symbol">{{</a><a id="8096" href="Data.Rational.Properties.html#7555" class="Function">pos⇒nonNeg</a> <a id="8107" href="Ledger.Core.Specification.Epoch.html#2485" class="Function">ActiveSlotCoeff</a><a id="8122" class="Symbol">}}))</a>

      <a id="8134" href="Ledger.Conway.Specification.Epoch.html#8134" class="Function">min1η-nonneg</a> <a id="8147" class="Symbol">:</a> <a id="8149" class="Number">0</a> <a id="8151" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8153" class="Number">1</a> <a id="8155" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8157" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">η</a>
      <a id="8165" href="Ledger.Conway.Specification.Epoch.html#8134" class="Function">min1η-nonneg</a> <a id="8178" class="Symbol">=</a> <a id="8180" href="Algebra.Construct.NaturalChoice.MinOp.html#7120" class="Function">⊓-glb</a> <a id="8186" class="Symbol">(</a><a id="8187" href="Data.Rational.Properties.html#27061" class="Function">nonNegative⁻¹</a> <a id="8201" class="Number">1</a><a id="8202" class="Symbol">)</a> <a id="8204" href="Ledger.Conway.Specification.Epoch.html#7928" class="Function">η-nonneg</a>

      <a id="8220" href="Ledger.Conway.Specification.Epoch.html#8220" class="Function">Δr₁-nonneg</a> <a id="8231" class="Symbol">:</a> <a id="8233" class="Number">0</a> <a id="8235" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8237" href="Ledger.Conway.Specification.Epoch.html#6791" class="Function">Δr₁</a>
      <a id="8247" href="Ledger.Conway.Specification.Epoch.html#8220" class="Function">Δr₁-nonneg</a> <a id="8258" class="Symbol">=</a> <a id="8260" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="8271" class="Symbol">_</a>
        <a id="8281" class="Symbol">(</a><a id="8282" href="stdlib.Data.Rational.Properties.html#2409" class="Function">*-0≤⇒0≤</a> <a id="8290" class="Symbol">(</a><a id="8291" class="Number">1</a> <a id="8293" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8295" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">η</a> <a id="8297" href="Data.Rational.Base.html#6394" class="Function Operator">*</a> <a id="8299" href="Ledger.Conway.Specification.Epoch.html#6584" class="Function">ρ</a><a id="8300" class="Symbol">)</a> <a id="8302" class="Symbol">(</a><a id="8303" href="Ledger.Conway.Specification.Epoch.html#1819" class="Function">fromℕ</a> <a id="8309" href="Ledger.Conway.Specification.Epoch.html#6159" class="Function">reserves</a><a id="8317" class="Symbol">)</a>
          <a id="8329" class="Symbol">(</a><a id="8330" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a> <a id="8348" class="Symbol">(</a><a id="8349" class="Number">1</a> <a id="8351" href="Data.Rational.Base.html#6933" class="Function Operator">⊓</a> <a id="8353" href="Ledger.Conway.Specification.Epoch.html#6586" class="Function">η</a><a id="8354" class="Symbol">)</a> <a id="8356" class="Symbol">(</a><a id="8357" href="Ledger.Conway.Specification.Epoch.html#6107" class="Function">prevPp</a> <a id="8364" class="Symbol">.</a><a id="8365" href="Ledger.Conway.Specification.PParams.html#2283" class="Field">PParams.monetaryExpansion</a><a id="8390" class="Symbol">)</a> <a id="8392" href="Ledger.Conway.Specification.Epoch.html#8134" class="Function">min1η-nonneg</a><a id="8404" class="Symbol">)</a>
          <a id="8416" class="Symbol">(</a><a id="8417" href="stdlib.Data.Rational.Properties.html#2275" class="Function">fromℕ-0≤</a> <a id="8426" href="Ledger.Conway.Specification.Epoch.html#6159" class="Function">reserves</a><a id="8434" class="Symbol">))</a>

      <a id="8444" href="Ledger.Conway.Specification.Epoch.html#8444" class="Function">rewardPot-nonneg</a> <a id="8461" class="Symbol">:</a> <a id="8463" class="Number">0</a> <a id="8465" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8467" href="Ledger.Conway.Specification.Epoch.html#6795" class="Function">rewardPot</a>
      <a id="8483" href="Ledger.Conway.Specification.Epoch.html#8444" class="Function">rewardPot-nonneg</a> <a id="8500" class="Symbol">=</a> <a id="8502" href="Data.Integer.Properties.html#34810" class="Function">+-mono-≤</a> <a id="8511" class="Symbol">(</a><a id="8512" href="Ledger.Conway.Specification.Epoch.html#596" class="Function">nonNegative⁻¹ℤ</a> <a id="8527" class="Symbol">(</a><a id="8528" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="8532" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a><a id="8537" class="Symbol">))</a> <a id="8540" href="Ledger.Conway.Specification.Epoch.html#8220" class="Function">Δr₁-nonneg</a>

      <a id="8558" href="Ledger.Conway.Specification.Epoch.html#8558" class="Function">Δt-nonneg</a> <a id="8568" class="Symbol">:</a> <a id="8570" class="Number">0</a> <a id="8572" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8574" href="Ledger.Conway.Specification.Epoch.html#6805" class="Function">Δt₁</a>
      <a id="8584" href="Ledger.Conway.Specification.Epoch.html#8558" class="Function">Δt-nonneg</a> <a id="8594" class="Symbol">=</a> <a id="8596" href="stdlib.Data.Rational.Properties.html#1631" class="Function">0≤⇒0≤floor</a> <a id="8607" class="Symbol">_</a>
        <a id="8617" class="Symbol">(</a><a id="8618" href="Ledger.Prelude.Numeric.UnitInterval.html#3337" class="Function">UnitInterval-*-0≤</a> <a id="8636" class="Symbol">(</a><a id="8637" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="8643" href="Ledger.Conway.Specification.Epoch.html#6795" class="Function">rewardPot</a><a id="8652" class="Symbol">)</a> <a id="8654" class="Symbol">(</a><a id="8655" href="Ledger.Conway.Specification.Epoch.html#6107" class="Function">prevPp</a> <a id="8662" class="Symbol">.</a><a id="8663" href="Ledger.Conway.Specification.PParams.html#2353" class="Field">PParams.treasuryCut</a><a id="8682" class="Symbol">)</a>
          <a id="8694" class="Symbol">(</a><a id="8695" href="stdlib.Data.Rational.Properties.html#2013" class="Function">fromℤ-0≤</a> <a id="8704" href="Ledger.Conway.Specification.Epoch.html#6795" class="Function">rewardPot</a> <a id="8714" href="Ledger.Conway.Specification.Epoch.html#8444" class="Function">rewardPot-nonneg</a><a id="8730" class="Symbol">))</a>

      <a id="8740" href="Ledger.Conway.Specification.Epoch.html#8740" class="Function">Δf-nonpos</a> <a id="8750" class="Symbol">:</a> <a id="8752" class="Symbol">(</a><a id="8753" class="Number">0</a> <a id="8755" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="8757" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="8761" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a><a id="8766" class="Symbol">)</a> <a id="8768" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="8770" class="Number">0</a>
      <a id="8778" href="Ledger.Conway.Specification.Epoch.html#8740" class="Function">Δf-nonpos</a> <a id="8788" class="Symbol">=</a> <a id="8790" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
          <a id="8806" class="Number">0</a> <a id="8808" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="8810" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="8814" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a> <a id="8820" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="8823" href="Data.Integer.Properties.html#27061" class="Function">+-identityˡ</a> <a id="8835" class="Symbol">_</a> <a id="8837" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
          <a id="8849" href="Data.Integer.Base.html#4719" class="Function Operator">ℤ.-</a> <a id="8853" href="Ledger.Conway.Specification.Epoch.html#414" class="InductiveConstructor">pos</a> <a id="8857" href="Ledger.Conway.Specification.Epoch.html#6292" class="Function">feeSS</a> <a id="8863" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="8866" href="Data.Integer.Properties.html#13298" class="Function">neg-mono-≤</a> <a id="8877" class="Symbol">(</a><a id="8878" href="Data.Integer.Base.html#2106" class="InductiveConstructor">ℤ.+≤+</a> <a id="8884" href="Data.Nat.Base.html#1720" class="InductiveConstructor">z≤n</a><a id="8887" class="Symbol">)</a> <a id="8889" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
          <a id="8901" class="Number">0</a>             <a id="8915" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
        <a id="8925" class="Keyword">where</a> <a id="8931" class="Keyword">open</a> <a id="8936" href="Data.Integer.Properties.html#11881" class="Module">≤-Reasoning</a>


<a id="applyRUpd"></a><a id="8950" href="Ledger.Conway.Specification.Epoch.html#8950" class="Function">applyRUpd</a> <a id="8960" class="Symbol">:</a> <a id="8962" href="Ledger.Conway.Specification.Rewards.html#6266" class="Record">RewardUpdate</a> <a id="8975" class="Symbol">→</a> <a id="8977" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a> <a id="8988" class="Symbol">→</a> <a id="8990" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
<a id="9001" href="Ledger.Conway.Specification.Epoch.html#8950" class="Function">applyRUpd</a> <a id="9011" href="Ledger.Conway.Specification.Epoch.html#9011" class="Bound">rewardUpdate</a> <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9028}{\htmlId{9028}{\htmlClass{Bound}{\text{treasury}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9039}{\htmlId{9039}{\htmlClass{Bound}{\text{reserves}}}}\, \end{pmatrix}
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9076}{\htmlId{9076}{\htmlClass{Bound}{\text{ss}}}}\,
                       \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9108}{\htmlId{9108}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9115}{\htmlId{9115}{\htmlClass{Bound}{\text{fees}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9122}{\htmlId{9122}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9133}{\htmlId{9133}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
                         \\ \,\href{Ledger.Conway.Specification.Epoch.html#9173}{\htmlId{9173}{\htmlClass{Bound}{\text{govSt}}}}\,
                         \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9210}{\htmlId{9210}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9223}{\htmlId{9223}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9237}{\htmlId{9237}{\htmlClass{Bound}{\text{rewards}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#9250}{\htmlId{9250}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9259}{\htmlId{9259}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9298}{\htmlId{9298}{\htmlClass{Bound}{\text{es}}}}\,
                       \\ \,\href{Ledger.Conway.Specification.Epoch.html#9326}{\htmlId{9326}{\htmlClass{Bound}{\text{fut}}}}\,
                       \end{pmatrix}$</a> <a id="9357" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Prelude.html#3280}{\htmlId{9363}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9371}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#414}{\htmlId{9372}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9028}{\htmlId{9376}{\htmlClass{Bound}{\text{treasury}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9385}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6303}{\htmlId{9387}{\htmlClass{Function}{\text{Δt}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9390}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#414}{\htmlId{9392}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9947}{\htmlId{9396}{\htmlClass{Function}{\text{unregRU&#39;}}}}\,\,\htmlId{9404}{\htmlClass{Symbol}{\text{)}}}\,
                               \\ \,\href{Prelude.html#3280}{\htmlId{9439}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9447}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#414}{\htmlId{9448}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9039}{\htmlId{9452}{\htmlClass{Bound}{\text{reserves}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9461}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6306}{\htmlId{9463}{\htmlClass{Function}{\text{Δr}}}}\,\,\htmlId{9465}{\htmlClass{Symbol}{\text{)}}}\, \end{pmatrix}
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9076}{\htmlId{9500}{\htmlClass{Bound}{\text{ss}}}}\,
                             \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9108}{\htmlId{9538}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Prelude.html#3280}{\htmlId{9545}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{9553}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Epoch.html#414}{\htmlId{9554}{\htmlClass{InductiveConstructor}{\text{pos}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9115}{\htmlId{9558}{\htmlClass{Bound}{\text{fees}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{9563}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Rewards.html#6309}{\htmlId{9565}{\htmlClass{Function}{\text{Δf}}}}\,\,\htmlId{9567}{\htmlClass{Symbol}{\text{)}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9122}{\htmlId{9571}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9133}{\htmlId{9582}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
                               \\ \,\href{Ledger.Conway.Specification.Epoch.html#9173}{\htmlId{9627}{\htmlClass{Bound}{\text{govSt}}}}\,
                               \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#9210}{\htmlId{9670}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9223}{\htmlId{9683}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9237}{\htmlId{9697}{\htmlClass{Bound}{\text{rewards}}}}\, \,\href{Axiom.Set.Map.Dec.html#2149}{\htmlId{9705}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#9879}{\htmlId{9708}{\htmlClass{Function}{\text{regRU}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#9250}{\htmlId{9718}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#9259}{\htmlId{9727}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9298}{\htmlId{9769}{\htmlClass{Bound}{\text{es}}}}\,
                             \\ \,\href{Ledger.Conway.Specification.Epoch.html#9326}{\htmlId{9803}{\htmlClass{Bound}{\text{fut}}}}\, \end{pmatrix}$</a>
  <a id="9811" class="Keyword">where</a>
    <a id="9821" class="Keyword">open</a> <a id="9826" href="Ledger.Conway.Specification.Rewards.html#6266" class="Module">RewardUpdate</a> <a id="9839" href="Ledger.Conway.Specification.Epoch.html#9011" class="Bound">rewardUpdate</a> <a id="9852" class="Keyword">using</a> <a id="9858" class="Symbol">(</a><a id="9859" href="Ledger.Conway.Specification.Rewards.html#6303" class="Field">Δt</a><a id="9861" class="Symbol">;</a> <a id="9863" href="Ledger.Conway.Specification.Rewards.html#6306" class="Field">Δr</a><a id="9865" class="Symbol">;</a> <a id="9867" href="Ledger.Conway.Specification.Rewards.html#6309" class="Field">Δf</a><a id="9869" class="Symbol">;</a> <a id="9871" href="Ledger.Conway.Specification.Rewards.html#6329" class="Field">rs</a><a id="9873" class="Symbol">)</a>
    <a id="9879" href="Ledger.Conway.Specification.Epoch.html#9879" class="Function">regRU</a>     <a id="9889" class="Symbol">=</a> <a id="9891" href="Ledger.Conway.Specification.Rewards.html#6329" class="Function">rs</a> <a id="9894" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="9896" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9900" href="Ledger.Conway.Specification.Epoch.html#9237" class="Bound">rewards</a>
    <a id="9912" href="Ledger.Conway.Specification.Epoch.html#9912" class="Function">unregRU</a>   <a id="9922" class="Symbol">=</a> <a id="9924" href="Ledger.Conway.Specification.Rewards.html#6329" class="Function">rs</a> <a id="9927" href="Axiom.Set.Map.html#13606" class="Function Operator">∣</a> <a id="9929" href="Class.IsSet.html#916" class="Function">dom</a> <a id="9933" href="Ledger.Conway.Specification.Epoch.html#9237" class="Bound">rewards</a> <a id="9941" href="Axiom.Set.Map.html#13606" class="Function Operator">ᶜ</a>
    <a id="9947" href="Ledger.Conway.Specification.Epoch.html#9947" class="Function">unregRU&#39;</a>  <a id="9957" class="Symbol">=</a> <a id="9959" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="9962" href="Ledger.Conway.Specification.Epoch.html#9962" class="Bound">x</a> <a id="9964" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="9966" href="Ledger.Conway.Specification.Epoch.html#9912" class="Function">unregRU</a> <a id="9974" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="9976" href="Ledger.Conway.Specification.Epoch.html#9962" class="Bound">x</a>


<a id="9980" class="Keyword">open</a> <a id="9985" href="Ledger.Core.Specification.Address.html#1313" class="Module">RewardAddress</a> <a id="9999" class="Keyword">using</a> <a id="10005" class="Symbol">(</a><a id="10006" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a><a id="10011" class="Symbol">)</a>
<a id="10013" class="Keyword">opaque</a>


  <a id="calculatePoolDelegatedStake"></a><a id="10024" href="Ledger.Conway.Specification.Epoch.html#10024" class="Function">calculatePoolDelegatedStake</a>
    <a id="10056" class="Symbol">:</a> <a id="10058" href="Ledger.Conway.Specification.Rewards.html#6489" class="Record">Snapshot</a>
    <a id="10071" class="Symbol">→</a> <a id="10073" href="Ledger.Conway.Specification.Epoch.html#3516" class="Function">PoolDelegatedStake</a>
  <a id="10094" href="Ledger.Conway.Specification.Epoch.html#10024" class="Function">calculatePoolDelegatedStake</a> <a id="10122" href="Ledger.Conway.Specification.Epoch.html#10122" class="Bound">ss</a> <a id="10125" class="Symbol">=</a>
      <a id="10133" class="Comment">-- Shelley spec: the output map must contain keys appearing in both</a>
      <a id="10207" class="Comment">-- sd and the pool parameters.</a>
      <a id="10244" href="Ledger.Conway.Specification.Epoch.html#10480" class="Function">sd</a> <a id="10247" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="10249" href="Class.IsSet.html#916" class="Function">dom</a> <a id="10253" class="Symbol">(</a><a id="10254" href="Ledger.Core.Specification.Certs.html#1531" class="Field">PoolsOf</a> <a id="10262" href="Ledger.Conway.Specification.Epoch.html#10122" class="Bound">ss</a><a id="10264" class="Symbol">)</a>
    <a id="10270" class="Keyword">where</a>
      <a id="10282" class="Comment">-- stake credentials delegating to each pool</a>
      <a id="10333" href="Ledger.Conway.Specification.Epoch.html#10333" class="Function">stakeCredentialsPerPool</a> <a id="10357" class="Symbol">:</a> <a id="10359" href="Axiom.Set.Rel.html#1312" class="Function">Rel</a> <a id="10363" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="10371" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
      <a id="10388" href="Ledger.Conway.Specification.Epoch.html#10333" class="Function">stakeCredentialsPerPool</a> <a id="10412" class="Symbol">=</a> <a id="10414" class="Symbol">(</a><a id="10415" href="Ledger.Core.Specification.Certs.html#1861" class="Field">StakeDelegsOf</a> <a id="10429" href="Ledger.Conway.Specification.Epoch.html#10122" class="Bound">ss</a> <a id="10432" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10433" class="Symbol">)</a> <a id="10435" href="Axiom.Set.Rel.html#1608" class="Function Operator">⁻¹ʳ</a>

      <a id="10446" class="Comment">-- delegated stake per pool</a>
      <a id="10480" href="Ledger.Conway.Specification.Epoch.html#10480" class="Function">sd</a> <a id="10483" class="Symbol">:</a> <a id="10485" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="10493" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="10495" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="10506" href="Ledger.Conway.Specification.Epoch.html#10480" class="Function">sd</a> <a id="10509" class="Symbol">=</a> <a id="10511" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="10522" class="Symbol">((</a><a id="10524" href="Ledger.Conway.Specification.Epoch.html#10333" class="Function">stakeCredentialsPerPool</a> <a id="10548" href="abstract-set-theory.FiniteSetTheory.html#3111" class="Function Operator">∘ʳ</a> <a id="10551" class="Symbol">(</a><a id="10552" href="Ledger.Core.Specification.Certs.html#1777" class="Field">StakeOf</a> <a id="10560" href="Ledger.Conway.Specification.Epoch.html#10122" class="Bound">ss</a> <a id="10563" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="10564" class="Symbol">))</a> <a id="10567" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="10569" class="Symbol">)</a>


  <a id="stakeFromGADeposits"></a><a id="10575" href="Ledger.Conway.Specification.Epoch.html#10575" class="Function">stakeFromGADeposits</a>
    <a id="10599" class="Symbol">:</a> <a id="10601" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
    <a id="10614" class="Symbol">→</a> <a id="10616" href="Ledger.Conway.Specification.Utxo.html#1300" class="Record">UTxOState</a>
    <a id="10630" class="Symbol">→</a> <a id="10632" href="Ledger.Core.Specification.Certs.html#1290" class="Function">Stake</a>
  <a id="10640" href="Ledger.Conway.Specification.Epoch.html#10575" class="Function">stakeFromGADeposits</a> <a id="10660" href="Ledger.Conway.Specification.Epoch.html#10660" class="Bound">govSt</a> <a id="10666" href="Ledger.Conway.Specification.Epoch.html#10666" class="Bound">utxoSt</a> <a id="10673" class="Symbol">=</a> <a id="10675" href="abstract-set-theory.FiniteSetTheory.html#4855" class="Function">aggregateBy</a>
     <a id="10692" class="Symbol">(</a><a id="10693" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10698" class="Symbol">(λ</a> <a id="10701" class="Symbol">(</a><a id="10702" href="Ledger.Conway.Specification.Epoch.html#10702" class="Bound">gaid</a> <a id="10707" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10709" href="Ledger.Conway.Specification.Epoch.html#10709" class="Bound">addr</a><a id="10713" class="Symbol">)</a> <a id="10715" class="Symbol">→</a> <a id="10717" class="Symbol">(</a><a id="10718" href="Ledger.Conway.Specification.Epoch.html#10702" class="Bound">gaid</a> <a id="10723" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10725" href="Ledger.Conway.Specification.Epoch.html#10709" class="Bound">addr</a><a id="10729" class="Symbol">)</a> <a id="10731" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10733" href="Ledger.Core.Specification.Address.html#1373" class="Field">stake</a> <a id="10739" href="Ledger.Conway.Specification.Epoch.html#10709" class="Bound">addr</a><a id="10743" class="Symbol">)</a> <a id="10745" href="Ledger.Conway.Specification.Epoch.html#10892" class="Function">govSt&#39;</a><a id="10751" class="Symbol">)</a>
     <a id="10758" class="Symbol">(</a><a id="10759" href="Axiom.Set.Map.html#13318" class="Function">mapFromPartialFun</a> <a id="10777" class="Symbol">(λ</a> <a id="10780" class="Symbol">(</a><a id="10781" href="Ledger.Conway.Specification.Epoch.html#10781" class="Bound">gaid</a> <a id="10786" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10788" class="Symbol">_)</a> <a id="10791" class="Symbol">→</a> <a id="10793" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="10802" href="Ledger.Conway.Specification.Utxo.html#1408" class="Field">deposits</a> <a id="10811" class="Symbol">(</a><a id="10812" href="Ledger.Core.Specification.Certs.html#723" class="InductiveConstructor">GovActionDeposit</a> <a id="10829" href="Ledger.Conway.Specification.Epoch.html#10781" class="Bound">gaid</a><a id="10833" class="Symbol">))</a> <a id="10836" href="Ledger.Conway.Specification.Epoch.html#10892" class="Function">govSt&#39;</a><a id="10842" class="Symbol">)</a>
     <a id="10849" class="Keyword">where</a>
       <a id="10862" class="Keyword">open</a> <a id="10867" href="Ledger.Conway.Specification.Utxo.html#1300" class="Module">UTxOState</a> <a id="10877" href="Ledger.Conway.Specification.Epoch.html#10666" class="Bound">utxoSt</a>

       <a id="10892" href="Ledger.Conway.Specification.Epoch.html#10892" class="Function">govSt&#39;</a> <a id="10899" class="Symbol">:</a> <a id="10901" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="10903" class="Symbol">(</a><a id="10904" href="Ledger.Core.Specification.Gov.Actions.html#1976" class="Function">GovActionID</a> <a id="10916" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="10918" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a><a id="10931" class="Symbol">)</a>
       <a id="10940" href="Ledger.Conway.Specification.Epoch.html#10892" class="Function">govSt&#39;</a> <a id="10947" class="Symbol">=</a> <a id="10949" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="10954" class="Symbol">(</a><a id="10955" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="10960" href="Ledger.Core.Specification.Gov.Actions.html#3885" class="Field">returnAddr</a><a id="10970" class="Symbol">)</a> <a id="10972" class="Symbol">(</a><a id="10973" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="10982" href="Ledger.Conway.Specification.Epoch.html#10660" class="Bound">govSt</a><a id="10987" class="Symbol">)</a>


<a id="10991" class="Keyword">module</a> <a id="VDelegDelegatedStake"></a><a id="10998" href="Ledger.Conway.Specification.Epoch.html#10998" class="Module">VDelegDelegatedStake</a>
  <a id="11021" class="Symbol">(</a><a id="11022" href="Ledger.Conway.Specification.Epoch.html#11022" class="Bound">currentEpoch</a> <a id="11035" class="Symbol">:</a> <a id="11037" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a><a id="11042" class="Symbol">)</a>
  <a id="11046" class="Symbol">(</a><a id="11047" href="Ledger.Conway.Specification.Epoch.html#11047" class="Bound">utxoSt</a>       <a id="11060" class="Symbol">:</a> <a id="11062" href="Ledger.Conway.Specification.Utxo.html#1300" class="Record">UTxOState</a><a id="11071" class="Symbol">)</a>
  <a id="11075" class="Symbol">(</a><a id="11076" href="Ledger.Conway.Specification.Epoch.html#11076" class="Bound">govSt</a>        <a id="11089" class="Symbol">:</a> <a id="11091" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a><a id="11099" class="Symbol">)</a>
  <a id="11103" class="Symbol">(</a><a id="11104" href="Ledger.Conway.Specification.Epoch.html#11104" class="Bound">gState</a>       <a id="11117" class="Symbol">:</a> <a id="11119" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a><a id="11125" class="Symbol">)</a>
  <a id="11129" class="Symbol">(</a><a id="11130" href="Ledger.Conway.Specification.Epoch.html#11130" class="Bound">dState</a>       <a id="11143" class="Symbol">:</a> <a id="11145" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a><a id="11151" class="Symbol">)</a>
  <a id="11155" class="Keyword">where</a>

  <a id="VDelegDelegatedStake.activeDReps"></a><a id="11164" href="Ledger.Conway.Specification.Epoch.html#11164" class="Function">activeDReps</a> <a id="11176" class="Symbol">:</a> <a id="11178" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="11180" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a>
  <a id="11193" href="Ledger.Conway.Specification.Epoch.html#11164" class="Function">activeDReps</a> <a id="11205" class="Symbol">=</a> <a id="11207" href="Class.IsSet.html#916" class="Function">dom</a> <a id="11211" class="Symbol">(</a><a id="11212" href="Ledger.Core.Specification.Gov.Actions.html#7240" class="Function">activeDRepsOf</a> <a id="11226" href="Ledger.Conway.Specification.Epoch.html#11104" class="Bound">gState</a> <a id="11233" href="Ledger.Conway.Specification.Epoch.html#11022" class="Bound">currentEpoch</a><a id="11245" class="Symbol">)</a>

  <a id="VDelegDelegatedStake.activeVDelegs"></a><a id="11250" href="Ledger.Conway.Specification.Epoch.html#11250" class="Function">activeVDelegs</a> <a id="11264" class="Symbol">:</a> <a id="11266" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="11268" href="Ledger.Core.Specification.Gov.Actions.html#2566" class="Datatype">VDeleg</a>
  <a id="11277" href="Ledger.Conway.Specification.Epoch.html#11250" class="Function">activeVDelegs</a> <a id="11291" class="Symbol">=</a> <a id="11293" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="11298" href="Ledger.Core.Specification.Gov.Actions.html#2588" class="InductiveConstructor">vDelegCredential</a> <a id="11315" href="Ledger.Conway.Specification.Epoch.html#11164" class="Function">activeDReps</a> <a id="11327" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="11329" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="11331" href="Ledger.Core.Specification.Gov.Actions.html#2661" class="InductiveConstructor">vDelegNoConfidence</a> <a id="11350" href="Class.HasSingleton.html#288" class="Field Operator">❵</a> <a id="11352" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="11354" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="11356" href="Ledger.Core.Specification.Gov.Actions.html#2631" class="InductiveConstructor">vDelegAbstain</a> <a id="11370" href="Class.HasSingleton.html#288" class="Field Operator">❵</a>

  <a id="11375" class="Comment">-- compute the stake for a credential</a>
  <a id="VDelegDelegatedStake.stakePerCredential"></a><a id="11415" href="Ledger.Conway.Specification.Epoch.html#11415" class="Function">stakePerCredential</a> <a id="11434" class="Symbol">:</a> <a id="11436" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="11447" class="Symbol">→</a> <a id="11449" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11456" href="Ledger.Conway.Specification.Epoch.html#11415" class="Function">stakePerCredential</a> <a id="11475" href="Ledger.Conway.Specification.Epoch.html#11475" class="Bound">c</a> <a id="11477" class="Symbol">=</a> <a id="11479" href="Ledger.Conway.Specification.Utxo.html#2526" class="Function">cbalance</a> <a id="11488" class="Symbol">((</a><a id="11490" href="Ledger.Conway.Specification.Transaction.html#2925" class="Field">UTxOOf</a> <a id="11497" href="Ledger.Conway.Specification.Epoch.html#11047" class="Bound">utxoSt</a><a id="11503" class="Symbol">)</a> <a id="11505" href="abstract-set-theory.FiniteSetTheory.html#4295" class="Function Operator">∣^&#39;</a> <a id="11509" class="Symbol">λ</a> <a id="11511" href="Ledger.Conway.Specification.Epoch.html#11511" class="Bound">txout</a> <a id="11517" class="Symbol">→</a> <a id="11519" href="Ledger.Conway.Specification.Epoch.html#5592" class="Function">getStakeCred</a> <a id="11532" href="Ledger.Conway.Specification.Epoch.html#11511" class="Bound">txout</a> <a id="11538" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="11540" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="11545" href="Ledger.Conway.Specification.Epoch.html#11475" class="Bound">c</a><a id="11546" class="Symbol">)</a>
                         <a id="11573" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="11575" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="11585" class="Number">0</a> <a id="11587" class="Symbol">(</a><a id="11588" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="11597" class="Symbol">(</a><a id="11598" href="Ledger.Conway.Specification.Epoch.html#10575" class="Function">stakeFromGADeposits</a> <a id="11618" href="Ledger.Conway.Specification.Epoch.html#11076" class="Bound">govSt</a> <a id="11624" href="Ledger.Conway.Specification.Epoch.html#11047" class="Bound">utxoSt</a><a id="11630" class="Symbol">)</a> <a id="11632" href="Ledger.Conway.Specification.Epoch.html#11475" class="Bound">c</a><a id="11633" class="Symbol">)</a>
                         <a id="11660" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="11662" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="11672" class="Number">0</a> <a id="11674" class="Symbol">(</a><a id="11675" href="Axiom.Set.Map.html#17169" class="Function">lookupᵐ?</a> <a id="11684" class="Symbol">(</a><a id="11685" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="11695" href="Ledger.Conway.Specification.Epoch.html#11130" class="Bound">dState</a><a id="11701" class="Symbol">)</a> <a id="11703" href="Ledger.Conway.Specification.Epoch.html#11475" class="Bound">c</a><a id="11704" class="Symbol">)</a>

  <a id="VDelegDelegatedStake.calculate"></a><a id="11709" href="Ledger.Conway.Specification.Epoch.html#11709" class="Function">calculate</a> <a id="11719" class="Symbol">:</a> <a id="11721" href="Ledger.Core.Specification.Gov.Actions.html#2566" class="Datatype">VDeleg</a> <a id="11728" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11730" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="11737" href="Ledger.Conway.Specification.Epoch.html#11709" class="Function">calculate</a> <a id="11747" class="Symbol">=</a> <a id="11749" href="Axiom.Set.Map.html#10462" class="Function">mapFromFun</a> <a id="11760" class="Symbol">(λ</a> <a id="11763" href="Ledger.Conway.Specification.Epoch.html#11763" class="Bound">vd</a> <a id="11766" class="Symbol">→</a> <a id="11768" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">∑ˢ[</a> <a id="11772" href="Ledger.Conway.Specification.Epoch.html#11772" class="Bound">c</a> <a id="11774" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">←</a> <a id="11776" class="Symbol">(</a><a id="11777" href="Ledger.Core.Specification.Gov.Actions.html#2806" class="Field">VoteDelegsOf</a> <a id="11790" href="Ledger.Conway.Specification.Epoch.html#11130" class="Bound">dState</a><a id="11796" class="Symbol">)</a> <a id="11798" href="Axiom.Set.Map.html#17957" class="Function Operator">⁻¹</a> <a id="11801" href="Ledger.Conway.Specification.Epoch.html#11763" class="Bound">vd</a> <a id="11804" href="abstract-set-theory.FiniteSetTheory.html#4509" class="Function">]</a> <a id="11806" class="Symbol">(</a><a id="11807" href="Ledger.Conway.Specification.Epoch.html#11415" class="Function">stakePerCredential</a> <a id="11826" href="Ledger.Conway.Specification.Epoch.html#11772" class="Bound">c</a><a id="11827" class="Symbol">))</a>
                         <a id="11855" href="Ledger.Conway.Specification.Epoch.html#11250" class="Function">activeVDelegs</a>


<a id="11871" class="Keyword">opaque</a>


  <a id="calculateVDelegDelegatedStake"></a><a id="11882" href="Ledger.Conway.Specification.Epoch.html#11882" class="Function">calculateVDelegDelegatedStake</a>
    <a id="11916" class="Symbol">:</a> <a id="11918" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
    <a id="11928" class="Symbol">→</a> <a id="11930" href="Ledger.Conway.Specification.Utxo.html#1300" class="Record">UTxOState</a>
    <a id="11944" class="Symbol">→</a> <a id="11946" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
    <a id="11959" class="Symbol">→</a> <a id="11961" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a>
    <a id="11972" class="Symbol">→</a> <a id="11974" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
    <a id="11985" class="Symbol">→</a> <a id="11987" href="Ledger.Core.Specification.Gov.Actions.html#2566" class="Datatype">VDeleg</a> <a id="11994" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="11996" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="12003" href="Ledger.Conway.Specification.Epoch.html#11882" class="Function">calculateVDelegDelegatedStake</a> <a id="12033" class="Symbol">=</a> <a id="12035" href="Ledger.Conway.Specification.Epoch.html#11709" class="Function">VDelegDelegatedStake.calculate</a>


<a id="12068" class="Keyword">opaque</a>


  <a id="calculatePoolDelegatedStakeForVoting"></a><a id="12079" href="Ledger.Conway.Specification.Epoch.html#12079" class="Function">calculatePoolDelegatedStakeForVoting</a>
    <a id="12120" class="Symbol">:</a> <a id="12122" href="Ledger.Conway.Specification.Rewards.html#6489" class="Record">Snapshot</a>
    <a id="12135" class="Symbol">→</a> <a id="12137" href="Ledger.Conway.Specification.Utxo.html#1300" class="Record">UTxOState</a>
    <a id="12151" class="Symbol">→</a> <a id="12153" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
    <a id="12166" class="Symbol">→</a> <a id="12168" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="12176" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12178" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="12185" href="Ledger.Conway.Specification.Epoch.html#12079" class="Function">calculatePoolDelegatedStakeForVoting</a> <a id="12222" href="Ledger.Conway.Specification.Epoch.html#12222" class="Bound">ss</a> <a id="12225" href="Ledger.Conway.Specification.Epoch.html#12225" class="Bound">utxoSt</a> <a id="12232" href="Ledger.Conway.Specification.Epoch.html#12232" class="Bound">govSt</a>
    <a id="12242" class="Symbol">=</a> <a id="12244" href="Ledger.Conway.Specification.Epoch.html#10024" class="Function">calculatePoolDelegatedStake</a> <a id="12272" href="Ledger.Conway.Specification.Epoch.html#12222" class="Bound">ss</a> <a id="12275" href="Axiom.Set.Map.Dec.html#2149" class="Function Operator">∪⁺</a> <a id="12278" class="Symbol">(</a><a id="12279" href="Ledger.Conway.Specification.Epoch.html#12333" class="Function">stakeFromDeposits</a> <a id="12297" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="12299" href="Class.IsSet.html#916" class="Function">dom</a> <a id="12303" class="Symbol">(</a><a id="12304" href="Ledger.Core.Specification.Certs.html#1531" class="Field">PoolsOf</a> <a id="12312" href="Ledger.Conway.Specification.Epoch.html#12222" class="Bound">ss</a><a id="12314" class="Symbol">))</a>
    <a id="12321" class="Keyword">where</a>
      <a id="12333" href="Ledger.Conway.Specification.Epoch.html#12333" class="Function">stakeFromDeposits</a> <a id="12351" class="Symbol">:</a> <a id="12353" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="12361" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="12363" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
      <a id="12374" href="Ledger.Conway.Specification.Epoch.html#12333" class="Function">stakeFromDeposits</a> <a id="12392" class="Symbol">=</a> <a id="12394" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="12405" class="Symbol">(((</a><a id="12408" href="Ledger.Core.Specification.Certs.html#1861" class="Field">StakeDelegsOf</a> <a id="12422" href="Ledger.Conway.Specification.Epoch.html#12222" class="Bound">ss</a> <a id="12425" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="12426" class="Symbol">)</a> <a id="12428" href="Axiom.Set.Rel.html#1608" class="Function Operator">⁻¹ʳ</a>
                                      <a id="12470" href="abstract-set-theory.FiniteSetTheory.html#3111" class="Function Operator">∘ʳ</a> <a id="12473" class="Symbol">(</a><a id="12474" href="Ledger.Conway.Specification.Epoch.html#10575" class="Function">stakeFromGADeposits</a> <a id="12494" href="Ledger.Conway.Specification.Epoch.html#12232" class="Bound">govSt</a> <a id="12500" href="Ledger.Conway.Specification.Epoch.html#12225" class="Bound">utxoSt</a> <a id="12507" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="12508" class="Symbol">))</a> <a id="12511" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="12513" class="Symbol">)</a>


<a id="mkStakeDistrs"></a><a id="12517" href="Ledger.Conway.Specification.Epoch.html#12517" class="Function">mkStakeDistrs</a>
  <a id="12533" class="Symbol">:</a> <a id="12535" href="Ledger.Conway.Specification.Rewards.html#6489" class="Record">Snapshot</a>
  <a id="12546" class="Symbol">→</a> <a id="12548" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
  <a id="12556" class="Symbol">→</a> <a id="12558" href="Ledger.Conway.Specification.Utxo.html#1300" class="Record">UTxOState</a>
  <a id="12570" class="Symbol">→</a> <a id="12572" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
  <a id="12583" class="Symbol">→</a> <a id="12585" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a>
  <a id="12594" class="Symbol">→</a> <a id="12596" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
  <a id="12605" class="Symbol">→</a> <a id="12607" href="Ledger.Conway.Specification.Ratify.html#3118" class="Record">StakeDistrs</a>
<a id="12619" href="Ledger.Conway.Specification.Epoch.html#12517" class="Function">mkStakeDistrs</a> <a id="12633" href="Ledger.Conway.Specification.Epoch.html#12633" class="Bound">ss</a> <a id="12636" href="Ledger.Conway.Specification.Epoch.html#12636" class="Bound">currentEpoch</a> <a id="12649" href="Ledger.Conway.Specification.Epoch.html#12649" class="Bound">utxoSt</a> <a id="12656" href="Ledger.Conway.Specification.Epoch.html#12656" class="Bound">govSt</a> <a id="12662" href="Ledger.Conway.Specification.Epoch.html#12662" class="Bound">gState</a> <a id="12669" href="Ledger.Conway.Specification.Epoch.html#12669" class="Bound">dState</a> <a id="12676" class="Symbol">=</a>
  <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#11882}{\htmlId{12682}{\htmlClass{Function}{\text{calculateVDelegDelegatedStake}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12636}{\htmlId{12712}{\htmlClass{Bound}{\text{currentEpoch}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12649}{\htmlId{12725}{\htmlClass{Bound}{\text{utxoSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12656}{\htmlId{12732}{\htmlClass{Bound}{\text{govSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12662}{\htmlId{12738}{\htmlClass{Bound}{\text{gState}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12669}{\htmlId{12745}{\htmlClass{Bound}{\text{dState}}}}\,
  \\ \,\href{Ledger.Conway.Specification.Epoch.html#12079}{\htmlId{12756}{\htmlClass{Function}{\text{calculatePoolDelegatedStakeForVoting}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12633}{\htmlId{12793}{\htmlClass{Bound}{\text{ss}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12649}{\htmlId{12796}{\htmlClass{Bound}{\text{utxoSt}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12656}{\htmlId{12803}{\htmlClass{Bound}{\text{govSt}}}}\, \end{pmatrix}$</a>


<a id="12813" class="Keyword">private</a> <a id="12821" class="Keyword">variable</a>
  <a id="12832" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="12834" href="Ledger.Conway.Specification.Epoch.html#12834" class="Generalizable">lastEpoch</a> <a id="12844" class="Symbol">:</a> <a id="12846" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
  <a id="12854" href="Ledger.Conway.Specification.Epoch.html#12854" class="Generalizable">fut</a> <a id="12858" href="Ledger.Conway.Specification.Epoch.html#12858" class="Generalizable">fut&#39;</a> <a id="12863" class="Symbol">:</a> <a id="12865" href="Ledger.Conway.Specification.Ratify.html#3529" class="Record">RatifyState</a>
  <a id="12879" href="Ledger.Conway.Specification.Epoch.html#12879" class="Generalizable">poolReapState</a> <a id="12893" class="Symbol">:</a> <a id="12895" href="Ledger.Conway.Specification.PoolReap.html#402" class="Record">PoolReapState</a>
  <a id="12911" href="Ledger.Conway.Specification.Epoch.html#12911" class="Generalizable">eps</a> <a id="12915" href="Ledger.Conway.Specification.Epoch.html#12915" class="Generalizable">eps&#39;</a> <a id="12920" href="Ledger.Conway.Specification.Epoch.html#12920" class="Generalizable">eps&#39;&#39;</a> <a id="12926" class="Symbol">:</a> <a id="12928" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>
  <a id="12941" href="Ledger.Conway.Specification.Epoch.html#12941" class="Generalizable">ls</a> <a id="12944" class="Symbol">:</a> <a id="12946" href="Ledger.Conway.Specification.Ledger.html#991" class="Record">LState</a>
  <a id="12955" href="Ledger.Conway.Specification.Epoch.html#12955" class="Generalizable">es₀</a> <a id="12959" class="Symbol">:</a> <a id="12961" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
  <a id="12974" href="Ledger.Conway.Specification.Epoch.html#12974" class="Generalizable">mark</a> <a id="12979" href="Ledger.Conway.Specification.Epoch.html#12979" class="Generalizable">set</a> <a id="12983" href="Ledger.Conway.Specification.Epoch.html#12983" class="Generalizable">go</a> <a id="12986" class="Symbol">:</a> <a id="12988" href="Ledger.Conway.Specification.Rewards.html#6489" class="Record">Snapshot</a>
  <a id="12999" href="Ledger.Conway.Specification.Epoch.html#12999" class="Generalizable">feeSS</a> <a id="13005" class="Symbol">:</a> <a id="13007" href="Ledger.Prelude.Base.html#186" class="Function">Fees</a>
  <a id="13014" href="Ledger.Conway.Specification.Epoch.html#13014" class="Generalizable">lstate</a> <a id="13021" class="Symbol">:</a> <a id="13023" href="Ledger.Conway.Specification.Ledger.html#991" class="Record">LState</a>
  <a id="13032" href="Ledger.Conway.Specification.Epoch.html#13032" class="Generalizable">pState&#39;&#39;</a> <a id="13041" class="Symbol">:</a> <a id="13043" href="Ledger.Core.Specification.Certs.html#3872" class="Record">PState</a>
  <a id="13052" href="Ledger.Conway.Specification.Epoch.html#13052" class="Generalizable">dState&#39;</a> <a id="13060" class="Symbol">:</a> <a id="13062" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
  <a id="13071" href="Ledger.Conway.Specification.Epoch.html#13071" class="Generalizable">acnt</a> <a id="13076" href="Ledger.Conway.Specification.Epoch.html#13076" class="Generalizable">acnt&#39;</a> <a id="13082" class="Symbol">:</a> <a id="13084" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>
  <a id="13091" href="Ledger.Conway.Specification.Epoch.html#13091" class="Generalizable">utxoSt&#39;&#39;</a> <a id="13100" class="Symbol">:</a> <a id="13102" href="Ledger.Conway.Specification.Utxo.html#1300" class="Record">UTxOState</a>
  <a id="13114" href="Ledger.Conway.Specification.Epoch.html#13114" class="Generalizable">ss</a> <a id="13117" href="Ledger.Conway.Specification.Epoch.html#13117" class="Generalizable">ss&#39;</a> <a id="13121" class="Symbol">:</a> <a id="13123" href="Ledger.Conway.Specification.Rewards.html#7736" class="Record">Snapshots</a>
  <a id="13135" href="Ledger.Conway.Specification.Epoch.html#13135" class="Generalizable">ru</a> <a id="13138" class="Symbol">:</a> <a id="13140" href="Ledger.Conway.Specification.Rewards.html#6266" class="Record">RewardUpdate</a>
  <a id="13155" href="Ledger.Conway.Specification.Epoch.html#13155" class="Generalizable">mru</a> <a id="13159" class="Symbol">:</a> <a id="13161" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="13167" href="Ledger.Conway.Specification.Rewards.html#6266" class="Record">RewardUpdate</a>
  <a id="13182" href="Ledger.Conway.Specification.Epoch.html#13182" class="Generalizable">pd</a> <a id="13185" class="Symbol">:</a> <a id="13187" href="Ledger.Conway.Specification.Epoch.html#3516" class="Function">PoolDelegatedStake</a>


<a id="getOrphans"></a><a id="13208" href="Ledger.Conway.Specification.Epoch.html#13208" class="Function">getOrphans</a> <a id="13219" class="Symbol">:</a> <a id="13221" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a> <a id="13232" class="Symbol">→</a> <a id="13234" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a> <a id="13243" class="Symbol">→</a> <a id="13245" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
<a id="13254" href="Ledger.Conway.Specification.Epoch.html#13208" class="Function">getOrphans</a> <a id="13265" href="Ledger.Conway.Specification.Epoch.html#13265" class="Bound">es</a> <a id="13268" href="Ledger.Conway.Specification.Epoch.html#13268" class="Bound">govSt</a> <a id="13274" class="Symbol">=</a> <a id="13276" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="13282" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="13284" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a> <a id="13292" href="Ledger.Conway.Specification.Epoch.html#13337" class="Function">step</a> <a id="13297" class="Symbol">(</a><a id="13298" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="13301" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13303" href="Ledger.Conway.Specification.Epoch.html#13268" class="Bound">govSt</a><a id="13308" class="Symbol">)</a> <a id="13310" class="Symbol">(</a><a id="13311" href="Data.List.Base.html#4746" class="Function">length</a> <a id="13318" href="Ledger.Conway.Specification.Epoch.html#13268" class="Bound">govSt</a><a id="13323" class="Symbol">)</a>
  <a id="13327" class="Keyword">where</a>
    <a id="13337" href="Ledger.Conway.Specification.Epoch.html#13337" class="Function">step</a> <a id="13342" class="Symbol">:</a> <a id="13344" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a> <a id="13353" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13355" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a> <a id="13364" class="Symbol">→</a> <a id="13366" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a> <a id="13375" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13377" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
    <a id="13390" href="Ledger.Conway.Specification.Epoch.html#13337" class="Function">step</a> <a id="13395" class="Symbol">(</a><a id="13396" href="Ledger.Conway.Specification.Epoch.html#13396" class="Bound">orps</a> <a id="13401" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13403" href="Ledger.Conway.Specification.Epoch.html#13403" class="Bound">govSt</a><a id="13408" class="Symbol">)</a> <a id="13410" class="Symbol">=</a>
      <a id="13418" class="Keyword">let</a>
        <a id="13430" href="Ledger.Conway.Specification.Epoch.html#13430" class="Bound">isOrphan?</a> <a id="13440" href="Ledger.Conway.Specification.Epoch.html#13440" class="Bound">a</a> <a id="13442" href="Ledger.Conway.Specification.Epoch.html#13442" class="Bound">prev</a> <a id="13447" class="Symbol">=</a> <a id="13449" href="Relation.Nullary.Decidable.Core.html#3277" class="Function">¬?</a> <a id="13452" class="Symbol">(</a><a id="13453" href="Ledger.Conway.Specification.Gov.html#9845" class="Function">hasParent?</a> <a id="13464" href="Ledger.Conway.Specification.Epoch.html#13265" class="Bound">es</a> <a id="13467" href="Ledger.Conway.Specification.Epoch.html#13403" class="Bound">govSt</a> <a id="13473" href="Ledger.Conway.Specification.Epoch.html#13440" class="Bound">a</a> <a id="13475" href="Ledger.Conway.Specification.Epoch.html#13442" class="Bound">prev</a><a id="13479" class="Symbol">)</a>
        <a id="13489" class="Symbol">(</a><a id="13490" href="Ledger.Conway.Specification.Epoch.html#13490" class="Bound">orps&#39;</a> <a id="13496" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13498" href="Ledger.Conway.Specification.Epoch.html#13498" class="Bound">govSt&#39;</a><a id="13504" class="Symbol">)</a> <a id="13506" class="Symbol">=</a> <a id="13508" href="Data.List.Base.html#10628" class="Function">partition</a>
          <a id="13528" class="Symbol">(λ</a> <a id="13531" class="Symbol">(_</a> <a id="13534" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13536" class="Keyword">record</a> <a id="13543" class="Symbol">{</a><a id="13544" href="Ledger.Core.Specification.Gov.Actions.html#3941" class="Field">action</a> <a id="13551" class="Symbol">=</a> <a id="13553" href="Ledger.Conway.Specification.Epoch.html#13553" class="Bound">a</a> <a id="13555" class="Symbol">;</a> <a id="13557" href="Ledger.Core.Specification.Gov.Actions.html#3969" class="Field">prevAction</a> <a id="13568" class="Symbol">=</a> <a id="13570" href="Ledger.Conway.Specification.Epoch.html#13570" class="Bound">prev</a><a id="13574" class="Symbol">})</a> <a id="13577" class="Symbol">→</a> <a id="13579" href="Ledger.Conway.Specification.Epoch.html#13430" class="Bound">isOrphan?</a> <a id="13589" class="Symbol">(</a><a id="13590" href="Ledger.Conway.Specification.Epoch.html#13553" class="Bound">a</a> <a id="13592" class="Symbol">.</a><a id="13593" href="Ledger.Core.Specification.Gov.Actions.html#1511" class="Field">gaType</a><a id="13599" class="Symbol">)</a> <a id="13601" href="Ledger.Conway.Specification.Epoch.html#13570" class="Bound">prev</a><a id="13605" class="Symbol">)</a>
          <a id="13617" href="Ledger.Conway.Specification.Epoch.html#13403" class="Bound">govSt</a>
      <a id="13629" class="Keyword">in</a>
        <a id="13640" class="Symbol">(</a><a id="13641" href="Ledger.Conway.Specification.Epoch.html#13396" class="Bound">orps</a> <a id="13646" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="13649" href="Ledger.Conway.Specification.Epoch.html#13490" class="Bound">orps&#39;</a> <a id="13655" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="13657" href="Ledger.Conway.Specification.Epoch.html#13498" class="Bound">govSt&#39;</a><a id="13663" class="Symbol">)</a>

<a id="13666" class="Keyword">record</a> <a id="Governance-Update"></a><a id="13673" href="Ledger.Conway.Specification.Epoch.html#13673" class="Record">Governance-Update</a> <a id="13691" class="Symbol">:</a> <a id="13693" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="13698" class="Keyword">where</a>
  <a id="13706" class="Keyword">constructor</a> <a id="GovernanceUpdate"></a><a id="13718" href="Ledger.Conway.Specification.Epoch.html#13718" class="InductiveConstructor">GovernanceUpdate</a>
  <a id="13737" class="Keyword">field</a>
    <a id="Governance-Update.removedGovActions"></a><a id="13747" href="Ledger.Conway.Specification.Epoch.html#13747" class="Field">removedGovActions</a> <a id="13765" class="Symbol">:</a> <a id="13767" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="13769" class="Symbol">(</a><a id="13770" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="13784" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13786" href="Ledger.Core.Specification.Certs.html#534" class="Datatype">DepositPurpose</a> <a id="13801" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="13803" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a><a id="13807" class="Symbol">)</a>
    <a id="Governance-Update.govSt&#39;"></a><a id="13813" href="Ledger.Conway.Specification.Epoch.html#13813" class="Field">govSt&#39;</a>            <a id="13831" class="Symbol">:</a> <a id="13833" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>

<a id="13843" class="Keyword">module</a> <a id="GovernanceUpdate"></a><a id="13850" href="Ledger.Conway.Specification.Epoch.html#13850" class="Module">GovernanceUpdate</a> <a id="13867" class="Symbol">(</a><a id="13868" href="Ledger.Conway.Specification.Epoch.html#13868" class="Bound">ls</a> <a id="13871" class="Symbol">:</a> <a id="13873" href="Ledger.Conway.Specification.Ledger.html#991" class="Record">LState</a><a id="13879" class="Symbol">)</a>
                        <a id="13905" class="Symbol">(</a><a id="13906" href="Ledger.Conway.Specification.Epoch.html#13906" class="Bound">fut</a> <a id="13910" class="Symbol">:</a> <a id="13912" href="Ledger.Conway.Specification.Ratify.html#3529" class="Record">RatifyState</a><a id="13923" class="Symbol">)</a>
                        <a id="13949" class="Keyword">where</a>


  <a id="13959" class="Keyword">open</a> <a id="13964" href="Ledger.Conway.Specification.Ledger.html#991" class="Module">LState</a> <a id="13971" href="Ledger.Conway.Specification.Epoch.html#13868" class="Bound">ls</a>
  <a id="13976" class="Keyword">open</a> <a id="13981" href="Ledger.Conway.Specification.Ratify.html#3529" class="Module">RatifyState</a> <a id="13993" href="Ledger.Conway.Specification.Epoch.html#13906" class="Bound">fut</a>


  <a id="GovernanceUpdate.tmpGovSt"></a><a id="14001" href="Ledger.Conway.Specification.Epoch.html#14001" class="Function">tmpGovSt</a> <a id="14010" class="Symbol">:</a> <a id="14012" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
  <a id="14023" href="Ledger.Conway.Specification.Epoch.html#14001" class="Function">tmpGovSt</a> <a id="14032" class="Symbol">=</a> <a id="14034" href="Ledger.Prelude.html#2451" class="Function">filter</a> <a id="14041" class="Symbol">(λ</a> <a id="14044" href="Ledger.Conway.Specification.Epoch.html#14044" class="Bound">x</a> <a id="14046" class="Symbol">→</a> <a id="14048" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14054" href="Ledger.Conway.Specification.Epoch.html#14044" class="Bound">x</a> <a id="14056" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="14058" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14063" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14069" href="Ledger.Conway.Specification.Ratify.html#3592" class="Field">removed</a><a id="14076" class="Symbol">)</a> <a id="14078" href="Ledger.Conway.Specification.Ledger.html#1077" class="Function">govSt</a>

  <a id="GovernanceUpdate.orphans"></a><a id="14087" href="Ledger.Conway.Specification.Epoch.html#14087" class="Function">orphans</a> <a id="14095" class="Symbol">:</a> <a id="14097" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14099" class="Symbol">(</a><a id="14100" href="Ledger.Core.Specification.Gov.Actions.html#1976" class="Function">GovActionID</a> <a id="14112" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14114" href="Ledger.Core.Specification.Gov.Actions.html#3818" class="Record">GovActionState</a><a id="14128" class="Symbol">)</a>
  <a id="14132" href="Ledger.Conway.Specification.Epoch.html#14087" class="Function">orphans</a>  <a id="14141" class="Symbol">=</a> <a id="14143" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="14152" class="Symbol">(</a><a id="14153" href="Ledger.Conway.Specification.Epoch.html#13208" class="Function">getOrphans</a> <a id="14164" href="Ledger.Conway.Specification.Ratify.html#3566" class="Field">es</a> <a id="14167" href="Ledger.Conway.Specification.Epoch.html#14001" class="Function">tmpGovSt</a><a id="14175" class="Symbol">)</a>

  <a id="GovernanceUpdate.removed&#39;"></a><a id="14180" href="Ledger.Conway.Specification.Epoch.html#14180" class="Function">removed&#39;</a> <a id="14189" class="Symbol">:</a> <a id="14191" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14193" class="Symbol">(</a><a id="14194" href="Ledger.Core.Specification.Gov.Actions.html#1976" class="Function">GovActionID</a> <a id="14206" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14208" href="Ledger.Core.Specification.Gov.Actions.html#3818" class="Record">GovActionState</a><a id="14222" class="Symbol">)</a>
  <a id="14226" href="Ledger.Conway.Specification.Epoch.html#14180" class="Function">removed&#39;</a> <a id="14235" class="Symbol">=</a> <a id="14237" href="Ledger.Conway.Specification.Ratify.html#3592" class="Field">removed</a> <a id="14245" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="14247" href="Ledger.Conway.Specification.Epoch.html#14087" class="Function">orphans</a>

  <a id="GovernanceUpdate.removedGovActions"></a><a id="14258" href="Ledger.Conway.Specification.Epoch.html#14258" class="Function">removedGovActions</a> <a id="14276" class="Symbol">:</a> <a id="14278" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="14280" class="Symbol">(</a><a id="14281" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="14295" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14297" href="Ledger.Core.Specification.Certs.html#534" class="Datatype">DepositPurpose</a> <a id="14312" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="14314" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a><a id="14318" class="Symbol">)</a>
  <a id="14322" href="Ledger.Conway.Specification.Epoch.html#14258" class="Function">removedGovActions</a> <a id="14340" class="Symbol">=</a>
    <a id="14346" href="Function.Base.html#1657" class="Function">flip</a> <a id="14351" href="Axiom.Set.html#7207" class="Function">concatMapˢ</a> <a id="14362" href="Ledger.Conway.Specification.Epoch.html#14180" class="Function">removed&#39;</a> <a id="14371" class="Symbol">λ</a> <a id="14373" class="Symbol">(</a><a id="14374" href="Ledger.Conway.Specification.Epoch.html#14374" class="Bound">gaid</a> <a id="14379" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="14381" href="Ledger.Conway.Specification.Epoch.html#14381" class="Bound">gaSt</a><a id="14385" class="Symbol">)</a> <a id="14387" class="Symbol">→</a>
      <a id="14395" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
        <a id="14408" class="Symbol">(</a><a id="14409" href="Ledger.Core.Specification.Gov.Actions.html#3885" class="Field">returnAddr</a> <a id="14420" href="Ledger.Conway.Specification.Epoch.html#14381" class="Bound">gaSt</a> <a id="14425" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="14427" class="Symbol">)</a>
        <a id="14437" class="Symbol">((</a><a id="14439" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="14450" href="Ledger.Conway.Specification.Ledger.html#1050" class="Function">utxoSt</a> <a id="14457" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="14459" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="14461" href="Ledger.Core.Specification.Certs.html#723" class="InductiveConstructor">GovActionDeposit</a> <a id="14478" href="Ledger.Conway.Specification.Epoch.html#14374" class="Bound">gaid</a> <a id="14483" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="14484" class="Symbol">)</a> <a id="14486" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="14487" class="Symbol">)</a>

  <a id="GovernanceUpdate.govSt&#39;"></a><a id="14492" href="Ledger.Conway.Specification.Epoch.html#14492" class="Function">govSt&#39;</a> <a id="14499" class="Symbol">:</a> <a id="14501" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
  <a id="14512" href="Ledger.Conway.Specification.Epoch.html#14492" class="Function">govSt&#39;</a> <a id="14519" class="Symbol">=</a> <a id="14521" href="Ledger.Prelude.html#2451" class="Function">filter</a> <a id="14528" class="Symbol">(λ</a> <a id="14531" href="Ledger.Conway.Specification.Epoch.html#14531" class="Bound">x</a> <a id="14533" class="Symbol">→</a> <a id="14535" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14541" href="Ledger.Conway.Specification.Epoch.html#14531" class="Bound">x</a> <a id="14543" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="14545" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="14550" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="14556" href="Ledger.Conway.Specification.Epoch.html#14180" class="Function">removed&#39;</a><a id="14564" class="Symbol">)</a> <a id="14566" href="Ledger.Conway.Specification.Ledger.html#1077" class="Function">govSt</a>

  <a id="GovernanceUpdate.updates"></a><a id="14575" href="Ledger.Conway.Specification.Epoch.html#14575" class="Function">updates</a> <a id="14583" class="Symbol">:</a> <a id="14585" href="Ledger.Conway.Specification.Epoch.html#13673" class="Record">Governance-Update</a>
  <a id="14605" href="Ledger.Conway.Specification.Epoch.html#14575" class="Function">updates</a> <a id="14613" class="Symbol">=</a> <a id="14615" href="Ledger.Conway.Specification.Epoch.html#13718" class="InductiveConstructor">GovernanceUpdate</a> <a id="14632" href="Ledger.Conway.Specification.Epoch.html#14258" class="Function">removedGovActions</a> <a id="14650" href="Ledger.Conway.Specification.Epoch.html#14492" class="Function">govSt&#39;</a>

<a id="14658" class="Keyword">record</a> <a id="Pre-POOLREAP-Update"></a><a id="14665" href="Ledger.Conway.Specification.Epoch.html#14665" class="Record">Pre-POOLREAP-Update</a> <a id="14685" class="Symbol">:</a> <a id="14687" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="14692" class="Keyword">where</a>
  <a id="14700" class="Keyword">inductive</a>
  <a id="14712" class="Keyword">constructor</a> <a id="Pre-POOLREAPUpdate"></a><a id="14724" href="Ledger.Conway.Specification.Epoch.html#14724" class="InductiveConstructor">Pre-POOLREAPUpdate</a>
  <a id="14745" class="Keyword">field</a>
    <a id="Pre-POOLREAP-Update.pState&#39;"></a><a id="14755" href="Ledger.Conway.Specification.Epoch.html#14755" class="Field">pState&#39;</a> <a id="14763" class="Symbol">:</a> <a id="14765" href="Ledger.Core.Specification.Certs.html#3872" class="Record">PState</a>
    <a id="Pre-POOLREAP-Update.gState&#39;"></a><a id="14776" href="Ledger.Conway.Specification.Epoch.html#14776" class="Field">gState&#39;</a> <a id="14784" class="Symbol">:</a> <a id="14786" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a>
    <a id="Pre-POOLREAP-Update.utxoSt&#39;"></a><a id="14797" href="Ledger.Conway.Specification.Epoch.html#14797" class="Field">utxoSt&#39;</a> <a id="14805" class="Symbol">:</a> <a id="14807" href="Ledger.Conway.Specification.Utxo.html#1300" class="Record">UTxOState</a>

<a id="14818" class="Keyword">module</a> <a id="Pre-POOLREAPUpdate"></a><a id="14825" href="Ledger.Conway.Specification.Epoch.html#14825" class="Module">Pre-POOLREAPUpdate</a> <a id="14844" class="Symbol">(</a><a id="14845" href="Ledger.Conway.Specification.Epoch.html#14845" class="Bound">ls</a> <a id="14848" class="Symbol">:</a> <a id="14850" href="Ledger.Conway.Specification.Ledger.html#991" class="Record">LState</a><a id="14856" class="Symbol">)</a>
                          <a id="14884" class="Symbol">(</a><a id="14885" href="Ledger.Conway.Specification.Epoch.html#14885" class="Bound">es</a> <a id="14888" class="Symbol">:</a> <a id="14890" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a><a id="14900" class="Symbol">)</a>
                          <a id="14928" class="Symbol">(</a><a id="14929" href="Ledger.Conway.Specification.Epoch.html#14929" class="Bound">govUpdate</a> <a id="14939" class="Symbol">:</a> <a id="14941" href="Ledger.Conway.Specification.Epoch.html#13673" class="Record">Governance-Update</a><a id="14958" class="Symbol">)</a>
                          <a id="14986" class="Keyword">where</a>


  <a id="14996" class="Keyword">open</a> <a id="15001" href="Ledger.Conway.Specification.Ledger.html#991" class="Module">LState</a> <a id="15008" href="Ledger.Conway.Specification.Epoch.html#14845" class="Bound">ls</a>
  <a id="15013" class="Keyword">open</a> <a id="15018" href="Ledger.Core.Specification.Certs.html#4115" class="Module">CertState</a> <a id="15028" href="Ledger.Conway.Specification.Ledger.html#1103" class="Function">certState</a> <a id="15038" class="Keyword">using</a> <a id="15044" class="Symbol">(</a><a id="15045" href="Ledger.Core.Specification.Certs.html#4198" class="Field">pState</a><a id="15051" class="Symbol">;</a> <a id="15053" href="Ledger.Core.Specification.Certs.html#4218" class="Field">gState</a><a id="15059" class="Symbol">)</a>
  <a id="15063" class="Keyword">open</a> <a id="15068" href="Ledger.Core.Specification.Certs.html#3872" class="Module">PState</a> <a id="15075" href="Ledger.Core.Specification.Certs.html#4198" class="Function">pState</a>
  <a id="15084" class="Keyword">open</a> <a id="15089" href="Ledger.Conway.Specification.Epoch.html#13673" class="Module">Governance-Update</a> <a id="15107" href="Ledger.Conway.Specification.Epoch.html#14929" class="Bound">govUpdate</a>


  <a id="Pre-POOLREAPUpdate.utxoSt&#39;"></a><a id="15121" href="Ledger.Conway.Specification.Epoch.html#15121" class="Function">utxoSt&#39;</a> <a id="15129" class="Symbol">:</a> <a id="15131" href="Ledger.Conway.Specification.Utxo.html#1300" class="Record">UTxOState</a>
  <a id="15143" href="Ledger.Conway.Specification.Epoch.html#15121" class="Function">utxoSt&#39;</a> <a id="15151" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Transaction.html#2925}{\htmlId{15155}{\htmlClass{Field}{\text{UTxOOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1050}{\htmlId{15162}{\htmlClass{Function}{\text{utxoSt}}}}\, \\ \,\href{Ledger.Prelude.Base.html#669}{\htmlId{15171}{\htmlClass{Field}{\text{FeesOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1050}{\htmlId{15178}{\htmlClass{Function}{\text{utxoSt}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#885}{\htmlId{15187}{\htmlClass{Field}{\text{DepositsOf}}}}\, \,\href{Ledger.Conway.Specification.Ledger.html#1050}{\htmlId{15198}{\htmlClass{Function}{\text{utxoSt}}}}\, \,\href{Axiom.Set.Map.html#13606}{\htmlId{15205}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{abstract-set-theory.FiniteSetTheory.html#519}{\htmlId{15207}{\htmlClass{Function}{\text{mapˢ}}}}\, \,\htmlId{15212}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Data.Product.Base.html#636}{\htmlId{15213}{\htmlClass{Field}{\text{proj₁}}}}\, \,\href{Function.Base.html#1134}{\htmlId{15219}{\htmlClass{Function Operator}{\text{∘}}}}\, \,\href{Data.Product.Base.html#650}{\htmlId{15221}{\htmlClass{Field}{\text{proj₂}}}}\,\,\htmlId{15226}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13747}{\htmlId{15228}{\htmlClass{Field}{\text{removedGovActions}}}}\, \,\href{Axiom.Set.Map.html#13606}{\htmlId{15246}{\htmlClass{Function Operator}{\text{ᶜ}}}}\, \\ \,\htmlId{15250}{\htmlClass{Number}{\text{0}}}\, \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.pState&#39;"></a><a id="15257" href="Ledger.Conway.Specification.Epoch.html#15257" class="Function">pState&#39;</a> <a id="15265" class="Symbol">:</a> <a id="15267" href="Ledger.Core.Specification.Certs.html#3872" class="Record">PState</a>
  <a id="15276" href="Ledger.Conway.Specification.Epoch.html#15257" class="Function">pState&#39;</a> <a id="15284" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Core.Specification.Certs.html#3926}{\htmlId{15288}{\htmlClass{Function}{\text{fPools}}}}\, \,\href{Axiom.Set.Map.html#7640}{\htmlId{15295}{\htmlClass{Function Operator}{\text{∪ˡ}}}}\, \,\href{Ledger.Core.Specification.Certs.html#3904}{\htmlId{15298}{\htmlClass{Function}{\text{pools}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{15306}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#3948}{\htmlId{15310}{\htmlClass{Function}{\text{retiring}}}}\, \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.gState&#39;"></a><a id="15324" href="Ledger.Conway.Specification.Epoch.html#15324" class="Function">gState&#39;</a> <a id="15332" class="Symbol">:</a> <a id="15334" href="Ledger.Core.Specification.Certs.html#3984" class="Record">GState</a>
  <a id="15343" href="Ledger.Conway.Specification.Epoch.html#15324" class="Function">gState&#39;</a> <a id="15351" class="Symbol">=</a>
    <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{15359}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Class.ToBool.html#342}{\htmlId{15360}{\htmlClass{Function Operator}{\text{if}}}}\, \,\href{Data.List.Base.html#4681}{\htmlId{15363}{\htmlClass{Function}{\text{null}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13813}{\htmlId{15368}{\htmlClass{Field}{\text{govSt&#39;}}}}\, \,\href{Class.ToBool.html#342}{\htmlId{15375}{\htmlClass{Function Operator}{\text{then}}}}\, \,\href{Axiom.Set.Map.html#7108}{\htmlId{15380}{\htmlClass{Function}{\text{mapValues}}}}\, \,\href{Ledger.Core.Specification.Epoch.html#1054}{\htmlId{15390}{\htmlClass{Function}{\text{sucᵉ}}}}\, \,\htmlId{15395}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Core.Specification.Gov.Actions.html#7094}{\htmlId{15396}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Core.Specification.Certs.html#4218}{\htmlId{15404}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{15410}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Class.ToBool.html#342}{\htmlId{15412}{\htmlClass{Function Operator}{\text{else}}}}\, \,\href{Ledger.Core.Specification.Gov.Actions.html#7094}{\htmlId{15417}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Core.Specification.Certs.html#4218}{\htmlId{15425}{\htmlClass{Function}{\text{gState}}}}\,\,\htmlId{15431}{\htmlClass{Symbol}{\text{)}}}\,
    \\ \,\href{Ledger.Core.Specification.Certs.html#1446}{\htmlId{15439}{\htmlClass{Field}{\text{CCHotKeysOf}}}}\, \,\href{Ledger.Core.Specification.Certs.html#4218}{\htmlId{15451}{\htmlClass{Function}{\text{gState}}}}\, \,\href{Axiom.Set.Map.html#13536}{\htmlId{15458}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Specification.Enact.html#1362}{\htmlId{15460}{\htmlClass{Function}{\text{ccCreds}}}}\, \,\htmlId{15468}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Specification.Enact.html#480}{\htmlId{15469}{\htmlClass{Field}{\text{EnactState.cc}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#14885}{\htmlId{15483}{\htmlClass{Bound}{\text{es}}}}\,\,\htmlId{15485}{\htmlClass{Symbol}{\text{)}}}\,
    \end{pmatrix}$</a>

  <a id="Pre-POOLREAPUpdate.updates"></a><a id="15496" href="Ledger.Conway.Specification.Epoch.html#15496" class="Function">updates</a> <a id="15504" class="Symbol">:</a> <a id="15506" href="Ledger.Conway.Specification.Epoch.html#14665" class="Record">Pre-POOLREAP-Update</a>
  <a id="15528" href="Ledger.Conway.Specification.Epoch.html#15496" class="Function">updates</a> <a id="15536" class="Symbol">=</a> <a id="15538" href="Ledger.Conway.Specification.Epoch.html#14724" class="InductiveConstructor">Pre-POOLREAPUpdate</a> <a id="15557" href="Ledger.Conway.Specification.Epoch.html#15257" class="Function">pState&#39;</a> <a id="15565" href="Ledger.Conway.Specification.Epoch.html#15324" class="Function">gState&#39;</a> <a id="15573" href="Ledger.Conway.Specification.Epoch.html#15121" class="Function">utxoSt&#39;</a>

<a id="15582" class="Keyword">record</a> <a id="Post-POOLREAP-Update"></a><a id="15589" href="Ledger.Conway.Specification.Epoch.html#15589" class="Record">Post-POOLREAP-Update</a> <a id="15610" class="Symbol">:</a> <a id="15612" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="15617" class="Keyword">where</a>
  <a id="15625" class="Keyword">inductive</a>
  <a id="15637" class="Keyword">constructor</a> <a id="Post-POOLREAPUpdate"></a><a id="15649" href="Ledger.Conway.Specification.Epoch.html#15649" class="InductiveConstructor">Post-POOLREAPUpdate</a>
  <a id="15671" class="Keyword">field</a>
    <a id="Post-POOLREAP-Update.dState&#39;&#39;"></a><a id="15681" href="Ledger.Conway.Specification.Epoch.html#15681" class="Field">dState&#39;&#39;</a>       <a id="15696" class="Symbol">:</a> <a id="15698" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
    <a id="Post-POOLREAP-Update.acnt&#39;&#39;"></a><a id="15709" href="Ledger.Conway.Specification.Epoch.html#15709" class="Field">acnt&#39;&#39;</a>         <a id="15724" class="Symbol">:</a> <a id="15726" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>

<a id="15732" class="Keyword">module</a> <a id="Post-POOLREAPUpdate"></a><a id="15739" href="Ledger.Conway.Specification.Epoch.html#15739" class="Module">Post-POOLREAPUpdate</a> <a id="15759" class="Symbol">(</a><a id="15760" href="Ledger.Conway.Specification.Epoch.html#15760" class="Bound">es</a> <a id="15763" class="Symbol">:</a> <a id="15765" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a><a id="15775" class="Symbol">)</a>
                           <a id="15804" class="Symbol">(</a><a id="15805" href="Ledger.Conway.Specification.Epoch.html#15805" class="Bound">ls</a> <a id="15808" class="Symbol">:</a> <a id="15810" href="Ledger.Conway.Specification.Ledger.html#991" class="Record">LState</a><a id="15816" class="Symbol">)</a>
                           <a id="15845" class="Symbol">(</a><a id="15846" href="Ledger.Conway.Specification.Epoch.html#15846" class="Bound">dState&#39;</a> <a id="15854" class="Symbol">:</a> <a id="15856" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a><a id="15862" class="Symbol">)</a>
                           <a id="15891" class="Symbol">(</a><a id="15892" href="Ledger.Conway.Specification.Epoch.html#15892" class="Bound">acnt&#39;</a> <a id="15898" class="Symbol">:</a> <a id="15900" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a><a id="15904" class="Symbol">)</a>
                           <a id="15933" class="Symbol">(</a><a id="15934" href="Ledger.Conway.Specification.Epoch.html#15934" class="Bound">govUpd</a> <a id="15941" class="Symbol">:</a> <a id="15943" href="Ledger.Conway.Specification.Epoch.html#13673" class="Record">Governance-Update</a><a id="15960" class="Symbol">)</a>
                           <a id="15989" class="Keyword">where</a>


  <a id="15999" class="Keyword">open</a> <a id="16004" href="Ledger.Conway.Specification.Ledger.html#991" class="Module">LState</a>
  <a id="16013" class="Keyword">open</a> <a id="16018" href="Ledger.Conway.Specification.Epoch.html#13673" class="Module">Governance-Update</a> <a id="16036" href="Ledger.Conway.Specification.Epoch.html#15934" class="Bound">govUpd</a>


  <a id="16047" class="Keyword">opaque</a>
    <a id="Post-POOLREAPUpdate.govActionReturns"></a><a id="16058" href="Ledger.Conway.Specification.Epoch.html#16058" class="Function">govActionReturns</a> <a id="16075" class="Symbol">:</a> <a id="16077" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="16091" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16093" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16102" href="Ledger.Conway.Specification.Epoch.html#16058" class="Function">govActionReturns</a> <a id="16119" class="Symbol">=</a>
      <a id="16127" href="Axiom.Set.Map.Dec.html#2227" class="Function">aggregate₊</a> <a id="16138" class="Symbol">(</a><a id="16139" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="16144" class="Symbol">(λ</a> <a id="16147" class="Symbol">(</a><a id="16148" href="Ledger.Conway.Specification.Epoch.html#16148" class="Bound">a</a> <a id="16150" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16152" class="Symbol">_</a> <a id="16154" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16156" href="Ledger.Conway.Specification.Epoch.html#16156" class="Bound">d</a><a id="16157" class="Symbol">)</a> <a id="16159" class="Symbol">→</a> <a id="16161" href="Ledger.Conway.Specification.Epoch.html#16148" class="Bound">a</a> <a id="16163" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="16165" href="Ledger.Conway.Specification.Epoch.html#16156" class="Bound">d</a><a id="16166" class="Symbol">)</a> <a id="16168" href="Ledger.Conway.Specification.Epoch.html#13747" class="Field">removedGovActions</a> <a id="16186" href="abstract-set-theory.FiniteSetTheory.html#2921" class="Function Operator">ᶠˢ</a><a id="16188" class="Symbol">)</a>

    <a id="Post-POOLREAPUpdate.payout"></a><a id="16195" href="Ledger.Conway.Specification.Epoch.html#16195" class="Function">payout</a> <a id="16202" class="Symbol">:</a> <a id="16204" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a> <a id="16218" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16220" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16229" href="Ledger.Conway.Specification.Epoch.html#16195" class="Function">payout</a> <a id="16236" class="Symbol">=</a> <a id="16238" href="Ledger.Conway.Specification.Epoch.html#16058" class="Function">govActionReturns</a> <a id="16255" href="Axiom.Set.Map.Dec.html#2149" class="Function Operator">∪⁺</a> <a id="16258" href="Ledger.Core.Specification.Address.html#1700" class="Field">WithdrawalsOf</a> <a id="16272" href="Ledger.Conway.Specification.Epoch.html#15760" class="Bound">es</a>

  <a id="16278" class="Keyword">opaque</a>
    <a id="Post-POOLREAPUpdate.refunds"></a><a id="16289" href="Ledger.Conway.Specification.Epoch.html#16289" class="Function">refunds</a> <a id="16297" class="Symbol">:</a> <a id="16299" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="16310" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="16312" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="16321" href="Ledger.Conway.Specification.Epoch.html#16289" class="Function">refunds</a> <a id="16329" class="Symbol">=</a> <a id="16331" href="Axiom.Set.Map.html#17518" class="Function">pullbackMap</a> <a id="16343" href="Ledger.Conway.Specification.Epoch.html#16195" class="Function">payout</a> <a id="16350" href="Ledger.Conway.Specification.Epoch.html#5487" class="Function">toRewardAddress</a> <a id="16366" class="Symbol">(</a><a id="16367" href="Class.IsSet.html#916" class="Function">dom</a> <a id="16371" class="Symbol">(</a><a id="16372" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="16382" href="Ledger.Conway.Specification.Epoch.html#15846" class="Bound">dState&#39;</a><a id="16389" class="Symbol">))</a>

  <a id="Post-POOLREAPUpdate.dState&#39;&#39;"></a><a id="16395" href="Ledger.Conway.Specification.Epoch.html#16395" class="Function">dState&#39;&#39;</a> <a id="16404" class="Symbol">:</a> <a id="16406" href="Ledger.Core.Specification.Certs.html#3721" class="Record">DState</a>
  <a id="16415" href="Ledger.Conway.Specification.Epoch.html#16395" class="Function">dState&#39;&#39;</a> <a id="16424" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Core.Specification.Gov.Actions.html#2806}{\htmlId{16428}{\htmlClass{Field}{\text{VoteDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15846}{\htmlId{16441}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#1861}{\htmlId{16451}{\htmlClass{Field}{\text{StakeDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15846}{\htmlId{16465}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#1696}{\htmlId{16475}{\htmlClass{Field}{\text{RewardsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15846}{\htmlId{16485}{\htmlClass{Bound}{\text{dState&#39;}}}}\, \,\href{Axiom.Set.Map.Dec.html#2149}{\htmlId{16493}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16289}{\htmlId{16496}{\htmlClass{Function}{\text{refunds}}}}\, \end{pmatrix}$</a>

  <a id="Post-POOLREAPUpdate.unclaimed"></a><a id="16509" href="Ledger.Conway.Specification.Epoch.html#16509" class="Function">unclaimed</a> <a id="16519" class="Symbol">:</a> <a id="16521" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="16528" href="Ledger.Conway.Specification.Epoch.html#16509" class="Function">unclaimed</a> <a id="16538" class="Symbol">=</a> <a id="16540" href="Ledger.Prelude.HasCoin.html#171" class="Field">getCoin</a> <a id="16548" href="Ledger.Conway.Specification.Epoch.html#16195" class="Function">payout</a> <a id="16555" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="16557" href="Ledger.Prelude.HasCoin.html#171" class="Field">getCoin</a> <a id="16565" href="Ledger.Conway.Specification.Epoch.html#16289" class="Function">refunds</a>

  <a id="Post-POOLREAPUpdate.totWithdrawals"></a><a id="16576" href="Ledger.Conway.Specification.Epoch.html#16576" class="Function">totWithdrawals</a> <a id="16591" class="Symbol">:</a> <a id="16593" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
  <a id="16600" href="Ledger.Conway.Specification.Epoch.html#16576" class="Function">totWithdrawals</a> <a id="16615" class="Symbol">=</a> <a id="16617" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">∑[</a> <a id="16620" href="Ledger.Conway.Specification.Epoch.html#16620" class="Bound">x</a> <a id="16622" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">←</a> <a id="16624" href="Ledger.Core.Specification.Address.html#1700" class="Field">WithdrawalsOf</a> <a id="16638" href="Ledger.Conway.Specification.Epoch.html#15760" class="Bound">es</a> <a id="16641" href="abstract-set-theory.FiniteSetTheory.html#4373" class="Function">]</a> <a id="16643" href="Ledger.Conway.Specification.Epoch.html#16620" class="Bound">x</a>

  <a id="Post-POOLREAPUpdate.acnt&#39;&#39;"></a><a id="16648" href="Ledger.Conway.Specification.Epoch.html#16648" class="Function">acnt&#39;&#39;</a> <a id="16655" class="Symbol">:</a> <a id="16657" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>
  <a id="16664" href="Ledger.Conway.Specification.Epoch.html#16648" class="Function">acnt&#39;&#39;</a> <a id="16671" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Prelude.Base.html#889}{\htmlId{16675}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15892}{\htmlId{16686}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \,\href{Data.Nat.Base.html#4462}{\htmlId{16692}{\htmlClass{Primitive Operator}{\text{∸}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16576}{\htmlId{16694}{\htmlClass{Function}{\text{totWithdrawals}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{16709}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Prelude.Base.html#554}{\htmlId{16711}{\htmlClass{Field}{\text{DonationsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15805}{\htmlId{16723}{\htmlClass{Bound}{\text{ls}}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{16726}{\htmlClass{Field Operator}{\text{+}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#16509}{\htmlId{16728}{\htmlClass{Function}{\text{unclaimed}}}}\, \\ \,\href{Ledger.Prelude.Base.html#773}{\htmlId{16740}{\htmlClass{Field}{\text{ReservesOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#15892}{\htmlId{16751}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \end{pmatrix}$</a>

  <a id="Post-POOLREAPUpdate.updates"></a><a id="16762" href="Ledger.Conway.Specification.Epoch.html#16762" class="Function">updates</a> <a id="16770" class="Symbol">:</a> <a id="16772" href="Ledger.Conway.Specification.Epoch.html#15589" class="Record">Post-POOLREAP-Update</a>
  <a id="16795" href="Ledger.Conway.Specification.Epoch.html#16762" class="Function">updates</a> <a id="16803" class="Symbol">=</a> <a id="16805" href="Ledger.Conway.Specification.Epoch.html#15649" class="InductiveConstructor">Post-POOLREAPUpdate</a> <a id="16825" href="Ledger.Conway.Specification.Epoch.html#16395" class="Function">dState&#39;&#39;</a> <a id="16834" href="Ledger.Conway.Specification.Epoch.html#16648" class="Function">acnt&#39;&#39;</a>


<a id="16843" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="16848" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="16863" class="Symbol">:</a> <a id="16865" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="16867" class="Symbol">→</a> <a id="16869" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a> <a id="16880" class="Symbol">→</a> <a id="16882" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a> <a id="16888" class="Symbol">→</a> <a id="16890" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a> <a id="16901" class="Symbol">→</a> <a id="16903" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="16908" class="Keyword">where</a>


  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="16918" href="Ledger.Conway.Specification.Epoch.html#16918" class="InductiveConstructor">EPOCH</a> <a id="16924" class="Symbol">:</a>
    <a id="16930" class="Keyword">let</a>
      <a id="16940" href="Ledger.Conway.Specification.Epoch.html#16940" class="Bound">es</a> <a id="16943" class="Symbol">=</a> <a id="16945" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="16958" href="Ledger.Conway.Specification.Epoch.html#12854" class="Generalizable">fut</a>

      <a id="16969" href="Ledger.Conway.Specification.Epoch.html#16969" class="Bound">govUpd</a> <a id="16976" class="Symbol">:</a> <a id="16978" href="Ledger.Conway.Specification.Epoch.html#13673" class="Record">Governance-Update</a>
      <a id="17002" href="Ledger.Conway.Specification.Epoch.html#16969" class="Bound">govUpd</a> <a id="17009" class="Symbol">=</a> <a id="17011" href="Ledger.Conway.Specification.Epoch.html#14575" class="Function">GovernanceUpdate.updates</a> <a id="17036" href="Ledger.Conway.Specification.Epoch.html#12941" class="Generalizable">ls</a> <a id="17039" href="Ledger.Conway.Specification.Epoch.html#12854" class="Generalizable">fut</a>

      <a id="17050" href="Ledger.Conway.Specification.Epoch.html#14724" class="InductiveConstructor">Pre-POOLREAPUpdate</a> <a id="17069" href="Ledger.Conway.Specification.Epoch.html#17069" class="Bound">pState&#39;</a> <a id="17077" href="Ledger.Conway.Specification.Epoch.html#17077" class="Bound">gState&#39;</a> <a id="17085" href="Ledger.Conway.Specification.Epoch.html#17085" class="Bound">utxoSt&#39;</a> <a id="17093" class="Symbol">=</a> <a id="17095" href="Ledger.Conway.Specification.Epoch.html#15496" class="Function">Pre-POOLREAPUpdate.updates</a> <a id="17122" href="Ledger.Conway.Specification.Epoch.html#12941" class="Generalizable">ls</a> <a id="17125" href="Ledger.Conway.Specification.Epoch.html#16940" class="Bound">es</a> <a id="17128" href="Ledger.Conway.Specification.Epoch.html#16969" class="Bound">govUpd</a>
      <a id="17141" href="Ledger.Conway.Specification.Epoch.html#15649" class="InductiveConstructor">Post-POOLREAPUpdate</a> <a id="17161" href="Ledger.Conway.Specification.Epoch.html#17161" class="Bound">dState&#39;&#39;</a> <a id="17170" href="Ledger.Conway.Specification.Epoch.html#17170" class="Bound">acnt&#39;&#39;</a> <a id="17177" class="Symbol">=</a> <a id="17179" href="Ledger.Conway.Specification.Epoch.html#16762" class="Function">Post-POOLREAPUpdate.updates</a> <a id="17207" href="Ledger.Conway.Specification.Epoch.html#16940" class="Bound">es</a> <a id="17210" href="Ledger.Conway.Specification.Epoch.html#12941" class="Generalizable">ls</a> <a id="17213" href="Ledger.Conway.Specification.Epoch.html#13052" class="Generalizable">dState&#39;</a> <a id="17221" href="Ledger.Conway.Specification.Epoch.html#13076" class="Generalizable">acnt&#39;</a> <a id="17227" href="Ledger.Conway.Specification.Epoch.html#16969" class="Bound">govUpd</a>

      <a id="17241" href="Ledger.Conway.Specification.Epoch.html#17241" class="Bound">es&#39;</a> <a id="17245" class="Symbol">:</a> <a id="17247" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
      <a id="17264" href="Ledger.Conway.Specification.Epoch.html#17241" class="Bound">es&#39;</a> <a id="17268" class="Symbol">=</a> <a id="17270" class="Keyword">record</a> <a id="17277" href="Ledger.Conway.Specification.Epoch.html#16940" class="Bound">es</a> <a id="17280" class="Symbol">{</a> <a id="17282" href="Ledger.Conway.Specification.Enact.html#696" class="Field">withdrawals</a> <a id="17294" class="Symbol">=</a> <a id="17296" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="17298" class="Symbol">}</a>

      <a id="17307" href="Ledger.Conway.Specification.Epoch.html#17307" class="Bound">govSt&#39;</a> <a id="17314" class="Symbol">:</a> <a id="17316" href="Ledger.Conway.Specification.Gov.html#1461" class="Function">GovState</a>
      <a id="17331" href="Ledger.Conway.Specification.Epoch.html#17307" class="Bound">govSt&#39;</a> <a id="17338" class="Symbol">=</a> <a id="17340" href="Ledger.Conway.Specification.Epoch.html#13813" class="Field">Governance-Update.govSt&#39;</a> <a id="17365" href="Ledger.Conway.Specification.Epoch.html#16969" class="Bound">govUpd</a>

      <a id="17379" href="Ledger.Conway.Specification.Epoch.html#17379" class="Bound">stakeDistrs</a> <a id="17391" class="Symbol">:</a> <a id="17393" href="Ledger.Conway.Specification.Ratify.html#3118" class="Record">StakeDistrs</a>
      <a id="17411" href="Ledger.Conway.Specification.Epoch.html#17379" class="Bound">stakeDistrs</a> <a id="17423" class="Symbol">=</a> <a id="17425" href="Ledger.Conway.Specification.Epoch.html#12517" class="Function">mkStakeDistrs</a> <a id="17439" class="Symbol">(</a><a id="17440" href="Ledger.Conway.Specification.Rewards.html#7770" class="Field">Snapshots.mark</a> <a id="17455" href="Ledger.Conway.Specification.Epoch.html#13117" class="Generalizable">ss&#39;</a><a id="17458" class="Symbol">)</a> <a id="17460" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="17462" href="Ledger.Conway.Specification.Epoch.html#17085" class="Bound">utxoSt&#39;</a>
                                  <a id="17504" href="Ledger.Conway.Specification.Epoch.html#17307" class="Bound">govSt&#39;</a> <a id="17511" class="Symbol">(</a><a id="17512" href="Ledger.Core.Specification.Certs.html#4634" class="Field">GStateOf</a> <a id="17521" href="Ledger.Conway.Specification.Epoch.html#12941" class="Generalizable">ls</a><a id="17523" class="Symbol">)</a> <a id="17525" class="Symbol">(</a><a id="17526" href="Ledger.Core.Specification.Certs.html#4418" class="Field">DStateOf</a> <a id="17535" href="Ledger.Conway.Specification.Epoch.html#12941" class="Generalizable">ls</a><a id="17537" class="Symbol">)</a>

      <a id="17546" href="Ledger.Conway.Specification.Epoch.html#17546" class="Bound">Γ</a> <a id="17548" class="Symbol">:</a> <a id="17550" href="Ledger.Conway.Specification.Ratify.html#3237" class="Record">RatifyEnv</a>
      <a id="17566" href="Ledger.Conway.Specification.Epoch.html#17546" class="Bound">Γ</a> <a id="17568" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17379}{\htmlId{17572}{\htmlClass{Bound}{\text{stakeDistrs}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12832}{\htmlId{17586}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Core.Specification.Gov.Actions.html#7094}{\htmlId{17590}{\htmlClass{Field}{\text{DRepsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12941}{\htmlId{17598}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#1446}{\htmlId{17603}{\htmlClass{Field}{\text{CCHotKeysOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12941}{\htmlId{17615}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Prelude.Base.html#889}{\htmlId{17620}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#17170}{\htmlId{17631}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#1531}{\htmlId{17640}{\htmlClass{Field}{\text{PoolsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12941}{\htmlId{17648}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Core.Specification.Gov.Actions.html#2806}{\htmlId{17653}{\htmlClass{Field}{\text{VoteDelegsOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12941}{\htmlId{17666}{\htmlClass{Generalizable}{\text{ls}}}}\, \end{pmatrix}$</a>

    <a id="17676" class="Keyword">in</a>
        <a id="17687" href="Ledger.Conway.Specification.Epoch.html#12941" class="Generalizable">ls</a> <a id="17690" href="Ledger.Conway.Specification.Rewards.html#8211" class="Datatype Operator">⊢</a> <a id="17692" href="Ledger.Conway.Specification.Epoch.html#13114" class="Generalizable">ss</a> <a id="17695" href="Ledger.Conway.Specification.Rewards.html#8211" class="Datatype Operator">⇀⦇</a> <a id="17698" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="17701" href="Ledger.Conway.Specification.Rewards.html#8211" class="Datatype Operator">,SNAP⦈</a> <a id="17708" href="Ledger.Conway.Specification.Epoch.html#13117" class="Generalizable">ss&#39;</a>
      <a id="17718" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="17720" class="Symbol">_</a>  <a id="17723" href="Ledger.Conway.Specification.PoolReap.html#868" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17085}{\htmlId{17727}{\htmlClass{Bound}{\text{utxoSt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13071}{\htmlId{17737}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Core.Specification.Certs.html#4418}{\htmlId{17744}{\htmlClass{Field}{\text{DStateOf}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#12941}{\htmlId{17753}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17069}{\htmlId{17758}{\htmlClass{Bound}{\text{pState&#39;}}}}\, \end{pmatrix}$</a> <a id="17768" href="Ledger.Conway.Specification.PoolReap.html#868" class="Datatype Operator">⇀⦇</a> <a id="17771" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="17773" href="Ledger.Conway.Specification.PoolReap.html#868" class="Datatype Operator">,POOLREAP⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13091}{\htmlId{17786}{\htmlClass{Generalizable}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13076}{\htmlId{17797}{\htmlClass{Generalizable}{\text{acnt&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13052}{\htmlId{17805}{\htmlClass{Generalizable}{\text{dState&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13032}{\htmlId{17815}{\htmlClass{Generalizable}{\text{pState&#39;&#39;}}}}\, \end{pmatrix}$</a>
      <a id="17832" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="17834" href="Ledger.Conway.Specification.Epoch.html#17546" class="Bound">Γ</a>  <a id="17837" href="Ledger.Conway.Specification.Ratify.html#13640" class="Function Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17241}{\htmlId{17841}{\htmlClass{Bound}{\text{es&#39;}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{17847}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Agda.Builtin.Bool.html#192}{\htmlId{17851}{\htmlClass{InductiveConstructor}{\text{false}}}}\, \end{pmatrix}$</a> <a id="17859" href="Ledger.Conway.Specification.Ratify.html#13640" class="Function Operator">⇀⦇</a> <a id="17862" href="Ledger.Conway.Specification.Epoch.html#17307" class="Bound">govSt&#39;</a> <a id="17869" href="Ledger.Conway.Specification.Ratify.html#13640" class="Function Operator">,RATIFIES⦈</a> <a id="17880" href="Ledger.Conway.Specification.Epoch.html#12858" class="Generalizable">fut&#39;</a>
      <a id="17891" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="17944" class="Symbol">_</a> <a id="17946" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13071}{\htmlId{17950}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13114}{\htmlId{17957}{\htmlClass{Generalizable}{\text{ss}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12941}{\htmlId{17962}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12955}{\htmlId{17967}{\htmlClass{Generalizable}{\text{es₀}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12854}{\htmlId{17973}{\htmlClass{Generalizable}{\text{fut}}}}\, \end{pmatrix}$</a> <a id="17979" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">⇀⦇</a> <a id="17982" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="17984" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">,EPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17170}{\htmlId{17994}{\htmlClass{Bound}{\text{acnt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13117}{\htmlId{18003}{\htmlClass{Generalizable}{\text{ss&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#13091}{\htmlId{18011}{\htmlClass{Generalizable}{\text{utxoSt&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17307}{\htmlId{18022}{\htmlClass{Bound}{\text{govSt&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#17161}{\htmlId{18033}{\htmlClass{Bound}{\text{dState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13032}{\htmlId{18044}{\htmlClass{Generalizable}{\text{pState&#39;&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#17077}{\htmlId{18055}{\htmlClass{Bound}{\text{gState&#39;}}}}\, \end{pmatrix} \end{pmatrix} \\ \,\href{Ledger.Conway.Specification.Epoch.html#17241}{\htmlId{18071}{\htmlClass{Bound}{\text{es&#39;}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12858}{\htmlId{18077}{\htmlClass{Generalizable}{\text{fut&#39;}}}}\, \end{pmatrix}$</a>


<a id="18086" class="Keyword">data</a> <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="18091" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="18109" class="Symbol">:</a> <a id="18111" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="18113" class="Symbol">→</a> <a id="18115" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a> <a id="18129" class="Symbol">→</a> <a id="18131" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a> <a id="18137" class="Symbol">→</a> <a id="18139" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a> <a id="18153" class="Symbol">→</a> <a id="18155" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="18160" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="18169" href="Ledger.Conway.Specification.Epoch.html#18169" class="InductiveConstructor">NEWEPOCH-New</a> <a id="18182" class="Symbol">:</a> <a id="18184" class="Symbol">∀</a> <a id="18186" class="Symbol">{</a><a id="18187" href="Ledger.Conway.Specification.Epoch.html#18187" class="Bound">bprev</a> <a id="18193" href="Ledger.Conway.Specification.Epoch.html#18193" class="Bound">bcur</a> <a id="18198" class="Symbol">:</a> <a id="18200" href="Ledger.Conway.Specification.Rewards.html#4923" class="Function">BlocksMade</a><a id="18210" class="Symbol">}</a> <a id="18212" class="Symbol">→</a>
    <a id="18218" class="Keyword">let</a>
      <a id="18228" href="Ledger.Conway.Specification.Epoch.html#18228" class="Bound">eps&#39;</a> <a id="18233" class="Symbol">=</a> <a id="18235" href="Ledger.Conway.Specification.Epoch.html#8950" class="Function">applyRUpd</a> <a id="18245" href="Ledger.Conway.Specification.Epoch.html#13135" class="Generalizable">ru</a> <a id="18248" href="Ledger.Conway.Specification.Epoch.html#12911" class="Generalizable">eps</a>
      <a id="18258" href="Ledger.Conway.Specification.Epoch.html#18258" class="Bound">ss</a>   <a id="18263" class="Symbol">=</a> <a id="18265" href="Ledger.Conway.Specification.Epoch.html#1925" class="Field">EpochState.ss</a> <a id="18279" href="Ledger.Conway.Specification.Epoch.html#12920" class="Generalizable">eps&#39;&#39;</a>
      <a id="18291" href="Ledger.Conway.Specification.Epoch.html#18291" class="Bound">pd&#39;</a>  <a id="18296" class="Symbol">=</a> <a id="18298" href="Ledger.Conway.Specification.Epoch.html#10024" class="Function">calculatePoolDelegatedStake</a> <a id="18326" class="Symbol">(</a><a id="18327" href="Ledger.Conway.Specification.Rewards.html#7775" class="Field">Snapshots.set</a> <a id="18341" href="Ledger.Conway.Specification.Epoch.html#18258" class="Bound">ss</a><a id="18343" class="Symbol">)</a>
    <a id="18349" class="Keyword">in</a>
      <a id="18358" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18360" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="18362" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="18364" href="Ledger.Conway.Specification.Epoch.html#12834" class="Generalizable">lastEpoch</a> <a id="18374" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18376" class="Number">1</a>
      <a id="18384" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="18386" class="Symbol">_</a> <a id="18388" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">⊢</a> <a id="18390" href="Ledger.Conway.Specification.Epoch.html#18228" class="Bound">eps&#39;</a> <a id="18395" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">⇀⦇</a> <a id="18398" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="18400" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">,EPOCH⦈</a> <a id="18408" href="Ledger.Conway.Specification.Epoch.html#12920" class="Generalizable">eps&#39;&#39;</a>
      <a id="18420" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18473" class="Symbol">_</a> <a id="18475" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12834}{\htmlId{18479}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18187}{\htmlId{18491}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18193}{\htmlId{18499}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12911}{\htmlId{18506}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#173}{\htmlId{18512}{\htmlClass{InductiveConstructor}{\text{just}}}}\, \,\href{Ledger.Conway.Specification.Epoch.html#13135}{\htmlId{18517}{\htmlClass{Generalizable}{\text{ru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13182}{\htmlId{18522}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18527" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">⇀⦇</a> <a id="18530" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="18532" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12832}{\htmlId{18545}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18193}{\htmlId{18549}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Axiom.Set.Map.html#2671}{\htmlId{18556}{\htmlClass{Function}{\text{∅ᵐ}}}}\,  \\ \,\href{Ledger.Conway.Specification.Epoch.html#12920}{\htmlId{18562}{\htmlClass{Generalizable}{\text{eps&#39;&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{18570}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18291}{\htmlId{18580}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="18589" href="Ledger.Conway.Specification.Epoch.html#18589" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="18606" class="Symbol">:</a> <a id="18608" class="Symbol">∀</a> <a id="18610" class="Symbol">{</a><a id="18611" href="Ledger.Conway.Specification.Epoch.html#18611" class="Bound">bprev</a> <a id="18617" href="Ledger.Conway.Specification.Epoch.html#18617" class="Bound">bcur</a> <a id="18622" class="Symbol">:</a> <a id="18624" href="Ledger.Conway.Specification.Rewards.html#4923" class="Function">BlocksMade</a><a id="18634" class="Symbol">}</a> <a id="18636" class="Symbol">→</a>
    <a id="18642" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="18644" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="18646" href="Relation.Binary.PropositionalEquality.Core.html#1000" class="Function Operator">≢</a> <a id="18648" href="Ledger.Conway.Specification.Epoch.html#12834" class="Generalizable">lastEpoch</a> <a id="18658" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="18660" class="Number">1</a>
      <a id="18668" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="18721" class="Symbol">_</a> <a id="18723" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12834}{\htmlId{18727}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18611}{\htmlId{18739}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18617}{\htmlId{18747}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12911}{\htmlId{18754}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13155}{\htmlId{18760}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13182}{\htmlId{18766}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="18771" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">⇀⦇</a> <a id="18774" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="18776" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12834}{\htmlId{18789}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18611}{\htmlId{18801}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18617}{\htmlId{18809}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12911}{\htmlId{18816}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13155}{\htmlId{18822}{\htmlClass{Generalizable}{\text{mru}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13182}{\htmlId{18828}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="18836" href="Ledger.Conway.Specification.Epoch.html#18836" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="18862" class="Symbol">:</a> <a id="18864" class="Symbol">∀</a> <a id="18866" class="Symbol">{</a><a id="18867" href="Ledger.Conway.Specification.Epoch.html#18867" class="Bound">bprev</a> <a id="18873" href="Ledger.Conway.Specification.Epoch.html#18873" class="Bound">bcur</a> <a id="18878" class="Symbol">:</a> <a id="18880" href="Ledger.Conway.Specification.Rewards.html#4923" class="Function">BlocksMade</a><a id="18890" class="Symbol">}</a> <a id="18892" class="Symbol">→</a>
    <a id="18898" class="Keyword">let</a>
      <a id="18908" href="Ledger.Conway.Specification.Epoch.html#18908" class="Bound">ss</a>  <a id="18912" class="Symbol">=</a> <a id="18914" href="Ledger.Conway.Specification.Epoch.html#1925" class="Field">EpochState.ss</a> <a id="18928" href="Ledger.Conway.Specification.Epoch.html#12915" class="Generalizable">eps&#39;</a>
      <a id="18939" href="Ledger.Conway.Specification.Epoch.html#18939" class="Bound">pd&#39;</a> <a id="18943" class="Symbol">=</a> <a id="18945" href="Ledger.Conway.Specification.Epoch.html#10024" class="Function">calculatePoolDelegatedStake</a> <a id="18973" class="Symbol">(</a><a id="18974" href="Ledger.Conway.Specification.Rewards.html#7775" class="Field">Snapshots.set</a> <a id="18988" href="Ledger.Conway.Specification.Epoch.html#18908" class="Bound">ss</a><a id="18990" class="Symbol">)</a>
    <a id="18996" class="Keyword">in</a>
      <a id="19005" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="19007" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="19009" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="19011" href="Ledger.Conway.Specification.Epoch.html#12834" class="Generalizable">lastEpoch</a> <a id="19021" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="19023" class="Number">1</a>
      <a id="19031" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="19033" class="Symbol">_</a> <a id="19035" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">⊢</a> <a id="19037" href="Ledger.Conway.Specification.Epoch.html#12911" class="Generalizable">eps</a> <a id="19041" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">⇀⦇</a> <a id="19044" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="19046" href="Ledger.Conway.Specification.Epoch.html#16848" class="Datatype Operator">,EPOCH⦈</a> <a id="19054" href="Ledger.Conway.Specification.Epoch.html#12915" class="Generalizable">eps&#39;</a>
      <a id="19065" href="Prelude.InferenceRules.html#13071" class="Function Operator">──────────────────────────────────────────────</a>
      <a id="19118" class="Symbol">_</a> <a id="19120" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12834}{\htmlId{19124}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18867}{\htmlId{19136}{\htmlClass{Bound}{\text{bprev}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18873}{\htmlId{19144}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12911}{\htmlId{19151}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{19157}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#13182}{\htmlId{19167}{\htmlClass{Generalizable}{\text{pd}}}}\, \end{pmatrix}$</a> <a id="19172" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">⇀⦇</a> <a id="19175" href="Ledger.Conway.Specification.Epoch.html#12832" class="Generalizable">e</a> <a id="19177" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.Epoch.html#12832}{\htmlId{19190}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18873}{\htmlId{19194}{\htmlClass{Bound}{\text{bcur}}}}\, \\ \,\href{Axiom.Set.Map.html#2671}{\htmlId{19201}{\htmlClass{Function}{\text{∅ᵐ}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#12915}{\htmlId{19206}{\htmlClass{Generalizable}{\text{eps&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{19213}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \\ \,\href{Ledger.Conway.Specification.Epoch.html#18939}{\htmlId{19223}{\htmlClass{Bound}{\text{pd&#39;}}}}\, \end{pmatrix}$</a>

</pre></body></html>