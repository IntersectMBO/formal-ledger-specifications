<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Foreign.HaskellTypes.Deriving</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Keyword">module</a> <a id="9" href="Foreign.HaskellTypes.Deriving.html" class="Module">Foreign.HaskellTypes.Deriving</a> <a id="39" class="Keyword">where</a>

<a id="46" class="Keyword">open</a> <a id="51" class="Keyword">import</a> <a id="58" href="Meta.Init.html" class="Module">Meta.Init</a> <a id="68" class="Keyword">hiding</a> <a id="75" class="Symbol">(</a><a id="76" href="Reflection.TCI.html#554" class="Function">TC</a><a id="78" class="Symbol">;</a> <a id="80" href="Reflection.TCI.html#598" class="Function">Monad-TC</a><a id="88" class="Symbol">;</a> <a id="90" href="Reflection.TCI.html#778" class="Function">MonadError-TC</a><a id="103" class="Symbol">)</a>

<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Level.html" class="Module">Level</a> <a id="124" class="Keyword">using</a> <a id="130" class="Symbol">(</a><a id="131" href="Agda.Primitive.html#742" class="Postulate">Level</a><a id="136" class="Symbol">;</a> <a id="138" href="Level.html#521" class="Function">0ℓ</a><a id="140" class="Symbol">)</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="178" class="Keyword">using</a> <a id="184" class="Symbol">(</a><a id="185" href="Agda.Builtin.Reflection.html#9556" class="Postulate">declareData</a><a id="196" class="Symbol">;</a> <a id="198" href="Agda.Builtin.Reflection.html#9602" class="Postulate">defineData</a><a id="208" class="Symbol">;</a> <a id="210" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a><a id="223" class="Symbol">;</a> <a id="225" href="Agda.Builtin.Reflection.html#9970" class="Postulate">pragmaCompile</a><a id="238" class="Symbol">;</a>
                                           <a id="283" href="Agda.Builtin.Reflection.html#12129" class="Postulate">solveInstanceConstraints</a><a id="307" class="Symbol">)</a>
<a id="309" class="Keyword">open</a> <a id="314" class="Keyword">import</a> <a id="321" href="Reflection.html" class="Module">Reflection</a> <a id="332" class="Symbol">as</a> <a id="335" class="Module">R</a> <a id="337" class="Keyword">hiding</a> <a id="344" class="Symbol">(</a><a id="345" href="Reflection.AST.Show.html#1581" class="Primitive">showName</a><a id="353" class="Symbol">;</a> <a id="355" href="Reflection.TCM.Syntax.html#623" class="Function Operator">_&gt;&gt;=_</a><a id="360" class="Symbol">;</a> <a id="362" href="Reflection.TCM.Syntax.html#693" class="Function Operator">_&gt;&gt;_</a><a id="366" class="Symbol">)</a>
<a id="368" class="Keyword">open</a> <a id="373" class="Keyword">import</a> <a id="380" href="Reflection.AST.html" class="Module">Reflection.AST</a> <a id="395" class="Keyword">hiding</a> <a id="402" class="Symbol">(</a><a id="403" href="Reflection.AST.Show.html#1581" class="Primitive">showName</a><a id="411" class="Symbol">)</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Reflection.AST.DeBruijn.html" class="Module">Reflection.AST.DeBruijn</a>
<a id="449" class="Keyword">open</a> <a id="454" class="Keyword">import</a> <a id="461" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="472" class="Keyword">using</a> <a id="478" class="Symbol">(</a><a id="479" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="484" class="Symbol">;</a> <a id="486" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="493" class="Symbol">;</a> <a id="495" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="499" class="Symbol">;</a> <a id="501" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a><a id="510" class="Symbol">;</a> <a id="512" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a><a id="518" class="Symbol">;</a> <a id="520" href="Data.Maybe.Base.html#2264" class="Function Operator">_&lt;∣&gt;_</a><a id="525" class="Symbol">)</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="549" class="Keyword">using</a> <a id="555" class="Symbol">(</a><a id="556" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="557" class="Symbol">;</a> <a id="559" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="561" class="Symbol">)</a>
<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="Data.Integer.Base.html" class="Module">Data.Integer.Base</a> <a id="593" class="Keyword">using</a> <a id="599" class="Symbol">(</a><a id="600" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="601" class="Symbol">)</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="624" class="Keyword">using</a> <a id="630" class="Symbol">(</a><a id="631" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a><a id="634" class="Symbol">;</a> <a id="636" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a><a id="640" class="Symbol">;</a> <a id="642" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a><a id="646" class="Symbol">)</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Data.String.html" class="Module">Data.String</a> <a id="672" class="Keyword">using</a> <a id="678" class="Symbol">(</a><a id="679" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="685" class="Symbol">)</a> <a id="687" class="Keyword">renaming</a> <a id="696" class="Symbol">(</a><a id="697" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="702" class="Symbol">to</a> <a id="705" class="Function Operator">_&amp;_</a><a id="708" class="Symbol">)</a>
<a id="710" class="Keyword">open</a> <a id="715" class="Keyword">import</a> <a id="722" href="Data.Product.html" class="Module">Data.Product</a> <a id="735" class="Keyword">hiding</a> <a id="742" class="Symbol">(</a><a id="743" href="Data.Product.Base.html#2173" class="Function">map</a><a id="746" class="Symbol">;</a> <a id="748" href="Data.Product.Base.html#2747" class="Function">zip</a><a id="751" class="Symbol">;</a> <a id="753" href="Data.Product.html#1353" class="Function">zipWith</a><a id="760" class="Symbol">)</a>
<a id="762" class="Keyword">import</a> <a id="769" href="Data.String.html" class="Module">Data.String</a> <a id="781" class="Symbol">as</a> <a id="784" class="Module">String</a>
<a id="791" class="Keyword">open</a> <a id="796" class="Keyword">import</a> <a id="803" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="813" class="Keyword">open</a> <a id="818" class="Keyword">import</a> <a id="825" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="834" class="Keyword">open</a> <a id="839" class="Keyword">import</a> <a id="846" href="Data.List.html" class="Module">Data.List</a> <a id="856" class="Keyword">hiding</a> <a id="863" class="Symbol">(</a><a id="864" href="Data.List.Base.html#6263" class="Function">lookup</a><a id="870" class="Symbol">;</a> <a id="872" href="Data.List.Base.html#4940" class="Function">fromMaybe</a><a id="881" class="Symbol">)</a>
<a id="883" class="Keyword">open</a> <a id="888" class="Keyword">import</a> <a id="895" href="Data.Char.html" class="Module">Data.Char</a> <a id="905" class="Keyword">using</a> <a id="911" class="Symbol">(</a><a id="912" href="Data.Char.Base.html#1115" class="Primitive">toUpper</a><a id="919" class="Symbol">;</a> <a id="921" href="Data.Char.Base.html#1142" class="Primitive">toLower</a><a id="928" class="Symbol">)</a>
<a id="930" class="Keyword">open</a> <a id="935" class="Keyword">import</a> <a id="942" href="Foreign.Haskell.html" class="Module">Foreign.Haskell</a>
<a id="958" class="Keyword">open</a> <a id="963" class="Keyword">import</a> <a id="970" href="Function.html" class="Module">Function</a>
<a id="979" class="Keyword">open</a> <a id="984" class="Keyword">import</a> <a id="991" href="Text.Printf.html" class="Module">Text.Printf</a>

<a id="1004" class="Keyword">open</a> <a id="1009" class="Keyword">import</a> <a id="1016" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="1028" class="Keyword">open</a> <a id="1033" class="Keyword">import</a> <a id="1040" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="1054" class="Keyword">open</a> <a id="1059" class="Keyword">import</a> <a id="1066" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="1078" class="Keyword">open</a> <a id="1083" class="Keyword">import</a> <a id="1090" href="Class.MonadError.html" class="Module">Class.MonadError</a>
<a id="1107" class="Keyword">open</a> <a id="1112" class="Keyword">import</a> <a id="1119" href="Class.MonadReader.html" class="Module">Class.MonadReader</a>
<a id="1137" class="Keyword">open</a> <a id="1142" class="Keyword">import</a> <a id="1149" href="Class.Show.html" class="Module">Class.Show</a>
<a id="1160" class="Keyword">open</a> <a id="1165" class="Keyword">import</a> <a id="1172" href="Class.Show.Instances.html" class="Module">Class.Show.Instances</a>
<a id="1193" class="Keyword">open</a> <a id="1198" class="Keyword">import</a> <a id="1205" href="Class.MonadTC.html" class="Module">Class.MonadTC</a> <a id="1219" class="Keyword">using</a> <a id="1225" class="Symbol">(</a><a id="1226" href="Class.MonadTC.html#818" class="Record">TCEnv</a><a id="1231" class="Symbol">;</a> <a id="1233" href="Class.MonadTC.html#514" class="InductiveConstructor">dontReduce</a><a id="1243" class="Symbol">;</a> <a id="1245" href="Class.MonadTC.html#706" class="Function">defaultTCOptions</a><a id="1261" class="Symbol">)</a>
<a id="1263" class="Keyword">open</a> <a id="1268" class="Keyword">import</a> <a id="1275" href="Tactic.Derive.Show.html" class="Module">Tactic.Derive.Show</a> <a id="1294" class="Keyword">using</a> <a id="1300" class="Symbol">(</a><a id="1301" href="Tactic.Derive.Show.html#829" class="Function">showName</a><a id="1309" class="Symbol">)</a>

<a id="1312" class="Keyword">open</a> <a id="1317" class="Keyword">import</a> <a id="1324" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="1341" class="Keyword">open</a> <a id="1346" class="Keyword">import</a> <a id="1353" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>
<a id="1374" class="Keyword">open</a> <a id="1379" class="Keyword">import</a> <a id="1386" href="Foreign.HaskellTypes.html" class="Module">Foreign.HaskellTypes</a>
<a id="1407" class="Keyword">open</a> <a id="1412" class="Keyword">import</a> <a id="1419" href="Foreign.Haskell.Pair.html" class="Module">Foreign.Haskell.Pair</a> <a id="1440" class="Keyword">using</a> <a id="1446" class="Symbol">(</a><a id="1447" href="Foreign.Haskell.Pair.html#553" class="Record">Pair</a><a id="1451" class="Symbol">)</a>

<a id="1454" class="Comment">{-
Need to generate:
  - a data type that can be compiled to a Haskell data type
  - the corresponding Haskell type (in a FOREIGN pragma)
  - the COMPILE pragma binding them together
-}</a>

<a id="1641" class="Keyword">private</a> <a id="1649" class="Keyword">variable</a>
  <a id="1660" href="Foreign.HaskellTypes.Deriving.html#1660" class="Generalizable">l</a> <a id="1662" class="Symbol">:</a> <a id="1664" href="Agda.Primitive.html#742" class="Postulate">Level</a>
  <a id="1672" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a> <a id="1674" href="Foreign.HaskellTypes.Deriving.html#1674" class="Generalizable">B</a> <a id="1676" class="Symbol">:</a> <a id="1678" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1682" href="Foreign.HaskellTypes.Deriving.html#1660" class="Generalizable">l</a>

<a id="1685" class="Comment">-- * Controlling the names of the generated types</a>

<a id="1736" class="Keyword">record</a> <a id="NameEnv"></a><a id="1743" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="1751" class="Symbol">:</a> <a id="1753" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1757" class="Keyword">where</a>
  <a id="1765" class="Keyword">field</a>
    <a id="NameEnv.customNames"></a><a id="1775" href="Foreign.HaskellTypes.Deriving.html#1775" class="Field">customNames</a> <a id="1787" class="Symbol">:</a> <a id="1789" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1794" class="Symbol">(</a><a id="1795" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1800" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1802" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1808" class="Symbol">)</a>
    <a id="NameEnv.tName"></a><a id="1814" href="Foreign.HaskellTypes.Deriving.html#1814" class="Field">tName</a>       <a id="1826" class="Symbol">:</a> <a id="1828" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1833" class="Symbol">→</a> <a id="1835" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1841" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="NameEnv.cName"></a><a id="1852" href="Foreign.HaskellTypes.Deriving.html#1852" class="Field">cName</a>       <a id="1864" class="Symbol">:</a> <a id="1866" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1871" class="Symbol">→</a> <a id="1873" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1879" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="NameEnv.fName"></a><a id="1890" href="Foreign.HaskellTypes.Deriving.html#1890" class="Field">fName</a>       <a id="1902" class="Symbol">:</a> <a id="1904" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1909" class="Symbol">→</a> <a id="1911" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1917" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="1925" class="Keyword">private</a>
  <a id="mapHead"></a><a id="1935" href="Foreign.HaskellTypes.Deriving.html#1935" class="Function">mapHead</a> <a id="1943" class="Symbol">:</a> <a id="1945" class="Symbol">(</a><a id="1946" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a> <a id="1948" class="Symbol">→</a> <a id="1950" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a><a id="1951" class="Symbol">)</a> <a id="1953" class="Symbol">→</a> <a id="1955" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1960" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a> <a id="1962" class="Symbol">→</a> <a id="1964" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1969" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a>
  <a id="1973" href="Foreign.HaskellTypes.Deriving.html#1935" class="Function">mapHead</a> <a id="1981" href="Foreign.HaskellTypes.Deriving.html#1981" class="Bound">f</a> <a id="1983" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="1992" class="Symbol">=</a> <a id="1994" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="1999" href="Foreign.HaskellTypes.Deriving.html#1935" class="Function">mapHead</a> <a id="2007" href="Foreign.HaskellTypes.Deriving.html#2007" class="Bound">f</a> <a id="2009" class="Symbol">(</a><a id="2010" href="Foreign.HaskellTypes.Deriving.html#2010" class="Bound">x</a> <a id="2012" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2014" href="Foreign.HaskellTypes.Deriving.html#2014" class="Bound">xs</a><a id="2016" class="Symbol">)</a> <a id="2018" class="Symbol">=</a> <a id="2020" href="Foreign.HaskellTypes.Deriving.html#2007" class="Bound">f</a> <a id="2022" href="Foreign.HaskellTypes.Deriving.html#2010" class="Bound">x</a> <a id="2024" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2026" href="Foreign.HaskellTypes.Deriving.html#2014" class="Bound">xs</a>

<a id="capitalize"></a><a id="2030" href="Foreign.HaskellTypes.Deriving.html#2030" class="Function">capitalize</a> <a id="2041" class="Symbol">:</a> <a id="2043" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2050" class="Symbol">→</a> <a id="2052" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="2059" href="Foreign.HaskellTypes.Deriving.html#2030" class="Function">capitalize</a> <a id="2070" class="Symbol">=</a> <a id="2072" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="2088" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2090" href="Foreign.HaskellTypes.Deriving.html#1935" class="Function">mapHead</a> <a id="2098" href="Data.Char.Base.html#1115" class="Primitive">toUpper</a> <a id="2106" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2108" href="Data.String.Base.html#1558" class="Primitive">String.toList</a>

<a id="uncapitalize"></a><a id="2123" href="Foreign.HaskellTypes.Deriving.html#2123" class="Function">uncapitalize</a> <a id="2136" class="Symbol">:</a> <a id="2138" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2145" class="Symbol">→</a> <a id="2147" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="2154" href="Foreign.HaskellTypes.Deriving.html#2123" class="Function">uncapitalize</a> <a id="2167" class="Symbol">=</a> <a id="2169" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="2185" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2187" href="Foreign.HaskellTypes.Deriving.html#1935" class="Function">mapHead</a> <a id="2195" href="Data.Char.Base.html#1142" class="Primitive">toLower</a> <a id="2203" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2205" href="Data.String.Base.html#1558" class="Primitive">String.toList</a>

<a id="2220" class="Keyword">private</a>
  <a id="lookup"></a><a id="2230" href="Foreign.HaskellTypes.Deriving.html#2230" class="Function">lookup</a> <a id="2237" class="Symbol">:</a> <a id="2239" class="Symbol">⦃</a> <a id="2241" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="2247" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a> <a id="2249" class="Symbol">⦄</a> <a id="2251" class="Symbol">→</a> <a id="2253" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a> <a id="2255" class="Symbol">→</a> <a id="2257" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2262" class="Symbol">(</a><a id="2263" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a> <a id="2265" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2267" href="Foreign.HaskellTypes.Deriving.html#1674" class="Generalizable">B</a><a id="2268" class="Symbol">)</a> <a id="2270" class="Symbol">→</a> <a id="2272" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2278" href="Foreign.HaskellTypes.Deriving.html#1674" class="Generalizable">B</a>
  <a id="2282" href="Foreign.HaskellTypes.Deriving.html#2230" class="Function">lookup</a> <a id="2289" href="Foreign.HaskellTypes.Deriving.html#2289" class="Bound">x</a> <a id="2291" href="Foreign.HaskellTypes.Deriving.html#2291" class="Bound">xs</a> <a id="2294" class="Symbol">=</a> <a id="2296" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2302" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2306" href="Data.List.Base.html#13474" class="Function">findᵇ</a> <a id="2312" class="Symbol">((</a><a id="2314" href="Foreign.HaskellTypes.Deriving.html#2289" class="Bound">x</a> <a id="2316" href="Class.DecEq.Core.html#197" class="Function Operator">==_</a><a id="2319" class="Symbol">)</a> <a id="2321" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2323" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="2328" class="Symbol">)</a> <a id="2330" href="Foreign.HaskellTypes.Deriving.html#2291" class="Bound">xs</a>

  <a id="lookupEnv"></a><a id="2336" href="Foreign.HaskellTypes.Deriving.html#2336" class="Function">lookupEnv</a> <a id="2346" class="Symbol">:</a> <a id="2348" class="Symbol">(</a><a id="2349" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="2357" class="Symbol">→</a> <a id="2359" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2364" class="Symbol">→</a> <a id="2366" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2372" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2378" class="Symbol">)</a> <a id="2380" class="Symbol">→</a> <a id="2382" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="2390" class="Symbol">→</a> <a id="2392" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2397" class="Symbol">→</a> <a id="2399" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2405" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="2414" href="Foreign.HaskellTypes.Deriving.html#2336" class="Function">lookupEnv</a> <a id="2424" href="Foreign.HaskellTypes.Deriving.html#2424" class="Bound">fn</a> <a id="2427" href="Foreign.HaskellTypes.Deriving.html#2427" class="Bound">env</a> <a id="2431" href="Foreign.HaskellTypes.Deriving.html#2431" class="Bound">x</a> <a id="2433" class="Symbol">=</a> <a id="2435" href="Foreign.HaskellTypes.Deriving.html#2230" class="Function">lookup</a> <a id="2442" href="Foreign.HaskellTypes.Deriving.html#2431" class="Bound">x</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Foreign.HaskellTypes.Deriving.html#1775" class="Field">NameEnv.customNames</a> <a id="2465" href="Foreign.HaskellTypes.Deriving.html#2427" class="Bound">env</a><a id="2468" class="Symbol">)</a> <a id="2470" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="2474" href="Foreign.HaskellTypes.Deriving.html#2424" class="Bound">fn</a> <a id="2477" href="Foreign.HaskellTypes.Deriving.html#2427" class="Bound">env</a> <a id="2481" href="Foreign.HaskellTypes.Deriving.html#2431" class="Bound">x</a>

  <a id="lookupTypeName"></a><a id="2486" href="Foreign.HaskellTypes.Deriving.html#2486" class="Function">lookupTypeName</a>  <a id="2502" class="Symbol">=</a> <a id="2504" href="Foreign.HaskellTypes.Deriving.html#2336" class="Function">lookupEnv</a> <a id="2514" href="Foreign.HaskellTypes.Deriving.html#1814" class="Field">NameEnv.tName</a>
  <a id="lookupConName"></a><a id="2530" href="Foreign.HaskellTypes.Deriving.html#2530" class="Function">lookupConName</a>   <a id="2546" class="Symbol">=</a> <a id="2548" href="Foreign.HaskellTypes.Deriving.html#2336" class="Function">lookupEnv</a> <a id="2558" href="Foreign.HaskellTypes.Deriving.html#1852" class="Field">NameEnv.cName</a>
  <a id="lookupFieldName"></a><a id="2574" href="Foreign.HaskellTypes.Deriving.html#2574" class="Function">lookupFieldName</a> <a id="2590" class="Symbol">=</a> <a id="2592" href="Foreign.HaskellTypes.Deriving.html#2336" class="Function">lookupEnv</a> <a id="2602" href="Foreign.HaskellTypes.Deriving.html#1890" class="Field">NameEnv.fName</a>

  <a id="emptyEnv"></a><a id="2619" href="Foreign.HaskellTypes.Deriving.html#2619" class="Function">emptyEnv</a> <a id="2628" class="Symbol">:</a> <a id="2630" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
  <a id="2640" href="Foreign.HaskellTypes.Deriving.html#2619" class="Function">emptyEnv</a> <a id="2649" class="Symbol">=</a> <a id="2651" class="Keyword">record</a><a id="2657" class="Symbol">{</a> <a id="2659" href="Foreign.HaskellTypes.Deriving.html#1775" class="Field">customNames</a> <a id="2671" class="Symbol">=</a> <a id="2673" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                   <a id="2695" class="Symbol">;</a> <a id="2697" href="Foreign.HaskellTypes.Deriving.html#1814" class="Field">tName</a> <a id="2703" class="Symbol">=</a> <a id="2705" href="Function.Base.html#725" class="Function">const</a> <a id="2711" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2738" class="Symbol">;</a> <a id="2740" href="Foreign.HaskellTypes.Deriving.html#1852" class="Field">cName</a> <a id="2746" class="Symbol">=</a> <a id="2748" href="Function.Base.html#725" class="Function">const</a> <a id="2754" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2781" class="Symbol">;</a> <a id="2783" href="Foreign.HaskellTypes.Deriving.html#1890" class="Field">fName</a> <a id="2789" class="Symbol">=</a> <a id="2791" href="Function.Base.html#725" class="Function">const</a> <a id="2797" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2805" class="Symbol">}</a>

  <a id="customName"></a><a id="2810" href="Foreign.HaskellTypes.Deriving.html#2810" class="Function">customName</a> <a id="2821" class="Symbol">:</a> <a id="2823" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2828" class="Symbol">→</a> <a id="2830" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2837" class="Symbol">→</a> <a id="2839" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
  <a id="2849" href="Foreign.HaskellTypes.Deriving.html#2810" class="Function">customName</a> <a id="2860" href="Foreign.HaskellTypes.Deriving.html#2860" class="Bound">x</a> <a id="2862" href="Foreign.HaskellTypes.Deriving.html#2862" class="Bound">s</a> <a id="2864" class="Symbol">=</a> <a id="2866" class="Keyword">record</a> <a id="2873" href="Foreign.HaskellTypes.Deriving.html#2619" class="Function">emptyEnv</a> <a id="2882" class="Symbol">{</a> <a id="2884" href="Foreign.HaskellTypes.Deriving.html#1775" class="Field">customNames</a> <a id="2896" class="Symbol">=</a> <a id="2898" class="Symbol">(</a><a id="2899" href="Foreign.HaskellTypes.Deriving.html#2860" class="Bound">x</a> <a id="2901" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2903" href="Foreign.HaskellTypes.Deriving.html#2862" class="Bound">s</a><a id="2904" class="Symbol">)</a> <a id="2906" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2908" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2911" class="Symbol">}</a>

<a id="onTypes"></a><a id="2914" href="Foreign.HaskellTypes.Deriving.html#2914" class="Function">onTypes</a> <a id="2922" class="Symbol">:</a> <a id="2924" class="Symbol">(</a><a id="2925" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2932" class="Symbol">→</a> <a id="2934" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2940" class="Symbol">)</a> <a id="2942" class="Symbol">→</a> <a id="2944" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
<a id="2952" href="Foreign.HaskellTypes.Deriving.html#2914" class="Function">onTypes</a> <a id="2960" href="Foreign.HaskellTypes.Deriving.html#2960" class="Bound">f</a> <a id="2962" class="Symbol">=</a> <a id="2964" class="Keyword">record</a> <a id="2971" href="Foreign.HaskellTypes.Deriving.html#2619" class="Function">emptyEnv</a> <a id="2980" class="Symbol">{</a> <a id="2982" href="Foreign.HaskellTypes.Deriving.html#1814" class="Field">tName</a> <a id="2988" class="Symbol">=</a> <a id="2990" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2995" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2997" href="Foreign.HaskellTypes.Deriving.html#2960" class="Bound">f</a> <a id="2999" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3001" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="3010" class="Symbol">}</a>

<a id="onConstructors"></a><a id="3013" href="Foreign.HaskellTypes.Deriving.html#3013" class="Function">onConstructors</a> <a id="3028" class="Symbol">:</a> <a id="3030" class="Symbol">(</a><a id="3031" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3038" class="Symbol">→</a> <a id="3040" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3046" class="Symbol">)</a> <a id="3048" class="Symbol">→</a> <a id="3050" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
<a id="3058" href="Foreign.HaskellTypes.Deriving.html#3013" class="Function">onConstructors</a> <a id="3073" href="Foreign.HaskellTypes.Deriving.html#3073" class="Bound">f</a> <a id="3075" class="Symbol">=</a> <a id="3077" class="Keyword">record</a> <a id="3084" href="Foreign.HaskellTypes.Deriving.html#2619" class="Function">emptyEnv</a> <a id="3093" class="Symbol">{</a> <a id="3095" href="Foreign.HaskellTypes.Deriving.html#1852" class="Field">cName</a> <a id="3101" class="Symbol">=</a> <a id="3103" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3108" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3110" href="Foreign.HaskellTypes.Deriving.html#3073" class="Bound">f</a> <a id="3112" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3114" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="3123" class="Symbol">}</a>

<a id="withName"></a><a id="3126" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3135" class="Symbol">:</a> <a id="3137" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3144" class="Symbol">→</a> <a id="3146" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
<a id="3154" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3163" href="Foreign.HaskellTypes.Deriving.html#3163" class="Bound">t</a> <a id="3165" class="Symbol">=</a> <a id="3167" href="Foreign.HaskellTypes.Deriving.html#2914" class="Function">onTypes</a> <a id="3175" class="Symbol">(</a><a id="3176" href="Function.Base.html#725" class="Function">const</a> <a id="3182" href="Foreign.HaskellTypes.Deriving.html#3163" class="Bound">t</a><a id="3183" class="Symbol">)</a>

<a id="3186" class="Comment">-- Only use for single constructor types obviously</a>
<a id="withConstructor"></a><a id="3237" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3253" class="Symbol">:</a> <a id="3255" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3262" class="Symbol">→</a> <a id="3264" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
<a id="3272" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3288" href="Foreign.HaskellTypes.Deriving.html#3288" class="Bound">c</a> <a id="3290" class="Symbol">=</a> <a id="3292" href="Foreign.HaskellTypes.Deriving.html#3013" class="Function">onConstructors</a> <a id="3307" class="Symbol">(</a><a id="3308" href="Function.Base.html#725" class="Function">const</a> <a id="3314" href="Foreign.HaskellTypes.Deriving.html#3288" class="Bound">c</a><a id="3315" class="Symbol">)</a>

<a id="onFields"></a><a id="3318" href="Foreign.HaskellTypes.Deriving.html#3318" class="Function">onFields</a> <a id="3327" class="Symbol">:</a> <a id="3329" class="Symbol">(</a><a id="3330" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3337" class="Symbol">→</a> <a id="3339" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3345" class="Symbol">)</a> <a id="3347" class="Symbol">→</a> <a id="3349" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
<a id="3357" href="Foreign.HaskellTypes.Deriving.html#3318" class="Function">onFields</a> <a id="3366" href="Foreign.HaskellTypes.Deriving.html#3366" class="Bound">f</a> <a id="3368" class="Symbol">=</a> <a id="3370" class="Keyword">record</a> <a id="3377" href="Foreign.HaskellTypes.Deriving.html#2619" class="Function">emptyEnv</a> <a id="3386" class="Symbol">{</a> <a id="3388" href="Foreign.HaskellTypes.Deriving.html#1890" class="Field">fName</a> <a id="3394" class="Symbol">=</a> <a id="3396" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3401" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3403" href="Foreign.HaskellTypes.Deriving.html#3366" class="Bound">f</a> <a id="3405" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3407" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="3416" class="Symbol">}</a>

<a id="fieldPrefix"></a><a id="3419" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3431" class="Symbol">:</a> <a id="3433" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3440" class="Symbol">→</a> <a id="3442" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
<a id="3450" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3462" href="Foreign.HaskellTypes.Deriving.html#3462" class="Bound">pre</a> <a id="3466" class="Symbol">=</a> <a id="3468" href="Foreign.HaskellTypes.Deriving.html#3318" class="Function">onFields</a> <a id="3477" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3479" class="Symbol">(</a><a id="3480" href="Foreign.HaskellTypes.Deriving.html#3462" class="Bound">pre</a> <a id="3484" href="Data.String.Base.html#2425" class="Function Operator">String.++_</a><a id="3494" class="Symbol">)</a> <a id="3496" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3498" href="Foreign.HaskellTypes.Deriving.html#2030" class="Function">capitalize</a>

<a id="3510" class="Keyword">infixr</a> <a id="3517" class="Number">5</a> <a id="3519" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">_•_</a>
<a id="_•_"></a><a id="3523" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">_•_</a> <a id="3527" class="Symbol">:</a> <a id="3529" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="3537" class="Symbol">→</a> <a id="3539" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="3547" class="Symbol">→</a> <a id="3549" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a>
<a id="3557" href="Foreign.HaskellTypes.Deriving.html#3557" class="Bound">env</a> <a id="3561" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3563" href="Foreign.HaskellTypes.Deriving.html#3563" class="Bound">env₁</a> <a id="3568" class="Symbol">=</a> <a id="3570" class="Keyword">record</a>
  <a id="3579" class="Symbol">{</a> <a id="3581" href="Foreign.HaskellTypes.Deriving.html#1775" class="Field">customNames</a> <a id="3593" class="Symbol">=</a> <a id="3595" href="Foreign.HaskellTypes.Deriving.html#1775" class="Function">env.customNames</a> <a id="3611" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="3614" href="Foreign.HaskellTypes.Deriving.html#1775" class="Field">env₁.customNames</a>
  <a id="3633" class="Symbol">;</a> <a id="3635" href="Foreign.HaskellTypes.Deriving.html#1814" class="Field">tName</a>       <a id="3647" class="Symbol">=</a> <a id="3649" class="Symbol">λ</a> <a id="3651" href="Foreign.HaskellTypes.Deriving.html#3651" class="Bound">x</a> <a id="3653" class="Symbol">→</a> <a id="3655" href="Foreign.HaskellTypes.Deriving.html#1814" class="Function">env.tName</a> <a id="3665" href="Foreign.HaskellTypes.Deriving.html#3651" class="Bound">x</a> <a id="3667" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3671" href="Foreign.HaskellTypes.Deriving.html#1814" class="Field">env₁.tName</a> <a id="3682" href="Foreign.HaskellTypes.Deriving.html#3651" class="Bound">x</a>
  <a id="3686" class="Symbol">;</a> <a id="3688" href="Foreign.HaskellTypes.Deriving.html#1852" class="Field">cName</a>       <a id="3700" class="Symbol">=</a> <a id="3702" class="Symbol">λ</a> <a id="3704" href="Foreign.HaskellTypes.Deriving.html#3704" class="Bound">x</a> <a id="3706" class="Symbol">→</a> <a id="3708" href="Foreign.HaskellTypes.Deriving.html#1852" class="Function">env.cName</a> <a id="3718" href="Foreign.HaskellTypes.Deriving.html#3704" class="Bound">x</a> <a id="3720" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3724" href="Foreign.HaskellTypes.Deriving.html#1852" class="Field">env₁.cName</a> <a id="3735" href="Foreign.HaskellTypes.Deriving.html#3704" class="Bound">x</a>
  <a id="3739" class="Symbol">;</a> <a id="3741" href="Foreign.HaskellTypes.Deriving.html#1890" class="Field">fName</a>       <a id="3753" class="Symbol">=</a> <a id="3755" class="Symbol">λ</a> <a id="3757" href="Foreign.HaskellTypes.Deriving.html#3757" class="Bound">x</a> <a id="3759" class="Symbol">→</a> <a id="3761" href="Foreign.HaskellTypes.Deriving.html#1890" class="Function">env.fName</a> <a id="3771" href="Foreign.HaskellTypes.Deriving.html#3757" class="Bound">x</a> <a id="3773" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="3777" href="Foreign.HaskellTypes.Deriving.html#1890" class="Field">env₁.fName</a> <a id="3788" href="Foreign.HaskellTypes.Deriving.html#3757" class="Bound">x</a>
  <a id="3792" class="Symbol">}</a>
  <a id="3796" class="Keyword">where</a>
    <a id="3806" class="Keyword">module</a> <a id="3813" href="Foreign.HaskellTypes.Deriving.html#3813" class="Module">env</a>  <a id="3818" class="Symbol">=</a> <a id="3820" href="Foreign.HaskellTypes.Deriving.html#1743" class="Module">NameEnv</a> <a id="3828" href="Foreign.HaskellTypes.Deriving.html#3557" class="Bound">env</a>
    <a id="3836" class="Keyword">module</a> <a id="3843" href="Foreign.HaskellTypes.Deriving.html#3843" class="Module">env₁</a> <a id="3848" class="Symbol">=</a> <a id="3850" href="Foreign.HaskellTypes.Deriving.html#1743" class="Module">NameEnv</a> <a id="3858" href="Foreign.HaskellTypes.Deriving.html#3563" class="Bound">env₁</a>


<a id="3865" class="Comment">-- * The inner workings</a>

<a id="solveHsType"></a><a id="3890" href="Foreign.HaskellTypes.Deriving.html#3890" class="Function">solveHsType</a> <a id="3902" class="Symbol">:</a> <a id="3904" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3909" class="Symbol">→</a> <a id="3911" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="3914" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="3919" href="Foreign.HaskellTypes.Deriving.html#3890" class="Function">solveHsType</a> <a id="3931" href="Foreign.HaskellTypes.Deriving.html#3931" class="Bound">tm</a> <a id="3934" class="Symbol">=</a> <a id="3936" class="Keyword">do</a>
  <a id="3941" href="Foreign.HaskellTypes.Deriving.html#3941" class="Bound">hsTy</a> <a id="3946" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3948" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="3958" class="Symbol">(</a><a id="3959" class="Keyword">quote</a> <a id="3965" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3972" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="3975" href="Foreign.HaskellTypes.Deriving.html#3931" class="Bound">tm</a> <a id="3978" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="3979" class="Symbol">)</a> <a id="3981" href="Reflection.Syntax.html#3546" class="InductiveConstructor">`Set</a>
  <a id="3988" href="Agda.Builtin.Reflection.html#12129" class="Postulate">solveInstanceConstraints</a>
  <a id="4015" href="Agda.Builtin.Reflection.html#8972" class="Postulate">normalise</a> <a id="4025" href="Foreign.HaskellTypes.Deriving.html#3941" class="Bound">hsTy</a> <a id="4030" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="4034" class="Symbol">λ</a> <a id="4036" class="Keyword">where</a>
    <a id="4046" class="Symbol">(</a><a id="4047" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="4051" class="Symbol">(</a><a id="4052" class="Keyword">quote</a> <a id="4058" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a><a id="4064" class="Symbol">)</a> <a id="4066" class="Symbol">_)</a> <a id="4069" class="Symbol">→</a> <a id="4071" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="4084" class="String">&quot;Failed to solve HsType %t&quot;</a> <a id="4112" href="Foreign.HaskellTypes.Deriving.html#3931" class="Bound">tm</a>
    <a id="4119" href="Foreign.HaskellTypes.Deriving.html#4119" class="CatchallClause Bound">hsTy</a>                   <a id="4142" class="Symbol">→</a> <a id="4144" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="4151" href="Foreign.HaskellTypes.Deriving.html#4119" class="Bound">hsTy</a>

<a id="4157" class="Keyword">private</a>
  <a id="debug"></a><a id="4167" href="Foreign.HaskellTypes.Deriving.html#4167" class="Function">debug</a> <a id="4173" class="Symbol">=</a> <a id="4175" href="Reflection.TCM.Format.html#2726" class="Function">debugPrintFmt</a> <a id="4189" class="String">&quot;tactic.hs-types&quot;</a>

  <a id="_‼_"></a><a id="4210" href="Foreign.HaskellTypes.Deriving.html#4210" class="Function Operator">_‼_</a> <a id="4214" class="Symbol">:</a> <a id="4216" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4221" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a> <a id="4223" class="Symbol">→</a> <a id="4225" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4227" class="Symbol">→</a> <a id="4229" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4235" href="Foreign.HaskellTypes.Deriving.html#1672" class="Generalizable">A</a>
  <a id="4239" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="4248" href="Foreign.HaskellTypes.Deriving.html#4210" class="Function Operator">‼</a> <a id="4250" href="Foreign.HaskellTypes.Deriving.html#4250" class="Bound">i</a>     <a id="4256" class="Symbol">=</a> <a id="4258" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
  <a id="4268" class="Symbol">(</a><a id="4269" href="Foreign.HaskellTypes.Deriving.html#4269" class="Bound">x</a> <a id="4271" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4273" href="Foreign.HaskellTypes.Deriving.html#4273" class="Bound">xs</a><a id="4275" class="Symbol">)</a> <a id="4277" href="Foreign.HaskellTypes.Deriving.html#4210" class="Function Operator">‼</a> <a id="4279" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>  <a id="4285" class="Symbol">=</a> <a id="4287" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4292" href="Foreign.HaskellTypes.Deriving.html#4269" class="Bound">x</a>
  <a id="4296" class="Symbol">(</a><a id="4297" href="Foreign.HaskellTypes.Deriving.html#4297" class="Bound">x</a> <a id="4299" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4301" href="Foreign.HaskellTypes.Deriving.html#4301" class="Bound">xs</a><a id="4303" class="Symbol">)</a> <a id="4305" href="Foreign.HaskellTypes.Deriving.html#4210" class="Function Operator">‼</a> <a id="4307" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="4311" href="Foreign.HaskellTypes.Deriving.html#4311" class="Bound">i</a> <a id="4313" class="Symbol">=</a> <a id="4315" href="Foreign.HaskellTypes.Deriving.html#4301" class="Bound">xs</a> <a id="4318" href="Foreign.HaskellTypes.Deriving.html#4210" class="Function Operator">‼</a> <a id="4320" href="Foreign.HaskellTypes.Deriving.html#4311" class="Bound">i</a>

  <a id="specialHsTypes"></a><a id="4325" href="Foreign.HaskellTypes.Deriving.html#4325" class="Function">specialHsTypes</a> <a id="4340" class="Symbol">:</a> <a id="4342" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4347" class="Symbol">(</a><a id="4348" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4353" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4355" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="4361" class="Symbol">)</a>
  <a id="4365" href="Foreign.HaskellTypes.Deriving.html#4325" class="Function">specialHsTypes</a> <a id="4380" class="Symbol">=</a> <a id="4382" class="Symbol">(</a><a id="4383" class="Keyword">quote</a> <a id="4389" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>      <a id="4396" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4398" class="String">&quot;()&quot;</a><a id="4402" class="Symbol">)</a>
                 <a id="4421" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4423" class="Symbol">(</a><a id="4424" class="Keyword">quote</a> <a id="4430" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>      <a id="4437" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4439" class="String">&quot;Integer&quot;</a><a id="4448" class="Symbol">)</a>
                 <a id="4467" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4469" class="Symbol">(</a><a id="4470" class="Keyword">quote</a> <a id="4476" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>      <a id="4483" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4485" class="String">&quot;Integer&quot;</a><a id="4494" class="Symbol">)</a>
                 <a id="4513" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4515" class="Symbol">(</a><a id="4516" class="Keyword">quote</a> <a id="4522" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>   <a id="4529" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4531" class="String">&quot;Bool&quot;</a><a id="4537" class="Symbol">)</a>
                 <a id="4556" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4558" class="Symbol">(</a><a id="4559" class="Keyword">quote</a> <a id="4565" href="Agda.Builtin.List.html#147" class="Datatype">List</a>   <a id="4572" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4574" class="String">&quot;[]&quot;</a><a id="4578" class="Symbol">)</a>
                 <a id="4597" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4599" class="Symbol">(</a><a id="4600" class="Keyword">quote</a> <a id="4606" href="Foreign.Haskell.Pair.html#553" class="Record">Pair</a>   <a id="4613" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4615" class="String">&quot;(,)&quot;</a><a id="4620" class="Symbol">)</a>
                 <a id="4639" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4641" class="Symbol">(</a><a id="4642" class="Keyword">quote</a> <a id="4648" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="4655" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4657" class="String">&quot;Maybe&quot;</a><a id="4664" class="Symbol">)</a>
                 <a id="4683" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4685" class="Symbol">(</a><a id="4686" class="Keyword">quote</a> <a id="4692" href="Foreign.Haskell.Either.html#558" class="Datatype">Either</a> <a id="4699" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4701" class="String">&quot;Either&quot;</a><a id="4709" class="Symbol">)</a>
                 <a id="4728" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4730" class="Symbol">(</a><a id="4731" class="Keyword">quote</a> <a id="4737" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4744" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4746" class="String">&quot;Data.Text.Text&quot;</a><a id="4762" class="Symbol">)</a>
                 <a id="4781" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4783" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="hsTypeName"></a><a id="4789" href="Foreign.HaskellTypes.Deriving.html#4789" class="Function">hsTypeName</a> <a id="4800" class="Symbol">:</a> <a id="4802" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="4810" class="Symbol">→</a> <a id="4812" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4817" class="Symbol">→</a> <a id="4819" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="4828" href="Foreign.HaskellTypes.Deriving.html#4789" class="Function">hsTypeName</a> <a id="4839" href="Foreign.HaskellTypes.Deriving.html#4839" class="Bound">env</a> <a id="4843" href="Foreign.HaskellTypes.Deriving.html#4843" class="Bound">d</a> <a id="4845" class="Symbol">=</a> <a id="4847" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="4857" class="Symbol">(</a><a id="4858" href="Foreign.HaskellTypes.Deriving.html#2030" class="Function">capitalize</a> <a id="4869" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="4871" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="4880" href="Foreign.HaskellTypes.Deriving.html#4843" class="Bound">d</a><a id="4881" class="Symbol">)</a> <a id="4883" class="Symbol">(</a><a id="4884" href="Foreign.HaskellTypes.Deriving.html#2486" class="Function">lookupTypeName</a> <a id="4899" href="Foreign.HaskellTypes.Deriving.html#4839" class="Bound">env</a> <a id="4903" href="Foreign.HaskellTypes.Deriving.html#4843" class="Bound">d</a><a id="4904" class="Symbol">)</a>

  <a id="freshHsTypeName"></a><a id="4909" href="Foreign.HaskellTypes.Deriving.html#4909" class="Function">freshHsTypeName</a> <a id="4925" class="Symbol">:</a> <a id="4927" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="4935" class="Symbol">→</a> <a id="4937" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4942" class="Symbol">→</a> <a id="4944" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="4947" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="4954" href="Foreign.HaskellTypes.Deriving.html#4909" class="Function">freshHsTypeName</a> <a id="4970" href="Foreign.HaskellTypes.Deriving.html#4970" class="Bound">env</a> <a id="4974" href="Foreign.HaskellTypes.Deriving.html#4974" class="Bound">d</a> <a id="4976" class="Symbol">=</a> <a id="4978" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="4988" class="Symbol">(</a><a id="4989" href="Foreign.HaskellTypes.Deriving.html#4789" class="Function">hsTypeName</a> <a id="5000" href="Foreign.HaskellTypes.Deriving.html#4970" class="Bound">env</a> <a id="5004" href="Foreign.HaskellTypes.Deriving.html#4974" class="Bound">d</a><a id="5005" class="Symbol">)</a>

  <a id="hsConName"></a><a id="5010" href="Foreign.HaskellTypes.Deriving.html#5010" class="Function">hsConName</a> <a id="5020" class="Symbol">:</a> <a id="5022" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="5030" class="Symbol">→</a> <a id="5032" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5037" class="Symbol">→</a> <a id="5039" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="5048" href="Foreign.HaskellTypes.Deriving.html#5010" class="Function">hsConName</a> <a id="5058" href="Foreign.HaskellTypes.Deriving.html#5058" class="Bound">env</a> <a id="5062" href="Foreign.HaskellTypes.Deriving.html#5062" class="Bound">c</a> <a id="5064" class="Symbol">=</a> <a id="5066" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="5076" class="Symbol">(</a><a id="5077" href="Foreign.HaskellTypes.Deriving.html#2030" class="Function">capitalize</a> <a id="5088" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="5090" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="5099" href="Foreign.HaskellTypes.Deriving.html#5062" class="Bound">c</a><a id="5100" class="Symbol">)</a> <a id="5102" class="Symbol">(</a><a id="5103" href="Foreign.HaskellTypes.Deriving.html#2530" class="Function">lookupConName</a> <a id="5117" href="Foreign.HaskellTypes.Deriving.html#5058" class="Bound">env</a> <a id="5121" href="Foreign.HaskellTypes.Deriving.html#5062" class="Bound">c</a><a id="5122" class="Symbol">)</a>

  <a id="hsFieldName"></a><a id="5127" href="Foreign.HaskellTypes.Deriving.html#5127" class="Function">hsFieldName</a> <a id="5139" class="Symbol">:</a> <a id="5141" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="5149" class="Symbol">→</a> <a id="5151" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5156" class="Symbol">→</a> <a id="5158" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="5167" href="Foreign.HaskellTypes.Deriving.html#5127" class="Function">hsFieldName</a> <a id="5179" href="Foreign.HaskellTypes.Deriving.html#5179" class="Bound">env</a> <a id="5183" href="Foreign.HaskellTypes.Deriving.html#5183" class="Bound">f</a> <a id="5185" class="Symbol">=</a> <a id="5187" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="5197" class="Symbol">(</a><a id="5198" href="Foreign.HaskellTypes.Deriving.html#2123" class="Function">uncapitalize</a> <a id="5211" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="5213" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="5222" href="Foreign.HaskellTypes.Deriving.html#5183" class="Bound">f</a><a id="5223" class="Symbol">)</a> <a id="5225" class="Symbol">(</a><a id="5226" href="Foreign.HaskellTypes.Deriving.html#2574" class="Function">lookupFieldName</a> <a id="5242" href="Foreign.HaskellTypes.Deriving.html#5179" class="Bound">env</a> <a id="5246" href="Foreign.HaskellTypes.Deriving.html#5183" class="Bound">f</a><a id="5247" class="Symbol">)</a>

  <a id="freshHsConName"></a><a id="5252" href="Foreign.HaskellTypes.Deriving.html#5252" class="Function">freshHsConName</a> <a id="5267" class="Symbol">:</a> <a id="5269" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="5277" class="Symbol">→</a> <a id="5279" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5284" class="Symbol">→</a> <a id="5286" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5291" class="Symbol">→</a> <a id="5293" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5296" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="5303" href="Foreign.HaskellTypes.Deriving.html#5252" class="Function">freshHsConName</a> <a id="5318" href="Foreign.HaskellTypes.Deriving.html#5318" class="Bound">env</a> <a id="5322" href="Foreign.HaskellTypes.Deriving.html#5322" class="Bound">tyName</a> <a id="5329" href="Foreign.HaskellTypes.Deriving.html#5329" class="Bound">c</a> <a id="5331" class="Symbol">=</a>
    <a id="5337" href="Data.Bool.Base.html#1515" class="Function Operator">if</a> <a id="5340" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="5349" href="Foreign.HaskellTypes.Deriving.html#5329" class="Bound">c</a> <a id="5351" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5354" class="String">&quot;constructor&quot;</a>
    <a id="5372" href="Data.Bool.Base.html#1515" class="Function Operator">then</a> <a id="5377" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5387" class="Symbol">(</a><a id="5388" href="Foreign.HaskellTypes.Deriving.html#5010" class="Function">hsConName</a> <a id="5398" href="Foreign.HaskellTypes.Deriving.html#5318" class="Bound">env</a> <a id="5402" href="Foreign.HaskellTypes.Deriving.html#5322" class="Bound">tyName</a><a id="5408" class="Symbol">)</a> <a id="5410" class="Comment">-- Unnamed record constructor: use type name</a>
    <a id="5459" href="Data.Bool.Base.html#1515" class="Function Operator">else</a> <a id="5464" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5474" class="Symbol">(</a><a id="5475" href="Foreign.HaskellTypes.Deriving.html#5010" class="Function">hsConName</a> <a id="5485" href="Foreign.HaskellTypes.Deriving.html#5318" class="Bound">env</a> <a id="5489" href="Foreign.HaskellTypes.Deriving.html#5329" class="Bound">c</a><a id="5490" class="Symbol">)</a>

  <a id="isThis"></a><a id="5495" href="Foreign.HaskellTypes.Deriving.html#5495" class="Function">isThis</a> <a id="5502" class="Symbol">:</a> <a id="5504" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5509" class="Symbol">→</a> <a id="5511" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5516" class="Symbol">→</a> <a id="5518" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="5525" href="Foreign.HaskellTypes.Deriving.html#5495" class="Function">isThis</a> <a id="5532" href="Foreign.HaskellTypes.Deriving.html#5532" class="Bound">f</a> <a id="5534" class="Symbol">(</a><a id="5535" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="5539" href="Foreign.HaskellTypes.Deriving.html#5539" class="Bound">g</a> <a id="5541" class="Symbol">_)</a> <a id="5544" class="Symbol">=</a> <a id="5546" href="Foreign.HaskellTypes.Deriving.html#5532" class="Bound">f</a> <a id="5548" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5551" href="Foreign.HaskellTypes.Deriving.html#5539" class="Bound">g</a>
  <a id="5555" href="Foreign.HaskellTypes.Deriving.html#5495" class="CatchallClause Function">isThis</a><a id="5561" class="CatchallClause"> </a><a id="5562" class="CatchallClause Symbol">_</a><a id="5563" class="CatchallClause"> </a><a id="5564" class="CatchallClause Symbol">_</a> <a id="5566" class="Symbol">=</a> <a id="5568" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

  <a id="computeHsType"></a><a id="5577" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="5591" class="Symbol">:</a> <a id="5593" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5598" class="Symbol">→</a> <a id="5600" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5605" class="Symbol">→</a> <a id="5607" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5612" class="Symbol">→</a> <a id="5614" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5617" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="5624" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="5638" href="Foreign.HaskellTypes.Deriving.html#5638" class="Bound">aThis</a> <a id="5644" href="Foreign.HaskellTypes.Deriving.html#5644" class="Bound">hThis</a> <a id="5650" href="Foreign.HaskellTypes.Deriving.html#5650" class="Bound">tm</a> <a id="5653" class="Keyword">with</a> <a id="5658" href="Foreign.HaskellTypes.Deriving.html#5495" class="Function">isThis</a> <a id="5665" href="Foreign.HaskellTypes.Deriving.html#5638" class="Bound">aThis</a> <a id="5671" href="Foreign.HaskellTypes.Deriving.html#5650" class="Bound">tm</a>
  <a id="5676" class="Symbol">...</a> <a id="5680" class="Symbol">|</a> <a id="5682" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="5687" class="Symbol">=</a> <a id="5689" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5694" class="Symbol">(</a><a id="5695" class="Bound">hThis</a> <a id="5701" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a><a id="5702" class="Symbol">)</a>
  <a id="5706" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="5720" href="Foreign.HaskellTypes.Deriving.html#5720" class="Bound">aThis</a> <a id="5726" href="Foreign.HaskellTypes.Deriving.html#5726" class="Bound">hThis</a> <a id="5732" class="Symbol">(</a><a id="5733" href="Reflection.AST.Term.html#2159" class="InductiveConstructor Operator">Π[</a> <a id="5736" href="Foreign.HaskellTypes.Deriving.html#5736" class="Bound">x</a> <a id="5738" href="Reflection.AST.Term.html#2159" class="InductiveConstructor Operator">∶</a> <a id="5740" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="5744" class="Symbol">(</a><a id="5745" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">arg-info</a> <a id="5754" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="5762" class="Symbol">_)</a> <a id="5765" href="Foreign.HaskellTypes.Deriving.html#5765" class="Bound">a</a> <a id="5767" href="Reflection.AST.Term.html#2159" class="InductiveConstructor Operator">]</a> <a id="5769" href="Foreign.HaskellTypes.Deriving.html#5769" class="Bound">b</a><a id="5770" class="Symbol">)</a> <a id="5772" class="Symbol">|</a> <a id="5774" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="5780" class="Symbol">=</a> <a id="5782" class="Keyword">do</a>
    <a id="5789" href="Foreign.HaskellTypes.Deriving.html#5789" class="Bound">dom</a> <a id="5793" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="5795" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="5809" href="Foreign.HaskellTypes.Deriving.html#5720" class="Bound">aThis</a> <a id="5815" href="Foreign.HaskellTypes.Deriving.html#5726" class="Bound">hThis</a> <a id="5821" href="Foreign.HaskellTypes.Deriving.html#5765" class="Bound">a</a>
    <a id="5827" href="Foreign.HaskellTypes.Deriving.html#5827" class="Bound">rng</a> <a id="5831" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="5833" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="5847" href="Foreign.HaskellTypes.Deriving.html#5736" class="Bound">x</a> <a id="5849" class="Symbol">(</a><a id="5850" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="5855" href="Foreign.HaskellTypes.Deriving.html#5765" class="Bound">a</a><a id="5856" class="Symbol">)</a> <a id="5858" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="5860" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="5874" href="Foreign.HaskellTypes.Deriving.html#5720" class="Bound">aThis</a> <a id="5880" href="Foreign.HaskellTypes.Deriving.html#5726" class="Bound">hThis</a> <a id="5886" href="Foreign.HaskellTypes.Deriving.html#5769" class="Bound">b</a>
    <a id="5892" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5897" class="Symbol">(</a><a id="5898" href="Reflection.AST.Term.html#2204" class="InductiveConstructor Operator">vΠ[</a> <a id="5902" href="Foreign.HaskellTypes.Deriving.html#5736" class="Bound">x</a> <a id="5904" href="Reflection.AST.Term.html#2204" class="InductiveConstructor Operator">∶</a> <a id="5906" href="Foreign.HaskellTypes.Deriving.html#5789" class="Bound">dom</a> <a id="5910" href="Reflection.AST.Term.html#2204" class="InductiveConstructor Operator">]</a> <a id="5912" href="Foreign.HaskellTypes.Deriving.html#5827" class="Bound">rng</a><a id="5915" class="Symbol">)</a>
  <a id="5919" href="Foreign.HaskellTypes.Deriving.html#5577" class="CatchallClause Function">computeHsType</a><a id="5932" class="CatchallClause"> </a><a id="5933" href="Foreign.HaskellTypes.Deriving.html#5933" class="CatchallClause Bound">aThis</a><a id="5938" class="CatchallClause"> </a><a id="5939" href="Foreign.HaskellTypes.Deriving.html#5939" class="CatchallClause Bound">hThis</a><a id="5944" class="CatchallClause"> </a><a id="5945" class="CatchallClause Symbol">(</a><a id="5946" href="Reflection.AST.Term.html#2159" class="CatchallClause InductiveConstructor Operator">Π[</a><a id="5948" class="CatchallClause"> </a><a id="5949" href="Foreign.HaskellTypes.Deriving.html#5949" class="CatchallClause Bound">x</a><a id="5950" class="CatchallClause"> </a><a id="5951" href="Reflection.AST.Term.html#2159" class="CatchallClause InductiveConstructor Operator">∶</a><a id="5952" class="CatchallClause"> </a><a id="5953" href="Foreign.HaskellTypes.Deriving.html#5953" class="CatchallClause Bound">a</a><a id="5954" class="CatchallClause"> </a><a id="5955" href="Reflection.AST.Term.html#2159" class="CatchallClause InductiveConstructor Operator">]</a><a id="5956" class="CatchallClause"> </a><a id="5957" href="Foreign.HaskellTypes.Deriving.html#5957" class="CatchallClause Bound">b</a><a id="5958" class="CatchallClause Symbol">)</a><a id="5959" class="CatchallClause"> </a><a id="5960" class="CatchallClause Symbol">|</a><a id="5961" class="CatchallClause"> </a><a id="5962" href="Agda.Builtin.Bool.html#192" class="CatchallClause InductiveConstructor">false</a> <a id="5968" class="Symbol">=</a> <a id="5970" class="Keyword">do</a>
    <a id="5977" href="Foreign.HaskellTypes.Deriving.html#5977" class="Bound">ty</a> <a id="5980" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="5982" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="5996" href="Foreign.HaskellTypes.Deriving.html#5949" class="Bound">x</a> <a id="5998" href="Foreign.HaskellTypes.Deriving.html#5953" class="Bound">a</a> <a id="6000" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="6002" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="6016" href="Foreign.HaskellTypes.Deriving.html#5933" class="Bound">aThis</a> <a id="6022" href="Foreign.HaskellTypes.Deriving.html#5939" class="Bound">hThis</a> <a id="6028" href="Foreign.HaskellTypes.Deriving.html#5957" class="Bound">b</a>
    <a id="6034" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6039" href="Foreign.HaskellTypes.Deriving.html#6039" class="Bound">ty′</a> <a id="6043" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6045" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6050" class="Symbol">(</a><a id="6051" href="Reflection.AST.DeBruijn.html#3451" class="Function">strengthen</a> <a id="6062" href="Foreign.HaskellTypes.Deriving.html#5977" class="Bound">ty</a><a id="6064" class="Symbol">)</a>
      <a id="6072" class="Keyword">where</a> <a id="6078" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6086" class="Symbol">→</a> <a id="6088" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="6102" href="Foreign.HaskellTypes.Deriving.html#5949" class="Bound">x</a> <a id="6104" href="Foreign.HaskellTypes.Deriving.html#5953" class="Bound">a</a> <a id="6106" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="6108" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="6121" class="String">&quot;%s free in computed HsType %t&quot;</a> <a id="6153" href="Foreign.HaskellTypes.Deriving.html#5949" class="Bound">x</a> <a id="6155" href="Foreign.HaskellTypes.Deriving.html#5977" class="Bound">ty</a>
    <a id="6162" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6167" href="Foreign.HaskellTypes.Deriving.html#6039" class="Bound">ty′</a>
  <a id="6173" class="Comment">-- Hack to get recursive occurrences under lists to work</a>
  <a id="6232" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="6246" href="Foreign.HaskellTypes.Deriving.html#6246" class="Bound">aThis</a> <a id="6252" href="Foreign.HaskellTypes.Deriving.html#6252" class="Bound">hThis</a> <a id="6258" class="Symbol">(</a><a id="6259" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6263" class="Symbol">(</a><a id="6264" class="Keyword">quote</a> <a id="6270" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="6274" class="Symbol">)</a> <a id="6276" class="Symbol">(_</a> <a id="6279" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6281" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="6286" href="Foreign.HaskellTypes.Deriving.html#6286" class="Bound">a</a> <a id="6288" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6290" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6292" class="Symbol">))</a> <a id="6295" class="Symbol">|</a> <a id="6297" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="6303" class="Symbol">=</a> <a id="6305" class="Keyword">do</a>
    <a id="6312" href="Foreign.HaskellTypes.Deriving.html#6312" class="Bound">ty</a> <a id="6315" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6317" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="6331" href="Foreign.HaskellTypes.Deriving.html#6246" class="Bound">aThis</a> <a id="6337" href="Foreign.HaskellTypes.Deriving.html#6252" class="Bound">hThis</a> <a id="6343" href="Foreign.HaskellTypes.Deriving.html#6286" class="Bound">a</a>
    <a id="6349" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6354" class="Symbol">(</a><a id="6355" class="Keyword">quote</a> <a id="6361" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6366" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="6369" href="Foreign.HaskellTypes.Deriving.html#6312" class="Bound">ty</a> <a id="6372" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="6373" class="Symbol">)</a>
  <a id="6377" href="Foreign.HaskellTypes.Deriving.html#5577" class="CatchallClause Function">computeHsType</a><a id="6390" class="CatchallClause"> </a><a id="6391" class="CatchallClause Symbol">_</a><a id="6392" class="CatchallClause"> </a><a id="6393" class="CatchallClause Symbol">_</a><a id="6394" class="CatchallClause"> </a><a id="6395" href="Foreign.HaskellTypes.Deriving.html#6395" class="CatchallClause Bound">tm</a><a id="6397" class="CatchallClause"> </a><a id="6398" class="CatchallClause Symbol">|</a><a id="6399" class="CatchallClause"> </a><a id="6400" href="Agda.Builtin.Bool.html#192" class="CatchallClause InductiveConstructor">false</a> <a id="6406" class="Symbol">=</a> <a id="6408" class="Keyword">do</a>
    <a id="6415" href="Foreign.HaskellTypes.Deriving.html#4167" class="Function">debug</a> <a id="6421" class="Number">10</a> <a id="6424" class="String">&quot;solving HsType %t&quot;</a> <a id="6444" href="Foreign.HaskellTypes.Deriving.html#6395" class="Bound">tm</a>
    <a id="6451" href="Foreign.HaskellTypes.Deriving.html#6451" class="Bound">ty</a> <a id="6454" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6456" href="Foreign.HaskellTypes.Deriving.html#3890" class="Function">solveHsType</a> <a id="6468" href="Foreign.HaskellTypes.Deriving.html#6395" class="Bound">tm</a>
    <a id="6475" href="Foreign.HaskellTypes.Deriving.html#4167" class="Function">debug</a> <a id="6481" class="Number">10</a> <a id="6484" class="String">&quot;HsType %t = %t&quot;</a> <a id="6501" href="Foreign.HaskellTypes.Deriving.html#6395" class="Bound">tm</a> <a id="6504" href="Foreign.HaskellTypes.Deriving.html#6451" class="Bound">ty</a>
    <a id="6511" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6516" href="Foreign.HaskellTypes.Deriving.html#6451" class="Bound">ty</a>

  <a id="makeHsCon"></a><a id="6522" href="Foreign.HaskellTypes.Deriving.html#6522" class="Function">makeHsCon</a> <a id="6532" class="Symbol">:</a> <a id="6534" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="6542" class="Symbol">→</a> <a id="6544" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6549" class="Symbol">→</a> <a id="6551" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6556" class="Symbol">→</a> <a id="6558" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6563" class="Symbol">→</a> <a id="6565" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="6568" class="Symbol">(</a><a id="6569" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6574" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6576" href="Agda.Builtin.Reflection.html#3207" class="Datatype">Agda.Builtin.Reflection.Quantity</a> <a id="6609" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6611" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="6615" class="Symbol">)</a>
  <a id="6619" href="Foreign.HaskellTypes.Deriving.html#6522" class="Function">makeHsCon</a> <a id="6629" href="Foreign.HaskellTypes.Deriving.html#6629" class="Bound">env</a> <a id="6633" href="Foreign.HaskellTypes.Deriving.html#6633" class="Bound">agdaName</a> <a id="6642" href="Foreign.HaskellTypes.Deriving.html#6642" class="Bound">hsName</a> <a id="6649" href="Foreign.HaskellTypes.Deriving.html#6649" class="Bound">c</a> <a id="6651" class="Symbol">=</a> <a id="6653" class="Keyword">do</a>
    <a id="6660" href="Foreign.HaskellTypes.Deriving.html#4167" class="Function">debug</a> <a id="6666" class="Number">10</a> <a id="6669" class="String">&quot;Making constructor %q : %q&quot;</a> <a id="6698" href="Foreign.HaskellTypes.Deriving.html#6649" class="Bound">c</a> <a id="6700" href="Foreign.HaskellTypes.Deriving.html#6633" class="Bound">agdaName</a>
    <a id="6713" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6717" href="Foreign.HaskellTypes.Deriving.html#6717" class="Bound">agdaName&#39;</a> <a id="6727" class="Symbol">_</a> <a id="6729" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6731" href="Agda.Builtin.Reflection.html#8972" class="Postulate">normalise</a> <a id="6741" class="Symbol">(</a><a id="6742" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6746" href="Foreign.HaskellTypes.Deriving.html#6633" class="Bound">agdaName</a> <a id="6755" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6757" class="Symbol">)</a>
      <a id="6765" class="Keyword">where</a> <a id="6771" class="CatchallClause Symbol">_</a> <a id="6773" class="Symbol">→</a> <a id="6775" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="6788" class="String">&quot;Failed to compute source type for %q&quot;</a> <a id="6827" href="Foreign.HaskellTypes.Deriving.html#6633" class="Bound">agdaName</a>
    <a id="6840" href="Foreign.HaskellTypes.Deriving.html#6840" class="Bound">hsC</a>  <a id="6845" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6847" href="Foreign.HaskellTypes.Deriving.html#5252" class="Function">freshHsConName</a> <a id="6862" href="Foreign.HaskellTypes.Deriving.html#6629" class="Bound">env</a> <a id="6866" href="Foreign.HaskellTypes.Deriving.html#6642" class="Bound">hsName</a> <a id="6873" href="Foreign.HaskellTypes.Deriving.html#6649" class="Bound">c</a>
    <a id="6879" href="Foreign.HaskellTypes.Deriving.html#6879" class="Bound">cTy</a>  <a id="6884" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6886" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="6894" href="Foreign.HaskellTypes.Deriving.html#6649" class="Bound">c</a>
    <a id="6900" href="Foreign.HaskellTypes.Deriving.html#4167" class="Function">debug</a> <a id="6906" class="Number">10</a> <a id="6909" class="String">&quot;cTy = %t&quot;</a> <a id="6920" href="Foreign.HaskellTypes.Deriving.html#6879" class="Bound">cTy</a>
    <a id="6928" href="Foreign.HaskellTypes.Deriving.html#6928" class="Bound">hsTy</a> <a id="6933" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6935" href="Foreign.HaskellTypes.Deriving.html#5577" class="Function">computeHsType</a> <a id="6949" href="Foreign.HaskellTypes.Deriving.html#6717" class="Bound">agdaName&#39;</a> <a id="6959" href="Foreign.HaskellTypes.Deriving.html#6642" class="Bound">hsName</a> <a id="6966" href="Foreign.HaskellTypes.Deriving.html#6879" class="Bound">cTy</a>
    <a id="6974" href="Foreign.HaskellTypes.Deriving.html#4167" class="Function">debug</a> <a id="6980" class="Number">10</a> <a id="6983" class="String">&quot;hsTy = %t&quot;</a> <a id="6995" href="Foreign.HaskellTypes.Deriving.html#6928" class="Bound">hsTy</a>
    <a id="7004" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="7009" class="Symbol">(</a><a id="7010" href="Foreign.HaskellTypes.Deriving.html#6840" class="Bound">hsC</a> <a id="7014" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7016" href="Agda.Builtin.Reflection.html#3241" class="InductiveConstructor">quantity-ω</a> <a id="7027" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7029" href="Foreign.HaskellTypes.Deriving.html#6928" class="Bound">hsTy</a><a id="7033" class="Symbol">)</a>

  <a id="makeHsData"></a><a id="7038" href="Foreign.HaskellTypes.Deriving.html#7038" class="Function">makeHsData</a> <a id="7049" class="Symbol">:</a> <a id="7051" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="7059" class="Symbol">→</a> <a id="7061" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7066" class="Symbol">→</a> <a id="7068" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7070" class="Symbol">→</a> <a id="7072" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7077" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7082" class="Symbol">→</a> <a id="7084" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="7087" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="7094" href="Foreign.HaskellTypes.Deriving.html#7038" class="Function">makeHsData</a> <a id="7105" href="Foreign.HaskellTypes.Deriving.html#7105" class="Bound">env</a> <a id="7109" href="Foreign.HaskellTypes.Deriving.html#7109" class="Bound">agdaName</a> <a id="7118" href="Foreign.HaskellTypes.Deriving.html#7118" class="Bound">nPars</a> <a id="7124" href="Foreign.HaskellTypes.Deriving.html#7124" class="Bound">constrs</a> <a id="7132" class="Symbol">=</a> <a id="7134" class="Keyword">do</a>
    <a id="7141" href="Foreign.HaskellTypes.Deriving.html#7141" class="Bound">hsName</a> <a id="7148" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7150" href="Foreign.HaskellTypes.Deriving.html#4909" class="Function">freshHsTypeName</a> <a id="7166" href="Foreign.HaskellTypes.Deriving.html#7105" class="Bound">env</a> <a id="7170" href="Foreign.HaskellTypes.Deriving.html#7109" class="Bound">agdaName</a>
    <a id="7183" href="Agda.Builtin.Reflection.html#9556" class="Postulate">declareData</a> <a id="7195" href="Foreign.HaskellTypes.Deriving.html#7141" class="Bound">hsName</a> <a id="7202" class="Number">0</a> <a id="7204" href="Reflection.Syntax.html#3546" class="InductiveConstructor">`Set</a>
    <a id="7213" href="Foreign.HaskellTypes.Deriving.html#7213" class="Bound">hsCons</a> <a id="7220" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7222" href="Class.Monad.Core.html#832" class="Function">mapM</a> <a id="7227" class="Symbol">(</a><a id="7228" href="Foreign.HaskellTypes.Deriving.html#6522" class="Function">makeHsCon</a> <a id="7238" href="Foreign.HaskellTypes.Deriving.html#7105" class="Bound">env</a> <a id="7242" href="Foreign.HaskellTypes.Deriving.html#7109" class="Bound">agdaName</a> <a id="7251" href="Foreign.HaskellTypes.Deriving.html#7141" class="Bound">hsName</a><a id="7257" class="Symbol">)</a> <a id="7259" href="Foreign.HaskellTypes.Deriving.html#7124" class="Bound">constrs</a>
    <a id="7271" href="Agda.Builtin.Reflection.html#9602" class="Postulate">defineData</a> <a id="7282" href="Foreign.HaskellTypes.Deriving.html#7141" class="Bound">hsName</a> <a id="7289" href="Foreign.HaskellTypes.Deriving.html#7213" class="Bound">hsCons</a>
    <a id="7300" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="7305" href="Foreign.HaskellTypes.Deriving.html#7141" class="Bound">hsName</a>

  <a id="makeHsType"></a><a id="7315" href="Foreign.HaskellTypes.Deriving.html#7315" class="Function">makeHsType</a> <a id="7326" class="Symbol">:</a> <a id="7328" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="7336" class="Symbol">→</a> <a id="7338" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7343" class="Symbol">→</a> <a id="7345" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="7348" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="7355" href="Foreign.HaskellTypes.Deriving.html#7315" class="Function">makeHsType</a> <a id="7366" href="Foreign.HaskellTypes.Deriving.html#7366" class="Bound">env</a> <a id="7370" href="Foreign.HaskellTypes.Deriving.html#7370" class="Bound">d</a> <a id="7372" class="Symbol">=</a> <a id="7374" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="7388" href="Foreign.HaskellTypes.Deriving.html#7370" class="Bound">d</a> <a id="7390" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="7394" class="Symbol">λ</a> <a id="7396" class="Keyword">where</a>
      <a id="7408" class="Symbol">(</a><a id="7409" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="7419" href="Foreign.HaskellTypes.Deriving.html#7419" class="Bound">pars</a> <a id="7424" href="Foreign.HaskellTypes.Deriving.html#7424" class="Bound">cs</a><a id="7426" class="Symbol">)</a> <a id="7428" class="Symbol">→</a> <a id="7430" href="Foreign.HaskellTypes.Deriving.html#7038" class="Function">makeHsData</a> <a id="7441" href="Foreign.HaskellTypes.Deriving.html#7366" class="Bound">env</a> <a id="7445" href="Foreign.HaskellTypes.Deriving.html#7370" class="Bound">d</a> <a id="7447" href="Foreign.HaskellTypes.Deriving.html#7419" class="Bound">pars</a> <a id="7452" href="Foreign.HaskellTypes.Deriving.html#7424" class="Bound">cs</a>
      <a id="7461" class="Symbol">(</a><a id="7462" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="7474" href="Foreign.HaskellTypes.Deriving.html#7474" class="Bound">c</a> <a id="7476" href="Foreign.HaskellTypes.Deriving.html#7476" class="Bound">fs</a><a id="7478" class="Symbol">)</a>  <a id="7481" class="Symbol">→</a> <a id="7483" href="Foreign.HaskellTypes.Deriving.html#7038" class="Function">makeHsData</a> <a id="7494" href="Foreign.HaskellTypes.Deriving.html#7366" class="Bound">env</a> <a id="7498" href="Foreign.HaskellTypes.Deriving.html#7370" class="Bound">d</a> <a id="7500" class="Number">0</a> <a id="7502" class="Symbol">(</a><a id="7503" href="Foreign.HaskellTypes.Deriving.html#7474" class="Bound">c</a> <a id="7505" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7507" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7509" class="Symbol">)</a>
      <a id="7517" class="CatchallClause Symbol">_</a>                   <a id="7537" class="Symbol">→</a> <a id="7539" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="7552" class="String">&quot;%q is not a data or record type&quot;</a> <a id="7586" href="Foreign.HaskellTypes.Deriving.html#7370" class="Bound">d</a>

  <a id="joinStrings"></a><a id="7591" href="Foreign.HaskellTypes.Deriving.html#7591" class="Function">joinStrings</a> <a id="7603" class="Symbol">:</a> <a id="7605" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7612" class="Symbol">→</a> <a id="7614" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7619" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7626" class="Symbol">→</a> <a id="7628" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7637" href="Foreign.HaskellTypes.Deriving.html#7591" class="Function">joinStrings</a> <a id="7649" href="Foreign.HaskellTypes.Deriving.html#7649" class="Bound">sep</a> <a id="7653" href="Foreign.HaskellTypes.Deriving.html#7653" class="Bound">ss</a> <a id="7656" class="Symbol">=</a> <a id="7658" href="Data.List.Base.html#4126" class="Function">foldr</a> <a id="7664" href="Foreign.HaskellTypes.Deriving.html#705" class="Function Operator">_&amp;_</a> <a id="7668" class="String">&quot;&quot;</a> <a id="7671" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="7673" href="Data.List.Base.html#1797" class="Function">intersperse</a> <a id="7685" href="Foreign.HaskellTypes.Deriving.html#7649" class="Bound">sep</a> <a id="7689" href="Foreign.HaskellTypes.Deriving.html#7653" class="Bound">ss</a>

  <a id="compilePragma"></a><a id="7695" href="Foreign.HaskellTypes.Deriving.html#7695" class="Function">compilePragma</a> <a id="7709" class="Symbol">:</a> <a id="7711" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7716" class="Symbol">→</a> <a id="7718" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7723" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7728" class="Symbol">→</a> <a id="7730" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7739" href="Foreign.HaskellTypes.Deriving.html#7695" class="Function">compilePragma</a> <a id="7753" href="Foreign.HaskellTypes.Deriving.html#7753" class="Bound">d</a> <a id="7755" href="Foreign.HaskellTypes.Deriving.html#7755" class="Bound">cs</a> <a id="7758" class="Symbol">=</a> <a id="7760" href="Text.Printf.html#1015" class="Function">printf</a> <a id="7767" class="String">&quot;= data %s (%s)&quot;</a> <a id="7784" class="Symbol">(</a><a id="7785" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="7794" href="Foreign.HaskellTypes.Deriving.html#7753" class="Bound">d</a><a id="7795" class="Symbol">)</a> <a id="7797" class="Symbol">(</a><a id="7798" href="Foreign.HaskellTypes.Deriving.html#7591" class="Function">joinStrings</a> <a id="7810" class="String">&quot; | &quot;</a> <a id="7816" class="Symbol">(</a><a id="7817" href="Data.List.Base.html#1612" class="Function">map</a> <a id="7821" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="7830" href="Foreign.HaskellTypes.Deriving.html#7755" class="Bound">cs</a><a id="7832" class="Symbol">))</a>

  <a id="renderHsTypeName"></a><a id="7838" href="Foreign.HaskellTypes.Deriving.html#7838" class="Function">renderHsTypeName</a> <a id="7855" class="Symbol">:</a> <a id="7857" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7862" class="Symbol">→</a> <a id="7864" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7873" href="Foreign.HaskellTypes.Deriving.html#7838" class="Function">renderHsTypeName</a> <a id="7890" href="Foreign.HaskellTypes.Deriving.html#7890" class="Bound">d</a> <a id="7892" class="Symbol">=</a> <a id="7894" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="7904" class="Symbol">(</a><a id="7905" class="String">&quot;MAlonzo.Code.&quot;</a> <a id="7921" href="Data.String.Base.html#2425" class="Function Operator">String.++</a> <a id="7931" href="Reflection.AST.Show.html#1581" class="Primitive">R.showName</a> <a id="7942" href="Foreign.HaskellTypes.Deriving.html#7890" class="Bound">d</a><a id="7943" class="Symbol">)</a> <a id="7945" class="Symbol">(</a><a id="7946" href="Foreign.HaskellTypes.Deriving.html#2230" class="Function">lookup</a> <a id="7953" href="Foreign.HaskellTypes.Deriving.html#7890" class="Bound">d</a> <a id="7955" href="Foreign.HaskellTypes.Deriving.html#4325" class="Function">specialHsTypes</a><a id="7969" class="Symbol">)</a>

  <a id="renderHsType"></a><a id="7974" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="7987" class="Symbol">:</a> <a id="7989" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="7994" class="Symbol">→</a> <a id="7996" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="renderHsArgs"></a><a id="8005" href="Foreign.HaskellTypes.Deriving.html#8005" class="Function">renderHsArgs</a> <a id="8018" class="Symbol">:</a> <a id="8020" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8025" class="Symbol">(</a><a id="8026" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="8030" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="8034" class="Symbol">)</a> <a id="8036" class="Symbol">→</a> <a id="8038" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8043" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

  <a id="8053" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="8066" class="Symbol">(</a><a id="8067" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8071" class="Symbol">(</a><a id="8072" class="Keyword">quote</a> <a id="8078" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="8082" class="Symbol">)</a> <a id="8084" class="Symbol">(_</a> <a id="8087" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8089" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="8094" href="Foreign.HaskellTypes.Deriving.html#8094" class="Bound">a</a> <a id="8096" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8098" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8100" class="Symbol">))</a> <a id="8103" class="Symbol">=</a> <a id="8105" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8112" class="String">&quot;[%s]&quot;</a> <a id="8119" class="Symbol">(</a><a id="8120" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="8133" href="Foreign.HaskellTypes.Deriving.html#8094" class="Bound">a</a><a id="8134" class="Symbol">)</a>
  <a id="8138" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="8151" class="Symbol">(</a><a id="8152" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8156" class="Symbol">(</a><a id="8157" class="Keyword">quote</a> <a id="8163" href="Foreign.Haskell.Pair.html#553" class="Record">Pair</a><a id="8167" class="Symbol">)</a> <a id="8169" class="Symbol">(_</a> <a id="8172" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8174" class="Symbol">_</a> <a id="8176" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8178" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="8183" href="Foreign.HaskellTypes.Deriving.html#8183" class="Bound">a</a> <a id="8185" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8187" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="8192" href="Foreign.HaskellTypes.Deriving.html#8192" class="Bound">b</a> <a id="8194" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8196" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8198" class="Symbol">))</a> <a id="8201" class="Symbol">=</a> <a id="8203" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8210" class="String">&quot;(%s, %s)&quot;</a> <a id="8221" class="Symbol">(</a><a id="8222" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="8235" href="Foreign.HaskellTypes.Deriving.html#8183" class="Bound">a</a><a id="8236" class="Symbol">)</a> <a id="8238" class="Symbol">(</a><a id="8239" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="8252" href="Foreign.HaskellTypes.Deriving.html#8192" class="Bound">b</a><a id="8253" class="Symbol">)</a>
  <a id="8257" href="Foreign.HaskellTypes.Deriving.html#7974" class="CatchallClause Function">renderHsType</a><a id="8269" class="CatchallClause"> </a><a id="8270" class="CatchallClause Symbol">(</a><a id="8271" href="Agda.Builtin.Reflection.html#5251" class="CatchallClause InductiveConstructor">def</a><a id="8274" class="CatchallClause"> </a><a id="8275" href="Foreign.HaskellTypes.Deriving.html#8275" class="CatchallClause Bound">d</a><a id="8276" class="CatchallClause"> </a><a id="8277" href="Agda.Builtin.List.html#184" class="CatchallClause InductiveConstructor">[]</a><a id="8279" class="CatchallClause Symbol">)</a> <a id="8281" class="Symbol">=</a> <a id="8283" href="Foreign.HaskellTypes.Deriving.html#7838" class="Function">renderHsTypeName</a> <a id="8300" href="Foreign.HaskellTypes.Deriving.html#8275" class="Bound">d</a>
  <a id="8304" href="Foreign.HaskellTypes.Deriving.html#7974" class="CatchallClause Function">renderHsType</a><a id="8316" class="CatchallClause"> </a><a id="8317" class="CatchallClause Symbol">(</a><a id="8318" href="Agda.Builtin.Reflection.html#5251" class="CatchallClause InductiveConstructor">def</a><a id="8321" class="CatchallClause"> </a><a id="8322" href="Foreign.HaskellTypes.Deriving.html#8322" class="CatchallClause Bound">d</a><a id="8323" class="CatchallClause"> </a><a id="8324" href="Foreign.HaskellTypes.Deriving.html#8324" class="CatchallClause Bound">vs</a><a id="8326" class="CatchallClause Symbol">)</a> <a id="8328" class="Symbol">=</a> <a id="8330" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8337" class="String">&quot;(%s %s)&quot;</a> <a id="8347" class="Symbol">(</a><a id="8348" href="Foreign.HaskellTypes.Deriving.html#7838" class="Function">renderHsTypeName</a> <a id="8365" href="Foreign.HaskellTypes.Deriving.html#8322" class="Bound">d</a><a id="8366" class="Symbol">)</a> <a id="8368" class="Symbol">(</a><a id="8369" href="Foreign.HaskellTypes.Deriving.html#7591" class="Function">joinStrings</a> <a id="8381" class="String">&quot; &quot;</a> <a id="8385" class="Symbol">(</a><a id="8386" href="Foreign.HaskellTypes.Deriving.html#8005" class="Function">renderHsArgs</a> <a id="8399" href="Foreign.HaskellTypes.Deriving.html#8324" class="Bound">vs</a><a id="8401" class="Symbol">))</a>
  <a id="8406" href="Foreign.HaskellTypes.Deriving.html#7974" class="CatchallClause Function">renderHsType</a><a id="8418" class="CatchallClause"> </a><a id="8419" href="Foreign.HaskellTypes.Deriving.html#8419" class="CatchallClause Bound">t</a> <a id="8421" class="Symbol">=</a> <a id="8423" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8430" class="String">&quot;(TODO: renderHsType %s)&quot;</a> <a id="8456" class="Symbol">(</a><a id="8457" href="Class.Show.Core.html#187" class="Field">show</a> <a id="8462" href="Foreign.HaskellTypes.Deriving.html#8419" class="Bound">t</a><a id="8463" class="Symbol">)</a>

  <a id="8468" href="Foreign.HaskellTypes.Deriving.html#8005" class="Function">renderHsArgs</a> <a id="8481" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8484" class="Symbol">=</a> <a id="8486" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="8491" href="Foreign.HaskellTypes.Deriving.html#8005" class="Function">renderHsArgs</a> <a id="8504" class="Symbol">(</a><a id="8505" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="8510" href="Foreign.HaskellTypes.Deriving.html#8510" class="Bound">a</a> <a id="8512" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8514" href="Foreign.HaskellTypes.Deriving.html#8514" class="Bound">as</a><a id="8516" class="Symbol">)</a> <a id="8518" class="Symbol">=</a> <a id="8520" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="8533" href="Foreign.HaskellTypes.Deriving.html#8510" class="Bound">a</a> <a id="8535" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8537" href="Foreign.HaskellTypes.Deriving.html#8005" class="Function">renderHsArgs</a> <a id="8550" href="Foreign.HaskellTypes.Deriving.html#8514" class="Bound">as</a>
  <a id="8555" href="Foreign.HaskellTypes.Deriving.html#8005" class="CatchallClause Function">renderHsArgs</a><a id="8567" class="CatchallClause"> </a><a id="8568" class="CatchallClause Symbol">(_</a><a id="8570" class="CatchallClause"> </a><a id="8571" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="8572" class="CatchallClause"> </a><a id="8573" href="Foreign.HaskellTypes.Deriving.html#8573" class="CatchallClause Bound">as</a><a id="8575" class="CatchallClause Symbol">)</a> <a id="8577" class="Symbol">=</a> <a id="8579" href="Foreign.HaskellTypes.Deriving.html#8005" class="Function">renderHsArgs</a> <a id="8592" href="Foreign.HaskellTypes.Deriving.html#8573" class="Bound">as</a>

  <a id="foreignPragma"></a><a id="8598" href="Foreign.HaskellTypes.Deriving.html#8598" class="Function">foreignPragma</a> <a id="8612" class="Symbol">:</a> <a id="8614" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8619" class="Symbol">→</a> <a id="8621" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8626" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8631" class="Symbol">→</a> <a id="8633" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="8636" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="8645" href="Foreign.HaskellTypes.Deriving.html#8598" class="Function">foreignPragma</a> <a id="8659" href="Foreign.HaskellTypes.Deriving.html#8659" class="Bound">d</a> <a id="8661" href="Foreign.HaskellTypes.Deriving.html#8661" class="Bound">cs</a> <a id="8664" class="Symbol">=</a> <a id="8666" class="Keyword">do</a>
    <a id="8673" href="Foreign.HaskellTypes.Deriving.html#8673" class="Bound">cons</a> <a id="8678" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="8680" href="Class.Monad.Core.html#1040" class="Function">forM</a> <a id="8685" href="Foreign.HaskellTypes.Deriving.html#8661" class="Bound">cs</a> <a id="8688" class="Symbol">λ</a> <a id="8690" href="Foreign.HaskellTypes.Deriving.html#8690" class="Bound">c</a> <a id="8692" class="Symbol">→</a> <a id="8694" class="Keyword">do</a>
            <a id="8709" href="Foreign.HaskellTypes.Deriving.html#8709" class="Bound">tel</a> <a id="8713" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8715" class="Symbol">_</a> <a id="8717" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="8719" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="8726" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="8730" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="8738" href="Foreign.HaskellTypes.Deriving.html#8690" class="Bound">c</a>
            <a id="8752" class="Keyword">let</a> <a id="8756" href="Foreign.HaskellTypes.Deriving.html#8756" class="Bound">args</a> <a id="8761" class="Symbol">=</a> <a id="8763" href="Data.List.Base.html#1612" class="Function">map</a> <a id="8767" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="8773" href="Foreign.HaskellTypes.Deriving.html#8709" class="Bound">tel</a>
            <a id="8789" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="8794" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="8796" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8803" class="String">&quot;%s %s&quot;</a> <a id="8811" class="Symbol">(</a><a id="8812" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="8821" href="Foreign.HaskellTypes.Deriving.html#8690" class="Bound">c</a><a id="8822" class="Symbol">)</a> <a id="8824" class="Symbol">(</a><a id="8825" href="Foreign.HaskellTypes.Deriving.html#7591" class="Function">joinStrings</a> <a id="8837" class="String">&quot; &quot;</a> <a id="8841" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="8843" href="Foreign.HaskellTypes.Deriving.html#8005" class="Function">renderHsArgs</a> <a id="8856" href="Foreign.HaskellTypes.Deriving.html#8756" class="Bound">args</a><a id="8860" class="Symbol">)</a>
    <a id="8866" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="8871" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="8873" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8880" class="String">&quot;data %s = %s\n  deriving (Show, Eq, Generic)&quot;</a>
                  <a id="8945" class="Symbol">(</a><a id="8946" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="8955" href="Foreign.HaskellTypes.Deriving.html#8659" class="Bound">d</a><a id="8956" class="Symbol">)</a> <a id="8958" class="Symbol">(</a><a id="8959" href="Foreign.HaskellTypes.Deriving.html#7591" class="Function">joinStrings</a> <a id="8971" class="String">&quot; | &quot;</a> <a id="8977" href="Foreign.HaskellTypes.Deriving.html#8673" class="Bound">cons</a><a id="8981" class="Symbol">)</a>

  <a id="8986" class="Comment">-- Record types</a>
  <a id="foreignPragmaRec"></a><a id="9004" href="Foreign.HaskellTypes.Deriving.html#9004" class="Function">foreignPragmaRec</a> <a id="9021" class="Symbol">:</a> <a id="9023" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="9031" class="Symbol">→</a> <a id="9033" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9038" class="Symbol">→</a> <a id="9040" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9045" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9050" class="Symbol">→</a> <a id="9052" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9057" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9062" class="Symbol">→</a> <a id="9064" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="9067" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="9076" href="Foreign.HaskellTypes.Deriving.html#9004" class="Function">foreignPragmaRec</a> <a id="9093" class="Symbol">_</a> <a id="9095" href="Foreign.HaskellTypes.Deriving.html#9095" class="Bound">d</a> <a id="9097" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="9100" class="Symbol">_</a> <a id="9102" class="Symbol">=</a> <a id="9104" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="9117" class="String">&quot;impossible: %q is a record type with no constructors&quot;</a> <a id="9172" href="Foreign.HaskellTypes.Deriving.html#9095" class="Bound">d</a>
  <a id="9176" href="Foreign.HaskellTypes.Deriving.html#9004" class="Function">foreignPragmaRec</a> <a id="9193" href="Foreign.HaskellTypes.Deriving.html#9193" class="Bound">env</a> <a id="9197" href="Foreign.HaskellTypes.Deriving.html#9197" class="Bound">d</a> <a id="9199" class="Symbol">(</a><a id="9200" href="Foreign.HaskellTypes.Deriving.html#9200" class="Bound">c</a> <a id="9202" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="9204" class="Symbol">_)</a> <a id="9207" href="Foreign.HaskellTypes.Deriving.html#9207" class="Bound">fs</a> <a id="9210" class="Symbol">=</a> <a id="9212" class="Keyword">do</a>
    <a id="9219" href="Foreign.HaskellTypes.Deriving.html#9219" class="Bound">tel</a> <a id="9223" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9225" class="Symbol">_</a> <a id="9227" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="9229" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="9236" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="9240" href="Agda.Builtin.Reflection.html#10159" class="Postulate">withNormalisation</a> <a id="9258" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="9263" class="Symbol">(</a><a id="9264" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="9272" href="Foreign.HaskellTypes.Deriving.html#9200" class="Bound">c</a><a id="9273" class="Symbol">)</a>
    <a id="9279" class="Keyword">let</a> <a id="9283" href="Foreign.HaskellTypes.Deriving.html#9283" class="Bound">fNames</a> <a id="9290" class="Symbol">=</a> <a id="9292" href="Data.List.Base.html#1612" class="Function">map</a> <a id="9296" class="Symbol">(</a><a id="9297" href="Foreign.HaskellTypes.Deriving.html#5127" class="Function">hsFieldName</a> <a id="9309" href="Foreign.HaskellTypes.Deriving.html#9193" class="Bound">env</a><a id="9312" class="Symbol">)</a> <a id="9314" href="Foreign.HaskellTypes.Deriving.html#9207" class="Bound">fs</a>
    <a id="9321" class="Keyword">let</a> <a id="9325" href="Foreign.HaskellTypes.Deriving.html#9325" class="Bound">args</a> <a id="9330" class="Symbol">=</a> <a id="9332" href="Data.List.Base.html#1612" class="Function">map</a> <a id="9336" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="9342" href="Foreign.HaskellTypes.Deriving.html#9219" class="Bound">tel</a>
        <a id="9354" href="Foreign.HaskellTypes.Deriving.html#9354" class="Bound">renderField</a> <a id="9366" href="Foreign.HaskellTypes.Deriving.html#9366" class="Bound">f</a> <a id="9368" href="Foreign.HaskellTypes.Deriving.html#9368" class="Bound">ty</a> <a id="9371" class="Symbol">=</a> <a id="9373" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9380" class="String">&quot;%s :: %s&quot;</a> <a id="9391" href="Foreign.HaskellTypes.Deriving.html#9366" class="Bound">f</a> <a id="9393" class="Symbol">(</a><a id="9394" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="9407" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9409" href="Reflection.AST.Argument.html#2600" class="Function">unArg</a> <a id="9415" href="Foreign.HaskellTypes.Deriving.html#9368" class="Bound">ty</a><a id="9417" class="Symbol">)</a>
        <a id="9427" href="Foreign.HaskellTypes.Deriving.html#9427" class="Bound">con</a> <a id="9431" class="Symbol">=</a> <a id="9433" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9440" class="String">&quot;%s {%s}&quot;</a> <a id="9450" class="Symbol">(</a><a id="9451" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="9460" href="Foreign.HaskellTypes.Deriving.html#9200" class="Bound">c</a><a id="9461" class="Symbol">)</a> <a id="9463" class="Symbol">(</a><a id="9464" href="Foreign.HaskellTypes.Deriving.html#7591" class="Function">joinStrings</a> <a id="9476" class="String">&quot;, &quot;</a> <a id="9481" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9483" href="Data.List.Base.html#2712" class="Function">zipWith</a> <a id="9491" href="Foreign.HaskellTypes.Deriving.html#9354" class="Bound">renderField</a> <a id="9503" href="Foreign.HaskellTypes.Deriving.html#9283" class="Bound">fNames</a> <a id="9510" href="Foreign.HaskellTypes.Deriving.html#9325" class="Bound">args</a><a id="9514" class="Symbol">)</a>
    <a id="9520" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="9525" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9527" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9534" class="String">&quot;data %s = %s\n  deriving (Show, Eq, Generic)&quot;</a>
                  <a id="9599" class="Symbol">(</a><a id="9600" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="9609" href="Foreign.HaskellTypes.Deriving.html#9197" class="Bound">d</a><a id="9610" class="Symbol">)</a> <a id="9612" href="Foreign.HaskellTypes.Deriving.html#9427" class="Bound">con</a>

  <a id="hsImports"></a><a id="9619" href="Foreign.HaskellTypes.Deriving.html#9619" class="Function">hsImports</a> <a id="9629" class="Symbol">:</a> <a id="9631" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="9640" href="Foreign.HaskellTypes.Deriving.html#9619" class="Function">hsImports</a> <a id="9650" class="Symbol">=</a> <a id="9652" class="String">&quot;import GHC.Generics (Generic)&quot;</a>

  <a id="9687" class="Comment">-- Take the name of a simple data type and generate the COMPILE and</a>
  <a id="9757" class="Comment">-- FOREIGN pragmas to bind to Haskell.</a>
  <a id="bindHsType"></a><a id="9798" href="Foreign.HaskellTypes.Deriving.html#9798" class="Function">bindHsType</a> <a id="9809" class="Symbol">:</a> <a id="9811" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="9819" class="Symbol">→</a> <a id="9821" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9826" class="Symbol">→</a> <a id="9828" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9833" class="Symbol">→</a> <a id="9835" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="9838" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="9842" href="Foreign.HaskellTypes.Deriving.html#9798" class="Function">bindHsType</a> <a id="9853" href="Foreign.HaskellTypes.Deriving.html#9853" class="Bound">env</a> <a id="9857" href="Foreign.HaskellTypes.Deriving.html#9857" class="Bound">agdaName</a> <a id="9866" href="Foreign.HaskellTypes.Deriving.html#9866" class="Bound">hsName</a> <a id="9873" class="Symbol">=</a> <a id="9875" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="9889" href="Foreign.HaskellTypes.Deriving.html#9866" class="Bound">hsName</a> <a id="9896" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="9900" class="Symbol">λ</a> <a id="9902" class="Keyword">where</a>
    <a id="9912" class="Symbol">(</a><a id="9913" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="9923" href="Foreign.HaskellTypes.Deriving.html#9923" class="Bound">pars</a> <a id="9928" href="Foreign.HaskellTypes.Deriving.html#9928" class="Bound">cs</a><a id="9930" class="Symbol">)</a> <a id="9932" class="Symbol">→</a> <a id="9934" class="Keyword">do</a>
      <a id="9943" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="9957" class="String">&quot;GHC&quot;</a> <a id="9963" href="Foreign.HaskellTypes.Deriving.html#9619" class="Function">hsImports</a>
      <a id="9979" href="Agda.Builtin.Reflection.html#9970" class="Postulate">pragmaCompile</a> <a id="9993" class="String">&quot;GHC&quot;</a> <a id="9999" href="Foreign.HaskellTypes.Deriving.html#9866" class="Bound">hsName</a> <a id="10006" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="10008" href="Foreign.HaskellTypes.Deriving.html#7695" class="Function">compilePragma</a> <a id="10022" href="Foreign.HaskellTypes.Deriving.html#9866" class="Bound">hsName</a> <a id="10029" href="Foreign.HaskellTypes.Deriving.html#9928" class="Bound">cs</a>
      <a id="10038" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="10052" href="Foreign.HaskellTypes.Deriving.html#9857" class="Bound">agdaName</a> <a id="10061" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="10065" class="Symbol">λ</a> <a id="10067" class="Keyword">where</a>
        <a id="10081" class="Symbol">(</a><a id="10082" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="10092" class="Symbol">_</a> <a id="10094" class="Symbol">_)</a>    <a id="10100" class="Symbol">→</a> <a id="10102" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10116" class="String">&quot;GHC&quot;</a> <a id="10122" href="Class.Monad.Core.html#426" class="Function Operator">=&lt;&lt;</a> <a id="10126" href="Foreign.HaskellTypes.Deriving.html#8598" class="Function">foreignPragma</a> <a id="10140" href="Foreign.HaskellTypes.Deriving.html#9866" class="Bound">hsName</a> <a id="10147" href="Foreign.HaskellTypes.Deriving.html#9928" class="Bound">cs</a>
        <a id="10158" class="Symbol">(</a><a id="10159" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="10171" class="Symbol">_</a> <a id="10173" href="Foreign.HaskellTypes.Deriving.html#10173" class="Bound">fs</a><a id="10175" class="Symbol">)</a> <a id="10177" class="Symbol">→</a> <a id="10179" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10193" class="String">&quot;GHC&quot;</a> <a id="10199" href="Class.Monad.Core.html#426" class="Function Operator">=&lt;&lt;</a> <a id="10203" href="Foreign.HaskellTypes.Deriving.html#9004" class="Function">foreignPragmaRec</a> <a id="10220" href="Foreign.HaskellTypes.Deriving.html#9853" class="Bound">env</a> <a id="10224" href="Foreign.HaskellTypes.Deriving.html#9866" class="Bound">hsName</a> <a id="10231" href="Foreign.HaskellTypes.Deriving.html#9928" class="Bound">cs</a> <a id="10234" class="Symbol">(</a><a id="10235" href="Data.List.Base.html#1612" class="Function">map</a> <a id="10239" href="Reflection.AST.Argument.html#2600" class="Function">unArg</a> <a id="10245" href="Foreign.HaskellTypes.Deriving.html#10173" class="Bound">fs</a><a id="10247" class="Symbol">)</a>
        <a id="10257" class="CatchallClause Symbol">_</a> <a id="10259" class="Symbol">→</a> <a id="10261" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="10274" class="String">&quot;%q is not a data or record type&quot;</a> <a id="10308" href="Foreign.HaskellTypes.Deriving.html#9857" class="Bound">agdaName</a>
    <a id="10321" class="CatchallClause Symbol">_</a> <a id="10323" class="Symbol">→</a> <a id="10325" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="10338" class="String">&quot;%q is not a data type (impossible)&quot;</a> <a id="10375" href="Foreign.HaskellTypes.Deriving.html#9866" class="Bound">hsName</a>

  <a id="computeProjections"></a><a id="10385" href="Foreign.HaskellTypes.Deriving.html#10385" class="Function">computeProjections</a> <a id="10404" class="Symbol">:</a> <a id="10406" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="10408" class="Symbol">→</a> <a id="10410" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10415" class="Symbol">→</a> <a id="10417" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="10420" class="Symbol">(</a><a id="10421" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="10426" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="10430" class="Symbol">)</a>
  <a id="10434" href="Foreign.HaskellTypes.Deriving.html#10385" class="Function">computeProjections</a> <a id="10453" href="Foreign.HaskellTypes.Deriving.html#10453" class="Bound">npars</a> <a id="10459" href="Foreign.HaskellTypes.Deriving.html#10459" class="Bound">c</a> <a id="10461" class="Symbol">=</a> <a id="10463" class="Keyword">do</a>
    <a id="10470" href="Foreign.HaskellTypes.Deriving.html#10470" class="Bound">argTys</a> <a id="10477" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10479" class="Symbol">_</a> <a id="10481" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="10483" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="10490" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="10494" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="10502" href="Foreign.HaskellTypes.Deriving.html#10459" class="Bound">c</a>
    <a id="10508" class="Keyword">let</a> <a id="10512" href="Foreign.HaskellTypes.Deriving.html#10512" class="Bound">is</a>  <a id="10516" class="Symbol">=</a> <a id="10518" href="Data.List.Base.html#6430" class="Function">downFrom</a> <a id="10527" class="Symbol">(</a><a id="10528" href="Data.List.Base.html#4746" class="Function">length</a> <a id="10535" href="Foreign.HaskellTypes.Deriving.html#10470" class="Bound">argTys</a><a id="10541" class="Symbol">)</a>
        <a id="10551" href="Foreign.HaskellTypes.Deriving.html#10551" class="Bound">tel</a> <a id="10555" class="Symbol">=</a> <a id="10557" href="Data.List.Base.html#1612" class="Function">map</a> <a id="10561" class="Symbol">(λ</a> <a id="10564" class="Keyword">where</a> <a id="10570" class="Symbol">(</a><a id="10571" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="10575" href="Foreign.HaskellTypes.Deriving.html#10575" class="Bound">x</a> <a id="10577" href="Foreign.HaskellTypes.Deriving.html#10577" class="Bound">ty</a><a id="10579" class="Symbol">)</a> <a id="10581" class="Symbol">→</a> <a id="10583" href="Foreign.HaskellTypes.Deriving.html#10575" class="Bound">x</a> <a id="10585" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10587" href="Foreign.HaskellTypes.Deriving.html#10577" class="Bound">ty</a><a id="10589" class="Symbol">)</a> <a id="10591" href="Foreign.HaskellTypes.Deriving.html#10470" class="Bound">argTys</a>
        <a id="10606" href="Foreign.HaskellTypes.Deriving.html#10606" class="Bound">lhs</a> <a id="10610" class="Symbol">=</a> <a id="10612" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="10617" class="Symbol">(</a><a id="10618" href="Agda.Builtin.Reflection.html#5814" class="InductiveConstructor">con</a> <a id="10622" href="Foreign.HaskellTypes.Deriving.html#10459" class="Bound">c</a> <a id="10624" class="Symbol">(</a><a id="10625" href="Data.List.Base.html#1612" class="Function">map</a> <a id="10629" class="Symbol">(λ</a> <a id="10632" class="Keyword">where</a> <a id="10638" class="Symbol">(</a><a id="10639" href="Foreign.HaskellTypes.Deriving.html#10639" class="Bound">i</a> <a id="10641" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10643" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="10647" href="Foreign.HaskellTypes.Deriving.html#10647" class="Bound">x</a> <a id="10649" class="Symbol">(</a><a id="10650" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="10654" href="Foreign.HaskellTypes.Deriving.html#10654" class="Bound">info</a> <a id="10659" class="Symbol">_))</a> <a id="10663" class="Symbol">→</a> <a id="10665" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="10669" href="Foreign.HaskellTypes.Deriving.html#10654" class="Bound">info</a> <a id="10674" class="Symbol">(</a><a id="10675" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">var</a> <a id="10679" href="Foreign.HaskellTypes.Deriving.html#10639" class="Bound">i</a><a id="10680" class="Symbol">))</a>
                               <a id="10714" class="Symbol">(</a><a id="10715" href="Data.List.Base.html#8509" class="Function">drop</a> <a id="10720" href="Foreign.HaskellTypes.Deriving.html#10453" class="Bound">npars</a> <a id="10726" class="Symbol">(</a><a id="10727" href="Data.List.Base.html#3484" class="Function">zip</a> <a id="10731" href="Foreign.HaskellTypes.Deriving.html#10512" class="Bound">is</a> <a id="10734" href="Foreign.HaskellTypes.Deriving.html#10470" class="Bound">argTys</a><a id="10740" class="Symbol">))))</a> <a id="10745" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="10747" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="10754" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="10761" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="10763" href="Data.List.Base.html#1612" class="Function">map</a> <a id="10767" class="Symbol">(λ</a> <a id="10770" href="Foreign.HaskellTypes.Deriving.html#10770" class="Bound">i</a> <a id="10772" class="Symbol">→</a> <a id="10774" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="10782" class="Symbol">(</a><a id="10783" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="10790" href="Foreign.HaskellTypes.Deriving.html#10551" class="Bound">tel</a> <a id="10794" href="Foreign.HaskellTypes.Deriving.html#10606" class="Bound">lhs</a> <a id="10798" class="Symbol">(</a><a id="10799" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="10803" href="Foreign.HaskellTypes.Deriving.html#10770" class="Bound">i</a> <a id="10805" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10807" class="Symbol">)</a> <a id="10809" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="10811" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10813" class="Symbol">)</a> <a id="10815" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10817" class="Symbol">)</a> <a id="10819" class="Symbol">(</a><a id="10820" href="Data.List.Base.html#8509" class="Function">drop</a> <a id="10825" href="Foreign.HaskellTypes.Deriving.html#10453" class="Bound">npars</a> <a id="10831" href="Foreign.HaskellTypes.Deriving.html#10512" class="Bound">is</a><a id="10833" class="Symbol">)</a>

  <a id="makeTypeAlias"></a><a id="10838" href="Foreign.HaskellTypes.Deriving.html#10838" class="Function">makeTypeAlias</a> <a id="10852" class="Symbol">:</a> <a id="10854" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10859" class="Symbol">→</a> <a id="10861" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="10869" class="Symbol">→</a> <a id="10871" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="10876" class="Symbol">→</a> <a id="10878" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="10881" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="10885" href="Foreign.HaskellTypes.Deriving.html#10838" class="Function">makeTypeAlias</a> <a id="10899" href="Foreign.HaskellTypes.Deriving.html#10899" class="Bound">agdaName</a> <a id="10908" href="Foreign.HaskellTypes.Deriving.html#10908" class="Bound">env</a> <a id="10912" href="Foreign.HaskellTypes.Deriving.html#10912" class="Bound">hole</a> <a id="10917" class="Symbol">=</a> <a id="10919" class="Keyword">do</a>
    <a id="10926" href="Foreign.HaskellTypes.Deriving.html#10926" class="Bound">hsTy</a> <a id="10931" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="10933" href="Foreign.HaskellTypes.Deriving.html#3890" class="Function">solveHsType</a> <a id="10945" class="Symbol">(</a><a id="10946" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="10950" href="Foreign.HaskellTypes.Deriving.html#10899" class="Bound">agdaName</a> <a id="10959" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10961" class="Symbol">)</a>
    <a id="10967" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10981" class="String">&quot;GHC&quot;</a> <a id="10987" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="10989" href="Text.Printf.html#1015" class="Function">printf</a> <a id="10996" class="String">&quot;type %s = %s&quot;</a> <a id="11011" class="Symbol">(</a><a id="11012" href="Foreign.HaskellTypes.Deriving.html#4789" class="Function">hsTypeName</a> <a id="11023" href="Foreign.HaskellTypes.Deriving.html#10908" class="Bound">env</a> <a id="11027" href="Foreign.HaskellTypes.Deriving.html#10899" class="Bound">agdaName</a><a id="11035" class="Symbol">)</a> <a id="11037" class="Symbol">(</a><a id="11038" href="Foreign.HaskellTypes.Deriving.html#7974" class="Function">renderHsType</a> <a id="11051" href="Foreign.HaskellTypes.Deriving.html#10926" class="Bound">hsTy</a><a id="11055" class="Symbol">)</a>
    <a id="11061" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="11067" href="Foreign.HaskellTypes.Deriving.html#10912" class="Bound">hole</a> <a id="11072" class="Symbol">(</a><a id="11073" class="Keyword">quote</a> <a id="11079" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="11086" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="11089" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="11093" class="Symbol">(</a><a id="11094" class="Keyword">quote</a> <a id="11100" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="11102" class="Symbol">)</a> <a id="11104" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="11107" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="11108" class="Symbol">)</a>

<a id="11111" class="Comment">-- * Exported macros</a>

<a id="doAutoHsType"></a><a id="11133" href="Foreign.HaskellTypes.Deriving.html#11133" class="Function">doAutoHsType</a> <a id="11146" class="Symbol">:</a> <a id="11148" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="11156" class="Symbol">→</a> <a id="11158" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11163" class="Symbol">→</a> <a id="11165" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11170" class="Symbol">→</a> <a id="11172" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11175" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="11180" href="Foreign.HaskellTypes.Deriving.html#11133" class="Function">doAutoHsType</a> <a id="11193" href="Foreign.HaskellTypes.Deriving.html#11193" class="Bound">env</a> <a id="11197" href="Foreign.HaskellTypes.Deriving.html#11197" class="Bound">d</a> <a id="11199" href="Foreign.HaskellTypes.Deriving.html#11199" class="Bound">hole</a> <a id="11204" class="Symbol">=</a> <a id="11206" class="Keyword">do</a>
  <a id="11211" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="11221" href="Foreign.HaskellTypes.Deriving.html#11199" class="Bound">hole</a> <a id="11226" class="Symbol">(</a><a id="11227" class="Keyword">quote</a> <a id="11233" href="Foreign.HaskellTypes.html#532" class="Record">HasHsType</a> <a id="11243" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="11246" href="Foreign.HaskellTypes.Deriving.html#11197" class="Bound">d</a> <a id="11248" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a> <a id="11250" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="11251" class="Symbol">)</a>
  <a id="11255" href="Foreign.HaskellTypes.Deriving.html#11255" class="Bound">hs</a> <a id="11258" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="11260" href="Foreign.HaskellTypes.Deriving.html#7315" class="Function">makeHsType</a> <a id="11271" href="Foreign.HaskellTypes.Deriving.html#11193" class="Bound">env</a> <a id="11275" href="Foreign.HaskellTypes.Deriving.html#11197" class="Bound">d</a>
  <a id="11279" href="Foreign.HaskellTypes.Deriving.html#4167" class="Function">debug</a> <a id="11285" class="Number">50</a> <a id="11288" class="String">&quot;  HsType %q = %q&quot;</a> <a id="11307" href="Foreign.HaskellTypes.Deriving.html#11197" class="Bound">d</a> <a id="11309" href="Foreign.HaskellTypes.Deriving.html#11255" class="Bound">hs</a>
  <a id="11314" href="Foreign.HaskellTypes.Deriving.html#9798" class="Function">bindHsType</a> <a id="11325" href="Foreign.HaskellTypes.Deriving.html#11193" class="Bound">env</a> <a id="11329" href="Foreign.HaskellTypes.Deriving.html#11197" class="Bound">d</a> <a id="11331" href="Foreign.HaskellTypes.Deriving.html#11255" class="Bound">hs</a>
  <a id="11336" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="11342" href="Foreign.HaskellTypes.Deriving.html#11199" class="Bound">hole</a> <a id="11347" class="Symbol">(</a><a id="11348" href="Reflection.Syntax.html#2695" class="InductiveConstructor Operator">`λ⟦</a> <a id="11352" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="11357" class="Symbol">(</a><a id="11358" class="Keyword">quote</a> <a id="11364" href="Foreign.HaskellTypes.html#579" class="Field">HasHsType.HsType</a><a id="11380" class="Symbol">)</a> <a id="11382" href="Reflection.Syntax.html#2695" class="InductiveConstructor Operator">⇒</a> <a id="11384" href="Foreign.HaskellTypes.Deriving.html#11255" class="Bound">hs</a> <a id="11387" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a> <a id="11389" href="Reflection.Syntax.html#2695" class="InductiveConstructor Operator">⟧</a><a id="11390" class="Symbol">)</a>
  <a id="11394" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="11399" class="Symbol">(</a><a id="11400" href="Foreign.HaskellTypes.Deriving.html#11255" class="Bound">hs</a> <a id="11403" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a><a id="11404" class="Symbol">)</a>

<a id="11407" class="Keyword">macro</a>
  <a id="autoHsType"></a><a id="11415" href="Foreign.HaskellTypes.Deriving.html#11415" class="Macro">autoHsType</a> <a id="11426" class="Symbol">:</a> <a id="11428" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11433" class="Symbol">→</a> <a id="11435" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11440" class="Symbol">→</a> <a id="11442" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11445" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11449" href="Foreign.HaskellTypes.Deriving.html#11415" class="Macro">autoHsType</a> <a id="11460" href="Foreign.HaskellTypes.Deriving.html#11460" class="Bound">d</a> <a id="11462" href="Foreign.HaskellTypes.Deriving.html#11462" class="Bound">hole</a> <a id="11467" class="Symbol">=</a> <a id="11469" class="Symbol">_</a> <a id="11471" href="Class.Functor.Core.html#288" class="Function Operator">&lt;$</a> <a id="11474" href="Foreign.HaskellTypes.Deriving.html#11133" class="Function">doAutoHsType</a> <a id="11487" href="Foreign.HaskellTypes.Deriving.html#2619" class="Function">emptyEnv</a> <a id="11496" href="Foreign.HaskellTypes.Deriving.html#11460" class="Bound">d</a> <a id="11498" href="Foreign.HaskellTypes.Deriving.html#11462" class="Bound">hole</a>

  <a id="11506" class="Keyword">infix</a> <a id="11512" class="Number">0</a> <a id="11514" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType_⊣_</a>
  <a id="autoHsType_⊣_"></a><a id="11530" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType_⊣_</a> <a id="11544" class="Symbol">:</a> <a id="11546" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11551" class="Symbol">→</a> <a id="11553" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="11561" class="Symbol">→</a> <a id="11563" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11568" class="Symbol">→</a> <a id="11570" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11573" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11577" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType_⊣_</a> <a id="11591" href="Foreign.HaskellTypes.Deriving.html#11591" class="Bound">d</a> <a id="11593" href="Foreign.HaskellTypes.Deriving.html#11593" class="Bound">env</a> <a id="11597" href="Foreign.HaskellTypes.Deriving.html#11597" class="Bound">hole</a> <a id="11602" class="Symbol">=</a> <a id="11604" class="Symbol">_</a> <a id="11606" href="Class.Functor.Core.html#288" class="Function Operator">&lt;$</a> <a id="11609" href="Foreign.HaskellTypes.Deriving.html#11133" class="Function">doAutoHsType</a> <a id="11622" href="Foreign.HaskellTypes.Deriving.html#11593" class="Bound">env</a> <a id="11626" href="Foreign.HaskellTypes.Deriving.html#11591" class="Bound">d</a> <a id="11628" href="Foreign.HaskellTypes.Deriving.html#11597" class="Bound">hole</a>

  <a id="11636" class="Keyword">infix</a> <a id="11642" class="Number">9</a> <a id="11644" href="Foreign.HaskellTypes.Deriving.html#11650" class="Macro Operator">_↦_</a>
  <a id="_↦_"></a><a id="11650" href="Foreign.HaskellTypes.Deriving.html#11650" class="Macro Operator">_↦_</a> <a id="11654" class="Symbol">:</a> <a id="11656" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11661" class="Symbol">→</a> <a id="11663" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="11670" class="Symbol">→</a> <a id="11672" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11677" class="Symbol">→</a> <a id="11679" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11682" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11686" href="Foreign.HaskellTypes.Deriving.html#11686" class="Bound">x</a> <a id="11688" href="Foreign.HaskellTypes.Deriving.html#11650" class="Macro Operator">↦</a> <a id="11690" href="Foreign.HaskellTypes.Deriving.html#11690" class="Bound">s</a> <a id="11692" class="Symbol">=</a> <a id="11694" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="11700" class="Symbol">(</a><a id="11701" class="Keyword">quote</a> <a id="11707" href="Foreign.HaskellTypes.Deriving.html#2810" class="Function">customName</a> <a id="11718" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∙⟦</a> <a id="11721" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="11725" class="Symbol">(</a><a id="11726" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="11731" href="Foreign.HaskellTypes.Deriving.html#11686" class="Bound">x</a><a id="11732" class="Symbol">)</a> <a id="11734" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∣</a> <a id="11736" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="11740" class="Symbol">(</a><a id="11741" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">string</a> <a id="11748" href="Foreign.HaskellTypes.Deriving.html#11690" class="Bound">s</a><a id="11749" class="Symbol">)</a> <a id="11751" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">⟧</a><a id="11752" class="Symbol">)</a>

  <a id="11757" class="Comment">-- Generate a Haskell type synonym for the HsType of the given type</a>
  <a id="11827" class="Comment">-- Usage `unquoteDecl = do hsTypeSynonym Foo; hsTypeSynonym Bar`</a>
  <a id="hsTypeAlias"></a><a id="11894" href="Foreign.HaskellTypes.Deriving.html#11894" class="Macro">hsTypeAlias</a> <a id="11906" class="Symbol">:</a> <a id="11908" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11913" class="Symbol">→</a> <a id="11915" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11920" class="Symbol">→</a> <a id="11922" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11925" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11929" href="Foreign.HaskellTypes.Deriving.html#11894" class="Macro">hsTypeAlias</a> <a id="11941" href="Foreign.HaskellTypes.Deriving.html#11941" class="Bound">agdaName</a> <a id="11950" class="Symbol">=</a> <a id="11952" href="Foreign.HaskellTypes.Deriving.html#10838" class="Function">makeTypeAlias</a> <a id="11966" href="Foreign.HaskellTypes.Deriving.html#11941" class="Bound">agdaName</a> <a id="11975" href="Foreign.HaskellTypes.Deriving.html#2619" class="Function">emptyEnv</a>

  <a id="11987" class="Comment">-- The only NameEnv that&#39;s useful here is `withName`.</a>
  <a id="hsTypeAlias_⊣_"></a><a id="12043" href="Foreign.HaskellTypes.Deriving.html#12043" class="Macro Operator">hsTypeAlias_⊣_</a> <a id="12058" class="Symbol">:</a> <a id="12060" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12065" class="Symbol">→</a> <a id="12067" href="Foreign.HaskellTypes.Deriving.html#1743" class="Record">NameEnv</a> <a id="12075" class="Symbol">→</a> <a id="12077" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12082" class="Symbol">→</a> <a id="12084" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12087" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12091" href="Foreign.HaskellTypes.Deriving.html#12043" class="Macro Operator">hsTypeAlias</a> <a id="12103" href="Foreign.HaskellTypes.Deriving.html#12103" class="Bound">agdaName</a> <a id="12112" href="Foreign.HaskellTypes.Deriving.html#12043" class="Macro Operator">⊣</a> <a id="12114" href="Foreign.HaskellTypes.Deriving.html#12114" class="Bound">env</a> <a id="12118" class="Symbol">=</a> <a id="12120" href="Foreign.HaskellTypes.Deriving.html#10838" class="Function">makeTypeAlias</a> <a id="12134" href="Foreign.HaskellTypes.Deriving.html#12103" class="Bound">agdaName</a> <a id="12143" href="Foreign.HaskellTypes.Deriving.html#12114" class="Bound">env</a>

  <a id="12150" class="Comment">-- * Macros for constructing and deconstructing generated types</a>

  <a id="hsCon"></a><a id="12217" href="Foreign.HaskellTypes.Deriving.html#12217" class="Macro">hsCon</a> <a id="12223" class="Symbol">:</a> <a id="12225" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12230" class="Symbol">→</a> <a id="12232" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="12234" class="Symbol">→</a> <a id="12236" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12241" class="Symbol">→</a> <a id="12243" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12246" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12250" href="Foreign.HaskellTypes.Deriving.html#12217" class="Macro">hsCon</a> <a id="12256" href="Foreign.HaskellTypes.Deriving.html#12256" class="Bound">agdaTy</a> <a id="12263" href="Foreign.HaskellTypes.Deriving.html#12263" class="Bound">i</a> <a id="12265" href="Foreign.HaskellTypes.Deriving.html#12265" class="Bound">hole</a> <a id="12270" class="Symbol">=</a> <a id="12272" class="Keyword">do</a>
    <a id="12279" href="Foreign.HaskellTypes.Deriving.html#12279" class="Bound">hsTy</a><a id="12283" class="Symbol">@(</a><a id="12285" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="12289" href="Foreign.HaskellTypes.Deriving.html#12289" class="Bound">hsName</a> <a id="12296" class="Symbol">_)</a> <a id="12299" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="12301" href="Foreign.HaskellTypes.Deriving.html#3890" class="Function">solveHsType</a> <a id="12313" href="Foreign.HaskellTypes.Deriving.html#12256" class="Bound">agdaTy</a>
      <a id="12326" class="Keyword">where</a> <a id="12332" class="CatchallClause Symbol">_</a> <a id="12334" class="Symbol">→</a> <a id="12336" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12349" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="12382" href="Foreign.HaskellTypes.Deriving.html#12256" class="Bound">agdaTy</a>
    <a id="12393" href="Foreign.HaskellTypes.Deriving.html#12393" class="Bound">cs</a> <a id="12396" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="12398" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="12412" href="Foreign.HaskellTypes.Deriving.html#12289" class="Bound">hsName</a> <a id="12419" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="12423" class="Symbol">λ</a> <a id="12425" class="Keyword">where</a>
      <a id="12437" class="Symbol">(</a><a id="12438" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="12448" class="Symbol">_</a> <a id="12450" href="Foreign.HaskellTypes.Deriving.html#12450" class="Bound">cs</a><a id="12452" class="Symbol">)</a>  <a id="12455" class="Symbol">→</a> <a id="12457" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="12464" href="Foreign.HaskellTypes.Deriving.html#12450" class="Bound">cs</a>
      <a id="12473" class="CatchallClause Symbol">_</a> <a id="12475" class="Symbol">→</a> <a id="12477" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12490" class="String">&quot;Expected HsType %t to be a data type, but got %t&quot;</a> <a id="12541" href="Foreign.HaskellTypes.Deriving.html#12256" class="Bound">agdaTy</a> <a id="12548" href="Foreign.HaskellTypes.Deriving.html#12279" class="Bound">hsTy</a>
    <a id="12557" href="Foreign.HaskellTypes.Deriving.html#12557" class="Bound">c</a> <a id="12559" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="12561" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a> <a id="12568" href="Class.Monad.Core.html#316" class="Field">return</a>  <a id="12576" class="Symbol">(</a><a id="12577" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12590" class="String">&quot;%q has only %u constructors&quot;</a> <a id="12620" href="Foreign.HaskellTypes.Deriving.html#12289" class="Bound">hsName</a> <a id="12627" class="Symbol">(</a><a id="12628" href="Data.List.Base.html#4746" class="Function">length</a> <a id="12635" href="Foreign.HaskellTypes.Deriving.html#12393" class="Bound">cs</a><a id="12637" class="Symbol">))</a> <a id="12640" class="Symbol">(</a><a id="12641" href="Foreign.HaskellTypes.Deriving.html#12393" class="Bound">cs</a> <a id="12644" href="Foreign.HaskellTypes.Deriving.html#4210" class="Function Operator">‼</a> <a id="12646" href="Foreign.HaskellTypes.Deriving.html#12263" class="Bound">i</a><a id="12647" class="Symbol">)</a>
    <a id="12653" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="12659" href="Foreign.HaskellTypes.Deriving.html#12265" class="Bound">hole</a> <a id="12664" class="Symbol">(</a><a id="12665" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="12669" href="Foreign.HaskellTypes.Deriving.html#12557" class="Bound">c</a> <a id="12671" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="12673" class="Symbol">)</a>

  <a id="hsProj"></a><a id="12678" href="Foreign.HaskellTypes.Deriving.html#12678" class="Macro">hsProj</a> <a id="12685" class="Symbol">:</a> <a id="12687" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12692" class="Symbol">→</a> <a id="12694" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="12696" class="Symbol">→</a> <a id="12698" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12703" class="Symbol">→</a> <a id="12705" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12708" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12712" href="Foreign.HaskellTypes.Deriving.html#12678" class="Macro">hsProj</a> <a id="12719" href="Foreign.HaskellTypes.Deriving.html#12719" class="Bound">agdaTy</a> <a id="12726" href="Foreign.HaskellTypes.Deriving.html#12726" class="Bound">i</a> <a id="12728" href="Foreign.HaskellTypes.Deriving.html#12728" class="Bound">hole</a> <a id="12733" class="Symbol">=</a> <a id="12735" class="Keyword">do</a>
    <a id="12742" href="Foreign.HaskellTypes.Deriving.html#12742" class="Bound">hsTy</a><a id="12746" class="Symbol">@(</a><a id="12748" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="12752" href="Foreign.HaskellTypes.Deriving.html#12752" class="Bound">hsName</a> <a id="12759" class="Symbol">_)</a> <a id="12762" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="12764" href="Foreign.HaskellTypes.Deriving.html#3890" class="Function">solveHsType</a> <a id="12776" href="Foreign.HaskellTypes.Deriving.html#12719" class="Bound">agdaTy</a>
      <a id="12789" class="Keyword">where</a> <a id="12795" class="CatchallClause Symbol">_</a> <a id="12797" class="Symbol">→</a> <a id="12799" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12812" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="12845" href="Foreign.HaskellTypes.Deriving.html#12719" class="Bound">agdaTy</a>
    <a id="12856" href="Foreign.HaskellTypes.Deriving.html#12856" class="Bound">prjs</a> <a id="12861" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="12863" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="12877" href="Foreign.HaskellTypes.Deriving.html#12752" class="Bound">hsName</a> <a id="12884" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="12888" class="Symbol">λ</a> <a id="12890" class="Keyword">where</a>
      <a id="12902" class="Symbol">(</a><a id="12903" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="12913" href="Foreign.HaskellTypes.Deriving.html#12913" class="Bound">npars</a> <a id="12919" class="Symbol">(</a><a id="12920" href="Foreign.HaskellTypes.Deriving.html#12920" class="Bound">c</a> <a id="12922" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="12924" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="12926" class="Symbol">))</a> <a id="12929" class="Symbol">→</a> <a id="12931" href="Foreign.HaskellTypes.Deriving.html#10385" class="Function">computeProjections</a> <a id="12950" href="Foreign.HaskellTypes.Deriving.html#12913" class="Bound">npars</a> <a id="12956" href="Foreign.HaskellTypes.Deriving.html#12920" class="Bound">c</a>
      <a id="12964" class="CatchallClause Symbol">_</a> <a id="12966" class="Symbol">→</a> <a id="12968" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12981" class="String">&quot;Expected HsType %t to be a single constructor data type, but got %t&quot;</a> <a id="13051" href="Foreign.HaskellTypes.Deriving.html#12719" class="Bound">agdaTy</a> <a id="13058" href="Foreign.HaskellTypes.Deriving.html#12742" class="Bound">hsTy</a>
    <a id="13067" href="Foreign.HaskellTypes.Deriving.html#13067" class="Bound">prj</a> <a id="13071" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="13073" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a> <a id="13080" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="13087" class="Symbol">(</a><a id="13088" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13101" class="String">&quot;%q has only %u fields&quot;</a> <a id="13125" href="Foreign.HaskellTypes.Deriving.html#12752" class="Bound">hsName</a> <a id="13132" class="Symbol">(</a><a id="13133" href="Data.List.Base.html#4746" class="Function">length</a> <a id="13140" href="Foreign.HaskellTypes.Deriving.html#12856" class="Bound">prjs</a><a id="13144" class="Symbol">))</a> <a id="13147" class="Symbol">(</a><a id="13148" href="Foreign.HaskellTypes.Deriving.html#12856" class="Bound">prjs</a> <a id="13153" href="Foreign.HaskellTypes.Deriving.html#4210" class="Function Operator">‼</a> <a id="13155" href="Foreign.HaskellTypes.Deriving.html#12726" class="Bound">i</a><a id="13156" class="Symbol">)</a>
    <a id="13162" href="Foreign.HaskellTypes.Deriving.html#13162" class="Bound">target</a> <a id="13169" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="13171" href="Reflection.TCM.html#1261" class="Function">newMeta</a> <a id="13179" href="Reflection.Syntax.html#3546" class="InductiveConstructor">`Set</a>
    <a id="13188" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="13198" href="Foreign.HaskellTypes.Deriving.html#12728" class="Bound">hole</a> <a id="13203" class="Symbol">(</a><a id="13204" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="13207" class="Symbol">(</a><a id="13208" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="13213" href="Foreign.HaskellTypes.Deriving.html#12742" class="Bound">hsTy</a><a id="13217" class="Symbol">)</a> <a id="13219" class="Symbol">(</a><a id="13220" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="13224" class="String">&quot;_&quot;</a> <a id="13228" href="Foreign.HaskellTypes.Deriving.html#13162" class="Bound">target</a><a id="13234" class="Symbol">))</a>
    <a id="13241" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="13247" href="Foreign.HaskellTypes.Deriving.html#12728" class="Bound">hole</a> <a id="13252" href="Foreign.HaskellTypes.Deriving.html#13067" class="Bound">prj</a>

  <a id="hsTyName"></a><a id="13259" href="Foreign.HaskellTypes.Deriving.html#13259" class="Macro">hsTyName</a> <a id="13268" class="Symbol">:</a> <a id="13270" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13275" class="Symbol">→</a> <a id="13277" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13282" class="Symbol">→</a> <a id="13284" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="13287" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="13291" href="Foreign.HaskellTypes.Deriving.html#13259" class="Macro">hsTyName</a> <a id="13300" href="Foreign.HaskellTypes.Deriving.html#13300" class="Bound">agdaTy</a> <a id="13307" href="Foreign.HaskellTypes.Deriving.html#13307" class="Bound">hole</a> <a id="13312" class="Symbol">=</a> <a id="13314" class="Keyword">do</a>
    <a id="13321" href="Foreign.HaskellTypes.Deriving.html#13321" class="Bound">hsTy</a><a id="13325" class="Symbol">@(</a><a id="13327" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="13331" href="Foreign.HaskellTypes.Deriving.html#13331" class="Bound">hsName</a> <a id="13338" class="Symbol">_)</a> <a id="13341" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="13343" href="Foreign.HaskellTypes.Deriving.html#3890" class="Function">solveHsType</a> <a id="13355" href="Foreign.HaskellTypes.Deriving.html#13300" class="Bound">agdaTy</a>
      <a id="13368" class="Keyword">where</a> <a id="13374" class="CatchallClause Symbol">_</a> <a id="13376" class="Symbol">→</a> <a id="13378" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13391" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="13424" href="Foreign.HaskellTypes.Deriving.html#13300" class="Bound">agdaTy</a>
    <a id="13435" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="13441" href="Foreign.HaskellTypes.Deriving.html#13307" class="Bound">hole</a> <a id="13446" class="Symbol">(</a><a id="13447" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="13451" class="Symbol">(</a><a id="13452" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="13457" href="Foreign.HaskellTypes.Deriving.html#13331" class="Bound">hsName</a><a id="13463" class="Symbol">))</a>
</pre></body></html>