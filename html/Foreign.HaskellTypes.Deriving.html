<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Foreign.HaskellTypes.Deriving</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Keyword">module</a> <a id="9" href="Foreign.HaskellTypes.Deriving.html" class="Module">Foreign.HaskellTypes.Deriving</a> <a id="39" class="Keyword">where</a>

<a id="46" class="Keyword">open</a> <a id="51" class="Keyword">import</a> <a id="58" href="Meta.Init.html" class="Module">Meta.Init</a> <a id="68" class="Keyword">hiding</a> <a id="75" class="Symbol">(</a><a id="76" href="Reflection.TCI.html#554" class="Function">TC</a><a id="78" class="Symbol">;</a> <a id="80" href="Reflection.TCI.html#598" class="Function">Monad-TC</a><a id="88" class="Symbol">;</a> <a id="90" href="Reflection.TCI.html#778" class="Function">MonadError-TC</a><a id="103" class="Symbol">)</a>

<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Level.html" class="Module">Level</a> <a id="124" class="Keyword">using</a> <a id="130" class="Symbol">(</a><a id="131" href="Agda.Primitive.html#742" class="Postulate">Level</a><a id="136" class="Symbol">;</a> <a id="138" href="Level.html#521" class="Function">0ℓ</a><a id="140" class="Symbol">)</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="178" class="Keyword">using</a> <a id="184" class="Symbol">(</a><a id="185" href="Agda.Builtin.Reflection.html#9556" class="Postulate">declareData</a><a id="196" class="Symbol">;</a> <a id="198" href="Agda.Builtin.Reflection.html#9602" class="Postulate">defineData</a><a id="208" class="Symbol">;</a> <a id="210" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a><a id="223" class="Symbol">;</a> <a id="225" href="Agda.Builtin.Reflection.html#9970" class="Postulate">pragmaCompile</a><a id="238" class="Symbol">;</a>
                                           <a id="283" href="Agda.Builtin.Reflection.html#12129" class="Postulate">solveInstanceConstraints</a><a id="307" class="Symbol">)</a>
<a id="309" class="Keyword">open</a> <a id="314" class="Keyword">import</a> <a id="321" href="Reflection.html" class="Module">Reflection</a> <a id="332" class="Symbol">as</a> <a id="335" class="Module">R</a> <a id="337" class="Keyword">hiding</a> <a id="344" class="Symbol">(</a><a id="345" href="Reflection.AST.Show.html#1581" class="Primitive">showName</a><a id="353" class="Symbol">;</a> <a id="355" href="Reflection.TCM.Syntax.html#623" class="Function Operator">_&gt;&gt;=_</a><a id="360" class="Symbol">;</a> <a id="362" href="Reflection.TCM.Syntax.html#693" class="Function Operator">_&gt;&gt;_</a><a id="366" class="Symbol">)</a>
<a id="368" class="Keyword">open</a> <a id="373" class="Keyword">import</a> <a id="380" href="Reflection.AST.html" class="Module">Reflection.AST</a> <a id="395" class="Keyword">hiding</a> <a id="402" class="Symbol">(</a><a id="403" href="Reflection.AST.Show.html#1581" class="Primitive">showName</a><a id="411" class="Symbol">)</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Reflection.AST.DeBruijn.html" class="Module">Reflection.AST.DeBruijn</a>
<a id="449" class="Keyword">open</a> <a id="454" class="Keyword">import</a> <a id="461" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="472" class="Keyword">using</a> <a id="478" class="Symbol">(</a><a id="479" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="484" class="Symbol">;</a> <a id="486" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="493" class="Symbol">;</a> <a id="495" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="499" class="Symbol">;</a> <a id="501" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a><a id="510" class="Symbol">;</a> <a id="512" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a><a id="518" class="Symbol">;</a> <a id="520" href="Data.Maybe.Base.html#2264" class="Function Operator">_&lt;∣&gt;_</a><a id="525" class="Symbol">)</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="549" class="Keyword">using</a> <a id="555" class="Symbol">(</a><a id="556" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="557" class="Symbol">;</a> <a id="559" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="561" class="Symbol">)</a>
<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="Data.Integer.Base.html" class="Module">Data.Integer.Base</a> <a id="593" class="Keyword">using</a> <a id="599" class="Symbol">(</a><a id="600" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="601" class="Symbol">)</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="624" class="Keyword">using</a> <a id="630" class="Symbol">(</a><a id="631" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a><a id="634" class="Symbol">;</a> <a id="636" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a><a id="640" class="Symbol">;</a> <a id="642" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a><a id="646" class="Symbol">)</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Data.String.html" class="Module">Data.String</a> <a id="672" class="Keyword">using</a> <a id="678" class="Symbol">(</a><a id="679" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="685" class="Symbol">)</a> <a id="687" class="Keyword">renaming</a> <a id="696" class="Symbol">(</a><a id="697" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="702" class="Symbol">to</a> <a id="705" class="Function Operator">_&amp;_</a><a id="708" class="Symbol">)</a>
<a id="710" class="Keyword">open</a> <a id="715" class="Keyword">import</a> <a id="722" href="Data.Product.html" class="Module">Data.Product</a> <a id="735" class="Keyword">hiding</a> <a id="742" class="Symbol">(</a><a id="743" href="Data.Product.Base.html#2173" class="Function">map</a><a id="746" class="Symbol">;</a> <a id="748" href="Data.Product.Base.html#2747" class="Function">zip</a><a id="751" class="Symbol">;</a> <a id="753" href="Data.Product.html#1353" class="Function">zipWith</a><a id="760" class="Symbol">)</a>
<a id="762" class="Keyword">import</a> <a id="769" href="Data.String.html" class="Module">Data.String</a> <a id="781" class="Symbol">as</a> <a id="784" class="Module">String</a>
<a id="791" class="Keyword">open</a> <a id="796" class="Keyword">import</a> <a id="803" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="813" class="Keyword">open</a> <a id="818" class="Keyword">import</a> <a id="825" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="834" class="Keyword">open</a> <a id="839" class="Keyword">import</a> <a id="846" href="Data.List.html" class="Module">Data.List</a> <a id="856" class="Keyword">hiding</a> <a id="863" class="Symbol">(</a><a id="864" href="Data.List.Base.html#6263" class="Function">lookup</a><a id="870" class="Symbol">;</a> <a id="872" href="Data.List.Base.html#4940" class="Function">fromMaybe</a><a id="881" class="Symbol">)</a>
<a id="883" class="Keyword">open</a> <a id="888" class="Keyword">import</a> <a id="895" href="Data.Char.html" class="Module">Data.Char</a> <a id="905" class="Keyword">using</a> <a id="911" class="Symbol">(</a><a id="912" href="Data.Char.Base.html#1115" class="Primitive">toUpper</a><a id="919" class="Symbol">;</a> <a id="921" href="Data.Char.Base.html#1142" class="Primitive">toLower</a><a id="928" class="Symbol">)</a>
<a id="930" class="Keyword">open</a> <a id="935" class="Keyword">import</a> <a id="942" href="Foreign.Haskell.html" class="Module">Foreign.Haskell</a>
<a id="958" class="Keyword">open</a> <a id="963" class="Keyword">import</a> <a id="970" href="Function.html" class="Module">Function</a>
<a id="979" class="Keyword">open</a> <a id="984" class="Keyword">import</a> <a id="991" href="Text.Printf.html" class="Module">Text.Printf</a>

<a id="1004" class="Keyword">open</a> <a id="1009" class="Keyword">import</a> <a id="1016" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="1028" class="Keyword">open</a> <a id="1033" class="Keyword">import</a> <a id="1040" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="1054" class="Keyword">open</a> <a id="1059" class="Keyword">import</a> <a id="1066" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="1078" class="Keyword">open</a> <a id="1083" class="Keyword">import</a> <a id="1090" href="Class.MonadError.html" class="Module">Class.MonadError</a>
<a id="1107" class="Keyword">open</a> <a id="1112" class="Keyword">import</a> <a id="1119" href="Class.MonadReader.html" class="Module">Class.MonadReader</a>
<a id="1137" class="Keyword">open</a> <a id="1142" class="Keyword">import</a> <a id="1149" href="Class.Show.html" class="Module">Class.Show</a>
<a id="1160" class="Keyword">open</a> <a id="1165" class="Keyword">import</a> <a id="1172" href="Class.Show.Instances.html" class="Module">Class.Show.Instances</a>
<a id="1193" class="Keyword">open</a> <a id="1198" class="Keyword">import</a> <a id="1205" href="Tactic.Derive.Show.html" class="Module">Tactic.Derive.Show</a> <a id="1224" class="Keyword">using</a> <a id="1230" class="Symbol">(</a><a id="1231" href="Tactic.Derive.Show.html#829" class="Function">showName</a><a id="1239" class="Symbol">)</a>

<a id="1242" class="Keyword">open</a> <a id="1247" class="Keyword">import</a> <a id="1254" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="1271" class="Keyword">open</a> <a id="1276" class="Keyword">import</a> <a id="1283" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>
<a id="1304" class="Keyword">open</a> <a id="1309" class="Keyword">import</a> <a id="1316" href="Foreign.HaskellTypes.html" class="Module">Foreign.HaskellTypes</a>
<a id="1337" class="Keyword">open</a> <a id="1342" class="Keyword">import</a> <a id="1349" href="Foreign.Haskell.Pair.html" class="Module">Foreign.Haskell.Pair</a> <a id="1370" class="Keyword">using</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Foreign.Haskell.Pair.html#553" class="Record">Pair</a><a id="1381" class="Symbol">)</a>

<a id="1384" class="Comment">{-
Need to generate:
  - a data type that can be compiled to a Haskell data type
  - the corresponding Haskell type (in a FOREIGN pragma)
  - the COMPILE pragma binding them together
-}</a>

<a id="1571" class="Keyword">private</a> <a id="1579" class="Keyword">variable</a>
  <a id="1590" href="Foreign.HaskellTypes.Deriving.html#1590" class="Generalizable">l</a> <a id="1592" class="Symbol">:</a> <a id="1594" href="Agda.Primitive.html#742" class="Postulate">Level</a>
  <a id="1602" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a> <a id="1604" href="Foreign.HaskellTypes.Deriving.html#1604" class="Generalizable">B</a> <a id="1606" class="Symbol">:</a> <a id="1608" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1612" href="Foreign.HaskellTypes.Deriving.html#1590" class="Generalizable">l</a>

<a id="1615" class="Keyword">private</a>
  <a id="mapHead"></a><a id="1625" href="Foreign.HaskellTypes.Deriving.html#1625" class="Function">mapHead</a> <a id="1633" class="Symbol">:</a> <a id="1635" class="Symbol">(</a><a id="1636" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a> <a id="1638" class="Symbol">→</a> <a id="1640" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a><a id="1641" class="Symbol">)</a> <a id="1643" class="Symbol">→</a> <a id="1645" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1650" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a> <a id="1652" class="Symbol">→</a> <a id="1654" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1659" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a>
  <a id="1663" href="Foreign.HaskellTypes.Deriving.html#1625" class="Function">mapHead</a> <a id="1671" href="Foreign.HaskellTypes.Deriving.html#1671" class="Bound">f</a> <a id="1673" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="1682" class="Symbol">=</a> <a id="1684" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="1689" href="Foreign.HaskellTypes.Deriving.html#1625" class="Function">mapHead</a> <a id="1697" href="Foreign.HaskellTypes.Deriving.html#1697" class="Bound">f</a> <a id="1699" class="Symbol">(</a><a id="1700" href="Foreign.HaskellTypes.Deriving.html#1700" class="Bound">x</a> <a id="1702" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1704" href="Foreign.HaskellTypes.Deriving.html#1704" class="Bound">xs</a><a id="1706" class="Symbol">)</a> <a id="1708" class="Symbol">=</a> <a id="1710" href="Foreign.HaskellTypes.Deriving.html#1697" class="Bound">f</a> <a id="1712" href="Foreign.HaskellTypes.Deriving.html#1700" class="Bound">x</a> <a id="1714" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1716" href="Foreign.HaskellTypes.Deriving.html#1704" class="Bound">xs</a>

  <a id="capitalize"></a><a id="1722" href="Foreign.HaskellTypes.Deriving.html#1722" class="Function">capitalize</a> <a id="1733" class="Symbol">:</a> <a id="1735" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1742" class="Symbol">→</a> <a id="1744" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1753" href="Foreign.HaskellTypes.Deriving.html#1722" class="Function">capitalize</a> <a id="1764" class="Symbol">=</a> <a id="1766" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="1782" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1784" href="Foreign.HaskellTypes.Deriving.html#1625" class="Function">mapHead</a> <a id="1792" href="Data.Char.Base.html#1115" class="Primitive">toUpper</a> <a id="1800" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1802" href="Data.String.Base.html#1558" class="Primitive">String.toList</a>

  <a id="uncapitalize"></a><a id="1819" href="Foreign.HaskellTypes.Deriving.html#1819" class="Function">uncapitalize</a> <a id="1832" class="Symbol">:</a> <a id="1834" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1841" class="Symbol">→</a> <a id="1843" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1852" href="Foreign.HaskellTypes.Deriving.html#1819" class="Function">uncapitalize</a> <a id="1865" class="Symbol">=</a> <a id="1867" href="Data.String.Base.html#1591" class="Primitive">String.fromList</a> <a id="1883" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1885" href="Foreign.HaskellTypes.Deriving.html#1625" class="Function">mapHead</a> <a id="1893" href="Data.Char.Base.html#1142" class="Primitive">toLower</a> <a id="1901" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1903" href="Data.String.Base.html#1558" class="Primitive">String.toList</a>

  <a id="joinStrings"></a><a id="1920" href="Foreign.HaskellTypes.Deriving.html#1920" class="Function">joinStrings</a> <a id="1932" class="Symbol">:</a> <a id="1934" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1941" class="Symbol">→</a> <a id="1943" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1948" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1955" class="Symbol">→</a> <a id="1957" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1966" href="Foreign.HaskellTypes.Deriving.html#1920" class="Function">joinStrings</a> <a id="1978" href="Foreign.HaskellTypes.Deriving.html#1978" class="Bound">sep</a> <a id="1982" href="Foreign.HaskellTypes.Deriving.html#1982" class="Bound">ss</a> <a id="1985" class="Symbol">=</a> <a id="1987" href="Data.List.Base.html#4126" class="Function">foldr</a> <a id="1993" href="Foreign.HaskellTypes.Deriving.html#705" class="Function Operator">_&amp;_</a> <a id="1997" class="String">&quot;&quot;</a> <a id="2000" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="2002" href="Data.List.Base.html#1797" class="Function">intersperse</a> <a id="2014" href="Foreign.HaskellTypes.Deriving.html#1978" class="Bound">sep</a> <a id="2018" href="Foreign.HaskellTypes.Deriving.html#1982" class="Bound">ss</a>

  <a id="_‼_"></a><a id="2024" href="Foreign.HaskellTypes.Deriving.html#2024" class="Function Operator">_‼_</a> <a id="2028" class="Symbol">:</a> <a id="2030" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2035" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a> <a id="2037" class="Symbol">→</a> <a id="2039" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2041" class="Symbol">→</a> <a id="2043" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2049" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a>
  <a id="2053" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="2062" href="Foreign.HaskellTypes.Deriving.html#2024" class="Function Operator">‼</a> <a id="2064" href="Foreign.HaskellTypes.Deriving.html#2064" class="Bound">i</a>     <a id="2070" class="Symbol">=</a> <a id="2072" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
  <a id="2082" class="Symbol">(</a><a id="2083" href="Foreign.HaskellTypes.Deriving.html#2083" class="Bound">x</a> <a id="2085" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2087" href="Foreign.HaskellTypes.Deriving.html#2087" class="Bound">xs</a><a id="2089" class="Symbol">)</a> <a id="2091" href="Foreign.HaskellTypes.Deriving.html#2024" class="Function Operator">‼</a> <a id="2093" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>  <a id="2099" class="Symbol">=</a> <a id="2101" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2106" href="Foreign.HaskellTypes.Deriving.html#2083" class="Bound">x</a>
  <a id="2110" class="Symbol">(</a><a id="2111" href="Foreign.HaskellTypes.Deriving.html#2111" class="Bound">x</a> <a id="2113" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2115" href="Foreign.HaskellTypes.Deriving.html#2115" class="Bound">xs</a><a id="2117" class="Symbol">)</a> <a id="2119" href="Foreign.HaskellTypes.Deriving.html#2024" class="Function Operator">‼</a> <a id="2121" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2125" href="Foreign.HaskellTypes.Deriving.html#2125" class="Bound">i</a> <a id="2127" class="Symbol">=</a> <a id="2129" href="Foreign.HaskellTypes.Deriving.html#2115" class="Bound">xs</a> <a id="2132" href="Foreign.HaskellTypes.Deriving.html#2024" class="Function Operator">‼</a> <a id="2134" href="Foreign.HaskellTypes.Deriving.html#2125" class="Bound">i</a>

  <a id="lookup"></a><a id="2139" href="Foreign.HaskellTypes.Deriving.html#2139" class="Function">lookup</a> <a id="2146" class="Symbol">:</a> <a id="2148" class="Symbol">⦃</a> <a id="2150" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="2156" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a> <a id="2158" class="Symbol">⦄</a> <a id="2160" class="Symbol">→</a> <a id="2162" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a> <a id="2164" class="Symbol">→</a> <a id="2166" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2171" class="Symbol">(</a><a id="2172" href="Foreign.HaskellTypes.Deriving.html#1602" class="Generalizable">A</a> <a id="2174" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2176" href="Foreign.HaskellTypes.Deriving.html#1604" class="Generalizable">B</a><a id="2177" class="Symbol">)</a> <a id="2179" class="Symbol">→</a> <a id="2181" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2187" href="Foreign.HaskellTypes.Deriving.html#1604" class="Generalizable">B</a>
  <a id="2191" href="Foreign.HaskellTypes.Deriving.html#2139" class="Function">lookup</a> <a id="2198" href="Foreign.HaskellTypes.Deriving.html#2198" class="Bound">x</a> <a id="2200" href="Foreign.HaskellTypes.Deriving.html#2200" class="Bound">xs</a> <a id="2203" class="Symbol">=</a> <a id="2205" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2211" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="2215" href="Data.List.Base.html#13474" class="Function">findᵇ</a> <a id="2221" class="Symbol">((</a><a id="2223" href="Foreign.HaskellTypes.Deriving.html#2198" class="Bound">x</a> <a id="2225" href="Class.DecEq.Core.html#197" class="Function Operator">==_</a><a id="2228" class="Symbol">)</a> <a id="2230" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2232" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="2237" class="Symbol">)</a> <a id="2239" href="Foreign.HaskellTypes.Deriving.html#2200" class="Bound">xs</a>

<a id="2243" class="Comment">-- * Controlling the names of the generated types</a>

<a id="2294" class="Keyword">record</a> <a id="Env"></a><a id="2301" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="2305" class="Symbol">:</a> <a id="2307" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2311" class="Keyword">where</a>
  <a id="2319" class="Keyword">field</a>
    <a id="Env.customNames"></a><a id="2329" href="Foreign.HaskellTypes.Deriving.html#2329" class="Field">customNames</a> <a id="2341" class="Symbol">:</a> <a id="2343" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2348" class="Symbol">(</a><a id="2349" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2354" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2356" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2362" class="Symbol">)</a>
    <a id="Env.tName"></a><a id="2368" href="Foreign.HaskellTypes.Deriving.html#2368" class="Field">tName</a>       <a id="2380" class="Symbol">:</a> <a id="2382" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2387" class="Symbol">→</a> <a id="2389" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2395" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="Env.cName"></a><a id="2406" href="Foreign.HaskellTypes.Deriving.html#2406" class="Field">cName</a>       <a id="2418" class="Symbol">:</a> <a id="2420" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2425" class="Symbol">→</a> <a id="2427" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2433" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="Env.fName"></a><a id="2444" href="Foreign.HaskellTypes.Deriving.html#2444" class="Field">fName</a>       <a id="2456" class="Symbol">:</a> <a id="2458" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2463" class="Symbol">→</a> <a id="2465" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2471" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="Env.typeclassDeriving"></a><a id="2482" href="Foreign.HaskellTypes.Deriving.html#2482" class="Field">typeclassDeriving</a> <a id="2500" class="Symbol">:</a> <a id="2502" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2507" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2514" class="Symbol">→</a> <a id="2516" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2521" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="2529" class="Keyword">private</a>
  <a id="lookupEnv"></a><a id="2539" href="Foreign.HaskellTypes.Deriving.html#2539" class="Function">lookupEnv</a> <a id="2549" class="Symbol">:</a> <a id="2551" class="Symbol">(</a><a id="2552" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="2556" class="Symbol">→</a> <a id="2558" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2563" class="Symbol">→</a> <a id="2565" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2571" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2577" class="Symbol">)</a> <a id="2579" class="Symbol">→</a> <a id="2581" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="2585" class="Symbol">→</a> <a id="2587" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2592" class="Symbol">→</a> <a id="2594" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2600" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="2609" href="Foreign.HaskellTypes.Deriving.html#2539" class="Function">lookupEnv</a> <a id="2619" href="Foreign.HaskellTypes.Deriving.html#2619" class="Bound">fn</a> <a id="2622" href="Foreign.HaskellTypes.Deriving.html#2622" class="Bound">env</a> <a id="2626" href="Foreign.HaskellTypes.Deriving.html#2626" class="Bound">x</a> <a id="2628" class="Symbol">=</a> <a id="2630" href="Foreign.HaskellTypes.Deriving.html#2139" class="Function">lookup</a> <a id="2637" href="Foreign.HaskellTypes.Deriving.html#2626" class="Bound">x</a> <a id="2639" class="Symbol">(</a><a id="2640" href="Foreign.HaskellTypes.Deriving.html#2329" class="Field">Env.customNames</a> <a id="2656" href="Foreign.HaskellTypes.Deriving.html#2622" class="Bound">env</a><a id="2659" class="Symbol">)</a> <a id="2661" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="2665" href="Foreign.HaskellTypes.Deriving.html#2619" class="Bound">fn</a> <a id="2668" href="Foreign.HaskellTypes.Deriving.html#2622" class="Bound">env</a> <a id="2672" href="Foreign.HaskellTypes.Deriving.html#2626" class="Bound">x</a>

  <a id="lookupTypeName"></a><a id="2677" href="Foreign.HaskellTypes.Deriving.html#2677" class="Function">lookupTypeName</a>  <a id="2693" class="Symbol">=</a> <a id="2695" href="Foreign.HaskellTypes.Deriving.html#2539" class="Function">lookupEnv</a> <a id="2705" href="Foreign.HaskellTypes.Deriving.html#2368" class="Field">Env.tName</a>
  <a id="lookupConName"></a><a id="2717" href="Foreign.HaskellTypes.Deriving.html#2717" class="Function">lookupConName</a>   <a id="2733" class="Symbol">=</a> <a id="2735" href="Foreign.HaskellTypes.Deriving.html#2539" class="Function">lookupEnv</a> <a id="2745" href="Foreign.HaskellTypes.Deriving.html#2406" class="Field">Env.cName</a>
  <a id="lookupFieldName"></a><a id="2757" href="Foreign.HaskellTypes.Deriving.html#2757" class="Function">lookupFieldName</a> <a id="2773" class="Symbol">=</a> <a id="2775" href="Foreign.HaskellTypes.Deriving.html#2539" class="Function">lookupEnv</a> <a id="2785" href="Foreign.HaskellTypes.Deriving.html#2444" class="Field">Env.fName</a>

  <a id="emptyEnv"></a><a id="2798" href="Foreign.HaskellTypes.Deriving.html#2798" class="Function">emptyEnv</a> <a id="2807" class="Symbol">:</a> <a id="2809" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
  <a id="2815" href="Foreign.HaskellTypes.Deriving.html#2798" class="Function">emptyEnv</a> <a id="2824" class="Symbol">=</a> <a id="2826" class="Keyword">record</a><a id="2832" class="Symbol">{</a> <a id="2834" href="Foreign.HaskellTypes.Deriving.html#2329" class="Field">customNames</a> <a id="2846" class="Symbol">=</a> <a id="2848" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                   <a id="2870" class="Symbol">;</a> <a id="2872" href="Foreign.HaskellTypes.Deriving.html#2368" class="Field">tName</a> <a id="2878" class="Symbol">=</a> <a id="2880" href="Function.Base.html#725" class="Function">const</a> <a id="2886" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2913" class="Symbol">;</a> <a id="2915" href="Foreign.HaskellTypes.Deriving.html#2406" class="Field">cName</a> <a id="2921" class="Symbol">=</a> <a id="2923" href="Function.Base.html#725" class="Function">const</a> <a id="2929" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2956" class="Symbol">;</a> <a id="2958" href="Foreign.HaskellTypes.Deriving.html#2444" class="Field">fName</a> <a id="2964" class="Symbol">=</a> <a id="2966" href="Function.Base.html#725" class="Function">const</a> <a id="2972" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                   <a id="2999" class="Symbol">;</a> <a id="3001" href="Foreign.HaskellTypes.Deriving.html#2482" class="Field">typeclassDeriving</a> <a id="3019" class="Symbol">=</a> <a id="3021" href="Function.Base.html#704" class="Function">id</a> <a id="3024" class="Symbol">}</a>

  <a id="customName"></a><a id="3029" href="Foreign.HaskellTypes.Deriving.html#3029" class="Function">customName</a> <a id="3040" class="Symbol">:</a> <a id="3042" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3047" class="Symbol">→</a> <a id="3049" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3056" class="Symbol">→</a> <a id="3058" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
  <a id="3064" href="Foreign.HaskellTypes.Deriving.html#3029" class="Function">customName</a> <a id="3075" href="Foreign.HaskellTypes.Deriving.html#3075" class="Bound">x</a> <a id="3077" href="Foreign.HaskellTypes.Deriving.html#3077" class="Bound">s</a> <a id="3079" class="Symbol">=</a> <a id="3081" class="Keyword">record</a> <a id="3088" href="Foreign.HaskellTypes.Deriving.html#2798" class="Function">emptyEnv</a> <a id="3097" class="Symbol">{</a> <a id="3099" href="Foreign.HaskellTypes.Deriving.html#2329" class="Field">customNames</a> <a id="3111" class="Symbol">=</a> <a id="3113" class="Symbol">(</a><a id="3114" href="Foreign.HaskellTypes.Deriving.html#3075" class="Bound">x</a> <a id="3116" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3118" href="Foreign.HaskellTypes.Deriving.html#3077" class="Bound">s</a><a id="3119" class="Symbol">)</a> <a id="3121" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3123" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3126" class="Symbol">}</a>

<a id="onTypes"></a><a id="3129" href="Foreign.HaskellTypes.Deriving.html#3129" class="Function">onTypes</a> <a id="3137" class="Symbol">:</a> <a id="3139" class="Symbol">(</a><a id="3140" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3147" class="Symbol">→</a> <a id="3149" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3155" class="Symbol">)</a> <a id="3157" class="Symbol">→</a> <a id="3159" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3163" href="Foreign.HaskellTypes.Deriving.html#3129" class="Function">onTypes</a> <a id="3171" href="Foreign.HaskellTypes.Deriving.html#3171" class="Bound">f</a> <a id="3173" class="Symbol">=</a> <a id="3175" class="Keyword">record</a> <a id="3182" href="Foreign.HaskellTypes.Deriving.html#2798" class="Function">emptyEnv</a> <a id="3191" class="Symbol">{</a> <a id="3193" href="Foreign.HaskellTypes.Deriving.html#2368" class="Field">tName</a> <a id="3199" class="Symbol">=</a> <a id="3201" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3206" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3208" href="Foreign.HaskellTypes.Deriving.html#3171" class="Bound">f</a> <a id="3210" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3212" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="3221" class="Symbol">}</a>

<a id="onConstructors"></a><a id="3224" href="Foreign.HaskellTypes.Deriving.html#3224" class="Function">onConstructors</a> <a id="3239" class="Symbol">:</a> <a id="3241" class="Symbol">(</a><a id="3242" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3249" class="Symbol">→</a> <a id="3251" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3257" class="Symbol">)</a> <a id="3259" class="Symbol">→</a> <a id="3261" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3265" href="Foreign.HaskellTypes.Deriving.html#3224" class="Function">onConstructors</a> <a id="3280" href="Foreign.HaskellTypes.Deriving.html#3280" class="Bound">f</a> <a id="3282" class="Symbol">=</a> <a id="3284" class="Keyword">record</a> <a id="3291" href="Foreign.HaskellTypes.Deriving.html#2798" class="Function">emptyEnv</a> <a id="3300" class="Symbol">{</a> <a id="3302" href="Foreign.HaskellTypes.Deriving.html#2406" class="Field">cName</a> <a id="3308" class="Symbol">=</a> <a id="3310" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3315" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3317" href="Foreign.HaskellTypes.Deriving.html#3280" class="Bound">f</a> <a id="3319" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3321" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="3330" class="Symbol">}</a>

<a id="withName"></a><a id="3333" href="Foreign.HaskellTypes.Deriving.html#3333" class="Function">withName</a> <a id="3342" class="Symbol">:</a> <a id="3344" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3351" class="Symbol">→</a> <a id="3353" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3357" href="Foreign.HaskellTypes.Deriving.html#3333" class="Function">withName</a> <a id="3366" href="Foreign.HaskellTypes.Deriving.html#3366" class="Bound">t</a> <a id="3368" class="Symbol">=</a> <a id="3370" href="Foreign.HaskellTypes.Deriving.html#3129" class="Function">onTypes</a> <a id="3378" class="Symbol">(</a><a id="3379" href="Function.Base.html#725" class="Function">const</a> <a id="3385" href="Foreign.HaskellTypes.Deriving.html#3366" class="Bound">t</a><a id="3386" class="Symbol">)</a>

<a id="3389" class="Comment">-- Only use for single constructor types obviously</a>
<a id="withConstructor"></a><a id="3440" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="3456" class="Symbol">:</a> <a id="3458" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3465" class="Symbol">→</a> <a id="3467" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3471" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="3487" href="Foreign.HaskellTypes.Deriving.html#3487" class="Bound">c</a> <a id="3489" class="Symbol">=</a> <a id="3491" href="Foreign.HaskellTypes.Deriving.html#3224" class="Function">onConstructors</a> <a id="3506" class="Symbol">(</a><a id="3507" href="Function.Base.html#725" class="Function">const</a> <a id="3513" href="Foreign.HaskellTypes.Deriving.html#3487" class="Bound">c</a><a id="3514" class="Symbol">)</a>

<a id="onFields"></a><a id="3517" href="Foreign.HaskellTypes.Deriving.html#3517" class="Function">onFields</a> <a id="3526" class="Symbol">:</a> <a id="3528" class="Symbol">(</a><a id="3529" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3536" class="Symbol">→</a> <a id="3538" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3544" class="Symbol">)</a> <a id="3546" class="Symbol">→</a> <a id="3548" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3552" href="Foreign.HaskellTypes.Deriving.html#3517" class="Function">onFields</a> <a id="3561" href="Foreign.HaskellTypes.Deriving.html#3561" class="Bound">f</a> <a id="3563" class="Symbol">=</a> <a id="3565" class="Keyword">record</a> <a id="3572" href="Foreign.HaskellTypes.Deriving.html#2798" class="Function">emptyEnv</a> <a id="3581" class="Symbol">{</a> <a id="3583" href="Foreign.HaskellTypes.Deriving.html#2444" class="Field">fName</a> <a id="3589" class="Symbol">=</a> <a id="3591" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3596" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3598" href="Foreign.HaskellTypes.Deriving.html#3561" class="Bound">f</a> <a id="3600" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3602" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="3611" class="Symbol">}</a>


<a id="fieldPrefix"></a><a id="3615" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="3627" class="Symbol">:</a> <a id="3629" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3636" class="Symbol">→</a> <a id="3638" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3642" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="3654" href="Foreign.HaskellTypes.Deriving.html#3654" class="Bound">pre</a> <a id="3658" class="Symbol">=</a> <a id="3660" href="Foreign.HaskellTypes.Deriving.html#3517" class="Function">onFields</a> <a id="3669" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3671" class="Symbol">(</a><a id="3672" href="Foreign.HaskellTypes.Deriving.html#3654" class="Bound">pre</a> <a id="3676" href="Data.String.Base.html#2425" class="Function Operator">String.++_</a><a id="3686" class="Symbol">)</a> <a id="3688" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3690" href="Foreign.HaskellTypes.Deriving.html#1722" class="Function">capitalize</a>

<a id="deriving"></a><a id="3702" href="Foreign.HaskellTypes.Deriving.html#3702" class="Function">deriving</a> <a id="3711" class="Symbol">:</a> <a id="3713" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3718" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3725" class="Symbol">→</a> <a id="3727" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3731" href="Foreign.HaskellTypes.Deriving.html#3702" class="Function">deriving</a> <a id="3740" href="Foreign.HaskellTypes.Deriving.html#3740" class="Bound">xs</a> <a id="3743" class="Symbol">=</a> <a id="3745" class="Keyword">record</a> <a id="3752" href="Foreign.HaskellTypes.Deriving.html#2798" class="Function">emptyEnv</a> <a id="3761" class="Symbol">{</a> <a id="3763" href="Foreign.HaskellTypes.Deriving.html#2482" class="Field">typeclassDeriving</a> <a id="3781" class="Symbol">=</a> <a id="3783" href="Function.Base.html#725" class="Function">const</a> <a id="3789" href="Foreign.HaskellTypes.Deriving.html#3740" class="Bound">xs</a> <a id="3792" class="Symbol">}</a>

<a id="withDefaultDeriving"></a><a id="3795" href="Foreign.HaskellTypes.Deriving.html#3795" class="Function">withDefaultDeriving</a> <a id="3815" class="Symbol">:</a> <a id="3817" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3821" href="Foreign.HaskellTypes.Deriving.html#3795" class="Function">withDefaultDeriving</a> <a id="3841" class="Symbol">=</a> <a id="3843" href="Foreign.HaskellTypes.Deriving.html#3702" class="Function">deriving</a> <a id="3852" class="Symbol">(</a><a id="3853" class="String">&quot;Show&quot;</a> <a id="3860" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3862" class="String">&quot;Eq&quot;</a> <a id="3867" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3869" class="String">&quot;Generic&quot;</a> <a id="3879" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3881" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3883" class="Symbol">)</a>

<a id="3886" class="Keyword">infixr</a> <a id="3893" class="Number">5</a> <a id="3895" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">_•_</a>
<a id="_•_"></a><a id="3899" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">_•_</a> <a id="3903" class="Symbol">:</a> <a id="3905" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="3909" class="Symbol">→</a> <a id="3911" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="3915" class="Symbol">→</a> <a id="3917" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a>
<a id="3921" href="Foreign.HaskellTypes.Deriving.html#3921" class="Bound">env</a> <a id="3925" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3927" href="Foreign.HaskellTypes.Deriving.html#3927" class="Bound">env₁</a> <a id="3932" class="Symbol">=</a> <a id="3934" class="Keyword">record</a>
  <a id="3943" class="Symbol">{</a> <a id="3945" href="Foreign.HaskellTypes.Deriving.html#2329" class="Field">customNames</a> <a id="3957" class="Symbol">=</a> <a id="3959" href="Foreign.HaskellTypes.Deriving.html#2329" class="Function">env.customNames</a> <a id="3975" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="3978" href="Foreign.HaskellTypes.Deriving.html#2329" class="Field">env₁.customNames</a>
  <a id="3997" class="Symbol">;</a> <a id="3999" href="Foreign.HaskellTypes.Deriving.html#2368" class="Field">tName</a>       <a id="4011" class="Symbol">=</a> <a id="4013" class="Symbol">λ</a> <a id="4015" href="Foreign.HaskellTypes.Deriving.html#4015" class="Bound">x</a> <a id="4017" class="Symbol">→</a> <a id="4019" href="Foreign.HaskellTypes.Deriving.html#2368" class="Function">env.tName</a> <a id="4029" href="Foreign.HaskellTypes.Deriving.html#4015" class="Bound">x</a> <a id="4031" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="4035" href="Foreign.HaskellTypes.Deriving.html#2368" class="Field">env₁.tName</a> <a id="4046" href="Foreign.HaskellTypes.Deriving.html#4015" class="Bound">x</a>
  <a id="4050" class="Symbol">;</a> <a id="4052" href="Foreign.HaskellTypes.Deriving.html#2406" class="Field">cName</a>       <a id="4064" class="Symbol">=</a> <a id="4066" class="Symbol">λ</a> <a id="4068" href="Foreign.HaskellTypes.Deriving.html#4068" class="Bound">x</a> <a id="4070" class="Symbol">→</a> <a id="4072" href="Foreign.HaskellTypes.Deriving.html#2406" class="Function">env.cName</a> <a id="4082" href="Foreign.HaskellTypes.Deriving.html#4068" class="Bound">x</a> <a id="4084" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="4088" href="Foreign.HaskellTypes.Deriving.html#2406" class="Field">env₁.cName</a> <a id="4099" href="Foreign.HaskellTypes.Deriving.html#4068" class="Bound">x</a>
  <a id="4103" class="Symbol">;</a> <a id="4105" href="Foreign.HaskellTypes.Deriving.html#2444" class="Field">fName</a>       <a id="4117" class="Symbol">=</a> <a id="4119" class="Symbol">λ</a> <a id="4121" href="Foreign.HaskellTypes.Deriving.html#4121" class="Bound">x</a> <a id="4123" class="Symbol">→</a> <a id="4125" href="Foreign.HaskellTypes.Deriving.html#2444" class="Function">env.fName</a> <a id="4135" href="Foreign.HaskellTypes.Deriving.html#4121" class="Bound">x</a> <a id="4137" href="Data.Maybe.Base.html#2264" class="Function Operator">&lt;∣&gt;</a> <a id="4141" href="Foreign.HaskellTypes.Deriving.html#2444" class="Field">env₁.fName</a> <a id="4152" href="Foreign.HaskellTypes.Deriving.html#4121" class="Bound">x</a>
  <a id="4156" class="Symbol">;</a> <a id="4158" href="Foreign.HaskellTypes.Deriving.html#2482" class="Field">typeclassDeriving</a> <a id="4176" class="Symbol">=</a> <a id="4178" href="Foreign.HaskellTypes.Deriving.html#2482" class="Field">env₁.typeclassDeriving</a> <a id="4201" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4203" href="Foreign.HaskellTypes.Deriving.html#2482" class="Function">env.typeclassDeriving</a>
  <a id="4227" class="Symbol">}</a>
  <a id="4231" class="Keyword">where</a>
    <a id="4241" class="Keyword">module</a> <a id="4248" href="Foreign.HaskellTypes.Deriving.html#4248" class="Module">env</a>  <a id="4253" class="Symbol">=</a> <a id="4255" href="Foreign.HaskellTypes.Deriving.html#2301" class="Module">Env</a> <a id="4259" href="Foreign.HaskellTypes.Deriving.html#3921" class="Bound">env</a>
    <a id="4267" class="Keyword">module</a> <a id="4274" href="Foreign.HaskellTypes.Deriving.html#4274" class="Module">env₁</a> <a id="4279" class="Symbol">=</a> <a id="4281" href="Foreign.HaskellTypes.Deriving.html#2301" class="Module">Env</a> <a id="4285" href="Foreign.HaskellTypes.Deriving.html#3927" class="Bound">env₁</a>


<a id="4292" class="Comment">-- * The inner workings</a>

<a id="solveHsType"></a><a id="4317" href="Foreign.HaskellTypes.Deriving.html#4317" class="Function">solveHsType</a> <a id="4329" class="Symbol">:</a> <a id="4331" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4336" class="Symbol">→</a> <a id="4338" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="4341" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="4346" href="Foreign.HaskellTypes.Deriving.html#4317" class="Function">solveHsType</a> <a id="4358" href="Foreign.HaskellTypes.Deriving.html#4358" class="Bound">tm</a> <a id="4361" class="Symbol">=</a> <a id="4363" class="Keyword">do</a>
  <a id="4368" href="Foreign.HaskellTypes.Deriving.html#4368" class="Bound">hsTy</a> <a id="4373" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4375" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="4385" class="Symbol">(</a><a id="4386" class="Keyword">quote</a> <a id="4392" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4399" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="4402" href="Foreign.HaskellTypes.Deriving.html#4358" class="Bound">tm</a> <a id="4405" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="4406" class="Symbol">)</a> <a id="4408" href="Reflection.Syntax.html#3546" class="InductiveConstructor">`Set</a>
  <a id="4415" href="Agda.Builtin.Reflection.html#12129" class="Postulate">solveInstanceConstraints</a>
  <a id="4442" href="Agda.Builtin.Reflection.html#8972" class="Postulate">normalise</a> <a id="4452" href="Foreign.HaskellTypes.Deriving.html#4368" class="Bound">hsTy</a> <a id="4457" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="4461" class="Symbol">λ</a> <a id="4463" class="Keyword">where</a>
    <a id="4473" class="Symbol">(</a><a id="4474" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="4478" class="Symbol">(</a><a id="4479" class="Keyword">quote</a> <a id="4485" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a><a id="4491" class="Symbol">)</a> <a id="4493" class="Symbol">_)</a> <a id="4496" class="Symbol">→</a> <a id="4498" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="4511" class="String">&quot;Failed to solve HsType %t&quot;</a> <a id="4539" href="Foreign.HaskellTypes.Deriving.html#4358" class="Bound">tm</a>
    <a id="4546" href="Foreign.HaskellTypes.Deriving.html#4546" class="CatchallClause Bound">hsTy</a>                   <a id="4569" class="Symbol">→</a> <a id="4571" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="4578" href="Foreign.HaskellTypes.Deriving.html#4546" class="Bound">hsTy</a>

<a id="4584" class="Keyword">private</a>
  <a id="debug"></a><a id="4594" href="Foreign.HaskellTypes.Deriving.html#4594" class="Function">debug</a> <a id="4600" class="Symbol">=</a> <a id="4602" href="Reflection.TCM.Format.html#2726" class="Function">debugPrintFmt</a> <a id="4616" class="String">&quot;tactic.hs-types&quot;</a>

  <a id="specialHsTypes"></a><a id="4637" href="Foreign.HaskellTypes.Deriving.html#4637" class="Function">specialHsTypes</a> <a id="4652" class="Symbol">:</a> <a id="4654" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4659" class="Symbol">(</a><a id="4660" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="4665" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4667" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="4673" class="Symbol">)</a>
  <a id="4677" href="Foreign.HaskellTypes.Deriving.html#4637" class="Function">specialHsTypes</a> <a id="4692" class="Symbol">=</a> <a id="4694" class="Symbol">(</a><a id="4695" class="Keyword">quote</a> <a id="4701" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>      <a id="4708" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4710" class="String">&quot;()&quot;</a><a id="4714" class="Symbol">)</a>
                 <a id="4733" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4735" class="Symbol">(</a><a id="4736" class="Keyword">quote</a> <a id="4742" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>      <a id="4749" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4751" class="String">&quot;Integer&quot;</a><a id="4760" class="Symbol">)</a>
                 <a id="4779" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4781" class="Symbol">(</a><a id="4782" class="Keyword">quote</a> <a id="4788" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>      <a id="4795" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4797" class="String">&quot;Integer&quot;</a><a id="4806" class="Symbol">)</a>
                 <a id="4825" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4827" class="Symbol">(</a><a id="4828" class="Keyword">quote</a> <a id="4834" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>   <a id="4841" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4843" class="String">&quot;Bool&quot;</a><a id="4849" class="Symbol">)</a>
                 <a id="4868" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4870" class="Symbol">(</a><a id="4871" class="Keyword">quote</a> <a id="4877" href="Agda.Builtin.List.html#147" class="Datatype">List</a>   <a id="4884" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4886" class="String">&quot;[]&quot;</a><a id="4890" class="Symbol">)</a>
                 <a id="4909" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4911" class="Symbol">(</a><a id="4912" class="Keyword">quote</a> <a id="4918" href="Foreign.Haskell.Pair.html#553" class="Record">Pair</a>   <a id="4925" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4927" class="String">&quot;(,)&quot;</a><a id="4932" class="Symbol">)</a>
                 <a id="4951" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4953" class="Symbol">(</a><a id="4954" class="Keyword">quote</a> <a id="4960" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="4967" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4969" class="String">&quot;Maybe&quot;</a><a id="4976" class="Symbol">)</a>
                 <a id="4995" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4997" class="Symbol">(</a><a id="4998" class="Keyword">quote</a> <a id="5004" href="Foreign.Haskell.Either.html#558" class="Datatype">Either</a> <a id="5011" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5013" class="String">&quot;Either&quot;</a><a id="5021" class="Symbol">)</a>
                 <a id="5040" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5042" class="Symbol">(</a><a id="5043" class="Keyword">quote</a> <a id="5049" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="5056" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5058" class="String">&quot;Data.Text.Text&quot;</a><a id="5074" class="Symbol">)</a>
                 <a id="5093" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5095" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="hsTypeName"></a><a id="5101" href="Foreign.HaskellTypes.Deriving.html#5101" class="Function">hsTypeName</a> <a id="5112" class="Symbol">:</a> <a id="5114" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="5118" class="Symbol">→</a> <a id="5120" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5125" class="Symbol">→</a> <a id="5127" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="5136" href="Foreign.HaskellTypes.Deriving.html#5101" class="Function">hsTypeName</a> <a id="5147" href="Foreign.HaskellTypes.Deriving.html#5147" class="Bound">env</a> <a id="5151" href="Foreign.HaskellTypes.Deriving.html#5151" class="Bound">d</a> <a id="5153" class="Symbol">=</a> <a id="5155" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="5165" class="Symbol">(</a><a id="5166" href="Foreign.HaskellTypes.Deriving.html#1722" class="Function">capitalize</a> <a id="5177" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="5179" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="5188" href="Foreign.HaskellTypes.Deriving.html#5151" class="Bound">d</a><a id="5189" class="Symbol">)</a> <a id="5191" class="Symbol">(</a><a id="5192" href="Foreign.HaskellTypes.Deriving.html#2677" class="Function">lookupTypeName</a> <a id="5207" href="Foreign.HaskellTypes.Deriving.html#5147" class="Bound">env</a> <a id="5211" href="Foreign.HaskellTypes.Deriving.html#5151" class="Bound">d</a><a id="5212" class="Symbol">)</a>

  <a id="freshHsTypeName"></a><a id="5217" href="Foreign.HaskellTypes.Deriving.html#5217" class="Function">freshHsTypeName</a> <a id="5233" class="Symbol">:</a> <a id="5235" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="5239" class="Symbol">→</a> <a id="5241" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5246" class="Symbol">→</a> <a id="5248" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5251" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="5258" href="Foreign.HaskellTypes.Deriving.html#5217" class="Function">freshHsTypeName</a> <a id="5274" href="Foreign.HaskellTypes.Deriving.html#5274" class="Bound">env</a> <a id="5278" href="Foreign.HaskellTypes.Deriving.html#5278" class="Bound">d</a> <a id="5280" class="Symbol">=</a> <a id="5282" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5292" class="Symbol">(</a><a id="5293" href="Foreign.HaskellTypes.Deriving.html#5101" class="Function">hsTypeName</a> <a id="5304" href="Foreign.HaskellTypes.Deriving.html#5274" class="Bound">env</a> <a id="5308" href="Foreign.HaskellTypes.Deriving.html#5278" class="Bound">d</a><a id="5309" class="Symbol">)</a>

  <a id="hsConName"></a><a id="5314" href="Foreign.HaskellTypes.Deriving.html#5314" class="Function">hsConName</a> <a id="5324" class="Symbol">:</a> <a id="5326" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="5330" class="Symbol">→</a> <a id="5332" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5337" class="Symbol">→</a> <a id="5339" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="5348" href="Foreign.HaskellTypes.Deriving.html#5314" class="Function">hsConName</a> <a id="5358" href="Foreign.HaskellTypes.Deriving.html#5358" class="Bound">env</a> <a id="5362" href="Foreign.HaskellTypes.Deriving.html#5362" class="Bound">c</a> <a id="5364" class="Symbol">=</a> <a id="5366" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="5376" class="Symbol">(</a><a id="5377" href="Foreign.HaskellTypes.Deriving.html#1722" class="Function">capitalize</a> <a id="5388" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="5390" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="5399" href="Foreign.HaskellTypes.Deriving.html#5362" class="Bound">c</a><a id="5400" class="Symbol">)</a> <a id="5402" class="Symbol">(</a><a id="5403" href="Foreign.HaskellTypes.Deriving.html#2717" class="Function">lookupConName</a> <a id="5417" href="Foreign.HaskellTypes.Deriving.html#5358" class="Bound">env</a> <a id="5421" href="Foreign.HaskellTypes.Deriving.html#5362" class="Bound">c</a><a id="5422" class="Symbol">)</a>

  <a id="hsFieldName"></a><a id="5427" href="Foreign.HaskellTypes.Deriving.html#5427" class="Function">hsFieldName</a> <a id="5439" class="Symbol">:</a> <a id="5441" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="5445" class="Symbol">→</a> <a id="5447" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5452" class="Symbol">→</a> <a id="5454" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="5463" href="Foreign.HaskellTypes.Deriving.html#5427" class="Function">hsFieldName</a> <a id="5475" href="Foreign.HaskellTypes.Deriving.html#5475" class="Bound">env</a> <a id="5479" href="Foreign.HaskellTypes.Deriving.html#5479" class="Bound">f</a> <a id="5481" class="Symbol">=</a> <a id="5483" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="5493" class="Symbol">(</a><a id="5494" href="Foreign.HaskellTypes.Deriving.html#1819" class="Function">uncapitalize</a> <a id="5507" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="5509" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="5518" href="Foreign.HaskellTypes.Deriving.html#5479" class="Bound">f</a><a id="5519" class="Symbol">)</a> <a id="5521" class="Symbol">(</a><a id="5522" href="Foreign.HaskellTypes.Deriving.html#2757" class="Function">lookupFieldName</a> <a id="5538" href="Foreign.HaskellTypes.Deriving.html#5475" class="Bound">env</a> <a id="5542" href="Foreign.HaskellTypes.Deriving.html#5479" class="Bound">f</a><a id="5543" class="Symbol">)</a>

  <a id="freshHsConName"></a><a id="5548" href="Foreign.HaskellTypes.Deriving.html#5548" class="Function">freshHsConName</a> <a id="5563" class="Symbol">:</a> <a id="5565" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="5569" class="Symbol">→</a> <a id="5571" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5576" class="Symbol">→</a> <a id="5578" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5583" class="Symbol">→</a> <a id="5585" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5588" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="5595" href="Foreign.HaskellTypes.Deriving.html#5548" class="Function">freshHsConName</a> <a id="5610" href="Foreign.HaskellTypes.Deriving.html#5610" class="Bound">env</a> <a id="5614" href="Foreign.HaskellTypes.Deriving.html#5614" class="Bound">tyName</a> <a id="5621" href="Foreign.HaskellTypes.Deriving.html#5621" class="Bound">c</a> <a id="5623" class="Symbol">=</a>
    <a id="5629" href="Data.Bool.Base.html#1515" class="Function Operator">if</a> <a id="5632" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="5641" href="Foreign.HaskellTypes.Deriving.html#5621" class="Bound">c</a> <a id="5643" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5646" class="String">&quot;constructor&quot;</a>
    <a id="5664" href="Data.Bool.Base.html#1515" class="Function Operator">then</a> <a id="5669" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5679" class="Symbol">(</a><a id="5680" href="Foreign.HaskellTypes.Deriving.html#5314" class="Function">hsConName</a> <a id="5690" href="Foreign.HaskellTypes.Deriving.html#5610" class="Bound">env</a> <a id="5694" href="Foreign.HaskellTypes.Deriving.html#5614" class="Bound">tyName</a><a id="5700" class="Symbol">)</a> <a id="5702" class="Comment">-- Unnamed record constructor: use type name</a>
    <a id="5751" href="Data.Bool.Base.html#1515" class="Function Operator">else</a> <a id="5756" href="Agda.Builtin.Reflection.html#9430" class="Postulate">freshName</a> <a id="5766" class="Symbol">(</a><a id="5767" href="Foreign.HaskellTypes.Deriving.html#5314" class="Function">hsConName</a> <a id="5777" href="Foreign.HaskellTypes.Deriving.html#5610" class="Bound">env</a> <a id="5781" href="Foreign.HaskellTypes.Deriving.html#5621" class="Bound">c</a><a id="5782" class="Symbol">)</a>

  <a id="isThis"></a><a id="5787" href="Foreign.HaskellTypes.Deriving.html#5787" class="Function">isThis</a> <a id="5794" class="Symbol">:</a> <a id="5796" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5801" class="Symbol">→</a> <a id="5803" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5808" class="Symbol">→</a> <a id="5810" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="5817" href="Foreign.HaskellTypes.Deriving.html#5787" class="Function">isThis</a> <a id="5824" href="Foreign.HaskellTypes.Deriving.html#5824" class="Bound">f</a> <a id="5826" class="Symbol">(</a><a id="5827" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="5831" href="Foreign.HaskellTypes.Deriving.html#5831" class="Bound">g</a> <a id="5833" class="Symbol">_)</a> <a id="5836" class="Symbol">=</a> <a id="5838" href="Foreign.HaskellTypes.Deriving.html#5824" class="Bound">f</a> <a id="5840" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5843" href="Foreign.HaskellTypes.Deriving.html#5831" class="Bound">g</a>
  <a id="5847" href="Foreign.HaskellTypes.Deriving.html#5787" class="CatchallClause Function">isThis</a><a id="5853" class="CatchallClause"> </a><a id="5854" class="CatchallClause Symbol">_</a><a id="5855" class="CatchallClause"> </a><a id="5856" class="CatchallClause Symbol">_</a> <a id="5858" class="Symbol">=</a> <a id="5860" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

  <a id="computeHsType"></a><a id="5869" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="5883" class="Symbol">:</a> <a id="5885" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5890" class="Symbol">→</a> <a id="5892" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="5897" class="Symbol">→</a> <a id="5899" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="5904" class="Symbol">→</a> <a id="5906" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="5909" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="5916" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="5930" href="Foreign.HaskellTypes.Deriving.html#5930" class="Bound">aThis</a> <a id="5936" href="Foreign.HaskellTypes.Deriving.html#5936" class="Bound">hThis</a> <a id="5942" href="Foreign.HaskellTypes.Deriving.html#5942" class="Bound">tm</a> <a id="5945" class="Keyword">with</a> <a id="5950" href="Foreign.HaskellTypes.Deriving.html#5787" class="Function">isThis</a> <a id="5957" href="Foreign.HaskellTypes.Deriving.html#5930" class="Bound">aThis</a> <a id="5963" href="Foreign.HaskellTypes.Deriving.html#5942" class="Bound">tm</a>
  <a id="5968" class="Symbol">...</a> <a id="5972" class="Symbol">|</a> <a id="5974" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="5979" class="Symbol">=</a> <a id="5981" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="5986" class="Symbol">(</a><a id="5987" class="Bound">hThis</a> <a id="5993" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a><a id="5994" class="Symbol">)</a>
  <a id="5998" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="6012" href="Foreign.HaskellTypes.Deriving.html#6012" class="Bound">aThis</a> <a id="6018" href="Foreign.HaskellTypes.Deriving.html#6018" class="Bound">hThis</a> <a id="6024" class="Symbol">(</a><a id="6025" href="Reflection.AST.Term.html#2159" class="InductiveConstructor Operator">Π[</a> <a id="6028" href="Foreign.HaskellTypes.Deriving.html#6028" class="Bound">x</a> <a id="6030" href="Reflection.AST.Term.html#2159" class="InductiveConstructor Operator">∶</a> <a id="6032" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="6036" class="Symbol">(</a><a id="6037" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">arg-info</a> <a id="6046" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="6054" class="Symbol">_)</a> <a id="6057" href="Foreign.HaskellTypes.Deriving.html#6057" class="Bound">a</a> <a id="6059" href="Reflection.AST.Term.html#2159" class="InductiveConstructor Operator">]</a> <a id="6061" href="Foreign.HaskellTypes.Deriving.html#6061" class="Bound">b</a><a id="6062" class="Symbol">)</a> <a id="6064" class="Symbol">|</a> <a id="6066" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="6072" class="Symbol">=</a> <a id="6074" class="Keyword">do</a>
    <a id="6081" href="Foreign.HaskellTypes.Deriving.html#6081" class="Bound">dom</a> <a id="6085" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6087" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="6101" href="Foreign.HaskellTypes.Deriving.html#6012" class="Bound">aThis</a> <a id="6107" href="Foreign.HaskellTypes.Deriving.html#6018" class="Bound">hThis</a> <a id="6113" href="Foreign.HaskellTypes.Deriving.html#6057" class="Bound">a</a>
    <a id="6119" href="Foreign.HaskellTypes.Deriving.html#6119" class="Bound">rng</a> <a id="6123" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6125" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="6139" href="Foreign.HaskellTypes.Deriving.html#6028" class="Bound">x</a> <a id="6141" class="Symbol">(</a><a id="6142" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="6147" href="Foreign.HaskellTypes.Deriving.html#6057" class="Bound">a</a><a id="6148" class="Symbol">)</a> <a id="6150" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="6152" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="6166" href="Foreign.HaskellTypes.Deriving.html#6012" class="Bound">aThis</a> <a id="6172" href="Foreign.HaskellTypes.Deriving.html#6018" class="Bound">hThis</a> <a id="6178" href="Foreign.HaskellTypes.Deriving.html#6061" class="Bound">b</a>
    <a id="6184" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6189" class="Symbol">(</a><a id="6190" href="Reflection.AST.Term.html#2204" class="InductiveConstructor Operator">vΠ[</a> <a id="6194" href="Foreign.HaskellTypes.Deriving.html#6028" class="Bound">x</a> <a id="6196" href="Reflection.AST.Term.html#2204" class="InductiveConstructor Operator">∶</a> <a id="6198" href="Foreign.HaskellTypes.Deriving.html#6081" class="Bound">dom</a> <a id="6202" href="Reflection.AST.Term.html#2204" class="InductiveConstructor Operator">]</a> <a id="6204" href="Foreign.HaskellTypes.Deriving.html#6119" class="Bound">rng</a><a id="6207" class="Symbol">)</a>
  <a id="6211" href="Foreign.HaskellTypes.Deriving.html#5869" class="CatchallClause Function">computeHsType</a><a id="6224" class="CatchallClause"> </a><a id="6225" href="Foreign.HaskellTypes.Deriving.html#6225" class="CatchallClause Bound">aThis</a><a id="6230" class="CatchallClause"> </a><a id="6231" href="Foreign.HaskellTypes.Deriving.html#6231" class="CatchallClause Bound">hThis</a><a id="6236" class="CatchallClause"> </a><a id="6237" class="CatchallClause Symbol">(</a><a id="6238" href="Reflection.AST.Term.html#2159" class="CatchallClause InductiveConstructor Operator">Π[</a><a id="6240" class="CatchallClause"> </a><a id="6241" href="Foreign.HaskellTypes.Deriving.html#6241" class="CatchallClause Bound">x</a><a id="6242" class="CatchallClause"> </a><a id="6243" href="Reflection.AST.Term.html#2159" class="CatchallClause InductiveConstructor Operator">∶</a><a id="6244" class="CatchallClause"> </a><a id="6245" href="Foreign.HaskellTypes.Deriving.html#6245" class="CatchallClause Bound">a</a><a id="6246" class="CatchallClause"> </a><a id="6247" href="Reflection.AST.Term.html#2159" class="CatchallClause InductiveConstructor Operator">]</a><a id="6248" class="CatchallClause"> </a><a id="6249" href="Foreign.HaskellTypes.Deriving.html#6249" class="CatchallClause Bound">b</a><a id="6250" class="CatchallClause Symbol">)</a><a id="6251" class="CatchallClause"> </a><a id="6252" class="CatchallClause Symbol">|</a><a id="6253" class="CatchallClause"> </a><a id="6254" href="Agda.Builtin.Bool.html#192" class="CatchallClause InductiveConstructor">false</a> <a id="6260" class="Symbol">=</a> <a id="6262" class="Keyword">do</a>
    <a id="6269" href="Foreign.HaskellTypes.Deriving.html#6269" class="Bound">ty</a> <a id="6272" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6274" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="6288" href="Foreign.HaskellTypes.Deriving.html#6241" class="Bound">x</a> <a id="6290" href="Foreign.HaskellTypes.Deriving.html#6245" class="Bound">a</a> <a id="6292" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="6294" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="6308" href="Foreign.HaskellTypes.Deriving.html#6225" class="Bound">aThis</a> <a id="6314" href="Foreign.HaskellTypes.Deriving.html#6231" class="Bound">hThis</a> <a id="6320" href="Foreign.HaskellTypes.Deriving.html#6249" class="Bound">b</a>
    <a id="6326" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6331" href="Foreign.HaskellTypes.Deriving.html#6331" class="Bound">ty′</a> <a id="6335" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6337" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6342" class="Symbol">(</a><a id="6343" href="Reflection.AST.DeBruijn.html#3451" class="Function">strengthen</a> <a id="6354" href="Foreign.HaskellTypes.Deriving.html#6269" class="Bound">ty</a><a id="6356" class="Symbol">)</a>
      <a id="6364" class="Keyword">where</a> <a id="6370" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6378" class="Symbol">→</a> <a id="6380" href="Agda.Builtin.Reflection.html#9292" class="Postulate">extendContext</a> <a id="6394" href="Foreign.HaskellTypes.Deriving.html#6241" class="Bound">x</a> <a id="6396" href="Foreign.HaskellTypes.Deriving.html#6245" class="Bound">a</a> <a id="6398" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="6400" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="6413" class="String">&quot;%s free in computed HsType %t&quot;</a> <a id="6445" href="Foreign.HaskellTypes.Deriving.html#6241" class="Bound">x</a> <a id="6447" href="Foreign.HaskellTypes.Deriving.html#6269" class="Bound">ty</a>
    <a id="6454" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6459" href="Foreign.HaskellTypes.Deriving.html#6331" class="Bound">ty′</a>
  <a id="6465" class="Comment">-- Hack to get recursive occurrences under lists to work</a>
  <a id="6524" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="6538" href="Foreign.HaskellTypes.Deriving.html#6538" class="Bound">aThis</a> <a id="6544" href="Foreign.HaskellTypes.Deriving.html#6544" class="Bound">hThis</a> <a id="6550" class="Symbol">(</a><a id="6551" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="6555" class="Symbol">(</a><a id="6556" class="Keyword">quote</a> <a id="6562" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="6566" class="Symbol">)</a> <a id="6568" class="Symbol">(_</a> <a id="6571" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6573" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="6578" href="Foreign.HaskellTypes.Deriving.html#6578" class="Bound">a</a> <a id="6580" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6582" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6584" class="Symbol">))</a> <a id="6587" class="Symbol">|</a> <a id="6589" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="6595" class="Symbol">=</a> <a id="6597" class="Keyword">do</a>
    <a id="6604" href="Foreign.HaskellTypes.Deriving.html#6604" class="Bound">ty</a> <a id="6607" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6609" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="6623" href="Foreign.HaskellTypes.Deriving.html#6538" class="Bound">aThis</a> <a id="6629" href="Foreign.HaskellTypes.Deriving.html#6544" class="Bound">hThis</a> <a id="6635" href="Foreign.HaskellTypes.Deriving.html#6578" class="Bound">a</a>
    <a id="6641" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6646" class="Symbol">(</a><a id="6647" class="Keyword">quote</a> <a id="6653" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6658" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="6661" href="Foreign.HaskellTypes.Deriving.html#6604" class="Bound">ty</a> <a id="6664" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="6665" class="Symbol">)</a>
  <a id="6669" href="Foreign.HaskellTypes.Deriving.html#5869" class="CatchallClause Function">computeHsType</a><a id="6682" class="CatchallClause"> </a><a id="6683" class="CatchallClause Symbol">_</a><a id="6684" class="CatchallClause"> </a><a id="6685" class="CatchallClause Symbol">_</a><a id="6686" class="CatchallClause"> </a><a id="6687" href="Foreign.HaskellTypes.Deriving.html#6687" class="CatchallClause Bound">tm</a><a id="6689" class="CatchallClause"> </a><a id="6690" class="CatchallClause Symbol">|</a><a id="6691" class="CatchallClause"> </a><a id="6692" href="Agda.Builtin.Bool.html#192" class="CatchallClause InductiveConstructor">false</a> <a id="6698" class="Symbol">=</a> <a id="6700" class="Keyword">do</a>
    <a id="6707" href="Foreign.HaskellTypes.Deriving.html#4594" class="Function">debug</a> <a id="6713" class="Number">10</a> <a id="6716" class="String">&quot;solving HsType %t&quot;</a> <a id="6736" href="Foreign.HaskellTypes.Deriving.html#6687" class="Bound">tm</a>
    <a id="6743" href="Foreign.HaskellTypes.Deriving.html#6743" class="Bound">ty</a> <a id="6746" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6748" href="Foreign.HaskellTypes.Deriving.html#4317" class="Function">solveHsType</a> <a id="6760" href="Foreign.HaskellTypes.Deriving.html#6687" class="Bound">tm</a>
    <a id="6767" href="Foreign.HaskellTypes.Deriving.html#4594" class="Function">debug</a> <a id="6773" class="Number">10</a> <a id="6776" class="String">&quot;HsType %t = %t&quot;</a> <a id="6793" href="Foreign.HaskellTypes.Deriving.html#6687" class="Bound">tm</a> <a id="6796" href="Foreign.HaskellTypes.Deriving.html#6743" class="Bound">ty</a>
    <a id="6803" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="6808" href="Foreign.HaskellTypes.Deriving.html#6743" class="Bound">ty</a>

  <a id="makeHsCon"></a><a id="6814" href="Foreign.HaskellTypes.Deriving.html#6814" class="Function">makeHsCon</a> <a id="6824" class="Symbol">:</a> <a id="6826" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="6830" class="Symbol">→</a> <a id="6832" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6837" class="Symbol">→</a> <a id="6839" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6844" class="Symbol">→</a> <a id="6846" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6851" class="Symbol">→</a> <a id="6853" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="6856" class="Symbol">(</a><a id="6857" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6862" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6864" href="Agda.Builtin.Reflection.html#3207" class="Datatype">Agda.Builtin.Reflection.Quantity</a> <a id="6897" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6899" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="6903" class="Symbol">)</a>
  <a id="6907" href="Foreign.HaskellTypes.Deriving.html#6814" class="Function">makeHsCon</a> <a id="6917" href="Foreign.HaskellTypes.Deriving.html#6917" class="Bound">env</a> <a id="6921" href="Foreign.HaskellTypes.Deriving.html#6921" class="Bound">agdaName</a> <a id="6930" href="Foreign.HaskellTypes.Deriving.html#6930" class="Bound">hsName</a> <a id="6937" href="Foreign.HaskellTypes.Deriving.html#6937" class="Bound">c</a> <a id="6939" class="Symbol">=</a> <a id="6941" class="Keyword">do</a>
    <a id="6948" href="Foreign.HaskellTypes.Deriving.html#4594" class="Function">debug</a> <a id="6954" class="Number">10</a> <a id="6957" class="String">&quot;Making constructor %q : %q&quot;</a> <a id="6986" href="Foreign.HaskellTypes.Deriving.html#6937" class="Bound">c</a> <a id="6988" href="Foreign.HaskellTypes.Deriving.html#6921" class="Bound">agdaName</a>
    <a id="7001" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="7005" href="Foreign.HaskellTypes.Deriving.html#7005" class="Bound">agdaName&#39;</a> <a id="7015" class="Symbol">_</a> <a id="7017" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7019" href="Agda.Builtin.Reflection.html#8972" class="Postulate">normalise</a> <a id="7029" class="Symbol">(</a><a id="7030" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="7034" href="Foreign.HaskellTypes.Deriving.html#6921" class="Bound">agdaName</a> <a id="7043" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7045" class="Symbol">)</a>
      <a id="7053" class="Keyword">where</a> <a id="7059" class="CatchallClause Symbol">_</a> <a id="7061" class="Symbol">→</a> <a id="7063" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="7076" class="String">&quot;Failed to compute source type for %q&quot;</a> <a id="7115" href="Foreign.HaskellTypes.Deriving.html#6921" class="Bound">agdaName</a>
    <a id="7128" href="Foreign.HaskellTypes.Deriving.html#7128" class="Bound">hsC</a>  <a id="7133" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7135" href="Foreign.HaskellTypes.Deriving.html#5548" class="Function">freshHsConName</a> <a id="7150" href="Foreign.HaskellTypes.Deriving.html#6917" class="Bound">env</a> <a id="7154" href="Foreign.HaskellTypes.Deriving.html#6930" class="Bound">hsName</a> <a id="7161" href="Foreign.HaskellTypes.Deriving.html#6937" class="Bound">c</a>
    <a id="7167" href="Foreign.HaskellTypes.Deriving.html#7167" class="Bound">cTy</a>  <a id="7172" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7174" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="7182" href="Foreign.HaskellTypes.Deriving.html#6937" class="Bound">c</a>
    <a id="7188" href="Foreign.HaskellTypes.Deriving.html#4594" class="Function">debug</a> <a id="7194" class="Number">10</a> <a id="7197" class="String">&quot;cTy = %t&quot;</a> <a id="7208" href="Foreign.HaskellTypes.Deriving.html#7167" class="Bound">cTy</a>
    <a id="7216" href="Foreign.HaskellTypes.Deriving.html#7216" class="Bound">hsTy</a> <a id="7221" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7223" href="Foreign.HaskellTypes.Deriving.html#5869" class="Function">computeHsType</a> <a id="7237" href="Foreign.HaskellTypes.Deriving.html#7005" class="Bound">agdaName&#39;</a> <a id="7247" href="Foreign.HaskellTypes.Deriving.html#6930" class="Bound">hsName</a> <a id="7254" href="Foreign.HaskellTypes.Deriving.html#7167" class="Bound">cTy</a>
    <a id="7262" href="Foreign.HaskellTypes.Deriving.html#4594" class="Function">debug</a> <a id="7268" class="Number">10</a> <a id="7271" class="String">&quot;hsTy = %t&quot;</a> <a id="7283" href="Foreign.HaskellTypes.Deriving.html#7216" class="Bound">hsTy</a>
    <a id="7292" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="7297" class="Symbol">(</a><a id="7298" href="Foreign.HaskellTypes.Deriving.html#7128" class="Bound">hsC</a> <a id="7302" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7304" href="Agda.Builtin.Reflection.html#3241" class="InductiveConstructor">quantity-ω</a> <a id="7315" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7317" href="Foreign.HaskellTypes.Deriving.html#7216" class="Bound">hsTy</a><a id="7321" class="Symbol">)</a>

  <a id="makeHsData"></a><a id="7326" href="Foreign.HaskellTypes.Deriving.html#7326" class="Function">makeHsData</a> <a id="7337" class="Symbol">:</a> <a id="7339" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="7343" class="Symbol">→</a> <a id="7345" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7350" class="Symbol">→</a> <a id="7352" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7354" class="Symbol">→</a> <a id="7356" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7361" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7366" class="Symbol">→</a> <a id="7368" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="7371" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="7378" href="Foreign.HaskellTypes.Deriving.html#7326" class="Function">makeHsData</a> <a id="7389" href="Foreign.HaskellTypes.Deriving.html#7389" class="Bound">env</a> <a id="7393" href="Foreign.HaskellTypes.Deriving.html#7393" class="Bound">agdaName</a> <a id="7402" href="Foreign.HaskellTypes.Deriving.html#7402" class="Bound">nPars</a> <a id="7408" href="Foreign.HaskellTypes.Deriving.html#7408" class="Bound">constrs</a> <a id="7416" class="Symbol">=</a> <a id="7418" class="Keyword">do</a>
    <a id="7425" href="Foreign.HaskellTypes.Deriving.html#7425" class="Bound">hsName</a> <a id="7432" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7434" href="Foreign.HaskellTypes.Deriving.html#5217" class="Function">freshHsTypeName</a> <a id="7450" href="Foreign.HaskellTypes.Deriving.html#7389" class="Bound">env</a> <a id="7454" href="Foreign.HaskellTypes.Deriving.html#7393" class="Bound">agdaName</a>
    <a id="7467" href="Agda.Builtin.Reflection.html#9556" class="Postulate">declareData</a> <a id="7479" href="Foreign.HaskellTypes.Deriving.html#7425" class="Bound">hsName</a> <a id="7486" class="Number">0</a> <a id="7488" href="Reflection.Syntax.html#3546" class="InductiveConstructor">`Set</a>
    <a id="7497" href="Foreign.HaskellTypes.Deriving.html#7497" class="Bound">hsCons</a> <a id="7504" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7506" href="Class.Monad.Core.html#832" class="Function">mapM</a> <a id="7511" class="Symbol">(</a><a id="7512" href="Foreign.HaskellTypes.Deriving.html#6814" class="Function">makeHsCon</a> <a id="7522" href="Foreign.HaskellTypes.Deriving.html#7389" class="Bound">env</a> <a id="7526" href="Foreign.HaskellTypes.Deriving.html#7393" class="Bound">agdaName</a> <a id="7535" href="Foreign.HaskellTypes.Deriving.html#7425" class="Bound">hsName</a><a id="7541" class="Symbol">)</a> <a id="7543" href="Foreign.HaskellTypes.Deriving.html#7408" class="Bound">constrs</a>
    <a id="7555" href="Agda.Builtin.Reflection.html#9602" class="Postulate">defineData</a> <a id="7566" href="Foreign.HaskellTypes.Deriving.html#7425" class="Bound">hsName</a> <a id="7573" href="Foreign.HaskellTypes.Deriving.html#7497" class="Bound">hsCons</a>
    <a id="7584" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="7589" href="Foreign.HaskellTypes.Deriving.html#7425" class="Bound">hsName</a>

  <a id="makeHsType"></a><a id="7599" href="Foreign.HaskellTypes.Deriving.html#7599" class="Function">makeHsType</a> <a id="7610" class="Symbol">:</a> <a id="7612" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="7616" class="Symbol">→</a> <a id="7618" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7623" class="Symbol">→</a> <a id="7625" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="7628" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
  <a id="7635" href="Foreign.HaskellTypes.Deriving.html#7599" class="Function">makeHsType</a> <a id="7646" href="Foreign.HaskellTypes.Deriving.html#7646" class="Bound">env</a> <a id="7650" href="Foreign.HaskellTypes.Deriving.html#7650" class="Bound">d</a> <a id="7652" class="Symbol">=</a> <a id="7654" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="7668" href="Foreign.HaskellTypes.Deriving.html#7650" class="Bound">d</a> <a id="7670" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="7674" class="Symbol">λ</a> <a id="7676" class="Keyword">where</a>
      <a id="7688" class="Symbol">(</a><a id="7689" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="7699" href="Foreign.HaskellTypes.Deriving.html#7699" class="Bound">pars</a> <a id="7704" href="Foreign.HaskellTypes.Deriving.html#7704" class="Bound">cs</a><a id="7706" class="Symbol">)</a> <a id="7708" class="Symbol">→</a> <a id="7710" href="Foreign.HaskellTypes.Deriving.html#7326" class="Function">makeHsData</a> <a id="7721" href="Foreign.HaskellTypes.Deriving.html#7646" class="Bound">env</a> <a id="7725" href="Foreign.HaskellTypes.Deriving.html#7650" class="Bound">d</a> <a id="7727" href="Foreign.HaskellTypes.Deriving.html#7699" class="Bound">pars</a> <a id="7732" href="Foreign.HaskellTypes.Deriving.html#7704" class="Bound">cs</a>
      <a id="7741" class="Symbol">(</a><a id="7742" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="7754" href="Foreign.HaskellTypes.Deriving.html#7754" class="Bound">c</a> <a id="7756" href="Foreign.HaskellTypes.Deriving.html#7756" class="Bound">fs</a><a id="7758" class="Symbol">)</a>  <a id="7761" class="Symbol">→</a> <a id="7763" href="Foreign.HaskellTypes.Deriving.html#7326" class="Function">makeHsData</a> <a id="7774" href="Foreign.HaskellTypes.Deriving.html#7646" class="Bound">env</a> <a id="7778" href="Foreign.HaskellTypes.Deriving.html#7650" class="Bound">d</a> <a id="7780" class="Number">0</a> <a id="7782" class="Symbol">(</a><a id="7783" href="Foreign.HaskellTypes.Deriving.html#7754" class="Bound">c</a> <a id="7785" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7787" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7789" class="Symbol">)</a>
      <a id="7797" class="CatchallClause Symbol">_</a>                   <a id="7817" class="Symbol">→</a> <a id="7819" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="7832" class="String">&quot;%q is not a data or record type&quot;</a> <a id="7866" href="Foreign.HaskellTypes.Deriving.html#7650" class="Bound">d</a>

  <a id="compilePragma"></a><a id="7871" href="Foreign.HaskellTypes.Deriving.html#7871" class="Function">compilePragma</a> <a id="7885" class="Symbol">:</a> <a id="7887" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7892" class="Symbol">→</a> <a id="7894" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7899" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7904" class="Symbol">→</a> <a id="7906" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="7915" href="Foreign.HaskellTypes.Deriving.html#7871" class="Function">compilePragma</a> <a id="7929" href="Foreign.HaskellTypes.Deriving.html#7929" class="Bound">d</a> <a id="7931" href="Foreign.HaskellTypes.Deriving.html#7931" class="Bound">cs</a> <a id="7934" class="Symbol">=</a> <a id="7936" href="Text.Printf.html#1015" class="Function">printf</a> <a id="7943" class="String">&quot;= data %s (%s)&quot;</a> <a id="7960" class="Symbol">(</a><a id="7961" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="7970" href="Foreign.HaskellTypes.Deriving.html#7929" class="Bound">d</a><a id="7971" class="Symbol">)</a> <a id="7973" class="Symbol">(</a><a id="7974" href="Foreign.HaskellTypes.Deriving.html#1920" class="Function">joinStrings</a> <a id="7986" class="String">&quot; | &quot;</a> <a id="7992" class="Symbol">(</a><a id="7993" href="Data.List.Base.html#1612" class="Function">map</a> <a id="7997" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="8006" href="Foreign.HaskellTypes.Deriving.html#7931" class="Bound">cs</a><a id="8008" class="Symbol">))</a>

  <a id="renderHsTypeName"></a><a id="8014" href="Foreign.HaskellTypes.Deriving.html#8014" class="Function">renderHsTypeName</a> <a id="8031" class="Symbol">:</a> <a id="8033" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8038" class="Symbol">→</a> <a id="8040" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="8049" href="Foreign.HaskellTypes.Deriving.html#8014" class="Function">renderHsTypeName</a> <a id="8066" href="Foreign.HaskellTypes.Deriving.html#8066" class="Bound">d</a> <a id="8068" class="Symbol">=</a> <a id="8070" href="Data.Maybe.Base.html#1546" class="Function">fromMaybe</a> <a id="8080" class="Symbol">(</a><a id="8081" class="String">&quot;MAlonzo.Code.&quot;</a> <a id="8097" href="Data.String.Base.html#2425" class="Function Operator">String.++</a> <a id="8107" href="Reflection.AST.Show.html#1581" class="Primitive">R.showName</a> <a id="8118" href="Foreign.HaskellTypes.Deriving.html#8066" class="Bound">d</a><a id="8119" class="Symbol">)</a> <a id="8121" class="Symbol">(</a><a id="8122" href="Foreign.HaskellTypes.Deriving.html#2139" class="Function">lookup</a> <a id="8129" href="Foreign.HaskellTypes.Deriving.html#8066" class="Bound">d</a> <a id="8131" href="Foreign.HaskellTypes.Deriving.html#4637" class="Function">specialHsTypes</a><a id="8145" class="Symbol">)</a>

  <a id="renderHsType"></a><a id="8150" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="8163" class="Symbol">:</a> <a id="8165" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8170" class="Symbol">→</a> <a id="8172" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="renderHsArgs"></a><a id="8181" href="Foreign.HaskellTypes.Deriving.html#8181" class="Function">renderHsArgs</a> <a id="8194" class="Symbol">:</a> <a id="8196" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8201" class="Symbol">(</a><a id="8202" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="8206" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="8210" class="Symbol">)</a> <a id="8212" class="Symbol">→</a> <a id="8214" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8219" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

  <a id="8229" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="8242" class="Symbol">(</a><a id="8243" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8247" class="Symbol">(</a><a id="8248" class="Keyword">quote</a> <a id="8254" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="8258" class="Symbol">)</a> <a id="8260" class="Symbol">(_</a> <a id="8263" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8265" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="8270" href="Foreign.HaskellTypes.Deriving.html#8270" class="Bound">a</a> <a id="8272" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8274" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8276" class="Symbol">))</a> <a id="8279" class="Symbol">=</a> <a id="8281" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8288" class="String">&quot;[%s]&quot;</a> <a id="8295" class="Symbol">(</a><a id="8296" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="8309" href="Foreign.HaskellTypes.Deriving.html#8270" class="Bound">a</a><a id="8310" class="Symbol">)</a>
  <a id="8314" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="8327" class="Symbol">(</a><a id="8328" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8332" class="Symbol">(</a><a id="8333" class="Keyword">quote</a> <a id="8339" href="Foreign.Haskell.Pair.html#553" class="Record">Pair</a><a id="8343" class="Symbol">)</a> <a id="8345" class="Symbol">(_</a> <a id="8348" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8350" class="Symbol">_</a> <a id="8352" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8354" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="8359" href="Foreign.HaskellTypes.Deriving.html#8359" class="Bound">a</a> <a id="8361" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8363" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="8368" href="Foreign.HaskellTypes.Deriving.html#8368" class="Bound">b</a> <a id="8370" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8372" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8374" class="Symbol">))</a> <a id="8377" class="Symbol">=</a> <a id="8379" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8386" class="String">&quot;(%s, %s)&quot;</a> <a id="8397" class="Symbol">(</a><a id="8398" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="8411" href="Foreign.HaskellTypes.Deriving.html#8359" class="Bound">a</a><a id="8412" class="Symbol">)</a> <a id="8414" class="Symbol">(</a><a id="8415" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="8428" href="Foreign.HaskellTypes.Deriving.html#8368" class="Bound">b</a><a id="8429" class="Symbol">)</a>
  <a id="8433" href="Foreign.HaskellTypes.Deriving.html#8150" class="CatchallClause Function">renderHsType</a><a id="8445" class="CatchallClause"> </a><a id="8446" class="CatchallClause Symbol">(</a><a id="8447" href="Agda.Builtin.Reflection.html#5251" class="CatchallClause InductiveConstructor">def</a><a id="8450" class="CatchallClause"> </a><a id="8451" href="Foreign.HaskellTypes.Deriving.html#8451" class="CatchallClause Bound">d</a><a id="8452" class="CatchallClause"> </a><a id="8453" href="Agda.Builtin.List.html#184" class="CatchallClause InductiveConstructor">[]</a><a id="8455" class="CatchallClause Symbol">)</a> <a id="8457" class="Symbol">=</a> <a id="8459" href="Foreign.HaskellTypes.Deriving.html#8014" class="Function">renderHsTypeName</a> <a id="8476" href="Foreign.HaskellTypes.Deriving.html#8451" class="Bound">d</a>
  <a id="8480" href="Foreign.HaskellTypes.Deriving.html#8150" class="CatchallClause Function">renderHsType</a><a id="8492" class="CatchallClause"> </a><a id="8493" class="CatchallClause Symbol">(</a><a id="8494" href="Agda.Builtin.Reflection.html#5251" class="CatchallClause InductiveConstructor">def</a><a id="8497" class="CatchallClause"> </a><a id="8498" href="Foreign.HaskellTypes.Deriving.html#8498" class="CatchallClause Bound">d</a><a id="8499" class="CatchallClause"> </a><a id="8500" href="Foreign.HaskellTypes.Deriving.html#8500" class="CatchallClause Bound">vs</a><a id="8502" class="CatchallClause Symbol">)</a> <a id="8504" class="Symbol">=</a> <a id="8506" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8513" class="String">&quot;(%s %s)&quot;</a> <a id="8523" class="Symbol">(</a><a id="8524" href="Foreign.HaskellTypes.Deriving.html#8014" class="Function">renderHsTypeName</a> <a id="8541" href="Foreign.HaskellTypes.Deriving.html#8498" class="Bound">d</a><a id="8542" class="Symbol">)</a> <a id="8544" class="Symbol">(</a><a id="8545" href="Foreign.HaskellTypes.Deriving.html#1920" class="Function">joinStrings</a> <a id="8557" class="String">&quot; &quot;</a> <a id="8561" class="Symbol">(</a><a id="8562" href="Foreign.HaskellTypes.Deriving.html#8181" class="Function">renderHsArgs</a> <a id="8575" href="Foreign.HaskellTypes.Deriving.html#8500" class="Bound">vs</a><a id="8577" class="Symbol">))</a>
  <a id="8582" href="Foreign.HaskellTypes.Deriving.html#8150" class="CatchallClause Function">renderHsType</a><a id="8594" class="CatchallClause"> </a><a id="8595" href="Foreign.HaskellTypes.Deriving.html#8595" class="CatchallClause Bound">t</a> <a id="8597" class="Symbol">=</a> <a id="8599" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8606" class="String">&quot;(TODO: renderHsType %s)&quot;</a> <a id="8632" class="Symbol">(</a><a id="8633" href="Class.Show.Core.html#187" class="Field">show</a> <a id="8638" href="Foreign.HaskellTypes.Deriving.html#8595" class="Bound">t</a><a id="8639" class="Symbol">)</a>

  <a id="8644" href="Foreign.HaskellTypes.Deriving.html#8181" class="Function">renderHsArgs</a> <a id="8657" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8660" class="Symbol">=</a> <a id="8662" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="8667" href="Foreign.HaskellTypes.Deriving.html#8181" class="Function">renderHsArgs</a> <a id="8680" class="Symbol">(</a><a id="8681" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="8686" href="Foreign.HaskellTypes.Deriving.html#8686" class="Bound">a</a> <a id="8688" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8690" href="Foreign.HaskellTypes.Deriving.html#8690" class="Bound">as</a><a id="8692" class="Symbol">)</a> <a id="8694" class="Symbol">=</a> <a id="8696" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="8709" href="Foreign.HaskellTypes.Deriving.html#8686" class="Bound">a</a> <a id="8711" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8713" href="Foreign.HaskellTypes.Deriving.html#8181" class="Function">renderHsArgs</a> <a id="8726" href="Foreign.HaskellTypes.Deriving.html#8690" class="Bound">as</a>
  <a id="8731" href="Foreign.HaskellTypes.Deriving.html#8181" class="CatchallClause Function">renderHsArgs</a><a id="8743" class="CatchallClause"> </a><a id="8744" class="CatchallClause Symbol">(_</a><a id="8746" class="CatchallClause"> </a><a id="8747" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="8748" class="CatchallClause"> </a><a id="8749" href="Foreign.HaskellTypes.Deriving.html#8749" class="CatchallClause Bound">as</a><a id="8751" class="CatchallClause Symbol">)</a> <a id="8753" class="Symbol">=</a> <a id="8755" href="Foreign.HaskellTypes.Deriving.html#8181" class="Function">renderHsArgs</a> <a id="8768" href="Foreign.HaskellTypes.Deriving.html#8749" class="Bound">as</a>

  <a id="renderTypeclassDeriving"></a><a id="8774" href="Foreign.HaskellTypes.Deriving.html#8774" class="Function">renderTypeclassDeriving</a> <a id="8798" class="Symbol">:</a> <a id="8800" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8805" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="8812" class="Symbol">→</a> <a id="8814" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="8823" href="Foreign.HaskellTypes.Deriving.html#8774" class="Function">renderTypeclassDeriving</a> <a id="8847" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8850" class="Symbol">=</a> <a id="8852" class="String">&quot;&quot;</a>
  <a id="8857" href="Foreign.HaskellTypes.Deriving.html#8774" class="CatchallClause Function">renderTypeclassDeriving</a><a id="8880" class="CatchallClause"> </a><a id="8881" href="Foreign.HaskellTypes.Deriving.html#8881" class="CatchallClause Bound">xs</a> <a id="8884" class="Symbol">=</a> <a id="8886" href="Text.Printf.html#1015" class="Function">printf</a> <a id="8893" class="String">&quot;deriving (%s)&quot;</a> <a id="8909" class="Symbol">(</a><a id="8910" href="Foreign.HaskellTypes.Deriving.html#1920" class="Function">joinStrings</a> <a id="8922" class="String">&quot;, &quot;</a> <a id="8927" href="Foreign.HaskellTypes.Deriving.html#8881" class="Bound">xs</a><a id="8929" class="Symbol">)</a>

  <a id="foreignPragma"></a><a id="8934" href="Foreign.HaskellTypes.Deriving.html#8934" class="Function">foreignPragma</a> <a id="8948" class="Symbol">:</a> <a id="8950" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="8954" class="Symbol">→</a> <a id="8956" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8961" class="Symbol">→</a> <a id="8963" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8968" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8973" class="Symbol">→</a> <a id="8975" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="8978" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="8987" href="Foreign.HaskellTypes.Deriving.html#8934" class="Function">foreignPragma</a> <a id="9001" href="Foreign.HaskellTypes.Deriving.html#9001" class="Bound">env</a> <a id="9005" href="Foreign.HaskellTypes.Deriving.html#9005" class="Bound">d</a> <a id="9007" href="Foreign.HaskellTypes.Deriving.html#9007" class="Bound">cs</a> <a id="9010" class="Symbol">=</a> <a id="9012" class="Keyword">do</a>
    <a id="9019" href="Foreign.HaskellTypes.Deriving.html#9019" class="Bound">cons</a> <a id="9024" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="9026" href="Class.Monad.Core.html#1040" class="Function">forM</a> <a id="9031" href="Foreign.HaskellTypes.Deriving.html#9007" class="Bound">cs</a> <a id="9034" class="Symbol">λ</a> <a id="9036" href="Foreign.HaskellTypes.Deriving.html#9036" class="Bound">c</a> <a id="9038" class="Symbol">→</a> <a id="9040" class="Keyword">do</a>
            <a id="9055" href="Foreign.HaskellTypes.Deriving.html#9055" class="Bound">tel</a> <a id="9059" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9061" class="Symbol">_</a> <a id="9063" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="9065" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="9072" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="9076" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="9084" href="Foreign.HaskellTypes.Deriving.html#9036" class="Bound">c</a>
            <a id="9098" class="Keyword">let</a> <a id="9102" href="Foreign.HaskellTypes.Deriving.html#9102" class="Bound">args</a> <a id="9107" class="Symbol">=</a> <a id="9109" href="Data.List.Base.html#1612" class="Function">map</a> <a id="9113" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="9119" href="Foreign.HaskellTypes.Deriving.html#9055" class="Bound">tel</a>
            <a id="9135" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="9140" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9142" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9149" class="String">&quot;%s %s&quot;</a> <a id="9157" class="Symbol">(</a><a id="9158" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="9167" href="Foreign.HaskellTypes.Deriving.html#9036" class="Bound">c</a><a id="9168" class="Symbol">)</a> <a id="9170" class="Symbol">(</a><a id="9171" href="Foreign.HaskellTypes.Deriving.html#1920" class="Function">joinStrings</a> <a id="9183" class="String">&quot; &quot;</a> <a id="9187" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9189" href="Foreign.HaskellTypes.Deriving.html#8181" class="Function">renderHsArgs</a> <a id="9202" href="Foreign.HaskellTypes.Deriving.html#9102" class="Bound">args</a><a id="9206" class="Symbol">)</a>
    <a id="9212" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="9217" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9219" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9226" class="String">&quot;data %s = %s\n  %s&quot;</a>
                  <a id="9265" class="Symbol">(</a><a id="9266" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="9275" href="Foreign.HaskellTypes.Deriving.html#9005" class="Bound">d</a><a id="9276" class="Symbol">)</a> <a id="9278" class="Symbol">(</a><a id="9279" href="Foreign.HaskellTypes.Deriving.html#1920" class="Function">joinStrings</a> <a id="9291" class="String">&quot; | &quot;</a> <a id="9297" href="Foreign.HaskellTypes.Deriving.html#9019" class="Bound">cons</a><a id="9301" class="Symbol">)</a> <a id="9303" class="Symbol">(</a><a id="9304" href="Foreign.HaskellTypes.Deriving.html#8774" class="Function">renderTypeclassDeriving</a> <a id="9328" class="Symbol">(</a><a id="9329" href="Foreign.HaskellTypes.Deriving.html#2482" class="Field">Env.typeclassDeriving</a> <a id="9351" href="Foreign.HaskellTypes.Deriving.html#9001" class="Bound">env</a> <a id="9355" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="9357" class="Symbol">))</a>

  <a id="9363" class="Comment">-- Record types</a>
  <a id="foreignPragmaRec"></a><a id="9381" href="Foreign.HaskellTypes.Deriving.html#9381" class="Function">foreignPragmaRec</a> <a id="9398" class="Symbol">:</a> <a id="9400" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="9404" class="Symbol">→</a> <a id="9406" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9411" class="Symbol">→</a> <a id="9413" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9418" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9423" class="Symbol">→</a> <a id="9425" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9430" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9435" class="Symbol">→</a> <a id="9437" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="9440" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="9449" href="Foreign.HaskellTypes.Deriving.html#9381" class="Function">foreignPragmaRec</a> <a id="9466" class="Symbol">_</a> <a id="9468" href="Foreign.HaskellTypes.Deriving.html#9468" class="Bound">d</a> <a id="9470" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="9473" class="Symbol">_</a> <a id="9475" class="Symbol">=</a> <a id="9477" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="9490" class="String">&quot;impossible: %q is a record type with no constructors&quot;</a> <a id="9545" href="Foreign.HaskellTypes.Deriving.html#9468" class="Bound">d</a>
  <a id="9549" href="Foreign.HaskellTypes.Deriving.html#9381" class="Function">foreignPragmaRec</a> <a id="9566" href="Foreign.HaskellTypes.Deriving.html#9566" class="Bound">env</a> <a id="9570" href="Foreign.HaskellTypes.Deriving.html#9570" class="Bound">d</a> <a id="9572" class="Symbol">(</a><a id="9573" href="Foreign.HaskellTypes.Deriving.html#9573" class="Bound">c</a> <a id="9575" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="9577" class="Symbol">_)</a> <a id="9580" href="Foreign.HaskellTypes.Deriving.html#9580" class="Bound">fs</a> <a id="9583" class="Symbol">=</a> <a id="9585" class="Keyword">do</a>
    <a id="9592" href="Foreign.HaskellTypes.Deriving.html#9592" class="Bound">tel</a> <a id="9596" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9598" class="Symbol">_</a> <a id="9600" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="9602" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="9609" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="9613" href="Agda.Builtin.Reflection.html#10159" class="Postulate">withNormalisation</a> <a id="9631" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="9636" class="Symbol">(</a><a id="9637" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="9645" href="Foreign.HaskellTypes.Deriving.html#9573" class="Bound">c</a><a id="9646" class="Symbol">)</a>
    <a id="9652" class="Keyword">let</a> <a id="9656" href="Foreign.HaskellTypes.Deriving.html#9656" class="Bound">fNames</a> <a id="9663" class="Symbol">=</a> <a id="9665" href="Data.List.Base.html#1612" class="Function">map</a> <a id="9669" class="Symbol">(</a><a id="9670" href="Foreign.HaskellTypes.Deriving.html#5427" class="Function">hsFieldName</a> <a id="9682" href="Foreign.HaskellTypes.Deriving.html#9566" class="Bound">env</a><a id="9685" class="Symbol">)</a> <a id="9687" href="Foreign.HaskellTypes.Deriving.html#9580" class="Bound">fs</a>
    <a id="9694" class="Keyword">let</a> <a id="9698" href="Foreign.HaskellTypes.Deriving.html#9698" class="Bound">args</a> <a id="9703" class="Symbol">=</a> <a id="9705" href="Data.List.Base.html#1612" class="Function">map</a> <a id="9709" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="9715" href="Foreign.HaskellTypes.Deriving.html#9592" class="Bound">tel</a>
        <a id="9727" href="Foreign.HaskellTypes.Deriving.html#9727" class="Bound">renderField</a> <a id="9739" href="Foreign.HaskellTypes.Deriving.html#9739" class="Bound">f</a> <a id="9741" href="Foreign.HaskellTypes.Deriving.html#9741" class="Bound">ty</a> <a id="9744" class="Symbol">=</a> <a id="9746" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9753" class="String">&quot;%s :: %s&quot;</a> <a id="9764" href="Foreign.HaskellTypes.Deriving.html#9739" class="Bound">f</a> <a id="9766" class="Symbol">(</a><a id="9767" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="9780" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9782" href="Reflection.AST.Argument.html#2600" class="Function">unArg</a> <a id="9788" href="Foreign.HaskellTypes.Deriving.html#9741" class="Bound">ty</a><a id="9790" class="Symbol">)</a>
        <a id="9800" href="Foreign.HaskellTypes.Deriving.html#9800" class="Bound">con</a> <a id="9804" class="Symbol">=</a> <a id="9806" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9813" class="String">&quot;%s {%s}&quot;</a> <a id="9823" class="Symbol">(</a><a id="9824" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="9833" href="Foreign.HaskellTypes.Deriving.html#9573" class="Bound">c</a><a id="9834" class="Symbol">)</a> <a id="9836" class="Symbol">(</a><a id="9837" href="Foreign.HaskellTypes.Deriving.html#1920" class="Function">joinStrings</a> <a id="9849" class="String">&quot;, &quot;</a> <a id="9854" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9856" href="Data.List.Base.html#2712" class="Function">zipWith</a> <a id="9864" href="Foreign.HaskellTypes.Deriving.html#9727" class="Bound">renderField</a> <a id="9876" href="Foreign.HaskellTypes.Deriving.html#9656" class="Bound">fNames</a> <a id="9883" href="Foreign.HaskellTypes.Deriving.html#9698" class="Bound">args</a><a id="9887" class="Symbol">)</a>
    <a id="9893" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="9898" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9900" href="Text.Printf.html#1015" class="Function">printf</a> <a id="9907" class="String">&quot;data %s = %s\n %s&quot;</a>
                  <a id="9945" class="Symbol">(</a><a id="9946" href="Tactic.Derive.Show.html#829" class="Function">showName</a> <a id="9955" href="Foreign.HaskellTypes.Deriving.html#9570" class="Bound">d</a><a id="9956" class="Symbol">)</a> <a id="9958" href="Foreign.HaskellTypes.Deriving.html#9800" class="Bound">con</a> <a id="9962" class="Symbol">(</a><a id="9963" href="Foreign.HaskellTypes.Deriving.html#8774" class="Function">renderTypeclassDeriving</a> <a id="9987" class="Symbol">(</a><a id="9988" href="Foreign.HaskellTypes.Deriving.html#2482" class="Field">Env.typeclassDeriving</a> <a id="10010" href="Foreign.HaskellTypes.Deriving.html#9566" class="Bound">env</a> <a id="10014" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="10016" class="Symbol">))</a>

  <a id="hsImports"></a><a id="10022" href="Foreign.HaskellTypes.Deriving.html#10022" class="Function">hsImports</a> <a id="10032" class="Symbol">:</a> <a id="10034" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="10043" href="Foreign.HaskellTypes.Deriving.html#10022" class="Function">hsImports</a> <a id="10053" class="Symbol">=</a> <a id="10055" class="String">&quot;import GHC.Generics (Generic)&quot;</a>

  <a id="10090" class="Comment">-- Take the name of a simple data type and generate the COMPILE and</a>
  <a id="10160" class="Comment">-- FOREIGN pragmas to bind to Haskell.</a>
  <a id="bindHsType"></a><a id="10201" href="Foreign.HaskellTypes.Deriving.html#10201" class="Function">bindHsType</a> <a id="10212" class="Symbol">:</a> <a id="10214" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="10218" class="Symbol">→</a> <a id="10220" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10225" class="Symbol">→</a> <a id="10227" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10232" class="Symbol">→</a> <a id="10234" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="10237" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="10241" href="Foreign.HaskellTypes.Deriving.html#10201" class="Function">bindHsType</a> <a id="10252" href="Foreign.HaskellTypes.Deriving.html#10252" class="Bound">env</a> <a id="10256" href="Foreign.HaskellTypes.Deriving.html#10256" class="Bound">agdaName</a> <a id="10265" href="Foreign.HaskellTypes.Deriving.html#10265" class="Bound">hsName</a> <a id="10272" class="Symbol">=</a> <a id="10274" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="10288" href="Foreign.HaskellTypes.Deriving.html#10265" class="Bound">hsName</a> <a id="10295" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="10299" class="Symbol">λ</a> <a id="10301" class="Keyword">where</a>
    <a id="10311" class="Symbol">(</a><a id="10312" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="10322" href="Foreign.HaskellTypes.Deriving.html#10322" class="Bound">pars</a> <a id="10327" href="Foreign.HaskellTypes.Deriving.html#10327" class="Bound">cs</a><a id="10329" class="Symbol">)</a> <a id="10331" class="Symbol">→</a> <a id="10333" class="Keyword">do</a>
      <a id="10342" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10356" class="String">&quot;GHC&quot;</a> <a id="10362" href="Foreign.HaskellTypes.Deriving.html#10022" class="Function">hsImports</a>
      <a id="10378" href="Agda.Builtin.Reflection.html#9970" class="Postulate">pragmaCompile</a> <a id="10392" class="String">&quot;GHC&quot;</a> <a id="10398" href="Foreign.HaskellTypes.Deriving.html#10265" class="Bound">hsName</a> <a id="10405" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="10407" href="Foreign.HaskellTypes.Deriving.html#7871" class="Function">compilePragma</a> <a id="10421" href="Foreign.HaskellTypes.Deriving.html#10265" class="Bound">hsName</a> <a id="10428" href="Foreign.HaskellTypes.Deriving.html#10327" class="Bound">cs</a>
      <a id="10437" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="10451" href="Foreign.HaskellTypes.Deriving.html#10256" class="Bound">agdaName</a> <a id="10460" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="10464" class="Symbol">λ</a> <a id="10466" class="Keyword">where</a>
        <a id="10480" class="Symbol">(</a><a id="10481" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="10491" class="Symbol">_</a> <a id="10493" class="Symbol">_)</a>    <a id="10499" class="Symbol">→</a> <a id="10501" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10515" class="String">&quot;GHC&quot;</a> <a id="10521" href="Class.Monad.Core.html#426" class="Function Operator">=&lt;&lt;</a> <a id="10525" href="Foreign.HaskellTypes.Deriving.html#8934" class="Function">foreignPragma</a> <a id="10539" href="Foreign.HaskellTypes.Deriving.html#10252" class="Bound">env</a> <a id="10543" href="Foreign.HaskellTypes.Deriving.html#10265" class="Bound">hsName</a> <a id="10550" href="Foreign.HaskellTypes.Deriving.html#10327" class="Bound">cs</a>
        <a id="10561" class="Symbol">(</a><a id="10562" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="10574" class="Symbol">_</a> <a id="10576" href="Foreign.HaskellTypes.Deriving.html#10576" class="Bound">fs</a><a id="10578" class="Symbol">)</a> <a id="10580" class="Symbol">→</a> <a id="10582" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="10596" class="String">&quot;GHC&quot;</a> <a id="10602" href="Class.Monad.Core.html#426" class="Function Operator">=&lt;&lt;</a> <a id="10606" href="Foreign.HaskellTypes.Deriving.html#9381" class="Function">foreignPragmaRec</a> <a id="10623" href="Foreign.HaskellTypes.Deriving.html#10252" class="Bound">env</a> <a id="10627" href="Foreign.HaskellTypes.Deriving.html#10265" class="Bound">hsName</a> <a id="10634" href="Foreign.HaskellTypes.Deriving.html#10327" class="Bound">cs</a> <a id="10637" class="Symbol">(</a><a id="10638" href="Data.List.Base.html#1612" class="Function">map</a> <a id="10642" href="Reflection.AST.Argument.html#2600" class="Function">unArg</a> <a id="10648" href="Foreign.HaskellTypes.Deriving.html#10576" class="Bound">fs</a><a id="10650" class="Symbol">)</a>
        <a id="10660" class="CatchallClause Symbol">_</a> <a id="10662" class="Symbol">→</a> <a id="10664" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="10677" class="String">&quot;%q is not a data or record type&quot;</a> <a id="10711" href="Foreign.HaskellTypes.Deriving.html#10256" class="Bound">agdaName</a>
    <a id="10724" class="CatchallClause Symbol">_</a> <a id="10726" class="Symbol">→</a> <a id="10728" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="10741" class="String">&quot;%q is not a data type (impossible)&quot;</a> <a id="10778" href="Foreign.HaskellTypes.Deriving.html#10265" class="Bound">hsName</a>

  <a id="computeProjections"></a><a id="10788" href="Foreign.HaskellTypes.Deriving.html#10788" class="Function">computeProjections</a> <a id="10807" class="Symbol">:</a> <a id="10809" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="10811" class="Symbol">→</a> <a id="10813" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="10818" class="Symbol">→</a> <a id="10820" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="10823" class="Symbol">(</a><a id="10824" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="10829" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="10833" class="Symbol">)</a>
  <a id="10837" href="Foreign.HaskellTypes.Deriving.html#10788" class="Function">computeProjections</a> <a id="10856" href="Foreign.HaskellTypes.Deriving.html#10856" class="Bound">npars</a> <a id="10862" href="Foreign.HaskellTypes.Deriving.html#10862" class="Bound">c</a> <a id="10864" class="Symbol">=</a> <a id="10866" class="Keyword">do</a>
    <a id="10873" href="Foreign.HaskellTypes.Deriving.html#10873" class="Bound">argTys</a> <a id="10880" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10882" class="Symbol">_</a> <a id="10884" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="10886" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="10893" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="10897" href="Agda.Builtin.Reflection.html#9730" class="Postulate">getType</a> <a id="10905" href="Foreign.HaskellTypes.Deriving.html#10862" class="Bound">c</a>
    <a id="10911" class="Keyword">let</a> <a id="10915" href="Foreign.HaskellTypes.Deriving.html#10915" class="Bound">is</a>  <a id="10919" class="Symbol">=</a> <a id="10921" href="Data.List.Base.html#6430" class="Function">downFrom</a> <a id="10930" class="Symbol">(</a><a id="10931" href="Data.List.Base.html#4746" class="Function">length</a> <a id="10938" href="Foreign.HaskellTypes.Deriving.html#10873" class="Bound">argTys</a><a id="10944" class="Symbol">)</a>
        <a id="10954" href="Foreign.HaskellTypes.Deriving.html#10954" class="Bound">tel</a> <a id="10958" class="Symbol">=</a> <a id="10960" href="Data.List.Base.html#1612" class="Function">map</a> <a id="10964" class="Symbol">(λ</a> <a id="10967" class="Keyword">where</a> <a id="10973" class="Symbol">(</a><a id="10974" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="10978" href="Foreign.HaskellTypes.Deriving.html#10978" class="Bound">x</a> <a id="10980" href="Foreign.HaskellTypes.Deriving.html#10980" class="Bound">ty</a><a id="10982" class="Symbol">)</a> <a id="10984" class="Symbol">→</a> <a id="10986" href="Foreign.HaskellTypes.Deriving.html#10978" class="Bound">x</a> <a id="10988" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10990" href="Foreign.HaskellTypes.Deriving.html#10980" class="Bound">ty</a><a id="10992" class="Symbol">)</a> <a id="10994" href="Foreign.HaskellTypes.Deriving.html#10873" class="Bound">argTys</a>
        <a id="11009" href="Foreign.HaskellTypes.Deriving.html#11009" class="Bound">lhs</a> <a id="11013" class="Symbol">=</a> <a id="11015" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="11020" class="Symbol">(</a><a id="11021" href="Agda.Builtin.Reflection.html#5814" class="InductiveConstructor">con</a> <a id="11025" href="Foreign.HaskellTypes.Deriving.html#10862" class="Bound">c</a> <a id="11027" class="Symbol">(</a><a id="11028" href="Data.List.Base.html#1612" class="Function">map</a> <a id="11032" class="Symbol">(λ</a> <a id="11035" class="Keyword">where</a> <a id="11041" class="Symbol">(</a><a id="11042" href="Foreign.HaskellTypes.Deriving.html#11042" class="Bound">i</a> <a id="11044" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="11046" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="11050" href="Foreign.HaskellTypes.Deriving.html#11050" class="Bound">x</a> <a id="11052" class="Symbol">(</a><a id="11053" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="11057" href="Foreign.HaskellTypes.Deriving.html#11057" class="Bound">info</a> <a id="11062" class="Symbol">_))</a> <a id="11066" class="Symbol">→</a> <a id="11068" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="11072" href="Foreign.HaskellTypes.Deriving.html#11057" class="Bound">info</a> <a id="11077" class="Symbol">(</a><a id="11078" href="Agda.Builtin.Reflection.html#5907" class="InductiveConstructor">var</a> <a id="11082" href="Foreign.HaskellTypes.Deriving.html#11042" class="Bound">i</a><a id="11083" class="Symbol">))</a>
                               <a id="11117" class="Symbol">(</a><a id="11118" href="Data.List.Base.html#8509" class="Function">drop</a> <a id="11123" href="Foreign.HaskellTypes.Deriving.html#10856" class="Bound">npars</a> <a id="11129" class="Symbol">(</a><a id="11130" href="Data.List.Base.html#3484" class="Function">zip</a> <a id="11134" href="Foreign.HaskellTypes.Deriving.html#10915" class="Bound">is</a> <a id="11137" href="Foreign.HaskellTypes.Deriving.html#10873" class="Bound">argTys</a><a id="11143" class="Symbol">))))</a> <a id="11148" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="11150" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="11157" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="11164" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="11166" href="Data.List.Base.html#1612" class="Function">map</a> <a id="11170" class="Symbol">(λ</a> <a id="11173" href="Foreign.HaskellTypes.Deriving.html#11173" class="Bound">i</a> <a id="11175" class="Symbol">→</a> <a id="11177" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="11185" class="Symbol">(</a><a id="11186" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="11193" href="Foreign.HaskellTypes.Deriving.html#10954" class="Bound">tel</a> <a id="11197" href="Foreign.HaskellTypes.Deriving.html#11009" class="Bound">lhs</a> <a id="11201" class="Symbol">(</a><a id="11202" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="11206" href="Foreign.HaskellTypes.Deriving.html#11173" class="Bound">i</a> <a id="11208" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="11210" class="Symbol">)</a> <a id="11212" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="11214" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="11216" class="Symbol">)</a> <a id="11218" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="11220" class="Symbol">)</a> <a id="11222" class="Symbol">(</a><a id="11223" href="Data.List.Base.html#8509" class="Function">drop</a> <a id="11228" href="Foreign.HaskellTypes.Deriving.html#10856" class="Bound">npars</a> <a id="11234" href="Foreign.HaskellTypes.Deriving.html#10915" class="Bound">is</a><a id="11236" class="Symbol">)</a>

  <a id="makeTypeAlias"></a><a id="11241" href="Foreign.HaskellTypes.Deriving.html#11241" class="Function">makeTypeAlias</a> <a id="11255" class="Symbol">:</a> <a id="11257" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11262" class="Symbol">→</a> <a id="11264" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="11268" class="Symbol">→</a> <a id="11270" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11275" class="Symbol">→</a> <a id="11277" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11280" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11284" href="Foreign.HaskellTypes.Deriving.html#11241" class="Function">makeTypeAlias</a> <a id="11298" href="Foreign.HaskellTypes.Deriving.html#11298" class="Bound">agdaName</a> <a id="11307" href="Foreign.HaskellTypes.Deriving.html#11307" class="Bound">env</a> <a id="11311" href="Foreign.HaskellTypes.Deriving.html#11311" class="Bound">hole</a> <a id="11316" class="Symbol">=</a> <a id="11318" class="Keyword">do</a>
    <a id="11325" href="Foreign.HaskellTypes.Deriving.html#11325" class="Bound">hsTy</a> <a id="11330" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="11332" href="Foreign.HaskellTypes.Deriving.html#4317" class="Function">solveHsType</a> <a id="11344" class="Symbol">(</a><a id="11345" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="11349" href="Foreign.HaskellTypes.Deriving.html#11298" class="Bound">agdaName</a> <a id="11358" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="11360" class="Symbol">)</a>
    <a id="11366" href="Agda.Builtin.Reflection.html#9926" class="Postulate">pragmaForeign</a> <a id="11380" class="String">&quot;GHC&quot;</a> <a id="11386" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="11388" href="Text.Printf.html#1015" class="Function">printf</a> <a id="11395" class="String">&quot;type %s = %s&quot;</a> <a id="11410" class="Symbol">(</a><a id="11411" href="Foreign.HaskellTypes.Deriving.html#5101" class="Function">hsTypeName</a> <a id="11422" href="Foreign.HaskellTypes.Deriving.html#11307" class="Bound">env</a> <a id="11426" href="Foreign.HaskellTypes.Deriving.html#11298" class="Bound">agdaName</a><a id="11434" class="Symbol">)</a> <a id="11436" class="Symbol">(</a><a id="11437" href="Foreign.HaskellTypes.Deriving.html#8150" class="Function">renderHsType</a> <a id="11450" href="Foreign.HaskellTypes.Deriving.html#11325" class="Bound">hsTy</a><a id="11454" class="Symbol">)</a>
    <a id="11460" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="11466" href="Foreign.HaskellTypes.Deriving.html#11311" class="Bound">hole</a> <a id="11471" class="Symbol">(</a><a id="11472" class="Keyword">quote</a> <a id="11478" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="11485" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="11488" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="11492" class="Symbol">(</a><a id="11493" class="Keyword">quote</a> <a id="11499" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="11501" class="Symbol">)</a> <a id="11503" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="11506" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="11507" class="Symbol">)</a>

<a id="11510" class="Comment">-- * Exported macros</a>

<a id="doAutoHsType"></a><a id="11532" href="Foreign.HaskellTypes.Deriving.html#11532" class="Function">doAutoHsType</a> <a id="11545" class="Symbol">:</a> <a id="11547" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="11551" class="Symbol">→</a> <a id="11553" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11558" class="Symbol">→</a> <a id="11560" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11565" class="Symbol">→</a> <a id="11567" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11570" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="11575" href="Foreign.HaskellTypes.Deriving.html#11532" class="Function">doAutoHsType</a> <a id="11588" href="Foreign.HaskellTypes.Deriving.html#11588" class="Bound">env</a> <a id="11592" href="Foreign.HaskellTypes.Deriving.html#11592" class="Bound">d</a> <a id="11594" href="Foreign.HaskellTypes.Deriving.html#11594" class="Bound">hole</a> <a id="11599" class="Symbol">=</a> <a id="11601" class="Keyword">do</a>
  <a id="11606" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="11616" href="Foreign.HaskellTypes.Deriving.html#11594" class="Bound">hole</a> <a id="11621" class="Symbol">(</a><a id="11622" class="Keyword">quote</a> <a id="11628" href="Foreign.HaskellTypes.html#532" class="Record">HasHsType</a> <a id="11638" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">∙⟦</a> <a id="11641" href="Foreign.HaskellTypes.Deriving.html#11592" class="Bound">d</a> <a id="11643" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a> <a id="11645" href="Reflection.Syntax.html#3047" class="InductiveConstructor Operator">⟧</a><a id="11646" class="Symbol">)</a>
  <a id="11650" href="Foreign.HaskellTypes.Deriving.html#11650" class="Bound">hs</a> <a id="11653" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="11655" href="Foreign.HaskellTypes.Deriving.html#7599" class="Function">makeHsType</a> <a id="11666" href="Foreign.HaskellTypes.Deriving.html#11588" class="Bound">env</a> <a id="11670" href="Foreign.HaskellTypes.Deriving.html#11592" class="Bound">d</a>
  <a id="11674" href="Foreign.HaskellTypes.Deriving.html#4594" class="Function">debug</a> <a id="11680" class="Number">50</a> <a id="11683" class="String">&quot;  HsType %q = %q&quot;</a> <a id="11702" href="Foreign.HaskellTypes.Deriving.html#11592" class="Bound">d</a> <a id="11704" href="Foreign.HaskellTypes.Deriving.html#11650" class="Bound">hs</a>
  <a id="11709" href="Foreign.HaskellTypes.Deriving.html#10201" class="Function">bindHsType</a> <a id="11720" href="Foreign.HaskellTypes.Deriving.html#11588" class="Bound">env</a> <a id="11724" href="Foreign.HaskellTypes.Deriving.html#11592" class="Bound">d</a> <a id="11726" href="Foreign.HaskellTypes.Deriving.html#11650" class="Bound">hs</a>
  <a id="11731" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="11737" href="Foreign.HaskellTypes.Deriving.html#11594" class="Bound">hole</a> <a id="11742" class="Symbol">(</a><a id="11743" href="Reflection.Syntax.html#2695" class="InductiveConstructor Operator">`λ⟦</a> <a id="11747" href="Agda.Builtin.Reflection.html#5977" class="InductiveConstructor">proj</a> <a id="11752" class="Symbol">(</a><a id="11753" class="Keyword">quote</a> <a id="11759" href="Foreign.HaskellTypes.html#579" class="Field">HasHsType.HsType</a><a id="11775" class="Symbol">)</a> <a id="11777" href="Reflection.Syntax.html#2695" class="InductiveConstructor Operator">⇒</a> <a id="11779" href="Foreign.HaskellTypes.Deriving.html#11650" class="Bound">hs</a> <a id="11782" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a> <a id="11784" href="Reflection.Syntax.html#2695" class="InductiveConstructor Operator">⟧</a><a id="11785" class="Symbol">)</a>
  <a id="11789" href="Reflection.TCM.html#1087" class="Postulate">pure</a> <a id="11794" class="Symbol">(</a><a id="11795" href="Foreign.HaskellTypes.Deriving.html#11650" class="Bound">hs</a> <a id="11798" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a><a id="11799" class="Symbol">)</a>

<a id="11802" class="Keyword">macro</a>
  <a id="autoHsType"></a><a id="11810" href="Foreign.HaskellTypes.Deriving.html#11810" class="Macro">autoHsType</a> <a id="11821" class="Symbol">:</a> <a id="11823" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11828" class="Symbol">→</a> <a id="11830" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11835" class="Symbol">→</a> <a id="11837" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11840" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11844" href="Foreign.HaskellTypes.Deriving.html#11810" class="Macro">autoHsType</a> <a id="11855" href="Foreign.HaskellTypes.Deriving.html#11855" class="Bound">d</a> <a id="11857" href="Foreign.HaskellTypes.Deriving.html#11857" class="Bound">hole</a> <a id="11862" class="Symbol">=</a> <a id="11864" class="Symbol">_</a> <a id="11866" href="Class.Functor.Core.html#288" class="Function Operator">&lt;$</a> <a id="11869" href="Foreign.HaskellTypes.Deriving.html#11532" class="Function">doAutoHsType</a> <a id="11882" href="Foreign.HaskellTypes.Deriving.html#3795" class="Function">withDefaultDeriving</a> <a id="11902" href="Foreign.HaskellTypes.Deriving.html#11855" class="Bound">d</a> <a id="11904" href="Foreign.HaskellTypes.Deriving.html#11857" class="Bound">hole</a>

  <a id="11912" class="Keyword">infix</a> <a id="11918" class="Number">0</a> <a id="11920" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType_⊣_</a>
  <a id="autoHsType_⊣_"></a><a id="11936" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType_⊣_</a> <a id="11950" class="Symbol">:</a> <a id="11952" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="11957" class="Symbol">→</a> <a id="11959" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="11963" class="Symbol">→</a> <a id="11965" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="11970" class="Symbol">→</a> <a id="11972" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="11975" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="11979" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType_⊣_</a> <a id="11993" href="Foreign.HaskellTypes.Deriving.html#11993" class="Bound">d</a> <a id="11995" href="Foreign.HaskellTypes.Deriving.html#11995" class="Bound">env</a> <a id="11999" href="Foreign.HaskellTypes.Deriving.html#11999" class="Bound">hole</a> <a id="12004" class="Symbol">=</a> <a id="12006" class="Symbol">_</a> <a id="12008" href="Class.Functor.Core.html#288" class="Function Operator">&lt;$</a> <a id="12011" href="Foreign.HaskellTypes.Deriving.html#11532" class="Function">doAutoHsType</a> <a id="12024" class="Symbol">(</a><a id="12025" href="Foreign.HaskellTypes.Deriving.html#3795" class="Function">withDefaultDeriving</a> <a id="12045" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="12047" href="Foreign.HaskellTypes.Deriving.html#11995" class="Bound">env</a><a id="12050" class="Symbol">)</a> <a id="12052" href="Foreign.HaskellTypes.Deriving.html#11993" class="Bound">d</a> <a id="12054" href="Foreign.HaskellTypes.Deriving.html#11999" class="Bound">hole</a>

  <a id="12062" class="Keyword">infix</a> <a id="12068" class="Number">9</a> <a id="12070" href="Foreign.HaskellTypes.Deriving.html#12076" class="Macro Operator">_↦_</a>
  <a id="_↦_"></a><a id="12076" href="Foreign.HaskellTypes.Deriving.html#12076" class="Macro Operator">_↦_</a> <a id="12080" class="Symbol">:</a> <a id="12082" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12087" class="Symbol">→</a> <a id="12089" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="12096" class="Symbol">→</a> <a id="12098" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12103" class="Symbol">→</a> <a id="12105" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12108" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12112" href="Foreign.HaskellTypes.Deriving.html#12112" class="Bound">x</a> <a id="12114" href="Foreign.HaskellTypes.Deriving.html#12076" class="Macro Operator">↦</a> <a id="12116" href="Foreign.HaskellTypes.Deriving.html#12116" class="Bound">s</a> <a id="12118" class="Symbol">=</a> <a id="12120" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="12126" class="Symbol">(</a><a id="12127" class="Keyword">quote</a> <a id="12133" href="Foreign.HaskellTypes.Deriving.html#3029" class="Function">customName</a> <a id="12144" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∙⟦</a> <a id="12147" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="12151" class="Symbol">(</a><a id="12152" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="12157" href="Foreign.HaskellTypes.Deriving.html#12112" class="Bound">x</a><a id="12158" class="Symbol">)</a> <a id="12160" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∣</a> <a id="12162" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="12166" class="Symbol">(</a><a id="12167" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">string</a> <a id="12174" href="Foreign.HaskellTypes.Deriving.html#12116" class="Bound">s</a><a id="12175" class="Symbol">)</a> <a id="12177" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">⟧</a><a id="12178" class="Symbol">)</a>

  <a id="12183" class="Comment">-- Generate a Haskell type synonym for the HsType of the given type</a>
  <a id="12253" class="Comment">-- Usage `unquoteDecl = do hsTypeSynonym Foo; hsTypeSynonym Bar`</a>
  <a id="hsTypeAlias"></a><a id="12320" href="Foreign.HaskellTypes.Deriving.html#12320" class="Macro">hsTypeAlias</a> <a id="12332" class="Symbol">:</a> <a id="12334" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12339" class="Symbol">→</a> <a id="12341" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12346" class="Symbol">→</a> <a id="12348" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12351" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12355" href="Foreign.HaskellTypes.Deriving.html#12320" class="Macro">hsTypeAlias</a> <a id="12367" href="Foreign.HaskellTypes.Deriving.html#12367" class="Bound">agdaName</a> <a id="12376" class="Symbol">=</a> <a id="12378" href="Foreign.HaskellTypes.Deriving.html#11241" class="Function">makeTypeAlias</a> <a id="12392" href="Foreign.HaskellTypes.Deriving.html#12367" class="Bound">agdaName</a> <a id="12401" href="Foreign.HaskellTypes.Deriving.html#2798" class="Function">emptyEnv</a>

  <a id="12413" class="Comment">-- The only Env that&#39;s useful here is `withName`.</a>
  <a id="hsTypeAlias_⊣_"></a><a id="12465" href="Foreign.HaskellTypes.Deriving.html#12465" class="Macro Operator">hsTypeAlias_⊣_</a> <a id="12480" class="Symbol">:</a> <a id="12482" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="12487" class="Symbol">→</a> <a id="12489" href="Foreign.HaskellTypes.Deriving.html#2301" class="Record">Env</a> <a id="12493" class="Symbol">→</a> <a id="12495" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12500" class="Symbol">→</a> <a id="12502" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12505" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12509" href="Foreign.HaskellTypes.Deriving.html#12465" class="Macro Operator">hsTypeAlias</a> <a id="12521" href="Foreign.HaskellTypes.Deriving.html#12521" class="Bound">agdaName</a> <a id="12530" href="Foreign.HaskellTypes.Deriving.html#12465" class="Macro Operator">⊣</a> <a id="12532" href="Foreign.HaskellTypes.Deriving.html#12532" class="Bound">env</a> <a id="12536" class="Symbol">=</a> <a id="12538" href="Foreign.HaskellTypes.Deriving.html#11241" class="Function">makeTypeAlias</a> <a id="12552" href="Foreign.HaskellTypes.Deriving.html#12521" class="Bound">agdaName</a> <a id="12561" href="Foreign.HaskellTypes.Deriving.html#12532" class="Bound">env</a>

  <a id="12568" class="Comment">-- * Macros for constructing and deconstructing generated types</a>

  <a id="hsCon"></a><a id="12635" href="Foreign.HaskellTypes.Deriving.html#12635" class="Macro">hsCon</a> <a id="12641" class="Symbol">:</a> <a id="12643" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12648" class="Symbol">→</a> <a id="12650" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="12652" class="Symbol">→</a> <a id="12654" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="12659" class="Symbol">→</a> <a id="12661" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="12664" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="12668" href="Foreign.HaskellTypes.Deriving.html#12635" class="Macro">hsCon</a> <a id="12674" href="Foreign.HaskellTypes.Deriving.html#12674" class="Bound">agdaTy</a> <a id="12681" href="Foreign.HaskellTypes.Deriving.html#12681" class="Bound">i</a> <a id="12683" href="Foreign.HaskellTypes.Deriving.html#12683" class="Bound">hole</a> <a id="12688" class="Symbol">=</a> <a id="12690" class="Keyword">do</a>
    <a id="12697" href="Foreign.HaskellTypes.Deriving.html#12697" class="Bound">hsTy</a><a id="12701" class="Symbol">@(</a><a id="12703" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="12707" href="Foreign.HaskellTypes.Deriving.html#12707" class="Bound">hsName</a> <a id="12714" class="Symbol">_)</a> <a id="12717" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="12719" href="Foreign.HaskellTypes.Deriving.html#4317" class="Function">solveHsType</a> <a id="12731" href="Foreign.HaskellTypes.Deriving.html#12674" class="Bound">agdaTy</a>
      <a id="12744" class="Keyword">where</a> <a id="12750" class="CatchallClause Symbol">_</a> <a id="12752" class="Symbol">→</a> <a id="12754" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12767" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="12800" href="Foreign.HaskellTypes.Deriving.html#12674" class="Bound">agdaTy</a>
    <a id="12811" href="Foreign.HaskellTypes.Deriving.html#12811" class="Bound">cs</a> <a id="12814" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="12816" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="12830" href="Foreign.HaskellTypes.Deriving.html#12707" class="Bound">hsName</a> <a id="12837" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="12841" class="Symbol">λ</a> <a id="12843" class="Keyword">where</a>
      <a id="12855" class="Symbol">(</a><a id="12856" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="12866" class="Symbol">_</a> <a id="12868" href="Foreign.HaskellTypes.Deriving.html#12868" class="Bound">cs</a><a id="12870" class="Symbol">)</a>  <a id="12873" class="Symbol">→</a> <a id="12875" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="12882" href="Foreign.HaskellTypes.Deriving.html#12868" class="Bound">cs</a>
      <a id="12891" class="CatchallClause Symbol">_</a> <a id="12893" class="Symbol">→</a> <a id="12895" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="12908" class="String">&quot;Expected HsType %t to be a data type, but got %t&quot;</a> <a id="12959" href="Foreign.HaskellTypes.Deriving.html#12674" class="Bound">agdaTy</a> <a id="12966" href="Foreign.HaskellTypes.Deriving.html#12697" class="Bound">hsTy</a>
    <a id="12975" href="Foreign.HaskellTypes.Deriving.html#12975" class="Bound">c</a> <a id="12977" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="12979" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a> <a id="12986" href="Class.Monad.Core.html#316" class="Field">return</a>  <a id="12994" class="Symbol">(</a><a id="12995" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13008" class="String">&quot;%q has only %u constructors&quot;</a> <a id="13038" href="Foreign.HaskellTypes.Deriving.html#12707" class="Bound">hsName</a> <a id="13045" class="Symbol">(</a><a id="13046" href="Data.List.Base.html#4746" class="Function">length</a> <a id="13053" href="Foreign.HaskellTypes.Deriving.html#12811" class="Bound">cs</a><a id="13055" class="Symbol">))</a> <a id="13058" class="Symbol">(</a><a id="13059" href="Foreign.HaskellTypes.Deriving.html#12811" class="Bound">cs</a> <a id="13062" href="Foreign.HaskellTypes.Deriving.html#2024" class="Function Operator">‼</a> <a id="13064" href="Foreign.HaskellTypes.Deriving.html#12681" class="Bound">i</a><a id="13065" class="Symbol">)</a>
    <a id="13071" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="13077" href="Foreign.HaskellTypes.Deriving.html#12683" class="Bound">hole</a> <a id="13082" class="Symbol">(</a><a id="13083" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="13087" href="Foreign.HaskellTypes.Deriving.html#12975" class="Bound">c</a> <a id="13089" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="13091" class="Symbol">)</a>

  <a id="hsProj"></a><a id="13096" href="Foreign.HaskellTypes.Deriving.html#13096" class="Macro">hsProj</a> <a id="13103" class="Symbol">:</a> <a id="13105" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13110" class="Symbol">→</a> <a id="13112" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="13114" class="Symbol">→</a> <a id="13116" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13121" class="Symbol">→</a> <a id="13123" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="13126" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="13130" href="Foreign.HaskellTypes.Deriving.html#13096" class="Macro">hsProj</a> <a id="13137" href="Foreign.HaskellTypes.Deriving.html#13137" class="Bound">agdaTy</a> <a id="13144" href="Foreign.HaskellTypes.Deriving.html#13144" class="Bound">i</a> <a id="13146" href="Foreign.HaskellTypes.Deriving.html#13146" class="Bound">hole</a> <a id="13151" class="Symbol">=</a> <a id="13153" class="Keyword">do</a>
    <a id="13160" href="Foreign.HaskellTypes.Deriving.html#13160" class="Bound">hsTy</a><a id="13164" class="Symbol">@(</a><a id="13166" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="13170" href="Foreign.HaskellTypes.Deriving.html#13170" class="Bound">hsName</a> <a id="13177" class="Symbol">_)</a> <a id="13180" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="13182" href="Foreign.HaskellTypes.Deriving.html#4317" class="Function">solveHsType</a> <a id="13194" href="Foreign.HaskellTypes.Deriving.html#13137" class="Bound">agdaTy</a>
      <a id="13207" class="Keyword">where</a> <a id="13213" class="CatchallClause Symbol">_</a> <a id="13215" class="Symbol">→</a> <a id="13217" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13230" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="13263" href="Foreign.HaskellTypes.Deriving.html#13137" class="Bound">agdaTy</a>
    <a id="13274" href="Foreign.HaskellTypes.Deriving.html#13274" class="Bound">prjs</a> <a id="13279" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="13281" href="Agda.Builtin.Reflection.html#9766" class="Postulate">getDefinition</a> <a id="13295" href="Foreign.HaskellTypes.Deriving.html#13170" class="Bound">hsName</a> <a id="13302" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="13306" class="Symbol">λ</a> <a id="13308" class="Keyword">where</a>
      <a id="13320" class="Symbol">(</a><a id="13321" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="13331" href="Foreign.HaskellTypes.Deriving.html#13331" class="Bound">npars</a> <a id="13337" class="Symbol">(</a><a id="13338" href="Foreign.HaskellTypes.Deriving.html#13338" class="Bound">c</a> <a id="13340" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="13342" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="13344" class="Symbol">))</a> <a id="13347" class="Symbol">→</a> <a id="13349" href="Foreign.HaskellTypes.Deriving.html#10788" class="Function">computeProjections</a> <a id="13368" href="Foreign.HaskellTypes.Deriving.html#13331" class="Bound">npars</a> <a id="13374" href="Foreign.HaskellTypes.Deriving.html#13338" class="Bound">c</a>
      <a id="13382" class="CatchallClause Symbol">_</a> <a id="13384" class="Symbol">→</a> <a id="13386" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13399" class="String">&quot;Expected HsType %t to be a single constructor data type, but got %t&quot;</a> <a id="13469" href="Foreign.HaskellTypes.Deriving.html#13137" class="Bound">agdaTy</a> <a id="13476" href="Foreign.HaskellTypes.Deriving.html#13160" class="Bound">hsTy</a>
    <a id="13485" href="Foreign.HaskellTypes.Deriving.html#13485" class="Bound">prj</a> <a id="13489" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="13491" href="Data.Maybe.Base.html#1468" class="Function">maybe′</a> <a id="13498" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="13505" class="Symbol">(</a><a id="13506" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13519" class="String">&quot;%q has only %u fields&quot;</a> <a id="13543" href="Foreign.HaskellTypes.Deriving.html#13170" class="Bound">hsName</a> <a id="13550" class="Symbol">(</a><a id="13551" href="Data.List.Base.html#4746" class="Function">length</a> <a id="13558" href="Foreign.HaskellTypes.Deriving.html#13274" class="Bound">prjs</a><a id="13562" class="Symbol">))</a> <a id="13565" class="Symbol">(</a><a id="13566" href="Foreign.HaskellTypes.Deriving.html#13274" class="Bound">prjs</a> <a id="13571" href="Foreign.HaskellTypes.Deriving.html#2024" class="Function Operator">‼</a> <a id="13573" href="Foreign.HaskellTypes.Deriving.html#13144" class="Bound">i</a><a id="13574" class="Symbol">)</a>
    <a id="13580" href="Foreign.HaskellTypes.Deriving.html#13580" class="Bound">target</a> <a id="13587" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="13589" href="Reflection.TCM.html#1261" class="Function">newMeta</a> <a id="13597" href="Reflection.Syntax.html#3546" class="InductiveConstructor">`Set</a>
    <a id="13606" href="Agda.Builtin.Reflection.html#8929" class="Postulate">checkType</a> <a id="13616" href="Foreign.HaskellTypes.Deriving.html#13146" class="Bound">hole</a> <a id="13621" class="Symbol">(</a><a id="13622" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="13625" class="Symbol">(</a><a id="13626" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="13631" href="Foreign.HaskellTypes.Deriving.html#13160" class="Bound">hsTy</a><a id="13635" class="Symbol">)</a> <a id="13637" class="Symbol">(</a><a id="13638" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="13642" class="String">&quot;_&quot;</a> <a id="13646" href="Foreign.HaskellTypes.Deriving.html#13580" class="Bound">target</a><a id="13652" class="Symbol">))</a>
    <a id="13659" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="13665" href="Foreign.HaskellTypes.Deriving.html#13146" class="Bound">hole</a> <a id="13670" href="Foreign.HaskellTypes.Deriving.html#13485" class="Bound">prj</a>

  <a id="hsTyName"></a><a id="13677" href="Foreign.HaskellTypes.Deriving.html#13677" class="Macro">hsTyName</a> <a id="13686" class="Symbol">:</a> <a id="13688" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13693" class="Symbol">→</a> <a id="13695" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="13700" class="Symbol">→</a> <a id="13702" href="Agda.Builtin.Reflection.html#8617" class="Postulate">TC</a> <a id="13705" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="13709" href="Foreign.HaskellTypes.Deriving.html#13677" class="Macro">hsTyName</a> <a id="13718" href="Foreign.HaskellTypes.Deriving.html#13718" class="Bound">agdaTy</a> <a id="13725" href="Foreign.HaskellTypes.Deriving.html#13725" class="Bound">hole</a> <a id="13730" class="Symbol">=</a> <a id="13732" class="Keyword">do</a>
    <a id="13739" href="Foreign.HaskellTypes.Deriving.html#13739" class="Bound">hsTy</a><a id="13743" class="Symbol">@(</a><a id="13745" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="13749" href="Foreign.HaskellTypes.Deriving.html#13749" class="Bound">hsName</a> <a id="13756" class="Symbol">_)</a> <a id="13759" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="13761" href="Foreign.HaskellTypes.Deriving.html#4317" class="Function">solveHsType</a> <a id="13773" href="Foreign.HaskellTypes.Deriving.html#13718" class="Bound">agdaTy</a>
      <a id="13786" class="Keyword">where</a> <a id="13792" class="CatchallClause Symbol">_</a> <a id="13794" class="Symbol">→</a> <a id="13796" href="Reflection.TCM.Format.html#2592" class="Function">typeErrorFmt</a> <a id="13809" class="String">&quot;Failed to compute HsType of %t&quot;</a> <a id="13842" href="Foreign.HaskellTypes.Deriving.html#13718" class="Bound">agdaTy</a>
    <a id="13853" href="Agda.Builtin.Reflection.html#8790" class="Postulate">unify</a> <a id="13859" href="Foreign.HaskellTypes.Deriving.html#13725" class="Bound">hole</a> <a id="13864" class="Symbol">(</a><a id="13865" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="13869" class="Symbol">(</a><a id="13870" href="Agda.Builtin.Reflection.html#4589" class="InductiveConstructor">name</a> <a id="13875" href="Foreign.HaskellTypes.Deriving.html#13749" class="Bound">hsName</a><a id="13881" class="Symbol">))</a>
</pre></body></html>