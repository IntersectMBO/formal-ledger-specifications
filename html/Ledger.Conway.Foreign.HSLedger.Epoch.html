<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Epoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Epoch.html" class="Module">Ledger.Conway.Foreign.HSLedger.Epoch</a> <a id="45" class="Keyword">where</a>

<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="154" class="Keyword">open</a> <a id="159" class="Keyword">import</a> <a id="166" href="Ledger.Conway.Foreign.HSLedger.Ledger.html" class="Module">Ledger.Conway.Foreign.HSLedger.Ledger</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Ledger.Conway.Foreign.HSLedger.Ratify.html" class="Module">Ledger.Conway.Foreign.HSLedger.Ratify</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Ledger.Conway.Foreign.HSLedger.Rewards.html" class="Module">Ledger.Conway.Foreign.HSLedger.Rewards</a>

<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Ledger.Conway.Conformance.Equivalence.Convert.html" class="Module">Ledger.Conway.Conformance.Equivalence.Convert</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Ledger.Conway.Conformance.Epoch.html" class="Module">Ledger.Conway.Conformance.Epoch</a> <a id="459" href="Function.Base.html#4755" class="Function">it</a> <a id="462" href="Function.Base.html#4755" class="Function">it</a>
<a id="465" class="Keyword">open</a> <a id="470" class="Keyword">import</a> <a id="477" href="Ledger.Conway.Conformance.Epoch.Properties.html" class="Module">Ledger.Conway.Conformance.Epoch.Properties</a> <a id="520" href="Function.Base.html#4755" class="Function">it</a> <a id="523" href="Function.Base.html#4755" class="Function">it</a>

<a id="527" class="Keyword">module</a> <a id="EpochSpec"></a><a id="534" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#534" class="Module">EpochSpec</a> <a id="544" class="Keyword">where</a>
  <a id="552" class="Keyword">open</a> <a id="557" class="Keyword">import</a> <a id="564" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="598" href="Function.Base.html#4755" class="Function">it</a> <a id="601" href="Function.Base.html#4755" class="Function">it</a> <a id="604" class="Keyword">public</a>
  <a id="613" class="Keyword">open</a> <a id="618" class="Keyword">import</a> <a id="625" href="Ledger.Conway.Specification.Epoch.Properties.Computational.html" class="Module">Ledger.Conway.Specification.Epoch.Properties.Computational</a> <a id="684" href="Function.Base.html#4755" class="Function">it</a> <a id="687" href="Function.Base.html#4755" class="Function">it</a> <a id="690" class="Keyword">public</a>

<a id="698" class="Keyword">import</a> <a id="705" href="Data.String.html" class="Module">Data.String</a> <a id="717" class="Symbol">as</a> <a id="720" class="Module">S</a>

<a id="723" class="Keyword">instance</a>
  <a id="Show-EPOCH"></a><a id="734" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#734" class="Function">Show-EPOCH</a> <a id="745" class="Symbol">:</a> <a id="747" class="Symbol">∀</a> <a id="749" class="Symbol">{</a><a id="750" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#750" class="Bound">eps</a> <a id="754" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#754" class="Bound">e</a> <a id="756" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#756" class="Bound">eps&#39;</a><a id="760" class="Symbol">}</a> <a id="762" class="Symbol">→</a> <a id="764" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="769" class="Symbol">(_</a> <a id="772" href="Ledger.Conway.Specification.Epoch.html#16859" class="Datatype Operator">EpochSpec.⊢</a> <a id="784" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#750" class="Bound">eps</a> <a id="788" href="Ledger.Conway.Specification.Epoch.html#16859" class="Datatype Operator">⇀⦇</a> <a id="791" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#754" class="Bound">e</a> <a id="793" href="Ledger.Conway.Specification.Epoch.html#16859" class="Datatype Operator">,EPOCH⦈</a> <a id="801" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#756" class="Bound">eps&#39;</a><a id="805" class="Symbol">)</a>
  <a id="809" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#734" class="Function">Show-EPOCH</a> <a id="820" class="Symbol">.</a><a id="821" href="Class.Show.Core.html#187" class="Field">show</a> <a id="826" class="Symbol">(</a><a id="827" href="Ledger.Conway.Specification.Epoch.html#16929" class="InductiveConstructor">EpochSpec.EPOCH</a> <a id="843" class="Symbol">(</a><a id="844" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#844" class="Bound">s</a> <a id="846" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="848" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#848" class="Bound">r</a> <a id="850" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="852" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#852" class="Bound">pr</a><a id="854" class="Symbol">))</a> <a id="857" class="Symbol">=</a>
    <a id="863" class="String">&quot;EPOCH\n&quot;</a> <a id="873" href="Data.String.Base.html#2425" class="Function Operator">S.++</a> <a id="878" class="String">&quot;SNAP&quot;</a> <a id="885" href="Data.String.Base.html#2425" class="Function Operator">S.++</a> <a id="890" class="String">&quot; POOLREAP&quot;</a>

<a id="903" class="Keyword">instance</a>
  <a id="HsTy-EpochState"></a><a id="914" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#914" class="Function">HsTy-EpochState</a> <a id="930" class="Symbol">=</a> <a id="932" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType</a> <a id="943" href="Ledger.Conway.Conformance.Epoch.html#1249" class="Record">EpochState</a> <a id="954" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">⊣</a> <a id="956" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="972" class="String">&quot;MkEpochState&quot;</a>
                                          <a id="1029" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="1031" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="1043" class="String">&quot;es&quot;</a>
  <a id="Conv-EpochState"></a><a id="1050" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1050" class="Function">Conv-EpochState</a> <a id="1066" class="Symbol">=</a> <a id="1068" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="1080" href="Ledger.Conway.Conformance.Epoch.html#1249" class="Record">EpochState</a>

<a id="1092" class="Comment">-- An implementation of EPOCH that connects the conformance state</a>
<a id="1158" class="Comment">-- with the specification rule.</a>

<a id="epoch-step"></a><a id="1191" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1191" class="Function">epoch-step</a>
  <a id="1204" class="Symbol">:</a> <a id="1206" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1213" class="Symbol">(</a><a id="1214" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="1216" class="Symbol">→</a> <a id="1218" href="Ledger.Conway.Conformance.Epoch.html#1249" class="Record">EpochState</a> <a id="1229" class="Symbol">→</a> <a id="1231" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a> <a id="1237" class="Symbol">→</a> <a id="1239" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="1257" href="Data.Empty.html#914" class="Function">⊥</a> <a id="1259" class="Symbol">(</a><a id="1260" href="Ledger.Conway.Conformance.Epoch.html#1249" class="Record">EpochState</a> <a id="1271" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1273" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1279" class="Symbol">))</a>
<a id="1282" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1191" class="Function">epoch-step</a> <a id="1293" class="Symbol">_</a> <a id="1295" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1295" class="Bound">epochSt</a> <a id="1303" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1303" class="Bound">e</a> <a id="1305" class="Symbol">=</a>
  <a id="1309" class="Keyword">let</a> <a id="1313" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1313" class="Bound">r</a> <a id="1315" class="Symbol">=</a> <a id="1317" href="Ledger.Conway.Specification.Epoch.Properties.Computational.html#4523" class="Function">EpochSpec.Computational-EPOCH</a> <a id="1347" class="Symbol">.</a><a id="1348" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1361" class="Symbol">_</a> <a id="1363" class="Symbol">(</a><a id="1364" href="Ledger.Conway.Conformance.Equivalence.Convert.html#452" class="Function">conv</a> <a id="1369" class="Symbol">(</a><a id="1370" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="1375" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1295" class="Bound">epochSt</a><a id="1382" class="Symbol">))</a> <a id="1385" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1303" class="Bound">e</a>
  <a id="1389" class="Keyword">in</a> <a id="1392" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1397" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1313" class="Bound">r</a> <a id="1399" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1402" class="Symbol">λ</a> <a id="1404" class="Keyword">where</a>
    <a id="1414" class="Symbol">(</a><a id="1415" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1423" class="Symbol">(</a><a id="1424" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1424" class="Bound">s</a> <a id="1426" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1428" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1428" class="Bound">p</a><a id="1429" class="Symbol">))</a> <a id="1432" class="Symbol">→</a> <a id="1434" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1437" class="Symbol">(</a><a id="1438" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1446" class="Symbol">(</a><a id="1447" href="Ledger.Conway.Conformance.Equivalence.Convert.html#452" class="Function">conv</a> <a id="1452" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1424" class="Bound">s</a> <a id="1454" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1456" href="Class.Show.Core.html#187" class="Field">show</a> <a id="1461" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1428" class="Bound">p</a><a id="1462" class="Symbol">))</a>

<a id="1466" class="Symbol">{-#</a> <a id="1470" class="Keyword">COMPILE</a> <a id="1478" class="Keyword">GHC</a> <a id="1482" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1191" class="Function">epoch-step</a> <a id="1493" class="Pragma">as</a> <a id="1496" class="Pragma">epochStep</a> <a id="1506" class="Symbol">#-}</a>
</pre></body></html>