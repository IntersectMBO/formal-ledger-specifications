<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Epoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Epoch.html" class="Module">Ledger.Conway.Foreign.HSLedger.Epoch</a> <a id="45" class="Keyword">where</a>

<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="154" class="Keyword">open</a> <a id="159" class="Keyword">import</a> <a id="166" href="Ledger.Conway.Foreign.HSLedger.Ledger.html" class="Module">Ledger.Conway.Foreign.HSLedger.Ledger</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Ledger.Conway.Foreign.HSLedger.Ratify.html" class="Module">Ledger.Conway.Foreign.HSLedger.Ratify</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Ledger.Conway.Foreign.HSLedger.Rewards.html" class="Module">Ledger.Conway.Foreign.HSLedger.Rewards</a>

<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Ledger.Conway.Conformance.Epoch.html" class="Module">Ledger.Conway.Conformance.Epoch</a> <a id="401" href="Function.Base.html#4755" class="Function">it</a> <a id="404" href="Function.Base.html#4755" class="Function">it</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Ledger.Conway.Conformance.Epoch.Properties.html" class="Module">Ledger.Conway.Conformance.Epoch.Properties</a> <a id="462" href="Function.Base.html#4755" class="Function">it</a> <a id="465" href="Function.Base.html#4755" class="Function">it</a>

<a id="469" class="Keyword">import</a> <a id="476" href="Data.String.html" class="Module">Data.String</a> <a id="488" class="Symbol">as</a> <a id="491" class="Module">S</a>

<a id="494" class="Keyword">instance</a>
  <a id="Show-EPOCH"></a><a id="505" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#505" class="Function">Show-EPOCH</a> <a id="516" class="Symbol">:</a> <a id="518" class="Symbol">∀</a> <a id="520" class="Symbol">{</a><a id="521" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#521" class="Bound">eps</a> <a id="525" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#525" class="Bound">e</a> <a id="527" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#527" class="Bound">eps&#39;</a><a id="531" class="Symbol">}</a> <a id="533" class="Symbol">→</a> <a id="535" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="540" class="Symbol">(_</a> <a id="543" href="Ledger.Conway.Conformance.Epoch.html#2548" class="Datatype Operator">⊢</a> <a id="545" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#521" class="Bound">eps</a> <a id="549" href="Ledger.Conway.Conformance.Epoch.html#2548" class="Datatype Operator">⇀⦇</a> <a id="552" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#525" class="Bound">e</a> <a id="554" href="Ledger.Conway.Conformance.Epoch.html#2548" class="Datatype Operator">,EPOCH⦈</a> <a id="562" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#527" class="Bound">eps&#39;</a><a id="566" class="Symbol">)</a>
  <a id="570" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#505" class="Function">Show-EPOCH</a> <a id="581" class="Symbol">.</a><a id="582" href="Class.Show.Core.html#187" class="Field">show</a> <a id="587" class="Symbol">(</a><a id="588" href="Ledger.Conway.Conformance.Epoch.html#2617" class="InductiveConstructor">EPOCH</a> <a id="594" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#594" class="Bound">e</a> <a id="596" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#596" class="Bound">s</a><a id="597" class="Symbol">)</a> <a id="599" class="Symbol">=</a> <a id="601" class="String">&quot;EPOCH\n&quot;</a> <a id="611" href="Data.String.Base.html#2425" class="Function Operator">S.++</a> <a id="616" href="Class.Show.Core.html#187" class="Field">show</a> <a id="621" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#596" class="Bound">s</a> <a id="623" href="Data.String.Base.html#2425" class="Function Operator">S.++</a> <a id="628" class="String">&quot; &quot;</a> <a id="632" href="Data.String.Base.html#2425" class="Function Operator">S.++</a> <a id="637" href="Class.Show.Core.html#187" class="Field">show</a> <a id="642" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#594" class="Bound">e</a> 

    <a id="650" class="Comment">-- record { currentEpoch = e</a>
    <a id="683" class="Comment">--        ; stakeDistrs = mkStakeDistrs  (Snapshots.mark ss&#39;) govSt&#39;</a>
    <a id="756" class="Comment">--                                       (utxoSt&#39; .deposits) (voteDelegs dState)</a>
<a id="837" class="Keyword">instance</a>
  <a id="HsTy-EpochState"></a><a id="848" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#848" class="Function">HsTy-EpochState</a> <a id="864" class="Symbol">=</a> <a id="866" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="877" href="Ledger.Conway.Conformance.Epoch.html#989" class="Record">EpochState</a> <a id="888" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="890" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="906" class="String">&quot;MkEpochState&quot;</a>
                                          <a id="963" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="965" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="977" class="String">&quot;es&quot;</a>
  <a id="Conv-EpochState"></a><a id="984" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#984" class="Function">Conv-EpochState</a> <a id="1000" class="Symbol">=</a> <a id="1002" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="1014" href="Ledger.Conway.Conformance.Epoch.html#989" class="Record">EpochState</a>

<a id="epoch-step"></a><a id="1026" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1026" class="Function">epoch-step</a> <a id="1037" class="Symbol">:</a> <a id="1039" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1046" class="Symbol">(</a><a id="1047" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="1049" class="Symbol">→</a> <a id="1051" href="Ledger.Conway.Conformance.Epoch.html#989" class="Record">EpochState</a> <a id="1062" class="Symbol">→</a> <a id="1064" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a> <a id="1070" class="Symbol">→</a> <a id="1072" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="1090" href="Data.Empty.html#914" class="Function">⊥</a> <a id="1092" class="Symbol">(</a><a id="1093" href="Ledger.Conway.Conformance.Epoch.html#989" class="Record">EpochState</a> <a id="1104" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1106" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1112" class="Symbol">))</a>
<a id="1115" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1026" class="Function">epoch-step</a> <a id="1126" class="Symbol">_</a> <a id="1128" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1128" class="Bound">epochSt</a> <a id="1136" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1136" class="Bound">e</a> <a id="1138" class="Symbol">=</a>
  <a id="1142" class="Keyword">let</a> <a id="1146" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1146" class="Bound">r</a> <a id="1148" class="Symbol">=</a> <a id="1150" href="Ledger.Conway.Conformance.Epoch.Properties.html#3072" class="Function">Computational-EPOCH</a> <a id="1170" class="Symbol">.</a><a id="1171" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1184" class="Symbol">_</a> <a id="1186" class="Symbol">(</a><a id="1187" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="1192" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1128" class="Bound">epochSt</a><a id="1199" class="Symbol">)</a> <a id="1201" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1136" class="Bound">e</a>
  <a id="1205" class="Keyword">in</a> <a id="1208" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1213" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1146" class="Bound">r</a> <a id="1215" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1218" class="Symbol">λ</a> <a id="1220" class="Keyword">where</a>
    <a id="1230" class="Symbol">(</a><a id="1231" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1239" class="Symbol">(</a><a id="1240" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1240" class="Bound">s</a> <a id="1242" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1244" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1244" class="Bound">p</a><a id="1245" class="Symbol">))</a> <a id="1248" class="Symbol">→</a> <a id="1250" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1253" class="Symbol">(</a><a id="1254" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1262" class="Symbol">(</a><a id="1263" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1240" class="Bound">s</a> <a id="1265" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1267" href="Class.Show.Core.html#187" class="Field">show</a> <a id="1272" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1244" class="Bound">p</a><a id="1273" class="Symbol">))</a>

<a id="1277" class="Symbol">{-#</a> <a id="1281" class="Keyword">COMPILE</a> <a id="1289" class="Keyword">GHC</a> <a id="1293" href="Ledger.Conway.Foreign.HSLedger.Epoch.html#1026" class="Function">epoch-step</a> <a id="1304" class="Pragma">as</a> <a id="1307" class="Pragma">epochStep</a> <a id="1317" class="Symbol">#-}</a>
</pre></body></html>