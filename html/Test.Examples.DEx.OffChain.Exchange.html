<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Test.Examples.DEx.OffChain.Exchange</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">module</a> <a id="32" href="Test.Examples.DEx.OffChain.Exchange.html" class="Module">Test.Examples.DEx.OffChain.Exchange</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="102" class="Keyword">open</a> <a id="107" class="Keyword">import</a> <a id="114" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="153" class="Keyword">open</a> <a id="158" class="Keyword">import</a> <a id="165" href="Test.Examples.DEx.Datum.html" class="Module">Test.Examples.DEx.Datum</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Test.Examples.DEx.Validator.html" class="Module">Test.Examples.DEx.Validator</a>
<a id="229" class="Keyword">open</a> <a id="234" class="Keyword">import</a> <a id="241" href="Test.Examples.DEx.OffChain.Lib.html" class="Module">Test.Examples.DEx.OffChain.Lib</a>
<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Test.Prelude.html" class="Module">Test.Prelude</a> <a id="297" href="Test.Examples.DEx.Datum.html#695" class="Function">DExData</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Test.SymbolicData.html" class="Module">Test.SymbolicData</a> <a id="335" href="Test.Examples.DEx.Datum.html#695" class="Function">DExData</a>
<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Test.LedgerImplementation.html" class="Module">Test.LedgerImplementation</a> <a id="381" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="387" href="Test.SymbolicData.html#240" class="Function">SData</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="Test.AbstractImplementation.html" class="Module">Test.AbstractImplementation</a> <a id="433" href="Test.SymbolicData.html#2902" class="Function">valContext</a>
<a id="444" class="Keyword">open</a> <a id="449" class="Keyword">import</a> <a id="456" href="Test.Lib.html" class="Module">Test.Lib</a> <a id="465" href="Test.SymbolicData.html#2902" class="Function">valContext</a>

<a id="477" class="Keyword">open</a> <a id="482" class="Keyword">import</a> <a id="489" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="529" href="Test.LedgerImplementation.html#4275" class="Function">SVTransactionStructure</a> <a id="552" href="Test.AbstractImplementation.html#673" class="Function">SVAbstractFunctions</a>
<a id="572" class="Keyword">open</a> <a id="577" class="Keyword">import</a> <a id="584" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="617" href="Test.LedgerImplementation.html#4275" class="Function">SVTransactionStructure</a> <a id="640" href="Test.AbstractImplementation.html#673" class="Function">SVAbstractFunctions</a>

<a id="661" class="Keyword">open</a> <a id="666" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="687" href="Test.LedgerImplementation.html#4275" class="Function">SVTransactionStructure</a>
<a id="710" class="Keyword">open</a> <a id="715" href="Test.LedgerImplementation.html#1056" class="Module">Implementation</a>

<a id="731" class="Keyword">import</a> <a id="738" href="Data.Rational.Base.html" class="Module">Data.Rational.Base</a> <a id="757" class="Symbol">as</a> <a id="760" class="Module">Q</a>

<a id="scriptETxOut"></a><a id="763" href="Test.Examples.DEx.OffChain.Exchange.html#763" class="Function">scriptETxOut</a> <a id="776" class="Symbol">:</a> <a id="778" href="Test.Examples.DEx.Datum.html#349" class="Datatype">Label</a> <a id="784" class="Symbol">→</a> <a id="786" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="792" class="Symbol">→</a> <a id="794" class="Symbol">(</a><a id="795" href="Test.Examples.DEx.OffChain.Exchange.html#795" class="Bound">w</a> <a id="797" class="Symbol">:</a> <a id="799" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="800" class="Symbol">)</a> <a id="802" class="Symbol">→</a> <a id="804" class="Symbol">(</a><a id="805" href="Test.Examples.DEx.OffChain.Exchange.html#805" class="Bound">v</a> <a id="807" class="Symbol">:</a> <a id="809" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="814" class="Symbol">)</a> <a id="816" class="Symbol">→</a> <a id="818" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a>
<a id="824" href="Test.Examples.DEx.OffChain.Exchange.html#763" class="Function">scriptETxOut</a> <a id="837" class="Symbol">(</a><a id="838" href="Test.Examples.DEx.Datum.html#389" class="InductiveConstructor">Always</a> <a id="845" href="Test.Examples.DEx.OffChain.Exchange.html#845" class="Bound">q</a> <a id="847" href="Test.Examples.DEx.OffChain.Exchange.html#847" class="Bound">o</a><a id="848" class="Symbol">)</a> <a id="850" class="Symbol">(</a><a id="851" href="Test.Examples.DEx.OffChain.Exchange.html#851" class="Bound">fst</a> <a id="855" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="857" href="Test.Examples.DEx.OffChain.Exchange.html#857" class="Bound">txValue</a> <a id="865" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="867" href="Test.Examples.DEx.OffChain.Exchange.html#867" class="Bound">snd</a><a id="870" class="Symbol">)</a> <a id="872" href="Test.Examples.DEx.OffChain.Exchange.html#872" class="Bound">w</a> <a id="874" href="Test.Examples.DEx.OffChain.Exchange.html#874" class="Bound">v</a> <a id="876" class="Symbol">=</a> <a id="878" class="Symbol">(</a><a id="879" href="Test.Examples.DEx.OffChain.Exchange.html#851" class="Bound">fst</a> <a id="883" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="885" class="Symbol">(</a><a id="886" href="Test.Examples.DEx.OffChain.Exchange.html#857" class="Bound">txValue</a> <a id="894" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="896" href="Test.Examples.DEx.OffChain.Exchange.html#874" class="Bound">v</a><a id="897" class="Symbol">)</a> <a id="899" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="901" class="Symbol">(</a><a id="902" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="907" class="Symbol">(</a><a id="908" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="913" class="Symbol">(</a><a id="914" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="919" class="Symbol">(</a><a id="920" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="925" class="Symbol">(</a><a id="926" href="Test.Examples.DEx.Datum.html#389" class="InductiveConstructor">Always</a> <a id="933" href="Test.Examples.DEx.OffChain.Exchange.html#845" class="Bound">q</a> <a id="935" href="Test.Examples.DEx.OffChain.Exchange.html#847" class="Bound">o</a><a id="936" class="Symbol">)))))</a> <a id="942" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="944" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="951" class="Symbol">)</a>


<a id="makeExchangeTxOut"></a><a id="955" href="Test.Examples.DEx.OffChain.Exchange.html#955" class="Function">makeExchangeTxOut</a> <a id="973" class="Symbol">:</a> <a id="975" href="Test.Examples.DEx.Datum.html#349" class="Datatype">Label</a> <a id="981" class="Symbol">→</a> <a id="983" class="Symbol">(</a><a id="984" href="Test.Examples.DEx.OffChain.Exchange.html#984" class="Bound">scriptIx</a> <a id="993" class="Symbol">:</a> <a id="995" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="996" class="Symbol">)</a> <a id="998" class="Symbol">→</a> <a id="1000" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="1006" class="Symbol">→</a> <a id="1008" class="Symbol">(</a><a id="1009" href="Test.Examples.DEx.OffChain.Exchange.html#1009" class="Bound">w</a> <a id="1011" class="Symbol">:</a> <a id="1013" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1014" class="Symbol">)</a> <a id="1016" class="Symbol">→</a> <a id="1018" class="Symbol">(</a><a id="1019" href="Test.Examples.DEx.OffChain.Exchange.html#1019" class="Bound">v</a> <a id="1021" class="Symbol">:</a> <a id="1023" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="1028" class="Symbol">)</a> <a id="1030" class="Symbol">→</a> <a id="1032" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1037" class="Symbol">(</a><a id="1038" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1040" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1042" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="1047" class="Symbol">)</a>
<a id="1049" href="Test.Examples.DEx.OffChain.Exchange.html#955" class="Function">makeExchangeTxOut</a> <a id="1067" class="Symbol">(</a><a id="1068" href="Test.Examples.DEx.Datum.html#389" class="InductiveConstructor">Always</a> <a id="1075" href="Test.Examples.DEx.OffChain.Exchange.html#1075" class="Bound">r</a> <a id="1077" href="Test.Examples.DEx.OffChain.Exchange.html#1077" class="Bound">o</a><a id="1078" class="Symbol">)</a> <a id="1080" href="Test.Examples.DEx.OffChain.Exchange.html#1080" class="Bound">ix</a> <a id="1083" href="Test.Examples.DEx.OffChain.Exchange.html#1083" class="Bound">txo</a> <a id="1087" href="Test.Examples.DEx.OffChain.Exchange.html#1087" class="Bound">w</a> <a id="1089" href="Test.Examples.DEx.OffChain.Exchange.html#1089" class="Bound">v</a> <a id="1091" class="Symbol">=</a>
            <a id="1105" class="Symbol">(</a><a id="1106" href="Test.Examples.DEx.OffChain.Exchange.html#1080" class="Bound">ix</a> <a id="1109" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1111" href="Test.Examples.DEx.OffChain.Exchange.html#763" class="Function">scriptETxOut</a> <a id="1124" class="Symbol">(</a><a id="1125" href="Test.Examples.DEx.Datum.html#389" class="InductiveConstructor">Always</a> <a id="1132" href="Test.Examples.DEx.OffChain.Exchange.html#1075" class="Bound">r</a> <a id="1134" href="Test.Examples.DEx.OffChain.Exchange.html#1077" class="Bound">o</a><a id="1135" class="Symbol">)</a> <a id="1137" href="Test.Examples.DEx.OffChain.Exchange.html#1083" class="Bound">txo</a> <a id="1141" href="Test.Examples.DEx.OffChain.Exchange.html#1087" class="Bound">w</a> <a id="1143" href="Test.Examples.DEx.OffChain.Exchange.html#1089" class="Bound">v</a><a id="1144" class="Symbol">)</a> <a id="1146" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
            <a id="1160" class="Symbol">(</a><a id="1161" class="Number">2</a> <a id="1163" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1165" class="Symbol">((</a><a id="1167" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1172" class="Symbol">(</a><a id="1173" class="Keyword">record</a> <a id="1180" class="Symbol">{</a> <a id="1182" href="Ledger.Core.Specification.Address.html#1119" class="Field">net</a> <a id="1186" class="Symbol">=</a> <a id="1188" class="Number">0</a> <a id="1190" class="Symbol">;</a> <a id="1192" href="Ledger.Core.Specification.Address.html#1140" class="Field">pay</a> <a id="1196" class="Symbol">=</a> <a id="1198" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1209" href="Test.Examples.DEx.OffChain.Exchange.html#1077" class="Bound">o</a> <a id="1211" class="Symbol">;</a> <a id="1213" href="Ledger.Core.Specification.Address.html#1164" class="Field">stake</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1226" class="Symbol">(</a><a id="1227" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1238" href="Test.Examples.DEx.OffChain.Exchange.html#1077" class="Bound">o</a><a id="1239" class="Symbol">)</a> <a id="1241" class="Symbol">}))</a> <a id="1245" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a>
              <a id="1261" class="Symbol">(</a><a id="1262" href="Test.Examples.DEx.Validator.html#5360" class="Function">ratioValue</a> <a id="1273" href="Test.Examples.DEx.OffChain.Exchange.html#1089" class="Bound">v</a> <a id="1275" href="Test.Examples.DEx.OffChain.Exchange.html#1075" class="Bound">r</a> <a id="1277" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1279" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1287" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1289" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="1296" class="Symbol">)))</a><a id="1299" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1301" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>



<a id="makeExchangeTx"></a><a id="1307" href="Test.Examples.DEx.OffChain.Exchange.html#1307" class="Function">makeExchangeTx</a> <a id="1322" class="Symbol">:</a> <a id="1324" class="Symbol">(</a><a id="1325" href="Test.Examples.DEx.OffChain.Exchange.html#1325" class="Bound">id</a> <a id="1328" class="Symbol">:</a> <a id="1330" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1331" class="Symbol">)</a> <a id="1333" class="Symbol">→</a> <a id="1335" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a> <a id="1345" class="Symbol">→</a> <a id="1347" href="Test.LedgerImplementation.html#1450" class="Function">PlutusScript</a> <a id="1360" class="Symbol">→</a> <a id="1362" class="Symbol">(</a><a id="1363" href="Test.Examples.DEx.OffChain.Exchange.html#1363" class="Bound">w</a> <a id="1365" class="Symbol">:</a> <a id="1367" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1368" class="Symbol">)</a> <a id="1370" class="Symbol">→</a> <a id="1372" class="Symbol">(</a><a id="1373" href="Test.Examples.DEx.OffChain.Exchange.html#1373" class="Bound">v</a> <a id="1375" class="Symbol">:</a> <a id="1377" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="1382" class="Symbol">)</a> <a id="1384" class="Symbol">→</a> <a id="1386" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1392" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a>
<a id="1395" href="Test.Examples.DEx.OffChain.Exchange.html#1307" class="Function">makeExchangeTx</a> <a id="1410" href="Test.Examples.DEx.OffChain.Exchange.html#1410" class="Bound">id</a> <a id="1413" href="Test.Examples.DEx.OffChain.Exchange.html#1413" class="Bound">state</a> <a id="1419" href="Test.Examples.DEx.OffChain.Exchange.html#1419" class="Bound">script</a><a id="1425" class="Symbol">@(</a><a id="1427" href="Test.Examples.DEx.OffChain.Exchange.html#1427" class="Bound">sh</a> <a id="1430" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1432" class="Symbol">_)</a> <a id="1435" href="Test.Examples.DEx.OffChain.Exchange.html#1435" class="Bound">w</a> <a id="1437" href="Test.Examples.DEx.OffChain.Exchange.html#1437" class="Bound">v</a> <a id="1439" class="Symbol">=</a> 
  <a id="1444" class="Keyword">let</a>
    <a id="1452" href="Test.Examples.DEx.OffChain.Exchange.html#1452" class="Bound">wutxo</a> <a id="1458" class="Symbol">=</a> <a id="1460" href="Test.Examples.DEx.OffChain.Lib.html#2211" class="Function">getWalletUTxO</a> <a id="1474" href="Test.Examples.DEx.OffChain.Exchange.html#1435" class="Bound">w</a> <a id="1476" class="Symbol">(</a><a id="1477" href="Ledger.Conway.Specification.Utxo.html#1370" class="Field">UTxOState.utxo</a> <a id="1492" href="Test.Examples.DEx.OffChain.Exchange.html#1413" class="Bound">state</a><a id="1497" class="Symbol">)</a>
  <a id="1501" class="Keyword">in</a>
    <a id="1508" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1514" class="Symbol">(λ</a> <a id="1517" class="Symbol">{</a> <a id="1519" class="Symbol">(</a><a id="1520" href="Test.Examples.DEx.OffChain.Exchange.html#1520" class="Bound">scIn</a> <a id="1525" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1527" href="Test.Examples.DEx.OffChain.Exchange.html#1527" class="Bound">scOut</a><a id="1532" class="Symbol">)</a> <a id="1534" class="Symbol">→</a> <a id="1536" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="1542" class="Symbol">(λ</a> <a id="1545" class="Symbol">{(</a><a id="1547" href="Test.Examples.DEx.Datum.html#389" class="InductiveConstructor">Always</a> <a id="1554" href="Test.Examples.DEx.OffChain.Exchange.html#1554" class="Bound">r</a> <a id="1556" href="Test.Examples.DEx.OffChain.Exchange.html#1556" class="Bound">o</a><a id="1557" class="Symbol">)</a> <a id="1559" class="Symbol">→</a>
    <a id="1565" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1570" class="Symbol">(</a>
          <a id="1582" class="Keyword">record</a> <a id="1589" class="Symbol">{</a> <a id="1591" href="Ledger.Conway.Specification.Transaction.html#1747" class="Field">body</a> <a id="1596" class="Symbol">=</a> <a id="1598" class="Keyword">record</a> <a id="1605" href="Test.Examples.DEx.OffChain.Lib.html#611" class="Function">defaultTxBody</a>
                         <a id="1644" class="Symbol">{</a> <a id="1646" href="Ledger.Conway.Specification.Transaction.html#382" class="Field">txIns</a> <a id="1652" class="Symbol">=</a> <a id="1654" href="Axiom.Set.html#5903" class="Function">Ledger.Prelude.fromList</a> <a id="1678" class="Symbol">((</a><a id="1680" href="Test.Examples.DEx.OffChain.Exchange.html#1520" class="Bound">scIn</a> <a id="1685" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1687" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1689" class="Symbol">)</a> <a id="1691" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="1694" class="Symbol">(</a><a id="1695" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1699" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1705" href="Test.Examples.DEx.OffChain.Exchange.html#1452" class="Bound">wutxo</a><a id="1710" class="Symbol">))</a>
                         <a id="1738" class="Symbol">;</a> <a id="1740" href="Ledger.Conway.Specification.Transaction.html#484" class="Field">txOuts</a> <a id="1747" class="Symbol">=</a> <a id="1749" href="Test.Lib.html#5513" class="Function">fromListIx</a> <a id="1760" class="Symbol">(</a><a id="1761" href="Test.Examples.DEx.OffChain.Lib.html#3788" class="Function">makeFeeSwapTxOut</a> <a id="1778" href="Test.Examples.DEx.OffChain.Exchange.html#1452" class="Bound">wutxo</a> <a id="1784" href="Test.Examples.DEx.OffChain.Exchange.html#1437" class="Bound">v</a> <a id="1786" class="Symbol">(</a><a id="1787" href="Test.Examples.DEx.Validator.html#5360" class="Function">ratioValue</a> <a id="1798" href="Test.Examples.DEx.OffChain.Exchange.html#1437" class="Bound">v</a> <a id="1800" href="Test.Examples.DEx.OffChain.Exchange.html#1554" class="Bound">r</a><a id="1801" class="Symbol">)</a> <a id="1803" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="1806" href="Test.Examples.DEx.OffChain.Exchange.html#955" class="Function">makeExchangeTxOut</a> <a id="1824" class="Symbol">(</a><a id="1825" href="Test.Examples.DEx.Datum.html#389" class="InductiveConstructor">Always</a> <a id="1832" href="Test.Examples.DEx.OffChain.Exchange.html#1554" class="Bound">r</a> <a id="1834" href="Test.Examples.DEx.OffChain.Exchange.html#1556" class="Bound">o</a><a id="1835" class="Symbol">)</a> <a id="1837" class="Symbol">(</a><a id="1838" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1844" href="Test.Examples.DEx.OffChain.Exchange.html#1520" class="Bound">scIn</a><a id="1848" class="Symbol">)</a> <a id="1850" href="Test.Examples.DEx.OffChain.Exchange.html#1527" class="Bound">scOut</a> <a id="1856" href="Test.Examples.DEx.OffChain.Exchange.html#1435" class="Bound">w</a> <a id="1858" href="Test.Examples.DEx.OffChain.Exchange.html#1437" class="Bound">v</a> <a id="1860" class="Symbol">)</a>
                         <a id="1887" class="Symbol">;</a> <a id="1889" href="Ledger.Conway.Specification.Transaction.html#522" class="Field">txId</a> <a id="1894" class="Symbol">=</a> <a id="1896" href="Test.Examples.DEx.OffChain.Exchange.html#1410" class="Bound">id</a>
                         <a id="1924" class="Symbol">;</a> <a id="1926" href="Ledger.Conway.Specification.Transaction.html#450" class="Field">collateralInputs</a> <a id="1943" class="Symbol">=</a> <a id="1945" href="Axiom.Set.html#5903" class="Function">Ledger.Prelude.fromList</a> <a id="1969" class="Symbol">(</a><a id="1970" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1974" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1980" href="Test.Examples.DEx.OffChain.Exchange.html#1452" class="Bound">wutxo</a><a id="1985" class="Symbol">)</a>
                         <a id="2012" class="Symbol">;</a> <a id="2014" href="Ledger.Conway.Specification.Transaction.html#991" class="Field">reqSignerHashes</a> <a id="2030" class="Symbol">=</a> <a id="2032" href="Axiom.Set.html#5903" class="Function">Ledger.Prelude.fromList</a> <a id="2056" class="Symbol">(</a><a id="2057" href="Test.Examples.DEx.OffChain.Exchange.html#1435" class="Bound">w</a> <a id="2059" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2061" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2063" class="Symbol">)</a>
                         <a id="2090" class="Symbol">}</a> <a id="2092" class="Symbol">;</a>
                <a id="2110" href="Ledger.Conway.Specification.Transaction.html#1769" class="Field">wits</a> <a id="2115" class="Symbol">=</a> <a id="2117" class="Keyword">record</a> <a id="2124" class="Symbol">{</a> <a id="2126" href="Ledger.Core.Specification.Transaction.html#2928" class="Field">vkSigs</a> <a id="2133" class="Symbol">=</a> <a id="2135" href="Axiom.Set.Map.html#2713" class="Function">fromListᵐ</a> <a id="2145" class="Symbol">((</a><a id="2147" href="Test.Examples.DEx.OffChain.Exchange.html#1435" class="Bound">w</a> <a id="2149" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2151" class="Symbol">(</a><a id="2152" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="2156" class="Symbol">{{</a><a id="2158" href="Class.HasAdd.Instances.html#143" class="Function">addNat</a><a id="2164" class="Symbol">}}</a> <a id="2167" class="Symbol">(</a><a id="2168" href="Test.Examples.DEx.OffChain.Lib.html#4081" class="Function">getTxId</a> <a id="2176" href="Test.Examples.DEx.OffChain.Exchange.html#1452" class="Bound">wutxo</a><a id="2181" class="Symbol">)</a> <a id="2183" href="Test.Examples.DEx.OffChain.Exchange.html#1435" class="Bound">w</a><a id="2184" class="Symbol">))</a> <a id="2187" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2189" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2191" class="Symbol">)</a> <a id="2193" class="Symbol">;</a>
                                <a id="2227" href="Ledger.Core.Specification.Transaction.html#2956" class="Field">scripts</a> <a id="2235" class="Symbol">=</a> <a id="2237" href="Axiom.Set.html#5903" class="Function">Ledger.Prelude.fromList</a> <a id="2261" class="Symbol">((</a><a id="2263" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2268" href="Test.Examples.DEx.OffChain.Exchange.html#1419" class="Bound">script</a><a id="2274" class="Symbol">)</a> <a id="2276" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2278" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2280" class="Symbol">)</a> <a id="2282" class="Symbol">;</a>
                                <a id="2316" href="Ledger.Core.Specification.Transaction.html#2982" class="Field">txdats</a> <a id="2323" class="Symbol">=</a> <a id="2325" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="2327" class="Symbol">;</a> 
                                <a id="2362" href="Ledger.Core.Specification.Transaction.html#3007" class="Field">txrdmrs</a> <a id="2370" class="Symbol">=</a> <a id="2372" href="Axiom.Set.Map.html#2713" class="Function">fromListᵐ</a> <a id="2382" class="Symbol">(((</a><a id="2385" href="Ledger.Core.Specification.Transaction.html#778" class="InductiveConstructor">Spend</a> <a id="2391" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2393" class="Symbol">(</a><a id="2394" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2400" href="Test.Examples.DEx.OffChain.Exchange.html#1520" class="Bound">scIn</a><a id="2404" class="Symbol">))</a> <a id="2407" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a>
                                                      <a id="2463" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2468" class="Symbol">(</a><a id="2469" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2474" class="Symbol">(</a><a id="2475" href="Test.Examples.DEx.Datum.html#559" class="InductiveConstructor">Exchange</a> <a id="2484" href="Test.Examples.DEx.OffChain.Exchange.html#1435" class="Bound">w</a> <a id="2486" href="Test.Examples.DEx.OffChain.Exchange.html#1437" class="Bound">v</a><a id="2487" class="Symbol">))</a> <a id="2490" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> 
                                                      <a id="2547" class="Symbol">((</a><a id="2549" href="Test.Examples.DEx.OffChain.Lib.html#4081" class="Function">getTxId</a> <a id="2557" href="Test.Examples.DEx.OffChain.Exchange.html#1452" class="Bound">wutxo</a><a id="2562" class="Symbol">)</a> <a id="2564" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2566" href="Test.Examples.DEx.OffChain.Exchange.html#1435" class="Bound">w</a><a id="2567" class="Symbol">))</a> <a id="2570" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2572" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2574" class="Symbol">)</a> <a id="2576" class="Symbol">}</a> <a id="2578" class="Symbol">;</a>
                <a id="2596" href="Ledger.Conway.Specification.Transaction.html#1796" class="Field">txsize</a> <a id="2603" class="Symbol">=</a> <a id="2605" class="Number">10</a> <a id="2608" class="Symbol">;</a>
                <a id="2626" href="Ledger.Conway.Specification.Transaction.html#1813" class="Field">isValid</a> <a id="2634" class="Symbol">=</a> <a id="2636" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="2641" class="Symbol">;</a>
                <a id="2659" href="Ledger.Conway.Specification.Transaction.html#1833" class="Field">txAD</a> <a id="2664" class="Symbol">=</a> <a id="2666" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2674" class="Symbol">}</a>
                <a id="2692" class="Symbol">)})</a> 
            <a id="2709" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
            <a id="2729" class="Symbol">(</a><a id="2730" href="Test.Examples.DEx.OffChain.Lib.html#2667" class="Function">getLabel</a> <a id="2739" href="Test.Examples.DEx.OffChain.Exchange.html#1527" class="Bound">scOut</a><a id="2744" class="Symbol">)})</a>
          <a id="2758" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
          <a id="2776" class="Symbol">(</a><a id="2777" href="Test.Examples.DEx.OffChain.Lib.html#1702" class="Function">getScriptUTxO</a> <a id="2791" href="Test.Examples.DEx.OffChain.Exchange.html#1427" class="Bound">sh</a> <a id="2794" class="Symbol">(</a><a id="2795" href="Ledger.Conway.Specification.Utxo.html#1370" class="Field">UTxOState.utxo</a> <a id="2810" href="Test.Examples.DEx.OffChain.Exchange.html#1413" class="Bound">state</a><a id="2815" class="Symbol">))</a>
</pre></body></html>