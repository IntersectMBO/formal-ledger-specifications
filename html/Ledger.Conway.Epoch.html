<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Epoch</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="58" class="Keyword">using</a> <a id="64" class="Symbol">(</a><a id="65" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="75" class="Symbol">;</a> <a id="77" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a><a id="98" class="Symbol">)</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="125" class="Keyword">using</a> <a id="131" class="Symbol">()</a> <a id="134" class="Keyword">renaming</a> <a id="143" class="Symbol">(</a><a id="144" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a> <a id="147" class="Symbol">to</a> <a id="150" class="InductiveConstructor">pos</a><a id="153" class="Symbol">)</a>
<a id="155" class="Keyword">open</a> <a id="160" class="Keyword">import</a> <a id="167" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="198" class="Keyword">using</a> <a id="204" class="Symbol">(</a><a id="205" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a><a id="212" class="Symbol">)</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="240" class="Keyword">using</a> <a id="246" class="Symbol">(</a><a id="247" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="248" class="Symbol">;</a> <a id="250" href="Data.Rational.Base.html#7116" class="Function">floor</a><a id="255" class="Symbol">;</a> <a id="257" href="Data.Rational.Base.html#6315" class="Function Operator">_*_</a><a id="260" class="Symbol">;</a> <a id="262" href="Data.Rational.Base.html#6708" class="Function Operator">_÷_</a><a id="265" class="Symbol">;</a> <a id="267" href="Data.Rational.Base.html#3884" class="Function Operator">_/_</a><a id="270" class="Symbol">)</a>
<a id="272" class="Keyword">open</a> <a id="277" class="Keyword">import</a> <a id="284" href="Data.Rational.Literals.html" class="Module">Data.Rational.Literals</a> <a id="307" class="Keyword">using</a> <a id="313" class="Symbol">(</a><a id="314" href="Data.Rational.Literals.html#740" class="Function">number</a><a id="320" class="Symbol">;</a> <a id="322" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a><a id="327" class="Symbol">)</a>
<a id="329" class="Keyword">import</a>      <a id="341" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="355" class="Symbol">as</a> <a id="358" class="Module">ℚ</a> <a id="360" class="Keyword">renaming</a> <a id="369" class="Symbol">(</a><a id="370" href="Data.Rational.Base.html#6854" class="Function Operator">_⊓_</a> <a id="374" class="Symbol">to</a> <a id="377" class="Function Operator">min</a><a id="380" class="Symbol">)</a>

<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="417" class="Keyword">open</a> <a id="422" class="Keyword">import</a> <a id="429" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="444" class="Keyword">hiding</a> <a id="451" class="Symbol">(</a><a id="452" href="Data.List.Base.html#5412" class="Function">iterate</a><a id="459" class="Symbol">;</a> <a id="461" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="464" class="Symbol">;</a> <a id="466" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="469" class="Symbol">)</a>
<a id="471" class="Keyword">open</a> <a id="476" href="Ledger.Prelude.html#2677" class="Module">Filter</a> <a id="483" class="Keyword">using</a> <a id="489" class="Symbol">(</a><a id="490" href="Ledger.Prelude.html#2692" class="Function">filter</a><a id="496" class="Symbol">)</a>
<a id="498" class="Keyword">open</a> <a id="503" class="Keyword">import</a> <a id="510" href="Ledger.Conway.Abstract.html" class="Module">Ledger.Conway.Abstract</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Ledger.Conway.Transaction.html" class="Module">Ledger.Conway.Transaction</a>
<a id="571" class="Keyword">open</a> <a id="576" class="Keyword">import</a> <a id="583" href="Ledger.Conway.Types.Numeric.UnitInterval.html" class="Module">Ledger.Conway.Types.Numeric.UnitInterval</a>

<a id="625" class="Keyword">open</a> <a id="630" href="Agda.Builtin.FromNat.html#196" class="Module">Number</a> <a id="637" href="Data.Rational.Literals.html#740" class="Function">number</a> <a id="644" class="Keyword">renaming</a> <a id="653" class="Symbol">(</a><a id="654" href="Agda.Builtin.FromNat.html#281" class="Field">fromNat</a> <a id="662" class="Symbol">to</a> <a id="665" class="Field">fromℕ</a><a id="670" class="Symbol">)</a>

<a id="673" class="Keyword">module</a> <a id="680" href="Ledger.Conway.Epoch.html" class="Module">Ledger.Conway.Epoch</a>
  <a id="702" class="Symbol">(</a><a id="703" href="Ledger.Conway.Epoch.html#703" class="Bound">txs</a> <a id="707" class="Symbol">:</a> <a id="709" class="Symbol">_)</a> <a id="712" class="Symbol">(</a><a id="713" class="Keyword">open</a> <a id="718" href="Ledger.Conway.Transaction.html#910" class="Module">TransactionStructure</a> <a id="739" href="Ledger.Conway.Epoch.html#703" class="Bound">txs</a><a id="742" class="Symbol">)</a>
  <a id="746" class="Symbol">(</a><a id="747" href="Ledger.Conway.Epoch.html#747" class="Bound">abs</a> <a id="751" class="Symbol">:</a> <a id="753" href="Ledger.Conway.Abstract.html#599" class="Record">AbstractFunctions</a> <a id="771" href="Ledger.Conway.Epoch.html#703" class="Bound">txs</a><a id="774" class="Symbol">)</a> <a id="776" class="Symbol">(</a><a id="777" class="Keyword">open</a> <a id="782" href="Ledger.Conway.Abstract.html#599" class="Module">AbstractFunctions</a> <a id="800" href="Ledger.Conway.Epoch.html#747" class="Bound">abs</a><a id="803" class="Symbol">)</a>
  <a id="807" class="Keyword">where</a>

<a id="814" class="Keyword">open</a> <a id="819" class="Keyword">import</a> <a id="826" href="Ledger.Conway.Certs.html" class="Module">Ledger.Conway.Certs</a> <a id="846" href="Ledger.Conway.Transaction.html#1880" class="Function">govStructure</a>
<a id="859" class="Keyword">open</a> <a id="864" class="Keyword">import</a> <a id="871" href="Ledger.Conway.Enact.html" class="Module">Ledger.Conway.Enact</a> <a id="891" href="Ledger.Conway.Transaction.html#1880" class="Function">govStructure</a>
<a id="904" class="Keyword">open</a> <a id="909" class="Keyword">import</a> <a id="916" href="Ledger.Conway.Gov.html" class="Module">Ledger.Conway.Gov</a> <a id="934" href="Ledger.Conway.Epoch.html#703" class="Bound">txs</a>
<a id="938" class="Keyword">open</a> <a id="943" class="Keyword">import</a> <a id="950" href="Ledger.Conway.Ledger.html" class="Module">Ledger.Conway.Ledger</a> <a id="971" href="Ledger.Conway.Epoch.html#703" class="Bound">txs</a> <a id="975" href="Ledger.Conway.Epoch.html#747" class="Bound">abs</a>
<a id="979" class="Keyword">open</a> <a id="984" class="Keyword">import</a> <a id="991" href="Ledger.Conway.Ratify.html" class="Module">Ledger.Conway.Ratify</a> <a id="1012" href="Ledger.Conway.Epoch.html#703" class="Bound">txs</a>
<a id="1016" class="Keyword">open</a> <a id="1021" class="Keyword">import</a> <a id="1028" href="Ledger.Conway.Rewards.html" class="Module">Ledger.Conway.Rewards</a> <a id="1050" href="Ledger.Conway.Epoch.html#703" class="Bound">txs</a> <a id="1054" href="Ledger.Conway.Epoch.html#747" class="Bound">abs</a>
<a id="1058" class="Keyword">open</a> <a id="1063" class="Keyword">import</a> <a id="1070" href="Ledger.Conway.Utxo.html" class="Module">Ledger.Conway.Utxo</a> <a id="1089" href="Ledger.Conway.Epoch.html#703" class="Bound">txs</a> <a id="1093" href="Ledger.Conway.Epoch.html#747" class="Bound">abs</a>




<a id="1101" class="Keyword">record</a> <a id="EpochState"></a><a id="1108" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a> <a id="1119" class="Symbol">:</a> <a id="1121" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1126" class="Keyword">where</a>


  <a id="1136" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1148" href="Ledger.Conway.Epoch.html#1148" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>


  <a id="1166" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1176" href="Ledger.Conway.Epoch.html#1176" class="Field">acnt</a>       <a id="1187" class="Symbol">:</a> <a id="1189" href="Ledger.Conway.PParams.html#709" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1198" href="Ledger.Conway.Epoch.html#1198" class="Field">ss</a>         <a id="1209" class="Symbol">:</a> <a id="1211" href="Ledger.Conway.Rewards.html#6717" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1225" href="Ledger.Conway.Epoch.html#1225" class="Field">ls</a>         <a id="1236" class="Symbol">:</a> <a id="1238" href="Ledger.Conway.Ledger.html#865" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1249" href="Ledger.Conway.Epoch.html#1249" class="Field">es</a>         <a id="1260" class="Symbol">:</a> <a id="1262" href="Ledger.Conway.Enact.html#418" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="1277" href="Ledger.Conway.Epoch.html#1277" class="Field">fut</a>        <a id="1288" class="Symbol">:</a> <a id="1290" href="Ledger.Conway.Ratify.html#3314" class="Record">RatifyState</a>



<a id="1305" class="Keyword">record</a> <a id="HasEpochState"></a><a id="1312" href="Ledger.Conway.Epoch.html#1312" class="Record">HasEpochState</a> <a id="1326" class="Symbol">{</a><a id="1327" href="Ledger.Conway.Epoch.html#1327" class="Bound">a</a><a id="1328" class="Symbol">}</a> <a id="1330" class="Symbol">(</a><a id="1331" href="Ledger.Conway.Epoch.html#1331" class="Bound">A</a> <a id="1333" class="Symbol">:</a> <a id="1335" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1340" href="Ledger.Conway.Epoch.html#1327" class="Bound">a</a><a id="1341" class="Symbol">)</a> <a id="1343" class="Symbol">:</a> <a id="1345" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1350" href="Ledger.Conway.Epoch.html#1327" class="Bound">a</a> <a id="1352" class="Keyword">where</a>
  <a id="1360" class="Keyword">field</a> <a id="HasEpochState.EpochStateOf"></a><a id="1366" href="Ledger.Conway.Epoch.html#1366" class="Field">EpochStateOf</a> <a id="1379" class="Symbol">:</a> <a id="1381" href="Ledger.Conway.Epoch.html#1331" class="Bound">A</a> <a id="1383" class="Symbol">→</a> <a id="1385" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>
<a id="1396" class="Keyword">open</a> <a id="1401" href="Ledger.Conway.Epoch.html#1312" class="Module">HasEpochState</a> <a id="1415" class="Symbol">⦃...⦄</a> <a id="1421" class="Keyword">public</a>

<a id="1429" class="Keyword">instance</a>
  <a id="HasLState-EpochState"></a><a id="1440" href="Ledger.Conway.Epoch.html#1440" class="Function">HasLState-EpochState</a> <a id="1461" class="Symbol">:</a> <a id="1463" href="Ledger.Conway.Ledger.html#1010" class="Record">HasLState</a> <a id="1473" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>
  <a id="1486" href="Ledger.Conway.Epoch.html#1440" class="Function">HasLState-EpochState</a> <a id="1507" class="Symbol">.</a><a id="1508" href="Ledger.Conway.Ledger.html#1060" class="Field">LStateOf</a> <a id="1517" class="Symbol">=</a> <a id="1519" href="Ledger.Conway.Epoch.html#1225" class="Field">EpochState.ls</a>

  <a id="HasEnactState-EpochState"></a><a id="1536" href="Ledger.Conway.Epoch.html#1536" class="Function">HasEnactState-EpochState</a> <a id="1561" class="Symbol">:</a> <a id="1563" href="Ledger.Conway.Enact.html#710" class="Record">HasEnactState</a> <a id="1577" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>
  <a id="1590" href="Ledger.Conway.Epoch.html#1536" class="Function">HasEnactState-EpochState</a> <a id="1615" class="Symbol">.</a><a id="1616" href="Ledger.Conway.Enact.html#764" class="Field">EnactStateOf</a> <a id="1629" class="Symbol">=</a> <a id="1631" href="Ledger.Conway.Epoch.html#1249" class="Field">EpochState.es</a>

  <a id="HasDeposits-EpochState"></a><a id="1648" href="Ledger.Conway.Epoch.html#1648" class="Function">HasDeposits-EpochState</a> <a id="1671" class="Symbol">:</a> <a id="1673" href="Ledger.Conway.Certs.html#705" class="Record">HasDeposits</a> <a id="1685" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>
  <a id="1698" href="Ledger.Conway.Epoch.html#1648" class="Function">HasDeposits-EpochState</a> <a id="1721" class="Symbol">.</a><a id="1722" href="Ledger.Conway.Certs.html#757" class="Field">DepositsOf</a> <a id="1733" class="Symbol">=</a> <a id="1735" href="Ledger.Conway.Certs.html#757" class="Field">DepositsOf</a> <a id="1746" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1748" href="Ledger.Conway.Ledger.html#1060" class="Field">LStateOf</a>

  <a id="Hastreasury-EpochState"></a><a id="1760" href="Ledger.Conway.Epoch.html#1760" class="Function">Hastreasury-EpochState</a> <a id="1783" class="Symbol">:</a> <a id="1785" href="Ledger.Conway.PParams.html#797" class="Record">Hastreasury</a> <a id="1797" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>
  <a id="1810" href="Ledger.Conway.Epoch.html#1760" class="Function">Hastreasury-EpochState</a> <a id="1833" class="Symbol">.</a><a id="1834" href="Ledger.Conway.PParams.html#849" class="Field">treasuryOf</a> <a id="1845" class="Symbol">=</a> <a id="1847" href="Ledger.Conway.PParams.html#764" class="Field">Acnt.treasury</a> <a id="1861" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1863" href="Ledger.Conway.Epoch.html#1176" class="Field">EpochState.acnt</a>



<a id="1882" class="Keyword">record</a> <a id="NewEpochState"></a><a id="1889" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a> <a id="1903" class="Symbol">:</a> <a id="1905" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1910" class="Keyword">where</a>
  <a id="1918" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="1928" href="Ledger.Conway.Epoch.html#1928" class="Field">lastEpoch</a>   <a id="1940" class="Symbol">:</a> <a id="1942" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a>
    <a id="NewEpochState.epochState"></a><a id="1952" href="Ledger.Conway.Epoch.html#1952" class="Field">epochState</a>  <a id="1964" class="Symbol">:</a> <a id="1966" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="1981" href="Ledger.Conway.Epoch.html#1981" class="Field">ru</a>          <a id="1993" class="Symbol">:</a> <a id="1995" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2001" href="Ledger.Conway.Rewards.html#5871" class="Record">RewardUpdate</a>


<a id="2016" class="Keyword">record</a> <a id="HasNewEpochState"></a><a id="2023" href="Ledger.Conway.Epoch.html#2023" class="Record">HasNewEpochState</a> <a id="2040" class="Symbol">{</a><a id="2041" href="Ledger.Conway.Epoch.html#2041" class="Bound">a</a><a id="2042" class="Symbol">}</a> <a id="2044" class="Symbol">(</a><a id="2045" href="Ledger.Conway.Epoch.html#2045" class="Bound">A</a> <a id="2047" class="Symbol">:</a> <a id="2049" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2054" href="Ledger.Conway.Epoch.html#2041" class="Bound">a</a><a id="2055" class="Symbol">)</a> <a id="2057" class="Symbol">:</a> <a id="2059" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2064" href="Ledger.Conway.Epoch.html#2041" class="Bound">a</a> <a id="2066" class="Keyword">where</a>
  <a id="2074" class="Keyword">field</a> <a id="HasNewEpochState.NewEpochStateOf"></a><a id="2080" href="Ledger.Conway.Epoch.html#2080" class="Field">NewEpochStateOf</a> <a id="2096" class="Symbol">:</a> <a id="2098" href="Ledger.Conway.Epoch.html#2045" class="Bound">A</a> <a id="2100" class="Symbol">→</a> <a id="2102" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
<a id="2116" class="Keyword">open</a> <a id="2121" href="Ledger.Conway.Epoch.html#2023" class="Module">HasNewEpochState</a> <a id="2138" class="Symbol">⦃...⦄</a> <a id="2144" class="Keyword">public</a>
<a id="2151" class="Keyword">record</a> <a id="HasLastEpoch"></a><a id="2158" href="Ledger.Conway.Epoch.html#2158" class="Record">HasLastEpoch</a>     <a id="2175" class="Symbol">{</a><a id="2176" href="Ledger.Conway.Epoch.html#2176" class="Bound">a</a><a id="2177" class="Symbol">}</a> <a id="2179" class="Symbol">(</a><a id="2180" href="Ledger.Conway.Epoch.html#2180" class="Bound">A</a> <a id="2182" class="Symbol">:</a> <a id="2184" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2189" href="Ledger.Conway.Epoch.html#2176" class="Bound">a</a><a id="2190" class="Symbol">)</a> <a id="2192" class="Symbol">:</a> <a id="2194" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2199" href="Ledger.Conway.Epoch.html#2176" class="Bound">a</a> <a id="2201" class="Keyword">where</a> <a id="2207" class="Keyword">field</a> <a id="HasLastEpoch.LastEpochOf"></a><a id="2213" href="Ledger.Conway.Epoch.html#2213" class="Field">LastEpochOf</a>     <a id="2229" class="Symbol">:</a> <a id="2231" href="Ledger.Conway.Epoch.html#2180" class="Bound">A</a> <a id="2233" class="Symbol">→</a> <a id="2235" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a>
<a id="2241" class="Keyword">open</a> <a id="2246" href="Ledger.Conway.Epoch.html#2158" class="Module">HasLastEpoch</a>     <a id="2263" class="Symbol">⦃...⦄</a> <a id="2269" class="Keyword">public</a>

<a id="2277" class="Keyword">instance</a>
  <a id="HasLastEpoch-NewEpochState"></a><a id="2288" href="Ledger.Conway.Epoch.html#2288" class="Function">HasLastEpoch-NewEpochState</a> <a id="2315" class="Symbol">:</a> <a id="2317" href="Ledger.Conway.Epoch.html#2158" class="Record">HasLastEpoch</a> <a id="2330" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
  <a id="2346" href="Ledger.Conway.Epoch.html#2288" class="Function">HasLastEpoch-NewEpochState</a> <a id="2373" class="Symbol">.</a><a id="2374" href="Ledger.Conway.Epoch.html#2213" class="Field">LastEpochOf</a> <a id="2386" class="Symbol">=</a> <a id="2388" href="Ledger.Conway.Epoch.html#1928" class="Field">NewEpochState.lastEpoch</a>

  <a id="HasEpochState-NewEpochState"></a><a id="2415" href="Ledger.Conway.Epoch.html#2415" class="Function">HasEpochState-NewEpochState</a> <a id="2443" class="Symbol">:</a> <a id="2445" href="Ledger.Conway.Epoch.html#1312" class="Record">HasEpochState</a> <a id="2459" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
  <a id="2475" href="Ledger.Conway.Epoch.html#2415" class="Function">HasEpochState-NewEpochState</a> <a id="2503" class="Symbol">.</a><a id="2504" href="Ledger.Conway.Epoch.html#1366" class="Field">EpochStateOf</a> <a id="2517" class="Symbol">=</a> <a id="2519" href="Ledger.Conway.Epoch.html#1952" class="Field">NewEpochState.epochState</a>

  <a id="Hastreasury-NewEpochState"></a><a id="2547" href="Ledger.Conway.Epoch.html#2547" class="Function">Hastreasury-NewEpochState</a> <a id="2573" class="Symbol">:</a> <a id="2575" href="Ledger.Conway.PParams.html#797" class="Record">Hastreasury</a> <a id="2587" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
  <a id="2603" href="Ledger.Conway.Epoch.html#2547" class="Function">Hastreasury-NewEpochState</a> <a id="2629" class="Symbol">.</a><a id="2630" href="Ledger.Conway.PParams.html#849" class="Field">treasuryOf</a> <a id="2641" class="Symbol">=</a> <a id="2643" href="Ledger.Conway.PParams.html#849" class="Field">treasuryOf</a> <a id="2654" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2656" href="Ledger.Conway.Epoch.html#1366" class="Field">EpochStateOf</a>

  <a id="HasLState-NewEpochState"></a><a id="2672" href="Ledger.Conway.Epoch.html#2672" class="Function">HasLState-NewEpochState</a> <a id="2696" class="Symbol">:</a> <a id="2698" href="Ledger.Conway.Ledger.html#1010" class="Record">HasLState</a> <a id="2708" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
  <a id="2724" href="Ledger.Conway.Epoch.html#2672" class="Function">HasLState-NewEpochState</a> <a id="2748" class="Symbol">.</a><a id="2749" href="Ledger.Conway.Ledger.html#1060" class="Field">LStateOf</a> <a id="2758" class="Symbol">=</a> <a id="2760" href="Ledger.Conway.Ledger.html#1060" class="Field">LStateOf</a> <a id="2769" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2771" href="Ledger.Conway.Epoch.html#1366" class="Field">EpochStateOf</a>

  <a id="HasGovState-NewEpochState"></a><a id="2787" href="Ledger.Conway.Epoch.html#2787" class="Function">HasGovState-NewEpochState</a> <a id="2813" class="Symbol">:</a> <a id="2815" href="Ledger.Conway.Gov.html#1471" class="Record">HasGovState</a> <a id="2827" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
  <a id="2843" href="Ledger.Conway.Epoch.html#2787" class="Function">HasGovState-NewEpochState</a> <a id="2869" class="Symbol">.</a><a id="2870" href="Ledger.Conway.Gov.html#1523" class="Field">GovStateOf</a> <a id="2881" class="Symbol">=</a> <a id="2883" href="Ledger.Conway.Gov.html#1523" class="Field">GovStateOf</a> <a id="2894" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2896" href="Ledger.Conway.Ledger.html#1060" class="Field">LStateOf</a>

  <a id="HasCertState-NewEpochState"></a><a id="2908" href="Ledger.Conway.Epoch.html#2908" class="Function">HasCertState-NewEpochState</a> <a id="2935" class="Symbol">:</a> <a id="2937" href="Ledger.Conway.Certs.html#4483" class="Record">HasCertState</a> <a id="2950" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
  <a id="2966" href="Ledger.Conway.Epoch.html#2908" class="Function">HasCertState-NewEpochState</a> <a id="2993" class="Symbol">.</a><a id="2994" href="Ledger.Conway.Certs.html#4536" class="Field">CertStateOf</a> <a id="3006" class="Symbol">=</a> <a id="3008" href="Ledger.Conway.Certs.html#4536" class="Field">CertStateOf</a> <a id="3020" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3022" href="Ledger.Conway.Ledger.html#1060" class="Field">LStateOf</a>

  <a id="HasDReps-NewEpochState"></a><a id="3034" href="Ledger.Conway.Epoch.html#3034" class="Function">HasDReps-NewEpochState</a> <a id="3057" class="Symbol">:</a> <a id="3059" href="Ledger.Conway.Certs.html#934" class="Record">HasDReps</a> <a id="3068" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a> 
  <a id="3085" href="Ledger.Conway.Epoch.html#3034" class="Function">HasDReps-NewEpochState</a> <a id="3108" class="Symbol">.</a><a id="3109" href="Ledger.Conway.Certs.html#983" class="Field">DRepsOf</a> <a id="3117" class="Symbol">=</a> <a id="3119" href="Ledger.Conway.Certs.html#983" class="Field">DRepsOf</a> <a id="3127" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3129" href="Ledger.Conway.Certs.html#4536" class="Field">CertStateOf</a>

  <a id="HasRewards-NewEpochState"></a><a id="3144" href="Ledger.Conway.Epoch.html#3144" class="Function">HasRewards-NewEpochState</a> <a id="3169" class="Symbol">:</a> <a id="3171" href="Ledger.Conway.Certs.html#821" class="Record">HasRewards</a> <a id="3182" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
  <a id="3198" href="Ledger.Conway.Epoch.html#3144" class="Function">HasRewards-NewEpochState</a> <a id="3223" class="Symbol">.</a><a id="3224" href="Ledger.Conway.Certs.html#872" class="Field">RewardsOf</a> <a id="3234" class="Symbol">=</a> <a id="3236" href="Ledger.Conway.Certs.html#872" class="Field">RewardsOf</a> <a id="3246" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3248" href="Ledger.Conway.Certs.html#4536" class="Field">CertStateOf</a>

  <a id="3263" class="Keyword">unquoteDecl</a> <a id="HasCast-RewardUpdate"></a><a id="3275" href="Ledger.Conway.Epoch.html#3275" class="Function">HasCast-RewardUpdate</a> <a id="HasCast-EpochState"></a><a id="3296" href="Ledger.Conway.Epoch.html#3296" class="Function">HasCast-EpochState</a> <a id="HasCast-NewEpochState"></a><a id="3315" href="Ledger.Conway.Epoch.html#3315" class="Function">HasCast-NewEpochState</a> <a id="3337" class="Symbol">=</a> <a id="3339" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="3358" class="Symbol">(</a>   <a id="3362" class="Symbol">(</a><a id="3363" class="Keyword">quote</a> <a id="3369" href="Ledger.Conway.Rewards.html#5871" class="Record">RewardUpdate</a>   <a id="3384" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3386" href="Ledger.Conway.Epoch.html#3275" class="Function">HasCast-RewardUpdate</a><a id="3406" class="Symbol">)</a>
    <a id="3412" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="3416" class="Symbol">(</a><a id="3417" class="Keyword">quote</a> <a id="3423" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>     <a id="3438" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3440" href="Ledger.Conway.Epoch.html#3296" class="Function">HasCast-EpochState</a><a id="3458" class="Symbol">)</a>
    <a id="3464" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3466" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="3468" class="Symbol">(</a><a id="3469" class="Keyword">quote</a> <a id="3475" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>  <a id="3490" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3492" href="Ledger.Conway.Epoch.html#3315" class="Function">HasCast-NewEpochState</a><a id="3513" class="Symbol">)</a><a id="3514" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="3515" class="Symbol">)</a>

<a id="3518" class="Keyword">instance</a> <a id="3527" href="Ledger.Conway.Epoch.html#3527" class="Function">_</a> <a id="3529" class="Symbol">=</a> <a id="3531" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="3541" class="Symbol">;</a> <a id="3543" href="Ledger.Conway.Epoch.html#3543" class="Function">_</a> <a id="3545" class="Symbol">=</a> <a id="3547" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>

<a id="toRwdAddr"></a><a id="3570" href="Ledger.Conway.Epoch.html#3570" class="Function">toRwdAddr</a> <a id="3580" class="Symbol">:</a> <a id="3582" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="3593" class="Symbol">→</a> <a id="3595" href="Ledger.Conway.Address.html#1344" class="Record">RwdAddr</a>
<a id="3603" href="Ledger.Conway.Epoch.html#3570" class="Function">toRwdAddr</a> <a id="3613" href="Ledger.Conway.Epoch.html#3613" class="Bound">x</a> <a id="3615" class="Symbol">=</a> <a id="3617" class="Keyword">record</a> <a id="3624" class="Symbol">{</a> <a id="3626" href="Ledger.Conway.Address.html#1373" class="Field">net</a> <a id="3630" class="Symbol">=</a> <a id="3632" href="Ledger.Conway.Types.Epoch.html#2317" class="Function">NetworkId</a> <a id="3642" class="Symbol">;</a> <a id="3644" href="Ledger.Conway.Address.html#1398" class="Field">stake</a> <a id="3650" class="Symbol">=</a> <a id="3652" href="Ledger.Conway.Epoch.html#3613" class="Bound">x</a> <a id="3654" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="3657" href="Ledger.Conway.Epoch.html#3657" class="Function">getStakeCred</a> <a id="3670" class="Symbol">:</a> <a id="3672" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a> <a id="3678" class="Symbol">→</a> <a id="3680" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3686" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a>
<a id="3697" href="Ledger.Conway.Epoch.html#3657" class="Function">getStakeCred</a> <a id="3710" class="Symbol">(</a><a id="3711" href="Ledger.Conway.Epoch.html#3711" class="Bound">a</a> <a id="3713" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3715" class="Symbol">_</a> <a id="3717" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3719" class="Symbol">_</a> <a id="3721" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3723" class="Symbol">_)</a> <a id="3726" class="Symbol">=</a> <a id="3728" href="Ledger.Conway.Address.html#2516" class="Function">stakeCred</a> <a id="3738" href="Ledger.Conway.Epoch.html#3711" class="Bound">a</a>

<a id="3741" class="Keyword">open</a> <a id="3746" href="Ledger.Conway.GovernanceActions.html#2760" class="Module">GovActionState</a> <a id="3761" class="Keyword">using</a> <a id="3767" class="Symbol">(</a><a id="3768" href="Ledger.Conway.GovernanceActions.html#2831" class="Field">returnAddr</a><a id="3778" class="Symbol">)</a>



<a id="createRUpd"></a><a id="3783" href="Ledger.Conway.Epoch.html#3783" class="Function">createRUpd</a> <a id="3794" class="Symbol">:</a> <a id="3796" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3798" class="Symbol">→</a> <a id="3800" href="Ledger.Conway.Rewards.html#4588" class="Function">BlocksMade</a> <a id="3811" class="Symbol">→</a> <a id="3813" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a> <a id="3824" class="Symbol">→</a> <a id="3826" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="3831" class="Symbol">→</a> <a id="3833" href="Ledger.Conway.Rewards.html#5871" class="Record">RewardUpdate</a>
<a id="3846" href="Ledger.Conway.Epoch.html#3783" class="Function">createRUpd</a> <a id="3857" href="Ledger.Conway.Epoch.html#3857" class="Bound">slotsPerEpoch</a> <a id="3871" href="Ledger.Conway.Epoch.html#3871" class="Bound">b</a> <a id="3873" href="Ledger.Conway.Epoch.html#3873" class="Bound">es</a> <a id="3876" href="Ledger.Conway.Epoch.html#3876" class="Bound">total</a>
  <a id="3884" class="Symbol">=</a> <a id="3886" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="3888" href="Ledger.Conway.Epoch.html#4591" class="Function">Δt₁</a> <a id="3892" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3894" class="Number">0</a> <a id="3896" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="3898" href="Ledger.Conway.Epoch.html#4450" class="Function">Δr₁</a> <a id="3902" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="3904" href="Ledger.Conway.Epoch.html#4764" class="Function">Δr₂</a> <a id="3908" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3910" class="Number">0</a> <a id="3912" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="3914" href="Ledger.Conway.Epoch.html#4090" class="Function">feeSS</a> <a id="3920" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3922" href="Ledger.Conway.Epoch.html#4701" class="Function">rs</a> <a id="3925" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>
  <a id="3929" class="Keyword">where</a>
    <a id="3939" href="Ledger.Conway.Epoch.html#3939" class="Function">prevPp</a>      <a id="3951" class="Symbol">=</a> <a id="3953" href="Ledger.Conway.PParams.html#3459" class="Field">PParamsOf</a> <a id="3963" class="Symbol">(</a><a id="3964" href="Ledger.Conway.Epoch.html#3873" class="Bound">es</a> <a id="3967" class="Symbol">.</a><a id="3968" href="Ledger.Conway.Epoch.html#1249" class="Field">EpochState.es</a><a id="3981" class="Symbol">)</a>
    <a id="3987" href="Ledger.Conway.Epoch.html#3987" class="Function">reserves</a>    <a id="3999" class="Symbol">=</a> <a id="4001" href="Ledger.Conway.Epoch.html#3873" class="Bound">es</a> <a id="4004" class="Symbol">.</a><a id="4005" href="Ledger.Conway.Epoch.html#1176" class="Field">EpochState.acnt</a> <a id="4021" class="Symbol">.</a><a id="4022" href="Ledger.Conway.PParams.html#773" class="Field">Acnt.reserves</a>
    <a id="4040" href="Ledger.Conway.Epoch.html#4040" class="Function">pstakego</a>    <a id="4052" class="Symbol">=</a> <a id="4054" href="Ledger.Conway.Epoch.html#3873" class="Bound">es</a> <a id="4057" class="Symbol">.</a><a id="4058" href="Ledger.Conway.Epoch.html#1198" class="Field">EpochState.ss</a> <a id="4072" class="Symbol">.</a><a id="4073" href="Ledger.Conway.Rewards.html#6760" class="Field">Snapshots.go</a>
    <a id="4090" href="Ledger.Conway.Epoch.html#4090" class="Function">feeSS</a>       <a id="4102" class="Symbol">=</a> <a id="4104" href="Ledger.Conway.Epoch.html#3873" class="Bound">es</a> <a id="4107" class="Symbol">.</a><a id="4108" href="Ledger.Conway.Epoch.html#1198" class="Field">EpochState.ss</a> <a id="4122" class="Symbol">.</a><a id="4123" href="Ledger.Conway.Rewards.html#6779" class="Field">Snapshots.feeSS</a>
    <a id="4143" href="Ledger.Conway.Epoch.html#4143" class="Function">stake</a>       <a id="4155" class="Symbol">=</a> <a id="4157" href="Ledger.Conway.Epoch.html#4040" class="Function">pstakego</a> <a id="4166" class="Symbol">.</a><a id="4167" href="Ledger.Conway.Rewards.html#6020" class="Field">Snapshot.stake</a>
    <a id="4186" href="Ledger.Conway.Epoch.html#4186" class="Function">delegs</a>      <a id="4198" class="Symbol">=</a> <a id="4200" href="Ledger.Conway.Epoch.html#4040" class="Function">pstakego</a> <a id="4209" class="Symbol">.</a><a id="4210" href="Ledger.Conway.Rewards.html#6060" class="Field">Snapshot.delegations</a>
    <a id="4235" href="Ledger.Conway.Epoch.html#4235" class="Function">poolParams</a>  <a id="4247" class="Symbol">=</a> <a id="4249" href="Ledger.Conway.Epoch.html#4040" class="Function">pstakego</a> <a id="4258" class="Symbol">.</a><a id="4259" href="Ledger.Conway.Rewards.html#6103" class="Field">Snapshot.poolParameters</a>

    <a id="4288" href="Ledger.Conway.Epoch.html#4288" class="Function">blocksMade</a> <a id="4299" class="Symbol">=</a> <a id="4301" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="4304" href="Ledger.Conway.Epoch.html#4304" class="Bound">m</a> <a id="4306" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="4308" href="Ledger.Conway.Epoch.html#3871" class="Bound">b</a> <a id="4310" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="4312" href="Ledger.Conway.Epoch.html#4304" class="Bound">m</a>

    <a id="4319" href="Ledger.Conway.Epoch.html#4319" class="Function">rho</a> <a id="4323" class="Symbol">=</a> <a id="4325" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2341" class="Function">fromUnitInterval</a> <a id="4342" class="Symbol">(</a><a id="4343" href="Ledger.Conway.Epoch.html#3939" class="Function">prevPp</a> <a id="4350" class="Symbol">.</a><a id="4351" href="Ledger.Conway.PParams.html#2201" class="Field">PParams.monetaryExpansion</a><a id="4376" class="Symbol">)</a>
    <a id="4382" href="Ledger.Conway.Epoch.html#4382" class="Function">η</a> <a id="4384" class="Symbol">=</a> <a id="4386" href="Ledger.Conway.Epoch.html#665" class="Function">fromℕ</a> <a id="4392" href="Ledger.Conway.Epoch.html#4288" class="Function">blocksMade</a> <a id="4403" href="Ledger.Prelude.html#2305" class="Function Operator">÷₀</a> <a id="4406" class="Symbol">(</a><a id="4407" href="Ledger.Conway.Epoch.html#665" class="Function">fromℕ</a> <a id="4413" href="Ledger.Conway.Epoch.html#3857" class="Bound">slotsPerEpoch</a> <a id="4427" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="4429" href="Ledger.Conway.Types.Epoch.html#2180" class="Function">ActiveSlotCoeff</a><a id="4444" class="Symbol">)</a>
    <a id="4450" href="Ledger.Conway.Epoch.html#4450" class="Function">Δr₁</a> <a id="4454" class="Symbol">=</a> <a id="4456" href="Data.Rational.Base.html#7116" class="Function">floor</a> <a id="4462" class="Symbol">(</a><a id="4463" href="Ledger.Conway.Epoch.html#377" class="Function">ℚ.min</a> <a id="4469" class="Number">1</a> <a id="4471" href="Ledger.Conway.Epoch.html#4382" class="Function">η</a> <a id="4473" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="4475" href="Ledger.Conway.Epoch.html#4319" class="Function">rho</a> <a id="4479" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="4481" href="Ledger.Conway.Epoch.html#665" class="Function">fromℕ</a> <a id="4487" href="Ledger.Conway.Epoch.html#3987" class="Function">reserves</a><a id="4495" class="Symbol">)</a>

    <a id="4502" href="Ledger.Conway.Epoch.html#4502" class="Function">rewardPot</a> <a id="4512" class="Symbol">=</a> <a id="4514" href="Ledger.Conway.Epoch.html#150" class="InductiveConstructor">pos</a> <a id="4518" href="Ledger.Conway.Epoch.html#4090" class="Function">feeSS</a> <a id="4524" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="4526" href="Ledger.Conway.Epoch.html#4450" class="Function">Δr₁</a>
    <a id="4534" href="Ledger.Conway.Epoch.html#4534" class="Function">tau</a> <a id="4538" class="Symbol">=</a> <a id="4540" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2341" class="Function">fromUnitInterval</a> <a id="4557" class="Symbol">(</a><a id="4558" href="Ledger.Conway.Epoch.html#3939" class="Function">prevPp</a> <a id="4565" class="Symbol">.</a><a id="4566" href="Ledger.Conway.PParams.html#2271" class="Field">PParams.treasuryCut</a><a id="4585" class="Symbol">)</a>
    <a id="4591" href="Ledger.Conway.Epoch.html#4591" class="Function">Δt₁</a> <a id="4595" class="Symbol">=</a> <a id="4597" href="Data.Rational.Base.html#7116" class="Function">floor</a> <a id="4603" class="Symbol">(</a><a id="4604" href="Ledger.Conway.Epoch.html#4534" class="Function">tau</a> <a id="4608" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="4610" href="Data.Rational.Literals.html#613" class="Function">fromℤ</a> <a id="4616" href="Ledger.Conway.Epoch.html#4502" class="Function">rewardPot</a><a id="4625" class="Symbol">)</a>
    <a id="4631" href="Ledger.Conway.Epoch.html#4631" class="Function">R</a> <a id="4633" class="Symbol">=</a> <a id="4635" href="Prelude.html#3167" class="Function">posPart</a> <a id="4643" class="Symbol">(</a><a id="4644" href="Ledger.Conway.Epoch.html#4502" class="Function">rewardPot</a> <a id="4654" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="4656" href="Ledger.Conway.Epoch.html#4591" class="Function">Δt₁</a><a id="4659" class="Symbol">)</a>
    <a id="4665" href="Ledger.Conway.Epoch.html#4665" class="Function">circulation</a> <a id="4677" class="Symbol">=</a> <a id="4679" href="Ledger.Conway.Epoch.html#3876" class="Bound">total</a> <a id="4685" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="4687" href="Ledger.Conway.Epoch.html#3987" class="Function">reserves</a>

    <a id="4701" href="Ledger.Conway.Epoch.html#4701" class="Function">rs</a> <a id="4704" class="Symbol">=</a> <a id="4706" href="Ledger.Conway.Rewards.html#5062" class="Function">reward</a> <a id="4713" href="Ledger.Conway.Epoch.html#3939" class="Function">prevPp</a> <a id="4720" href="Ledger.Conway.Epoch.html#3871" class="Bound">b</a> <a id="4722" href="Ledger.Conway.Epoch.html#4631" class="Function">R</a> <a id="4724" href="Ledger.Conway.Epoch.html#4235" class="Function">poolParams</a> <a id="4735" href="Ledger.Conway.Epoch.html#4143" class="Function">stake</a> <a id="4741" href="Ledger.Conway.Epoch.html#4186" class="Function">delegs</a> <a id="4748" href="Ledger.Conway.Epoch.html#4665" class="Function">circulation</a>
    <a id="4764" href="Ledger.Conway.Epoch.html#4764" class="Function">Δr₂</a> <a id="4768" class="Symbol">=</a> <a id="4770" href="Ledger.Conway.Epoch.html#4631" class="Function">R</a> <a id="4772" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="4774" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="4777" href="Ledger.Conway.Epoch.html#4777" class="Bound">c</a> <a id="4779" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="4781" href="Ledger.Conway.Epoch.html#4701" class="Function">rs</a> <a id="4784" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="4786" href="Ledger.Conway.Epoch.html#4777" class="Bound">c</a>



<a id="applyRUpd"></a><a id="4791" href="Ledger.Conway.Epoch.html#4791" class="Function">applyRUpd</a> <a id="4801" class="Symbol">:</a> <a id="4803" href="Ledger.Conway.Rewards.html#5871" class="Record">RewardUpdate</a> <a id="4816" class="Symbol">→</a> <a id="4818" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a> <a id="4829" class="Symbol">→</a> <a id="4831" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>
<a id="4842" href="Ledger.Conway.Epoch.html#4791" class="Function">applyRUpd</a> <a id="4852" href="Ledger.Conway.Rewards.html#5912" class="InductiveConstructor Operator">⟦</a> <a id="4854" href="Ledger.Conway.Epoch.html#4854" class="Bound">Δt</a> <a id="4857" href="Ledger.Conway.Rewards.html#5912" class="InductiveConstructor Operator">,</a> <a id="4859" href="Ledger.Conway.Epoch.html#4859" class="Bound">Δr</a> <a id="4862" href="Ledger.Conway.Rewards.html#5912" class="InductiveConstructor Operator">,</a> <a id="4864" href="Ledger.Conway.Epoch.html#4864" class="Bound">Δf</a> <a id="4867" href="Ledger.Conway.Rewards.html#5912" class="InductiveConstructor Operator">,</a> <a id="4869" href="Ledger.Conway.Epoch.html#4869" class="Bound">rs</a> <a id="4872" href="Ledger.Conway.Rewards.html#5912" class="InductiveConstructor Operator">⟧ʳᵘ</a>
  <a id="4878" href="Ledger.Conway.Epoch.html#1148" class="InductiveConstructor Operator">⟦</a> <a id="4880" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">⟦</a> <a id="4882" href="Ledger.Conway.Epoch.html#4882" class="Bound">treasury</a> <a id="4891" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">,</a> <a id="4893" href="Ledger.Conway.Epoch.html#4893" class="Bound">reserves</a> <a id="4902" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">⟧ᵃ</a>
  <a id="4907" href="Ledger.Conway.Epoch.html#1148" class="InductiveConstructor Operator">,</a> <a id="4909" href="Ledger.Conway.Epoch.html#4909" class="Bound">ss</a>
  <a id="4914" href="Ledger.Conway.Epoch.html#1148" class="InductiveConstructor Operator">,</a> <a id="4916" href="Ledger.Conway.Ledger.html#901" class="InductiveConstructor Operator">⟦</a> <a id="4918" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">⟦</a> <a id="4920" href="Ledger.Conway.Epoch.html#4920" class="Bound">utxo</a> <a id="4925" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="4927" href="Ledger.Conway.Epoch.html#4927" class="Bound">fees</a> <a id="4932" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="4934" href="Ledger.Conway.Epoch.html#4934" class="Bound">deposits</a> <a id="4943" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="4945" href="Ledger.Conway.Epoch.html#4945" class="Bound">donations</a> <a id="4955" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">⟧ᵘ</a>
    <a id="4962" href="Ledger.Conway.Ledger.html#901" class="InductiveConstructor Operator">,</a> <a id="4964" href="Ledger.Conway.Epoch.html#4964" class="Bound">govSt</a>
    <a id="4974" href="Ledger.Conway.Ledger.html#901" class="InductiveConstructor Operator">,</a> <a id="4976" href="Ledger.Conway.Certs.html#4394" class="InductiveConstructor Operator">⟦</a> <a id="4978" href="Ledger.Conway.Certs.html#3235" class="InductiveConstructor Operator">⟦</a> <a id="4980" href="Ledger.Conway.Epoch.html#4980" class="Bound">voteDelegs</a> <a id="4991" href="Ledger.Conway.Certs.html#3235" class="InductiveConstructor Operator">,</a> <a id="4993" href="Ledger.Conway.Epoch.html#4993" class="Bound">stakeDelegs</a> <a id="5005" href="Ledger.Conway.Certs.html#3235" class="InductiveConstructor Operator">,</a> <a id="5007" href="Ledger.Conway.Epoch.html#5007" class="Bound">rewards</a> <a id="5015" href="Ledger.Conway.Certs.html#3235" class="InductiveConstructor Operator">⟧ᵈ</a> <a id="5018" href="Ledger.Conway.Certs.html#4394" class="InductiveConstructor Operator">,</a> <a id="5020" href="Ledger.Conway.Epoch.html#5020" class="Bound">pState</a> <a id="5027" href="Ledger.Conway.Certs.html#4394" class="InductiveConstructor Operator">,</a> <a id="5029" href="Ledger.Conway.Epoch.html#5029" class="Bound">gState</a> <a id="5036" href="Ledger.Conway.Certs.html#4394" class="InductiveConstructor Operator">⟧ᶜˢ</a> <a id="5040" href="Ledger.Conway.Ledger.html#901" class="InductiveConstructor Operator">⟧ˡ</a>
  <a id="5045" href="Ledger.Conway.Epoch.html#1148" class="InductiveConstructor Operator">,</a> <a id="5047" href="Ledger.Conway.Epoch.html#5047" class="Bound">es</a>
  <a id="5052" href="Ledger.Conway.Epoch.html#1148" class="InductiveConstructor Operator">,</a> <a id="5054" href="Ledger.Conway.Epoch.html#5054" class="Bound">fut</a>
  <a id="5060" href="Ledger.Conway.Epoch.html#1148" class="InductiveConstructor Operator">⟧ᵉ&#39;</a> <a id="5064" class="Symbol">=</a>
  <a id="5068" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5070" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5072" href="Prelude.html#3167" class="Function">posPart</a> <a id="5080" class="Symbol">(</a><a id="5081" href="Ledger.Conway.Epoch.html#150" class="InductiveConstructor">pos</a> <a id="5085" href="Ledger.Conway.Epoch.html#4882" class="Bound">treasury</a> <a id="5094" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5096" href="Ledger.Conway.Epoch.html#4854" class="Bound">Δt</a> <a id="5099" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5101" href="Ledger.Conway.Epoch.html#150" class="InductiveConstructor">pos</a> <a id="5105" href="Ledger.Conway.Epoch.html#5409" class="Function">unregRU&#39;</a><a id="5113" class="Symbol">)</a>
    <a id="5119" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5121" href="Prelude.html#3167" class="Function">posPart</a> <a id="5129" class="Symbol">(</a><a id="5130" href="Ledger.Conway.Epoch.html#150" class="InductiveConstructor">pos</a> <a id="5134" href="Ledger.Conway.Epoch.html#4893" class="Bound">reserves</a> <a id="5143" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5145" href="Ledger.Conway.Epoch.html#4859" class="Bound">Δr</a><a id="5147" class="Symbol">)</a> <a id="5149" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>
  <a id="5153" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5155" href="Ledger.Conway.Epoch.html#4909" class="Bound">ss</a>
  <a id="5160" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5162" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5164" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5166" href="Ledger.Conway.Epoch.html#4920" class="Bound">utxo</a> <a id="5171" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5173" href="Prelude.html#3167" class="Function">posPart</a> <a id="5181" class="Symbol">(</a><a id="5182" href="Ledger.Conway.Epoch.html#150" class="InductiveConstructor">pos</a> <a id="5186" href="Ledger.Conway.Epoch.html#4927" class="Bound">fees</a> <a id="5191" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5193" href="Ledger.Conway.Epoch.html#4864" class="Bound">Δf</a><a id="5195" class="Symbol">)</a> <a id="5197" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5199" href="Ledger.Conway.Epoch.html#4934" class="Bound">deposits</a> <a id="5208" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5210" href="Ledger.Conway.Epoch.html#4945" class="Bound">donations</a> <a id="5220" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>
    <a id="5226" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5228" href="Ledger.Conway.Epoch.html#4964" class="Bound">govSt</a>
    <a id="5238" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5240" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5242" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5244" href="Ledger.Conway.Epoch.html#4980" class="Bound">voteDelegs</a> <a id="5255" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5257" href="Ledger.Conway.Epoch.html#4993" class="Bound">stakeDelegs</a> <a id="5269" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5271" href="Ledger.Conway.Epoch.html#5007" class="Bound">rewards</a> <a id="5279" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="5282" href="Ledger.Conway.Epoch.html#5341" class="Function">regRU</a> <a id="5288" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="5290" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5292" href="Ledger.Conway.Epoch.html#5020" class="Bound">pState</a> <a id="5299" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5301" href="Ledger.Conway.Epoch.html#5029" class="Bound">gState</a> <a id="5308" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="5310" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>
  <a id="5314" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5316" href="Ledger.Conway.Epoch.html#5047" class="Bound">es</a>
  <a id="5321" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5323" href="Ledger.Conway.Epoch.html#5054" class="Bound">fut</a> <a id="5327" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>
  <a id="5331" class="Keyword">where</a>
    <a id="5341" href="Ledger.Conway.Epoch.html#5341" class="Function">regRU</a>     <a id="5351" class="Symbol">=</a> <a id="5353" href="Ledger.Conway.Epoch.html#4869" class="Bound">rs</a> <a id="5356" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="5358" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5362" href="Ledger.Conway.Epoch.html#5007" class="Bound">rewards</a>
    <a id="5374" href="Ledger.Conway.Epoch.html#5374" class="Function">unregRU</a>   <a id="5384" class="Symbol">=</a> <a id="5386" href="Ledger.Conway.Epoch.html#4869" class="Bound">rs</a> <a id="5389" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="5391" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5395" href="Ledger.Conway.Epoch.html#5007" class="Bound">rewards</a> <a id="5403" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a>
    <a id="5409" href="Ledger.Conway.Epoch.html#5409" class="Function">unregRU&#39;</a>  <a id="5419" class="Symbol">=</a> <a id="5421" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="5424" href="Ledger.Conway.Epoch.html#5424" class="Bound">x</a> <a id="5426" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="5428" href="Ledger.Conway.Epoch.html#5374" class="Function">unregRU</a> <a id="5436" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="5438" href="Ledger.Conway.Epoch.html#5424" class="Bound">x</a>

<a id="getOrphans"></a><a id="5441" href="Ledger.Conway.Epoch.html#5441" class="Function">getOrphans</a> <a id="5452" class="Symbol">:</a> <a id="5454" href="Ledger.Conway.Enact.html#418" class="Record">EnactState</a> <a id="5465" class="Symbol">→</a> <a id="5467" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a> <a id="5476" class="Symbol">→</a> <a id="5478" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a>
<a id="5487" href="Ledger.Conway.Epoch.html#5441" class="Function">getOrphans</a> <a id="5498" href="Ledger.Conway.Epoch.html#5498" class="Bound">es</a> <a id="5501" href="Ledger.Conway.Epoch.html#5501" class="Bound">govSt</a> <a id="5507" class="Symbol">=</a> <a id="5509" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5515" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5517" href="Data.Nat.GeneralisedArithmetic.html#866" class="Function">iterate</a> <a id="5525" href="Ledger.Conway.Epoch.html#5570" class="Function">step</a> <a id="5530" class="Symbol">(</a><a id="5531" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5534" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5536" href="Ledger.Conway.Epoch.html#5501" class="Bound">govSt</a><a id="5541" class="Symbol">)</a> <a id="5543" class="Symbol">(</a><a id="5544" href="Data.List.Base.html#5044" class="Function">length</a> <a id="5551" href="Ledger.Conway.Epoch.html#5501" class="Bound">govSt</a><a id="5556" class="Symbol">)</a>
  <a id="5560" class="Keyword">where</a>
    <a id="5570" href="Ledger.Conway.Epoch.html#5570" class="Function">step</a> <a id="5575" class="Symbol">:</a> <a id="5577" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a> <a id="5586" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5588" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a> <a id="5597" class="Symbol">→</a> <a id="5599" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a> <a id="5608" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5610" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a>
    <a id="5623" href="Ledger.Conway.Epoch.html#5570" class="Function">step</a> <a id="5628" class="Symbol">(</a><a id="5629" href="Ledger.Conway.Epoch.html#5629" class="Bound">orps</a> <a id="5634" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5636" href="Ledger.Conway.Epoch.html#5636" class="Bound">govSt</a><a id="5641" class="Symbol">)</a> <a id="5643" class="Symbol">=</a>
      <a id="5651" class="Keyword">let</a>
        <a id="5663" href="Ledger.Conway.Epoch.html#5663" class="Bound">isOrphan?</a> <a id="5673" href="Ledger.Conway.Epoch.html#5673" class="Bound">a</a> <a id="5675" href="Ledger.Conway.Epoch.html#5675" class="Bound">prev</a> <a id="5680" class="Symbol">=</a> <a id="5682" href="Relation.Nullary.Decidable.Core.html#3011" class="Function">¬?</a> <a id="5685" class="Symbol">(</a><a id="5686" href="Ledger.Conway.Gov.html#8737" class="Function">hasParent?</a> <a id="5697" href="Ledger.Conway.Epoch.html#5498" class="Bound">es</a> <a id="5700" href="Ledger.Conway.Epoch.html#5636" class="Bound">govSt</a> <a id="5706" href="Ledger.Conway.Epoch.html#5673" class="Bound">a</a> <a id="5708" href="Ledger.Conway.Epoch.html#5675" class="Bound">prev</a><a id="5712" class="Symbol">)</a>
        <a id="5722" class="Symbol">(</a><a id="5723" href="Ledger.Conway.Epoch.html#5723" class="Bound">orps&#39;</a> <a id="5729" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5731" href="Ledger.Conway.Epoch.html#5731" class="Bound">govSt&#39;</a><a id="5737" class="Symbol">)</a> <a id="5739" class="Symbol">=</a> <a id="5741" href="Data.List.Base.html#10926" class="Function">partition</a>
          <a id="5761" class="Symbol">(λ</a> <a id="5764" class="Symbol">(_</a> <a id="5767" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5769" class="Keyword">record</a> <a id="5776" class="Symbol">{</a><a id="5777" href="Ledger.Conway.GovernanceActions.html#2881" class="Field">action</a> <a id="5784" class="Symbol">=</a> <a id="5786" href="Ledger.Conway.Epoch.html#5786" class="Bound">a</a> <a id="5788" class="Symbol">;</a> <a id="5790" href="Ledger.Conway.GovernanceActions.html#2909" class="Field">prevAction</a> <a id="5801" class="Symbol">=</a> <a id="5803" href="Ledger.Conway.Epoch.html#5803" class="Bound">prev</a><a id="5807" class="Symbol">})</a> <a id="5810" class="Symbol">→</a> <a id="5812" href="Ledger.Conway.Epoch.html#5663" class="Bound">isOrphan?</a> <a id="5822" class="Symbol">(</a><a id="5823" href="Ledger.Conway.Epoch.html#5786" class="Bound">a</a> <a id="5825" class="Symbol">.</a><a id="5826" href="Ledger.Conway.GovernanceActions.html#1447" class="Field">gaType</a><a id="5832" class="Symbol">)</a> <a id="5834" href="Ledger.Conway.Epoch.html#5803" class="Bound">prev</a><a id="5838" class="Symbol">)</a> <a id="5840" href="Ledger.Conway.Epoch.html#5636" class="Bound">govSt</a>
      <a id="5852" class="Keyword">in</a>
        <a id="5863" class="Symbol">(</a><a id="5864" href="Ledger.Conway.Epoch.html#5629" class="Bound">orps</a> <a id="5869" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="5872" href="Ledger.Conway.Epoch.html#5723" class="Bound">orps&#39;</a> <a id="5878" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5880" href="Ledger.Conway.Epoch.html#5731" class="Bound">govSt&#39;</a><a id="5886" class="Symbol">)</a>


<a id="5890" class="Keyword">open</a> <a id="5895" href="Ledger.Conway.Address.html#1344" class="Module">RwdAddr</a> <a id="5903" class="Keyword">using</a> <a id="5909" class="Symbol">(</a><a id="5910" href="Ledger.Conway.Address.html#1398" class="Field">stake</a><a id="5915" class="Symbol">)</a>


<a id="gaDepositStake"></a><a id="5919" href="Ledger.Conway.Epoch.html#5919" class="Function">gaDepositStake</a> <a id="5934" class="Symbol">:</a> <a id="5936" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a> <a id="5945" class="Symbol">→</a> <a id="5947" href="Ledger.Conway.Certs.html#601" class="Function">Deposits</a> <a id="5956" class="Symbol">→</a> <a id="5958" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="5969" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="5971" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="5976" href="Ledger.Conway.Epoch.html#5919" class="Function">gaDepositStake</a> <a id="5991" href="Ledger.Conway.Epoch.html#5991" class="Bound">govSt</a> <a id="5997" href="Ledger.Conway.Epoch.html#5997" class="Bound">ds</a> <a id="6000" class="Symbol">=</a> <a id="6002" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a>
  <a id="6016" class="Symbol">(</a><a id="6017" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="6022" class="Symbol">(λ</a> <a id="6025" class="Symbol">(</a><a id="6026" href="Ledger.Conway.Epoch.html#6026" class="Bound">gaid</a> <a id="6031" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6033" href="Ledger.Conway.Epoch.html#6033" class="Bound">addr</a><a id="6037" class="Symbol">)</a> <a id="6039" class="Symbol">→</a> <a id="6041" class="Symbol">(</a><a id="6042" href="Ledger.Conway.Epoch.html#6026" class="Bound">gaid</a> <a id="6047" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6049" href="Ledger.Conway.Epoch.html#6033" class="Bound">addr</a><a id="6053" class="Symbol">)</a> <a id="6055" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6057" href="Ledger.Conway.Address.html#1398" class="Field">stake</a> <a id="6063" href="Ledger.Conway.Epoch.html#6033" class="Bound">addr</a><a id="6067" class="Symbol">)</a> <a id="6069" href="Ledger.Conway.Epoch.html#6167" class="Function">govSt&#39;</a><a id="6075" class="Symbol">)</a>
  <a id="6079" class="Symbol">(</a><a id="6080" href="Axiom.Set.Map.html#10460" class="Function">mapFromPartialFun</a> <a id="6098" class="Symbol">(λ</a> <a id="6101" class="Symbol">(</a><a id="6102" href="Ledger.Conway.Epoch.html#6102" class="Bound">gaid</a> <a id="6107" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6109" class="Symbol">_)</a> <a id="6112" class="Symbol">→</a> <a id="6114" href="Axiom.Set.Map.html#13670" class="Function">lookupᵐ?</a> <a id="6123" href="Ledger.Conway.Epoch.html#5997" class="Bound">ds</a> <a id="6126" class="Symbol">(</a><a id="6127" href="Ledger.Conway.Certs.html#549" class="InductiveConstructor">GovActionDeposit</a> <a id="6144" href="Ledger.Conway.Epoch.html#6102" class="Bound">gaid</a><a id="6148" class="Symbol">))</a> <a id="6151" href="Ledger.Conway.Epoch.html#6167" class="Function">govSt&#39;</a><a id="6157" class="Symbol">)</a>
  <a id="6161" class="Keyword">where</a> <a id="6167" href="Ledger.Conway.Epoch.html#6167" class="Function">govSt&#39;</a> <a id="6174" class="Symbol">=</a> <a id="6176" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="6181" class="Symbol">(</a><a id="6182" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="6187" href="Ledger.Conway.GovernanceActions.html#2831" class="Field">returnAddr</a><a id="6197" class="Symbol">)</a> <a id="6199" class="Symbol">(</a><a id="6200" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="6209" href="Ledger.Conway.Epoch.html#5991" class="Bound">govSt</a><a id="6214" class="Symbol">)</a>



<a id="6219" class="Keyword">opaque</a>


  <a id="mkStakeDistrs"></a><a id="6230" href="Ledger.Conway.Epoch.html#6230" class="Function">mkStakeDistrs</a> <a id="6244" class="Symbol">:</a> <a id="6246" href="Ledger.Conway.Rewards.html#5987" class="Record">Snapshot</a> <a id="6255" class="Symbol">→</a> <a id="6257" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a> <a id="6266" class="Symbol">→</a> <a id="6268" href="Ledger.Conway.Certs.html#601" class="Function">Deposits</a> <a id="6277" class="Symbol">→</a> <a id="6279" class="Symbol">(</a><a id="6280" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="6291" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="6293" href="Ledger.Conway.GovernanceActions.html#472" class="Datatype">VDeleg</a><a id="6299" class="Symbol">)</a> <a id="6301" class="Symbol">→</a> <a id="6303" href="Ledger.Conway.Ratify.html#2949" class="Record">StakeDistrs</a>
  <a id="6317" href="Ledger.Conway.Epoch.html#6230" class="Function">mkStakeDistrs</a> <a id="6331" href="Ledger.Conway.Epoch.html#6331" class="Bound">ss</a> <a id="6334" href="Ledger.Conway.Epoch.html#6334" class="Bound">govSt</a> <a id="6340" href="Ledger.Conway.Epoch.html#6340" class="Bound">ds</a> <a id="6343" href="Ledger.Conway.Epoch.html#6343" class="Bound">delegations</a> <a id="6355" class="Symbol">.</a><a id="6356" href="Ledger.Conway.Ratify.html#2986" class="Field">StakeDistrs.stakeDistr</a> <a id="6379" class="Symbol">=</a>
    <a id="6385" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a> <a id="6397" href="Ledger.Prelude.html#2543" class="Function Operator">∣</a> <a id="6399" href="Ledger.Conway.Epoch.html#6343" class="Bound">delegations</a> <a id="6411" href="Ledger.Prelude.html#2543" class="Function Operator">∣</a> <a id="6413" class="Symbol">(</a><a id="6414" href="Ledger.Conway.Rewards.html#6020" class="Field">Snapshot.stake</a> <a id="6429" href="Ledger.Conway.Epoch.html#6331" class="Bound">ss</a> <a id="6432" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="6435" href="Ledger.Conway.Epoch.html#5919" class="Function">gaDepositStake</a> <a id="6450" href="Ledger.Conway.Epoch.html#6334" class="Bound">govSt</a> <a id="6456" href="Ledger.Conway.Epoch.html#6340" class="Bound">ds</a><a id="6458" class="Symbol">)</a>


<a id="6462" class="Keyword">private</a> <a id="6470" class="Keyword">variable</a>
  <a id="6481" href="Ledger.Conway.Epoch.html#6481" class="Generalizable">nes</a> <a id="6485" href="Ledger.Conway.Epoch.html#6485" class="Generalizable">nes&#39;</a> <a id="6490" class="Symbol">:</a> <a id="6492" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a>
  <a id="6508" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="6510" href="Ledger.Conway.Epoch.html#6510" class="Generalizable">lastEpoch</a> <a id="6520" class="Symbol">:</a> <a id="6522" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a>
  <a id="6530" href="Ledger.Conway.Epoch.html#6530" class="Generalizable">fut</a> <a id="6534" href="Ledger.Conway.Epoch.html#6534" class="Generalizable">fut&#39;</a> <a id="6539" class="Symbol">:</a> <a id="6541" href="Ledger.Conway.Ratify.html#3314" class="Record">RatifyState</a>
  <a id="6555" href="Ledger.Conway.Epoch.html#6555" class="Generalizable">eps</a> <a id="6559" href="Ledger.Conway.Epoch.html#6559" class="Generalizable">eps&#39;</a> <a id="6564" href="Ledger.Conway.Epoch.html#6564" class="Generalizable">eps&#39;&#39;</a> <a id="6570" class="Symbol">:</a> <a id="6572" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a>
  <a id="6585" href="Ledger.Conway.Epoch.html#6585" class="Generalizable">ls</a> <a id="6588" class="Symbol">:</a> <a id="6590" href="Ledger.Conway.Ledger.html#865" class="Record">LState</a>
  <a id="6599" href="Ledger.Conway.Epoch.html#6599" class="Generalizable">acnt</a> <a id="6604" class="Symbol">:</a> <a id="6606" href="Ledger.Conway.PParams.html#709" class="Record">Acnt</a>
  <a id="6613" href="Ledger.Conway.Epoch.html#6613" class="Generalizable">es₀</a> <a id="6617" class="Symbol">:</a> <a id="6619" href="Ledger.Conway.Enact.html#418" class="Record">EnactState</a>
  <a id="6632" href="Ledger.Conway.Epoch.html#6632" class="Generalizable">mark</a> <a id="6637" href="Ledger.Conway.Epoch.html#6637" class="Generalizable">set</a> <a id="6641" href="Ledger.Conway.Epoch.html#6641" class="Generalizable">go</a> <a id="6644" class="Symbol">:</a> <a id="6646" href="Ledger.Conway.Rewards.html#5987" class="Record">Snapshot</a>
  <a id="6657" href="Ledger.Conway.Epoch.html#6657" class="Generalizable">feeSS</a> <a id="6663" class="Symbol">:</a> <a id="6665" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="6672" href="Ledger.Conway.Epoch.html#6672" class="Generalizable">lstate</a> <a id="6679" class="Symbol">:</a> <a id="6681" href="Ledger.Conway.Ledger.html#865" class="Record">LState</a>
  <a id="6690" href="Ledger.Conway.Epoch.html#6690" class="Generalizable">ss</a> <a id="6693" href="Ledger.Conway.Epoch.html#6693" class="Generalizable">ss&#39;</a> <a id="6697" class="Symbol">:</a> <a id="6699" href="Ledger.Conway.Rewards.html#6717" class="Record">Snapshots</a>
  <a id="6711" href="Ledger.Conway.Epoch.html#6711" class="Generalizable">ru</a> <a id="6714" class="Symbol">:</a> <a id="6716" href="Ledger.Conway.Rewards.html#5871" class="Record">RewardUpdate</a>
  <a id="6731" href="Ledger.Conway.Epoch.html#6731" class="Generalizable">mru</a> <a id="6735" class="Symbol">:</a> <a id="6737" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6743" href="Ledger.Conway.Rewards.html#5871" class="Record">RewardUpdate</a>


<a id="6758" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="6763" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="6778" class="Symbol">:</a> <a id="6780" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="6782" class="Symbol">→</a> <a id="6784" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a> <a id="6795" class="Symbol">→</a> <a id="6797" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a> <a id="6803" class="Symbol">→</a> <a id="6805" href="Ledger.Conway.Epoch.html#1108" class="Record">EpochState</a> <a id="6816" class="Symbol">→</a> <a id="6818" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="6823" class="Keyword">where</a>


  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="6833" href="Ledger.Conway.Epoch.html#6833" class="InductiveConstructor">EPOCH</a> <a id="6839" class="Symbol">:</a> <a id="6841" class="Keyword">let</a>


      <a id="6853" class="Keyword">open</a> <a id="6858" href="Ledger.Conway.Ledger.html#865" class="Module">LState</a> <a id="6865" href="Ledger.Conway.Epoch.html#6585" class="Generalizable">ls</a>
      <a id="6874" class="Keyword">open</a> <a id="6879" href="Ledger.Conway.Certs.html#4355" class="Module">CertState</a> <a id="6889" href="Ledger.Conway.Ledger.html#977" class="Function">certState</a>
      <a id="6905" class="Keyword">open</a> <a id="6910" href="Ledger.Conway.Ratify.html#3314" class="Module">RatifyState</a> <a id="6922" href="Ledger.Conway.Epoch.html#6530" class="Generalizable">fut</a> <a id="6926" class="Keyword">hiding</a> <a id="6933" class="Symbol">(</a><a id="6934" href="Ledger.Conway.Ratify.html#3351" class="Field">es</a><a id="6936" class="Symbol">)</a>
      <a id="6944" class="Keyword">open</a> <a id="6949" href="Ledger.Conway.Utxo.html#2747" class="Module">UTxOState</a>
      <a id="6965" class="Keyword">open</a> <a id="6970" href="Ledger.Conway.Certs.html#3809" class="Module">PState</a><a id="6976" class="Symbol">;</a> <a id="6978" class="Keyword">open</a> <a id="6983" href="Ledger.Conway.Certs.html#3199" class="Module">DState</a><a id="6989" class="Symbol">;</a> <a id="6991" class="Keyword">open</a> <a id="6996" href="Ledger.Conway.Certs.html#4025" class="Module">GState</a>
      <a id="7009" class="Keyword">open</a> <a id="7014" href="Ledger.Conway.PParams.html#709" class="Module">Acnt</a><a id="7018" class="Symbol">;</a> <a id="7020" class="Keyword">open</a> <a id="7025" href="Ledger.Conway.Enact.html#418" class="Module">EnactState</a><a id="7035" class="Symbol">;</a> <a id="7037" class="Keyword">open</a> <a id="7042" href="Ledger.Conway.GovernanceActions.html#2760" class="Module">GovActionState</a>


      <a id="7065" href="Ledger.Conway.Epoch.html#7065" class="Bound">esW</a>               <a id="7083" class="Symbol">=</a> <a id="7085" href="Ledger.Conway.Ratify.html#3351" class="Field">RatifyState.es</a> <a id="7100" href="Ledger.Conway.Epoch.html#6530" class="Generalizable">fut</a>
      <a id="7110" href="Ledger.Conway.Epoch.html#7110" class="Bound">es</a>                <a id="7128" class="Symbol">=</a> <a id="7130" class="Keyword">record</a> <a id="7137" href="Ledger.Conway.Epoch.html#7065" class="Bound">esW</a> <a id="7141" class="Symbol">{</a> <a id="7143" href="Ledger.Conway.Enact.html#670" class="Field">withdrawals</a> <a id="7155" class="Symbol">=</a> <a id="7157" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="7159" class="Symbol">}</a>
      <a id="7167" href="Ledger.Conway.Epoch.html#7167" class="Bound">tmpGovSt</a>          <a id="7185" class="Symbol">=</a> <a id="7187" href="Ledger.Prelude.html#2692" class="Function">filter</a> <a id="7194" class="Symbol">(λ</a> <a id="7197" href="Ledger.Conway.Epoch.html#7197" class="Bound">x</a> <a id="7199" class="Symbol">→</a> <a id="7201" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7207" href="Ledger.Conway.Epoch.html#7197" class="Bound">x</a> <a id="7209" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="7211" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="7216" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7222" href="Ledger.Conway.Ratify.html#3384" class="Function">removed</a><a id="7229" class="Symbol">)</a> <a id="7231" href="Ledger.Conway.Ledger.html#951" class="Function">govSt</a>
      <a id="7243" href="Ledger.Conway.Epoch.html#7243" class="Bound">orphans</a>           <a id="7261" class="Symbol">=</a> <a id="7263" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="7272" class="Symbol">(</a><a id="7273" href="Ledger.Conway.Epoch.html#5441" class="Function">getOrphans</a> <a id="7284" href="Ledger.Conway.Epoch.html#7110" class="Bound">es</a> <a id="7287" href="Ledger.Conway.Epoch.html#7167" class="Bound">tmpGovSt</a><a id="7295" class="Symbol">)</a>
      <a id="7303" href="Ledger.Conway.Epoch.html#7303" class="Bound">removed&#39;</a>          <a id="7321" class="Symbol">=</a> <a id="7323" href="Ledger.Conway.Ratify.html#3384" class="Function">removed</a> <a id="7331" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="7333" href="Ledger.Conway.Epoch.html#7243" class="Bound">orphans</a>
      <a id="7347" href="Ledger.Conway.Epoch.html#7347" class="Bound">removedGovActions</a> <a id="7365" class="Symbol">=</a> <a id="7367" href="Function.Base.html#1638" class="Function">flip</a> <a id="7372" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a> <a id="7383" href="Ledger.Conway.Epoch.html#7303" class="Bound">removed&#39;</a> <a id="7392" class="Symbol">λ</a> <a id="7394" class="Symbol">(</a><a id="7395" href="Ledger.Conway.Epoch.html#7395" class="Bound">gaid</a> <a id="7400" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7402" href="Ledger.Conway.Epoch.html#7402" class="Bound">gaSt</a><a id="7406" class="Symbol">)</a> <a id="7408" class="Symbol">→</a>
        <a id="7418" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="7423" class="Symbol">(</a><a id="7424" href="Ledger.Conway.GovernanceActions.html#2831" class="Field">returnAddr</a> <a id="7435" href="Ledger.Conway.Epoch.html#7402" class="Bound">gaSt</a> <a id="7440" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="7442" class="Symbol">)</a> <a id="7444" class="Symbol">((</a><a id="7446" href="Ledger.Conway.Ledger.html#924" class="Function">utxoSt</a> <a id="7453" class="Symbol">.</a><a id="7454" href="Ledger.Conway.Utxo.html#2855" class="Field">deposits</a> <a id="7463" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="7465" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="7467" href="Ledger.Conway.Certs.html#549" class="InductiveConstructor">GovActionDeposit</a> <a id="7484" href="Ledger.Conway.Epoch.html#7395" class="Bound">gaid</a> <a id="7489" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="7490" class="Symbol">)</a> <a id="7492" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="7493" class="Symbol">)</a>
      <a id="7501" href="Ledger.Conway.Epoch.html#7501" class="Bound">govActionReturns</a> <a id="7518" class="Symbol">=</a> <a id="7520" href="Axiom.Set.Map.Dec.html#1932" class="Function">aggregate₊</a> <a id="7531" class="Symbol">(</a><a id="7532" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="7537" class="Symbol">(λ</a> <a id="7540" class="Symbol">(</a><a id="7541" href="Ledger.Conway.Epoch.html#7541" class="Bound">a</a> <a id="7543" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7545" class="Symbol">_</a> <a id="7547" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7549" href="Ledger.Conway.Epoch.html#7549" class="Bound">d</a><a id="7550" class="Symbol">)</a> <a id="7552" class="Symbol">→</a> <a id="7554" href="Ledger.Conway.Epoch.html#7541" class="Bound">a</a> <a id="7556" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7558" href="Ledger.Conway.Epoch.html#7549" class="Bound">d</a><a id="7559" class="Symbol">)</a> <a id="7561" href="Ledger.Conway.Epoch.html#7347" class="Bound">removedGovActions</a> <a id="7579" href="abstract-set-theory.FiniteSetTheory.html#2767" class="Function Operator">ᶠˢ</a><a id="7581" class="Symbol">)</a>

      <a id="7590" href="Ledger.Conway.Epoch.html#7590" class="Bound">trWithdrawals</a>   <a id="7606" class="Symbol">=</a> <a id="7608" href="Ledger.Conway.Epoch.html#7065" class="Bound">esW</a> <a id="7612" class="Symbol">.</a><a id="7613" href="Ledger.Conway.Enact.html#670" class="Field">withdrawals</a>
      <a id="7631" href="Ledger.Conway.Epoch.html#7631" class="Bound">totWithdrawals</a>  <a id="7647" class="Symbol">=</a> <a id="7649" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="7652" href="Ledger.Conway.Epoch.html#7652" class="Bound">x</a> <a id="7654" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="7656" href="Ledger.Conway.Epoch.html#7590" class="Bound">trWithdrawals</a> <a id="7670" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="7672" href="Ledger.Conway.Epoch.html#7652" class="Bound">x</a>

      <a id="7681" href="Ledger.Conway.Epoch.html#7681" class="Bound">retired</a>    <a id="7692" class="Symbol">=</a> <a id="7694" class="Symbol">(</a><a id="7695" href="Ledger.Conway.Certs.html#4438" class="Function">pState</a> <a id="7702" class="Symbol">.</a><a id="7703" href="Ledger.Conway.Certs.html#3878" class="Field">retiring</a><a id="7711" class="Symbol">)</a> <a id="7713" href="Axiom.Set.Map.html#14230" class="Function Operator">⁻¹</a> <a id="7716" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a>
      <a id="7724" href="Ledger.Conway.Epoch.html#7724" class="Bound">payout</a>     <a id="7735" class="Symbol">=</a> <a id="7737" href="Ledger.Conway.Epoch.html#7501" class="Bound">govActionReturns</a> <a id="7754" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="7757" href="Ledger.Conway.Epoch.html#7590" class="Bound">trWithdrawals</a>
      <a id="7777" href="Ledger.Conway.Epoch.html#7777" class="Bound">refunds</a>    <a id="7788" class="Symbol">=</a> <a id="7790" href="Axiom.Set.Map.html#13791" class="Function">pullbackMap</a> <a id="7802" href="Ledger.Conway.Epoch.html#7724" class="Bound">payout</a> <a id="7809" href="Ledger.Conway.Epoch.html#3570" class="Function">toRwdAddr</a> <a id="7819" class="Symbol">(</a><a id="7820" href="Class.IsSet.html#916" class="Function">dom</a> <a id="7824" class="Symbol">(</a><a id="7825" href="Ledger.Conway.Certs.html#4418" class="Function">dState</a> <a id="7832" class="Symbol">.</a><a id="7833" href="Ledger.Conway.Certs.html#3337" class="Field">rewards</a><a id="7840" class="Symbol">))</a>
      <a id="7849" href="Ledger.Conway.Epoch.html#7849" class="Bound">unclaimed</a>  <a id="7860" class="Symbol">=</a> <a id="7862" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="7870" href="Ledger.Conway.Epoch.html#7724" class="Bound">payout</a> <a id="7877" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="7879" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="7887" href="Ledger.Conway.Epoch.html#7777" class="Bound">refunds</a>

      <a id="7902" href="Ledger.Conway.Epoch.html#7902" class="Bound">govSt&#39;</a> <a id="7909" class="Symbol">=</a> <a id="7911" href="Ledger.Prelude.html#2692" class="Function">filter</a> <a id="7918" class="Symbol">(λ</a> <a id="7921" href="Ledger.Conway.Epoch.html#7921" class="Bound">x</a> <a id="7923" class="Symbol">→</a> <a id="7925" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7931" href="Ledger.Conway.Epoch.html#7921" class="Bound">x</a> <a id="7933" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="7935" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="7940" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7946" href="Ledger.Conway.Epoch.html#7303" class="Bound">removed&#39;</a><a id="7954" class="Symbol">)</a> <a id="7956" href="Ledger.Conway.Ledger.html#951" class="Function">govSt</a>

      <a id="7969" href="Ledger.Conway.Epoch.html#7969" class="Bound">dState&#39;</a> <a id="7977" class="Symbol">=</a> <a id="7979" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="7981" href="Ledger.Conway.Certs.html#4418" class="Function">dState</a> <a id="7988" class="Symbol">.</a><a id="7989" href="Ledger.Conway.Certs.html#3258" class="Field">voteDelegs</a> <a id="8000" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8002" href="Ledger.Conway.Certs.html#4418" class="Function">dState</a> <a id="8009" class="Symbol">.</a><a id="8010" href="Ledger.Conway.Certs.html#3297" class="Field">stakeDelegs</a> <a id="8022" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a>  <a id="8025" href="Ledger.Conway.Certs.html#4418" class="Function">dState</a> <a id="8032" class="Symbol">.</a><a id="8033" href="Ledger.Conway.Certs.html#3337" class="Field">rewards</a> <a id="8041" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="8044" href="Ledger.Conway.Epoch.html#7777" class="Bound">refunds</a> <a id="8052" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

      <a id="8061" href="Ledger.Conway.Epoch.html#8061" class="Bound">pState&#39;</a> <a id="8069" class="Symbol">=</a> <a id="8071" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="8073" href="Ledger.Conway.Certs.html#4438" class="Function">pState</a> <a id="8080" class="Symbol">.</a><a id="8081" href="Ledger.Conway.Certs.html#3841" class="Field">pools</a> <a id="8087" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="8089" href="Ledger.Conway.Epoch.html#7681" class="Bound">retired</a> <a id="8097" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="8099" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8101" href="Ledger.Conway.Certs.html#4438" class="Function">pState</a> <a id="8108" class="Symbol">.</a><a id="8109" href="Ledger.Conway.Certs.html#3878" class="Field">retiring</a> <a id="8118" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="8120" href="Ledger.Conway.Epoch.html#7681" class="Bound">retired</a> <a id="8128" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="8130" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

      <a id="8139" href="Ledger.Conway.Epoch.html#8139" class="Bound">gState&#39;</a> <a id="8147" class="Symbol">=</a> <a id="8149" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="8151" class="Symbol">(</a><a id="8152" href="Class.ToBool.html#389" class="Function Operator">if</a> <a id="8155" href="Data.List.Base.html#4703" class="Function">null</a> <a id="8160" href="Ledger.Conway.Epoch.html#7902" class="Bound">govSt&#39;</a> <a id="8167" href="Class.ToBool.html#389" class="Function Operator">then</a> <a id="8172" href="Axiom.Set.Map.html#6068" class="Function">mapValues</a> <a id="8182" class="Symbol">(</a><a id="8183" class="Number">1</a> <a id="8185" href="Class.HasAdd.Core.html#162" class="Field Operator">+_</a><a id="8187" class="Symbol">)</a> <a id="8189" class="Symbol">(</a><a id="8190" href="Ledger.Conway.Certs.html#4458" class="Function">gState</a> <a id="8197" class="Symbol">.</a><a id="8198" href="Ledger.Conway.Certs.html#4082" class="Field">dreps</a><a id="8203" class="Symbol">)</a> <a id="8205" href="Class.ToBool.html#389" class="Function Operator">else</a> <a id="8210" class="Symbol">(</a><a id="8211" href="Ledger.Conway.Certs.html#4458" class="Function">gState</a> <a id="8218" class="Symbol">.</a><a id="8219" href="Ledger.Conway.Certs.html#4082" class="Field">dreps</a><a id="8224" class="Symbol">))</a>
                <a id="8243" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8245" href="Ledger.Conway.Certs.html#4458" class="Function">gState</a> <a id="8252" class="Symbol">.</a><a id="8253" href="Ledger.Conway.Certs.html#4105" class="Field">ccHotKeys</a> <a id="8263" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="8265" href="Ledger.Conway.Enact.html#1215" class="Function">ccCreds</a> <a id="8273" class="Symbol">(</a><a id="8274" href="Ledger.Conway.Epoch.html#7110" class="Bound">es</a> <a id="8277" class="Symbol">.</a><a id="8278" href="Ledger.Conway.Enact.html#454" class="Field">cc</a><a id="8280" class="Symbol">)</a> <a id="8282" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

      <a id="8291" href="Ledger.Conway.Epoch.html#8291" class="Bound">certState&#39;</a> <a id="8302" class="Symbol">:</a> <a id="8304" href="Ledger.Conway.Certs.html#4355" class="Record">CertState</a>
      <a id="8320" href="Ledger.Conway.Epoch.html#8291" class="Bound">certState&#39;</a> <a id="8331" class="Symbol">=</a> <a id="8333" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="8335" href="Ledger.Conway.Epoch.html#7969" class="Bound">dState&#39;</a> <a id="8343" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8345" href="Ledger.Conway.Epoch.html#8061" class="Bound">pState&#39;</a> <a id="8353" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8355" href="Ledger.Conway.Epoch.html#8139" class="Bound">gState&#39;</a> <a id="8363" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

      <a id="8372" href="Ledger.Conway.Epoch.html#8372" class="Bound">utxoSt&#39;</a> <a id="8380" class="Symbol">=</a> <a id="8382" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="8384" href="Ledger.Conway.Ledger.html#924" class="Function">utxoSt</a> <a id="8391" class="Symbol">.</a><a id="8392" href="Ledger.Conway.Utxo.html#2811" class="Field">utxo</a> <a id="8397" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8399" href="Ledger.Conway.Ledger.html#924" class="Function">utxoSt</a> <a id="8406" class="Symbol">.</a><a id="8407" href="Ledger.Conway.Utxo.html#2833" class="Field">fees</a> <a id="8412" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8414" href="Ledger.Conway.Ledger.html#924" class="Function">utxoSt</a> <a id="8421" class="Symbol">.</a><a id="8422" href="Ledger.Conway.Utxo.html#2855" class="Field">deposits</a> <a id="8431" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="8433" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="8438" class="Symbol">(</a><a id="8439" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="8445" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="8447" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="8452" class="Symbol">)</a> <a id="8454" href="Ledger.Conway.Epoch.html#7347" class="Bound">removedGovActions</a> <a id="8472" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="8474" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8476" class="Number">0</a> <a id="8478" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

      <a id="8487" href="Ledger.Conway.Epoch.html#8487" class="Bound">acnt&#39;</a> <a id="8493" class="Symbol">=</a> <a id="8495" class="Keyword">record</a> <a id="8502" href="Ledger.Conway.Epoch.html#6599" class="Generalizable">acnt</a>
        <a id="8515" class="Symbol">{</a> <a id="8517" href="Ledger.Conway.PParams.html#764" class="Field">treasury</a>  <a id="8527" class="Symbol">=</a> <a id="8529" href="Ledger.Conway.Epoch.html#6599" class="Generalizable">acnt</a> <a id="8534" class="Symbol">.</a><a id="8535" href="Ledger.Conway.PParams.html#764" class="Field">treasury</a> <a id="8544" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="8546" href="Ledger.Conway.Epoch.html#7631" class="Bound">totWithdrawals</a> <a id="8561" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="8563" href="Ledger.Conway.Ledger.html#924" class="Function">utxoSt</a> <a id="8570" class="Symbol">.</a><a id="8571" href="Ledger.Conway.Utxo.html#2881" class="Field">donations</a> <a id="8581" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="8583" href="Ledger.Conway.Epoch.html#7849" class="Bound">unclaimed</a> <a id="8593" class="Symbol">}</a>
    <a id="8599" class="Keyword">in</a>
    <a id="8606" class="Keyword">record</a> <a id="8613" class="Symbol">{</a> <a id="8615" href="Ledger.Conway.Ratify.html#3089" class="Field">currentEpoch</a> <a id="8628" class="Symbol">=</a> <a id="8630" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a>
           <a id="8643" class="Symbol">;</a> <a id="8645" href="Ledger.Conway.Ratify.html#3057" class="Field">stakeDistrs</a> <a id="8657" class="Symbol">=</a> <a id="8659" href="Ledger.Conway.Epoch.html#6230" class="Function">mkStakeDistrs</a>  <a id="8674" class="Symbol">(</a><a id="8675" href="Ledger.Conway.Rewards.html#6751" class="Field">Snapshots.mark</a> <a id="8690" href="Ledger.Conway.Epoch.html#6693" class="Generalizable">ss&#39;</a><a id="8693" class="Symbol">)</a> <a id="8695" href="Ledger.Conway.Epoch.html#7902" class="Bound">govSt&#39;</a>
                                          <a id="8744" class="Symbol">(</a><a id="8745" href="Ledger.Conway.Epoch.html#8372" class="Bound">utxoSt&#39;</a> <a id="8753" class="Symbol">.</a><a id="8754" href="Ledger.Conway.Utxo.html#2855" class="Field">deposits</a><a id="8762" class="Symbol">)</a> <a id="8764" class="Symbol">(</a><a id="8765" href="Ledger.Conway.Certs.html#3258" class="Field">voteDelegs</a> <a id="8776" href="Ledger.Conway.Certs.html#4418" class="Function">dState</a><a id="8782" class="Symbol">)</a>
           <a id="8795" class="Symbol">;</a> <a id="8797" href="Ledger.Conway.Ratify.html#3204" class="Field">treasury</a> <a id="8806" class="Symbol">=</a> <a id="8808" href="Ledger.Conway.Epoch.html#6599" class="Generalizable">acnt</a> <a id="8813" class="Symbol">.</a><a id="8814" href="Ledger.Conway.PParams.html#764" class="Field">treasury</a> <a id="8823" class="Symbol">;</a> <a id="8825" href="Ledger.Conway.Epoch.html#8825" class="Module">GState</a> <a id="8832" href="Ledger.Conway.Certs.html#4458" class="Function">gState</a>
           <a id="8850" class="Symbol">;</a> <a id="8852" href="Ledger.Conway.Ratify.html#3229" class="Field">pools</a> <a id="8858" class="Symbol">=</a> <a id="8860" href="Ledger.Conway.Certs.html#4438" class="Function">pState</a> <a id="8867" class="Symbol">.</a><a id="8868" href="Ledger.Conway.Certs.html#3841" class="Field">pools</a> <a id="8874" class="Symbol">;</a> <a id="8876" href="Ledger.Conway.Ratify.html#3270" class="Field">delegatees</a> <a id="8887" class="Symbol">=</a> <a id="8889" href="Ledger.Conway.Certs.html#4418" class="Function">dState</a> <a id="8896" class="Symbol">.</a><a id="8897" href="Ledger.Conway.Certs.html#3258" class="Field">voteDelegs</a> <a id="8908" class="Symbol">}</a>
        <a id="8918" href="Ledger.Conway.Ratify.html#11107" class="Function Operator">⊢</a> <a id="8920" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="8922" href="Ledger.Conway.Epoch.html#7110" class="Bound">es</a> <a id="8925" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8927" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="8929" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8931" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="8937" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="8939" href="Ledger.Conway.Ratify.html#11107" class="Function Operator">⇀⦇</a> <a id="8942" href="Ledger.Conway.Epoch.html#7902" class="Bound">govSt&#39;</a> <a id="8949" href="Ledger.Conway.Ratify.html#11107" class="Function Operator">,RATIFIES⦈</a> <a id="8960" href="Ledger.Conway.Epoch.html#6534" class="Generalizable">fut&#39;</a>
      <a id="8971" class="Symbol">→</a> <a id="8973" href="Ledger.Conway.Epoch.html#6585" class="Generalizable">ls</a> <a id="8976" href="Ledger.Conway.Rewards.html#6990" class="Datatype Operator">⊢</a> <a id="8978" href="Ledger.Conway.Epoch.html#6690" class="Generalizable">ss</a> <a id="8981" href="Ledger.Conway.Rewards.html#6990" class="Datatype Operator">⇀⦇</a> <a id="8984" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="8987" href="Ledger.Conway.Rewards.html#6990" class="Datatype Operator">,SNAP⦈</a> <a id="8994" href="Ledger.Conway.Epoch.html#6693" class="Generalizable">ss&#39;</a>
    <a id="9002" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
    <a id="9039" class="Symbol">_</a> <a id="9041" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">⊢</a> <a id="9043" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9045" href="Ledger.Conway.Epoch.html#6599" class="Generalizable">acnt</a> <a id="9050" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9052" href="Ledger.Conway.Epoch.html#6690" class="Generalizable">ss</a> <a id="9055" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9057" href="Ledger.Conway.Epoch.html#6585" class="Generalizable">ls</a> <a id="9060" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9062" href="Ledger.Conway.Epoch.html#6613" class="Generalizable">es₀</a> <a id="9066" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9068" href="Ledger.Conway.Epoch.html#6530" class="Generalizable">fut</a> <a id="9072" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="9074" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">⇀⦇</a> <a id="9077" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9079" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">,EPOCH⦈</a>
        <a id="9095" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9097" href="Ledger.Conway.Epoch.html#8487" class="Bound">acnt&#39;</a> <a id="9103" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9105" href="Ledger.Conway.Epoch.html#6693" class="Generalizable">ss&#39;</a> <a id="9109" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9111" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9113" href="Ledger.Conway.Epoch.html#8372" class="Bound">utxoSt&#39;</a> <a id="9121" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9123" href="Ledger.Conway.Epoch.html#7902" class="Bound">govSt&#39;</a> <a id="9130" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9132" href="Ledger.Conway.Epoch.html#8291" class="Bound">certState&#39;</a> <a id="9143" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="9145" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9147" href="Ledger.Conway.Epoch.html#7110" class="Bound">es</a> <a id="9150" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9152" href="Ledger.Conway.Epoch.html#6534" class="Generalizable">fut&#39;</a> <a id="9157" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>


<a id="9161" class="Keyword">data</a>


  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="9170" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="9188" class="Symbol">:</a> <a id="9190" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="9192" class="Symbol">→</a> <a id="9194" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a> <a id="9208" class="Symbol">→</a> <a id="9210" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a> <a id="9216" class="Symbol">→</a> <a id="9218" href="Ledger.Conway.Epoch.html#1889" class="Record">NewEpochState</a> <a id="9232" class="Symbol">→</a> <a id="9234" href="Agda.Primitive.html#388" class="Primitive">Type</a>


  <a id="9243" class="Keyword">where</a>


  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="9253" href="Ledger.Conway.Epoch.html#9253" class="InductiveConstructor">NEWEPOCH-New</a> <a id="9266" class="Symbol">:</a> <a id="9268" class="Keyword">let</a>
      <a id="9278" href="Ledger.Conway.Epoch.html#9278" class="Bound">eps&#39;</a> <a id="9283" class="Symbol">=</a> <a id="9285" href="Ledger.Conway.Epoch.html#4791" class="Function">applyRUpd</a> <a id="9295" href="Ledger.Conway.Epoch.html#6711" class="Generalizable">ru</a> <a id="9298" href="Ledger.Conway.Epoch.html#6555" class="Generalizable">eps</a>
    <a id="9306" class="Keyword">in</a>
    <a id="9313" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="9315" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9317" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="9319" href="Ledger.Conway.Epoch.html#6510" class="Generalizable">lastEpoch</a> <a id="9329" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="9331" class="Number">1</a>
    <a id="9337" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">∙</a> <a id="9339" class="Symbol">_</a> <a id="9341" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">⊢</a> <a id="9343" href="Ledger.Conway.Epoch.html#9278" class="Bound">eps&#39;</a> <a id="9348" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">⇀⦇</a> <a id="9351" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9353" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">,EPOCH⦈</a> <a id="9361" href="Ledger.Conway.Epoch.html#6564" class="Generalizable">eps&#39;&#39;</a>
      <a id="9373" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="9412" class="Symbol">_</a> <a id="9414" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">⊢</a> <a id="9416" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9418" href="Ledger.Conway.Epoch.html#6510" class="Generalizable">lastEpoch</a> <a id="9428" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9430" href="Ledger.Conway.Epoch.html#6555" class="Generalizable">eps</a> <a id="9434" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9436" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="9441" href="Ledger.Conway.Epoch.html#6711" class="Generalizable">ru</a> <a id="9444" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="9446" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">⇀⦇</a> <a id="9449" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9451" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="9462" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9464" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9466" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9468" href="Ledger.Conway.Epoch.html#6564" class="Generalizable">eps&#39;&#39;</a> <a id="9474" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9476" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="9484" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="9489" href="Ledger.Conway.Epoch.html#9489" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="9506" class="Symbol">:</a>
    <a id="9512" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="9514" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9516" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="9518" href="Ledger.Conway.Epoch.html#6510" class="Generalizable">lastEpoch</a> <a id="9528" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="9530" class="Number">1</a>
      <a id="9538" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="9577" class="Symbol">_</a> <a id="9579" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">⊢</a> <a id="9581" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9583" href="Ledger.Conway.Epoch.html#6510" class="Generalizable">lastEpoch</a> <a id="9593" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9595" href="Ledger.Conway.Epoch.html#6555" class="Generalizable">eps</a> <a id="9599" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9601" href="Ledger.Conway.Epoch.html#6731" class="Generalizable">mru</a> <a id="9605" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="9607" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">⇀⦇</a> <a id="9610" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9612" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="9623" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9625" href="Ledger.Conway.Epoch.html#6510" class="Generalizable">lastEpoch</a> <a id="9635" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9637" href="Ledger.Conway.Epoch.html#6555" class="Generalizable">eps</a> <a id="9641" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9643" href="Ledger.Conway.Epoch.html#6731" class="Generalizable">mru</a> <a id="9647" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="9652" href="Ledger.Conway.Epoch.html#9652" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="9678" class="Symbol">:</a>
    <a id="9684" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="9686" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9688" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="9690" href="Ledger.Conway.Epoch.html#6510" class="Generalizable">lastEpoch</a> <a id="9700" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="9702" class="Number">1</a>
    <a id="9708" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">∙</a> <a id="9710" class="Symbol">_</a> <a id="9712" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">⊢</a> <a id="9714" href="Ledger.Conway.Epoch.html#6555" class="Generalizable">eps</a> <a id="9718" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">⇀⦇</a> <a id="9721" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9723" href="Ledger.Conway.Epoch.html#6763" class="Datatype Operator">,EPOCH⦈</a> <a id="9731" href="Ledger.Conway.Epoch.html#6559" class="Generalizable">eps&#39;</a>
      <a id="9742" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="9781" class="Symbol">_</a> <a id="9783" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">⊢</a> <a id="9785" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9787" href="Ledger.Conway.Epoch.html#6510" class="Generalizable">lastEpoch</a> <a id="9797" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9799" href="Ledger.Conway.Epoch.html#6555" class="Generalizable">eps</a> <a id="9803" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9805" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="9813" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="9815" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">⇀⦇</a> <a id="9818" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9820" href="Ledger.Conway.Epoch.html#9170" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="9831" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="9833" href="Ledger.Conway.Epoch.html#6508" class="Generalizable">e</a> <a id="9835" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9837" href="Ledger.Conway.Epoch.html#6559" class="Generalizable">eps&#39;</a> <a id="9842" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9844" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="9852" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

</pre></body></html>