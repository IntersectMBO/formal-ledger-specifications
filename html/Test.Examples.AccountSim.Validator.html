<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Test.Examples.AccountSim.Validator</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Comment">-- Validator Simulating Accounts on Cardano based on Agda2hs work</a>

<a id="92" class="Keyword">module</a> <a id="99" href="Test.Examples.AccountSim.Validator.html" class="Module">Test.Examples.AccountSim.Validator</a> <a id="134" class="Keyword">where</a>

<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="168" class="Keyword">renaming</a> <a id="177" class="Symbol">(</a><a id="178" href="Data.Bool.Base.html#1005" class="Function Operator">_∧_</a> <a id="182" class="Symbol">to</a> <a id="185" class="Function Operator">_&amp;&amp;_</a><a id="189" class="Symbol">)</a> <a id="191" class="Keyword">hiding</a> <a id="198" class="Symbol">(</a><a id="199" href="Data.Bool.Base.html#1515" class="Function Operator">if_then_else_</a><a id="212" class="Symbol">)</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.List.html" class="Module">Data.List</a> <a id="236" class="Keyword">using</a> <a id="242" class="Symbol">(</a><a id="243" href="Data.List.Base.html#10389" class="Function">filter</a><a id="249" class="Symbol">)</a>
<a id="251" class="Keyword">open</a> <a id="256" class="Keyword">import</a> <a id="263" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="274" class="Keyword">renaming</a> <a id="283" class="Symbol">(</a><a id="284" href="Data.Maybe.Base.html#1934" class="Function">map</a> <a id="288" class="Symbol">to</a> <a id="291" class="Function">maybeMap</a><a id="299" class="Symbol">)</a>

<a id="302" class="Keyword">open</a> <a id="307" class="Keyword">import</a> <a id="314" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Test.Examples.AccountSim.Datum.html" class="Module">Test.Examples.AccountSim.Datum</a>
<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Test.Prelude.html" class="Module">Test.Prelude</a> <a id="397" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Test.SymbolicData.html" class="Module">Test.SymbolicData</a> <a id="442" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>

<a id="458" class="Keyword">import</a> <a id="465" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="482" class="Symbol">as</a> <a id="485" class="Module">N</a>

<a id="PubKeyHash"></a><a id="488" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="499" class="Symbol">:</a> <a id="501" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="506" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="517" class="Symbol">=</a> <a id="519" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="522" class="Keyword">instance</a>
  <a id="ShowAccountSimData"></a><a id="533" href="Test.Examples.AccountSim.Validator.html#533" class="Function">ShowAccountSimData</a> <a id="552" class="Symbol">:</a> <a id="554" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="559" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>
  <a id="576" href="Test.Examples.AccountSim.Validator.html#533" class="Function">ShowAccountSimData</a> <a id="595" class="Symbol">=</a> <a id="597" href="Class.Show.Core.html#172" class="InductiveConstructor">mkShow</a> <a id="604" class="Symbol">(λ</a> <a id="607" href="Test.Examples.AccountSim.Validator.html#607" class="Bound">x</a> <a id="609" class="Symbol">→</a> <a id="611" class="String">&quot;&quot;</a><a id="613" class="Symbol">)</a>

<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="Test.LedgerImplementation.html" class="Module">Test.LedgerImplementation</a> <a id="654" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="660" href="Test.SymbolicData.html#240" class="Function">SData</a>
<a id="666" class="Keyword">open</a> <a id="671" class="Keyword">import</a> <a id="678" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>

<a id="719" class="Keyword">open</a> <a id="724" href="Ledger.Conway.Specification.Transaction.html#991" class="Module">TransactionStructure</a> <a id="745" href="Test.LedgerImplementation.html#4277" class="Function">SVTransactionStructure</a>

<a id="emptyValue"></a><a id="769" href="Test.Examples.AccountSim.Validator.html#769" class="Function">emptyValue</a> <a id="780" class="Symbol">:</a> <a id="782" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="788" href="Test.Examples.AccountSim.Validator.html#769" class="Function">emptyValue</a> <a id="799" class="Symbol">=</a> <a id="801" class="Number">0</a>

<a id="feeValue"></a><a id="804" href="Test.Examples.AccountSim.Validator.html#804" class="Function">feeValue</a> <a id="813" class="Symbol">:</a> <a id="815" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="821" href="Test.Examples.AccountSim.Validator.html#804" class="Function">feeValue</a> <a id="830" class="Symbol">=</a> <a id="832" class="Number">10000000000</a>

<a id="startValue"></a><a id="845" href="Test.Examples.AccountSim.Validator.html#845" class="Function">startValue</a> <a id="856" class="Symbol">:</a> <a id="858" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="864" href="Test.Examples.AccountSim.Validator.html#845" class="Function">startValue</a> <a id="875" class="Symbol">=</a> <a id="877" class="Number">1000000000000</a>

<a id="scriptValue"></a><a id="892" href="Test.Examples.AccountSim.Validator.html#892" class="Function">scriptValue</a> <a id="904" class="Symbol">:</a> <a id="906" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="912" href="Test.Examples.AccountSim.Validator.html#892" class="Function">scriptValue</a> <a id="924" class="Symbol">=</a> <a id="926" class="Number">30000000000</a>

<a id="adaValueOf"></a><a id="939" href="Test.Examples.AccountSim.Validator.html#939" class="Function">adaValueOf</a> <a id="950" class="Symbol">:</a> <a id="952" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="954" class="Symbol">-&gt;</a> <a id="957" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="963" href="Test.Examples.AccountSim.Validator.html#939" class="Function">adaValueOf</a> <a id="974" href="Test.Examples.AccountSim.Validator.html#974" class="Bound">n</a> <a id="976" class="Symbol">=</a> <a id="978" href="Test.Examples.AccountSim.Validator.html#974" class="Bound">n</a>


<a id="geq"></a><a id="982" href="Test.Examples.AccountSim.Validator.html#982" class="Function">geq</a> <a id="986" class="Symbol">:</a> <a id="988" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="994" class="Symbol">-&gt;</a> <a id="997" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="1003" class="Symbol">-&gt;</a> <a id="1006" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1011" href="Test.Examples.AccountSim.Validator.html#982" class="Function">geq</a> <a id="1015" href="Test.Examples.AccountSim.Validator.html#1015" class="Bound">v1</a> <a id="1018" href="Test.Examples.AccountSim.Validator.html#1018" class="Bound">v2</a> <a id="1021" class="Symbol">=</a>  <a id="1024" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="1026" href="Test.Examples.AccountSim.Validator.html#1015" class="Bound">v1</a> <a id="1029" href="Data.Nat.Properties.html#6984" class="Function Operator">≥?</a> <a id="1032" href="Test.Examples.AccountSim.Validator.html#1018" class="Bound">v2</a> <a id="1035" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="subVal"></a><a id="1038" href="Test.Examples.AccountSim.Validator.html#1038" class="Function">subVal</a> <a id="1045" class="Symbol">:</a> <a id="1047" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="1053" class="Symbol">-&gt;</a> <a id="1056" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="1062" class="Symbol">-&gt;</a> <a id="1065" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="1071" href="Test.Examples.AccountSim.Validator.html#1038" class="Function">subVal</a> <a id="1078" href="Test.Examples.AccountSim.Validator.html#1078" class="Bound">v1</a> <a id="1081" href="Test.Examples.AccountSim.Validator.html#1081" class="Bound">v2</a> <a id="1084" class="Symbol">=</a> <a id="1086" href="Test.Examples.AccountSim.Validator.html#1078" class="Bound">v1</a> <a id="1089" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="1091" href="Test.Examples.AccountSim.Validator.html#1081" class="Bound">v2</a>

<a id="1095" class="Keyword">instance</a> <a id="ValueSub"></a><a id="1104" href="Test.Examples.AccountSim.Validator.html#1104" class="Function">ValueSub</a> <a id="1113" class="Symbol">:</a> <a id="1115" href="Interface.TypeClasses.HasSubtract.html#162" class="Record">HasSubtract</a> <a id="1127" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="1133" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
         <a id="1148" href="Test.Examples.AccountSim.Validator.html#1104" class="Function">ValueSub</a> <a id="1157" class="Symbol">=</a> <a id="1159" class="Keyword">record</a> <a id="1166" class="Symbol">{</a> <a id="1168" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">_-_</a> <a id="1172" class="Symbol">=</a> <a id="1174" class="Symbol">λ</a> <a id="1176" href="Test.Examples.AccountSim.Validator.html#1176" class="Bound">x</a> <a id="1178" href="Test.Examples.AccountSim.Validator.html#1178" class="Bound">y</a> <a id="1180" class="Symbol">→</a> <a id="1182" href="Test.Examples.AccountSim.Validator.html#1038" class="Function">subVal</a> <a id="1189" href="Test.Examples.AccountSim.Validator.html#1176" class="Bound">x</a> <a id="1191" href="Test.Examples.AccountSim.Validator.html#1178" class="Bound">y</a> <a id="1193" class="Symbol">}</a> <a id="1195" class="Comment">--subVal</a>


<a id="getInlineOutputDatum"></a><a id="1206" href="Test.Examples.AccountSim.Validator.html#1206" class="Function">getInlineOutputDatum</a> <a id="1227" class="Symbol">:</a> <a id="1229" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="1236" class="Symbol">→</a> <a id="1238" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1243" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a> <a id="1258" class="Symbol">→</a> <a id="1260" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1266" href="Ledger.Core.Specification.Script.Base.html#1768" class="Function">Datum</a>
<a id="1272" href="Test.Examples.AccountSim.Validator.html#1206" class="Function">getInlineOutputDatum</a> <a id="1293" class="Symbol">(</a><a id="1294" href="Test.Examples.AccountSim.Validator.html#1294" class="Bound">a</a> <a id="1296" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1298" href="Test.Examples.AccountSim.Validator.html#1298" class="Bound">b</a> <a id="1300" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1302" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1307" class="Symbol">(</a><a id="1308" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1313" class="Symbol">(</a><a id="1314" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1319" href="Test.Examples.AccountSim.Validator.html#1319" class="Bound">x</a><a id="1320" class="Symbol">)))</a> <a id="1324" href="Test.Examples.AccountSim.Validator.html#1324" class="Bound">dats</a> <a id="1329" class="Symbol">=</a> <a id="1331" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1336" class="Symbol">(</a><a id="1337" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1342" class="Symbol">(</a><a id="1343" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1348" href="Test.Examples.AccountSim.Validator.html#1319" class="Bound">x</a><a id="1349" class="Symbol">))</a>
<a id="1352" href="Test.Examples.AccountSim.Validator.html#1206" class="Function">getInlineOutputDatum</a> <a id="1373" class="Symbol">(</a><a id="1374" href="Test.Examples.AccountSim.Validator.html#1374" class="Bound">a</a> <a id="1376" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1378" href="Test.Examples.AccountSim.Validator.html#1378" class="Bound">b</a> <a id="1380" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1382" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1387" class="Symbol">(</a><a id="1388" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1393" class="Symbol">(</a><a id="1394" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1399" href="Test.Examples.AccountSim.Validator.html#1399" class="Bound">y</a><a id="1400" class="Symbol">)))</a> <a id="1404" href="Test.Examples.AccountSim.Validator.html#1404" class="Bound">dats</a> <a id="1409" class="Symbol">=</a> <a id="1411" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1419" href="Test.Examples.AccountSim.Validator.html#1206" class="Function">getInlineOutputDatum</a> <a id="1440" class="Symbol">(</a><a id="1441" href="Test.Examples.AccountSim.Validator.html#1441" class="Bound">a</a> <a id="1443" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1445" href="Test.Examples.AccountSim.Validator.html#1445" class="Bound">b</a> <a id="1447" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1449" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1454" class="Symbol">(</a><a id="1455" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1460" href="Test.Examples.AccountSim.Validator.html#1460" class="Bound">y</a><a id="1461" class="Symbol">))</a> <a id="1464" href="Test.Examples.AccountSim.Validator.html#1464" class="Bound">dats</a> <a id="1469" class="Symbol">=</a> <a id="1471" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1479" href="Test.Examples.AccountSim.Validator.html#1206" class="Function">getInlineOutputDatum</a> <a id="1500" class="Symbol">(</a><a id="1501" href="Test.Examples.AccountSim.Validator.html#1501" class="Bound">a</a> <a id="1503" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1505" href="Test.Examples.AccountSim.Validator.html#1505" class="Bound">b</a> <a id="1507" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1509" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="1516" class="Symbol">)</a> <a id="1518" href="Test.Examples.AccountSim.Validator.html#1518" class="Bound">dats</a> <a id="1523" class="Symbol">=</a> <a id="1525" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="newLabel"></a><a id="1534" href="Test.Examples.AccountSim.Validator.html#1534" class="Function">newLabel</a> <a id="1543" class="Symbol">:</a> <a id="1545" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="1559" class="Symbol">-&gt;</a> <a id="1562" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1568" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a>
<a id="1574" href="Test.Examples.AccountSim.Validator.html#1534" class="Function">newLabel</a> <a id="1583" class="Symbol">(</a><a id="1584" class="Keyword">record</a> <a id="1591" class="Symbol">{</a> <a id="1593" href="Test.Prelude.html#1924" class="Field">realizedInputs</a> <a id="1608" class="Symbol">=</a> <a id="1610" href="Test.Examples.AccountSim.Validator.html#1610" class="Bound">realizedInputs</a> <a id="1625" class="Symbol">;</a> <a id="1627" href="Test.Prelude.html#1955" class="Field">txouts</a> <a id="1634" class="Symbol">=</a> <a id="1636" href="Test.Examples.AccountSim.Validator.html#1636" class="Bound">txouts</a> <a id="1643" class="Symbol">;</a> <a id="1645" href="Test.Prelude.html#2000" class="Field">fee</a> <a id="1649" class="Symbol">=</a> <a id="1651" href="Test.Examples.AccountSim.Validator.html#1651" class="Bound">fee</a> <a id="1655" class="Symbol">;</a> <a id="1657" href="Test.Prelude.html#2032" class="Field">mint</a> <a id="1662" class="Symbol">=</a> <a id="1664" href="Test.Examples.AccountSim.Validator.html#1664" class="Bound">mint</a> <a id="1669" class="Symbol">;</a> <a id="1671" href="Test.Prelude.html#2109" class="Field">txwdrls</a> <a id="1679" class="Symbol">=</a> <a id="1681" href="Test.Examples.AccountSim.Validator.html#1681" class="Bound">txwdrls</a> <a id="1689" class="Symbol">;</a> <a id="1691" href="Test.Prelude.html#2164" class="Field">txvldt</a> <a id="1698" class="Symbol">=</a> <a id="1700" href="Test.Examples.AccountSim.Validator.html#1700" class="Bound">txvldt</a> <a id="1707" class="Symbol">;</a> <a id="1709" href="Test.Prelude.html#2215" class="Field">vkey</a> <a id="1714" class="Symbol">=</a> <a id="1716" href="Test.Examples.AccountSim.Validator.html#1716" class="Bound">vkey</a> <a id="1721" class="Symbol">;</a> <a id="1723" href="Test.Prelude.html#2251" class="Field">txdats</a> <a id="1730" class="Symbol">=</a> <a id="1732" href="Test.Examples.AccountSim.Validator.html#1732" class="Bound">txdats</a> <a id="1739" class="Symbol">;</a> <a id="1741" href="Test.Prelude.html#2356" class="Field">txid</a> <a id="1746" class="Symbol">=</a> <a id="1748" href="Test.Examples.AccountSim.Validator.html#1748" class="Bound">txid</a> <a id="1753" class="Symbol">}</a> <a id="1755" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1757" href="Test.Examples.AccountSim.Validator.html#1757" class="Bound">snd</a><a id="1760" class="Symbol">)</a> <a id="1762" class="Keyword">with</a>
  <a id="1769" href="Data.List.Base.html#4606" class="Function">mapMaybe</a> <a id="1778" class="Symbol">(λ</a> <a id="1781" href="Test.Examples.AccountSim.Validator.html#1781" class="Bound">x</a> <a id="1783" class="Symbol">→</a> <a id="1785" href="Test.Examples.AccountSim.Validator.html#1206" class="Function">getInlineOutputDatum</a> <a id="1806" href="Test.Examples.AccountSim.Validator.html#1781" class="Bound">x</a> <a id="1808" href="Test.Examples.AccountSim.Validator.html#1732" class="Bound">txdats</a><a id="1814" class="Symbol">)</a> <a id="1816" class="Symbol">(</a><a id="1817" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1821" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1827" href="Test.Examples.AccountSim.Validator.html#1636" class="Bound">txouts</a><a id="1833" class="Symbol">)</a>
<a id="1835" class="Symbol">...</a> <a id="1839" class="Symbol">|</a> <a id="1841" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1844" class="Symbol">=</a> <a id="1846" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1854" class="Symbol">...</a> <a id="1858" class="Symbol">|</a> <a id="1860" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1865" class="Symbol">(</a><a id="1866" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1871" href="Test.Examples.AccountSim.Validator.html#1871" class="Bound">x</a><a id="1872" class="Symbol">)</a> <a id="1874" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1876" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1879" class="Symbol">=</a> <a id="1881" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1886" href="Test.Examples.AccountSim.Validator.html#1871" class="Bound">x</a>
<a id="1888" class="CatchallClause Symbol">...</a><a id="1891" class="CatchallClause"> </a><a id="1892" class="CatchallClause Symbol">|</a><a id="1893" class="CatchallClause"> </a><a id="1894" class="CatchallClause Symbol">_</a> <a id="1896" class="Symbol">=</a> <a id="1898" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="continuing"></a><a id="1907" href="Test.Examples.AccountSim.Validator.html#1907" class="Function">continuing</a> <a id="1918" class="Symbol">:</a> <a id="1920" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="1934" class="Symbol">-&gt;</a> <a id="1937" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1942" href="Test.Examples.AccountSim.Validator.html#1907" class="Function">continuing</a> <a id="1953" class="Symbol">(</a><a id="1954" class="Keyword">record</a> <a id="1961" class="Symbol">{</a> <a id="1963" href="Test.Prelude.html#1924" class="Field">realizedInputs</a> <a id="1978" class="Symbol">=</a> <a id="1980" href="Test.Examples.AccountSim.Validator.html#1980" class="Bound">realizedInputs</a> <a id="1995" class="Symbol">;</a> <a id="1997" href="Test.Prelude.html#1955" class="Field">txouts</a> <a id="2004" class="Symbol">=</a> <a id="2006" href="Test.Examples.AccountSim.Validator.html#2006" class="Bound">txouts</a> <a id="2013" class="Symbol">;</a> <a id="2015" href="Test.Prelude.html#2000" class="Field">fee</a> <a id="2019" class="Symbol">=</a> <a id="2021" href="Test.Examples.AccountSim.Validator.html#2021" class="Bound">fee</a> <a id="2025" class="Symbol">;</a> <a id="2027" href="Test.Prelude.html#2032" class="Field">mint</a> <a id="2032" class="Symbol">=</a> <a id="2034" href="Test.Examples.AccountSim.Validator.html#2034" class="Bound">mint</a> <a id="2039" class="Symbol">;</a> <a id="2041" href="Test.Prelude.html#2109" class="Field">txwdrls</a> <a id="2049" class="Symbol">=</a> <a id="2051" href="Test.Examples.AccountSim.Validator.html#2051" class="Bound">txwdrls</a> <a id="2059" class="Symbol">;</a> <a id="2061" href="Test.Prelude.html#2164" class="Field">txvldt</a> <a id="2068" class="Symbol">=</a> <a id="2070" href="Test.Examples.AccountSim.Validator.html#2070" class="Bound">txvldt</a> <a id="2077" class="Symbol">;</a> <a id="2079" href="Test.Prelude.html#2215" class="Field">vkey</a> <a id="2084" class="Symbol">=</a> <a id="2086" href="Test.Examples.AccountSim.Validator.html#2086" class="Bound">vkey</a> <a id="2091" class="Symbol">;</a> <a id="2093" href="Test.Prelude.html#2251" class="Field">txdats</a> <a id="2100" class="Symbol">=</a> <a id="2102" href="Test.Examples.AccountSim.Validator.html#2102" class="Bound">txdats</a> <a id="2109" class="Symbol">;</a> <a id="2111" href="Test.Prelude.html#2356" class="Field">txid</a> <a id="2116" class="Symbol">=</a> <a id="2118" href="Test.Examples.AccountSim.Validator.html#2118" class="Bound">txid</a> <a id="2123" class="Symbol">}</a> <a id="2125" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2127" href="Test.Examples.AccountSim.Validator.html#2127" class="Bound">snd</a><a id="2130" class="Symbol">)</a> <a id="2132" class="Keyword">with</a>
  <a id="2139" href="Data.List.Base.html#4606" class="Function">mapMaybe</a> <a id="2148" class="Symbol">(λ</a> <a id="2151" href="Test.Examples.AccountSim.Validator.html#2151" class="Bound">x</a> <a id="2153" class="Symbol">→</a> <a id="2155" href="Test.Examples.AccountSim.Validator.html#1206" class="Function">getInlineOutputDatum</a> <a id="2176" href="Test.Examples.AccountSim.Validator.html#2151" class="Bound">x</a> <a id="2178" href="Test.Examples.AccountSim.Validator.html#2102" class="Bound">txdats</a><a id="2184" class="Symbol">)</a> <a id="2186" class="Symbol">(</a><a id="2187" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2191" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2197" href="Test.Examples.AccountSim.Validator.html#2006" class="Bound">txouts</a><a id="2203" class="Symbol">)</a>
<a id="2205" class="Symbol">...</a> <a id="2209" class="Symbol">|</a> <a id="2211" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2214" class="Symbol">=</a> <a id="2216" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="2222" class="CatchallClause Symbol">...</a><a id="2225" class="CatchallClause"> </a><a id="2226" class="CatchallClause Symbol">|</a><a id="2227" class="CatchallClause"> </a><a id="2228" class="CatchallClause Symbol">_</a> <a id="2230" class="Symbol">=</a> <a id="2232" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>


<a id="getPaymentCredential"></a><a id="2239" href="Test.Examples.AccountSim.Validator.html#2239" class="Function">getPaymentCredential</a> <a id="2260" class="Symbol">:</a> <a id="2262" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="2269" class="Symbol">→</a> <a id="2271" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2273" href="Test.Examples.AccountSim.Validator.html#2239" class="Function">getPaymentCredential</a> <a id="2294" class="Symbol">(</a><a id="2295" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2300" class="Keyword">record</a> <a id="2307" class="Symbol">{</a> <a id="2309" href="Test.Prelude.html#730" class="Field">net</a> <a id="2313" class="Symbol">=</a> <a id="2315" href="Test.Examples.AccountSim.Validator.html#2315" class="Bound">net</a> <a id="2319" class="Symbol">;</a> <a id="2321" href="Test.Prelude.html#756" class="Field">pay</a> <a id="2325" class="Symbol">=</a> <a id="2327" class="Symbol">(</a><a id="2328" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="2339" href="Test.Examples.AccountSim.Validator.html#2339" class="Bound">x</a><a id="2340" class="Symbol">)</a> <a id="2342" class="Symbol">;</a> <a id="2344" href="Test.Prelude.html#785" class="Field">stake</a> <a id="2350" class="Symbol">=</a> <a id="2352" href="Test.Examples.AccountSim.Validator.html#2352" class="Bound">stake</a> <a id="2358" class="Symbol">}</a> <a id="2360" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2362" href="Test.Examples.AccountSim.Validator.html#2362" class="Bound">snd</a><a id="2365" class="Symbol">)</a> <a id="2367" class="Symbol">=</a> <a id="2369" href="Test.Examples.AccountSim.Validator.html#2339" class="Bound">x</a>
<a id="2371" href="Test.Examples.AccountSim.Validator.html#2239" class="Function">getPaymentCredential</a> <a id="2392" class="Symbol">(</a><a id="2393" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2398" class="Keyword">record</a> <a id="2405" class="Symbol">{</a> <a id="2407" href="Test.Prelude.html#730" class="Field">net</a> <a id="2411" class="Symbol">=</a> <a id="2413" href="Test.Examples.AccountSim.Validator.html#2413" class="Bound">net</a> <a id="2417" class="Symbol">;</a> <a id="2419" href="Test.Prelude.html#756" class="Field">pay</a> <a id="2423" class="Symbol">=</a> <a id="2425" class="Symbol">(</a><a id="2426" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="2436" href="Test.Examples.AccountSim.Validator.html#2436" class="Bound">x</a><a id="2437" class="Symbol">)</a> <a id="2439" class="Symbol">;</a> <a id="2441" href="Test.Prelude.html#785" class="Field">stake</a> <a id="2447" class="Symbol">=</a> <a id="2449" href="Test.Examples.AccountSim.Validator.html#2449" class="Bound">stake</a> <a id="2455" class="Symbol">}</a> <a id="2457" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2459" href="Test.Examples.AccountSim.Validator.html#2459" class="Bound">snd</a><a id="2462" class="Symbol">)</a> <a id="2464" class="Symbol">=</a> <a id="2466" href="Test.Examples.AccountSim.Validator.html#2436" class="Bound">x</a>
<a id="2468" href="Test.Examples.AccountSim.Validator.html#2239" class="Function">getPaymentCredential</a> <a id="2489" class="Symbol">(</a><a id="2490" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2495" class="Keyword">record</a> <a id="2502" class="Symbol">{</a> <a id="2504" href="Test.Prelude.html#956" class="Field">net</a> <a id="2508" class="Symbol">=</a> <a id="2510" href="Test.Examples.AccountSim.Validator.html#2510" class="Bound">net</a> <a id="2514" class="Symbol">;</a> <a id="2516" href="Test.Prelude.html#986" class="Field">pay</a> <a id="2520" class="Symbol">=</a> <a id="2522" class="Symbol">(</a><a id="2523" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="2534" href="Test.Examples.AccountSim.Validator.html#2534" class="Bound">x</a><a id="2535" class="Symbol">)</a> <a id="2537" class="Symbol">;</a> <a id="2539" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="2549" class="Symbol">=</a> <a id="2551" href="Test.Examples.AccountSim.Validator.html#2551" class="Bound">attrsSize</a> <a id="2561" class="Symbol">}</a> <a id="2563" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2565" href="Test.Examples.AccountSim.Validator.html#2565" class="Bound">snd</a><a id="2568" class="Symbol">)</a> <a id="2570" class="Symbol">=</a> <a id="2572" href="Test.Examples.AccountSim.Validator.html#2534" class="Bound">x</a>
<a id="2574" href="Test.Examples.AccountSim.Validator.html#2239" class="Function">getPaymentCredential</a> <a id="2595" class="Symbol">(</a><a id="2596" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2601" class="Keyword">record</a> <a id="2608" class="Symbol">{</a> <a id="2610" href="Test.Prelude.html#956" class="Field">net</a> <a id="2614" class="Symbol">=</a> <a id="2616" href="Test.Examples.AccountSim.Validator.html#2616" class="Bound">net</a> <a id="2620" class="Symbol">;</a> <a id="2622" href="Test.Prelude.html#986" class="Field">pay</a> <a id="2626" class="Symbol">=</a> <a id="2628" class="Symbol">(</a><a id="2629" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="2639" href="Test.Examples.AccountSim.Validator.html#2639" class="Bound">x</a><a id="2640" class="Symbol">)</a> <a id="2642" class="Symbol">;</a> <a id="2644" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="2654" class="Symbol">=</a> <a id="2656" href="Test.Examples.AccountSim.Validator.html#2656" class="Bound">attrsSize</a> <a id="2666" class="Symbol">}</a> <a id="2668" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2670" href="Test.Examples.AccountSim.Validator.html#2670" class="Bound">snd</a><a id="2673" class="Symbol">)</a> <a id="2675" class="Symbol">=</a> <a id="2677" href="Test.Examples.AccountSim.Validator.html#2639" class="Bound">x</a>


<a id="getScriptCredential&#39;"></a><a id="2681" href="Test.Examples.AccountSim.Validator.html#2681" class="Function">getScriptCredential&#39;</a> <a id="2702" class="Symbol">:</a> <a id="2704" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2706" class="Symbol">→</a> <a id="2708" href="Test.Prelude.html#1311" class="Function">SUTxO</a> <a id="2714" class="Symbol">→</a> <a id="2716" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2722" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2724" href="Test.Examples.AccountSim.Validator.html#2681" class="Function">getScriptCredential&#39;</a> <a id="2745" href="Test.Examples.AccountSim.Validator.html#2745" class="Bound">ix</a> <a id="2748" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2751" class="Symbol">=</a> <a id="2753" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2761" href="Test.Examples.AccountSim.Validator.html#2681" class="Function">getScriptCredential&#39;</a> <a id="2782" href="Test.Examples.AccountSim.Validator.html#2782" class="Bound">ix</a> <a id="2785" class="Symbol">(((</a><a id="2788" href="Test.Examples.AccountSim.Validator.html#2788" class="Bound">txid&#39;</a> <a id="2794" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2796" href="Test.Examples.AccountSim.Validator.html#2796" class="Bound">ix&#39;</a><a id="2799" class="Symbol">)</a> <a id="2801" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2803" href="Test.Examples.AccountSim.Validator.html#2803" class="Bound">txout</a><a id="2808" class="Symbol">)</a> <a id="2810" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2812" href="Test.Examples.AccountSim.Validator.html#2812" class="Bound">utxos</a><a id="2817" class="Symbol">)</a> <a id="2819" class="Keyword">with</a> <a id="2824" href="Test.Examples.AccountSim.Validator.html#2782" class="Bound">ix</a> <a id="2827" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="2829" href="Test.Examples.AccountSim.Validator.html#2796" class="Bound">ix&#39;</a>
<a id="2833" class="Symbol">...</a> <a id="2837" class="Symbol">|</a> <a id="2839" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2842" href="Test.Examples.AccountSim.Validator.html#2842" class="Bound">¬a</a> <a id="2845" class="Symbol">=</a> <a id="2847" href="Test.Examples.AccountSim.Validator.html#2681" class="Function">getScriptCredential&#39;</a> <a id="2868" class="Bound">ix</a> <a id="2871" class="Bound">utxos</a>
<a id="2877" class="Symbol">...</a> <a id="2881" class="Symbol">|</a> <a id="2883" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2887" href="Test.Examples.AccountSim.Validator.html#2887" class="Bound">a</a> <a id="2889" class="Symbol">=</a> <a id="2891" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2896" class="Symbol">(</a><a id="2897" href="Test.Examples.AccountSim.Validator.html#2239" class="Function">getPaymentCredential</a> <a id="2918" class="Bound">txout</a><a id="2923" class="Symbol">)</a>


<a id="getScriptCredential"></a><a id="2927" href="Test.Examples.AccountSim.Validator.html#2927" class="Function">getScriptCredential</a> <a id="2947" class="Symbol">:</a> <a id="2949" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="2963" class="Symbol">→</a> <a id="2965" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2971" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2973" href="Test.Examples.AccountSim.Validator.html#2927" class="Function">getScriptCredential</a> <a id="2993" class="Symbol">(</a><a id="2994" href="Test.Examples.AccountSim.Validator.html#2994" class="Bound">fst</a> <a id="2998" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3000" href="Test.Prelude.html#1627" class="InductiveConstructor">Rwrd</a> <a id="3005" href="Test.Examples.AccountSim.Validator.html#3005" class="Bound">x</a><a id="3006" class="Symbol">)</a> <a id="3008" class="Symbol">=</a> <a id="3010" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="3018" href="Test.Examples.AccountSim.Validator.html#2927" class="Function">getScriptCredential</a> <a id="3038" class="Symbol">(</a><a id="3039" href="Test.Examples.AccountSim.Validator.html#3039" class="Bound">fst</a> <a id="3043" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3045" href="Test.Prelude.html#1672" class="InductiveConstructor">Mint</a> <a id="3050" href="Test.Examples.AccountSim.Validator.html#3050" class="Bound">x</a><a id="3051" class="Symbol">)</a> <a id="3053" class="Symbol">=</a> <a id="3055" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="3063" href="Test.Examples.AccountSim.Validator.html#2927" class="Function">getScriptCredential</a> <a id="3083" class="Symbol">(</a><a id="3084" href="Test.Examples.AccountSim.Validator.html#3084" class="Bound">txinfo</a> <a id="3091" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3093" href="Test.Prelude.html#1709" class="InductiveConstructor">Spend</a> <a id="3099" class="Symbol">(</a><a id="3100" href="Test.Examples.AccountSim.Validator.html#3100" class="Bound">txid</a> <a id="3105" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3107" href="Test.Examples.AccountSim.Validator.html#3107" class="Bound">ix</a><a id="3109" class="Symbol">))</a> <a id="3112" class="Symbol">=</a> <a id="3114" href="Test.Examples.AccountSim.Validator.html#2681" class="Function">getScriptCredential&#39;</a> <a id="3135" href="Test.Examples.AccountSim.Validator.html#3107" class="Bound">ix</a> <a id="3138" class="Symbol">(</a><a id="3139" href="Test.Prelude.html#1924" class="Field">STxInfo.realizedInputs</a> <a id="3162" href="Test.Examples.AccountSim.Validator.html#3084" class="Bound">txinfo</a><a id="3168" class="Symbol">)</a>
<a id="3170" href="Test.Examples.AccountSim.Validator.html#2927" class="Function">getScriptCredential</a> <a id="3190" class="Symbol">(</a><a id="3191" href="Test.Examples.AccountSim.Validator.html#3191" class="Bound">fst</a> <a id="3195" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3197" href="Test.Prelude.html#1745" class="InductiveConstructor">Empty</a><a id="3202" class="Symbol">)</a> <a id="3204" class="Symbol">=</a> <a id="3206" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="balanceSTxOut"></a><a id="3215" href="Test.Examples.AccountSim.Validator.html#3215" class="Function">balanceSTxOut</a> <a id="3229" class="Symbol">:</a> <a id="3231" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3236" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="3243" class="Symbol">→</a> <a id="3245" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="3251" href="Test.Examples.AccountSim.Validator.html#3215" class="Function">balanceSTxOut</a> <a id="3265" href="Test.Examples.AccountSim.Validator.html#3265" class="Bound">txout</a> <a id="3271" class="Symbol">=</a> <a id="3273" href="Data.List.Base.html#4126" class="Function">foldr</a> <a id="3279" class="Symbol">(</a><a id="3280" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3284" class="Symbol">{{</a><a id="3286" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="3294" class="Symbol">}})</a> <a id="3298" href="Test.Examples.AccountSim.Validator.html#769" class="Function">emptyValue</a> <a id="3309" class="Symbol">(</a><a id="3310" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3314" class="Symbol">(λ</a> <a id="3317" class="Symbol">{(_</a> <a id="3321" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3323" href="Test.Examples.AccountSim.Validator.html#3323" class="Bound">v</a> <a id="3325" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3327" class="Symbol">_)</a> <a id="3330" class="Symbol">→</a> <a id="3332" href="Test.Examples.AccountSim.Validator.html#3323" class="Bound">v</a><a id="3333" class="Symbol">})</a> <a id="3336" href="Test.Examples.AccountSim.Validator.html#3265" class="Bound">txout</a><a id="3341" class="Symbol">)</a>

<a id="matchIx"></a><a id="3344" href="Test.Examples.AccountSim.Validator.html#3344" class="Function">matchIx</a> <a id="3352" class="Symbol">:</a> <a id="3354" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3356" class="Symbol">→</a> <a id="3358" href="Test.Prelude.html#1151" class="Function">SAddr</a> <a id="3364" class="Symbol">→</a> <a id="3366" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="3370" href="Test.Examples.AccountSim.Validator.html#3344" class="Function">matchIx</a> <a id="3378" href="Test.Examples.AccountSim.Validator.html#3378" class="Bound">n</a> <a id="3380" class="Symbol">(</a><a id="3381" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3386" class="Keyword">record</a> <a id="3393" class="Symbol">{</a> <a id="3395" href="Test.Prelude.html#730" class="Field">net</a> <a id="3399" class="Symbol">=</a> <a id="3401" href="Test.Examples.AccountSim.Validator.html#3401" class="Bound">net</a> <a id="3405" class="Symbol">;</a> <a id="3407" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3411" class="Symbol">=</a> <a id="3413" class="Symbol">(</a><a id="3414" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3425" href="Test.Examples.AccountSim.Validator.html#3425" class="Bound">x</a><a id="3426" class="Symbol">)</a> <a id="3428" class="Symbol">;</a> <a id="3430" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3436" class="Symbol">=</a> <a id="3438" href="Test.Examples.AccountSim.Validator.html#3438" class="Bound">stake</a> <a id="3444" class="Symbol">})</a> <a id="3447" class="Symbol">=</a> <a id="3449" href="Test.Examples.AccountSim.Validator.html#3378" class="Bound">n</a> <a id="3451" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3453" href="Test.Examples.AccountSim.Validator.html#3425" class="Bound">x</a>
<a id="3455" href="Test.Examples.AccountSim.Validator.html#3344" class="Function">matchIx</a> <a id="3463" href="Test.Examples.AccountSim.Validator.html#3463" class="Bound">n</a> <a id="3465" class="Symbol">(</a><a id="3466" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3471" class="Keyword">record</a> <a id="3478" class="Symbol">{</a> <a id="3480" href="Test.Prelude.html#730" class="Field">net</a> <a id="3484" class="Symbol">=</a> <a id="3486" href="Test.Examples.AccountSim.Validator.html#3486" class="Bound">net</a> <a id="3490" class="Symbol">;</a> <a id="3492" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3496" class="Symbol">=</a> <a id="3498" class="Symbol">(</a><a id="3499" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3509" href="Test.Examples.AccountSim.Validator.html#3509" class="Bound">y</a><a id="3510" class="Symbol">)</a> <a id="3512" class="Symbol">;</a> <a id="3514" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3520" class="Symbol">=</a> <a id="3522" href="Test.Examples.AccountSim.Validator.html#3522" class="Bound">stake</a> <a id="3528" class="Symbol">})</a> <a id="3531" class="Symbol">=</a> <a id="3533" href="Test.Examples.AccountSim.Validator.html#3463" class="Bound">n</a> <a id="3535" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3537" href="Test.Examples.AccountSim.Validator.html#3509" class="Bound">y</a>
<a id="3539" href="Test.Examples.AccountSim.Validator.html#3344" class="Function">matchIx</a> <a id="3547" href="Test.Examples.AccountSim.Validator.html#3547" class="Bound">n</a> <a id="3549" class="Symbol">(</a><a id="3550" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3555" class="Keyword">record</a> <a id="3562" class="Symbol">{</a> <a id="3564" href="Test.Prelude.html#956" class="Field">net</a> <a id="3568" class="Symbol">=</a> <a id="3570" href="Test.Examples.AccountSim.Validator.html#3570" class="Bound">net</a> <a id="3574" class="Symbol">;</a> <a id="3576" href="Test.Prelude.html#986" class="Field">pay</a> <a id="3580" class="Symbol">=</a> <a id="3582" class="Symbol">(</a><a id="3583" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3594" href="Test.Examples.AccountSim.Validator.html#3594" class="Bound">x</a><a id="3595" class="Symbol">)</a> <a id="3597" class="Symbol">;</a> <a id="3599" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="3609" class="Symbol">=</a> <a id="3611" href="Test.Examples.AccountSim.Validator.html#3611" class="Bound">attrsSize</a> <a id="3621" class="Symbol">})</a> <a id="3624" class="Symbol">=</a> <a id="3626" href="Test.Examples.AccountSim.Validator.html#3547" class="Bound">n</a> <a id="3628" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3630" href="Test.Examples.AccountSim.Validator.html#3594" class="Bound">x</a>
<a id="3632" href="Test.Examples.AccountSim.Validator.html#3344" class="Function">matchIx</a> <a id="3640" href="Test.Examples.AccountSim.Validator.html#3640" class="Bound">n</a> <a id="3642" class="Symbol">(</a><a id="3643" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3648" class="Keyword">record</a> <a id="3655" class="Symbol">{</a> <a id="3657" href="Test.Prelude.html#956" class="Field">net</a> <a id="3661" class="Symbol">=</a> <a id="3663" href="Test.Examples.AccountSim.Validator.html#3663" class="Bound">net</a> <a id="3667" class="Symbol">;</a> <a id="3669" href="Test.Prelude.html#986" class="Field">pay</a> <a id="3673" class="Symbol">=</a> <a id="3675" class="Symbol">(</a><a id="3676" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3686" href="Test.Examples.AccountSim.Validator.html#3686" class="Bound">y</a><a id="3687" class="Symbol">)</a> <a id="3689" class="Symbol">;</a> <a id="3691" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="3701" class="Symbol">=</a> <a id="3703" href="Test.Examples.AccountSim.Validator.html#3703" class="Bound">attrsSize</a> <a id="3713" class="Symbol">})</a> <a id="3716" class="Symbol">=</a> <a id="3718" href="Test.Examples.AccountSim.Validator.html#3640" class="Bound">n</a> <a id="3720" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3722" href="Test.Examples.AccountSim.Validator.html#3686" class="Bound">y</a>

<a id="matchIx?"></a><a id="3725" href="Test.Examples.AccountSim.Validator.html#3725" class="Function">matchIx?</a> <a id="3734" class="Symbol">:</a> <a id="3736" class="Symbol">(</a><a id="3737" href="Test.Examples.AccountSim.Validator.html#3737" class="Bound">n</a> <a id="3739" class="Symbol">:</a> <a id="3741" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="3742" class="Symbol">)</a> <a id="3744" class="Symbol">→</a> <a id="3746" class="Symbol">(</a><a id="3747" href="Test.Examples.AccountSim.Validator.html#3747" class="Bound">a</a> <a id="3749" class="Symbol">:</a> <a id="3751" href="Test.Prelude.html#1151" class="Function">SAddr</a><a id="3756" class="Symbol">)</a> <a id="3758" class="Symbol">→</a> <a id="3760" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="3764" class="Symbol">(</a><a id="3765" href="Test.Examples.AccountSim.Validator.html#3344" class="Function">matchIx</a> <a id="3773" href="Test.Examples.AccountSim.Validator.html#3737" class="Bound">n</a> <a id="3775" href="Test.Examples.AccountSim.Validator.html#3747" class="Bound">a</a><a id="3776" class="Symbol">)</a>
<a id="3778" href="Test.Examples.AccountSim.Validator.html#3725" class="Function">matchIx?</a> <a id="3787" href="Test.Examples.AccountSim.Validator.html#3787" class="Bound">n</a> <a id="3789" class="Symbol">(</a><a id="3790" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3795" class="Keyword">record</a> <a id="3802" class="Symbol">{</a> <a id="3804" href="Test.Prelude.html#730" class="Field">net</a> <a id="3808" class="Symbol">=</a> <a id="3810" href="Test.Examples.AccountSim.Validator.html#3810" class="Bound">net</a> <a id="3814" class="Symbol">;</a> <a id="3816" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3820" class="Symbol">=</a> <a id="3822" class="Symbol">(</a><a id="3823" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3834" href="Test.Examples.AccountSim.Validator.html#3834" class="Bound">x</a><a id="3835" class="Symbol">)</a> <a id="3837" class="Symbol">;</a> <a id="3839" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3845" class="Symbol">=</a> <a id="3847" href="Test.Examples.AccountSim.Validator.html#3847" class="Bound">stake</a> <a id="3853" class="Symbol">})</a> <a id="3856" class="Symbol">=</a> <a id="3858" href="Test.Examples.AccountSim.Validator.html#3787" class="Bound">n</a> <a id="3860" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="3862" href="Test.Examples.AccountSim.Validator.html#3834" class="Bound">x</a>
<a id="3864" href="Test.Examples.AccountSim.Validator.html#3725" class="Function">matchIx?</a> <a id="3873" href="Test.Examples.AccountSim.Validator.html#3873" class="Bound">n</a> <a id="3875" class="Symbol">(</a><a id="3876" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3881" class="Keyword">record</a> <a id="3888" class="Symbol">{</a> <a id="3890" href="Test.Prelude.html#730" class="Field">net</a> <a id="3894" class="Symbol">=</a> <a id="3896" href="Test.Examples.AccountSim.Validator.html#3896" class="Bound">net</a> <a id="3900" class="Symbol">;</a> <a id="3902" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3906" class="Symbol">=</a> <a id="3908" class="Symbol">(</a><a id="3909" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3919" href="Test.Examples.AccountSim.Validator.html#3919" class="Bound">y</a><a id="3920" class="Symbol">)</a> <a id="3922" class="Symbol">;</a> <a id="3924" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3930" class="Symbol">=</a> <a id="3932" href="Test.Examples.AccountSim.Validator.html#3932" class="Bound">stake</a> <a id="3938" class="Symbol">})</a> <a id="3941" class="Symbol">=</a> <a id="3943" href="Test.Examples.AccountSim.Validator.html#3873" class="Bound">n</a> <a id="3945" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="3947" href="Test.Examples.AccountSim.Validator.html#3919" class="Bound">y</a>
<a id="3949" href="Test.Examples.AccountSim.Validator.html#3725" class="Function">matchIx?</a> <a id="3958" href="Test.Examples.AccountSim.Validator.html#3958" class="Bound">n</a> <a id="3960" class="Symbol">(</a><a id="3961" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3966" class="Keyword">record</a> <a id="3973" class="Symbol">{</a> <a id="3975" href="Test.Prelude.html#956" class="Field">net</a> <a id="3979" class="Symbol">=</a> <a id="3981" href="Test.Examples.AccountSim.Validator.html#3981" class="Bound">net</a> <a id="3985" class="Symbol">;</a> <a id="3987" href="Test.Prelude.html#986" class="Field">pay</a> <a id="3991" class="Symbol">=</a> <a id="3993" class="Symbol">(</a><a id="3994" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="4005" href="Test.Examples.AccountSim.Validator.html#4005" class="Bound">x</a><a id="4006" class="Symbol">)</a> <a id="4008" class="Symbol">;</a> <a id="4010" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="4020" class="Symbol">=</a> <a id="4022" href="Test.Examples.AccountSim.Validator.html#4022" class="Bound">attrsSize</a> <a id="4032" class="Symbol">})</a> <a id="4035" class="Symbol">=</a> <a id="4037" href="Test.Examples.AccountSim.Validator.html#3958" class="Bound">n</a> <a id="4039" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="4041" href="Test.Examples.AccountSim.Validator.html#4005" class="Bound">x</a>
<a id="4043" href="Test.Examples.AccountSim.Validator.html#3725" class="Function">matchIx?</a> <a id="4052" href="Test.Examples.AccountSim.Validator.html#4052" class="Bound">n</a> <a id="4054" class="Symbol">(</a><a id="4055" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="4060" class="Keyword">record</a> <a id="4067" class="Symbol">{</a> <a id="4069" href="Test.Prelude.html#956" class="Field">net</a> <a id="4073" class="Symbol">=</a> <a id="4075" href="Test.Examples.AccountSim.Validator.html#4075" class="Bound">net</a> <a id="4079" class="Symbol">;</a> <a id="4081" href="Test.Prelude.html#986" class="Field">pay</a> <a id="4085" class="Symbol">=</a> <a id="4087" class="Symbol">(</a><a id="4088" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="4098" href="Test.Examples.AccountSim.Validator.html#4098" class="Bound">y</a><a id="4099" class="Symbol">)</a> <a id="4101" class="Symbol">;</a> <a id="4103" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="4113" class="Symbol">=</a> <a id="4115" href="Test.Examples.AccountSim.Validator.html#4115" class="Bound">attrsSize</a> <a id="4125" class="Symbol">})</a> <a id="4128" class="Symbol">=</a> <a id="4130" href="Test.Examples.AccountSim.Validator.html#4052" class="Bound">n</a> <a id="4132" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="4134" href="Test.Examples.AccountSim.Validator.html#4098" class="Bound">y</a>


<a id="totalOuts"></a><a id="4138" href="Test.Examples.AccountSim.Validator.html#4138" class="Function">totalOuts</a> <a id="4148" class="Symbol">:</a> <a id="4150" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4164" class="Symbol">→</a> <a id="4166" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4177" class="Symbol">→</a> <a id="4179" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="4185" href="Test.Examples.AccountSim.Validator.html#4138" class="Function">totalOuts</a> <a id="4195" class="Symbol">(</a><a id="4196" href="Test.Examples.AccountSim.Validator.html#4196" class="Bound">txinfo</a> <a id="4203" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4205" class="Symbol">_)</a> <a id="4208" href="Test.Examples.AccountSim.Validator.html#4208" class="Bound">ph</a>  <a id="4212" class="Symbol">=</a> <a id="4214" href="Test.Examples.AccountSim.Validator.html#3215" class="Function">balanceSTxOut</a> <a id="4228" class="Symbol">(</a><a id="4229" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="4236" class="Symbol">(λ</a> <a id="4239" class="Symbol">{</a> <a id="4241" class="Symbol">(</a><a id="4242" href="Test.Examples.AccountSim.Validator.html#4242" class="Bound">fst</a> <a id="4246" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4248" href="Test.Examples.AccountSim.Validator.html#4248" class="Bound">snd</a><a id="4251" class="Symbol">)</a> <a id="4253" class="Symbol">→</a> <a id="4255" href="Test.Examples.AccountSim.Validator.html#3725" class="Function">matchIx?</a> <a id="4264" href="Test.Examples.AccountSim.Validator.html#4208" class="Bound">ph</a> <a id="4267" href="Test.Examples.AccountSim.Validator.html#4242" class="Bound">fst</a><a id="4270" class="Symbol">})</a> <a id="4273" class="Symbol">(</a><a id="4274" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="4278" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4284" class="Symbol">(</a><a id="4285" href="Test.Prelude.html#1955" class="Field">STxInfo.txouts</a> <a id="4300" href="Test.Examples.AccountSim.Validator.html#4196" class="Bound">txinfo</a><a id="4306" class="Symbol">)))</a>

<a id="totalIns"></a><a id="4311" href="Test.Examples.AccountSim.Validator.html#4311" class="Function">totalIns</a> <a id="4320" class="Symbol">:</a> <a id="4322" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4336" class="Symbol">→</a> <a id="4338" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4349" class="Symbol">→</a> <a id="4351" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="4357" href="Test.Examples.AccountSim.Validator.html#4311" class="Function">totalIns</a> <a id="4366" class="Symbol">(</a><a id="4367" href="Test.Examples.AccountSim.Validator.html#4367" class="Bound">txinfo</a> <a id="4374" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4376" class="Symbol">_)</a> <a id="4379" href="Test.Examples.AccountSim.Validator.html#4379" class="Bound">ph</a>  <a id="4383" class="Symbol">=</a> <a id="4385" href="Test.Examples.AccountSim.Validator.html#3215" class="Function">balanceSTxOut</a> <a id="4399" class="Symbol">(</a><a id="4400" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="4407" class="Symbol">(λ</a> <a id="4410" class="Symbol">{</a> <a id="4412" class="Symbol">(</a><a id="4413" href="Test.Examples.AccountSim.Validator.html#4413" class="Bound">fst</a> <a id="4417" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4419" href="Test.Examples.AccountSim.Validator.html#4419" class="Bound">snd</a><a id="4422" class="Symbol">)</a> <a id="4424" class="Symbol">→</a> <a id="4426" href="Test.Examples.AccountSim.Validator.html#3725" class="Function">matchIx?</a> <a id="4435" href="Test.Examples.AccountSim.Validator.html#4379" class="Bound">ph</a> <a id="4438" href="Test.Examples.AccountSim.Validator.html#4413" class="Bound">fst</a><a id="4441" class="Symbol">})</a> <a id="4444" class="Symbol">(</a><a id="4445" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="4449" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4455" class="Symbol">(</a><a id="4456" href="Test.Prelude.html#1924" class="Field">STxInfo.realizedInputs</a> <a id="4479" href="Test.Examples.AccountSim.Validator.html#4367" class="Bound">txinfo</a><a id="4485" class="Symbol">)))</a>

<a id="4490" class="Comment">-- Get the value of txouts for own script</a>
<a id="newValue"></a><a id="4532" href="Test.Examples.AccountSim.Validator.html#4532" class="Function">newValue</a> <a id="4541" class="Symbol">:</a> <a id="4543" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4557" class="Symbol">→</a> <a id="4559" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4565" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="4571" href="Test.Examples.AccountSim.Validator.html#4532" class="Function">newValue</a> <a id="4580" href="Test.Examples.AccountSim.Validator.html#4580" class="Bound">sc</a><a id="4582" class="Symbol">@(</a><a id="4584" href="Test.Examples.AccountSim.Validator.html#4584" class="Bound">txinfo</a> <a id="4591" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4593" href="Test.Examples.AccountSim.Validator.html#4593" class="Bound">sp</a><a id="4595" class="Symbol">)</a> <a id="4597" class="Keyword">with</a> <a id="4602" href="Test.Examples.AccountSim.Validator.html#2927" class="Function">getScriptCredential</a> <a id="4622" href="Test.Examples.AccountSim.Validator.html#4580" class="Bound">sc</a>
<a id="4625" class="Symbol">...</a> <a id="4629" class="Symbol">|</a> <a id="4631" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="4639" class="Symbol">=</a> <a id="4641" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="4649" class="Symbol">...</a> <a id="4653" class="Symbol">|</a> <a id="4655" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4660" href="Test.Examples.AccountSim.Validator.html#4660" class="Bound">sh</a> <a id="4663" class="Symbol">=</a> <a id="4665" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4670" class="Symbol">(</a><a id="4671" href="Test.Examples.AccountSim.Validator.html#4138" class="Function">totalOuts</a> <a id="4681" class="Bound">sc</a> <a id="4684" href="Test.Examples.AccountSim.Validator.html#4660" class="Bound">sh</a><a id="4686" class="Symbol">)</a>

<a id="oldValue"></a><a id="4689" href="Test.Examples.AccountSim.Validator.html#4689" class="Function">oldValue</a> <a id="4698" class="Symbol">:</a> <a id="4700" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4714" class="Symbol">→</a> <a id="4716" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4722" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="4728" href="Test.Examples.AccountSim.Validator.html#4689" class="Function">oldValue</a> <a id="4737" href="Test.Examples.AccountSim.Validator.html#4737" class="Bound">sc</a><a id="4739" class="Symbol">@(</a><a id="4741" href="Test.Examples.AccountSim.Validator.html#4741" class="Bound">txinfo</a> <a id="4748" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4750" href="Test.Examples.AccountSim.Validator.html#4750" class="Bound">sp</a><a id="4752" class="Symbol">)</a> <a id="4754" class="Keyword">with</a> <a id="4759" href="Test.Examples.AccountSim.Validator.html#2927" class="Function">getScriptCredential</a> <a id="4779" href="Test.Examples.AccountSim.Validator.html#4737" class="Bound">sc</a>
<a id="4782" class="Symbol">...</a> <a id="4786" class="Symbol">|</a> <a id="4788" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="4796" class="Symbol">=</a> <a id="4798" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="4806" class="Symbol">...</a> <a id="4810" class="Symbol">|</a> <a id="4812" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4817" href="Test.Examples.AccountSim.Validator.html#4817" class="Bound">sh</a> <a id="4820" class="Symbol">=</a> <a id="4822" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4827" class="Symbol">(</a><a id="4828" href="Test.Examples.AccountSim.Validator.html#4311" class="Function">totalIns</a> <a id="4837" class="Bound">sc</a> <a id="4840" href="Test.Examples.AccountSim.Validator.html#4817" class="Bound">sh</a><a id="4842" class="Symbol">)</a>


<a id="4846" class="Keyword">open</a> <a id="4851" class="Keyword">import</a> <a id="4858" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="checkSigned"></a><a id="4886" href="Test.Examples.AccountSim.Validator.html#4886" class="Function">checkSigned</a> <a id="4898" class="Symbol">:</a> <a id="4900" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4911" class="Symbol">→</a> <a id="4913" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4927" class="Symbol">→</a> <a id="4929" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4934" href="Test.Examples.AccountSim.Validator.html#4886" class="Function">checkSigned</a> <a id="4946" href="Test.Examples.AccountSim.Validator.html#4946" class="Bound">ph</a> <a id="4949" class="Symbol">(</a><a id="4950" href="Test.Examples.AccountSim.Validator.html#4950" class="Bound">txinfo</a> <a id="4957" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4959" class="Symbol">_)</a> <a id="4962" class="Symbol">=</a> <a id="4964" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="4966" class="Symbol">(</a><a id="4967" href="Test.Examples.AccountSim.Validator.html#4946" class="Bound">ph</a> <a id="4970" href="Axiom.Set.html#11038" class="Function Operator">∈?</a> <a id="4973" class="Symbol">(</a><a id="4974" href="Test.Prelude.html#2215" class="Field">STxInfo.vkey</a> <a id="4987" href="Test.Examples.AccountSim.Validator.html#4950" class="Bound">txinfo</a><a id="4993" class="Symbol">))</a> <a id="4996" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="query"></a><a id="4999" href="Test.Examples.AccountSim.Validator.html#4999" class="Function">query</a> <a id="5005" class="Symbol">:</a> <a id="5007" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5018" class="Symbol">→</a> <a id="5020" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5025" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5036" class="Symbol">→</a> <a id="5038" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5043" href="Test.Examples.AccountSim.Validator.html#4999" class="Function">query</a> <a id="5049" href="Test.Examples.AccountSim.Validator.html#5049" class="Bound">ph</a> <a id="5052" href="Test.Examples.AccountSim.Validator.html#5052" class="Bound">xs</a> <a id="5055" class="Symbol">=</a> <a id="5057" href="Data.Bool.ListAction.html#874" class="Function">any</a> <a id="5061" class="Symbol">(λ</a> <a id="5064" href="Test.Examples.AccountSim.Validator.html#5064" class="Bound">k</a> <a id="5066" class="Symbol">→</a>  <a id="5069" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5071" href="Test.Examples.AccountSim.Validator.html#5049" class="Bound">ph</a> <a id="5074" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="5076" href="Test.Examples.AccountSim.Validator.html#5064" class="Bound">k</a> <a id="5078" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a><a id="5079" class="Symbol">)</a> <a id="5081" href="Test.Examples.AccountSim.Validator.html#5052" class="Bound">xs</a>

<a id="checkPayment"></a><a id="5085" href="Test.Examples.AccountSim.Validator.html#5085" class="Function">checkPayment</a> <a id="5098" class="Symbol">:</a> <a id="5100" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5111" class="Symbol">-&gt;</a> <a id="5114" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="5120" class="Symbol">-&gt;</a> <a id="5123" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="5137" class="Symbol">-&gt;</a> <a id="5140" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5145" href="Test.Examples.AccountSim.Validator.html#5085" class="Function">checkPayment</a> <a id="5158" href="Test.Examples.AccountSim.Validator.html#5158" class="Bound">pkh</a> <a id="5162" href="Test.Examples.AccountSim.Validator.html#5162" class="Bound">v</a> <a id="5164" href="Test.Examples.AccountSim.Validator.html#5164" class="Bound">ctx</a> <a id="5168" class="Symbol">=</a> <a id="5170" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5172" href="Test.Examples.AccountSim.Validator.html#4138" class="Function">totalOuts</a> <a id="5182" href="Test.Examples.AccountSim.Validator.html#5164" class="Bound">ctx</a> <a id="5186" href="Test.Examples.AccountSim.Validator.html#5158" class="Bound">pkh</a> <a id="5190" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="5192" class="Symbol">(</a><a id="5193" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="5197" class="Symbol">{{</a><a id="5199" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="5207" class="Symbol">}}</a> <a id="5210" class="Symbol">(</a><a id="5211" href="Test.Examples.AccountSim.Validator.html#4311" class="Function">totalIns</a> <a id="5220" href="Test.Examples.AccountSim.Validator.html#5164" class="Bound">ctx</a> <a id="5224" href="Test.Examples.AccountSim.Validator.html#5158" class="Bound">pkh</a><a id="5227" class="Symbol">)</a> <a id="5229" href="Test.Examples.AccountSim.Validator.html#5162" class="Bound">v</a><a id="5230" class="Symbol">)</a> <a id="5232" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="expired"></a><a id="5235" href="Test.Examples.AccountSim.Validator.html#5235" class="Function">expired</a> <a id="5243" class="Symbol">:</a> <a id="5245" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5247" class="Symbol">-&gt;</a> <a id="5250" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="5264" class="Symbol">-&gt;</a> <a id="5267" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5272" href="Test.Examples.AccountSim.Validator.html#5235" class="Function">expired</a> <a id="5280" href="Test.Examples.AccountSim.Validator.html#5280" class="Bound">slot</a> <a id="5285" class="Symbol">(</a><a id="5286" href="Test.Examples.AccountSim.Validator.html#5286" class="Bound">txinfo</a> <a id="5293" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5295" class="Symbol">_)</a> <a id="5298" class="Symbol">=</a> <a id="5300" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="5306" class="Symbol">(λ</a> <a id="5309" href="Test.Examples.AccountSim.Validator.html#5309" class="Bound">deadline</a> <a id="5318" class="Symbol">→</a>  <a id="5321" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5323" href="Test.Examples.AccountSim.Validator.html#5280" class="Bound">slot</a> <a id="5328" href="Data.Nat.Properties.html#11973" class="Function Operator">&gt;?</a> <a id="5331" href="Test.Examples.AccountSim.Validator.html#5309" class="Bound">deadline</a> <a id="5340" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a><a id="5341" class="Symbol">)</a>
                                     <a id="5380" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
                                     <a id="5423" class="Symbol">(</a><a id="5424" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="5430" class="Symbol">(</a><a id="5431" href="Test.Prelude.html#2164" class="Field">STxInfo.txvldt</a> <a id="5446" href="Test.Examples.AccountSim.Validator.html#5286" class="Bound">txinfo</a><a id="5452" class="Symbol">))</a>



<a id="checkMembership"></a><a id="5458" href="Test.Examples.AccountSim.Validator.html#5458" class="Function">checkMembership</a> <a id="5474" class="Symbol">:</a> <a id="5476" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5482" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="5488" class="Symbol">-&gt;</a> <a id="5491" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5496" href="Test.Examples.AccountSim.Validator.html#5458" class="Function">checkMembership</a> <a id="5512" class="Symbol">(</a><a id="5513" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5518" href="Test.Examples.AccountSim.Validator.html#5518" class="Bound">x</a><a id="5519" class="Symbol">)</a> <a id="5521" class="Symbol">=</a> <a id="5523" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="5528" href="Test.Examples.AccountSim.Validator.html#5458" class="Function">checkMembership</a> <a id="5544" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5552" class="Symbol">=</a> <a id="5554" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="checkEmpty"></a><a id="5561" href="Test.Examples.AccountSim.Validator.html#5561" class="Function">checkEmpty</a> <a id="5572" class="Symbol">:</a> <a id="5574" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5580" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="5586" class="Symbol">-&gt;</a> <a id="5589" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5594" href="Test.Examples.AccountSim.Validator.html#5561" class="Function">checkEmpty</a> <a id="5605" class="Symbol">(</a><a id="5606" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5611" href="Test.Examples.AccountSim.Validator.html#5611" class="Bound">x</a><a id="5612" class="Symbol">)</a> <a id="5614" class="Symbol">=</a> <a id="5616" href="Test.Examples.AccountSim.Validator.html#5611" class="Bound">x</a> <a id="5618" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5621" href="Test.Examples.AccountSim.Validator.html#769" class="Function">emptyValue</a>
<a id="5632" href="Test.Examples.AccountSim.Validator.html#5561" class="Function">checkEmpty</a> <a id="5643" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5651" class="Symbol">=</a> <a id="5653" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="insert&#39;"></a><a id="5660" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="5668" class="Symbol">:</a> <a id="5670" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5681" class="Symbol">-&gt;</a> <a id="5684" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="5690" class="Symbol">-&gt;</a> <a id="5693" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5698" class="Symbol">(</a><a id="5699" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5701" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5703" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="5708" class="Symbol">)</a> <a id="5710" class="Symbol">-&gt;</a> <a id="5713" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5718" class="Symbol">(</a><a id="5719" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5721" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5723" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="5728" class="Symbol">)</a>
<a id="5730" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="5738" href="Test.Examples.AccountSim.Validator.html#5738" class="Bound">pkh</a> <a id="5742" href="Test.Examples.AccountSim.Validator.html#5742" class="Bound">val</a> <a id="5746" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5749" class="Symbol">=</a> <a id="5751" class="Symbol">((</a><a id="5753" href="Test.Examples.AccountSim.Validator.html#5738" class="Bound">pkh</a> <a id="5757" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5759" href="Test.Examples.AccountSim.Validator.html#5742" class="Bound">val</a><a id="5762" class="Symbol">)</a> <a id="5764" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5766" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5768" class="Symbol">)</a>
<a id="5770" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="5778" href="Test.Examples.AccountSim.Validator.html#5778" class="Bound">pkh</a> <a id="5782" href="Test.Examples.AccountSim.Validator.html#5782" class="Bound">val</a> <a id="5786" class="Symbol">((</a><a id="5788" href="Test.Examples.AccountSim.Validator.html#5788" class="Bound">x</a> <a id="5790" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5792" href="Test.Examples.AccountSim.Validator.html#5792" class="Bound">y</a><a id="5793" class="Symbol">)</a> <a id="5795" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5797" href="Test.Examples.AccountSim.Validator.html#5797" class="Bound">xs</a><a id="5799" class="Symbol">)</a> <a id="5801" class="Symbol">=</a> <a id="5803" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="5806" class="Symbol">(</a><a id="5807" href="Test.Examples.AccountSim.Validator.html#5778" class="Bound">pkh</a> <a id="5811" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5814" href="Test.Examples.AccountSim.Validator.html#5788" class="Bound">x</a><a id="5815" class="Symbol">)</a> <a id="5817" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="5822" class="Symbol">((</a><a id="5824" href="Test.Examples.AccountSim.Validator.html#5778" class="Bound">pkh</a> <a id="5828" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5830" href="Test.Examples.AccountSim.Validator.html#5782" class="Bound">val</a><a id="5833" class="Symbol">)</a> <a id="5835" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5837" href="Test.Examples.AccountSim.Validator.html#5797" class="Bound">xs</a><a id="5839" class="Symbol">)</a> <a id="5841" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="5846" class="Symbol">((</a><a id="5848" href="Test.Examples.AccountSim.Validator.html#5788" class="Bound">x</a> <a id="5850" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5852" href="Test.Examples.AccountSim.Validator.html#5792" class="Bound">y</a><a id="5853" class="Symbol">)</a> <a id="5855" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5857" class="Symbol">(</a><a id="5858" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="5866" href="Test.Examples.AccountSim.Validator.html#5778" class="Bound">pkh</a> <a id="5870" href="Test.Examples.AccountSim.Validator.html#5782" class="Bound">val</a> <a id="5874" href="Test.Examples.AccountSim.Validator.html#5797" class="Bound">xs</a><a id="5876" class="Symbol">))</a>
  
<a id="delete&#39;"></a><a id="5882" href="Test.Examples.AccountSim.Validator.html#5882" class="Function">delete&#39;</a> <a id="5890" class="Symbol">:</a> <a id="5892" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5903" class="Symbol">-&gt;</a> <a id="5906" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5911" class="Symbol">(</a><a id="5912" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5914" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5916" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="5921" class="Symbol">)</a> <a id="5923" class="Symbol">-&gt;</a> <a id="5926" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5931" class="Symbol">(</a><a id="5932" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5934" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5936" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="5941" class="Symbol">)</a>
<a id="5943" href="Test.Examples.AccountSim.Validator.html#5882" class="Function">delete&#39;</a> <a id="5951" href="Test.Examples.AccountSim.Validator.html#5951" class="Bound">pkh</a> <a id="5955" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5958" class="Symbol">=</a> <a id="5960" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="5963" href="Test.Examples.AccountSim.Validator.html#5882" class="Function">delete&#39;</a> <a id="5971" href="Test.Examples.AccountSim.Validator.html#5971" class="Bound">pkh</a> <a id="5975" class="Symbol">((</a><a id="5977" href="Test.Examples.AccountSim.Validator.html#5977" class="Bound">x</a> <a id="5979" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5981" href="Test.Examples.AccountSim.Validator.html#5981" class="Bound">y</a><a id="5982" class="Symbol">)</a> <a id="5984" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5986" href="Test.Examples.AccountSim.Validator.html#5986" class="Bound">xs</a><a id="5988" class="Symbol">)</a> <a id="5990" class="Symbol">=</a> <a id="5992" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="5995" class="Symbol">(</a><a id="5996" href="Test.Examples.AccountSim.Validator.html#5971" class="Bound">pkh</a> <a id="6000" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6003" href="Test.Examples.AccountSim.Validator.html#5977" class="Bound">x</a><a id="6004" class="Symbol">)</a>
  <a id="6008" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="6013" href="Test.Examples.AccountSim.Validator.html#5986" class="Bound">xs</a>
  <a id="6018" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="6023" class="Symbol">((</a><a id="6025" href="Test.Examples.AccountSim.Validator.html#5977" class="Bound">x</a> <a id="6027" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6029" href="Test.Examples.AccountSim.Validator.html#5981" class="Bound">y</a><a id="6030" class="Symbol">)</a> <a id="6032" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6034" class="Symbol">(</a><a id="6035" href="Test.Examples.AccountSim.Validator.html#5882" class="Function">delete&#39;</a> <a id="6043" href="Test.Examples.AccountSim.Validator.html#5971" class="Bound">pkh</a> <a id="6047" href="Test.Examples.AccountSim.Validator.html#5986" class="Bound">xs</a><a id="6049" class="Symbol">))</a>

<a id="lookup&#39;"></a><a id="6053" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="6061" class="Symbol">:</a> <a id="6063" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6065" class="Symbol">→</a> <a id="6067" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6072" class="Symbol">(</a><a id="6073" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6075" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6077" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="6082" class="Symbol">)</a> <a id="6084" class="Symbol">→</a> <a id="6086" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6092" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="6098" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="6106" href="Test.Examples.AccountSim.Validator.html#6106" class="Bound">x</a> <a id="6108" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>              <a id="6124" class="Symbol">=</a> <a id="6126" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> 
<a id="6135" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="6143" href="Test.Examples.AccountSim.Validator.html#6143" class="Bound">x</a> <a id="6145" class="Symbol">((</a><a id="6147" href="Test.Examples.AccountSim.Validator.html#6147" class="Bound">x₁</a> <a id="6150" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6152" href="Test.Examples.AccountSim.Validator.html#6152" class="Bound">y</a><a id="6153" class="Symbol">)</a> <a id="6155" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6157" href="Test.Examples.AccountSim.Validator.html#6157" class="Bound">xs</a><a id="6159" class="Symbol">)</a> <a id="6161" class="Symbol">=</a> <a id="6163" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="6166" href="Test.Examples.AccountSim.Validator.html#6143" class="Bound">x</a> <a id="6168" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6171" href="Test.Examples.AccountSim.Validator.html#6147" class="Bound">x₁</a> <a id="6174" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="6179" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6184" href="Test.Examples.AccountSim.Validator.html#6152" class="Bound">y</a> <a id="6186" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="6191" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="6199" href="Test.Examples.AccountSim.Validator.html#6143" class="Bound">x</a> <a id="6201" href="Test.Examples.AccountSim.Validator.html#6157" class="Bound">xs</a>



<a id="checkWithdraw"></a><a id="6207" href="Test.Examples.AccountSim.Validator.html#6207" class="Function">checkWithdraw</a> <a id="6221" class="Symbol">:</a> <a id="6223" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6229" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6235" class="Symbol">-&gt;</a> <a id="6238" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6240" class="Symbol">-&gt;</a> <a id="6243" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6249" class="Symbol">-&gt;</a> <a id="6252" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6258" class="Symbol">-&gt;</a> <a id="6261" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6275" class="Symbol">-&gt;</a> <a id="6278" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6283" href="Test.Examples.AccountSim.Validator.html#6207" class="Function">checkWithdraw</a> <a id="6297" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6305" class="Symbol">_</a> <a id="6307" class="Symbol">_</a> <a id="6309" class="Symbol">_</a> <a id="6311" class="Symbol">_</a> <a id="6313" class="Symbol">=</a> <a id="6315" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6321" href="Test.Examples.AccountSim.Validator.html#6207" class="Function">checkWithdraw</a> <a id="6335" class="Symbol">(</a><a id="6336" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6341" href="Test.Examples.AccountSim.Validator.html#6341" class="Bound">v</a><a id="6342" class="Symbol">)</a> <a id="6344" href="Test.Examples.AccountSim.Validator.html#6344" class="Bound">pkh</a> <a id="6348" href="Test.Examples.AccountSim.Validator.html#6348" class="Bound">val</a> <a id="6352" class="Symbol">(</a><a id="6353" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6360" href="Test.Examples.AccountSim.Validator.html#6360" class="Bound">lab</a><a id="6363" class="Symbol">)</a> <a id="6365" href="Test.Examples.AccountSim.Validator.html#6365" class="Bound">ctx</a> <a id="6369" class="Symbol">=</a> <a id="6371" href="Test.Examples.AccountSim.Validator.html#982" class="Function">geq</a> <a id="6375" href="Test.Examples.AccountSim.Validator.html#6348" class="Bound">val</a> <a id="6379" href="Test.Examples.AccountSim.Validator.html#769" class="Function">emptyValue</a> <a id="6390" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6393" href="Test.Examples.AccountSim.Validator.html#982" class="Function">geq</a> <a id="6397" href="Test.Examples.AccountSim.Validator.html#6341" class="Bound">v</a> <a id="6399" href="Test.Examples.AccountSim.Validator.html#6348" class="Bound">val</a> <a id="6403" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6406" class="Symbol">(</a><a id="6407" href="Test.Examples.AccountSim.Validator.html#1534" class="Function">newLabel</a> <a id="6416" href="Test.Examples.AccountSim.Validator.html#6365" class="Bound">ctx</a> <a id="6420" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6423" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6428" class="Symbol">(</a><a id="6429" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6436" class="Symbol">(</a><a id="6437" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="6445" href="Test.Examples.AccountSim.Validator.html#6344" class="Bound">pkh</a> <a id="6449" class="Symbol">(</a><a id="6450" href="Test.Examples.AccountSim.Validator.html#6341" class="Bound">v</a> <a id="6452" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="6454" href="Test.Examples.AccountSim.Validator.html#6348" class="Bound">val</a><a id="6457" class="Symbol">)</a> <a id="6459" href="Test.Examples.AccountSim.Validator.html#6360" class="Bound">lab</a><a id="6462" class="Symbol">)))</a> 

<a id="checkDeposit"></a><a id="6468" href="Test.Examples.AccountSim.Validator.html#6468" class="Function">checkDeposit</a> <a id="6481" class="Symbol">:</a> <a id="6483" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="6490" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6496" class="Symbol">-&gt;</a> <a id="6499" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6501" class="Symbol">-&gt;</a> <a id="6504" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6510" class="Symbol">-&gt;</a>  <a id="6514" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6520" class="Symbol">-&gt;</a> <a id="6523" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6537" class="Symbol">-&gt;</a> <a id="6540" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6545" href="Test.Examples.AccountSim.Validator.html#6468" class="Function">checkDeposit</a> <a id="6558" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6566" class="Symbol">_</a> <a id="6568" class="Symbol">_</a> <a id="6570" class="Symbol">_</a> <a id="6572" class="Symbol">_</a> <a id="6574" class="Symbol">=</a> <a id="6576" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6582" href="Test.Examples.AccountSim.Validator.html#6468" class="Function">checkDeposit</a> <a id="6595" class="Symbol">(</a><a id="6596" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6601" href="Test.Examples.AccountSim.Validator.html#6601" class="Bound">v</a><a id="6602" class="Symbol">)</a> <a id="6604" href="Test.Examples.AccountSim.Validator.html#6604" class="Bound">pkh</a> <a id="6608" href="Test.Examples.AccountSim.Validator.html#6608" class="Bound">val</a> <a id="6612" class="Symbol">(</a><a id="6613" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6620" href="Test.Examples.AccountSim.Validator.html#6620" class="Bound">lab</a><a id="6623" class="Symbol">)</a> <a id="6625" href="Test.Examples.AccountSim.Validator.html#6625" class="Bound">ctx</a> <a id="6629" class="Symbol">=</a> <a id="6631" href="Test.Examples.AccountSim.Validator.html#982" class="Function">geq</a> <a id="6635" href="Test.Examples.AccountSim.Validator.html#6608" class="Bound">val</a> <a id="6639" href="Test.Examples.AccountSim.Validator.html#769" class="Function">emptyValue</a> <a id="6650" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6653" class="Symbol">(</a><a id="6654" href="Test.Examples.AccountSim.Validator.html#1534" class="Function">newLabel</a> <a id="6663" href="Test.Examples.AccountSim.Validator.html#6625" class="Bound">ctx</a> <a id="6667" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6670" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6675" class="Symbol">(</a> <a id="6677" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6684" class="Symbol">(</a><a id="6685" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="6693" href="Test.Examples.AccountSim.Validator.html#6604" class="Bound">pkh</a> <a id="6697" class="Symbol">(</a><a id="6698" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="6702" class="Symbol">{{</a><a id="6704" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="6712" class="Symbol">}}</a> <a id="6715" href="Test.Examples.AccountSim.Validator.html#6601" class="Bound">v</a> <a id="6717" href="Test.Examples.AccountSim.Validator.html#6608" class="Bound">val</a><a id="6720" class="Symbol">)</a> <a id="6722" href="Test.Examples.AccountSim.Validator.html#6620" class="Bound">lab</a><a id="6725" class="Symbol">)))</a>

<a id="checkTransfer"></a><a id="6730" href="Test.Examples.AccountSim.Validator.html#6730" class="Function">checkTransfer</a> <a id="6744" class="Symbol">:</a> <a id="6746" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6752" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6758" class="Symbol">-&gt;</a> <a id="6761" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6767" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6773" class="Symbol">-&gt;</a> <a id="6776" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6778" class="Symbol">-&gt;</a> <a id="6781" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6783" class="Symbol">-&gt;</a> <a id="6786" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6792" class="Symbol">-&gt;</a> <a id="6795" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6801" class="Symbol">-&gt;</a> <a id="6804" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6818" class="Symbol">-&gt;</a> <a id="6821" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6826" href="Test.Examples.AccountSim.Validator.html#6730" class="Function">checkTransfer</a> <a id="6840" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6848" class="Symbol">_</a> <a id="6850" class="Symbol">_</a> <a id="6852" class="Symbol">_</a> <a id="6854" class="Symbol">_</a> <a id="6856" class="Symbol">_</a> <a id="6858" class="Symbol">_</a> <a id="6860" class="Symbol">=</a> <a id="6862" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6868" href="Test.Examples.AccountSim.Validator.html#6730" class="Function">checkTransfer</a> <a id="6882" class="Symbol">(</a><a id="6883" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6888" href="Test.Examples.AccountSim.Validator.html#6888" class="Bound">vF</a><a id="6890" class="Symbol">)</a> <a id="6892" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6900" class="Symbol">_</a> <a id="6902" class="Symbol">_</a> <a id="6904" class="Symbol">_</a> <a id="6906" class="Symbol">_</a> <a id="6908" class="Symbol">_</a> <a id="6910" class="Symbol">=</a> <a id="6912" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6918" href="Test.Examples.AccountSim.Validator.html#6730" class="Function">checkTransfer</a> <a id="6932" class="Symbol">(</a><a id="6933" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6938" href="Test.Examples.AccountSim.Validator.html#6938" class="Bound">vF</a><a id="6940" class="Symbol">)</a> <a id="6942" class="Symbol">(</a><a id="6943" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6948" href="Test.Examples.AccountSim.Validator.html#6948" class="Bound">vT</a><a id="6950" class="Symbol">)</a> <a id="6952" href="Test.Examples.AccountSim.Validator.html#6952" class="Bound">from</a> <a id="6957" href="Test.Examples.AccountSim.Validator.html#6957" class="Bound">to</a> <a id="6960" href="Test.Examples.AccountSim.Validator.html#6960" class="Bound">val</a> <a id="6964" class="Symbol">(</a><a id="6965" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6972" href="Test.Examples.AccountSim.Validator.html#6972" class="Bound">lab</a><a id="6975" class="Symbol">)</a> <a id="6977" href="Test.Examples.AccountSim.Validator.html#6977" class="Bound">ctx</a> <a id="6981" class="Symbol">=</a> <a id="6983" href="Test.Examples.AccountSim.Validator.html#982" class="Function">geq</a> <a id="6987" href="Test.Examples.AccountSim.Validator.html#6960" class="Bound">val</a> <a id="6991" href="Test.Examples.AccountSim.Validator.html#769" class="Function">emptyValue</a> <a id="7002" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7005" href="Test.Examples.AccountSim.Validator.html#982" class="Function">geq</a> <a id="7009" href="Test.Examples.AccountSim.Validator.html#6938" class="Bound">vF</a> <a id="7012" href="Test.Examples.AccountSim.Validator.html#6960" class="Bound">val</a> <a id="7016" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7019" class="Symbol">(</a><a id="7020" href="Test.Examples.AccountSim.Validator.html#6952" class="Bound">from</a> <a id="7025" href="Class.DecEq.Core.html#260" class="Function Operator">≠</a> <a id="7027" href="Test.Examples.AccountSim.Validator.html#6957" class="Bound">to</a><a id="7029" class="Symbol">)</a> <a id="7031" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7034" class="Symbol">(</a><a id="7035" href="Test.Examples.AccountSim.Validator.html#1534" class="Function">newLabel</a> <a id="7044" href="Test.Examples.AccountSim.Validator.html#6977" class="Bound">ctx</a> <a id="7048" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7051" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7056" class="Symbol">(</a><a id="7057" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7064" class="Symbol">(</a><a id="7065" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="7073" href="Test.Examples.AccountSim.Validator.html#6952" class="Bound">from</a> <a id="7078" class="Symbol">(</a><a id="7079" href="Test.Examples.AccountSim.Validator.html#6938" class="Bound">vF</a> <a id="7082" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7084" href="Test.Examples.AccountSim.Validator.html#6960" class="Bound">val</a><a id="7087" class="Symbol">)</a> <a id="7089" class="Symbol">(</a><a id="7090" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="7098" href="Test.Examples.AccountSim.Validator.html#6957" class="Bound">to</a> <a id="7101" class="Symbol">(</a><a id="7102" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="7106" class="Symbol">{{</a><a id="7108" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="7116" class="Symbol">}}</a> <a id="7119" href="Test.Examples.AccountSim.Validator.html#6948" class="Bound">vT</a> <a id="7122" href="Test.Examples.AccountSim.Validator.html#6960" class="Bound">val</a><a id="7125" class="Symbol">)</a> <a id="7127" href="Test.Examples.AccountSim.Validator.html#6972" class="Bound">lab</a><a id="7130" class="Symbol">))))</a>

<a id="agdaValidator"></a><a id="7136" href="Test.Examples.AccountSim.Validator.html#7136" class="Function">agdaValidator</a> <a id="7150" class="Symbol">:</a> <a id="7152" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="7158" class="Symbol">-&gt;</a> <a id="7161" href="Test.Examples.AccountSim.Datum.html#470" class="Datatype">Input</a> <a id="7167" class="Symbol">-&gt;</a> <a id="7170" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="7184" class="Symbol">-&gt;</a> <a id="7187" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="7192" href="Test.Examples.AccountSim.Validator.html#7136" class="Function">agdaValidator</a> <a id="7206" class="Symbol">(</a><a id="7207" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7214" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="7217" class="Symbol">)</a> <a id="7219" href="Test.Examples.AccountSim.Validator.html#7219" class="Bound">inp</a> <a id="7223" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7227" class="Symbol">=</a> <a id="7229" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="7234" href="Test.Examples.AccountSim.Validator.html#7219" class="Bound">inp</a> <a id="7238" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="7241" class="Symbol">λ</a> <a id="7243" class="Keyword">where</a>

    <a id="7254" class="Symbol">(</a><a id="7255" href="Test.Examples.AccountSim.Datum.html#490" class="InductiveConstructor">Open</a> <a id="7260" href="Test.Examples.AccountSim.Validator.html#7260" class="Bound">pkh</a><a id="7263" class="Symbol">)</a> <a id="7265" class="Symbol">-&gt;</a> <a id="7268" href="Test.Examples.AccountSim.Validator.html#1907" class="Function">continuing</a> <a id="7279" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7283" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7286" class="Symbol">(</a><a id="7287" href="Test.Examples.AccountSim.Validator.html#4886" class="Function">checkSigned</a> <a id="7299" href="Test.Examples.AccountSim.Validator.html#7260" class="Bound">pkh</a> <a id="7303" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="7306" class="Symbol">)</a> <a id="7308" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7311" class="Symbol">(</a><a id="7312" href="Data.Bool.Base.html#951" class="Function">not</a> <a id="7316" class="Symbol">(</a><a id="7317" href="Test.Examples.AccountSim.Validator.html#5458" class="Function">checkMembership</a> <a id="7333" class="Symbol">(</a><a id="7334" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="7342" href="Test.Examples.AccountSim.Validator.html#7260" class="Bound">pkh</a> <a id="7346" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="7349" class="Symbol">)))</a> <a id="7353" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                  <a id="7374" class="Symbol">(</a><a id="7375" href="Test.Examples.AccountSim.Validator.html#1534" class="Function">newLabel</a> <a id="7384" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7388" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7391" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7396" class="Symbol">(</a><a id="7397" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7404" class="Symbol">(</a><a id="7405" href="Test.Examples.AccountSim.Validator.html#5660" class="Function">insert&#39;</a> <a id="7413" href="Test.Examples.AccountSim.Validator.html#7260" class="Bound">pkh</a> <a id="7417" href="Test.Examples.AccountSim.Validator.html#769" class="Function">emptyValue</a> <a id="7428" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="7431" class="Symbol">)))</a> <a id="7435" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7438" class="Symbol">(</a><a id="7439" href="Test.Examples.AccountSim.Validator.html#4532" class="Function">newValue</a> <a id="7448" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7452" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7455" href="Test.Examples.AccountSim.Validator.html#4689" class="Function">oldValue</a> <a id="7464" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="7467" class="Symbol">)</a>

    <a id="7474" class="Symbol">(</a><a id="7475" href="Test.Examples.AccountSim.Datum.html#514" class="InductiveConstructor">Close</a> <a id="7481" href="Test.Examples.AccountSim.Validator.html#7481" class="Bound">pkh</a><a id="7484" class="Symbol">)</a> <a id="7486" class="Symbol">-&gt;</a> <a id="7489" href="Test.Examples.AccountSim.Validator.html#1907" class="Function">continuing</a> <a id="7500" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7504" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7507" class="Symbol">(</a><a id="7508" href="Test.Examples.AccountSim.Validator.html#4886" class="Function">checkSigned</a> <a id="7520" href="Test.Examples.AccountSim.Validator.html#7481" class="Bound">pkh</a> <a id="7524" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="7527" class="Symbol">)</a> <a id="7529" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7532" class="Symbol">(</a><a id="7533" href="Test.Examples.AccountSim.Validator.html#5561" class="Function">checkEmpty</a> <a id="7544" class="Symbol">(</a><a id="7545" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="7553" href="Test.Examples.AccountSim.Validator.html#7481" class="Bound">pkh</a> <a id="7557" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="7560" class="Symbol">))</a> <a id="7563" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                   <a id="7585" class="Symbol">(</a><a id="7586" href="Test.Examples.AccountSim.Validator.html#1534" class="Function">newLabel</a> <a id="7595" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7599" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7602" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7607" class="Symbol">(</a><a id="7608" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7615" class="Symbol">(</a><a id="7616" href="Test.Examples.AccountSim.Validator.html#5882" class="Function">delete&#39;</a> <a id="7624" href="Test.Examples.AccountSim.Validator.html#7481" class="Bound">pkh</a> <a id="7628" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="7631" class="Symbol">)))</a> <a id="7635" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7638" class="Symbol">(</a><a id="7639" href="Test.Examples.AccountSim.Validator.html#4532" class="Function">newValue</a> <a id="7648" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7652" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7655" href="Test.Examples.AccountSim.Validator.html#4689" class="Function">oldValue</a> <a id="7664" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="7667" class="Symbol">)</a>

    <a id="7674" class="Symbol">(</a><a id="7675" href="Test.Examples.AccountSim.Datum.html#538" class="InductiveConstructor">Withdraw</a> <a id="7684" href="Test.Examples.AccountSim.Validator.html#7684" class="Bound">pkh</a> <a id="7688" href="Test.Examples.AccountSim.Validator.html#7688" class="Bound">val</a><a id="7691" class="Symbol">)</a> <a id="7693" class="Symbol">-&gt;</a> <a id="7696" href="Test.Examples.AccountSim.Validator.html#1907" class="Function">continuing</a> <a id="7707" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7711" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7714" class="Symbol">(</a><a id="7715" href="Test.Examples.AccountSim.Validator.html#4886" class="Function">checkSigned</a> <a id="7727" href="Test.Examples.AccountSim.Validator.html#7684" class="Bound">pkh</a> <a id="7731" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="7734" class="Symbol">)</a> <a id="7736" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7739" class="Symbol">(</a><a id="7740" href="Test.Examples.AccountSim.Validator.html#6207" class="Function">checkWithdraw</a> <a id="7754" class="Symbol">(</a><a id="7755" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="7763" href="Test.Examples.AccountSim.Validator.html#7684" class="Bound">pkh</a> <a id="7767" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="7770" class="Symbol">)</a> <a id="7772" href="Test.Examples.AccountSim.Validator.html#7684" class="Bound">pkh</a> <a id="7776" href="Test.Examples.AccountSim.Validator.html#7688" class="Bound">val</a> <a id="7780" class="Symbol">(</a><a id="7781" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7788" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="7791" class="Symbol">)</a> <a id="7793" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="7796" class="Symbol">)</a> <a id="7798" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                          <a id="7827" class="Symbol">((</a><a id="7829" href="Test.Examples.AccountSim.Validator.html#291" class="Function">maybeMap</a> <a id="7838" class="Symbol">(</a><a id="7839" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="7843" class="Symbol">{{</a><a id="7845" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="7853" class="Symbol">}}</a> <a id="7856" href="Test.Examples.AccountSim.Validator.html#7688" class="Bound">val</a><a id="7859" class="Symbol">)</a> <a id="7861" class="Symbol">(</a><a id="7862" href="Test.Examples.AccountSim.Validator.html#4532" class="Function">newValue</a> <a id="7871" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="7874" class="Symbol">))</a> <a id="7877" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7880" href="Test.Examples.AccountSim.Validator.html#4689" class="Function">oldValue</a> <a id="7889" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7893" class="Symbol">)</a>

    <a id="7900" class="Symbol">(</a><a id="7901" href="Test.Examples.AccountSim.Datum.html#567" class="InductiveConstructor">Deposit</a> <a id="7909" href="Test.Examples.AccountSim.Validator.html#7909" class="Bound">pkh</a> <a id="7913" href="Test.Examples.AccountSim.Validator.html#7913" class="Bound">val</a><a id="7916" class="Symbol">)</a> <a id="7918" class="Symbol">-&gt;</a> <a id="7921" href="Test.Examples.AccountSim.Validator.html#1907" class="Function">continuing</a> <a id="7932" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7936" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7939" href="Test.Examples.AccountSim.Validator.html#4886" class="Function">checkSigned</a> <a id="7951" href="Test.Examples.AccountSim.Validator.html#7909" class="Bound">pkh</a> <a id="7955" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="7959" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7962" href="Test.Examples.AccountSim.Validator.html#6468" class="Function">checkDeposit</a> <a id="7975" class="Symbol">(</a><a id="7976" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="7984" href="Test.Examples.AccountSim.Validator.html#7909" class="Bound">pkh</a> <a id="7988" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="7991" class="Symbol">)</a> <a id="7993" href="Test.Examples.AccountSim.Validator.html#7909" class="Bound">pkh</a> <a id="7997" href="Test.Examples.AccountSim.Validator.html#7913" class="Bound">val</a> <a id="8001" class="Symbol">(</a><a id="8002" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="8009" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="8012" class="Symbol">)</a> <a id="8014" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="8018" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                         <a id="8046" class="Symbol">(</a><a id="8047" href="Test.Examples.AccountSim.Validator.html#4532" class="Function">newValue</a> <a id="8056" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="8060" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8063" class="Symbol">(</a><a id="8064" href="Test.Examples.AccountSim.Validator.html#291" class="Function">maybeMap</a> <a id="8073" class="Symbol">(</a><a id="8074" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="8078" class="Symbol">{{</a><a id="8080" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="8088" class="Symbol">}}</a> <a id="8091" href="Test.Examples.AccountSim.Validator.html#7913" class="Bound">val</a><a id="8094" class="Symbol">)</a> <a id="8096" class="Symbol">(</a><a id="8097" href="Test.Examples.AccountSim.Validator.html#4689" class="Function">oldValue</a> <a id="8106" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="8109" class="Symbol">)))</a> 

    <a id="8119" class="Symbol">(</a><a id="8120" href="Test.Examples.AccountSim.Datum.html#596" class="InductiveConstructor">Transfer</a> <a id="8129" href="Test.Examples.AccountSim.Validator.html#8129" class="Bound">from</a> <a id="8134" href="Test.Examples.AccountSim.Validator.html#8134" class="Bound">to</a> <a id="8137" href="Test.Examples.AccountSim.Validator.html#8137" class="Bound">val</a><a id="8140" class="Symbol">)</a> <a id="8142" class="Symbol">-&gt;</a> <a id="8145" href="Test.Examples.AccountSim.Validator.html#1907" class="Function">continuing</a> <a id="8156" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="8160" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="8163" href="Test.Examples.AccountSim.Validator.html#4886" class="Function">checkSigned</a> <a id="8175" href="Test.Examples.AccountSim.Validator.html#8129" class="Bound">from</a> <a id="8180" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="8184" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                              <a id="8217" href="Test.Examples.AccountSim.Validator.html#6730" class="Function">checkTransfer</a> <a id="8231" class="Symbol">(</a><a id="8232" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="8240" href="Test.Examples.AccountSim.Validator.html#8129" class="Bound">from</a> <a id="8245" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="8248" class="Symbol">)</a> <a id="8250" class="Symbol">(</a><a id="8251" href="Test.Examples.AccountSim.Validator.html#6053" class="Function">lookup&#39;</a> <a id="8259" href="Test.Examples.AccountSim.Validator.html#8134" class="Bound">to</a> <a id="8262" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="8265" class="Symbol">)</a> <a id="8267" href="Test.Examples.AccountSim.Validator.html#8129" class="Bound">from</a> <a id="8272" href="Test.Examples.AccountSim.Validator.html#8134" class="Bound">to</a> <a id="8275" href="Test.Examples.AccountSim.Validator.html#8137" class="Bound">val</a> <a id="8279" class="Symbol">(</a><a id="8280" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="8287" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a><a id="8290" class="Symbol">)</a> <a id="8292" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="8296" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                              <a id="8329" class="Symbol">(</a><a id="8330" href="Test.Examples.AccountSim.Validator.html#4532" class="Function">newValue</a> <a id="8339" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a> <a id="8343" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8346" href="Test.Examples.AccountSim.Validator.html#4689" class="Function">oldValue</a> <a id="8355" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="8358" class="Symbol">)</a> 

    <a id="8366" href="Test.Examples.AccountSim.Datum.html#630" class="InductiveConstructor">Cleanup</a> <a id="8374" class="Symbol">-&gt;</a> <a id="8377" href="Data.Bool.Base.html#951" class="Function">not</a> <a id="8381" class="Symbol">(</a><a id="8382" href="Test.Examples.AccountSim.Validator.html#1907" class="Function">continuing</a> <a id="8393" href="Test.Examples.AccountSim.Validator.html#7223" class="Bound">ctx</a><a id="8396" class="Symbol">)</a> <a id="8398" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="8401" class="Symbol">(</a><a id="8402" href="Test.Examples.AccountSim.Validator.html#7214" class="Bound">lab</a> <a id="8406" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8409" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8411" class="Symbol">)</a>


<a id="accSimValidator"></a><a id="8415" href="Test.Examples.AccountSim.Validator.html#8415" class="Function">accSimValidator</a> <a id="8431" class="Symbol">:</a> <a id="8433" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="8439" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8445" class="Symbol">→</a> <a id="8447" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="8453" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8459" class="Symbol">→</a> <a id="8461" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8466" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8472" class="Symbol">→</a> <a id="8474" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="8479" href="Test.Examples.AccountSim.Validator.html#8415" class="Function">accSimValidator</a> <a id="8495" class="Symbol">(</a><a id="8496" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8501" class="Symbol">(</a><a id="8502" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8507" class="Symbol">(</a><a id="8508" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8513" href="Test.Examples.AccountSim.Validator.html#8513" class="Bound">x</a><a id="8514" class="Symbol">)))</a> <a id="8518" class="Symbol">(</a><a id="8519" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8524" class="Symbol">(</a><a id="8525" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8530" class="Symbol">(</a><a id="8531" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="8536" href="Test.Examples.AccountSim.Validator.html#8536" class="Bound">y</a><a id="8537" class="Symbol">)))</a> <a id="8541" class="Symbol">(</a><a id="8542" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="8547" href="Test.Examples.AccountSim.Validator.html#8547" class="Bound">y₁</a> <a id="8550" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8552" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8554" class="Symbol">)</a> <a id="8556" class="Symbol">=</a>
  <a id="8560" href="Test.Examples.AccountSim.Validator.html#7136" class="Function">agdaValidator</a> <a id="8574" href="Test.Examples.AccountSim.Validator.html#8513" class="Bound">x</a> <a id="8576" href="Test.Examples.AccountSim.Validator.html#8536" class="Bound">y</a> <a id="8578" href="Test.Examples.AccountSim.Validator.html#8547" class="Bound">y₁</a>
<a id="8581" href="Test.Examples.AccountSim.Validator.html#8415" class="CatchallClause Function">accSimValidator</a><a id="8596" class="CatchallClause"> </a><a id="8597" class="CatchallClause Symbol">_</a><a id="8598" class="CatchallClause"> </a><a id="8599" class="CatchallClause Symbol">_</a><a id="8600" class="CatchallClause"> </a><a id="8601" class="CatchallClause Symbol">_</a> <a id="8603" class="Symbol">=</a> <a id="8605" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

</pre></body></html>