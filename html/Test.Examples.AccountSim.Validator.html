<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Test.Examples.AccountSim.Validator</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Comment">-- Validator Simulating Accounts on Cardano based on Agda2hs work</a>

<a id="92" class="Keyword">module</a> <a id="99" href="Test.Examples.AccountSim.Validator.html" class="Module">Test.Examples.AccountSim.Validator</a> <a id="134" class="Keyword">where</a>

<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="168" class="Keyword">renaming</a> <a id="177" class="Symbol">(</a><a id="178" href="Data.Bool.Base.html#1005" class="Function Operator">_∧_</a> <a id="182" class="Symbol">to</a> <a id="185" class="Function Operator">_&amp;&amp;_</a><a id="189" class="Symbol">)</a> <a id="191" class="Keyword">hiding</a> <a id="198" class="Symbol">(</a><a id="199" href="Data.Bool.Base.html#1515" class="Function Operator">if_then_else_</a><a id="212" class="Symbol">)</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.List.html" class="Module">Data.List</a> <a id="236" class="Keyword">using</a> <a id="242" class="Symbol">(</a><a id="243" href="Data.List.Base.html#10389" class="Function">filter</a><a id="249" class="Symbol">)</a>
<a id="251" class="Keyword">open</a> <a id="256" class="Keyword">import</a> <a id="263" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="274" class="Keyword">renaming</a> <a id="283" class="Symbol">(</a><a id="284" href="Data.Maybe.Base.html#1934" class="Function">map</a> <a id="288" class="Symbol">to</a> <a id="291" class="Function">maybeMap</a><a id="299" class="Symbol">)</a>

<a id="302" class="Keyword">open</a> <a id="307" class="Keyword">import</a> <a id="314" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Test.Examples.AccountSim.Datum.html" class="Module">Test.Examples.AccountSim.Datum</a>
<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Test.Prelude.html" class="Module">Test.Prelude</a> <a id="397" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Test.SymbolicData.html" class="Module">Test.SymbolicData</a> <a id="442" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>

<a id="458" class="Keyword">import</a> <a id="465" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="482" class="Symbol">as</a> <a id="485" class="Module">N</a>

<a id="PubKeyHash"></a><a id="488" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="499" class="Symbol">:</a> <a id="501" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="506" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="517" class="Symbol">=</a> <a id="519" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="522" class="Keyword">instance</a>
  <a id="ShowAccountSimData"></a><a id="533" href="Test.Examples.AccountSim.Validator.html#533" class="Function">ShowAccountSimData</a> <a id="552" class="Symbol">:</a> <a id="554" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="559" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>
  <a id="576" href="Test.Examples.AccountSim.Validator.html#533" class="Function">ShowAccountSimData</a> <a id="595" class="Symbol">=</a> <a id="597" href="Class.Show.Core.html#172" class="InductiveConstructor">mkShow</a> <a id="604" class="Symbol">(λ</a> <a id="607" href="Test.Examples.AccountSim.Validator.html#607" class="Bound">x</a> <a id="609" class="Symbol">→</a> <a id="611" class="String">&quot;&quot;</a><a id="613" class="Symbol">)</a>

<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="Test.LedgerImplementation.html" class="Module">Test.LedgerImplementation</a> <a id="654" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="660" href="Test.SymbolicData.html#240" class="Function">SData</a>
<a id="666" class="Keyword">open</a> <a id="671" class="Keyword">import</a> <a id="678" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="717" class="Keyword">open</a> <a id="722" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="743" href="Test.LedgerImplementation.html#4275" class="Function">SVTransactionStructure</a>

<a id="emptyValue"></a><a id="767" href="Test.Examples.AccountSim.Validator.html#767" class="Function">emptyValue</a> <a id="778" class="Symbol">:</a> <a id="780" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="786" href="Test.Examples.AccountSim.Validator.html#767" class="Function">emptyValue</a> <a id="797" class="Symbol">=</a> <a id="799" class="Number">0</a>

<a id="feeValue"></a><a id="802" href="Test.Examples.AccountSim.Validator.html#802" class="Function">feeValue</a> <a id="811" class="Symbol">:</a> <a id="813" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="819" href="Test.Examples.AccountSim.Validator.html#802" class="Function">feeValue</a> <a id="828" class="Symbol">=</a> <a id="830" class="Number">10000000000</a>

<a id="startValue"></a><a id="843" href="Test.Examples.AccountSim.Validator.html#843" class="Function">startValue</a> <a id="854" class="Symbol">:</a> <a id="856" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="862" href="Test.Examples.AccountSim.Validator.html#843" class="Function">startValue</a> <a id="873" class="Symbol">=</a> <a id="875" class="Number">1000000000000</a>

<a id="scriptValue"></a><a id="890" href="Test.Examples.AccountSim.Validator.html#890" class="Function">scriptValue</a> <a id="902" class="Symbol">:</a> <a id="904" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="910" href="Test.Examples.AccountSim.Validator.html#890" class="Function">scriptValue</a> <a id="922" class="Symbol">=</a> <a id="924" class="Number">30000000000</a>

<a id="adaValueOf"></a><a id="937" href="Test.Examples.AccountSim.Validator.html#937" class="Function">adaValueOf</a> <a id="948" class="Symbol">:</a> <a id="950" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="952" class="Symbol">-&gt;</a> <a id="955" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="961" href="Test.Examples.AccountSim.Validator.html#937" class="Function">adaValueOf</a> <a id="972" href="Test.Examples.AccountSim.Validator.html#972" class="Bound">n</a> <a id="974" class="Symbol">=</a> <a id="976" href="Test.Examples.AccountSim.Validator.html#972" class="Bound">n</a>


<a id="geq"></a><a id="980" href="Test.Examples.AccountSim.Validator.html#980" class="Function">geq</a> <a id="984" class="Symbol">:</a> <a id="986" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="992" class="Symbol">-&gt;</a> <a id="995" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="1001" class="Symbol">-&gt;</a> <a id="1004" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1009" href="Test.Examples.AccountSim.Validator.html#980" class="Function">geq</a> <a id="1013" href="Test.Examples.AccountSim.Validator.html#1013" class="Bound">v1</a> <a id="1016" href="Test.Examples.AccountSim.Validator.html#1016" class="Bound">v2</a> <a id="1019" class="Symbol">=</a>  <a id="1022" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="1024" href="Test.Examples.AccountSim.Validator.html#1013" class="Bound">v1</a> <a id="1027" href="Data.Nat.Properties.html#6984" class="Function Operator">≥?</a> <a id="1030" href="Test.Examples.AccountSim.Validator.html#1016" class="Bound">v2</a> <a id="1033" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="subVal"></a><a id="1036" href="Test.Examples.AccountSim.Validator.html#1036" class="Function">subVal</a> <a id="1043" class="Symbol">:</a> <a id="1045" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="1051" class="Symbol">-&gt;</a> <a id="1054" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="1060" class="Symbol">-&gt;</a> <a id="1063" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="1069" href="Test.Examples.AccountSim.Validator.html#1036" class="Function">subVal</a> <a id="1076" href="Test.Examples.AccountSim.Validator.html#1076" class="Bound">v1</a> <a id="1079" href="Test.Examples.AccountSim.Validator.html#1079" class="Bound">v2</a> <a id="1082" class="Symbol">=</a> <a id="1084" href="Test.Examples.AccountSim.Validator.html#1076" class="Bound">v1</a> <a id="1087" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="1089" href="Test.Examples.AccountSim.Validator.html#1079" class="Bound">v2</a>

<a id="1093" class="Keyword">instance</a> <a id="ValueSub"></a><a id="1102" href="Test.Examples.AccountSim.Validator.html#1102" class="Function">ValueSub</a> <a id="1111" class="Symbol">:</a> <a id="1113" href="Interface.TypeClasses.HasSubtract.html#162" class="Record">HasSubtract</a> <a id="1125" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="1131" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
         <a id="1146" href="Test.Examples.AccountSim.Validator.html#1102" class="Function">ValueSub</a> <a id="1155" class="Symbol">=</a> <a id="1157" class="Keyword">record</a> <a id="1164" class="Symbol">{</a> <a id="1166" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">_-_</a> <a id="1170" class="Symbol">=</a> <a id="1172" class="Symbol">λ</a> <a id="1174" href="Test.Examples.AccountSim.Validator.html#1174" class="Bound">x</a> <a id="1176" href="Test.Examples.AccountSim.Validator.html#1176" class="Bound">y</a> <a id="1178" class="Symbol">→</a> <a id="1180" href="Test.Examples.AccountSim.Validator.html#1036" class="Function">subVal</a> <a id="1187" href="Test.Examples.AccountSim.Validator.html#1174" class="Bound">x</a> <a id="1189" href="Test.Examples.AccountSim.Validator.html#1176" class="Bound">y</a> <a id="1191" class="Symbol">}</a> <a id="1193" class="Comment">--subVal</a>


<a id="getInlineOutputDatum"></a><a id="1204" href="Test.Examples.AccountSim.Validator.html#1204" class="Function">getInlineOutputDatum</a> <a id="1225" class="Symbol">:</a> <a id="1227" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="1234" class="Symbol">→</a> <a id="1236" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1241" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a> <a id="1256" class="Symbol">→</a> <a id="1258" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1264" href="Ledger.Core.Specification.Script.Base.html#1768" class="Function">Datum</a>
<a id="1270" href="Test.Examples.AccountSim.Validator.html#1204" class="Function">getInlineOutputDatum</a> <a id="1291" class="Symbol">(</a><a id="1292" href="Test.Examples.AccountSim.Validator.html#1292" class="Bound">a</a> <a id="1294" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1296" href="Test.Examples.AccountSim.Validator.html#1296" class="Bound">b</a> <a id="1298" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1300" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1305" class="Symbol">(</a><a id="1306" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1311" class="Symbol">(</a><a id="1312" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1317" href="Test.Examples.AccountSim.Validator.html#1317" class="Bound">x</a><a id="1318" class="Symbol">)))</a> <a id="1322" href="Test.Examples.AccountSim.Validator.html#1322" class="Bound">dats</a> <a id="1327" class="Symbol">=</a> <a id="1329" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1334" class="Symbol">(</a><a id="1335" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1340" class="Symbol">(</a><a id="1341" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1346" href="Test.Examples.AccountSim.Validator.html#1317" class="Bound">x</a><a id="1347" class="Symbol">))</a>
<a id="1350" href="Test.Examples.AccountSim.Validator.html#1204" class="Function">getInlineOutputDatum</a> <a id="1371" class="Symbol">(</a><a id="1372" href="Test.Examples.AccountSim.Validator.html#1372" class="Bound">a</a> <a id="1374" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1376" href="Test.Examples.AccountSim.Validator.html#1376" class="Bound">b</a> <a id="1378" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1380" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1385" class="Symbol">(</a><a id="1386" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1391" class="Symbol">(</a><a id="1392" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1397" href="Test.Examples.AccountSim.Validator.html#1397" class="Bound">y</a><a id="1398" class="Symbol">)))</a> <a id="1402" href="Test.Examples.AccountSim.Validator.html#1402" class="Bound">dats</a> <a id="1407" class="Symbol">=</a> <a id="1409" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1417" href="Test.Examples.AccountSim.Validator.html#1204" class="Function">getInlineOutputDatum</a> <a id="1438" class="Symbol">(</a><a id="1439" href="Test.Examples.AccountSim.Validator.html#1439" class="Bound">a</a> <a id="1441" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1443" href="Test.Examples.AccountSim.Validator.html#1443" class="Bound">b</a> <a id="1445" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1447" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1452" class="Symbol">(</a><a id="1453" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1458" href="Test.Examples.AccountSim.Validator.html#1458" class="Bound">y</a><a id="1459" class="Symbol">))</a> <a id="1462" href="Test.Examples.AccountSim.Validator.html#1462" class="Bound">dats</a> <a id="1467" class="Symbol">=</a> <a id="1469" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1477" href="Test.Examples.AccountSim.Validator.html#1204" class="Function">getInlineOutputDatum</a> <a id="1498" class="Symbol">(</a><a id="1499" href="Test.Examples.AccountSim.Validator.html#1499" class="Bound">a</a> <a id="1501" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1503" href="Test.Examples.AccountSim.Validator.html#1503" class="Bound">b</a> <a id="1505" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1507" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="1514" class="Symbol">)</a> <a id="1516" href="Test.Examples.AccountSim.Validator.html#1516" class="Bound">dats</a> <a id="1521" class="Symbol">=</a> <a id="1523" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="newLabel"></a><a id="1532" href="Test.Examples.AccountSim.Validator.html#1532" class="Function">newLabel</a> <a id="1541" class="Symbol">:</a> <a id="1543" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="1557" class="Symbol">-&gt;</a> <a id="1560" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1566" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a>
<a id="1572" href="Test.Examples.AccountSim.Validator.html#1532" class="Function">newLabel</a> <a id="1581" class="Symbol">(</a><a id="1582" class="Keyword">record</a> <a id="1589" class="Symbol">{</a> <a id="1591" href="Test.Prelude.html#1924" class="Field">realizedInputs</a> <a id="1606" class="Symbol">=</a> <a id="1608" href="Test.Examples.AccountSim.Validator.html#1608" class="Bound">realizedInputs</a> <a id="1623" class="Symbol">;</a> <a id="1625" href="Test.Prelude.html#1955" class="Field">txouts</a> <a id="1632" class="Symbol">=</a> <a id="1634" href="Test.Examples.AccountSim.Validator.html#1634" class="Bound">txouts</a> <a id="1641" class="Symbol">;</a> <a id="1643" href="Test.Prelude.html#2000" class="Field">fee</a> <a id="1647" class="Symbol">=</a> <a id="1649" href="Test.Examples.AccountSim.Validator.html#1649" class="Bound">fee</a> <a id="1653" class="Symbol">;</a> <a id="1655" href="Test.Prelude.html#2032" class="Field">mint</a> <a id="1660" class="Symbol">=</a> <a id="1662" href="Test.Examples.AccountSim.Validator.html#1662" class="Bound">mint</a> <a id="1667" class="Symbol">;</a> <a id="1669" href="Test.Prelude.html#2109" class="Field">txwdrls</a> <a id="1677" class="Symbol">=</a> <a id="1679" href="Test.Examples.AccountSim.Validator.html#1679" class="Bound">txwdrls</a> <a id="1687" class="Symbol">;</a> <a id="1689" href="Test.Prelude.html#2164" class="Field">txvldt</a> <a id="1696" class="Symbol">=</a> <a id="1698" href="Test.Examples.AccountSim.Validator.html#1698" class="Bound">txvldt</a> <a id="1705" class="Symbol">;</a> <a id="1707" href="Test.Prelude.html#2215" class="Field">vkey</a> <a id="1712" class="Symbol">=</a> <a id="1714" href="Test.Examples.AccountSim.Validator.html#1714" class="Bound">vkey</a> <a id="1719" class="Symbol">;</a> <a id="1721" href="Test.Prelude.html#2251" class="Field">txdats</a> <a id="1728" class="Symbol">=</a> <a id="1730" href="Test.Examples.AccountSim.Validator.html#1730" class="Bound">txdats</a> <a id="1737" class="Symbol">;</a> <a id="1739" href="Test.Prelude.html#2356" class="Field">txid</a> <a id="1744" class="Symbol">=</a> <a id="1746" href="Test.Examples.AccountSim.Validator.html#1746" class="Bound">txid</a> <a id="1751" class="Symbol">}</a> <a id="1753" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1755" href="Test.Examples.AccountSim.Validator.html#1755" class="Bound">snd</a><a id="1758" class="Symbol">)</a> <a id="1760" class="Keyword">with</a>
  <a id="1767" href="Data.List.Base.html#4606" class="Function">mapMaybe</a> <a id="1776" class="Symbol">(λ</a> <a id="1779" href="Test.Examples.AccountSim.Validator.html#1779" class="Bound">x</a> <a id="1781" class="Symbol">→</a> <a id="1783" href="Test.Examples.AccountSim.Validator.html#1204" class="Function">getInlineOutputDatum</a> <a id="1804" href="Test.Examples.AccountSim.Validator.html#1779" class="Bound">x</a> <a id="1806" href="Test.Examples.AccountSim.Validator.html#1730" class="Bound">txdats</a><a id="1812" class="Symbol">)</a> <a id="1814" class="Symbol">(</a><a id="1815" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1819" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1825" href="Test.Examples.AccountSim.Validator.html#1634" class="Bound">txouts</a><a id="1831" class="Symbol">)</a>
<a id="1833" class="Symbol">...</a> <a id="1837" class="Symbol">|</a> <a id="1839" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1842" class="Symbol">=</a> <a id="1844" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1852" class="Symbol">...</a> <a id="1856" class="Symbol">|</a> <a id="1858" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1863" class="Symbol">(</a><a id="1864" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1869" href="Test.Examples.AccountSim.Validator.html#1869" class="Bound">x</a><a id="1870" class="Symbol">)</a> <a id="1872" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1874" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1877" class="Symbol">=</a> <a id="1879" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1884" href="Test.Examples.AccountSim.Validator.html#1869" class="Bound">x</a>
<a id="1886" class="CatchallClause Symbol">...</a><a id="1889" class="CatchallClause"> </a><a id="1890" class="CatchallClause Symbol">|</a><a id="1891" class="CatchallClause"> </a><a id="1892" class="CatchallClause Symbol">_</a> <a id="1894" class="Symbol">=</a> <a id="1896" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="continuing"></a><a id="1905" href="Test.Examples.AccountSim.Validator.html#1905" class="Function">continuing</a> <a id="1916" class="Symbol">:</a> <a id="1918" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="1932" class="Symbol">-&gt;</a> <a id="1935" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1940" href="Test.Examples.AccountSim.Validator.html#1905" class="Function">continuing</a> <a id="1951" class="Symbol">(</a><a id="1952" class="Keyword">record</a> <a id="1959" class="Symbol">{</a> <a id="1961" href="Test.Prelude.html#1924" class="Field">realizedInputs</a> <a id="1976" class="Symbol">=</a> <a id="1978" href="Test.Examples.AccountSim.Validator.html#1978" class="Bound">realizedInputs</a> <a id="1993" class="Symbol">;</a> <a id="1995" href="Test.Prelude.html#1955" class="Field">txouts</a> <a id="2002" class="Symbol">=</a> <a id="2004" href="Test.Examples.AccountSim.Validator.html#2004" class="Bound">txouts</a> <a id="2011" class="Symbol">;</a> <a id="2013" href="Test.Prelude.html#2000" class="Field">fee</a> <a id="2017" class="Symbol">=</a> <a id="2019" href="Test.Examples.AccountSim.Validator.html#2019" class="Bound">fee</a> <a id="2023" class="Symbol">;</a> <a id="2025" href="Test.Prelude.html#2032" class="Field">mint</a> <a id="2030" class="Symbol">=</a> <a id="2032" href="Test.Examples.AccountSim.Validator.html#2032" class="Bound">mint</a> <a id="2037" class="Symbol">;</a> <a id="2039" href="Test.Prelude.html#2109" class="Field">txwdrls</a> <a id="2047" class="Symbol">=</a> <a id="2049" href="Test.Examples.AccountSim.Validator.html#2049" class="Bound">txwdrls</a> <a id="2057" class="Symbol">;</a> <a id="2059" href="Test.Prelude.html#2164" class="Field">txvldt</a> <a id="2066" class="Symbol">=</a> <a id="2068" href="Test.Examples.AccountSim.Validator.html#2068" class="Bound">txvldt</a> <a id="2075" class="Symbol">;</a> <a id="2077" href="Test.Prelude.html#2215" class="Field">vkey</a> <a id="2082" class="Symbol">=</a> <a id="2084" href="Test.Examples.AccountSim.Validator.html#2084" class="Bound">vkey</a> <a id="2089" class="Symbol">;</a> <a id="2091" href="Test.Prelude.html#2251" class="Field">txdats</a> <a id="2098" class="Symbol">=</a> <a id="2100" href="Test.Examples.AccountSim.Validator.html#2100" class="Bound">txdats</a> <a id="2107" class="Symbol">;</a> <a id="2109" href="Test.Prelude.html#2356" class="Field">txid</a> <a id="2114" class="Symbol">=</a> <a id="2116" href="Test.Examples.AccountSim.Validator.html#2116" class="Bound">txid</a> <a id="2121" class="Symbol">}</a> <a id="2123" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2125" href="Test.Examples.AccountSim.Validator.html#2125" class="Bound">snd</a><a id="2128" class="Symbol">)</a> <a id="2130" class="Keyword">with</a>
  <a id="2137" href="Data.List.Base.html#4606" class="Function">mapMaybe</a> <a id="2146" class="Symbol">(λ</a> <a id="2149" href="Test.Examples.AccountSim.Validator.html#2149" class="Bound">x</a> <a id="2151" class="Symbol">→</a> <a id="2153" href="Test.Examples.AccountSim.Validator.html#1204" class="Function">getInlineOutputDatum</a> <a id="2174" href="Test.Examples.AccountSim.Validator.html#2149" class="Bound">x</a> <a id="2176" href="Test.Examples.AccountSim.Validator.html#2100" class="Bound">txdats</a><a id="2182" class="Symbol">)</a> <a id="2184" class="Symbol">(</a><a id="2185" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2189" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2195" href="Test.Examples.AccountSim.Validator.html#2004" class="Bound">txouts</a><a id="2201" class="Symbol">)</a>
<a id="2203" class="Symbol">...</a> <a id="2207" class="Symbol">|</a> <a id="2209" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2212" class="Symbol">=</a> <a id="2214" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="2220" class="CatchallClause Symbol">...</a><a id="2223" class="CatchallClause"> </a><a id="2224" class="CatchallClause Symbol">|</a><a id="2225" class="CatchallClause"> </a><a id="2226" class="CatchallClause Symbol">_</a> <a id="2228" class="Symbol">=</a> <a id="2230" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>


<a id="getPaymentCredential"></a><a id="2237" href="Test.Examples.AccountSim.Validator.html#2237" class="Function">getPaymentCredential</a> <a id="2258" class="Symbol">:</a> <a id="2260" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="2267" class="Symbol">→</a> <a id="2269" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2271" href="Test.Examples.AccountSim.Validator.html#2237" class="Function">getPaymentCredential</a> <a id="2292" class="Symbol">(</a><a id="2293" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2298" class="Keyword">record</a> <a id="2305" class="Symbol">{</a> <a id="2307" href="Test.Prelude.html#730" class="Field">net</a> <a id="2311" class="Symbol">=</a> <a id="2313" href="Test.Examples.AccountSim.Validator.html#2313" class="Bound">net</a> <a id="2317" class="Symbol">;</a> <a id="2319" href="Test.Prelude.html#756" class="Field">pay</a> <a id="2323" class="Symbol">=</a> <a id="2325" class="Symbol">(</a><a id="2326" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="2337" href="Test.Examples.AccountSim.Validator.html#2337" class="Bound">x</a><a id="2338" class="Symbol">)</a> <a id="2340" class="Symbol">;</a> <a id="2342" href="Test.Prelude.html#785" class="Field">stake</a> <a id="2348" class="Symbol">=</a> <a id="2350" href="Test.Examples.AccountSim.Validator.html#2350" class="Bound">stake</a> <a id="2356" class="Symbol">}</a> <a id="2358" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2360" href="Test.Examples.AccountSim.Validator.html#2360" class="Bound">snd</a><a id="2363" class="Symbol">)</a> <a id="2365" class="Symbol">=</a> <a id="2367" href="Test.Examples.AccountSim.Validator.html#2337" class="Bound">x</a>
<a id="2369" href="Test.Examples.AccountSim.Validator.html#2237" class="Function">getPaymentCredential</a> <a id="2390" class="Symbol">(</a><a id="2391" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2396" class="Keyword">record</a> <a id="2403" class="Symbol">{</a> <a id="2405" href="Test.Prelude.html#730" class="Field">net</a> <a id="2409" class="Symbol">=</a> <a id="2411" href="Test.Examples.AccountSim.Validator.html#2411" class="Bound">net</a> <a id="2415" class="Symbol">;</a> <a id="2417" href="Test.Prelude.html#756" class="Field">pay</a> <a id="2421" class="Symbol">=</a> <a id="2423" class="Symbol">(</a><a id="2424" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="2434" href="Test.Examples.AccountSim.Validator.html#2434" class="Bound">x</a><a id="2435" class="Symbol">)</a> <a id="2437" class="Symbol">;</a> <a id="2439" href="Test.Prelude.html#785" class="Field">stake</a> <a id="2445" class="Symbol">=</a> <a id="2447" href="Test.Examples.AccountSim.Validator.html#2447" class="Bound">stake</a> <a id="2453" class="Symbol">}</a> <a id="2455" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2457" href="Test.Examples.AccountSim.Validator.html#2457" class="Bound">snd</a><a id="2460" class="Symbol">)</a> <a id="2462" class="Symbol">=</a> <a id="2464" href="Test.Examples.AccountSim.Validator.html#2434" class="Bound">x</a>
<a id="2466" href="Test.Examples.AccountSim.Validator.html#2237" class="Function">getPaymentCredential</a> <a id="2487" class="Symbol">(</a><a id="2488" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2493" class="Keyword">record</a> <a id="2500" class="Symbol">{</a> <a id="2502" href="Test.Prelude.html#956" class="Field">net</a> <a id="2506" class="Symbol">=</a> <a id="2508" href="Test.Examples.AccountSim.Validator.html#2508" class="Bound">net</a> <a id="2512" class="Symbol">;</a> <a id="2514" href="Test.Prelude.html#986" class="Field">pay</a> <a id="2518" class="Symbol">=</a> <a id="2520" class="Symbol">(</a><a id="2521" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="2532" href="Test.Examples.AccountSim.Validator.html#2532" class="Bound">x</a><a id="2533" class="Symbol">)</a> <a id="2535" class="Symbol">;</a> <a id="2537" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="2547" class="Symbol">=</a> <a id="2549" href="Test.Examples.AccountSim.Validator.html#2549" class="Bound">attrsSize</a> <a id="2559" class="Symbol">}</a> <a id="2561" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2563" href="Test.Examples.AccountSim.Validator.html#2563" class="Bound">snd</a><a id="2566" class="Symbol">)</a> <a id="2568" class="Symbol">=</a> <a id="2570" href="Test.Examples.AccountSim.Validator.html#2532" class="Bound">x</a>
<a id="2572" href="Test.Examples.AccountSim.Validator.html#2237" class="Function">getPaymentCredential</a> <a id="2593" class="Symbol">(</a><a id="2594" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2599" class="Keyword">record</a> <a id="2606" class="Symbol">{</a> <a id="2608" href="Test.Prelude.html#956" class="Field">net</a> <a id="2612" class="Symbol">=</a> <a id="2614" href="Test.Examples.AccountSim.Validator.html#2614" class="Bound">net</a> <a id="2618" class="Symbol">;</a> <a id="2620" href="Test.Prelude.html#986" class="Field">pay</a> <a id="2624" class="Symbol">=</a> <a id="2626" class="Symbol">(</a><a id="2627" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="2637" href="Test.Examples.AccountSim.Validator.html#2637" class="Bound">x</a><a id="2638" class="Symbol">)</a> <a id="2640" class="Symbol">;</a> <a id="2642" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="2652" class="Symbol">=</a> <a id="2654" href="Test.Examples.AccountSim.Validator.html#2654" class="Bound">attrsSize</a> <a id="2664" class="Symbol">}</a> <a id="2666" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2668" href="Test.Examples.AccountSim.Validator.html#2668" class="Bound">snd</a><a id="2671" class="Symbol">)</a> <a id="2673" class="Symbol">=</a> <a id="2675" href="Test.Examples.AccountSim.Validator.html#2637" class="Bound">x</a>


<a id="getScriptCredential&#39;"></a><a id="2679" href="Test.Examples.AccountSim.Validator.html#2679" class="Function">getScriptCredential&#39;</a> <a id="2700" class="Symbol">:</a> <a id="2702" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2704" class="Symbol">→</a> <a id="2706" href="Test.Prelude.html#1311" class="Function">SUTxO</a> <a id="2712" class="Symbol">→</a> <a id="2714" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2720" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2722" href="Test.Examples.AccountSim.Validator.html#2679" class="Function">getScriptCredential&#39;</a> <a id="2743" href="Test.Examples.AccountSim.Validator.html#2743" class="Bound">ix</a> <a id="2746" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2749" class="Symbol">=</a> <a id="2751" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2759" href="Test.Examples.AccountSim.Validator.html#2679" class="Function">getScriptCredential&#39;</a> <a id="2780" href="Test.Examples.AccountSim.Validator.html#2780" class="Bound">ix</a> <a id="2783" class="Symbol">(((</a><a id="2786" href="Test.Examples.AccountSim.Validator.html#2786" class="Bound">txid&#39;</a> <a id="2792" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2794" href="Test.Examples.AccountSim.Validator.html#2794" class="Bound">ix&#39;</a><a id="2797" class="Symbol">)</a> <a id="2799" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2801" href="Test.Examples.AccountSim.Validator.html#2801" class="Bound">txout</a><a id="2806" class="Symbol">)</a> <a id="2808" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2810" href="Test.Examples.AccountSim.Validator.html#2810" class="Bound">utxos</a><a id="2815" class="Symbol">)</a> <a id="2817" class="Keyword">with</a> <a id="2822" href="Test.Examples.AccountSim.Validator.html#2780" class="Bound">ix</a> <a id="2825" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="2827" href="Test.Examples.AccountSim.Validator.html#2794" class="Bound">ix&#39;</a>
<a id="2831" class="Symbol">...</a> <a id="2835" class="Symbol">|</a> <a id="2837" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2840" href="Test.Examples.AccountSim.Validator.html#2840" class="Bound">¬a</a> <a id="2843" class="Symbol">=</a> <a id="2845" href="Test.Examples.AccountSim.Validator.html#2679" class="Function">getScriptCredential&#39;</a> <a id="2866" class="Bound">ix</a> <a id="2869" class="Bound">utxos</a>
<a id="2875" class="Symbol">...</a> <a id="2879" class="Symbol">|</a> <a id="2881" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2885" href="Test.Examples.AccountSim.Validator.html#2885" class="Bound">a</a> <a id="2887" class="Symbol">=</a> <a id="2889" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2894" class="Symbol">(</a><a id="2895" href="Test.Examples.AccountSim.Validator.html#2237" class="Function">getPaymentCredential</a> <a id="2916" class="Bound">txout</a><a id="2921" class="Symbol">)</a>


<a id="getScriptCredential"></a><a id="2925" href="Test.Examples.AccountSim.Validator.html#2925" class="Function">getScriptCredential</a> <a id="2945" class="Symbol">:</a> <a id="2947" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="2961" class="Symbol">→</a> <a id="2963" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2969" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2971" href="Test.Examples.AccountSim.Validator.html#2925" class="Function">getScriptCredential</a> <a id="2991" class="Symbol">(</a><a id="2992" href="Test.Examples.AccountSim.Validator.html#2992" class="Bound">fst</a> <a id="2996" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2998" href="Test.Prelude.html#1627" class="InductiveConstructor">Rwrd</a> <a id="3003" href="Test.Examples.AccountSim.Validator.html#3003" class="Bound">x</a><a id="3004" class="Symbol">)</a> <a id="3006" class="Symbol">=</a> <a id="3008" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="3016" href="Test.Examples.AccountSim.Validator.html#2925" class="Function">getScriptCredential</a> <a id="3036" class="Symbol">(</a><a id="3037" href="Test.Examples.AccountSim.Validator.html#3037" class="Bound">fst</a> <a id="3041" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3043" href="Test.Prelude.html#1672" class="InductiveConstructor">Mint</a> <a id="3048" href="Test.Examples.AccountSim.Validator.html#3048" class="Bound">x</a><a id="3049" class="Symbol">)</a> <a id="3051" class="Symbol">=</a> <a id="3053" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="3061" href="Test.Examples.AccountSim.Validator.html#2925" class="Function">getScriptCredential</a> <a id="3081" class="Symbol">(</a><a id="3082" href="Test.Examples.AccountSim.Validator.html#3082" class="Bound">txinfo</a> <a id="3089" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3091" href="Test.Prelude.html#1709" class="InductiveConstructor">Spend</a> <a id="3097" class="Symbol">(</a><a id="3098" href="Test.Examples.AccountSim.Validator.html#3098" class="Bound">txid</a> <a id="3103" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3105" href="Test.Examples.AccountSim.Validator.html#3105" class="Bound">ix</a><a id="3107" class="Symbol">))</a> <a id="3110" class="Symbol">=</a> <a id="3112" href="Test.Examples.AccountSim.Validator.html#2679" class="Function">getScriptCredential&#39;</a> <a id="3133" href="Test.Examples.AccountSim.Validator.html#3105" class="Bound">ix</a> <a id="3136" class="Symbol">(</a><a id="3137" href="Test.Prelude.html#1924" class="Field">STxInfo.realizedInputs</a> <a id="3160" href="Test.Examples.AccountSim.Validator.html#3082" class="Bound">txinfo</a><a id="3166" class="Symbol">)</a>
<a id="3168" href="Test.Examples.AccountSim.Validator.html#2925" class="Function">getScriptCredential</a> <a id="3188" class="Symbol">(</a><a id="3189" href="Test.Examples.AccountSim.Validator.html#3189" class="Bound">fst</a> <a id="3193" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3195" href="Test.Prelude.html#1745" class="InductiveConstructor">Empty</a><a id="3200" class="Symbol">)</a> <a id="3202" class="Symbol">=</a> <a id="3204" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="balanceSTxOut"></a><a id="3213" href="Test.Examples.AccountSim.Validator.html#3213" class="Function">balanceSTxOut</a> <a id="3227" class="Symbol">:</a> <a id="3229" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3234" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="3241" class="Symbol">→</a> <a id="3243" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="3249" href="Test.Examples.AccountSim.Validator.html#3213" class="Function">balanceSTxOut</a> <a id="3263" href="Test.Examples.AccountSim.Validator.html#3263" class="Bound">txout</a> <a id="3269" class="Symbol">=</a> <a id="3271" href="Data.List.Base.html#4126" class="Function">foldr</a> <a id="3277" class="Symbol">(</a><a id="3278" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3282" class="Symbol">{{</a><a id="3284" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="3292" class="Symbol">}})</a> <a id="3296" href="Test.Examples.AccountSim.Validator.html#767" class="Function">emptyValue</a> <a id="3307" class="Symbol">(</a><a id="3308" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3312" class="Symbol">(λ</a> <a id="3315" class="Symbol">{(_</a> <a id="3319" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3321" href="Test.Examples.AccountSim.Validator.html#3321" class="Bound">v</a> <a id="3323" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3325" class="Symbol">_)</a> <a id="3328" class="Symbol">→</a> <a id="3330" href="Test.Examples.AccountSim.Validator.html#3321" class="Bound">v</a><a id="3331" class="Symbol">})</a> <a id="3334" href="Test.Examples.AccountSim.Validator.html#3263" class="Bound">txout</a><a id="3339" class="Symbol">)</a>

<a id="matchIx"></a><a id="3342" href="Test.Examples.AccountSim.Validator.html#3342" class="Function">matchIx</a> <a id="3350" class="Symbol">:</a> <a id="3352" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3354" class="Symbol">→</a> <a id="3356" href="Test.Prelude.html#1151" class="Function">SAddr</a> <a id="3362" class="Symbol">→</a> <a id="3364" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="3368" href="Test.Examples.AccountSim.Validator.html#3342" class="Function">matchIx</a> <a id="3376" href="Test.Examples.AccountSim.Validator.html#3376" class="Bound">n</a> <a id="3378" class="Symbol">(</a><a id="3379" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3384" class="Keyword">record</a> <a id="3391" class="Symbol">{</a> <a id="3393" href="Test.Prelude.html#730" class="Field">net</a> <a id="3397" class="Symbol">=</a> <a id="3399" href="Test.Examples.AccountSim.Validator.html#3399" class="Bound">net</a> <a id="3403" class="Symbol">;</a> <a id="3405" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3409" class="Symbol">=</a> <a id="3411" class="Symbol">(</a><a id="3412" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3423" href="Test.Examples.AccountSim.Validator.html#3423" class="Bound">x</a><a id="3424" class="Symbol">)</a> <a id="3426" class="Symbol">;</a> <a id="3428" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3434" class="Symbol">=</a> <a id="3436" href="Test.Examples.AccountSim.Validator.html#3436" class="Bound">stake</a> <a id="3442" class="Symbol">})</a> <a id="3445" class="Symbol">=</a> <a id="3447" href="Test.Examples.AccountSim.Validator.html#3376" class="Bound">n</a> <a id="3449" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3451" href="Test.Examples.AccountSim.Validator.html#3423" class="Bound">x</a>
<a id="3453" href="Test.Examples.AccountSim.Validator.html#3342" class="Function">matchIx</a> <a id="3461" href="Test.Examples.AccountSim.Validator.html#3461" class="Bound">n</a> <a id="3463" class="Symbol">(</a><a id="3464" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3469" class="Keyword">record</a> <a id="3476" class="Symbol">{</a> <a id="3478" href="Test.Prelude.html#730" class="Field">net</a> <a id="3482" class="Symbol">=</a> <a id="3484" href="Test.Examples.AccountSim.Validator.html#3484" class="Bound">net</a> <a id="3488" class="Symbol">;</a> <a id="3490" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3494" class="Symbol">=</a> <a id="3496" class="Symbol">(</a><a id="3497" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3507" href="Test.Examples.AccountSim.Validator.html#3507" class="Bound">y</a><a id="3508" class="Symbol">)</a> <a id="3510" class="Symbol">;</a> <a id="3512" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3518" class="Symbol">=</a> <a id="3520" href="Test.Examples.AccountSim.Validator.html#3520" class="Bound">stake</a> <a id="3526" class="Symbol">})</a> <a id="3529" class="Symbol">=</a> <a id="3531" href="Test.Examples.AccountSim.Validator.html#3461" class="Bound">n</a> <a id="3533" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3535" href="Test.Examples.AccountSim.Validator.html#3507" class="Bound">y</a>
<a id="3537" href="Test.Examples.AccountSim.Validator.html#3342" class="Function">matchIx</a> <a id="3545" href="Test.Examples.AccountSim.Validator.html#3545" class="Bound">n</a> <a id="3547" class="Symbol">(</a><a id="3548" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3553" class="Keyword">record</a> <a id="3560" class="Symbol">{</a> <a id="3562" href="Test.Prelude.html#956" class="Field">net</a> <a id="3566" class="Symbol">=</a> <a id="3568" href="Test.Examples.AccountSim.Validator.html#3568" class="Bound">net</a> <a id="3572" class="Symbol">;</a> <a id="3574" href="Test.Prelude.html#986" class="Field">pay</a> <a id="3578" class="Symbol">=</a> <a id="3580" class="Symbol">(</a><a id="3581" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3592" href="Test.Examples.AccountSim.Validator.html#3592" class="Bound">x</a><a id="3593" class="Symbol">)</a> <a id="3595" class="Symbol">;</a> <a id="3597" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="3607" class="Symbol">=</a> <a id="3609" href="Test.Examples.AccountSim.Validator.html#3609" class="Bound">attrsSize</a> <a id="3619" class="Symbol">})</a> <a id="3622" class="Symbol">=</a> <a id="3624" href="Test.Examples.AccountSim.Validator.html#3545" class="Bound">n</a> <a id="3626" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3628" href="Test.Examples.AccountSim.Validator.html#3592" class="Bound">x</a>
<a id="3630" href="Test.Examples.AccountSim.Validator.html#3342" class="Function">matchIx</a> <a id="3638" href="Test.Examples.AccountSim.Validator.html#3638" class="Bound">n</a> <a id="3640" class="Symbol">(</a><a id="3641" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3646" class="Keyword">record</a> <a id="3653" class="Symbol">{</a> <a id="3655" href="Test.Prelude.html#956" class="Field">net</a> <a id="3659" class="Symbol">=</a> <a id="3661" href="Test.Examples.AccountSim.Validator.html#3661" class="Bound">net</a> <a id="3665" class="Symbol">;</a> <a id="3667" href="Test.Prelude.html#986" class="Field">pay</a> <a id="3671" class="Symbol">=</a> <a id="3673" class="Symbol">(</a><a id="3674" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3684" href="Test.Examples.AccountSim.Validator.html#3684" class="Bound">y</a><a id="3685" class="Symbol">)</a> <a id="3687" class="Symbol">;</a> <a id="3689" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="3699" class="Symbol">=</a> <a id="3701" href="Test.Examples.AccountSim.Validator.html#3701" class="Bound">attrsSize</a> <a id="3711" class="Symbol">})</a> <a id="3714" class="Symbol">=</a> <a id="3716" href="Test.Examples.AccountSim.Validator.html#3638" class="Bound">n</a> <a id="3718" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3720" href="Test.Examples.AccountSim.Validator.html#3684" class="Bound">y</a>

<a id="matchIx?"></a><a id="3723" href="Test.Examples.AccountSim.Validator.html#3723" class="Function">matchIx?</a> <a id="3732" class="Symbol">:</a> <a id="3734" class="Symbol">(</a><a id="3735" href="Test.Examples.AccountSim.Validator.html#3735" class="Bound">n</a> <a id="3737" class="Symbol">:</a> <a id="3739" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="3740" class="Symbol">)</a> <a id="3742" class="Symbol">→</a> <a id="3744" class="Symbol">(</a><a id="3745" href="Test.Examples.AccountSim.Validator.html#3745" class="Bound">a</a> <a id="3747" class="Symbol">:</a> <a id="3749" href="Test.Prelude.html#1151" class="Function">SAddr</a><a id="3754" class="Symbol">)</a> <a id="3756" class="Symbol">→</a> <a id="3758" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="3762" class="Symbol">(</a><a id="3763" href="Test.Examples.AccountSim.Validator.html#3342" class="Function">matchIx</a> <a id="3771" href="Test.Examples.AccountSim.Validator.html#3735" class="Bound">n</a> <a id="3773" href="Test.Examples.AccountSim.Validator.html#3745" class="Bound">a</a><a id="3774" class="Symbol">)</a>
<a id="3776" href="Test.Examples.AccountSim.Validator.html#3723" class="Function">matchIx?</a> <a id="3785" href="Test.Examples.AccountSim.Validator.html#3785" class="Bound">n</a> <a id="3787" class="Symbol">(</a><a id="3788" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3793" class="Keyword">record</a> <a id="3800" class="Symbol">{</a> <a id="3802" href="Test.Prelude.html#730" class="Field">net</a> <a id="3806" class="Symbol">=</a> <a id="3808" href="Test.Examples.AccountSim.Validator.html#3808" class="Bound">net</a> <a id="3812" class="Symbol">;</a> <a id="3814" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3818" class="Symbol">=</a> <a id="3820" class="Symbol">(</a><a id="3821" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3832" href="Test.Examples.AccountSim.Validator.html#3832" class="Bound">x</a><a id="3833" class="Symbol">)</a> <a id="3835" class="Symbol">;</a> <a id="3837" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3843" class="Symbol">=</a> <a id="3845" href="Test.Examples.AccountSim.Validator.html#3845" class="Bound">stake</a> <a id="3851" class="Symbol">})</a> <a id="3854" class="Symbol">=</a> <a id="3856" href="Test.Examples.AccountSim.Validator.html#3785" class="Bound">n</a> <a id="3858" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="3860" href="Test.Examples.AccountSim.Validator.html#3832" class="Bound">x</a>
<a id="3862" href="Test.Examples.AccountSim.Validator.html#3723" class="Function">matchIx?</a> <a id="3871" href="Test.Examples.AccountSim.Validator.html#3871" class="Bound">n</a> <a id="3873" class="Symbol">(</a><a id="3874" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3879" class="Keyword">record</a> <a id="3886" class="Symbol">{</a> <a id="3888" href="Test.Prelude.html#730" class="Field">net</a> <a id="3892" class="Symbol">=</a> <a id="3894" href="Test.Examples.AccountSim.Validator.html#3894" class="Bound">net</a> <a id="3898" class="Symbol">;</a> <a id="3900" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3904" class="Symbol">=</a> <a id="3906" class="Symbol">(</a><a id="3907" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3917" href="Test.Examples.AccountSim.Validator.html#3917" class="Bound">y</a><a id="3918" class="Symbol">)</a> <a id="3920" class="Symbol">;</a> <a id="3922" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3928" class="Symbol">=</a> <a id="3930" href="Test.Examples.AccountSim.Validator.html#3930" class="Bound">stake</a> <a id="3936" class="Symbol">})</a> <a id="3939" class="Symbol">=</a> <a id="3941" href="Test.Examples.AccountSim.Validator.html#3871" class="Bound">n</a> <a id="3943" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="3945" href="Test.Examples.AccountSim.Validator.html#3917" class="Bound">y</a>
<a id="3947" href="Test.Examples.AccountSim.Validator.html#3723" class="Function">matchIx?</a> <a id="3956" href="Test.Examples.AccountSim.Validator.html#3956" class="Bound">n</a> <a id="3958" class="Symbol">(</a><a id="3959" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3964" class="Keyword">record</a> <a id="3971" class="Symbol">{</a> <a id="3973" href="Test.Prelude.html#956" class="Field">net</a> <a id="3977" class="Symbol">=</a> <a id="3979" href="Test.Examples.AccountSim.Validator.html#3979" class="Bound">net</a> <a id="3983" class="Symbol">;</a> <a id="3985" href="Test.Prelude.html#986" class="Field">pay</a> <a id="3989" class="Symbol">=</a> <a id="3991" class="Symbol">(</a><a id="3992" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="4003" href="Test.Examples.AccountSim.Validator.html#4003" class="Bound">x</a><a id="4004" class="Symbol">)</a> <a id="4006" class="Symbol">;</a> <a id="4008" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="4018" class="Symbol">=</a> <a id="4020" href="Test.Examples.AccountSim.Validator.html#4020" class="Bound">attrsSize</a> <a id="4030" class="Symbol">})</a> <a id="4033" class="Symbol">=</a> <a id="4035" href="Test.Examples.AccountSim.Validator.html#3956" class="Bound">n</a> <a id="4037" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="4039" href="Test.Examples.AccountSim.Validator.html#4003" class="Bound">x</a>
<a id="4041" href="Test.Examples.AccountSim.Validator.html#3723" class="Function">matchIx?</a> <a id="4050" href="Test.Examples.AccountSim.Validator.html#4050" class="Bound">n</a> <a id="4052" class="Symbol">(</a><a id="4053" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="4058" class="Keyword">record</a> <a id="4065" class="Symbol">{</a> <a id="4067" href="Test.Prelude.html#956" class="Field">net</a> <a id="4071" class="Symbol">=</a> <a id="4073" href="Test.Examples.AccountSim.Validator.html#4073" class="Bound">net</a> <a id="4077" class="Symbol">;</a> <a id="4079" href="Test.Prelude.html#986" class="Field">pay</a> <a id="4083" class="Symbol">=</a> <a id="4085" class="Symbol">(</a><a id="4086" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="4096" href="Test.Examples.AccountSim.Validator.html#4096" class="Bound">y</a><a id="4097" class="Symbol">)</a> <a id="4099" class="Symbol">;</a> <a id="4101" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="4111" class="Symbol">=</a> <a id="4113" href="Test.Examples.AccountSim.Validator.html#4113" class="Bound">attrsSize</a> <a id="4123" class="Symbol">})</a> <a id="4126" class="Symbol">=</a> <a id="4128" href="Test.Examples.AccountSim.Validator.html#4050" class="Bound">n</a> <a id="4130" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="4132" href="Test.Examples.AccountSim.Validator.html#4096" class="Bound">y</a>


<a id="totalOuts"></a><a id="4136" href="Test.Examples.AccountSim.Validator.html#4136" class="Function">totalOuts</a> <a id="4146" class="Symbol">:</a> <a id="4148" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4162" class="Symbol">→</a> <a id="4164" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4175" class="Symbol">→</a> <a id="4177" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="4183" href="Test.Examples.AccountSim.Validator.html#4136" class="Function">totalOuts</a> <a id="4193" class="Symbol">(</a><a id="4194" href="Test.Examples.AccountSim.Validator.html#4194" class="Bound">txinfo</a> <a id="4201" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4203" class="Symbol">_)</a> <a id="4206" href="Test.Examples.AccountSim.Validator.html#4206" class="Bound">ph</a>  <a id="4210" class="Symbol">=</a> <a id="4212" href="Test.Examples.AccountSim.Validator.html#3213" class="Function">balanceSTxOut</a> <a id="4226" class="Symbol">(</a><a id="4227" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="4234" class="Symbol">(λ</a> <a id="4237" class="Symbol">{</a> <a id="4239" class="Symbol">(</a><a id="4240" href="Test.Examples.AccountSim.Validator.html#4240" class="Bound">fst</a> <a id="4244" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4246" href="Test.Examples.AccountSim.Validator.html#4246" class="Bound">snd</a><a id="4249" class="Symbol">)</a> <a id="4251" class="Symbol">→</a> <a id="4253" href="Test.Examples.AccountSim.Validator.html#3723" class="Function">matchIx?</a> <a id="4262" href="Test.Examples.AccountSim.Validator.html#4206" class="Bound">ph</a> <a id="4265" href="Test.Examples.AccountSim.Validator.html#4240" class="Bound">fst</a><a id="4268" class="Symbol">})</a> <a id="4271" class="Symbol">(</a><a id="4272" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="4276" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4282" class="Symbol">(</a><a id="4283" href="Test.Prelude.html#1955" class="Field">STxInfo.txouts</a> <a id="4298" href="Test.Examples.AccountSim.Validator.html#4194" class="Bound">txinfo</a><a id="4304" class="Symbol">)))</a>

<a id="totalIns"></a><a id="4309" href="Test.Examples.AccountSim.Validator.html#4309" class="Function">totalIns</a> <a id="4318" class="Symbol">:</a> <a id="4320" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4334" class="Symbol">→</a> <a id="4336" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4347" class="Symbol">→</a> <a id="4349" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="4355" href="Test.Examples.AccountSim.Validator.html#4309" class="Function">totalIns</a> <a id="4364" class="Symbol">(</a><a id="4365" href="Test.Examples.AccountSim.Validator.html#4365" class="Bound">txinfo</a> <a id="4372" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4374" class="Symbol">_)</a> <a id="4377" href="Test.Examples.AccountSim.Validator.html#4377" class="Bound">ph</a>  <a id="4381" class="Symbol">=</a> <a id="4383" href="Test.Examples.AccountSim.Validator.html#3213" class="Function">balanceSTxOut</a> <a id="4397" class="Symbol">(</a><a id="4398" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="4405" class="Symbol">(λ</a> <a id="4408" class="Symbol">{</a> <a id="4410" class="Symbol">(</a><a id="4411" href="Test.Examples.AccountSim.Validator.html#4411" class="Bound">fst</a> <a id="4415" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4417" href="Test.Examples.AccountSim.Validator.html#4417" class="Bound">snd</a><a id="4420" class="Symbol">)</a> <a id="4422" class="Symbol">→</a> <a id="4424" href="Test.Examples.AccountSim.Validator.html#3723" class="Function">matchIx?</a> <a id="4433" href="Test.Examples.AccountSim.Validator.html#4377" class="Bound">ph</a> <a id="4436" href="Test.Examples.AccountSim.Validator.html#4411" class="Bound">fst</a><a id="4439" class="Symbol">})</a> <a id="4442" class="Symbol">(</a><a id="4443" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="4447" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4453" class="Symbol">(</a><a id="4454" href="Test.Prelude.html#1924" class="Field">STxInfo.realizedInputs</a> <a id="4477" href="Test.Examples.AccountSim.Validator.html#4365" class="Bound">txinfo</a><a id="4483" class="Symbol">)))</a>

<a id="4488" class="Comment">-- Get the value of txouts for own script</a>
<a id="newValue"></a><a id="4530" href="Test.Examples.AccountSim.Validator.html#4530" class="Function">newValue</a> <a id="4539" class="Symbol">:</a> <a id="4541" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4555" class="Symbol">→</a> <a id="4557" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4563" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="4569" href="Test.Examples.AccountSim.Validator.html#4530" class="Function">newValue</a> <a id="4578" href="Test.Examples.AccountSim.Validator.html#4578" class="Bound">sc</a><a id="4580" class="Symbol">@(</a><a id="4582" href="Test.Examples.AccountSim.Validator.html#4582" class="Bound">txinfo</a> <a id="4589" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4591" href="Test.Examples.AccountSim.Validator.html#4591" class="Bound">sp</a><a id="4593" class="Symbol">)</a> <a id="4595" class="Keyword">with</a> <a id="4600" href="Test.Examples.AccountSim.Validator.html#2925" class="Function">getScriptCredential</a> <a id="4620" href="Test.Examples.AccountSim.Validator.html#4578" class="Bound">sc</a>
<a id="4623" class="Symbol">...</a> <a id="4627" class="Symbol">|</a> <a id="4629" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="4637" class="Symbol">=</a> <a id="4639" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="4647" class="Symbol">...</a> <a id="4651" class="Symbol">|</a> <a id="4653" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4658" href="Test.Examples.AccountSim.Validator.html#4658" class="Bound">sh</a> <a id="4661" class="Symbol">=</a> <a id="4663" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4668" class="Symbol">(</a><a id="4669" href="Test.Examples.AccountSim.Validator.html#4136" class="Function">totalOuts</a> <a id="4679" class="Bound">sc</a> <a id="4682" href="Test.Examples.AccountSim.Validator.html#4658" class="Bound">sh</a><a id="4684" class="Symbol">)</a>

<a id="oldValue"></a><a id="4687" href="Test.Examples.AccountSim.Validator.html#4687" class="Function">oldValue</a> <a id="4696" class="Symbol">:</a> <a id="4698" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4712" class="Symbol">→</a> <a id="4714" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4720" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="4726" href="Test.Examples.AccountSim.Validator.html#4687" class="Function">oldValue</a> <a id="4735" href="Test.Examples.AccountSim.Validator.html#4735" class="Bound">sc</a><a id="4737" class="Symbol">@(</a><a id="4739" href="Test.Examples.AccountSim.Validator.html#4739" class="Bound">txinfo</a> <a id="4746" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4748" href="Test.Examples.AccountSim.Validator.html#4748" class="Bound">sp</a><a id="4750" class="Symbol">)</a> <a id="4752" class="Keyword">with</a> <a id="4757" href="Test.Examples.AccountSim.Validator.html#2925" class="Function">getScriptCredential</a> <a id="4777" href="Test.Examples.AccountSim.Validator.html#4735" class="Bound">sc</a>
<a id="4780" class="Symbol">...</a> <a id="4784" class="Symbol">|</a> <a id="4786" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="4794" class="Symbol">=</a> <a id="4796" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="4804" class="Symbol">...</a> <a id="4808" class="Symbol">|</a> <a id="4810" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4815" href="Test.Examples.AccountSim.Validator.html#4815" class="Bound">sh</a> <a id="4818" class="Symbol">=</a> <a id="4820" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4825" class="Symbol">(</a><a id="4826" href="Test.Examples.AccountSim.Validator.html#4309" class="Function">totalIns</a> <a id="4835" class="Bound">sc</a> <a id="4838" href="Test.Examples.AccountSim.Validator.html#4815" class="Bound">sh</a><a id="4840" class="Symbol">)</a>


<a id="4844" class="Keyword">open</a> <a id="4849" class="Keyword">import</a> <a id="4856" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="checkSigned"></a><a id="4884" href="Test.Examples.AccountSim.Validator.html#4884" class="Function">checkSigned</a> <a id="4896" class="Symbol">:</a> <a id="4898" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4909" class="Symbol">→</a> <a id="4911" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4925" class="Symbol">→</a> <a id="4927" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4932" href="Test.Examples.AccountSim.Validator.html#4884" class="Function">checkSigned</a> <a id="4944" href="Test.Examples.AccountSim.Validator.html#4944" class="Bound">ph</a> <a id="4947" class="Symbol">(</a><a id="4948" href="Test.Examples.AccountSim.Validator.html#4948" class="Bound">txinfo</a> <a id="4955" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4957" class="Symbol">_)</a> <a id="4960" class="Symbol">=</a> <a id="4962" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="4964" class="Symbol">(</a><a id="4965" href="Test.Examples.AccountSim.Validator.html#4944" class="Bound">ph</a> <a id="4968" href="Axiom.Set.html#11038" class="Function Operator">∈?</a> <a id="4971" class="Symbol">(</a><a id="4972" href="Test.Prelude.html#2215" class="Field">STxInfo.vkey</a> <a id="4985" href="Test.Examples.AccountSim.Validator.html#4948" class="Bound">txinfo</a><a id="4991" class="Symbol">))</a> <a id="4994" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="query"></a><a id="4997" href="Test.Examples.AccountSim.Validator.html#4997" class="Function">query</a> <a id="5003" class="Symbol">:</a> <a id="5005" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5016" class="Symbol">→</a> <a id="5018" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5023" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5034" class="Symbol">→</a> <a id="5036" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5041" href="Test.Examples.AccountSim.Validator.html#4997" class="Function">query</a> <a id="5047" href="Test.Examples.AccountSim.Validator.html#5047" class="Bound">ph</a> <a id="5050" href="Test.Examples.AccountSim.Validator.html#5050" class="Bound">xs</a> <a id="5053" class="Symbol">=</a> <a id="5055" href="Data.Bool.ListAction.html#874" class="Function">any</a> <a id="5059" class="Symbol">(λ</a> <a id="5062" href="Test.Examples.AccountSim.Validator.html#5062" class="Bound">k</a> <a id="5064" class="Symbol">→</a>  <a id="5067" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5069" href="Test.Examples.AccountSim.Validator.html#5047" class="Bound">ph</a> <a id="5072" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="5074" href="Test.Examples.AccountSim.Validator.html#5062" class="Bound">k</a> <a id="5076" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a><a id="5077" class="Symbol">)</a> <a id="5079" href="Test.Examples.AccountSim.Validator.html#5050" class="Bound">xs</a>

<a id="checkPayment"></a><a id="5083" href="Test.Examples.AccountSim.Validator.html#5083" class="Function">checkPayment</a> <a id="5096" class="Symbol">:</a> <a id="5098" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5109" class="Symbol">-&gt;</a> <a id="5112" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="5118" class="Symbol">-&gt;</a> <a id="5121" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="5135" class="Symbol">-&gt;</a> <a id="5138" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5143" href="Test.Examples.AccountSim.Validator.html#5083" class="Function">checkPayment</a> <a id="5156" href="Test.Examples.AccountSim.Validator.html#5156" class="Bound">pkh</a> <a id="5160" href="Test.Examples.AccountSim.Validator.html#5160" class="Bound">v</a> <a id="5162" href="Test.Examples.AccountSim.Validator.html#5162" class="Bound">ctx</a> <a id="5166" class="Symbol">=</a> <a id="5168" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5170" href="Test.Examples.AccountSim.Validator.html#4136" class="Function">totalOuts</a> <a id="5180" href="Test.Examples.AccountSim.Validator.html#5162" class="Bound">ctx</a> <a id="5184" href="Test.Examples.AccountSim.Validator.html#5156" class="Bound">pkh</a> <a id="5188" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="5190" class="Symbol">(</a><a id="5191" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="5195" class="Symbol">{{</a><a id="5197" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="5205" class="Symbol">}}</a> <a id="5208" class="Symbol">(</a><a id="5209" href="Test.Examples.AccountSim.Validator.html#4309" class="Function">totalIns</a> <a id="5218" href="Test.Examples.AccountSim.Validator.html#5162" class="Bound">ctx</a> <a id="5222" href="Test.Examples.AccountSim.Validator.html#5156" class="Bound">pkh</a><a id="5225" class="Symbol">)</a> <a id="5227" href="Test.Examples.AccountSim.Validator.html#5160" class="Bound">v</a><a id="5228" class="Symbol">)</a> <a id="5230" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="expired"></a><a id="5233" href="Test.Examples.AccountSim.Validator.html#5233" class="Function">expired</a> <a id="5241" class="Symbol">:</a> <a id="5243" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5245" class="Symbol">-&gt;</a> <a id="5248" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="5262" class="Symbol">-&gt;</a> <a id="5265" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5270" href="Test.Examples.AccountSim.Validator.html#5233" class="Function">expired</a> <a id="5278" href="Test.Examples.AccountSim.Validator.html#5278" class="Bound">slot</a> <a id="5283" class="Symbol">(</a><a id="5284" href="Test.Examples.AccountSim.Validator.html#5284" class="Bound">txinfo</a> <a id="5291" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5293" class="Symbol">_)</a> <a id="5296" class="Symbol">=</a> <a id="5298" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="5304" class="Symbol">(λ</a> <a id="5307" href="Test.Examples.AccountSim.Validator.html#5307" class="Bound">deadline</a> <a id="5316" class="Symbol">→</a>  <a id="5319" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5321" href="Test.Examples.AccountSim.Validator.html#5278" class="Bound">slot</a> <a id="5326" href="Data.Nat.Properties.html#11973" class="Function Operator">&gt;?</a> <a id="5329" href="Test.Examples.AccountSim.Validator.html#5307" class="Bound">deadline</a> <a id="5338" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a><a id="5339" class="Symbol">)</a>
                                     <a id="5378" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
                                     <a id="5421" class="Symbol">(</a><a id="5422" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="5428" class="Symbol">(</a><a id="5429" href="Test.Prelude.html#2164" class="Field">STxInfo.txvldt</a> <a id="5444" href="Test.Examples.AccountSim.Validator.html#5284" class="Bound">txinfo</a><a id="5450" class="Symbol">))</a>



<a id="checkMembership"></a><a id="5456" href="Test.Examples.AccountSim.Validator.html#5456" class="Function">checkMembership</a> <a id="5472" class="Symbol">:</a> <a id="5474" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5480" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="5486" class="Symbol">-&gt;</a> <a id="5489" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5494" href="Test.Examples.AccountSim.Validator.html#5456" class="Function">checkMembership</a> <a id="5510" class="Symbol">(</a><a id="5511" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5516" href="Test.Examples.AccountSim.Validator.html#5516" class="Bound">x</a><a id="5517" class="Symbol">)</a> <a id="5519" class="Symbol">=</a> <a id="5521" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="5526" href="Test.Examples.AccountSim.Validator.html#5456" class="Function">checkMembership</a> <a id="5542" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5550" class="Symbol">=</a> <a id="5552" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="checkEmpty"></a><a id="5559" href="Test.Examples.AccountSim.Validator.html#5559" class="Function">checkEmpty</a> <a id="5570" class="Symbol">:</a> <a id="5572" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5578" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="5584" class="Symbol">-&gt;</a> <a id="5587" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5592" href="Test.Examples.AccountSim.Validator.html#5559" class="Function">checkEmpty</a> <a id="5603" class="Symbol">(</a><a id="5604" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5609" href="Test.Examples.AccountSim.Validator.html#5609" class="Bound">x</a><a id="5610" class="Symbol">)</a> <a id="5612" class="Symbol">=</a> <a id="5614" href="Test.Examples.AccountSim.Validator.html#5609" class="Bound">x</a> <a id="5616" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5619" href="Test.Examples.AccountSim.Validator.html#767" class="Function">emptyValue</a>
<a id="5630" href="Test.Examples.AccountSim.Validator.html#5559" class="Function">checkEmpty</a> <a id="5641" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5649" class="Symbol">=</a> <a id="5651" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="insert&#39;"></a><a id="5658" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="5666" class="Symbol">:</a> <a id="5668" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5679" class="Symbol">-&gt;</a> <a id="5682" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="5688" class="Symbol">-&gt;</a> <a id="5691" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5696" class="Symbol">(</a><a id="5697" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5699" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5701" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="5706" class="Symbol">)</a> <a id="5708" class="Symbol">-&gt;</a> <a id="5711" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5716" class="Symbol">(</a><a id="5717" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5719" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5721" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="5726" class="Symbol">)</a>
<a id="5728" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="5736" href="Test.Examples.AccountSim.Validator.html#5736" class="Bound">pkh</a> <a id="5740" href="Test.Examples.AccountSim.Validator.html#5740" class="Bound">val</a> <a id="5744" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5747" class="Symbol">=</a> <a id="5749" class="Symbol">((</a><a id="5751" href="Test.Examples.AccountSim.Validator.html#5736" class="Bound">pkh</a> <a id="5755" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5757" href="Test.Examples.AccountSim.Validator.html#5740" class="Bound">val</a><a id="5760" class="Symbol">)</a> <a id="5762" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5764" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5766" class="Symbol">)</a>
<a id="5768" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="5776" href="Test.Examples.AccountSim.Validator.html#5776" class="Bound">pkh</a> <a id="5780" href="Test.Examples.AccountSim.Validator.html#5780" class="Bound">val</a> <a id="5784" class="Symbol">((</a><a id="5786" href="Test.Examples.AccountSim.Validator.html#5786" class="Bound">x</a> <a id="5788" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5790" href="Test.Examples.AccountSim.Validator.html#5790" class="Bound">y</a><a id="5791" class="Symbol">)</a> <a id="5793" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5795" href="Test.Examples.AccountSim.Validator.html#5795" class="Bound">xs</a><a id="5797" class="Symbol">)</a> <a id="5799" class="Symbol">=</a> <a id="5801" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="5804" class="Symbol">(</a><a id="5805" href="Test.Examples.AccountSim.Validator.html#5776" class="Bound">pkh</a> <a id="5809" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5812" href="Test.Examples.AccountSim.Validator.html#5786" class="Bound">x</a><a id="5813" class="Symbol">)</a> <a id="5815" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="5820" class="Symbol">((</a><a id="5822" href="Test.Examples.AccountSim.Validator.html#5776" class="Bound">pkh</a> <a id="5826" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5828" href="Test.Examples.AccountSim.Validator.html#5780" class="Bound">val</a><a id="5831" class="Symbol">)</a> <a id="5833" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5835" href="Test.Examples.AccountSim.Validator.html#5795" class="Bound">xs</a><a id="5837" class="Symbol">)</a> <a id="5839" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="5844" class="Symbol">((</a><a id="5846" href="Test.Examples.AccountSim.Validator.html#5786" class="Bound">x</a> <a id="5848" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5850" href="Test.Examples.AccountSim.Validator.html#5790" class="Bound">y</a><a id="5851" class="Symbol">)</a> <a id="5853" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5855" class="Symbol">(</a><a id="5856" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="5864" href="Test.Examples.AccountSim.Validator.html#5776" class="Bound">pkh</a> <a id="5868" href="Test.Examples.AccountSim.Validator.html#5780" class="Bound">val</a> <a id="5872" href="Test.Examples.AccountSim.Validator.html#5795" class="Bound">xs</a><a id="5874" class="Symbol">))</a>
  
<a id="delete&#39;"></a><a id="5880" href="Test.Examples.AccountSim.Validator.html#5880" class="Function">delete&#39;</a> <a id="5888" class="Symbol">:</a> <a id="5890" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5901" class="Symbol">-&gt;</a> <a id="5904" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5909" class="Symbol">(</a><a id="5910" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5912" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5914" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="5919" class="Symbol">)</a> <a id="5921" class="Symbol">-&gt;</a> <a id="5924" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5929" class="Symbol">(</a><a id="5930" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5932" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5934" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="5939" class="Symbol">)</a>
<a id="5941" href="Test.Examples.AccountSim.Validator.html#5880" class="Function">delete&#39;</a> <a id="5949" href="Test.Examples.AccountSim.Validator.html#5949" class="Bound">pkh</a> <a id="5953" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5956" class="Symbol">=</a> <a id="5958" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="5961" href="Test.Examples.AccountSim.Validator.html#5880" class="Function">delete&#39;</a> <a id="5969" href="Test.Examples.AccountSim.Validator.html#5969" class="Bound">pkh</a> <a id="5973" class="Symbol">((</a><a id="5975" href="Test.Examples.AccountSim.Validator.html#5975" class="Bound">x</a> <a id="5977" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5979" href="Test.Examples.AccountSim.Validator.html#5979" class="Bound">y</a><a id="5980" class="Symbol">)</a> <a id="5982" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5984" href="Test.Examples.AccountSim.Validator.html#5984" class="Bound">xs</a><a id="5986" class="Symbol">)</a> <a id="5988" class="Symbol">=</a> <a id="5990" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="5993" class="Symbol">(</a><a id="5994" href="Test.Examples.AccountSim.Validator.html#5969" class="Bound">pkh</a> <a id="5998" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6001" href="Test.Examples.AccountSim.Validator.html#5975" class="Bound">x</a><a id="6002" class="Symbol">)</a>
  <a id="6006" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="6011" href="Test.Examples.AccountSim.Validator.html#5984" class="Bound">xs</a>
  <a id="6016" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="6021" class="Symbol">((</a><a id="6023" href="Test.Examples.AccountSim.Validator.html#5975" class="Bound">x</a> <a id="6025" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6027" href="Test.Examples.AccountSim.Validator.html#5979" class="Bound">y</a><a id="6028" class="Symbol">)</a> <a id="6030" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6032" class="Symbol">(</a><a id="6033" href="Test.Examples.AccountSim.Validator.html#5880" class="Function">delete&#39;</a> <a id="6041" href="Test.Examples.AccountSim.Validator.html#5969" class="Bound">pkh</a> <a id="6045" href="Test.Examples.AccountSim.Validator.html#5984" class="Bound">xs</a><a id="6047" class="Symbol">))</a>

<a id="lookup&#39;"></a><a id="6051" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="6059" class="Symbol">:</a> <a id="6061" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6063" class="Symbol">→</a> <a id="6065" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6070" class="Symbol">(</a><a id="6071" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6073" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6075" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a><a id="6080" class="Symbol">)</a> <a id="6082" class="Symbol">→</a> <a id="6084" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6090" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a>
<a id="6096" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="6104" href="Test.Examples.AccountSim.Validator.html#6104" class="Bound">x</a> <a id="6106" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>              <a id="6122" class="Symbol">=</a> <a id="6124" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> 
<a id="6133" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="6141" href="Test.Examples.AccountSim.Validator.html#6141" class="Bound">x</a> <a id="6143" class="Symbol">((</a><a id="6145" href="Test.Examples.AccountSim.Validator.html#6145" class="Bound">x₁</a> <a id="6148" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6150" href="Test.Examples.AccountSim.Validator.html#6150" class="Bound">y</a><a id="6151" class="Symbol">)</a> <a id="6153" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6155" href="Test.Examples.AccountSim.Validator.html#6155" class="Bound">xs</a><a id="6157" class="Symbol">)</a> <a id="6159" class="Symbol">=</a> <a id="6161" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="6164" href="Test.Examples.AccountSim.Validator.html#6141" class="Bound">x</a> <a id="6166" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6169" href="Test.Examples.AccountSim.Validator.html#6145" class="Bound">x₁</a> <a id="6172" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="6177" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6182" href="Test.Examples.AccountSim.Validator.html#6150" class="Bound">y</a> <a id="6184" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="6189" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="6197" href="Test.Examples.AccountSim.Validator.html#6141" class="Bound">x</a> <a id="6199" href="Test.Examples.AccountSim.Validator.html#6155" class="Bound">xs</a>



<a id="checkWithdraw"></a><a id="6205" href="Test.Examples.AccountSim.Validator.html#6205" class="Function">checkWithdraw</a> <a id="6219" class="Symbol">:</a> <a id="6221" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6227" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6233" class="Symbol">-&gt;</a> <a id="6236" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6238" class="Symbol">-&gt;</a> <a id="6241" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6247" class="Symbol">-&gt;</a> <a id="6250" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6256" class="Symbol">-&gt;</a> <a id="6259" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6273" class="Symbol">-&gt;</a> <a id="6276" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6281" href="Test.Examples.AccountSim.Validator.html#6205" class="Function">checkWithdraw</a> <a id="6295" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6303" class="Symbol">_</a> <a id="6305" class="Symbol">_</a> <a id="6307" class="Symbol">_</a> <a id="6309" class="Symbol">_</a> <a id="6311" class="Symbol">=</a> <a id="6313" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6319" href="Test.Examples.AccountSim.Validator.html#6205" class="Function">checkWithdraw</a> <a id="6333" class="Symbol">(</a><a id="6334" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6339" href="Test.Examples.AccountSim.Validator.html#6339" class="Bound">v</a><a id="6340" class="Symbol">)</a> <a id="6342" href="Test.Examples.AccountSim.Validator.html#6342" class="Bound">pkh</a> <a id="6346" href="Test.Examples.AccountSim.Validator.html#6346" class="Bound">val</a> <a id="6350" class="Symbol">(</a><a id="6351" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6358" href="Test.Examples.AccountSim.Validator.html#6358" class="Bound">lab</a><a id="6361" class="Symbol">)</a> <a id="6363" href="Test.Examples.AccountSim.Validator.html#6363" class="Bound">ctx</a> <a id="6367" class="Symbol">=</a> <a id="6369" href="Test.Examples.AccountSim.Validator.html#980" class="Function">geq</a> <a id="6373" href="Test.Examples.AccountSim.Validator.html#6346" class="Bound">val</a> <a id="6377" href="Test.Examples.AccountSim.Validator.html#767" class="Function">emptyValue</a> <a id="6388" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6391" href="Test.Examples.AccountSim.Validator.html#980" class="Function">geq</a> <a id="6395" href="Test.Examples.AccountSim.Validator.html#6339" class="Bound">v</a> <a id="6397" href="Test.Examples.AccountSim.Validator.html#6346" class="Bound">val</a> <a id="6401" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6404" class="Symbol">(</a><a id="6405" href="Test.Examples.AccountSim.Validator.html#1532" class="Function">newLabel</a> <a id="6414" href="Test.Examples.AccountSim.Validator.html#6363" class="Bound">ctx</a> <a id="6418" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6421" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6426" class="Symbol">(</a><a id="6427" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6434" class="Symbol">(</a><a id="6435" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="6443" href="Test.Examples.AccountSim.Validator.html#6342" class="Bound">pkh</a> <a id="6447" class="Symbol">(</a><a id="6448" href="Test.Examples.AccountSim.Validator.html#6339" class="Bound">v</a> <a id="6450" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="6452" href="Test.Examples.AccountSim.Validator.html#6346" class="Bound">val</a><a id="6455" class="Symbol">)</a> <a id="6457" href="Test.Examples.AccountSim.Validator.html#6358" class="Bound">lab</a><a id="6460" class="Symbol">)))</a> 

<a id="checkDeposit"></a><a id="6466" href="Test.Examples.AccountSim.Validator.html#6466" class="Function">checkDeposit</a> <a id="6479" class="Symbol">:</a> <a id="6481" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="6488" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6494" class="Symbol">-&gt;</a> <a id="6497" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6499" class="Symbol">-&gt;</a> <a id="6502" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6508" class="Symbol">-&gt;</a>  <a id="6512" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6518" class="Symbol">-&gt;</a> <a id="6521" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6535" class="Symbol">-&gt;</a> <a id="6538" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6543" href="Test.Examples.AccountSim.Validator.html#6466" class="Function">checkDeposit</a> <a id="6556" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6564" class="Symbol">_</a> <a id="6566" class="Symbol">_</a> <a id="6568" class="Symbol">_</a> <a id="6570" class="Symbol">_</a> <a id="6572" class="Symbol">=</a> <a id="6574" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6580" href="Test.Examples.AccountSim.Validator.html#6466" class="Function">checkDeposit</a> <a id="6593" class="Symbol">(</a><a id="6594" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6599" href="Test.Examples.AccountSim.Validator.html#6599" class="Bound">v</a><a id="6600" class="Symbol">)</a> <a id="6602" href="Test.Examples.AccountSim.Validator.html#6602" class="Bound">pkh</a> <a id="6606" href="Test.Examples.AccountSim.Validator.html#6606" class="Bound">val</a> <a id="6610" class="Symbol">(</a><a id="6611" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6618" href="Test.Examples.AccountSim.Validator.html#6618" class="Bound">lab</a><a id="6621" class="Symbol">)</a> <a id="6623" href="Test.Examples.AccountSim.Validator.html#6623" class="Bound">ctx</a> <a id="6627" class="Symbol">=</a> <a id="6629" href="Test.Examples.AccountSim.Validator.html#980" class="Function">geq</a> <a id="6633" href="Test.Examples.AccountSim.Validator.html#6606" class="Bound">val</a> <a id="6637" href="Test.Examples.AccountSim.Validator.html#767" class="Function">emptyValue</a> <a id="6648" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6651" class="Symbol">(</a><a id="6652" href="Test.Examples.AccountSim.Validator.html#1532" class="Function">newLabel</a> <a id="6661" href="Test.Examples.AccountSim.Validator.html#6623" class="Bound">ctx</a> <a id="6665" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6668" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6673" class="Symbol">(</a> <a id="6675" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6682" class="Symbol">(</a><a id="6683" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="6691" href="Test.Examples.AccountSim.Validator.html#6602" class="Bound">pkh</a> <a id="6695" class="Symbol">(</a><a id="6696" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="6700" class="Symbol">{{</a><a id="6702" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="6710" class="Symbol">}}</a> <a id="6713" href="Test.Examples.AccountSim.Validator.html#6599" class="Bound">v</a> <a id="6715" href="Test.Examples.AccountSim.Validator.html#6606" class="Bound">val</a><a id="6718" class="Symbol">)</a> <a id="6720" href="Test.Examples.AccountSim.Validator.html#6618" class="Bound">lab</a><a id="6723" class="Symbol">)))</a>

<a id="checkTransfer"></a><a id="6728" href="Test.Examples.AccountSim.Validator.html#6728" class="Function">checkTransfer</a> <a id="6742" class="Symbol">:</a> <a id="6744" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6750" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6756" class="Symbol">-&gt;</a> <a id="6759" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6765" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6771" class="Symbol">-&gt;</a> <a id="6774" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6776" class="Symbol">-&gt;</a> <a id="6779" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6781" class="Symbol">-&gt;</a> <a id="6784" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="6790" class="Symbol">-&gt;</a> <a id="6793" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6799" class="Symbol">-&gt;</a> <a id="6802" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6816" class="Symbol">-&gt;</a> <a id="6819" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6824" href="Test.Examples.AccountSim.Validator.html#6728" class="Function">checkTransfer</a> <a id="6838" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6846" class="Symbol">_</a> <a id="6848" class="Symbol">_</a> <a id="6850" class="Symbol">_</a> <a id="6852" class="Symbol">_</a> <a id="6854" class="Symbol">_</a> <a id="6856" class="Symbol">_</a> <a id="6858" class="Symbol">=</a> <a id="6860" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6866" href="Test.Examples.AccountSim.Validator.html#6728" class="Function">checkTransfer</a> <a id="6880" class="Symbol">(</a><a id="6881" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6886" href="Test.Examples.AccountSim.Validator.html#6886" class="Bound">vF</a><a id="6888" class="Symbol">)</a> <a id="6890" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6898" class="Symbol">_</a> <a id="6900" class="Symbol">_</a> <a id="6902" class="Symbol">_</a> <a id="6904" class="Symbol">_</a> <a id="6906" class="Symbol">_</a> <a id="6908" class="Symbol">=</a> <a id="6910" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6916" href="Test.Examples.AccountSim.Validator.html#6728" class="Function">checkTransfer</a> <a id="6930" class="Symbol">(</a><a id="6931" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6936" href="Test.Examples.AccountSim.Validator.html#6936" class="Bound">vF</a><a id="6938" class="Symbol">)</a> <a id="6940" class="Symbol">(</a><a id="6941" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6946" href="Test.Examples.AccountSim.Validator.html#6946" class="Bound">vT</a><a id="6948" class="Symbol">)</a> <a id="6950" href="Test.Examples.AccountSim.Validator.html#6950" class="Bound">from</a> <a id="6955" href="Test.Examples.AccountSim.Validator.html#6955" class="Bound">to</a> <a id="6958" href="Test.Examples.AccountSim.Validator.html#6958" class="Bound">val</a> <a id="6962" class="Symbol">(</a><a id="6963" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6970" href="Test.Examples.AccountSim.Validator.html#6970" class="Bound">lab</a><a id="6973" class="Symbol">)</a> <a id="6975" href="Test.Examples.AccountSim.Validator.html#6975" class="Bound">ctx</a> <a id="6979" class="Symbol">=</a> <a id="6981" href="Test.Examples.AccountSim.Validator.html#980" class="Function">geq</a> <a id="6985" href="Test.Examples.AccountSim.Validator.html#6958" class="Bound">val</a> <a id="6989" href="Test.Examples.AccountSim.Validator.html#767" class="Function">emptyValue</a> <a id="7000" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7003" href="Test.Examples.AccountSim.Validator.html#980" class="Function">geq</a> <a id="7007" href="Test.Examples.AccountSim.Validator.html#6936" class="Bound">vF</a> <a id="7010" href="Test.Examples.AccountSim.Validator.html#6958" class="Bound">val</a> <a id="7014" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7017" class="Symbol">(</a><a id="7018" href="Test.Examples.AccountSim.Validator.html#6950" class="Bound">from</a> <a id="7023" href="Class.DecEq.Core.html#260" class="Function Operator">≠</a> <a id="7025" href="Test.Examples.AccountSim.Validator.html#6955" class="Bound">to</a><a id="7027" class="Symbol">)</a> <a id="7029" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7032" class="Symbol">(</a><a id="7033" href="Test.Examples.AccountSim.Validator.html#1532" class="Function">newLabel</a> <a id="7042" href="Test.Examples.AccountSim.Validator.html#6975" class="Bound">ctx</a> <a id="7046" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7049" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7054" class="Symbol">(</a><a id="7055" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7062" class="Symbol">(</a><a id="7063" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="7071" href="Test.Examples.AccountSim.Validator.html#6950" class="Bound">from</a> <a id="7076" class="Symbol">(</a><a id="7077" href="Test.Examples.AccountSim.Validator.html#6936" class="Bound">vF</a> <a id="7080" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7082" href="Test.Examples.AccountSim.Validator.html#6958" class="Bound">val</a><a id="7085" class="Symbol">)</a> <a id="7087" class="Symbol">(</a><a id="7088" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="7096" href="Test.Examples.AccountSim.Validator.html#6955" class="Bound">to</a> <a id="7099" class="Symbol">(</a><a id="7100" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="7104" class="Symbol">{{</a><a id="7106" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="7114" class="Symbol">}}</a> <a id="7117" href="Test.Examples.AccountSim.Validator.html#6946" class="Bound">vT</a> <a id="7120" href="Test.Examples.AccountSim.Validator.html#6958" class="Bound">val</a><a id="7123" class="Symbol">)</a> <a id="7125" href="Test.Examples.AccountSim.Validator.html#6970" class="Bound">lab</a><a id="7128" class="Symbol">))))</a>

<a id="agdaValidator"></a><a id="7134" href="Test.Examples.AccountSim.Validator.html#7134" class="Function">agdaValidator</a> <a id="7148" class="Symbol">:</a> <a id="7150" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="7156" class="Symbol">-&gt;</a> <a id="7159" href="Test.Examples.AccountSim.Datum.html#470" class="Datatype">Input</a> <a id="7165" class="Symbol">-&gt;</a> <a id="7168" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="7182" class="Symbol">-&gt;</a> <a id="7185" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="7190" href="Test.Examples.AccountSim.Validator.html#7134" class="Function">agdaValidator</a> <a id="7204" class="Symbol">(</a><a id="7205" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7212" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="7215" class="Symbol">)</a> <a id="7217" href="Test.Examples.AccountSim.Validator.html#7217" class="Bound">inp</a> <a id="7221" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7225" class="Symbol">=</a> <a id="7227" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="7232" href="Test.Examples.AccountSim.Validator.html#7217" class="Bound">inp</a> <a id="7236" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="7239" class="Symbol">λ</a> <a id="7241" class="Keyword">where</a>

    <a id="7252" class="Symbol">(</a><a id="7253" href="Test.Examples.AccountSim.Datum.html#490" class="InductiveConstructor">Open</a> <a id="7258" href="Test.Examples.AccountSim.Validator.html#7258" class="Bound">pkh</a><a id="7261" class="Symbol">)</a> <a id="7263" class="Symbol">-&gt;</a> <a id="7266" href="Test.Examples.AccountSim.Validator.html#1905" class="Function">continuing</a> <a id="7277" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7281" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7284" class="Symbol">(</a><a id="7285" href="Test.Examples.AccountSim.Validator.html#4884" class="Function">checkSigned</a> <a id="7297" href="Test.Examples.AccountSim.Validator.html#7258" class="Bound">pkh</a> <a id="7301" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="7304" class="Symbol">)</a> <a id="7306" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7309" class="Symbol">(</a><a id="7310" href="Data.Bool.Base.html#951" class="Function">not</a> <a id="7314" class="Symbol">(</a><a id="7315" href="Test.Examples.AccountSim.Validator.html#5456" class="Function">checkMembership</a> <a id="7331" class="Symbol">(</a><a id="7332" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="7340" href="Test.Examples.AccountSim.Validator.html#7258" class="Bound">pkh</a> <a id="7344" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="7347" class="Symbol">)))</a> <a id="7351" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                  <a id="7372" class="Symbol">(</a><a id="7373" href="Test.Examples.AccountSim.Validator.html#1532" class="Function">newLabel</a> <a id="7382" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7386" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7389" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7394" class="Symbol">(</a><a id="7395" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7402" class="Symbol">(</a><a id="7403" href="Test.Examples.AccountSim.Validator.html#5658" class="Function">insert&#39;</a> <a id="7411" href="Test.Examples.AccountSim.Validator.html#7258" class="Bound">pkh</a> <a id="7415" href="Test.Examples.AccountSim.Validator.html#767" class="Function">emptyValue</a> <a id="7426" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="7429" class="Symbol">)))</a> <a id="7433" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7436" class="Symbol">(</a><a id="7437" href="Test.Examples.AccountSim.Validator.html#4530" class="Function">newValue</a> <a id="7446" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7450" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7453" href="Test.Examples.AccountSim.Validator.html#4687" class="Function">oldValue</a> <a id="7462" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="7465" class="Symbol">)</a>

    <a id="7472" class="Symbol">(</a><a id="7473" href="Test.Examples.AccountSim.Datum.html#514" class="InductiveConstructor">Close</a> <a id="7479" href="Test.Examples.AccountSim.Validator.html#7479" class="Bound">pkh</a><a id="7482" class="Symbol">)</a> <a id="7484" class="Symbol">-&gt;</a> <a id="7487" href="Test.Examples.AccountSim.Validator.html#1905" class="Function">continuing</a> <a id="7498" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7502" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7505" class="Symbol">(</a><a id="7506" href="Test.Examples.AccountSim.Validator.html#4884" class="Function">checkSigned</a> <a id="7518" href="Test.Examples.AccountSim.Validator.html#7479" class="Bound">pkh</a> <a id="7522" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="7525" class="Symbol">)</a> <a id="7527" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7530" class="Symbol">(</a><a id="7531" href="Test.Examples.AccountSim.Validator.html#5559" class="Function">checkEmpty</a> <a id="7542" class="Symbol">(</a><a id="7543" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="7551" href="Test.Examples.AccountSim.Validator.html#7479" class="Bound">pkh</a> <a id="7555" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="7558" class="Symbol">))</a> <a id="7561" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                   <a id="7583" class="Symbol">(</a><a id="7584" href="Test.Examples.AccountSim.Validator.html#1532" class="Function">newLabel</a> <a id="7593" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7597" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7600" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7605" class="Symbol">(</a><a id="7606" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7613" class="Symbol">(</a><a id="7614" href="Test.Examples.AccountSim.Validator.html#5880" class="Function">delete&#39;</a> <a id="7622" href="Test.Examples.AccountSim.Validator.html#7479" class="Bound">pkh</a> <a id="7626" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="7629" class="Symbol">)))</a> <a id="7633" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7636" class="Symbol">(</a><a id="7637" href="Test.Examples.AccountSim.Validator.html#4530" class="Function">newValue</a> <a id="7646" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7650" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7653" href="Test.Examples.AccountSim.Validator.html#4687" class="Function">oldValue</a> <a id="7662" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="7665" class="Symbol">)</a>

    <a id="7672" class="Symbol">(</a><a id="7673" href="Test.Examples.AccountSim.Datum.html#538" class="InductiveConstructor">Withdraw</a> <a id="7682" href="Test.Examples.AccountSim.Validator.html#7682" class="Bound">pkh</a> <a id="7686" href="Test.Examples.AccountSim.Validator.html#7686" class="Bound">val</a><a id="7689" class="Symbol">)</a> <a id="7691" class="Symbol">-&gt;</a> <a id="7694" href="Test.Examples.AccountSim.Validator.html#1905" class="Function">continuing</a> <a id="7705" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7709" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7712" class="Symbol">(</a><a id="7713" href="Test.Examples.AccountSim.Validator.html#4884" class="Function">checkSigned</a> <a id="7725" href="Test.Examples.AccountSim.Validator.html#7682" class="Bound">pkh</a> <a id="7729" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="7732" class="Symbol">)</a> <a id="7734" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7737" class="Symbol">(</a><a id="7738" href="Test.Examples.AccountSim.Validator.html#6205" class="Function">checkWithdraw</a> <a id="7752" class="Symbol">(</a><a id="7753" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="7761" href="Test.Examples.AccountSim.Validator.html#7682" class="Bound">pkh</a> <a id="7765" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="7768" class="Symbol">)</a> <a id="7770" href="Test.Examples.AccountSim.Validator.html#7682" class="Bound">pkh</a> <a id="7774" href="Test.Examples.AccountSim.Validator.html#7686" class="Bound">val</a> <a id="7778" class="Symbol">(</a><a id="7779" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7786" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="7789" class="Symbol">)</a> <a id="7791" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="7794" class="Symbol">)</a> <a id="7796" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                          <a id="7825" class="Symbol">((</a><a id="7827" href="Test.Examples.AccountSim.Validator.html#291" class="Function">maybeMap</a> <a id="7836" class="Symbol">(</a><a id="7837" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="7841" class="Symbol">{{</a><a id="7843" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="7851" class="Symbol">}}</a> <a id="7854" href="Test.Examples.AccountSim.Validator.html#7686" class="Bound">val</a><a id="7857" class="Symbol">)</a> <a id="7859" class="Symbol">(</a><a id="7860" href="Test.Examples.AccountSim.Validator.html#4530" class="Function">newValue</a> <a id="7869" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="7872" class="Symbol">))</a> <a id="7875" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7878" href="Test.Examples.AccountSim.Validator.html#4687" class="Function">oldValue</a> <a id="7887" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7891" class="Symbol">)</a>

    <a id="7898" class="Symbol">(</a><a id="7899" href="Test.Examples.AccountSim.Datum.html#567" class="InductiveConstructor">Deposit</a> <a id="7907" href="Test.Examples.AccountSim.Validator.html#7907" class="Bound">pkh</a> <a id="7911" href="Test.Examples.AccountSim.Validator.html#7911" class="Bound">val</a><a id="7914" class="Symbol">)</a> <a id="7916" class="Symbol">-&gt;</a> <a id="7919" href="Test.Examples.AccountSim.Validator.html#1905" class="Function">continuing</a> <a id="7930" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7934" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7937" href="Test.Examples.AccountSim.Validator.html#4884" class="Function">checkSigned</a> <a id="7949" href="Test.Examples.AccountSim.Validator.html#7907" class="Bound">pkh</a> <a id="7953" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="7957" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7960" href="Test.Examples.AccountSim.Validator.html#6466" class="Function">checkDeposit</a> <a id="7973" class="Symbol">(</a><a id="7974" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="7982" href="Test.Examples.AccountSim.Validator.html#7907" class="Bound">pkh</a> <a id="7986" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="7989" class="Symbol">)</a> <a id="7991" href="Test.Examples.AccountSim.Validator.html#7907" class="Bound">pkh</a> <a id="7995" href="Test.Examples.AccountSim.Validator.html#7911" class="Bound">val</a> <a id="7999" class="Symbol">(</a><a id="8000" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="8007" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="8010" class="Symbol">)</a> <a id="8012" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="8016" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                         <a id="8044" class="Symbol">(</a><a id="8045" href="Test.Examples.AccountSim.Validator.html#4530" class="Function">newValue</a> <a id="8054" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="8058" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8061" class="Symbol">(</a><a id="8062" href="Test.Examples.AccountSim.Validator.html#291" class="Function">maybeMap</a> <a id="8071" class="Symbol">(</a><a id="8072" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="8076" class="Symbol">{{</a><a id="8078" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="8086" class="Symbol">}}</a> <a id="8089" href="Test.Examples.AccountSim.Validator.html#7911" class="Bound">val</a><a id="8092" class="Symbol">)</a> <a id="8094" class="Symbol">(</a><a id="8095" href="Test.Examples.AccountSim.Validator.html#4687" class="Function">oldValue</a> <a id="8104" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="8107" class="Symbol">)))</a> 

    <a id="8117" class="Symbol">(</a><a id="8118" href="Test.Examples.AccountSim.Datum.html#596" class="InductiveConstructor">Transfer</a> <a id="8127" href="Test.Examples.AccountSim.Validator.html#8127" class="Bound">from</a> <a id="8132" href="Test.Examples.AccountSim.Validator.html#8132" class="Bound">to</a> <a id="8135" href="Test.Examples.AccountSim.Validator.html#8135" class="Bound">val</a><a id="8138" class="Symbol">)</a> <a id="8140" class="Symbol">-&gt;</a> <a id="8143" href="Test.Examples.AccountSim.Validator.html#1905" class="Function">continuing</a> <a id="8154" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="8158" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="8161" href="Test.Examples.AccountSim.Validator.html#4884" class="Function">checkSigned</a> <a id="8173" href="Test.Examples.AccountSim.Validator.html#8127" class="Bound">from</a> <a id="8178" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="8182" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                              <a id="8215" href="Test.Examples.AccountSim.Validator.html#6728" class="Function">checkTransfer</a> <a id="8229" class="Symbol">(</a><a id="8230" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="8238" href="Test.Examples.AccountSim.Validator.html#8127" class="Bound">from</a> <a id="8243" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="8246" class="Symbol">)</a> <a id="8248" class="Symbol">(</a><a id="8249" href="Test.Examples.AccountSim.Validator.html#6051" class="Function">lookup&#39;</a> <a id="8257" href="Test.Examples.AccountSim.Validator.html#8132" class="Bound">to</a> <a id="8260" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="8263" class="Symbol">)</a> <a id="8265" href="Test.Examples.AccountSim.Validator.html#8127" class="Bound">from</a> <a id="8270" href="Test.Examples.AccountSim.Validator.html#8132" class="Bound">to</a> <a id="8273" href="Test.Examples.AccountSim.Validator.html#8135" class="Bound">val</a> <a id="8277" class="Symbol">(</a><a id="8278" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="8285" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a><a id="8288" class="Symbol">)</a> <a id="8290" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="8294" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                              <a id="8327" class="Symbol">(</a><a id="8328" href="Test.Examples.AccountSim.Validator.html#4530" class="Function">newValue</a> <a id="8337" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a> <a id="8341" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8344" href="Test.Examples.AccountSim.Validator.html#4687" class="Function">oldValue</a> <a id="8353" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="8356" class="Symbol">)</a> 

    <a id="8364" href="Test.Examples.AccountSim.Datum.html#630" class="InductiveConstructor">Cleanup</a> <a id="8372" class="Symbol">-&gt;</a> <a id="8375" href="Data.Bool.Base.html#951" class="Function">not</a> <a id="8379" class="Symbol">(</a><a id="8380" href="Test.Examples.AccountSim.Validator.html#1905" class="Function">continuing</a> <a id="8391" href="Test.Examples.AccountSim.Validator.html#7221" class="Bound">ctx</a><a id="8394" class="Symbol">)</a> <a id="8396" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="8399" class="Symbol">(</a><a id="8400" href="Test.Examples.AccountSim.Validator.html#7212" class="Bound">lab</a> <a id="8404" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8407" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8409" class="Symbol">)</a>


<a id="accSimValidator"></a><a id="8413" href="Test.Examples.AccountSim.Validator.html#8413" class="Function">accSimValidator</a> <a id="8429" class="Symbol">:</a> <a id="8431" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="8437" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8443" class="Symbol">→</a> <a id="8445" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="8451" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8457" class="Symbol">→</a> <a id="8459" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8464" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8470" class="Symbol">→</a> <a id="8472" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="8477" href="Test.Examples.AccountSim.Validator.html#8413" class="Function">accSimValidator</a> <a id="8493" class="Symbol">(</a><a id="8494" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8499" class="Symbol">(</a><a id="8500" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8505" class="Symbol">(</a><a id="8506" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8511" href="Test.Examples.AccountSim.Validator.html#8511" class="Bound">x</a><a id="8512" class="Symbol">)))</a> <a id="8516" class="Symbol">(</a><a id="8517" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8522" class="Symbol">(</a><a id="8523" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8528" class="Symbol">(</a><a id="8529" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="8534" href="Test.Examples.AccountSim.Validator.html#8534" class="Bound">y</a><a id="8535" class="Symbol">)))</a> <a id="8539" class="Symbol">(</a><a id="8540" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="8545" href="Test.Examples.AccountSim.Validator.html#8545" class="Bound">y₁</a> <a id="8548" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8550" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8552" class="Symbol">)</a> <a id="8554" class="Symbol">=</a>
  <a id="8558" href="Test.Examples.AccountSim.Validator.html#7134" class="Function">agdaValidator</a> <a id="8572" href="Test.Examples.AccountSim.Validator.html#8511" class="Bound">x</a> <a id="8574" href="Test.Examples.AccountSim.Validator.html#8534" class="Bound">y</a> <a id="8576" href="Test.Examples.AccountSim.Validator.html#8545" class="Bound">y₁</a>
<a id="8579" href="Test.Examples.AccountSim.Validator.html#8413" class="CatchallClause Function">accSimValidator</a><a id="8594" class="CatchallClause"> </a><a id="8595" class="CatchallClause Symbol">_</a><a id="8596" class="CatchallClause"> </a><a id="8597" class="CatchallClause Symbol">_</a><a id="8598" class="CatchallClause"> </a><a id="8599" class="CatchallClause Symbol">_</a> <a id="8601" class="Symbol">=</a> <a id="8603" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

</pre></body></html>