<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Test.Examples.AccountSim.Validator</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Comment">-- Validator Simulating Accounts on Cardano based on Agda2hs work</a>

<a id="92" class="Keyword">module</a> <a id="99" href="Test.Examples.AccountSim.Validator.html" class="Module">Test.Examples.AccountSim.Validator</a> <a id="134" class="Keyword">where</a>

<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="168" class="Keyword">renaming</a> <a id="177" class="Symbol">(</a><a id="178" href="Data.Bool.Base.html#1005" class="Function Operator">_∧_</a> <a id="182" class="Symbol">to</a> <a id="185" class="Function Operator">_&amp;&amp;_</a><a id="189" class="Symbol">)</a> <a id="191" class="Keyword">hiding</a> <a id="198" class="Symbol">(</a><a id="199" href="Data.Bool.Base.html#1515" class="Function Operator">if_then_else_</a><a id="212" class="Symbol">)</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.List.html" class="Module">Data.List</a> <a id="236" class="Keyword">using</a> <a id="242" class="Symbol">(</a><a id="243" href="Data.List.Base.html#10389" class="Function">filter</a><a id="249" class="Symbol">)</a>
<a id="251" class="Keyword">open</a> <a id="256" class="Keyword">import</a> <a id="263" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="274" class="Keyword">renaming</a> <a id="283" class="Symbol">(</a><a id="284" href="Data.Maybe.Base.html#1934" class="Function">map</a> <a id="288" class="Symbol">to</a> <a id="291" class="Function">maybeMap</a><a id="299" class="Symbol">)</a>

<a id="302" class="Keyword">open</a> <a id="307" class="Keyword">import</a> <a id="314" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="329" class="Keyword">open</a> <a id="334" class="Keyword">import</a> <a id="341" href="Test.Examples.AccountSim.Datum.html" class="Module">Test.Examples.AccountSim.Datum</a>
<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Test.Prelude.html" class="Module">Test.Prelude</a> <a id="397" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>
<a id="412" class="Keyword">open</a> <a id="417" class="Keyword">import</a> <a id="424" href="Test.SymbolicData.html" class="Module">Test.SymbolicData</a> <a id="442" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>

<a id="458" class="Keyword">import</a> <a id="465" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="482" class="Symbol">as</a> <a id="485" class="Module">N</a>

<a id="PubKeyHash"></a><a id="488" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="499" class="Symbol">:</a> <a id="501" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="506" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="517" class="Symbol">=</a> <a id="519" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="522" class="Keyword">instance</a>
  <a id="ShowAccountSimData"></a><a id="533" href="Test.Examples.AccountSim.Validator.html#533" class="Function">ShowAccountSimData</a> <a id="552" class="Symbol">:</a> <a id="554" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="559" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a>
  <a id="576" href="Test.Examples.AccountSim.Validator.html#533" class="Function">ShowAccountSimData</a> <a id="595" class="Symbol">=</a> <a id="597" href="Class.Show.Core.html#172" class="InductiveConstructor">mkShow</a> <a id="604" class="Symbol">(λ</a> <a id="607" href="Test.Examples.AccountSim.Validator.html#607" class="Bound">x</a> <a id="609" class="Symbol">→</a> <a id="611" class="String">&quot;&quot;</a><a id="613" class="Symbol">)</a>

<a id="616" class="Keyword">open</a> <a id="621" class="Keyword">import</a> <a id="628" href="Test.LedgerImplementation.html" class="Module">Test.LedgerImplementation</a> <a id="654" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="660" href="Test.SymbolicData.html#240" class="Function">SData</a>
<a id="666" class="Keyword">open</a> <a id="671" class="Keyword">import</a> <a id="678" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="718" class="Keyword">using</a> <a id="724" class="Symbol">(</a><a id="725" href="Ledger.Conway.Specification.Transaction.html#999" class="Record">TransactionStructure</a><a id="745" class="Symbol">)</a>

<a id="748" class="Keyword">open</a> <a id="753" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="774" href="Test.LedgerImplementation.html#4278" class="Function">SVTransactionStructure</a>

<a id="emptyValue"></a><a id="798" href="Test.Examples.AccountSim.Validator.html#798" class="Function">emptyValue</a> <a id="809" class="Symbol">:</a> <a id="811" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="817" href="Test.Examples.AccountSim.Validator.html#798" class="Function">emptyValue</a> <a id="828" class="Symbol">=</a> <a id="830" class="Number">0</a>

<a id="feeValue"></a><a id="833" href="Test.Examples.AccountSim.Validator.html#833" class="Function">feeValue</a> <a id="842" class="Symbol">:</a> <a id="844" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="850" href="Test.Examples.AccountSim.Validator.html#833" class="Function">feeValue</a> <a id="859" class="Symbol">=</a> <a id="861" class="Number">10000000000</a>

<a id="startValue"></a><a id="874" href="Test.Examples.AccountSim.Validator.html#874" class="Function">startValue</a> <a id="885" class="Symbol">:</a> <a id="887" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="893" href="Test.Examples.AccountSim.Validator.html#874" class="Function">startValue</a> <a id="904" class="Symbol">=</a> <a id="906" class="Number">1000000000000</a>

<a id="scriptValue"></a><a id="921" href="Test.Examples.AccountSim.Validator.html#921" class="Function">scriptValue</a> <a id="933" class="Symbol">:</a> <a id="935" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="941" href="Test.Examples.AccountSim.Validator.html#921" class="Function">scriptValue</a> <a id="953" class="Symbol">=</a> <a id="955" class="Number">30000000000</a>

<a id="adaValueOf"></a><a id="968" href="Test.Examples.AccountSim.Validator.html#968" class="Function">adaValueOf</a> <a id="979" class="Symbol">:</a> <a id="981" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="983" class="Symbol">-&gt;</a> <a id="986" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="992" href="Test.Examples.AccountSim.Validator.html#968" class="Function">adaValueOf</a> <a id="1003" href="Test.Examples.AccountSim.Validator.html#1003" class="Bound">n</a> <a id="1005" class="Symbol">=</a> <a id="1007" href="Test.Examples.AccountSim.Validator.html#1003" class="Bound">n</a>


<a id="geq"></a><a id="1011" href="Test.Examples.AccountSim.Validator.html#1011" class="Function">geq</a> <a id="1015" class="Symbol">:</a> <a id="1017" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="1023" class="Symbol">-&gt;</a> <a id="1026" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="1032" class="Symbol">-&gt;</a> <a id="1035" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1040" href="Test.Examples.AccountSim.Validator.html#1011" class="Function">geq</a> <a id="1044" href="Test.Examples.AccountSim.Validator.html#1044" class="Bound">v1</a> <a id="1047" href="Test.Examples.AccountSim.Validator.html#1047" class="Bound">v2</a> <a id="1050" class="Symbol">=</a>  <a id="1053" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="1055" href="Test.Examples.AccountSim.Validator.html#1044" class="Bound">v1</a> <a id="1058" href="Data.Nat.Properties.html#6984" class="Function Operator">≥?</a> <a id="1061" href="Test.Examples.AccountSim.Validator.html#1047" class="Bound">v2</a> <a id="1064" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="subVal"></a><a id="1067" href="Test.Examples.AccountSim.Validator.html#1067" class="Function">subVal</a> <a id="1074" class="Symbol">:</a> <a id="1076" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="1082" class="Symbol">-&gt;</a> <a id="1085" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="1091" class="Symbol">-&gt;</a> <a id="1094" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="1100" href="Test.Examples.AccountSim.Validator.html#1067" class="Function">subVal</a> <a id="1107" href="Test.Examples.AccountSim.Validator.html#1107" class="Bound">v1</a> <a id="1110" href="Test.Examples.AccountSim.Validator.html#1110" class="Bound">v2</a> <a id="1113" class="Symbol">=</a> <a id="1115" href="Test.Examples.AccountSim.Validator.html#1107" class="Bound">v1</a> <a id="1118" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="1120" href="Test.Examples.AccountSim.Validator.html#1110" class="Bound">v2</a>

<a id="1124" class="Keyword">instance</a> <a id="ValueSub"></a><a id="1133" href="Test.Examples.AccountSim.Validator.html#1133" class="Function">ValueSub</a> <a id="1142" class="Symbol">:</a> <a id="1144" href="Interface.TypeClasses.HasSubtract.html#162" class="Record">HasSubtract</a> <a id="1156" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="1162" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
         <a id="1177" href="Test.Examples.AccountSim.Validator.html#1133" class="Function">ValueSub</a> <a id="1186" class="Symbol">=</a> <a id="1188" class="Keyword">record</a> <a id="1195" class="Symbol">{</a> <a id="1197" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">_-_</a> <a id="1201" class="Symbol">=</a> <a id="1203" class="Symbol">λ</a> <a id="1205" href="Test.Examples.AccountSim.Validator.html#1205" class="Bound">x</a> <a id="1207" href="Test.Examples.AccountSim.Validator.html#1207" class="Bound">y</a> <a id="1209" class="Symbol">→</a> <a id="1211" href="Test.Examples.AccountSim.Validator.html#1067" class="Function">subVal</a> <a id="1218" href="Test.Examples.AccountSim.Validator.html#1205" class="Bound">x</a> <a id="1220" href="Test.Examples.AccountSim.Validator.html#1207" class="Bound">y</a> <a id="1222" class="Symbol">}</a> <a id="1224" class="Comment">--subVal</a>


<a id="getInlineOutputDatum"></a><a id="1235" href="Test.Examples.AccountSim.Validator.html#1235" class="Function">getInlineOutputDatum</a> <a id="1256" class="Symbol">:</a> <a id="1258" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="1265" class="Symbol">→</a> <a id="1267" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1272" href="Test.Examples.AccountSim.Datum.html#737" class="Function">AccountSimData</a> <a id="1287" class="Symbol">→</a> <a id="1289" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1295" href="Ledger.Conway.Specification.Script.Base.html#1823" class="Function">Datum</a>
<a id="1301" href="Test.Examples.AccountSim.Validator.html#1235" class="Function">getInlineOutputDatum</a> <a id="1322" class="Symbol">(</a><a id="1323" href="Test.Examples.AccountSim.Validator.html#1323" class="Bound">a</a> <a id="1325" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1327" href="Test.Examples.AccountSim.Validator.html#1327" class="Bound">b</a> <a id="1329" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1331" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1336" class="Symbol">(</a><a id="1337" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1342" class="Symbol">(</a><a id="1343" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1348" href="Test.Examples.AccountSim.Validator.html#1348" class="Bound">x</a><a id="1349" class="Symbol">)))</a> <a id="1353" href="Test.Examples.AccountSim.Validator.html#1353" class="Bound">dats</a> <a id="1358" class="Symbol">=</a> <a id="1360" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1365" class="Symbol">(</a><a id="1366" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1371" class="Symbol">(</a><a id="1372" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1377" href="Test.Examples.AccountSim.Validator.html#1348" class="Bound">x</a><a id="1378" class="Symbol">))</a>
<a id="1381" href="Test.Examples.AccountSim.Validator.html#1235" class="Function">getInlineOutputDatum</a> <a id="1402" class="Symbol">(</a><a id="1403" href="Test.Examples.AccountSim.Validator.html#1403" class="Bound">a</a> <a id="1405" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1407" href="Test.Examples.AccountSim.Validator.html#1407" class="Bound">b</a> <a id="1409" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1411" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1416" class="Symbol">(</a><a id="1417" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1422" class="Symbol">(</a><a id="1423" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1428" href="Test.Examples.AccountSim.Validator.html#1428" class="Bound">y</a><a id="1429" class="Symbol">)))</a> <a id="1433" href="Test.Examples.AccountSim.Validator.html#1433" class="Bound">dats</a> <a id="1438" class="Symbol">=</a> <a id="1440" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1448" href="Test.Examples.AccountSim.Validator.html#1235" class="Function">getInlineOutputDatum</a> <a id="1469" class="Symbol">(</a><a id="1470" href="Test.Examples.AccountSim.Validator.html#1470" class="Bound">a</a> <a id="1472" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1474" href="Test.Examples.AccountSim.Validator.html#1474" class="Bound">b</a> <a id="1476" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1478" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1483" class="Symbol">(</a><a id="1484" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1489" href="Test.Examples.AccountSim.Validator.html#1489" class="Bound">y</a><a id="1490" class="Symbol">))</a> <a id="1493" href="Test.Examples.AccountSim.Validator.html#1493" class="Bound">dats</a> <a id="1498" class="Symbol">=</a> <a id="1500" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1508" href="Test.Examples.AccountSim.Validator.html#1235" class="Function">getInlineOutputDatum</a> <a id="1529" class="Symbol">(</a><a id="1530" href="Test.Examples.AccountSim.Validator.html#1530" class="Bound">a</a> <a id="1532" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1534" href="Test.Examples.AccountSim.Validator.html#1534" class="Bound">b</a> <a id="1536" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1538" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="1545" class="Symbol">)</a> <a id="1547" href="Test.Examples.AccountSim.Validator.html#1547" class="Bound">dats</a> <a id="1552" class="Symbol">=</a> <a id="1554" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="newLabel"></a><a id="1563" href="Test.Examples.AccountSim.Validator.html#1563" class="Function">newLabel</a> <a id="1572" class="Symbol">:</a> <a id="1574" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="1588" class="Symbol">-&gt;</a> <a id="1591" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1597" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a>
<a id="1603" href="Test.Examples.AccountSim.Validator.html#1563" class="Function">newLabel</a> <a id="1612" class="Symbol">(</a><a id="1613" class="Keyword">record</a> <a id="1620" class="Symbol">{</a> <a id="1622" href="Test.Prelude.html#1924" class="Field">realizedInputs</a> <a id="1637" class="Symbol">=</a> <a id="1639" href="Test.Examples.AccountSim.Validator.html#1639" class="Bound">realizedInputs</a> <a id="1654" class="Symbol">;</a> <a id="1656" href="Test.Prelude.html#1955" class="Field">txouts</a> <a id="1663" class="Symbol">=</a> <a id="1665" href="Test.Examples.AccountSim.Validator.html#1665" class="Bound">txouts</a> <a id="1672" class="Symbol">;</a> <a id="1674" href="Test.Prelude.html#2000" class="Field">fee</a> <a id="1678" class="Symbol">=</a> <a id="1680" href="Test.Examples.AccountSim.Validator.html#1680" class="Bound">fee</a> <a id="1684" class="Symbol">;</a> <a id="1686" href="Test.Prelude.html#2032" class="Field">mint</a> <a id="1691" class="Symbol">=</a> <a id="1693" href="Test.Examples.AccountSim.Validator.html#1693" class="Bound">mint</a> <a id="1698" class="Symbol">;</a> <a id="1700" href="Test.Prelude.html#2109" class="Field">txwdrls</a> <a id="1708" class="Symbol">=</a> <a id="1710" href="Test.Examples.AccountSim.Validator.html#1710" class="Bound">txwdrls</a> <a id="1718" class="Symbol">;</a> <a id="1720" href="Test.Prelude.html#2164" class="Field">txvldt</a> <a id="1727" class="Symbol">=</a> <a id="1729" href="Test.Examples.AccountSim.Validator.html#1729" class="Bound">txvldt</a> <a id="1736" class="Symbol">;</a> <a id="1738" href="Test.Prelude.html#2215" class="Field">vkey</a> <a id="1743" class="Symbol">=</a> <a id="1745" href="Test.Examples.AccountSim.Validator.html#1745" class="Bound">vkey</a> <a id="1750" class="Symbol">;</a> <a id="1752" href="Test.Prelude.html#2251" class="Field">txdats</a> <a id="1759" class="Symbol">=</a> <a id="1761" href="Test.Examples.AccountSim.Validator.html#1761" class="Bound">txdats</a> <a id="1768" class="Symbol">;</a> <a id="1770" href="Test.Prelude.html#2356" class="Field">txid</a> <a id="1775" class="Symbol">=</a> <a id="1777" href="Test.Examples.AccountSim.Validator.html#1777" class="Bound">txid</a> <a id="1782" class="Symbol">}</a> <a id="1784" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1786" href="Test.Examples.AccountSim.Validator.html#1786" class="Bound">snd</a><a id="1789" class="Symbol">)</a> <a id="1791" class="Keyword">with</a>
  <a id="1798" href="Data.List.Base.html#4606" class="Function">mapMaybe</a> <a id="1807" class="Symbol">(λ</a> <a id="1810" href="Test.Examples.AccountSim.Validator.html#1810" class="Bound">x</a> <a id="1812" class="Symbol">→</a> <a id="1814" href="Test.Examples.AccountSim.Validator.html#1235" class="Function">getInlineOutputDatum</a> <a id="1835" href="Test.Examples.AccountSim.Validator.html#1810" class="Bound">x</a> <a id="1837" href="Test.Examples.AccountSim.Validator.html#1761" class="Bound">txdats</a><a id="1843" class="Symbol">)</a> <a id="1845" class="Symbol">(</a><a id="1846" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1850" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1856" href="Test.Examples.AccountSim.Validator.html#1665" class="Bound">txouts</a><a id="1862" class="Symbol">)</a>
<a id="1864" class="Symbol">...</a> <a id="1868" class="Symbol">|</a> <a id="1870" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1873" class="Symbol">=</a> <a id="1875" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="1883" class="Symbol">...</a> <a id="1887" class="Symbol">|</a> <a id="1889" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1894" class="Symbol">(</a><a id="1895" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1900" href="Test.Examples.AccountSim.Validator.html#1900" class="Bound">x</a><a id="1901" class="Symbol">)</a> <a id="1903" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1905" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1908" class="Symbol">=</a> <a id="1910" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1915" href="Test.Examples.AccountSim.Validator.html#1900" class="Bound">x</a>
<a id="1917" class="CatchallClause Symbol">...</a><a id="1920" class="CatchallClause"> </a><a id="1921" class="CatchallClause Symbol">|</a><a id="1922" class="CatchallClause"> </a><a id="1923" class="CatchallClause Symbol">_</a> <a id="1925" class="Symbol">=</a> <a id="1927" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="continuing"></a><a id="1936" href="Test.Examples.AccountSim.Validator.html#1936" class="Function">continuing</a> <a id="1947" class="Symbol">:</a> <a id="1949" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="1963" class="Symbol">-&gt;</a> <a id="1966" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="1971" href="Test.Examples.AccountSim.Validator.html#1936" class="Function">continuing</a> <a id="1982" class="Symbol">(</a><a id="1983" class="Keyword">record</a> <a id="1990" class="Symbol">{</a> <a id="1992" href="Test.Prelude.html#1924" class="Field">realizedInputs</a> <a id="2007" class="Symbol">=</a> <a id="2009" href="Test.Examples.AccountSim.Validator.html#2009" class="Bound">realizedInputs</a> <a id="2024" class="Symbol">;</a> <a id="2026" href="Test.Prelude.html#1955" class="Field">txouts</a> <a id="2033" class="Symbol">=</a> <a id="2035" href="Test.Examples.AccountSim.Validator.html#2035" class="Bound">txouts</a> <a id="2042" class="Symbol">;</a> <a id="2044" href="Test.Prelude.html#2000" class="Field">fee</a> <a id="2048" class="Symbol">=</a> <a id="2050" href="Test.Examples.AccountSim.Validator.html#2050" class="Bound">fee</a> <a id="2054" class="Symbol">;</a> <a id="2056" href="Test.Prelude.html#2032" class="Field">mint</a> <a id="2061" class="Symbol">=</a> <a id="2063" href="Test.Examples.AccountSim.Validator.html#2063" class="Bound">mint</a> <a id="2068" class="Symbol">;</a> <a id="2070" href="Test.Prelude.html#2109" class="Field">txwdrls</a> <a id="2078" class="Symbol">=</a> <a id="2080" href="Test.Examples.AccountSim.Validator.html#2080" class="Bound">txwdrls</a> <a id="2088" class="Symbol">;</a> <a id="2090" href="Test.Prelude.html#2164" class="Field">txvldt</a> <a id="2097" class="Symbol">=</a> <a id="2099" href="Test.Examples.AccountSim.Validator.html#2099" class="Bound">txvldt</a> <a id="2106" class="Symbol">;</a> <a id="2108" href="Test.Prelude.html#2215" class="Field">vkey</a> <a id="2113" class="Symbol">=</a> <a id="2115" href="Test.Examples.AccountSim.Validator.html#2115" class="Bound">vkey</a> <a id="2120" class="Symbol">;</a> <a id="2122" href="Test.Prelude.html#2251" class="Field">txdats</a> <a id="2129" class="Symbol">=</a> <a id="2131" href="Test.Examples.AccountSim.Validator.html#2131" class="Bound">txdats</a> <a id="2138" class="Symbol">;</a> <a id="2140" href="Test.Prelude.html#2356" class="Field">txid</a> <a id="2145" class="Symbol">=</a> <a id="2147" href="Test.Examples.AccountSim.Validator.html#2147" class="Bound">txid</a> <a id="2152" class="Symbol">}</a> <a id="2154" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2156" href="Test.Examples.AccountSim.Validator.html#2156" class="Bound">snd</a><a id="2159" class="Symbol">)</a> <a id="2161" class="Keyword">with</a>
  <a id="2168" href="Data.List.Base.html#4606" class="Function">mapMaybe</a> <a id="2177" class="Symbol">(λ</a> <a id="2180" href="Test.Examples.AccountSim.Validator.html#2180" class="Bound">x</a> <a id="2182" class="Symbol">→</a> <a id="2184" href="Test.Examples.AccountSim.Validator.html#1235" class="Function">getInlineOutputDatum</a> <a id="2205" href="Test.Examples.AccountSim.Validator.html#2180" class="Bound">x</a> <a id="2207" href="Test.Examples.AccountSim.Validator.html#2131" class="Bound">txdats</a><a id="2213" class="Symbol">)</a> <a id="2215" class="Symbol">(</a><a id="2216" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2220" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="2226" href="Test.Examples.AccountSim.Validator.html#2035" class="Bound">txouts</a><a id="2232" class="Symbol">)</a>
<a id="2234" class="Symbol">...</a> <a id="2238" class="Symbol">|</a> <a id="2240" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2243" class="Symbol">=</a> <a id="2245" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="2251" class="CatchallClause Symbol">...</a><a id="2254" class="CatchallClause"> </a><a id="2255" class="CatchallClause Symbol">|</a><a id="2256" class="CatchallClause"> </a><a id="2257" class="CatchallClause Symbol">_</a> <a id="2259" class="Symbol">=</a> <a id="2261" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>


<a id="getPaymentCredential"></a><a id="2268" href="Test.Examples.AccountSim.Validator.html#2268" class="Function">getPaymentCredential</a> <a id="2289" class="Symbol">:</a> <a id="2291" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="2298" class="Symbol">→</a> <a id="2300" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2302" href="Test.Examples.AccountSim.Validator.html#2268" class="Function">getPaymentCredential</a> <a id="2323" class="Symbol">(</a><a id="2324" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2329" class="Keyword">record</a> <a id="2336" class="Symbol">{</a> <a id="2338" href="Test.Prelude.html#730" class="Field">net</a> <a id="2342" class="Symbol">=</a> <a id="2344" href="Test.Examples.AccountSim.Validator.html#2344" class="Bound">net</a> <a id="2348" class="Symbol">;</a> <a id="2350" href="Test.Prelude.html#756" class="Field">pay</a> <a id="2354" class="Symbol">=</a> <a id="2356" class="Symbol">(</a><a id="2357" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="2368" href="Test.Examples.AccountSim.Validator.html#2368" class="Bound">x</a><a id="2369" class="Symbol">)</a> <a id="2371" class="Symbol">;</a> <a id="2373" href="Test.Prelude.html#785" class="Field">stake</a> <a id="2379" class="Symbol">=</a> <a id="2381" href="Test.Examples.AccountSim.Validator.html#2381" class="Bound">stake</a> <a id="2387" class="Symbol">}</a> <a id="2389" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2391" href="Test.Examples.AccountSim.Validator.html#2391" class="Bound">snd</a><a id="2394" class="Symbol">)</a> <a id="2396" class="Symbol">=</a> <a id="2398" href="Test.Examples.AccountSim.Validator.html#2368" class="Bound">x</a>
<a id="2400" href="Test.Examples.AccountSim.Validator.html#2268" class="Function">getPaymentCredential</a> <a id="2421" class="Symbol">(</a><a id="2422" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2427" class="Keyword">record</a> <a id="2434" class="Symbol">{</a> <a id="2436" href="Test.Prelude.html#730" class="Field">net</a> <a id="2440" class="Symbol">=</a> <a id="2442" href="Test.Examples.AccountSim.Validator.html#2442" class="Bound">net</a> <a id="2446" class="Symbol">;</a> <a id="2448" href="Test.Prelude.html#756" class="Field">pay</a> <a id="2452" class="Symbol">=</a> <a id="2454" class="Symbol">(</a><a id="2455" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="2465" href="Test.Examples.AccountSim.Validator.html#2465" class="Bound">x</a><a id="2466" class="Symbol">)</a> <a id="2468" class="Symbol">;</a> <a id="2470" href="Test.Prelude.html#785" class="Field">stake</a> <a id="2476" class="Symbol">=</a> <a id="2478" href="Test.Examples.AccountSim.Validator.html#2478" class="Bound">stake</a> <a id="2484" class="Symbol">}</a> <a id="2486" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2488" href="Test.Examples.AccountSim.Validator.html#2488" class="Bound">snd</a><a id="2491" class="Symbol">)</a> <a id="2493" class="Symbol">=</a> <a id="2495" href="Test.Examples.AccountSim.Validator.html#2465" class="Bound">x</a>
<a id="2497" href="Test.Examples.AccountSim.Validator.html#2268" class="Function">getPaymentCredential</a> <a id="2518" class="Symbol">(</a><a id="2519" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2524" class="Keyword">record</a> <a id="2531" class="Symbol">{</a> <a id="2533" href="Test.Prelude.html#956" class="Field">net</a> <a id="2537" class="Symbol">=</a> <a id="2539" href="Test.Examples.AccountSim.Validator.html#2539" class="Bound">net</a> <a id="2543" class="Symbol">;</a> <a id="2545" href="Test.Prelude.html#986" class="Field">pay</a> <a id="2549" class="Symbol">=</a> <a id="2551" class="Symbol">(</a><a id="2552" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="2563" href="Test.Examples.AccountSim.Validator.html#2563" class="Bound">x</a><a id="2564" class="Symbol">)</a> <a id="2566" class="Symbol">;</a> <a id="2568" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="2578" class="Symbol">=</a> <a id="2580" href="Test.Examples.AccountSim.Validator.html#2580" class="Bound">attrsSize</a> <a id="2590" class="Symbol">}</a> <a id="2592" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2594" href="Test.Examples.AccountSim.Validator.html#2594" class="Bound">snd</a><a id="2597" class="Symbol">)</a> <a id="2599" class="Symbol">=</a> <a id="2601" href="Test.Examples.AccountSim.Validator.html#2563" class="Bound">x</a>
<a id="2603" href="Test.Examples.AccountSim.Validator.html#2268" class="Function">getPaymentCredential</a> <a id="2624" class="Symbol">(</a><a id="2625" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2630" class="Keyword">record</a> <a id="2637" class="Symbol">{</a> <a id="2639" href="Test.Prelude.html#956" class="Field">net</a> <a id="2643" class="Symbol">=</a> <a id="2645" href="Test.Examples.AccountSim.Validator.html#2645" class="Bound">net</a> <a id="2649" class="Symbol">;</a> <a id="2651" href="Test.Prelude.html#986" class="Field">pay</a> <a id="2655" class="Symbol">=</a> <a id="2657" class="Symbol">(</a><a id="2658" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="2668" href="Test.Examples.AccountSim.Validator.html#2668" class="Bound">x</a><a id="2669" class="Symbol">)</a> <a id="2671" class="Symbol">;</a> <a id="2673" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="2683" class="Symbol">=</a> <a id="2685" href="Test.Examples.AccountSim.Validator.html#2685" class="Bound">attrsSize</a> <a id="2695" class="Symbol">}</a> <a id="2697" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2699" href="Test.Examples.AccountSim.Validator.html#2699" class="Bound">snd</a><a id="2702" class="Symbol">)</a> <a id="2704" class="Symbol">=</a> <a id="2706" href="Test.Examples.AccountSim.Validator.html#2668" class="Bound">x</a>


<a id="getScriptCredential&#39;"></a><a id="2710" href="Test.Examples.AccountSim.Validator.html#2710" class="Function">getScriptCredential&#39;</a> <a id="2731" class="Symbol">:</a> <a id="2733" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2735" class="Symbol">→</a> <a id="2737" href="Test.Prelude.html#1311" class="Function">SUTxO</a> <a id="2743" class="Symbol">→</a> <a id="2745" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2751" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2753" href="Test.Examples.AccountSim.Validator.html#2710" class="Function">getScriptCredential&#39;</a> <a id="2774" href="Test.Examples.AccountSim.Validator.html#2774" class="Bound">ix</a> <a id="2777" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2780" class="Symbol">=</a> <a id="2782" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2790" href="Test.Examples.AccountSim.Validator.html#2710" class="Function">getScriptCredential&#39;</a> <a id="2811" href="Test.Examples.AccountSim.Validator.html#2811" class="Bound">ix</a> <a id="2814" class="Symbol">(((</a><a id="2817" href="Test.Examples.AccountSim.Validator.html#2817" class="Bound">txid&#39;</a> <a id="2823" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2825" href="Test.Examples.AccountSim.Validator.html#2825" class="Bound">ix&#39;</a><a id="2828" class="Symbol">)</a> <a id="2830" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2832" href="Test.Examples.AccountSim.Validator.html#2832" class="Bound">txout</a><a id="2837" class="Symbol">)</a> <a id="2839" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2841" href="Test.Examples.AccountSim.Validator.html#2841" class="Bound">utxos</a><a id="2846" class="Symbol">)</a> <a id="2848" class="Keyword">with</a> <a id="2853" href="Test.Examples.AccountSim.Validator.html#2811" class="Bound">ix</a> <a id="2856" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="2858" href="Test.Examples.AccountSim.Validator.html#2825" class="Bound">ix&#39;</a>
<a id="2862" class="Symbol">...</a> <a id="2866" class="Symbol">|</a> <a id="2868" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2871" href="Test.Examples.AccountSim.Validator.html#2871" class="Bound">¬a</a> <a id="2874" class="Symbol">=</a> <a id="2876" href="Test.Examples.AccountSim.Validator.html#2710" class="Function">getScriptCredential&#39;</a> <a id="2897" class="Bound">ix</a> <a id="2900" class="Bound">utxos</a>
<a id="2906" class="Symbol">...</a> <a id="2910" class="Symbol">|</a> <a id="2912" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2916" href="Test.Examples.AccountSim.Validator.html#2916" class="Bound">a</a> <a id="2918" class="Symbol">=</a> <a id="2920" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2925" class="Symbol">(</a><a id="2926" href="Test.Examples.AccountSim.Validator.html#2268" class="Function">getPaymentCredential</a> <a id="2947" class="Bound">txout</a><a id="2952" class="Symbol">)</a>


<a id="getScriptCredential"></a><a id="2956" href="Test.Examples.AccountSim.Validator.html#2956" class="Function">getScriptCredential</a> <a id="2976" class="Symbol">:</a> <a id="2978" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="2992" class="Symbol">→</a> <a id="2994" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3000" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="3002" href="Test.Examples.AccountSim.Validator.html#2956" class="Function">getScriptCredential</a> <a id="3022" class="Symbol">(</a><a id="3023" href="Test.Examples.AccountSim.Validator.html#3023" class="Bound">fst</a> <a id="3027" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3029" href="Test.Prelude.html#1627" class="InductiveConstructor">Rwrd</a> <a id="3034" href="Test.Examples.AccountSim.Validator.html#3034" class="Bound">x</a><a id="3035" class="Symbol">)</a> <a id="3037" class="Symbol">=</a> <a id="3039" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="3047" href="Test.Examples.AccountSim.Validator.html#2956" class="Function">getScriptCredential</a> <a id="3067" class="Symbol">(</a><a id="3068" href="Test.Examples.AccountSim.Validator.html#3068" class="Bound">fst</a> <a id="3072" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3074" href="Test.Prelude.html#1672" class="InductiveConstructor">Mint</a> <a id="3079" href="Test.Examples.AccountSim.Validator.html#3079" class="Bound">x</a><a id="3080" class="Symbol">)</a> <a id="3082" class="Symbol">=</a> <a id="3084" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="3092" href="Test.Examples.AccountSim.Validator.html#2956" class="Function">getScriptCredential</a> <a id="3112" class="Symbol">(</a><a id="3113" href="Test.Examples.AccountSim.Validator.html#3113" class="Bound">txinfo</a> <a id="3120" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3122" href="Test.Prelude.html#1709" class="InductiveConstructor">Spend</a> <a id="3128" class="Symbol">(</a><a id="3129" href="Test.Examples.AccountSim.Validator.html#3129" class="Bound">txid</a> <a id="3134" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3136" href="Test.Examples.AccountSim.Validator.html#3136" class="Bound">ix</a><a id="3138" class="Symbol">))</a> <a id="3141" class="Symbol">=</a> <a id="3143" href="Test.Examples.AccountSim.Validator.html#2710" class="Function">getScriptCredential&#39;</a> <a id="3164" href="Test.Examples.AccountSim.Validator.html#3136" class="Bound">ix</a> <a id="3167" class="Symbol">(</a><a id="3168" href="Test.Prelude.html#1924" class="Field">STxInfo.realizedInputs</a> <a id="3191" href="Test.Examples.AccountSim.Validator.html#3113" class="Bound">txinfo</a><a id="3197" class="Symbol">)</a>
<a id="3199" href="Test.Examples.AccountSim.Validator.html#2956" class="Function">getScriptCredential</a> <a id="3219" class="Symbol">(</a><a id="3220" href="Test.Examples.AccountSim.Validator.html#3220" class="Bound">fst</a> <a id="3224" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3226" href="Test.Prelude.html#1745" class="InductiveConstructor">Empty</a><a id="3231" class="Symbol">)</a> <a id="3233" class="Symbol">=</a> <a id="3235" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="balanceSTxOut"></a><a id="3244" href="Test.Examples.AccountSim.Validator.html#3244" class="Function">balanceSTxOut</a> <a id="3258" class="Symbol">:</a> <a id="3260" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3265" href="Test.Prelude.html#1201" class="Function">STxOut</a> <a id="3272" class="Symbol">→</a> <a id="3274" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="3280" href="Test.Examples.AccountSim.Validator.html#3244" class="Function">balanceSTxOut</a> <a id="3294" href="Test.Examples.AccountSim.Validator.html#3294" class="Bound">txout</a> <a id="3300" class="Symbol">=</a> <a id="3302" href="Data.List.Base.html#4126" class="Function">foldr</a> <a id="3308" class="Symbol">(</a><a id="3309" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3313" class="Symbol">{{</a><a id="3315" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#1274" class="Function">addValue</a><a id="3323" class="Symbol">}})</a> <a id="3327" href="Test.Examples.AccountSim.Validator.html#798" class="Function">emptyValue</a> <a id="3338" class="Symbol">(</a><a id="3339" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="3343" class="Symbol">(λ</a> <a id="3346" class="Symbol">{(_</a> <a id="3350" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3352" href="Test.Examples.AccountSim.Validator.html#3352" class="Bound">v</a> <a id="3354" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3356" class="Symbol">_)</a> <a id="3359" class="Symbol">→</a> <a id="3361" href="Test.Examples.AccountSim.Validator.html#3352" class="Bound">v</a><a id="3362" class="Symbol">})</a> <a id="3365" href="Test.Examples.AccountSim.Validator.html#3294" class="Bound">txout</a><a id="3370" class="Symbol">)</a>

<a id="matchIx"></a><a id="3373" href="Test.Examples.AccountSim.Validator.html#3373" class="Function">matchIx</a> <a id="3381" class="Symbol">:</a> <a id="3383" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3385" class="Symbol">→</a> <a id="3387" href="Test.Prelude.html#1151" class="Function">SAddr</a> <a id="3393" class="Symbol">→</a> <a id="3395" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="3399" href="Test.Examples.AccountSim.Validator.html#3373" class="Function">matchIx</a> <a id="3407" href="Test.Examples.AccountSim.Validator.html#3407" class="Bound">n</a> <a id="3409" class="Symbol">(</a><a id="3410" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3415" class="Keyword">record</a> <a id="3422" class="Symbol">{</a> <a id="3424" href="Test.Prelude.html#730" class="Field">net</a> <a id="3428" class="Symbol">=</a> <a id="3430" href="Test.Examples.AccountSim.Validator.html#3430" class="Bound">net</a> <a id="3434" class="Symbol">;</a> <a id="3436" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3440" class="Symbol">=</a> <a id="3442" class="Symbol">(</a><a id="3443" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3454" href="Test.Examples.AccountSim.Validator.html#3454" class="Bound">x</a><a id="3455" class="Symbol">)</a> <a id="3457" class="Symbol">;</a> <a id="3459" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3465" class="Symbol">=</a> <a id="3467" href="Test.Examples.AccountSim.Validator.html#3467" class="Bound">stake</a> <a id="3473" class="Symbol">})</a> <a id="3476" class="Symbol">=</a> <a id="3478" href="Test.Examples.AccountSim.Validator.html#3407" class="Bound">n</a> <a id="3480" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3482" href="Test.Examples.AccountSim.Validator.html#3454" class="Bound">x</a>
<a id="3484" href="Test.Examples.AccountSim.Validator.html#3373" class="Function">matchIx</a> <a id="3492" href="Test.Examples.AccountSim.Validator.html#3492" class="Bound">n</a> <a id="3494" class="Symbol">(</a><a id="3495" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3500" class="Keyword">record</a> <a id="3507" class="Symbol">{</a> <a id="3509" href="Test.Prelude.html#730" class="Field">net</a> <a id="3513" class="Symbol">=</a> <a id="3515" href="Test.Examples.AccountSim.Validator.html#3515" class="Bound">net</a> <a id="3519" class="Symbol">;</a> <a id="3521" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3525" class="Symbol">=</a> <a id="3527" class="Symbol">(</a><a id="3528" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3538" href="Test.Examples.AccountSim.Validator.html#3538" class="Bound">y</a><a id="3539" class="Symbol">)</a> <a id="3541" class="Symbol">;</a> <a id="3543" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3549" class="Symbol">=</a> <a id="3551" href="Test.Examples.AccountSim.Validator.html#3551" class="Bound">stake</a> <a id="3557" class="Symbol">})</a> <a id="3560" class="Symbol">=</a> <a id="3562" href="Test.Examples.AccountSim.Validator.html#3492" class="Bound">n</a> <a id="3564" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3566" href="Test.Examples.AccountSim.Validator.html#3538" class="Bound">y</a>
<a id="3568" href="Test.Examples.AccountSim.Validator.html#3373" class="Function">matchIx</a> <a id="3576" href="Test.Examples.AccountSim.Validator.html#3576" class="Bound">n</a> <a id="3578" class="Symbol">(</a><a id="3579" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3584" class="Keyword">record</a> <a id="3591" class="Symbol">{</a> <a id="3593" href="Test.Prelude.html#956" class="Field">net</a> <a id="3597" class="Symbol">=</a> <a id="3599" href="Test.Examples.AccountSim.Validator.html#3599" class="Bound">net</a> <a id="3603" class="Symbol">;</a> <a id="3605" href="Test.Prelude.html#986" class="Field">pay</a> <a id="3609" class="Symbol">=</a> <a id="3611" class="Symbol">(</a><a id="3612" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3623" href="Test.Examples.AccountSim.Validator.html#3623" class="Bound">x</a><a id="3624" class="Symbol">)</a> <a id="3626" class="Symbol">;</a> <a id="3628" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="3638" class="Symbol">=</a> <a id="3640" href="Test.Examples.AccountSim.Validator.html#3640" class="Bound">attrsSize</a> <a id="3650" class="Symbol">})</a> <a id="3653" class="Symbol">=</a> <a id="3655" href="Test.Examples.AccountSim.Validator.html#3576" class="Bound">n</a> <a id="3657" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3659" href="Test.Examples.AccountSim.Validator.html#3623" class="Bound">x</a>
<a id="3661" href="Test.Examples.AccountSim.Validator.html#3373" class="Function">matchIx</a> <a id="3669" href="Test.Examples.AccountSim.Validator.html#3669" class="Bound">n</a> <a id="3671" class="Symbol">(</a><a id="3672" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3677" class="Keyword">record</a> <a id="3684" class="Symbol">{</a> <a id="3686" href="Test.Prelude.html#956" class="Field">net</a> <a id="3690" class="Symbol">=</a> <a id="3692" href="Test.Examples.AccountSim.Validator.html#3692" class="Bound">net</a> <a id="3696" class="Symbol">;</a> <a id="3698" href="Test.Prelude.html#986" class="Field">pay</a> <a id="3702" class="Symbol">=</a> <a id="3704" class="Symbol">(</a><a id="3705" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3715" href="Test.Examples.AccountSim.Validator.html#3715" class="Bound">y</a><a id="3716" class="Symbol">)</a> <a id="3718" class="Symbol">;</a> <a id="3720" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="3730" class="Symbol">=</a> <a id="3732" href="Test.Examples.AccountSim.Validator.html#3732" class="Bound">attrsSize</a> <a id="3742" class="Symbol">})</a> <a id="3745" class="Symbol">=</a> <a id="3747" href="Test.Examples.AccountSim.Validator.html#3669" class="Bound">n</a> <a id="3749" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3751" href="Test.Examples.AccountSim.Validator.html#3715" class="Bound">y</a>

<a id="matchIx?"></a><a id="3754" href="Test.Examples.AccountSim.Validator.html#3754" class="Function">matchIx?</a> <a id="3763" class="Symbol">:</a> <a id="3765" class="Symbol">(</a><a id="3766" href="Test.Examples.AccountSim.Validator.html#3766" class="Bound">n</a> <a id="3768" class="Symbol">:</a> <a id="3770" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="3771" class="Symbol">)</a> <a id="3773" class="Symbol">→</a> <a id="3775" class="Symbol">(</a><a id="3776" href="Test.Examples.AccountSim.Validator.html#3776" class="Bound">a</a> <a id="3778" class="Symbol">:</a> <a id="3780" href="Test.Prelude.html#1151" class="Function">SAddr</a><a id="3785" class="Symbol">)</a> <a id="3787" class="Symbol">→</a> <a id="3789" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="3793" class="Symbol">(</a><a id="3794" href="Test.Examples.AccountSim.Validator.html#3373" class="Function">matchIx</a> <a id="3802" href="Test.Examples.AccountSim.Validator.html#3766" class="Bound">n</a> <a id="3804" href="Test.Examples.AccountSim.Validator.html#3776" class="Bound">a</a><a id="3805" class="Symbol">)</a>
<a id="3807" href="Test.Examples.AccountSim.Validator.html#3754" class="Function">matchIx?</a> <a id="3816" href="Test.Examples.AccountSim.Validator.html#3816" class="Bound">n</a> <a id="3818" class="Symbol">(</a><a id="3819" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3824" class="Keyword">record</a> <a id="3831" class="Symbol">{</a> <a id="3833" href="Test.Prelude.html#730" class="Field">net</a> <a id="3837" class="Symbol">=</a> <a id="3839" href="Test.Examples.AccountSim.Validator.html#3839" class="Bound">net</a> <a id="3843" class="Symbol">;</a> <a id="3845" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3849" class="Symbol">=</a> <a id="3851" class="Symbol">(</a><a id="3852" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="3863" href="Test.Examples.AccountSim.Validator.html#3863" class="Bound">x</a><a id="3864" class="Symbol">)</a> <a id="3866" class="Symbol">;</a> <a id="3868" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3874" class="Symbol">=</a> <a id="3876" href="Test.Examples.AccountSim.Validator.html#3876" class="Bound">stake</a> <a id="3882" class="Symbol">})</a> <a id="3885" class="Symbol">=</a> <a id="3887" href="Test.Examples.AccountSim.Validator.html#3816" class="Bound">n</a> <a id="3889" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="3891" href="Test.Examples.AccountSim.Validator.html#3863" class="Bound">x</a>
<a id="3893" href="Test.Examples.AccountSim.Validator.html#3754" class="Function">matchIx?</a> <a id="3902" href="Test.Examples.AccountSim.Validator.html#3902" class="Bound">n</a> <a id="3904" class="Symbol">(</a><a id="3905" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="3910" class="Keyword">record</a> <a id="3917" class="Symbol">{</a> <a id="3919" href="Test.Prelude.html#730" class="Field">net</a> <a id="3923" class="Symbol">=</a> <a id="3925" href="Test.Examples.AccountSim.Validator.html#3925" class="Bound">net</a> <a id="3929" class="Symbol">;</a> <a id="3931" href="Test.Prelude.html#756" class="Field">pay</a> <a id="3935" class="Symbol">=</a> <a id="3937" class="Symbol">(</a><a id="3938" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="3948" href="Test.Examples.AccountSim.Validator.html#3948" class="Bound">y</a><a id="3949" class="Symbol">)</a> <a id="3951" class="Symbol">;</a> <a id="3953" href="Test.Prelude.html#785" class="Field">stake</a> <a id="3959" class="Symbol">=</a> <a id="3961" href="Test.Examples.AccountSim.Validator.html#3961" class="Bound">stake</a> <a id="3967" class="Symbol">})</a> <a id="3970" class="Symbol">=</a> <a id="3972" href="Test.Examples.AccountSim.Validator.html#3902" class="Bound">n</a> <a id="3974" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="3976" href="Test.Examples.AccountSim.Validator.html#3948" class="Bound">y</a>
<a id="3978" href="Test.Examples.AccountSim.Validator.html#3754" class="Function">matchIx?</a> <a id="3987" href="Test.Examples.AccountSim.Validator.html#3987" class="Bound">n</a> <a id="3989" class="Symbol">(</a><a id="3990" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3995" class="Keyword">record</a> <a id="4002" class="Symbol">{</a> <a id="4004" href="Test.Prelude.html#956" class="Field">net</a> <a id="4008" class="Symbol">=</a> <a id="4010" href="Test.Examples.AccountSim.Validator.html#4010" class="Bound">net</a> <a id="4014" class="Symbol">;</a> <a id="4016" href="Test.Prelude.html#986" class="Field">pay</a> <a id="4020" class="Symbol">=</a> <a id="4022" class="Symbol">(</a><a id="4023" href="Test.Prelude.html#525" class="InductiveConstructor">KeyHashObj</a> <a id="4034" href="Test.Examples.AccountSim.Validator.html#4034" class="Bound">x</a><a id="4035" class="Symbol">)</a> <a id="4037" class="Symbol">;</a> <a id="4039" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="4049" class="Symbol">=</a> <a id="4051" href="Test.Examples.AccountSim.Validator.html#4051" class="Bound">attrsSize</a> <a id="4061" class="Symbol">})</a> <a id="4064" class="Symbol">=</a> <a id="4066" href="Test.Examples.AccountSim.Validator.html#3987" class="Bound">n</a> <a id="4068" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="4070" href="Test.Examples.AccountSim.Validator.html#4034" class="Bound">x</a>
<a id="4072" href="Test.Examples.AccountSim.Validator.html#3754" class="Function">matchIx?</a> <a id="4081" href="Test.Examples.AccountSim.Validator.html#4081" class="Bound">n</a> <a id="4083" class="Symbol">(</a><a id="4084" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="4089" class="Keyword">record</a> <a id="4096" class="Symbol">{</a> <a id="4098" href="Test.Prelude.html#956" class="Field">net</a> <a id="4102" class="Symbol">=</a> <a id="4104" href="Test.Examples.AccountSim.Validator.html#4104" class="Bound">net</a> <a id="4108" class="Symbol">;</a> <a id="4110" href="Test.Prelude.html#986" class="Field">pay</a> <a id="4114" class="Symbol">=</a> <a id="4116" class="Symbol">(</a><a id="4117" href="Test.Prelude.html#556" class="InductiveConstructor">ScriptObj</a> <a id="4127" href="Test.Examples.AccountSim.Validator.html#4127" class="Bound">y</a><a id="4128" class="Symbol">)</a> <a id="4130" class="Symbol">;</a> <a id="4132" href="Test.Prelude.html#1019" class="Field">attrsSize</a> <a id="4142" class="Symbol">=</a> <a id="4144" href="Test.Examples.AccountSim.Validator.html#4144" class="Bound">attrsSize</a> <a id="4154" class="Symbol">})</a> <a id="4157" class="Symbol">=</a> <a id="4159" href="Test.Examples.AccountSim.Validator.html#4081" class="Bound">n</a> <a id="4161" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="4163" href="Test.Examples.AccountSim.Validator.html#4127" class="Bound">y</a>


<a id="totalOuts"></a><a id="4167" href="Test.Examples.AccountSim.Validator.html#4167" class="Function">totalOuts</a> <a id="4177" class="Symbol">:</a> <a id="4179" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4193" class="Symbol">→</a> <a id="4195" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4206" class="Symbol">→</a> <a id="4208" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="4214" href="Test.Examples.AccountSim.Validator.html#4167" class="Function">totalOuts</a> <a id="4224" class="Symbol">(</a><a id="4225" href="Test.Examples.AccountSim.Validator.html#4225" class="Bound">txinfo</a> <a id="4232" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4234" class="Symbol">_)</a> <a id="4237" href="Test.Examples.AccountSim.Validator.html#4237" class="Bound">ph</a>  <a id="4241" class="Symbol">=</a> <a id="4243" href="Test.Examples.AccountSim.Validator.html#3244" class="Function">balanceSTxOut</a> <a id="4257" class="Symbol">(</a><a id="4258" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="4265" class="Symbol">(λ</a> <a id="4268" class="Symbol">{</a> <a id="4270" class="Symbol">(</a><a id="4271" href="Test.Examples.AccountSim.Validator.html#4271" class="Bound">fst</a> <a id="4275" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4277" href="Test.Examples.AccountSim.Validator.html#4277" class="Bound">snd</a><a id="4280" class="Symbol">)</a> <a id="4282" class="Symbol">→</a> <a id="4284" href="Test.Examples.AccountSim.Validator.html#3754" class="Function">matchIx?</a> <a id="4293" href="Test.Examples.AccountSim.Validator.html#4237" class="Bound">ph</a> <a id="4296" href="Test.Examples.AccountSim.Validator.html#4271" class="Bound">fst</a><a id="4299" class="Symbol">})</a> <a id="4302" class="Symbol">(</a><a id="4303" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="4307" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4313" class="Symbol">(</a><a id="4314" href="Test.Prelude.html#1955" class="Field">STxInfo.txouts</a> <a id="4329" href="Test.Examples.AccountSim.Validator.html#4225" class="Bound">txinfo</a><a id="4335" class="Symbol">)))</a>

<a id="totalIns"></a><a id="4340" href="Test.Examples.AccountSim.Validator.html#4340" class="Function">totalIns</a> <a id="4349" class="Symbol">:</a> <a id="4351" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4365" class="Symbol">→</a> <a id="4367" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4378" class="Symbol">→</a> <a id="4380" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="4386" href="Test.Examples.AccountSim.Validator.html#4340" class="Function">totalIns</a> <a id="4395" class="Symbol">(</a><a id="4396" href="Test.Examples.AccountSim.Validator.html#4396" class="Bound">txinfo</a> <a id="4403" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4405" class="Symbol">_)</a> <a id="4408" href="Test.Examples.AccountSim.Validator.html#4408" class="Bound">ph</a>  <a id="4412" class="Symbol">=</a> <a id="4414" href="Test.Examples.AccountSim.Validator.html#3244" class="Function">balanceSTxOut</a> <a id="4428" class="Symbol">(</a><a id="4429" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="4436" class="Symbol">(λ</a> <a id="4439" class="Symbol">{</a> <a id="4441" class="Symbol">(</a><a id="4442" href="Test.Examples.AccountSim.Validator.html#4442" class="Bound">fst</a> <a id="4446" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4448" href="Test.Examples.AccountSim.Validator.html#4448" class="Bound">snd</a><a id="4451" class="Symbol">)</a> <a id="4453" class="Symbol">→</a> <a id="4455" href="Test.Examples.AccountSim.Validator.html#3754" class="Function">matchIx?</a> <a id="4464" href="Test.Examples.AccountSim.Validator.html#4408" class="Bound">ph</a> <a id="4467" href="Test.Examples.AccountSim.Validator.html#4442" class="Bound">fst</a><a id="4470" class="Symbol">})</a> <a id="4473" class="Symbol">(</a><a id="4474" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="4478" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4484" class="Symbol">(</a><a id="4485" href="Test.Prelude.html#1924" class="Field">STxInfo.realizedInputs</a> <a id="4508" href="Test.Examples.AccountSim.Validator.html#4396" class="Bound">txinfo</a><a id="4514" class="Symbol">)))</a>

<a id="4519" class="Comment">-- Get the value of txouts for own script</a>
<a id="newValue"></a><a id="4561" href="Test.Examples.AccountSim.Validator.html#4561" class="Function">newValue</a> <a id="4570" class="Symbol">:</a> <a id="4572" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4586" class="Symbol">→</a> <a id="4588" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4594" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="4600" href="Test.Examples.AccountSim.Validator.html#4561" class="Function">newValue</a> <a id="4609" href="Test.Examples.AccountSim.Validator.html#4609" class="Bound">sc</a><a id="4611" class="Symbol">@(</a><a id="4613" href="Test.Examples.AccountSim.Validator.html#4613" class="Bound">txinfo</a> <a id="4620" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4622" href="Test.Examples.AccountSim.Validator.html#4622" class="Bound">sp</a><a id="4624" class="Symbol">)</a> <a id="4626" class="Keyword">with</a> <a id="4631" href="Test.Examples.AccountSim.Validator.html#2956" class="Function">getScriptCredential</a> <a id="4651" href="Test.Examples.AccountSim.Validator.html#4609" class="Bound">sc</a>
<a id="4654" class="Symbol">...</a> <a id="4658" class="Symbol">|</a> <a id="4660" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="4668" class="Symbol">=</a> <a id="4670" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="4678" class="Symbol">...</a> <a id="4682" class="Symbol">|</a> <a id="4684" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4689" href="Test.Examples.AccountSim.Validator.html#4689" class="Bound">sh</a> <a id="4692" class="Symbol">=</a> <a id="4694" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4699" class="Symbol">(</a><a id="4700" href="Test.Examples.AccountSim.Validator.html#4167" class="Function">totalOuts</a> <a id="4710" class="Bound">sc</a> <a id="4713" href="Test.Examples.AccountSim.Validator.html#4689" class="Bound">sh</a><a id="4715" class="Symbol">)</a>

<a id="oldValue"></a><a id="4718" href="Test.Examples.AccountSim.Validator.html#4718" class="Function">oldValue</a> <a id="4727" class="Symbol">:</a> <a id="4729" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4743" class="Symbol">→</a> <a id="4745" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4751" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="4757" href="Test.Examples.AccountSim.Validator.html#4718" class="Function">oldValue</a> <a id="4766" href="Test.Examples.AccountSim.Validator.html#4766" class="Bound">sc</a><a id="4768" class="Symbol">@(</a><a id="4770" href="Test.Examples.AccountSim.Validator.html#4770" class="Bound">txinfo</a> <a id="4777" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4779" href="Test.Examples.AccountSim.Validator.html#4779" class="Bound">sp</a><a id="4781" class="Symbol">)</a> <a id="4783" class="Keyword">with</a> <a id="4788" href="Test.Examples.AccountSim.Validator.html#2956" class="Function">getScriptCredential</a> <a id="4808" href="Test.Examples.AccountSim.Validator.html#4766" class="Bound">sc</a>
<a id="4811" class="Symbol">...</a> <a id="4815" class="Symbol">|</a> <a id="4817" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="4825" class="Symbol">=</a> <a id="4827" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="4835" class="Symbol">...</a> <a id="4839" class="Symbol">|</a> <a id="4841" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4846" href="Test.Examples.AccountSim.Validator.html#4846" class="Bound">sh</a> <a id="4849" class="Symbol">=</a> <a id="4851" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4856" class="Symbol">(</a><a id="4857" href="Test.Examples.AccountSim.Validator.html#4340" class="Function">totalIns</a> <a id="4866" class="Bound">sc</a> <a id="4869" href="Test.Examples.AccountSim.Validator.html#4846" class="Bound">sh</a><a id="4871" class="Symbol">)</a>


<a id="4875" class="Keyword">open</a> <a id="4880" class="Keyword">import</a> <a id="4887" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="checkSigned"></a><a id="4915" href="Test.Examples.AccountSim.Validator.html#4915" class="Function">checkSigned</a> <a id="4927" class="Symbol">:</a> <a id="4929" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="4940" class="Symbol">→</a> <a id="4942" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="4956" class="Symbol">→</a> <a id="4958" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4963" href="Test.Examples.AccountSim.Validator.html#4915" class="Function">checkSigned</a> <a id="4975" href="Test.Examples.AccountSim.Validator.html#4975" class="Bound">ph</a> <a id="4978" class="Symbol">(</a><a id="4979" href="Test.Examples.AccountSim.Validator.html#4979" class="Bound">txinfo</a> <a id="4986" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4988" class="Symbol">_)</a> <a id="4991" class="Symbol">=</a> <a id="4993" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="4995" class="Symbol">(</a><a id="4996" href="Test.Examples.AccountSim.Validator.html#4975" class="Bound">ph</a> <a id="4999" href="Axiom.Set.html#11038" class="Function Operator">∈?</a> <a id="5002" class="Symbol">(</a><a id="5003" href="Test.Prelude.html#2215" class="Field">STxInfo.vkey</a> <a id="5016" href="Test.Examples.AccountSim.Validator.html#4979" class="Bound">txinfo</a><a id="5022" class="Symbol">))</a> <a id="5025" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="query"></a><a id="5028" href="Test.Examples.AccountSim.Validator.html#5028" class="Function">query</a> <a id="5034" class="Symbol">:</a> <a id="5036" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5047" class="Symbol">→</a> <a id="5049" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5054" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5065" class="Symbol">→</a> <a id="5067" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5072" href="Test.Examples.AccountSim.Validator.html#5028" class="Function">query</a> <a id="5078" href="Test.Examples.AccountSim.Validator.html#5078" class="Bound">ph</a> <a id="5081" href="Test.Examples.AccountSim.Validator.html#5081" class="Bound">xs</a> <a id="5084" class="Symbol">=</a> <a id="5086" href="Data.Bool.ListAction.html#874" class="Function">any</a> <a id="5090" class="Symbol">(λ</a> <a id="5093" href="Test.Examples.AccountSim.Validator.html#5093" class="Bound">k</a> <a id="5095" class="Symbol">→</a>  <a id="5098" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5100" href="Test.Examples.AccountSim.Validator.html#5078" class="Bound">ph</a> <a id="5103" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="5105" href="Test.Examples.AccountSim.Validator.html#5093" class="Bound">k</a> <a id="5107" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a><a id="5108" class="Symbol">)</a> <a id="5110" href="Test.Examples.AccountSim.Validator.html#5081" class="Bound">xs</a>

<a id="checkPayment"></a><a id="5114" href="Test.Examples.AccountSim.Validator.html#5114" class="Function">checkPayment</a> <a id="5127" class="Symbol">:</a> <a id="5129" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5140" class="Symbol">-&gt;</a> <a id="5143" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="5149" class="Symbol">-&gt;</a> <a id="5152" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="5166" class="Symbol">-&gt;</a> <a id="5169" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5174" href="Test.Examples.AccountSim.Validator.html#5114" class="Function">checkPayment</a> <a id="5187" href="Test.Examples.AccountSim.Validator.html#5187" class="Bound">pkh</a> <a id="5191" href="Test.Examples.AccountSim.Validator.html#5191" class="Bound">v</a> <a id="5193" href="Test.Examples.AccountSim.Validator.html#5193" class="Bound">ctx</a> <a id="5197" class="Symbol">=</a> <a id="5199" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5201" href="Test.Examples.AccountSim.Validator.html#4167" class="Function">totalOuts</a> <a id="5211" href="Test.Examples.AccountSim.Validator.html#5193" class="Bound">ctx</a> <a id="5215" href="Test.Examples.AccountSim.Validator.html#5187" class="Bound">pkh</a> <a id="5219" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="5221" class="Symbol">(</a><a id="5222" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="5226" class="Symbol">{{</a><a id="5228" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#1274" class="Function">addValue</a><a id="5236" class="Symbol">}}</a> <a id="5239" class="Symbol">(</a><a id="5240" href="Test.Examples.AccountSim.Validator.html#4340" class="Function">totalIns</a> <a id="5249" href="Test.Examples.AccountSim.Validator.html#5193" class="Bound">ctx</a> <a id="5253" href="Test.Examples.AccountSim.Validator.html#5187" class="Bound">pkh</a><a id="5256" class="Symbol">)</a> <a id="5258" href="Test.Examples.AccountSim.Validator.html#5191" class="Bound">v</a><a id="5259" class="Symbol">)</a> <a id="5261" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="expired"></a><a id="5264" href="Test.Examples.AccountSim.Validator.html#5264" class="Function">expired</a> <a id="5272" class="Symbol">:</a> <a id="5274" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5276" class="Symbol">-&gt;</a> <a id="5279" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="5293" class="Symbol">-&gt;</a> <a id="5296" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5301" href="Test.Examples.AccountSim.Validator.html#5264" class="Function">expired</a> <a id="5309" href="Test.Examples.AccountSim.Validator.html#5309" class="Bound">slot</a> <a id="5314" class="Symbol">(</a><a id="5315" href="Test.Examples.AccountSim.Validator.html#5315" class="Bound">txinfo</a> <a id="5322" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5324" class="Symbol">_)</a> <a id="5327" class="Symbol">=</a> <a id="5329" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="5335" class="Symbol">(λ</a> <a id="5338" href="Test.Examples.AccountSim.Validator.html#5338" class="Bound">deadline</a> <a id="5347" class="Symbol">→</a>  <a id="5350" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="5352" href="Test.Examples.AccountSim.Validator.html#5309" class="Bound">slot</a> <a id="5357" href="Data.Nat.Properties.html#11973" class="Function Operator">&gt;?</a> <a id="5360" href="Test.Examples.AccountSim.Validator.html#5338" class="Bound">deadline</a> <a id="5369" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a><a id="5370" class="Symbol">)</a>
                                     <a id="5409" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
                                     <a id="5452" class="Symbol">(</a><a id="5453" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="5459" class="Symbol">(</a><a id="5460" href="Test.Prelude.html#2164" class="Field">STxInfo.txvldt</a> <a id="5475" href="Test.Examples.AccountSim.Validator.html#5315" class="Bound">txinfo</a><a id="5481" class="Symbol">))</a>



<a id="checkMembership"></a><a id="5487" href="Test.Examples.AccountSim.Validator.html#5487" class="Function">checkMembership</a> <a id="5503" class="Symbol">:</a> <a id="5505" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5511" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="5517" class="Symbol">-&gt;</a> <a id="5520" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5525" href="Test.Examples.AccountSim.Validator.html#5487" class="Function">checkMembership</a> <a id="5541" class="Symbol">(</a><a id="5542" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5547" href="Test.Examples.AccountSim.Validator.html#5547" class="Bound">x</a><a id="5548" class="Symbol">)</a> <a id="5550" class="Symbol">=</a> <a id="5552" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="5557" href="Test.Examples.AccountSim.Validator.html#5487" class="Function">checkMembership</a> <a id="5573" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5581" class="Symbol">=</a> <a id="5583" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="checkEmpty"></a><a id="5590" href="Test.Examples.AccountSim.Validator.html#5590" class="Function">checkEmpty</a> <a id="5601" class="Symbol">:</a> <a id="5603" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5609" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="5615" class="Symbol">-&gt;</a> <a id="5618" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5623" href="Test.Examples.AccountSim.Validator.html#5590" class="Function">checkEmpty</a> <a id="5634" class="Symbol">(</a><a id="5635" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5640" href="Test.Examples.AccountSim.Validator.html#5640" class="Bound">x</a><a id="5641" class="Symbol">)</a> <a id="5643" class="Symbol">=</a> <a id="5645" href="Test.Examples.AccountSim.Validator.html#5640" class="Bound">x</a> <a id="5647" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5650" href="Test.Examples.AccountSim.Validator.html#798" class="Function">emptyValue</a>
<a id="5661" href="Test.Examples.AccountSim.Validator.html#5590" class="Function">checkEmpty</a> <a id="5672" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5680" class="Symbol">=</a> <a id="5682" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="insert&#39;"></a><a id="5689" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="5697" class="Symbol">:</a> <a id="5699" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5710" class="Symbol">-&gt;</a> <a id="5713" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="5719" class="Symbol">-&gt;</a> <a id="5722" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5727" class="Symbol">(</a><a id="5728" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5730" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5732" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a><a id="5737" class="Symbol">)</a> <a id="5739" class="Symbol">-&gt;</a> <a id="5742" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5747" class="Symbol">(</a><a id="5748" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5750" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5752" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a><a id="5757" class="Symbol">)</a>
<a id="5759" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="5767" href="Test.Examples.AccountSim.Validator.html#5767" class="Bound">pkh</a> <a id="5771" href="Test.Examples.AccountSim.Validator.html#5771" class="Bound">val</a> <a id="5775" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5778" class="Symbol">=</a> <a id="5780" class="Symbol">((</a><a id="5782" href="Test.Examples.AccountSim.Validator.html#5767" class="Bound">pkh</a> <a id="5786" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5788" href="Test.Examples.AccountSim.Validator.html#5771" class="Bound">val</a><a id="5791" class="Symbol">)</a> <a id="5793" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5795" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5797" class="Symbol">)</a>
<a id="5799" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="5807" href="Test.Examples.AccountSim.Validator.html#5807" class="Bound">pkh</a> <a id="5811" href="Test.Examples.AccountSim.Validator.html#5811" class="Bound">val</a> <a id="5815" class="Symbol">((</a><a id="5817" href="Test.Examples.AccountSim.Validator.html#5817" class="Bound">x</a> <a id="5819" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5821" href="Test.Examples.AccountSim.Validator.html#5821" class="Bound">y</a><a id="5822" class="Symbol">)</a> <a id="5824" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5826" href="Test.Examples.AccountSim.Validator.html#5826" class="Bound">xs</a><a id="5828" class="Symbol">)</a> <a id="5830" class="Symbol">=</a> <a id="5832" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="5835" class="Symbol">(</a><a id="5836" href="Test.Examples.AccountSim.Validator.html#5807" class="Bound">pkh</a> <a id="5840" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="5843" href="Test.Examples.AccountSim.Validator.html#5817" class="Bound">x</a><a id="5844" class="Symbol">)</a> <a id="5846" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="5851" class="Symbol">((</a><a id="5853" href="Test.Examples.AccountSim.Validator.html#5807" class="Bound">pkh</a> <a id="5857" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5859" href="Test.Examples.AccountSim.Validator.html#5811" class="Bound">val</a><a id="5862" class="Symbol">)</a> <a id="5864" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5866" href="Test.Examples.AccountSim.Validator.html#5826" class="Bound">xs</a><a id="5868" class="Symbol">)</a> <a id="5870" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="5875" class="Symbol">((</a><a id="5877" href="Test.Examples.AccountSim.Validator.html#5817" class="Bound">x</a> <a id="5879" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5881" href="Test.Examples.AccountSim.Validator.html#5821" class="Bound">y</a><a id="5882" class="Symbol">)</a> <a id="5884" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5886" class="Symbol">(</a><a id="5887" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="5895" href="Test.Examples.AccountSim.Validator.html#5807" class="Bound">pkh</a> <a id="5899" href="Test.Examples.AccountSim.Validator.html#5811" class="Bound">val</a> <a id="5903" href="Test.Examples.AccountSim.Validator.html#5826" class="Bound">xs</a><a id="5905" class="Symbol">))</a>
  
<a id="delete&#39;"></a><a id="5911" href="Test.Examples.AccountSim.Validator.html#5911" class="Function">delete&#39;</a> <a id="5919" class="Symbol">:</a> <a id="5921" href="Test.Examples.AccountSim.Validator.html#488" class="Function">PubKeyHash</a> <a id="5932" class="Symbol">-&gt;</a> <a id="5935" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5940" class="Symbol">(</a><a id="5941" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5943" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5945" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a><a id="5950" class="Symbol">)</a> <a id="5952" class="Symbol">-&gt;</a> <a id="5955" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5960" class="Symbol">(</a><a id="5961" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5963" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5965" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a><a id="5970" class="Symbol">)</a>
<a id="5972" href="Test.Examples.AccountSim.Validator.html#5911" class="Function">delete&#39;</a> <a id="5980" href="Test.Examples.AccountSim.Validator.html#5980" class="Bound">pkh</a> <a id="5984" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5987" class="Symbol">=</a> <a id="5989" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="5992" href="Test.Examples.AccountSim.Validator.html#5911" class="Function">delete&#39;</a> <a id="6000" href="Test.Examples.AccountSim.Validator.html#6000" class="Bound">pkh</a> <a id="6004" class="Symbol">((</a><a id="6006" href="Test.Examples.AccountSim.Validator.html#6006" class="Bound">x</a> <a id="6008" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6010" href="Test.Examples.AccountSim.Validator.html#6010" class="Bound">y</a><a id="6011" class="Symbol">)</a> <a id="6013" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6015" href="Test.Examples.AccountSim.Validator.html#6015" class="Bound">xs</a><a id="6017" class="Symbol">)</a> <a id="6019" class="Symbol">=</a> <a id="6021" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="6024" class="Symbol">(</a><a id="6025" href="Test.Examples.AccountSim.Validator.html#6000" class="Bound">pkh</a> <a id="6029" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6032" href="Test.Examples.AccountSim.Validator.html#6006" class="Bound">x</a><a id="6033" class="Symbol">)</a>
  <a id="6037" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="6042" href="Test.Examples.AccountSim.Validator.html#6015" class="Bound">xs</a>
  <a id="6047" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="6052" class="Symbol">((</a><a id="6054" href="Test.Examples.AccountSim.Validator.html#6006" class="Bound">x</a> <a id="6056" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6058" href="Test.Examples.AccountSim.Validator.html#6010" class="Bound">y</a><a id="6059" class="Symbol">)</a> <a id="6061" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6063" class="Symbol">(</a><a id="6064" href="Test.Examples.AccountSim.Validator.html#5911" class="Function">delete&#39;</a> <a id="6072" href="Test.Examples.AccountSim.Validator.html#6000" class="Bound">pkh</a> <a id="6076" href="Test.Examples.AccountSim.Validator.html#6015" class="Bound">xs</a><a id="6078" class="Symbol">))</a>

<a id="lookup&#39;"></a><a id="6082" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="6090" class="Symbol">:</a> <a id="6092" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6094" class="Symbol">→</a> <a id="6096" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="6101" class="Symbol">(</a><a id="6102" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6104" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="6106" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a><a id="6111" class="Symbol">)</a> <a id="6113" class="Symbol">→</a> <a id="6115" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6121" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a>
<a id="6127" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="6135" href="Test.Examples.AccountSim.Validator.html#6135" class="Bound">x</a> <a id="6137" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>              <a id="6153" class="Symbol">=</a> <a id="6155" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> 
<a id="6164" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="6172" href="Test.Examples.AccountSim.Validator.html#6172" class="Bound">x</a> <a id="6174" class="Symbol">((</a><a id="6176" href="Test.Examples.AccountSim.Validator.html#6176" class="Bound">x₁</a> <a id="6179" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6181" href="Test.Examples.AccountSim.Validator.html#6181" class="Bound">y</a><a id="6182" class="Symbol">)</a> <a id="6184" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6186" href="Test.Examples.AccountSim.Validator.html#6186" class="Bound">xs</a><a id="6188" class="Symbol">)</a> <a id="6190" class="Symbol">=</a> <a id="6192" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="6195" href="Test.Examples.AccountSim.Validator.html#6172" class="Bound">x</a> <a id="6197" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6200" href="Test.Examples.AccountSim.Validator.html#6176" class="Bound">x₁</a> <a id="6203" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="6208" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6213" href="Test.Examples.AccountSim.Validator.html#6181" class="Bound">y</a> <a id="6215" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="6220" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="6228" href="Test.Examples.AccountSim.Validator.html#6172" class="Bound">x</a> <a id="6230" href="Test.Examples.AccountSim.Validator.html#6186" class="Bound">xs</a>



<a id="checkWithdraw"></a><a id="6236" href="Test.Examples.AccountSim.Validator.html#6236" class="Function">checkWithdraw</a> <a id="6250" class="Symbol">:</a> <a id="6252" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6258" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="6264" class="Symbol">-&gt;</a> <a id="6267" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6269" class="Symbol">-&gt;</a> <a id="6272" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="6278" class="Symbol">-&gt;</a> <a id="6281" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6287" class="Symbol">-&gt;</a> <a id="6290" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6304" class="Symbol">-&gt;</a> <a id="6307" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6312" href="Test.Examples.AccountSim.Validator.html#6236" class="Function">checkWithdraw</a> <a id="6326" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6334" class="Symbol">_</a> <a id="6336" class="Symbol">_</a> <a id="6338" class="Symbol">_</a> <a id="6340" class="Symbol">_</a> <a id="6342" class="Symbol">=</a> <a id="6344" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6350" href="Test.Examples.AccountSim.Validator.html#6236" class="Function">checkWithdraw</a> <a id="6364" class="Symbol">(</a><a id="6365" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6370" href="Test.Examples.AccountSim.Validator.html#6370" class="Bound">v</a><a id="6371" class="Symbol">)</a> <a id="6373" href="Test.Examples.AccountSim.Validator.html#6373" class="Bound">pkh</a> <a id="6377" href="Test.Examples.AccountSim.Validator.html#6377" class="Bound">val</a> <a id="6381" class="Symbol">(</a><a id="6382" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6389" href="Test.Examples.AccountSim.Validator.html#6389" class="Bound">lab</a><a id="6392" class="Symbol">)</a> <a id="6394" href="Test.Examples.AccountSim.Validator.html#6394" class="Bound">ctx</a> <a id="6398" class="Symbol">=</a> <a id="6400" href="Test.Examples.AccountSim.Validator.html#1011" class="Function">geq</a> <a id="6404" href="Test.Examples.AccountSim.Validator.html#6377" class="Bound">val</a> <a id="6408" href="Test.Examples.AccountSim.Validator.html#798" class="Function">emptyValue</a> <a id="6419" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6422" href="Test.Examples.AccountSim.Validator.html#1011" class="Function">geq</a> <a id="6426" href="Test.Examples.AccountSim.Validator.html#6370" class="Bound">v</a> <a id="6428" href="Test.Examples.AccountSim.Validator.html#6377" class="Bound">val</a> <a id="6432" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6435" class="Symbol">(</a><a id="6436" href="Test.Examples.AccountSim.Validator.html#1563" class="Function">newLabel</a> <a id="6445" href="Test.Examples.AccountSim.Validator.html#6394" class="Bound">ctx</a> <a id="6449" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6452" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6457" class="Symbol">(</a><a id="6458" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6465" class="Symbol">(</a><a id="6466" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="6474" href="Test.Examples.AccountSim.Validator.html#6373" class="Bound">pkh</a> <a id="6478" class="Symbol">(</a><a id="6479" href="Test.Examples.AccountSim.Validator.html#6370" class="Bound">v</a> <a id="6481" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="6483" href="Test.Examples.AccountSim.Validator.html#6377" class="Bound">val</a><a id="6486" class="Symbol">)</a> <a id="6488" href="Test.Examples.AccountSim.Validator.html#6389" class="Bound">lab</a><a id="6491" class="Symbol">)))</a> 

<a id="checkDeposit"></a><a id="6497" href="Test.Examples.AccountSim.Validator.html#6497" class="Function">checkDeposit</a> <a id="6510" class="Symbol">:</a> <a id="6512" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a>  <a id="6519" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="6525" class="Symbol">-&gt;</a> <a id="6528" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6530" class="Symbol">-&gt;</a> <a id="6533" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="6539" class="Symbol">-&gt;</a>  <a id="6543" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6549" class="Symbol">-&gt;</a> <a id="6552" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6566" class="Symbol">-&gt;</a> <a id="6569" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6574" href="Test.Examples.AccountSim.Validator.html#6497" class="Function">checkDeposit</a> <a id="6587" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6595" class="Symbol">_</a> <a id="6597" class="Symbol">_</a> <a id="6599" class="Symbol">_</a> <a id="6601" class="Symbol">_</a> <a id="6603" class="Symbol">=</a> <a id="6605" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6611" href="Test.Examples.AccountSim.Validator.html#6497" class="Function">checkDeposit</a> <a id="6624" class="Symbol">(</a><a id="6625" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6630" href="Test.Examples.AccountSim.Validator.html#6630" class="Bound">v</a><a id="6631" class="Symbol">)</a> <a id="6633" href="Test.Examples.AccountSim.Validator.html#6633" class="Bound">pkh</a> <a id="6637" href="Test.Examples.AccountSim.Validator.html#6637" class="Bound">val</a> <a id="6641" class="Symbol">(</a><a id="6642" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6649" href="Test.Examples.AccountSim.Validator.html#6649" class="Bound">lab</a><a id="6652" class="Symbol">)</a> <a id="6654" href="Test.Examples.AccountSim.Validator.html#6654" class="Bound">ctx</a> <a id="6658" class="Symbol">=</a> <a id="6660" href="Test.Examples.AccountSim.Validator.html#1011" class="Function">geq</a> <a id="6664" href="Test.Examples.AccountSim.Validator.html#6637" class="Bound">val</a> <a id="6668" href="Test.Examples.AccountSim.Validator.html#798" class="Function">emptyValue</a> <a id="6679" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="6682" class="Symbol">(</a><a id="6683" href="Test.Examples.AccountSim.Validator.html#1563" class="Function">newLabel</a> <a id="6692" href="Test.Examples.AccountSim.Validator.html#6654" class="Bound">ctx</a> <a id="6696" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="6699" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6704" class="Symbol">(</a> <a id="6706" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="6713" class="Symbol">(</a><a id="6714" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="6722" href="Test.Examples.AccountSim.Validator.html#6633" class="Bound">pkh</a> <a id="6726" class="Symbol">(</a><a id="6727" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="6731" class="Symbol">{{</a><a id="6733" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#1274" class="Function">addValue</a><a id="6741" class="Symbol">}}</a> <a id="6744" href="Test.Examples.AccountSim.Validator.html#6630" class="Bound">v</a> <a id="6746" href="Test.Examples.AccountSim.Validator.html#6637" class="Bound">val</a><a id="6749" class="Symbol">)</a> <a id="6751" href="Test.Examples.AccountSim.Validator.html#6649" class="Bound">lab</a><a id="6754" class="Symbol">)))</a>

<a id="checkTransfer"></a><a id="6759" href="Test.Examples.AccountSim.Validator.html#6759" class="Function">checkTransfer</a> <a id="6773" class="Symbol">:</a> <a id="6775" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6781" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="6787" class="Symbol">-&gt;</a> <a id="6790" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6796" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="6802" class="Symbol">-&gt;</a> <a id="6805" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6807" class="Symbol">-&gt;</a> <a id="6810" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6812" class="Symbol">-&gt;</a> <a id="6815" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="6821" class="Symbol">-&gt;</a> <a id="6824" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="6830" class="Symbol">-&gt;</a> <a id="6833" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="6847" class="Symbol">-&gt;</a> <a id="6850" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="6855" href="Test.Examples.AccountSim.Validator.html#6759" class="Function">checkTransfer</a> <a id="6869" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6877" class="Symbol">_</a> <a id="6879" class="Symbol">_</a> <a id="6881" class="Symbol">_</a> <a id="6883" class="Symbol">_</a> <a id="6885" class="Symbol">_</a> <a id="6887" class="Symbol">_</a> <a id="6889" class="Symbol">=</a> <a id="6891" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6897" href="Test.Examples.AccountSim.Validator.html#6759" class="Function">checkTransfer</a> <a id="6911" class="Symbol">(</a><a id="6912" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6917" href="Test.Examples.AccountSim.Validator.html#6917" class="Bound">vF</a><a id="6919" class="Symbol">)</a> <a id="6921" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6929" class="Symbol">_</a> <a id="6931" class="Symbol">_</a> <a id="6933" class="Symbol">_</a> <a id="6935" class="Symbol">_</a> <a id="6937" class="Symbol">_</a> <a id="6939" class="Symbol">=</a> <a id="6941" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="6947" href="Test.Examples.AccountSim.Validator.html#6759" class="Function">checkTransfer</a> <a id="6961" class="Symbol">(</a><a id="6962" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6967" href="Test.Examples.AccountSim.Validator.html#6967" class="Bound">vF</a><a id="6969" class="Symbol">)</a> <a id="6971" class="Symbol">(</a><a id="6972" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6977" href="Test.Examples.AccountSim.Validator.html#6977" class="Bound">vT</a><a id="6979" class="Symbol">)</a> <a id="6981" href="Test.Examples.AccountSim.Validator.html#6981" class="Bound">from</a> <a id="6986" href="Test.Examples.AccountSim.Validator.html#6986" class="Bound">to</a> <a id="6989" href="Test.Examples.AccountSim.Validator.html#6989" class="Bound">val</a> <a id="6993" class="Symbol">(</a><a id="6994" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7001" href="Test.Examples.AccountSim.Validator.html#7001" class="Bound">lab</a><a id="7004" class="Symbol">)</a> <a id="7006" href="Test.Examples.AccountSim.Validator.html#7006" class="Bound">ctx</a> <a id="7010" class="Symbol">=</a> <a id="7012" href="Test.Examples.AccountSim.Validator.html#1011" class="Function">geq</a> <a id="7016" href="Test.Examples.AccountSim.Validator.html#6989" class="Bound">val</a> <a id="7020" href="Test.Examples.AccountSim.Validator.html#798" class="Function">emptyValue</a> <a id="7031" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7034" href="Test.Examples.AccountSim.Validator.html#1011" class="Function">geq</a> <a id="7038" href="Test.Examples.AccountSim.Validator.html#6967" class="Bound">vF</a> <a id="7041" href="Test.Examples.AccountSim.Validator.html#6989" class="Bound">val</a> <a id="7045" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7048" class="Symbol">(</a><a id="7049" href="Test.Examples.AccountSim.Validator.html#6981" class="Bound">from</a> <a id="7054" href="Class.DecEq.Core.html#260" class="Function Operator">≠</a> <a id="7056" href="Test.Examples.AccountSim.Validator.html#6986" class="Bound">to</a><a id="7058" class="Symbol">)</a> <a id="7060" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7063" class="Symbol">(</a><a id="7064" href="Test.Examples.AccountSim.Validator.html#1563" class="Function">newLabel</a> <a id="7073" href="Test.Examples.AccountSim.Validator.html#7006" class="Bound">ctx</a> <a id="7077" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7080" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7085" class="Symbol">(</a><a id="7086" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7093" class="Symbol">(</a><a id="7094" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="7102" href="Test.Examples.AccountSim.Validator.html#6981" class="Bound">from</a> <a id="7107" class="Symbol">(</a><a id="7108" href="Test.Examples.AccountSim.Validator.html#6967" class="Bound">vF</a> <a id="7111" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="7113" href="Test.Examples.AccountSim.Validator.html#6989" class="Bound">val</a><a id="7116" class="Symbol">)</a> <a id="7118" class="Symbol">(</a><a id="7119" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="7127" href="Test.Examples.AccountSim.Validator.html#6986" class="Bound">to</a> <a id="7130" class="Symbol">(</a><a id="7131" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="7135" class="Symbol">{{</a><a id="7137" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#1274" class="Function">addValue</a><a id="7145" class="Symbol">}}</a> <a id="7148" href="Test.Examples.AccountSim.Validator.html#6977" class="Bound">vT</a> <a id="7151" href="Test.Examples.AccountSim.Validator.html#6989" class="Bound">val</a><a id="7154" class="Symbol">)</a> <a id="7156" href="Test.Examples.AccountSim.Validator.html#7001" class="Bound">lab</a><a id="7159" class="Symbol">))))</a>

<a id="agdaValidator"></a><a id="7165" href="Test.Examples.AccountSim.Validator.html#7165" class="Function">agdaValidator</a> <a id="7179" class="Symbol">:</a> <a id="7181" href="Test.Examples.AccountSim.Datum.html#324" class="Datatype">Label</a> <a id="7187" class="Symbol">-&gt;</a> <a id="7190" href="Test.Examples.AccountSim.Datum.html#470" class="Datatype">Input</a> <a id="7196" class="Symbol">-&gt;</a> <a id="7199" href="Test.SymbolicData.html#177" class="Function">ScriptContext</a> <a id="7213" class="Symbol">-&gt;</a> <a id="7216" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="7221" href="Test.Examples.AccountSim.Validator.html#7165" class="Function">agdaValidator</a> <a id="7235" class="Symbol">(</a><a id="7236" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7243" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="7246" class="Symbol">)</a> <a id="7248" href="Test.Examples.AccountSim.Validator.html#7248" class="Bound">inp</a> <a id="7252" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7256" class="Symbol">=</a> <a id="7258" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="7263" href="Test.Examples.AccountSim.Validator.html#7248" class="Bound">inp</a> <a id="7267" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="7270" class="Symbol">λ</a> <a id="7272" class="Keyword">where</a>

    <a id="7283" class="Symbol">(</a><a id="7284" href="Test.Examples.AccountSim.Datum.html#490" class="InductiveConstructor">Open</a> <a id="7289" href="Test.Examples.AccountSim.Validator.html#7289" class="Bound">pkh</a><a id="7292" class="Symbol">)</a> <a id="7294" class="Symbol">-&gt;</a> <a id="7297" href="Test.Examples.AccountSim.Validator.html#1936" class="Function">continuing</a> <a id="7308" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7312" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7315" class="Symbol">(</a><a id="7316" href="Test.Examples.AccountSim.Validator.html#4915" class="Function">checkSigned</a> <a id="7328" href="Test.Examples.AccountSim.Validator.html#7289" class="Bound">pkh</a> <a id="7332" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="7335" class="Symbol">)</a> <a id="7337" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7340" class="Symbol">(</a><a id="7341" href="Data.Bool.Base.html#951" class="Function">not</a> <a id="7345" class="Symbol">(</a><a id="7346" href="Test.Examples.AccountSim.Validator.html#5487" class="Function">checkMembership</a> <a id="7362" class="Symbol">(</a><a id="7363" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="7371" href="Test.Examples.AccountSim.Validator.html#7289" class="Bound">pkh</a> <a id="7375" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="7378" class="Symbol">)))</a> <a id="7382" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                  <a id="7403" class="Symbol">(</a><a id="7404" href="Test.Examples.AccountSim.Validator.html#1563" class="Function">newLabel</a> <a id="7413" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7417" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7420" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7425" class="Symbol">(</a><a id="7426" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7433" class="Symbol">(</a><a id="7434" href="Test.Examples.AccountSim.Validator.html#5689" class="Function">insert&#39;</a> <a id="7442" href="Test.Examples.AccountSim.Validator.html#7289" class="Bound">pkh</a> <a id="7446" href="Test.Examples.AccountSim.Validator.html#798" class="Function">emptyValue</a> <a id="7457" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="7460" class="Symbol">)))</a> <a id="7464" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7467" class="Symbol">(</a><a id="7468" href="Test.Examples.AccountSim.Validator.html#4561" class="Function">newValue</a> <a id="7477" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7481" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7484" href="Test.Examples.AccountSim.Validator.html#4718" class="Function">oldValue</a> <a id="7493" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="7496" class="Symbol">)</a>

    <a id="7503" class="Symbol">(</a><a id="7504" href="Test.Examples.AccountSim.Datum.html#514" class="InductiveConstructor">Close</a> <a id="7510" href="Test.Examples.AccountSim.Validator.html#7510" class="Bound">pkh</a><a id="7513" class="Symbol">)</a> <a id="7515" class="Symbol">-&gt;</a> <a id="7518" href="Test.Examples.AccountSim.Validator.html#1936" class="Function">continuing</a> <a id="7529" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7533" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7536" class="Symbol">(</a><a id="7537" href="Test.Examples.AccountSim.Validator.html#4915" class="Function">checkSigned</a> <a id="7549" href="Test.Examples.AccountSim.Validator.html#7510" class="Bound">pkh</a> <a id="7553" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="7556" class="Symbol">)</a> <a id="7558" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7561" class="Symbol">(</a><a id="7562" href="Test.Examples.AccountSim.Validator.html#5590" class="Function">checkEmpty</a> <a id="7573" class="Symbol">(</a><a id="7574" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="7582" href="Test.Examples.AccountSim.Validator.html#7510" class="Bound">pkh</a> <a id="7586" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="7589" class="Symbol">))</a> <a id="7592" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                   <a id="7614" class="Symbol">(</a><a id="7615" href="Test.Examples.AccountSim.Validator.html#1563" class="Function">newLabel</a> <a id="7624" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7628" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7631" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="7636" class="Symbol">(</a><a id="7637" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7644" class="Symbol">(</a><a id="7645" href="Test.Examples.AccountSim.Validator.html#5911" class="Function">delete&#39;</a> <a id="7653" href="Test.Examples.AccountSim.Validator.html#7510" class="Bound">pkh</a> <a id="7657" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="7660" class="Symbol">)))</a> <a id="7664" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7667" class="Symbol">(</a><a id="7668" href="Test.Examples.AccountSim.Validator.html#4561" class="Function">newValue</a> <a id="7677" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7681" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7684" href="Test.Examples.AccountSim.Validator.html#4718" class="Function">oldValue</a> <a id="7693" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="7696" class="Symbol">)</a>

    <a id="7703" class="Symbol">(</a><a id="7704" href="Test.Examples.AccountSim.Datum.html#538" class="InductiveConstructor">Withdraw</a> <a id="7713" href="Test.Examples.AccountSim.Validator.html#7713" class="Bound">pkh</a> <a id="7717" href="Test.Examples.AccountSim.Validator.html#7717" class="Bound">val</a><a id="7720" class="Symbol">)</a> <a id="7722" class="Symbol">-&gt;</a> <a id="7725" href="Test.Examples.AccountSim.Validator.html#1936" class="Function">continuing</a> <a id="7736" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7740" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7743" class="Symbol">(</a><a id="7744" href="Test.Examples.AccountSim.Validator.html#4915" class="Function">checkSigned</a> <a id="7756" href="Test.Examples.AccountSim.Validator.html#7713" class="Bound">pkh</a> <a id="7760" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="7763" class="Symbol">)</a> <a id="7765" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7768" class="Symbol">(</a><a id="7769" href="Test.Examples.AccountSim.Validator.html#6236" class="Function">checkWithdraw</a> <a id="7783" class="Symbol">(</a><a id="7784" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="7792" href="Test.Examples.AccountSim.Validator.html#7713" class="Bound">pkh</a> <a id="7796" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="7799" class="Symbol">)</a> <a id="7801" href="Test.Examples.AccountSim.Validator.html#7713" class="Bound">pkh</a> <a id="7805" href="Test.Examples.AccountSim.Validator.html#7717" class="Bound">val</a> <a id="7809" class="Symbol">(</a><a id="7810" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="7817" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="7820" class="Symbol">)</a> <a id="7822" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="7825" class="Symbol">)</a> <a id="7827" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                          <a id="7856" class="Symbol">((</a><a id="7858" href="Test.Examples.AccountSim.Validator.html#291" class="Function">maybeMap</a> <a id="7867" class="Symbol">(</a><a id="7868" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="7872" class="Symbol">{{</a><a id="7874" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#1274" class="Function">addValue</a><a id="7882" class="Symbol">}}</a> <a id="7885" href="Test.Examples.AccountSim.Validator.html#7717" class="Bound">val</a><a id="7888" class="Symbol">)</a> <a id="7890" class="Symbol">(</a><a id="7891" href="Test.Examples.AccountSim.Validator.html#4561" class="Function">newValue</a> <a id="7900" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="7903" class="Symbol">))</a> <a id="7906" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="7909" href="Test.Examples.AccountSim.Validator.html#4718" class="Function">oldValue</a> <a id="7918" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7922" class="Symbol">)</a>

    <a id="7929" class="Symbol">(</a><a id="7930" href="Test.Examples.AccountSim.Datum.html#567" class="InductiveConstructor">Deposit</a> <a id="7938" href="Test.Examples.AccountSim.Validator.html#7938" class="Bound">pkh</a> <a id="7942" href="Test.Examples.AccountSim.Validator.html#7942" class="Bound">val</a><a id="7945" class="Symbol">)</a> <a id="7947" class="Symbol">-&gt;</a> <a id="7950" href="Test.Examples.AccountSim.Validator.html#1936" class="Function">continuing</a> <a id="7961" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7965" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7968" href="Test.Examples.AccountSim.Validator.html#4915" class="Function">checkSigned</a> <a id="7980" href="Test.Examples.AccountSim.Validator.html#7938" class="Bound">pkh</a> <a id="7984" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="7988" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="7991" href="Test.Examples.AccountSim.Validator.html#6497" class="Function">checkDeposit</a> <a id="8004" class="Symbol">(</a><a id="8005" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="8013" href="Test.Examples.AccountSim.Validator.html#7938" class="Bound">pkh</a> <a id="8017" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="8020" class="Symbol">)</a> <a id="8022" href="Test.Examples.AccountSim.Validator.html#7938" class="Bound">pkh</a> <a id="8026" href="Test.Examples.AccountSim.Validator.html#7942" class="Bound">val</a> <a id="8030" class="Symbol">(</a><a id="8031" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="8038" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="8041" class="Symbol">)</a> <a id="8043" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="8047" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                         <a id="8075" class="Symbol">(</a><a id="8076" href="Test.Examples.AccountSim.Validator.html#4561" class="Function">newValue</a> <a id="8085" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="8089" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8092" class="Symbol">(</a><a id="8093" href="Test.Examples.AccountSim.Validator.html#291" class="Function">maybeMap</a> <a id="8102" class="Symbol">(</a><a id="8103" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="8107" class="Symbol">{{</a><a id="8109" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#1274" class="Function">addValue</a><a id="8117" class="Symbol">}}</a> <a id="8120" href="Test.Examples.AccountSim.Validator.html#7942" class="Bound">val</a><a id="8123" class="Symbol">)</a> <a id="8125" class="Symbol">(</a><a id="8126" href="Test.Examples.AccountSim.Validator.html#4718" class="Function">oldValue</a> <a id="8135" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="8138" class="Symbol">)))</a> 

    <a id="8148" class="Symbol">(</a><a id="8149" href="Test.Examples.AccountSim.Datum.html#596" class="InductiveConstructor">Transfer</a> <a id="8158" href="Test.Examples.AccountSim.Validator.html#8158" class="Bound">from</a> <a id="8163" href="Test.Examples.AccountSim.Validator.html#8163" class="Bound">to</a> <a id="8166" href="Test.Examples.AccountSim.Validator.html#8166" class="Bound">val</a><a id="8169" class="Symbol">)</a> <a id="8171" class="Symbol">-&gt;</a> <a id="8174" href="Test.Examples.AccountSim.Validator.html#1936" class="Function">continuing</a> <a id="8185" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="8189" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="8192" href="Test.Examples.AccountSim.Validator.html#4915" class="Function">checkSigned</a> <a id="8204" href="Test.Examples.AccountSim.Validator.html#8158" class="Bound">from</a> <a id="8209" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="8213" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                              <a id="8246" href="Test.Examples.AccountSim.Validator.html#6759" class="Function">checkTransfer</a> <a id="8260" class="Symbol">(</a><a id="8261" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="8269" href="Test.Examples.AccountSim.Validator.html#8158" class="Bound">from</a> <a id="8274" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="8277" class="Symbol">)</a> <a id="8279" class="Symbol">(</a><a id="8280" href="Test.Examples.AccountSim.Validator.html#6082" class="Function">lookup&#39;</a> <a id="8288" href="Test.Examples.AccountSim.Validator.html#8163" class="Bound">to</a> <a id="8291" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="8294" class="Symbol">)</a> <a id="8296" href="Test.Examples.AccountSim.Validator.html#8158" class="Bound">from</a> <a id="8301" href="Test.Examples.AccountSim.Validator.html#8163" class="Bound">to</a> <a id="8304" href="Test.Examples.AccountSim.Validator.html#8166" class="Bound">val</a> <a id="8308" class="Symbol">(</a><a id="8309" href="Test.Examples.AccountSim.Datum.html#344" class="InductiveConstructor">Always</a> <a id="8316" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a><a id="8319" class="Symbol">)</a> <a id="8321" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="8325" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a>
                              <a id="8358" class="Symbol">(</a><a id="8359" href="Test.Examples.AccountSim.Validator.html#4561" class="Function">newValue</a> <a id="8368" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a> <a id="8372" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8375" href="Test.Examples.AccountSim.Validator.html#4718" class="Function">oldValue</a> <a id="8384" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="8387" class="Symbol">)</a> 

    <a id="8395" href="Test.Examples.AccountSim.Datum.html#630" class="InductiveConstructor">Cleanup</a> <a id="8403" class="Symbol">-&gt;</a> <a id="8406" href="Data.Bool.Base.html#951" class="Function">not</a> <a id="8410" class="Symbol">(</a><a id="8411" href="Test.Examples.AccountSim.Validator.html#1936" class="Function">continuing</a> <a id="8422" href="Test.Examples.AccountSim.Validator.html#7252" class="Bound">ctx</a><a id="8425" class="Symbol">)</a> <a id="8427" href="Test.Examples.AccountSim.Validator.html#185" class="Function Operator">&amp;&amp;</a> <a id="8430" class="Symbol">(</a><a id="8431" href="Test.Examples.AccountSim.Validator.html#7243" class="Bound">lab</a> <a id="8435" href="Class.DecEq.Core.html#197" class="Function Operator">==</a> <a id="8438" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8440" class="Symbol">)</a>


<a id="accSimValidator"></a><a id="8444" href="Test.Examples.AccountSim.Validator.html#8444" class="Function">accSimValidator</a> <a id="8460" class="Symbol">:</a> <a id="8462" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="8468" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8474" class="Symbol">→</a> <a id="8476" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="8482" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8488" class="Symbol">→</a> <a id="8490" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="8495" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="8501" class="Symbol">→</a> <a id="8503" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="8508" href="Test.Examples.AccountSim.Validator.html#8444" class="Function">accSimValidator</a> <a id="8524" class="Symbol">(</a><a id="8525" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8530" class="Symbol">(</a><a id="8531" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8536" class="Symbol">(</a><a id="8537" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8542" href="Test.Examples.AccountSim.Validator.html#8542" class="Bound">x</a><a id="8543" class="Symbol">)))</a> <a id="8547" class="Symbol">(</a><a id="8548" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8553" class="Symbol">(</a><a id="8554" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="8559" class="Symbol">(</a><a id="8560" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="8565" href="Test.Examples.AccountSim.Validator.html#8565" class="Bound">y</a><a id="8566" class="Symbol">)))</a> <a id="8570" class="Symbol">(</a><a id="8571" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="8576" href="Test.Examples.AccountSim.Validator.html#8576" class="Bound">y₁</a> <a id="8579" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8581" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8583" class="Symbol">)</a> <a id="8585" class="Symbol">=</a>
  <a id="8589" href="Test.Examples.AccountSim.Validator.html#7165" class="Function">agdaValidator</a> <a id="8603" href="Test.Examples.AccountSim.Validator.html#8542" class="Bound">x</a> <a id="8605" href="Test.Examples.AccountSim.Validator.html#8565" class="Bound">y</a> <a id="8607" href="Test.Examples.AccountSim.Validator.html#8576" class="Bound">y₁</a>
<a id="8610" href="Test.Examples.AccountSim.Validator.html#8444" class="CatchallClause Function">accSimValidator</a><a id="8625" class="CatchallClause"> </a><a id="8626" class="CatchallClause Symbol">_</a><a id="8627" class="CatchallClause"> </a><a id="8628" class="CatchallClause Symbol">_</a><a id="8629" class="CatchallClause"> </a><a id="8630" class="CatchallClause Symbol">_</a> <a id="8632" class="Symbol">=</a> <a id="8634" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

</pre></body></html>