<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Chain.Properties.GovDepsMatch</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a>
<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Ledger.Abstract.html" class="Module">Ledger.Abstract</a>

<a id="86" class="Keyword">module</a> <a id="93" href="Ledger.Chain.Properties.GovDepsMatch.html" class="Module">Ledger.Chain.Properties.GovDepsMatch</a>
  <a id="132" class="Symbol">(</a><a id="133" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a> <a id="137" class="Symbol">:</a> <a id="139" class="Symbol">_)</a> <a id="142" class="Symbol">(</a><a id="143" class="Keyword">open</a> <a id="148" href="Ledger.Transaction.html#867" class="Module">TransactionStructure</a> <a id="169" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a><a id="172" class="Symbol">)</a>
  <a id="176" class="Symbol">(</a><a id="177" href="Ledger.Chain.Properties.GovDepsMatch.html#177" class="Bound">abs</a> <a id="181" class="Symbol">:</a> <a id="183" href="Ledger.Abstract.html#578" class="Record">AbstractFunctions</a> <a id="201" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a><a id="204" class="Symbol">)</a> <a id="206" class="Symbol">(</a><a id="207" class="Keyword">open</a> <a id="212" href="Ledger.Abstract.html#578" class="Module">AbstractFunctions</a> <a id="230" href="Ledger.Chain.Properties.GovDepsMatch.html#177" class="Bound">abs</a><a id="233" class="Symbol">)</a>
  <a id="237" class="Keyword">where</a>


<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="Ledger.Certs.html" class="Module">Ledger.Certs</a> <a id="270" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Ledger.Chain.html" class="Module">Ledger.Chain</a> <a id="308" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a> <a id="312" href="Ledger.Chain.Properties.GovDepsMatch.html#177" class="Bound">abs</a>
<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Ledger.Enact.html" class="Module">Ledger.Enact</a> <a id="341" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Ledger.Epoch.html" class="Module">Ledger.Epoch</a> <a id="379" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a> <a id="383" href="Ledger.Chain.Properties.GovDepsMatch.html#177" class="Bound">abs</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Ledger.Epoch.Properties.GovDepsMatch.html" class="Module">Ledger.Epoch.Properties.GovDepsMatch</a> <a id="436" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a> <a id="440" href="Ledger.Chain.Properties.GovDepsMatch.html#177" class="Bound">abs</a>
<a id="444" class="Keyword">open</a> <a id="449" class="Keyword">import</a> <a id="456" href="Ledger.Ledger.html" class="Module">Ledger.Ledger</a> <a id="470" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a> <a id="474" href="Ledger.Chain.Properties.GovDepsMatch.html#177" class="Bound">abs</a>
<a id="478" class="Keyword">open</a> <a id="483" class="Keyword">import</a> <a id="490" href="Ledger.Ledger.Properties.html" class="Module">Ledger.Ledger.Properties</a> <a id="515" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a> <a id="519" href="Ledger.Chain.Properties.GovDepsMatch.html#177" class="Bound">abs</a>
<a id="523" class="Keyword">open</a> <a id="528" class="Keyword">import</a> <a id="535" href="Ledger.Ledger.Properties.GovDepsMatch.html" class="Module">Ledger.Ledger.Properties.GovDepsMatch</a> <a id="573" href="Ledger.Chain.Properties.GovDepsMatch.html#133" class="Bound">txs</a> <a id="577" href="Ledger.Chain.Properties.GovDepsMatch.html#177" class="Bound">abs</a>
<a id="581" class="Keyword">open</a> <a id="586" class="Keyword">import</a> <a id="593" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="608" class="Keyword">hiding</a> <a id="615" class="Symbol">(</a><a id="616" href="Class.Functor.Core.html#272" class="Function">map</a><a id="619" class="Symbol">)</a> <a id="621" class="Keyword">renaming</a> <a id="630" class="Symbol">(</a><a id="631" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="636" class="Symbol">to</a> <a id="639" class="Function">map</a><a id="642" class="Symbol">)</a>

<a id="645" class="Keyword">module</a> <a id="652" href="Ledger.Chain.Properties.GovDepsMatch.html#652" class="Module">_</a>
  <a id="656" class="Symbol">{</a><a id="657" href="Ledger.Chain.Properties.GovDepsMatch.html#657" class="Bound">b</a>   <a id="661" class="Symbol">:</a> <a id="663" href="Ledger.Chain.html#653" class="Record">Block</a> <a id="669" class="Symbol">}</a>
  <a id="673" class="Symbol">{</a><a id="674" href="Ledger.Chain.Properties.GovDepsMatch.html#674" class="Bound">nes</a> <a id="678" class="Symbol">:</a> <a id="680" href="Ledger.Epoch.html#2136" class="Record">NewEpochState</a><a id="693" class="Symbol">}</a>
  <a id="697" class="Symbol">{</a><a id="698" href="Ledger.Chain.Properties.GovDepsMatch.html#698" class="Bound">cs</a>  <a id="702" class="Symbol">:</a> <a id="704" href="Ledger.Chain.html#578" class="Record">ChainState</a><a id="714" class="Symbol">}</a>
  <a id="718" class="Keyword">where</a>
  <a id="726" class="Keyword">open</a> <a id="731" href="Ledger.Chain.html#653" class="Module">Block</a> <a id="737" href="Ledger.Chain.Properties.GovDepsMatch.html#657" class="Bound">b</a><a id="738" class="Symbol">;</a> <a id="740" class="Keyword">open</a> <a id="745" href="Ledger.Chain.html#578" class="Module">ChainState</a> <a id="756" href="Ledger.Chain.Properties.GovDepsMatch.html#698" class="Bound">cs</a>
  <a id="761" class="Keyword">open</a> <a id="766" href="Ledger.Epoch.html#2136" class="Module">NewEpochState</a>
  <a id="782" class="Keyword">open</a> <a id="787" href="Ledger.Epoch.Properties.GovDepsMatch.html#1120" class="Module">EPOCH-Body</a> <a id="798" class="Symbol">(</a><a id="799" href="Ledger.Epoch.html#1613" class="Field">EpochStateOf</a> <a id="812" href="Ledger.Chain.Properties.GovDepsMatch.html#698" class="Bound">cs</a><a id="814" class="Symbol">)</a> <a id="816" class="Keyword">renaming</a> <a id="825" class="Symbol">(</a><a id="826" href="Ledger.Epoch.Properties.GovDepsMatch.html#1206" class="Field">epsLState</a> <a id="836" class="Symbol">to</a> <a id="839" class="Field">csLState</a><a id="847" class="Symbol">)</a>
  <a id="851" class="Keyword">open</a> <a id="856" href="Ledger.Enact.html#397" class="Module">EnactState</a> <a id="867" href="Ledger.Epoch.Properties.GovDepsMatch.html#1382" class="Function">ens</a> <a id="871" class="Keyword">using</a> <a id="877" class="Symbol">(</a><a id="878" href="Ledger.Enact.html#607" class="Field">pparams</a><a id="885" class="Symbol">)</a>
  <a id="889" href="Ledger.Chain.Properties.GovDepsMatch.html#889" class="Function">pp</a> <a id="892" class="Symbol">=</a> <a id="894" href="Ledger.Enact.html#607" class="Function">pparams</a> <a id="902" class="Symbol">.</a><a id="903" href="Data.Product.Base.html#636" class="Field">proj₁</a>
  <a id="911" class="Keyword">open</a> <a id="916" href="Ledger.PParams.html#1570" class="Module">PParams</a> <a id="924" href="Ledger.Chain.Properties.GovDepsMatch.html#889" class="Function">pp</a> <a id="927" class="Keyword">using</a> <a id="933" class="Symbol">(</a><a id="934" href="Ledger.PParams.html#2482" class="Field">maxRefScriptSizePerBlock</a><a id="958" class="Symbol">)</a>


  <a id="964" href="Ledger.Chain.Properties.GovDepsMatch.html#964" class="Function">cs&#39;</a> <a id="968" class="Symbol">:</a> <a id="970" href="Ledger.Chain.html#578" class="Record">ChainState</a>
  <a id="983" href="Ledger.Chain.Properties.GovDepsMatch.html#964" class="Function">cs&#39;</a> <a id="987" class="Symbol">.</a><a id="988" href="Ledger.Chain.html#614" class="Field">newEpochState</a> <a id="1002" class="Symbol">=</a>
    <a id="1008" class="Keyword">record</a> <a id="1015" class="Symbol">{</a> <a id="1017" href="Ledger.Epoch.html#2175" class="Field">lastEpoch</a>   <a id="1029" class="Symbol">=</a> <a id="1031" href="Ledger.Chain.Properties.GovDepsMatch.html#674" class="Bound">nes</a> <a id="1035" class="Symbol">.</a><a id="1036" href="Ledger.Epoch.html#2175" class="Field">lastEpoch</a>
           <a id="1057" class="Symbol">;</a> <a id="1059" href="Ledger.Epoch.html#2199" class="Field">epochState</a>  <a id="1071" class="Symbol">=</a> <a id="1073" class="Keyword">record</a> <a id="1080" class="Symbol">(</a><a id="1081" href="Ledger.Epoch.html#1613" class="Field">EpochStateOf</a> <a id="1094" href="Ledger.Chain.Properties.GovDepsMatch.html#698" class="Bound">cs</a><a id="1096" class="Symbol">)</a> <a id="1098" class="Symbol">{</a><a id="1099" href="Ledger.Epoch.html#1473" class="Field">ls</a> <a id="1102" class="Symbol">=</a> <a id="1104" href="Ledger.Ledger.html#1004" class="Field">LStateOf</a> <a id="1113" href="Ledger.Chain.Properties.GovDepsMatch.html#674" class="Bound">nes</a><a id="1116" class="Symbol">}</a>
           <a id="1129" class="Symbol">;</a> <a id="1131" href="Ledger.Epoch.html#2228" class="Field">ru</a>          <a id="1143" class="Symbol">=</a> <a id="1145" href="Ledger.Chain.Properties.GovDepsMatch.html#674" class="Bound">nes</a> <a id="1149" class="Symbol">.</a><a id="1150" href="Ledger.Epoch.html#2228" class="Field">ru</a> <a id="1153" class="Symbol">}</a>


  <a id="1159" href="Ledger.Chain.Properties.GovDepsMatch.html#1159" class="Function">CHAIN-govDepsMatch</a> <a id="1178" class="Symbol">:</a>
    <a id="1184" href="Ledger.Chain.Properties.GovDepsMatch.html#639" class="Function">map</a> <a id="1188" class="Symbol">(</a><a id="1189" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="1206" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1208" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="1213" class="Symbol">)</a> <a id="1215" href="Ledger.Epoch.Properties.GovDepsMatch.html#1572" class="Function">removed&#39;</a> <a id="1224" href="Interface.HasSubset.html#158" class="Field Operator">⊆</a> <a id="1226" href="Class.IsSet.html#916" class="Function">dom</a> <a id="1230" class="Symbol">(</a><a id="1231" href="Ledger.Certs.html#729" class="Field">DepositsOf</a> <a id="1242" href="Ledger.Chain.Properties.GovDepsMatch.html#698" class="Bound">cs</a><a id="1244" class="Symbol">)</a>
    <a id="1250" class="Symbol">→</a>  <a id="1253" href="Ledger.Chain.html#3618" class="Function">totalRefScriptsSize</a> <a id="1273" href="Ledger.Chain.Properties.GovDepsMatch.html#839" class="Function">csLState</a> <a id="1282" href="Ledger.Chain.html#684" class="Function">ts</a> <a id="1285" href="Class.HasOrder.Core.html#608" class="Field Operator">≤</a> <a id="1287" href="Ledger.PParams.html#2482" class="Function">maxRefScriptSizePerBlock</a>
    <a id="1316" class="Symbol">→</a>  <a id="1319" class="Symbol">_</a> <a id="1321" href="Ledger.Chain.html#3813" class="Datatype Operator">⊢</a> <a id="1323" href="Ledger.Chain.Properties.GovDepsMatch.html#698" class="Bound">cs</a> <a id="1326" href="Ledger.Chain.html#3813" class="Datatype Operator">⇀⦇</a> <a id="1329" href="Ledger.Chain.Properties.GovDepsMatch.html#657" class="Bound">b</a> <a id="1331" href="Ledger.Chain.html#3813" class="Datatype Operator">,CHAIN⦈</a> <a id="1339" href="Ledger.Chain.Properties.GovDepsMatch.html#964" class="Function">cs&#39;</a>
    <a id="1347" class="Symbol">→</a>  <a id="1350" href="Ledger.Ledger.Properties.html#4161" class="Function">govDepsMatch</a> <a id="1363" href="Ledger.Chain.Properties.GovDepsMatch.html#839" class="Function">csLState</a> <a id="1372" class="Symbol">→</a> <a id="1374" href="Ledger.Ledger.Properties.html#4161" class="Function">govDepsMatch</a> <a id="1387" class="Symbol">(</a><a id="1388" href="Ledger.Ledger.html#1004" class="Field">LStateOf</a> <a id="1397" href="Ledger.Chain.Properties.GovDepsMatch.html#674" class="Bound">nes</a><a id="1400" class="Symbol">)</a>


  <a id="1406" class="Comment">-- Proof.</a>
  <a id="1418" href="Ledger.Chain.Properties.GovDepsMatch.html#1159" class="Function">CHAIN-govDepsMatch</a> <a id="1437" href="Ledger.Chain.Properties.GovDepsMatch.html#1437" class="Bound">rrm</a> <a id="1441" href="Ledger.Chain.Properties.GovDepsMatch.html#1441" class="Bound">rss</a> <a id="1445" class="Symbol">(</a><a id="1446" href="Ledger.Chain.html#3887" class="InductiveConstructor">CHAIN</a> <a id="1452" class="Symbol">(</a><a id="1453" href="Ledger.Chain.Properties.GovDepsMatch.html#1453" class="Bound">x</a> <a id="1455" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1457" href="Ledger.Epoch.html#9227" class="InductiveConstructor">NEWEPOCH-New</a> <a id="1470" class="Symbol">(_</a> <a id="1473" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1475" href="Ledger.Chain.Properties.GovDepsMatch.html#1475" class="Bound">eps₁→eps₂</a><a id="1484" class="Symbol">)</a> <a id="1486" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1488" href="Ledger.Chain.Properties.GovDepsMatch.html#1488" class="Bound">ledgers</a><a id="1495" class="Symbol">))</a> <a id="1498" class="Symbol">=</a>
    <a id="1504" href="Interface.STS.html#4007" class="Function">RTC-preserves-inv</a> <a id="1522" href="Ledger.Ledger.Properties.GovDepsMatch.html#593" class="Function">LEDGER-govDepsMatch</a> <a id="1542" href="Ledger.Chain.Properties.GovDepsMatch.html#1488" class="Bound">ledgers</a>
     <a id="1555" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1557" href="Ledger.Epoch.Properties.GovDepsMatch.html#1893" class="Function">EPOCH-PROPS.EPOCH-govDepsMatch</a> <a id="1588" href="Ledger.Chain.Properties.GovDepsMatch.html#1437" class="Bound">rrm</a> <a id="1592" href="Ledger.Chain.Properties.GovDepsMatch.html#1475" class="Bound">eps₁→eps₂</a>

  <a id="1605" href="Ledger.Chain.Properties.GovDepsMatch.html#1159" class="Function">CHAIN-govDepsMatch</a> <a id="1624" href="Ledger.Chain.Properties.GovDepsMatch.html#1624" class="Bound">rrm</a> <a id="1628" href="Ledger.Chain.Properties.GovDepsMatch.html#1628" class="Bound">rss</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Ledger.Chain.html#3887" class="InductiveConstructor">CHAIN</a> <a id="1639" class="Symbol">(</a><a id="1640" href="Ledger.Chain.Properties.GovDepsMatch.html#1640" class="Bound">x</a> <a id="1642" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1644" href="Ledger.Epoch.html#9463" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="1661" class="Symbol">_</a> <a id="1663" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1665" href="Ledger.Chain.Properties.GovDepsMatch.html#1665" class="Bound">ledgers</a><a id="1672" class="Symbol">))</a> <a id="1675" class="Symbol">=</a>
    <a id="1681" href="Interface.STS.html#4007" class="Function">RTC-preserves-inv</a> <a id="1699" href="Ledger.Ledger.Properties.GovDepsMatch.html#593" class="Function">LEDGER-govDepsMatch</a> <a id="1719" href="Ledger.Chain.Properties.GovDepsMatch.html#1665" class="Bound">ledgers</a>

  <a id="1730" href="Ledger.Chain.Properties.GovDepsMatch.html#1159" class="Function">CHAIN-govDepsMatch</a> <a id="1749" href="Ledger.Chain.Properties.GovDepsMatch.html#1749" class="Bound">rrm</a> <a id="1753" href="Ledger.Chain.Properties.GovDepsMatch.html#1753" class="Bound">rss</a> <a id="1757" class="Symbol">(</a><a id="1758" href="Ledger.Chain.html#3887" class="InductiveConstructor">CHAIN</a> <a id="1764" class="Symbol">(</a><a id="1765" href="Ledger.Chain.Properties.GovDepsMatch.html#1765" class="Bound">x</a> <a id="1767" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1769" href="Ledger.Epoch.html#9626" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="1795" class="Symbol">(_</a> <a id="1798" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1800" href="Ledger.Chain.Properties.GovDepsMatch.html#1800" class="Bound">eps₁→eps₂</a><a id="1809" class="Symbol">)</a> <a id="1811" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1813" href="Ledger.Chain.Properties.GovDepsMatch.html#1813" class="Bound">ledgers</a><a id="1820" class="Symbol">))</a> <a id="1823" class="Symbol">=</a>
    <a id="1829" href="Interface.STS.html#4007" class="Function">RTC-preserves-inv</a> <a id="1847" href="Ledger.Ledger.Properties.GovDepsMatch.html#593" class="Function">LEDGER-govDepsMatch</a> <a id="1867" href="Ledger.Chain.Properties.GovDepsMatch.html#1813" class="Bound">ledgers</a>
     <a id="1880" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1882" href="Ledger.Epoch.Properties.GovDepsMatch.html#1893" class="Function">EPOCH-PROPS.EPOCH-govDepsMatch</a> <a id="1913" href="Ledger.Chain.Properties.GovDepsMatch.html#1749" class="Bound">rrm</a> <a id="1917" href="Ledger.Chain.Properties.GovDepsMatch.html#1800" class="Bound">eps₁→eps₂</a>

</pre></body></html>