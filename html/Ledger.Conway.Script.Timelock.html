<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Script.Timelock</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Crypto.html" class="Module">Ledger.Conway.Crypto</a>
  <a id="61" class="Keyword">using</a> <a id="67" class="Symbol">(</a><a id="68" href="Ledger.Conway.Crypto.html#1050" class="Record">Crypto</a><a id="74" class="Symbol">)</a>
<a id="76" class="Keyword">open</a> <a id="81" class="Keyword">import</a> <a id="88" href="Ledger.Conway.Types.Epoch.html" class="Module">Ledger.Conway.Types.Epoch</a>
  <a id="116" class="Keyword">using</a> <a id="122" class="Symbol">(</a><a id="123" href="Ledger.Conway.Types.Epoch.html#524" class="Record">EpochStructure</a><a id="137" class="Symbol">)</a>

<a id="140" class="Keyword">module</a> <a id="147" href="Ledger.Conway.Script.Timelock.html" class="Module">Ledger.Conway.Script.Timelock</a>
  <a id="179" class="Symbol">(</a><a id="180" href="Ledger.Conway.Script.Timelock.html#180" class="Bound">crypto</a> <a id="187" class="Symbol">:</a> <a id="189" class="Symbol">_)</a> <a id="192" class="Symbol">(</a><a id="193" class="Keyword">open</a> <a id="198" href="Ledger.Conway.Crypto.html#1050" class="Module">Crypto</a> <a id="205" href="Ledger.Conway.Script.Timelock.html#180" class="Bound">crypto</a><a id="211" class="Symbol">)</a>
  <a id="215" class="Symbol">(</a><a id="216" href="Ledger.Conway.Script.Timelock.html#216" class="Bound">es</a>     <a id="223" class="Symbol">:</a> <a id="225" class="Symbol">_)</a> <a id="228" class="Symbol">(</a><a id="229" class="Keyword">open</a> <a id="234" href="Ledger.Conway.Types.Epoch.html#524" class="Module">EpochStructure</a> <a id="249" href="Ledger.Conway.Script.Timelock.html#216" class="Bound">es</a><a id="251" class="Symbol">)</a>
  <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
  <a id="291" class="Keyword">hiding</a> <a id="298" class="Symbol">(</a><a id="299" href="Axiom.Set.html#9724" class="Function">All</a><a id="302" class="Symbol">;</a> <a id="304" href="Axiom.Set.html#9793" class="Function">Any</a><a id="307" class="Symbol">;</a> <a id="309" href="Axiom.Set.html#10821" class="Function">all?</a><a id="313" class="Symbol">;</a> <a id="315" href="Axiom.Set.html#10895" class="Function">any?</a><a id="319" class="Symbol">;</a> <a id="321" href="Data.List.Base.html#7451" class="Function Operator">_∷ʳ_</a><a id="325" class="Symbol">;</a> <a id="327" href="Data.List.Base.html#8345" class="Function">uncons</a><a id="333" class="Symbol">;</a> <a id="335" href="Interface.HasSubset.html#158" class="Field Operator">_⊆_</a><a id="338" class="Symbol">)</a>

<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a>
  <a id="384" class="Keyword">using</a> <a id="390" class="Symbol">(</a><a id="391" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a><a id="394" class="Symbol">;</a> <a id="396" href="Data.List.Relation.Unary.All.html#1707" class="InductiveConstructor">[]</a><a id="398" class="Symbol">;</a> <a id="400" href="Data.List.Relation.Unary.All.html#1724" class="InductiveConstructor Operator">_∷_</a><a id="403" class="Symbol">;</a> <a id="405" href="Data.List.Relation.Unary.All.html#6425" class="Function">all?</a><a id="409" class="Symbol">;</a> <a id="411" href="Data.List.Relation.Unary.All.html#2478" class="Function">uncons</a><a id="417" class="Symbol">)</a>
<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a>
  <a id="462" class="Keyword">using</a> <a id="468" class="Symbol">(</a><a id="469" href="Data.List.Relation.Unary.Any.html#1148" class="Datatype">Any</a><a id="472" class="Symbol">;</a> <a id="474" href="Data.List.Relation.Unary.Any.html#2684" class="Function">any?</a><a id="478" class="Symbol">)</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="stdlib.Data.List.Relation.Unary.MOf.html" class="Module">stdlib.Data.List.Relation.Unary.MOf</a>



<a id="531" class="Keyword">data</a> <a id="Timelock"></a><a id="536" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a> <a id="545" class="Symbol">:</a> <a id="547" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="552" class="Keyword">where</a>
  <a id="Timelock.RequireAllOf"></a><a id="560" href="Ledger.Conway.Script.Timelock.html#560" class="InductiveConstructor">RequireAllOf</a>       <a id="579" class="Symbol">:</a> <a id="581" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="586" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>      <a id="600" class="Symbol">→</a> <a id="602" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>
  <a id="Timelock.RequireAnyOf"></a><a id="613" href="Ledger.Conway.Script.Timelock.html#613" class="InductiveConstructor">RequireAnyOf</a>       <a id="632" class="Symbol">:</a> <a id="634" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="639" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>      <a id="653" class="Symbol">→</a> <a id="655" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>
  <a id="Timelock.RequireMOf"></a><a id="666" href="Ledger.Conway.Script.Timelock.html#666" class="InductiveConstructor">RequireMOf</a>         <a id="685" class="Symbol">:</a> <a id="687" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="689" class="Symbol">→</a> <a id="691" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="696" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>  <a id="706" class="Symbol">→</a> <a id="708" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>
  <a id="Timelock.RequireSig"></a><a id="719" href="Ledger.Conway.Script.Timelock.html#719" class="InductiveConstructor">RequireSig</a>         <a id="738" class="Symbol">:</a> <a id="740" href="Ledger.Conway.Crypto.html#1317" class="Function">KeyHash</a>            <a id="759" class="Symbol">→</a> <a id="761" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>
  <a id="Timelock.RequireTimeStart"></a><a id="772" href="Ledger.Conway.Script.Timelock.html#772" class="InductiveConstructor">RequireTimeStart</a>   <a id="791" class="Symbol">:</a> <a id="793" href="Ledger.Conway.Types.Epoch.html#668" class="Function">Slot</a>               <a id="812" class="Symbol">→</a> <a id="814" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>
  <a id="Timelock.RequireTimeExpire"></a><a id="825" href="Ledger.Conway.Script.Timelock.html#825" class="InductiveConstructor">RequireTimeExpire</a>  <a id="844" class="Symbol">:</a> <a id="846" href="Ledger.Conway.Types.Epoch.html#668" class="Function">Slot</a>               <a id="865" class="Symbol">→</a> <a id="867" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>


<a id="878" class="Keyword">unquoteDecl</a> <a id="DecEq-Timelock"></a><a id="890" href="Ledger.Conway.Script.Timelock.html#890" class="Function">DecEq-Timelock</a> <a id="905" class="Symbol">=</a> <a id="907" href="Tactic.Derive.DecEq.html#3519" class="Function">derive-DecEq</a> <a id="920" class="Symbol">((</a><a id="922" class="Keyword">quote</a> <a id="928" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a> <a id="937" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="939" href="Ledger.Conway.Script.Timelock.html#890" class="Function">DecEq-Timelock</a><a id="953" class="Symbol">)</a> <a id="955" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="957" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="959" class="Symbol">)</a>

<a id="962" class="Keyword">private</a> <a id="970" class="Keyword">variable</a>
  <a id="981" href="Ledger.Conway.Script.Timelock.html#981" class="Generalizable">s</a> <a id="983" class="Symbol">:</a> <a id="985" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>
  <a id="996" href="Ledger.Conway.Script.Timelock.html#996" class="Generalizable">ss</a> <a id="999" href="Ledger.Conway.Script.Timelock.html#999" class="Generalizable">ss&#39;</a> <a id="1003" class="Symbol">:</a> <a id="1005" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1010" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a>
  <a id="1021" href="Ledger.Conway.Script.Timelock.html#1021" class="Generalizable">m</a> <a id="1023" class="Symbol">:</a> <a id="1025" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
  <a id="1029" href="Ledger.Conway.Script.Timelock.html#1029" class="Generalizable">x</a> <a id="1031" class="Symbol">:</a> <a id="1033" href="Ledger.Conway.Crypto.html#1317" class="Function">KeyHash</a>
  <a id="1043" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a> <a id="1045" href="Ledger.Conway.Script.Timelock.html#1045" class="Generalizable">l</a> <a id="1047" href="Ledger.Conway.Script.Timelock.html#1047" class="Generalizable">r</a> <a id="1049" class="Symbol">:</a> <a id="1051" href="Ledger.Conway.Types.Epoch.html#668" class="Function">Slot</a>

<a id="1057" class="Keyword">open</a> <a id="1062" class="Keyword">import</a> <a id="1069" href="Data.List.Relation.Binary.Sublist.Propositional.html" class="Module">Data.List.Relation.Binary.Sublist.Propositional</a> <a id="1117" class="Symbol">as</a> <a id="1120" class="Module">S</a>
<a id="1122" class="Keyword">import</a> <a id="1129" href="Data.Maybe.Relation.Unary.Any.html" class="Module">Data.Maybe.Relation.Unary.Any</a> <a id="1159" class="Symbol">as</a> <a id="1162" class="Module">M</a>


<a id="1166" class="Keyword">data</a>


  <a id="evalTimelock"></a><a id="1175" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1188" class="Symbol">(</a><a id="1189" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1193" class="Symbol">:</a> <a id="1195" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="1197" href="Ledger.Conway.Crypto.html#1317" class="Function">KeyHash</a><a id="1204" class="Symbol">)</a> <a id="1206" class="Symbol">(</a><a id="1207" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a> <a id="1209" class="Symbol">:</a> <a id="1211" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1217" href="Ledger.Conway.Types.Epoch.html#668" class="Function">Slot</a> <a id="1222" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1224" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1230" href="Ledger.Conway.Types.Epoch.html#668" class="Function">Slot</a><a id="1234" class="Symbol">)</a> <a id="1236" class="Symbol">:</a> <a id="1238" href="Ledger.Conway.Script.Timelock.html#536" class="Datatype">Timelock</a> <a id="1247" class="Symbol">→</a> <a id="1249" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1254" class="Keyword">where</a>
  <a id="evalTimelock.evalAll"></a><a id="1262" href="Ledger.Conway.Script.Timelock.html#1262" class="InductiveConstructor">evalAll</a>  <a id="1271" class="Symbol">:</a> <a id="1273" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="1277" class="Symbol">(</a><a id="1278" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1291" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1295" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1296" class="Symbol">)</a> <a id="1298" href="Ledger.Conway.Script.Timelock.html#996" class="Generalizable">ss</a>
           <a id="1312" class="Symbol">→</a> <a id="1314" class="Symbol">(</a><a id="1315" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1328" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1332" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1333" class="Symbol">)</a> <a id="1335" class="Symbol">(</a><a id="1336" href="Ledger.Conway.Script.Timelock.html#560" class="InductiveConstructor">RequireAllOf</a> <a id="1349" href="Ledger.Conway.Script.Timelock.html#996" class="Generalizable">ss</a><a id="1351" class="Symbol">)</a>
  <a id="evalTimelock.evalAny"></a><a id="1355" href="Ledger.Conway.Script.Timelock.html#1355" class="InductiveConstructor">evalAny</a>  <a id="1364" class="Symbol">:</a> <a id="1366" href="Data.List.Relation.Unary.Any.html#1148" class="Datatype">Any</a> <a id="1370" class="Symbol">(</a><a id="1371" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1384" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1388" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1389" class="Symbol">)</a> <a id="1391" href="Ledger.Conway.Script.Timelock.html#996" class="Generalizable">ss</a>
           <a id="1405" class="Symbol">→</a> <a id="1407" class="Symbol">(</a><a id="1408" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1421" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1425" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1426" class="Symbol">)</a> <a id="1428" class="Symbol">(</a><a id="1429" href="Ledger.Conway.Script.Timelock.html#613" class="InductiveConstructor">RequireAnyOf</a> <a id="1442" href="Ledger.Conway.Script.Timelock.html#996" class="Generalizable">ss</a><a id="1444" class="Symbol">)</a>
  <a id="evalTimelock.evalMOf"></a><a id="1448" href="Ledger.Conway.Script.Timelock.html#1448" class="InductiveConstructor">evalMOf</a>  <a id="1457" class="Symbol">:</a> <a id="1459" href="stdlib.Data.List.Relation.Unary.MOf.html#1135" class="Datatype">MOf</a> <a id="1463" href="Ledger.Conway.Script.Timelock.html#1021" class="Generalizable">m</a> <a id="1465" class="Symbol">(</a><a id="1466" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1479" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1483" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1484" class="Symbol">)</a> <a id="1486" href="Ledger.Conway.Script.Timelock.html#996" class="Generalizable">ss</a>
           <a id="1500" class="Symbol">→</a> <a id="1502" class="Symbol">(</a><a id="1503" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1516" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1520" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1521" class="Symbol">)</a> <a id="1523" class="Symbol">(</a><a id="1524" href="Ledger.Conway.Script.Timelock.html#666" class="InductiveConstructor">RequireMOf</a> <a id="1535" href="Ledger.Conway.Script.Timelock.html#1021" class="Generalizable">m</a> <a id="1537" href="Ledger.Conway.Script.Timelock.html#996" class="Generalizable">ss</a><a id="1539" class="Symbol">)</a>
  <a id="evalTimelock.evalSig"></a><a id="1543" href="Ledger.Conway.Script.Timelock.html#1543" class="InductiveConstructor">evalSig</a>  <a id="1552" class="Symbol">:</a> <a id="1554" href="Ledger.Conway.Script.Timelock.html#1029" class="Generalizable">x</a> <a id="1556" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="1558" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a>
           <a id="1573" class="Symbol">→</a> <a id="1575" class="Symbol">(</a><a id="1576" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1589" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1593" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1594" class="Symbol">)</a> <a id="1596" class="Symbol">(</a><a id="1597" href="Ledger.Conway.Script.Timelock.html#719" class="InductiveConstructor">RequireSig</a> <a id="1608" href="Ledger.Conway.Script.Timelock.html#1029" class="Generalizable">x</a><a id="1609" class="Symbol">)</a>
  <a id="evalTimelock.evalTSt"></a><a id="1613" href="Ledger.Conway.Script.Timelock.html#1613" class="InductiveConstructor">evalTSt</a>  <a id="1622" class="Symbol">:</a> <a id="1624" href="Data.Maybe.Relation.Unary.Any.html#835" class="Datatype">M.Any</a> <a id="1630" class="Symbol">(</a><a id="1631" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a> <a id="1633" href="Class.HasOrder.Core.html#608" class="Field Operator">≤_</a><a id="1635" class="Symbol">)</a> <a id="1637" class="Symbol">(</a><a id="1638" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a> <a id="1640" class="Symbol">.</a><a id="1641" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="1646" class="Symbol">)</a>
           <a id="1659" class="Symbol">→</a> <a id="1661" class="Symbol">(</a><a id="1662" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1675" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1679" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1680" class="Symbol">)</a> <a id="1682" class="Symbol">(</a><a id="1683" href="Ledger.Conway.Script.Timelock.html#772" class="InductiveConstructor">RequireTimeStart</a> <a id="1700" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a><a id="1701" class="Symbol">)</a>
  <a id="evalTimelock.evalTEx"></a><a id="1705" href="Ledger.Conway.Script.Timelock.html#1705" class="InductiveConstructor">evalTEx</a>  <a id="1714" class="Symbol">:</a> <a id="1716" href="Data.Maybe.Relation.Unary.Any.html#835" class="Datatype">M.Any</a> <a id="1722" class="Symbol">(</a><a id="1723" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤</a> <a id="1726" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a><a id="1727" class="Symbol">)</a> <a id="1729" class="Symbol">(</a><a id="1730" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a> <a id="1732" class="Symbol">.</a><a id="1733" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="1738" class="Symbol">)</a>
           <a id="1751" class="Symbol">→</a> <a id="1753" class="Symbol">(</a><a id="1754" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1767" href="Ledger.Conway.Script.Timelock.html#1189" class="Bound">khs</a> <a id="1771" href="Ledger.Conway.Script.Timelock.html#1207" class="Bound">I</a><a id="1772" class="Symbol">)</a> <a id="1774" class="Symbol">(</a><a id="1775" href="Ledger.Conway.Script.Timelock.html#825" class="InductiveConstructor">RequireTimeExpire</a> <a id="1793" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a><a id="1794" class="Symbol">)</a>


<a id="1798" class="Keyword">instance</a>
  <a id="Dec-evalTimelock"></a><a id="1809" href="Ledger.Conway.Script.Timelock.html#1809" class="Function">Dec-evalTimelock</a> <a id="1826" class="Symbol">:</a> <a id="1828" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1841" href="Class.Decidable.Core.html#784" class="Function Operator">⁇³</a>
  <a id="1846" href="Ledger.Conway.Script.Timelock.html#1809" class="Function">Dec-evalTimelock</a> <a id="1863" class="Symbol">{</a><a id="1864" href="Ledger.Conway.Script.Timelock.html#1864" class="Bound">khs</a><a id="1867" class="Symbol">}</a> <a id="1869" class="Symbol">{</a><a id="1870" href="Ledger.Conway.Script.Timelock.html#1870" class="Bound">I</a><a id="1871" class="Symbol">}</a> <a id="1873" class="Symbol">{</a><a id="1874" href="Ledger.Conway.Script.Timelock.html#1874" class="Bound">tl</a><a id="1876" class="Symbol">}</a> <a id="1878" class="Symbol">.</a><a id="1879" href="Class.Decidable.Core.html#264" class="Field">dec</a> <a id="1883" class="Symbol">=</a> <a id="1885" href="Ledger.Conway.Script.Timelock.html#3007" class="Function">go?</a> <a id="1889" href="Ledger.Conway.Script.Timelock.html#1874" class="Bound">tl</a>
    <a id="1896" class="Keyword">where</a> <a id="1902" class="Keyword">mutual</a>
      <a id="1915" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="1918" class="Symbol">=</a> <a id="1920" href="Ledger.Conway.Script.Timelock.html#1175" class="Datatype">evalTimelock</a> <a id="1933" href="Ledger.Conway.Script.Timelock.html#1864" class="Bound">khs</a> <a id="1937" href="Ledger.Conway.Script.Timelock.html#1870" class="Bound">I</a>

      <a id="1946" class="Comment">-- ** inversion principles for `evalTimelock`</a>
      <a id="1998" href="Ledger.Conway.Script.Timelock.html#1998" class="Function">evalAll˘</a> <a id="2007" class="Symbol">:</a> <a id="2009" class="Symbol">∀</a> <a id="2011" class="Symbol">{</a><a id="2012" href="Ledger.Conway.Script.Timelock.html#2012" class="Bound">ss</a><a id="2014" class="Symbol">}</a> <a id="2016" class="Symbol">→</a> <a id="2018" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2021" class="Symbol">(</a><a id="2022" href="Ledger.Conway.Script.Timelock.html#560" class="InductiveConstructor">RequireAllOf</a> <a id="2035" href="Ledger.Conway.Script.Timelock.html#2012" class="Bound">ss</a><a id="2037" class="Symbol">)</a> <a id="2039" class="Symbol">→</a> <a id="2041" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="2045" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2048" href="Ledger.Conway.Script.Timelock.html#2012" class="Bound">ss</a>
      <a id="2057" href="Ledger.Conway.Script.Timelock.html#1998" class="Function">evalAll˘</a> <a id="2066" class="Symbol">(</a><a id="2067" href="Ledger.Conway.Script.Timelock.html#1262" class="InductiveConstructor">evalAll</a> <a id="2075" href="Ledger.Conway.Script.Timelock.html#2075" class="Bound">p</a><a id="2076" class="Symbol">)</a> <a id="2078" class="Symbol">=</a> <a id="2080" href="Ledger.Conway.Script.Timelock.html#2075" class="Bound">p</a>

      <a id="2089" href="Ledger.Conway.Script.Timelock.html#2089" class="Function">evalAny˘</a> <a id="2098" class="Symbol">:</a> <a id="2100" class="Symbol">∀</a> <a id="2102" class="Symbol">{</a><a id="2103" href="Ledger.Conway.Script.Timelock.html#2103" class="Bound">ss</a><a id="2105" class="Symbol">}</a> <a id="2107" class="Symbol">→</a> <a id="2109" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2112" class="Symbol">(</a><a id="2113" href="Ledger.Conway.Script.Timelock.html#613" class="InductiveConstructor">RequireAnyOf</a> <a id="2126" href="Ledger.Conway.Script.Timelock.html#2103" class="Bound">ss</a><a id="2128" class="Symbol">)</a> <a id="2130" class="Symbol">→</a> <a id="2132" href="Data.List.Relation.Unary.Any.html#1148" class="Datatype">Any</a> <a id="2136" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2139" href="Ledger.Conway.Script.Timelock.html#2103" class="Bound">ss</a>
      <a id="2148" href="Ledger.Conway.Script.Timelock.html#2089" class="Function">evalAny˘</a> <a id="2157" class="Symbol">(</a><a id="2158" href="Ledger.Conway.Script.Timelock.html#1355" class="InductiveConstructor">evalAny</a> <a id="2166" href="Ledger.Conway.Script.Timelock.html#2166" class="Bound">p</a><a id="2167" class="Symbol">)</a> <a id="2169" class="Symbol">=</a> <a id="2171" href="Ledger.Conway.Script.Timelock.html#2166" class="Bound">p</a>

      <a id="2180" href="Ledger.Conway.Script.Timelock.html#2180" class="Function">evalTSt˘</a> <a id="2189" class="Symbol">:</a> <a id="2191" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2194" class="Symbol">(</a><a id="2195" href="Ledger.Conway.Script.Timelock.html#772" class="InductiveConstructor">RequireTimeStart</a> <a id="2212" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a><a id="2213" class="Symbol">)</a> <a id="2215" class="Symbol">→</a> <a id="2217" href="Data.Maybe.Relation.Unary.Any.html#835" class="Datatype">M.Any</a> <a id="2223" class="Symbol">(</a><a id="2224" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a> <a id="2226" href="Class.HasOrder.Core.html#608" class="Field Operator">≤_</a><a id="2228" class="Symbol">)</a> <a id="2230" class="Symbol">(</a><a id="2231" href="Ledger.Conway.Script.Timelock.html#1870" class="Bound">I</a> <a id="2233" class="Symbol">.</a><a id="2234" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="2239" class="Symbol">)</a>
      <a id="2247" href="Ledger.Conway.Script.Timelock.html#2180" class="Function">evalTSt˘</a> <a id="2256" class="Symbol">(</a><a id="2257" href="Ledger.Conway.Script.Timelock.html#1613" class="InductiveConstructor">evalTSt</a> <a id="2265" href="Ledger.Conway.Script.Timelock.html#2265" class="Bound">p</a><a id="2266" class="Symbol">)</a> <a id="2268" class="Symbol">=</a> <a id="2270" href="Ledger.Conway.Script.Timelock.html#2265" class="Bound">p</a>

      <a id="2279" href="Ledger.Conway.Script.Timelock.html#2279" class="Function">evalTEx˘</a> <a id="2288" class="Symbol">:</a> <a id="2290" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2293" class="Symbol">(</a><a id="2294" href="Ledger.Conway.Script.Timelock.html#825" class="InductiveConstructor">RequireTimeExpire</a> <a id="2312" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a><a id="2313" class="Symbol">)</a> <a id="2315" class="Symbol">→</a> <a id="2317" href="Data.Maybe.Relation.Unary.Any.html#835" class="Datatype">M.Any</a> <a id="2323" class="Symbol">(</a><a id="2324" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤</a> <a id="2327" href="Ledger.Conway.Script.Timelock.html#1043" class="Generalizable">a</a><a id="2328" class="Symbol">)</a> <a id="2330" class="Symbol">(</a><a id="2331" href="Ledger.Conway.Script.Timelock.html#1870" class="Bound">I</a> <a id="2333" class="Symbol">.</a><a id="2334" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="2339" class="Symbol">)</a>
      <a id="2347" href="Ledger.Conway.Script.Timelock.html#2279" class="Function">evalTEx˘</a> <a id="2356" class="Symbol">(</a><a id="2357" href="Ledger.Conway.Script.Timelock.html#1705" class="InductiveConstructor">evalTEx</a> <a id="2365" href="Ledger.Conway.Script.Timelock.html#2365" class="Bound">p</a><a id="2366" class="Symbol">)</a> <a id="2368" class="Symbol">=</a> <a id="2370" href="Ledger.Conway.Script.Timelock.html#2365" class="Bound">p</a>

      <a id="2379" href="Ledger.Conway.Script.Timelock.html#2379" class="Function">evalSig˘</a> <a id="2388" class="Symbol">:</a> <a id="2390" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2393" class="Symbol">(</a><a id="2394" href="Ledger.Conway.Script.Timelock.html#719" class="InductiveConstructor">RequireSig</a> <a id="2405" href="Ledger.Conway.Script.Timelock.html#1029" class="Generalizable">x</a><a id="2406" class="Symbol">)</a> <a id="2408" class="Symbol">→</a> <a id="2410" href="Ledger.Conway.Script.Timelock.html#1029" class="Generalizable">x</a> <a id="2412" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="2414" href="Ledger.Conway.Script.Timelock.html#1864" class="Bound">khs</a>
      <a id="2424" href="Ledger.Conway.Script.Timelock.html#2379" class="Function">evalSig˘</a> <a id="2433" class="Symbol">(</a><a id="2434" href="Ledger.Conway.Script.Timelock.html#1543" class="InductiveConstructor">evalSig</a> <a id="2442" href="Ledger.Conway.Script.Timelock.html#2442" class="Bound">p</a><a id="2443" class="Symbol">)</a> <a id="2445" class="Symbol">=</a> <a id="2447" href="Ledger.Conway.Script.Timelock.html#2442" class="Bound">p</a>

      <a id="2456" href="Ledger.Conway.Script.Timelock.html#2456" class="Function">evalMOf˘</a> <a id="2465" class="Symbol">:</a> <a id="2467" class="Symbol">∀</a> <a id="2469" class="Symbol">{</a><a id="2470" href="Ledger.Conway.Script.Timelock.html#2470" class="Bound">m</a> <a id="2472" href="Ledger.Conway.Script.Timelock.html#2472" class="Bound">xs</a><a id="2474" class="Symbol">}</a>
        <a id="2484" class="Symbol">→</a> <a id="2486" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2489" class="Symbol">(</a><a id="2490" href="Ledger.Conway.Script.Timelock.html#666" class="InductiveConstructor">RequireMOf</a> <a id="2501" href="Ledger.Conway.Script.Timelock.html#2470" class="Bound">m</a> <a id="2503" href="Ledger.Conway.Script.Timelock.html#2472" class="Bound">xs</a><a id="2505" class="Symbol">)</a>
        <a id="2515" class="Symbol">→</a> <a id="2517" href="stdlib.Data.List.Relation.Unary.MOf.html#1135" class="Datatype">MOf</a> <a id="2521" href="Ledger.Conway.Script.Timelock.html#2470" class="Bound">m</a> <a id="2523" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2526" href="Ledger.Conway.Script.Timelock.html#2472" class="Bound">xs</a>
      <a id="2535" href="Ledger.Conway.Script.Timelock.html#2456" class="Function">evalMOf˘</a> <a id="2544" class="Symbol">(</a><a id="2545" href="Ledger.Conway.Script.Timelock.html#1448" class="InductiveConstructor">evalMOf</a> <a id="2553" href="Ledger.Conway.Script.Timelock.html#2553" class="Bound">p</a><a id="2554" class="Symbol">)</a> <a id="2556" class="Symbol">=</a> <a id="2558" href="Ledger.Conway.Script.Timelock.html#2553" class="Bound">p</a>

      <a id="2567" class="Comment">-- ** inlining recursive decision procedures to please the termination checker</a>
      <a id="2652" href="Ledger.Conway.Script.Timelock.html#2652" class="Function">MOf-go?</a> <a id="2660" class="Symbol">:</a> <a id="2662" class="Symbol">∀</a> <a id="2664" href="Ledger.Conway.Script.Timelock.html#2664" class="Bound">m</a> <a id="2666" href="Ledger.Conway.Script.Timelock.html#2666" class="Bound">xs</a> <a id="2669" class="Symbol">→</a> <a id="2671" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a> <a id="2675" class="Symbol">(</a><a id="2676" href="stdlib.Data.List.Relation.Unary.MOf.html#1135" class="Datatype">MOf</a> <a id="2680" href="Ledger.Conway.Script.Timelock.html#2664" class="Bound">m</a> <a id="2682" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a> <a id="2685" href="Ledger.Conway.Script.Timelock.html#2666" class="Bound">xs</a><a id="2687" class="Symbol">)</a>
      <a id="2695" class="Keyword">unquoteDef</a> <a id="2706" href="Ledger.Conway.Script.Timelock.html#2652" class="Function">MOf-go?</a> <a id="2714" class="Symbol">=</a> <a id="2716" href="Tactic.Inline.html#4646" class="Function">inline</a> <a id="2723" href="Ledger.Conway.Script.Timelock.html#2652" class="Function">MOf-go?</a> <a id="2731" class="Symbol">(</a><a id="2732" class="Keyword">quoteTerm</a> <a id="2742" class="Symbol">(</a><a id="2743" href="stdlib.Data.List.Relation.Unary.MOf.html#2319" class="Function">MOf?</a> <a id="2748" href="Ledger.Conway.Script.Timelock.html#3007" class="Function">go?</a><a id="2751" class="Symbol">))</a>

      <a id="2761" href="Ledger.Conway.Script.Timelock.html#2761" class="Function">all-go?</a> <a id="2769" class="Symbol">:</a> <a id="2771" href="Relation.Unary.html#4543" class="Function">Decidable¹</a> <a id="2782" class="Symbol">(</a><a id="2783" href="Data.List.Relation.Unary.All.html#1644" class="Datatype">All</a> <a id="2787" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a><a id="2789" class="Symbol">)</a>
      <a id="2797" class="Keyword">unquoteDef</a> <a id="2808" href="Ledger.Conway.Script.Timelock.html#2761" class="Function">all-go?</a> <a id="2816" class="Symbol">=</a> <a id="2818" href="Tactic.Inline.html#4646" class="Function">inline</a> <a id="2825" href="Ledger.Conway.Script.Timelock.html#2761" class="Function">all-go?</a> <a id="2833" class="Symbol">(</a><a id="2834" class="Keyword">quoteTerm</a> <a id="2844" class="Symbol">(</a><a id="2845" href="Data.List.Relation.Unary.All.html#6425" class="Function">all?</a> <a id="2850" href="Ledger.Conway.Script.Timelock.html#3007" class="Function">go?</a><a id="2853" class="Symbol">))</a>

      <a id="2863" href="Ledger.Conway.Script.Timelock.html#2863" class="Function">any-go?</a> <a id="2871" class="Symbol">:</a> <a id="2873" href="Relation.Unary.html#4543" class="Function">Decidable¹</a> <a id="2884" class="Symbol">(</a><a id="2885" href="Data.List.Relation.Unary.Any.html#1148" class="Datatype">Any</a> <a id="2889" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a><a id="2891" class="Symbol">)</a>
      <a id="2899" class="Keyword">unquoteDef</a> <a id="2910" href="Ledger.Conway.Script.Timelock.html#2863" class="Function">any-go?</a> <a id="2918" class="Symbol">=</a> <a id="2920" href="Tactic.Inline.html#4646" class="Function">inline</a> <a id="2927" href="Ledger.Conway.Script.Timelock.html#2863" class="Function">any-go?</a> <a id="2935" class="Symbol">(</a><a id="2936" class="Keyword">quoteTerm</a> <a id="2946" class="Symbol">(</a><a id="2947" href="Data.List.Relation.Unary.Any.html#2684" class="Function">any?</a> <a id="2952" href="Ledger.Conway.Script.Timelock.html#3007" class="Function">go?</a><a id="2955" class="Symbol">))</a>

      <a id="2965" class="Comment">-- ** the actual decision procedure</a>
      <a id="3007" href="Ledger.Conway.Script.Timelock.html#3007" class="Function">go?</a> <a id="3011" class="Symbol">:</a> <a id="3013" href="Relation.Unary.html#4543" class="Function">Decidable¹</a> <a id="3024" href="Ledger.Conway.Script.Timelock.html#1915" class="Function">go</a>
      <a id="3033" href="Ledger.Conway.Script.Timelock.html#3007" class="Function">go?</a> <a id="3037" class="Symbol">=</a> <a id="3039" class="Symbol">λ</a> <a id="3041" class="Keyword">where</a>
        <a id="3055" class="Symbol">(</a><a id="3056" href="Ledger.Conway.Script.Timelock.html#560" class="InductiveConstructor">RequireAllOf</a> <a id="3069" href="Ledger.Conway.Script.Timelock.html#3069" class="Bound">ss</a><a id="3071" class="Symbol">)</a>     <a id="3077" class="Symbol">→</a> <a id="3079" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">mapDec</a> <a id="3086" href="Ledger.Conway.Script.Timelock.html#1262" class="InductiveConstructor">evalAll</a> <a id="3094" href="Ledger.Conway.Script.Timelock.html#1998" class="Function">evalAll˘</a> <a id="3103" class="Symbol">(</a><a id="3104" href="Ledger.Conway.Script.Timelock.html#2761" class="Function">all-go?</a> <a id="3112" href="Ledger.Conway.Script.Timelock.html#3069" class="Bound">ss</a><a id="3114" class="Symbol">)</a>
        <a id="3124" class="Symbol">(</a><a id="3125" href="Ledger.Conway.Script.Timelock.html#613" class="InductiveConstructor">RequireAnyOf</a> <a id="3138" href="Ledger.Conway.Script.Timelock.html#3138" class="Bound">ss</a><a id="3140" class="Symbol">)</a>     <a id="3146" class="Symbol">→</a> <a id="3148" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">mapDec</a> <a id="3155" href="Ledger.Conway.Script.Timelock.html#1355" class="InductiveConstructor">evalAny</a> <a id="3163" href="Ledger.Conway.Script.Timelock.html#2089" class="Function">evalAny˘</a> <a id="3172" class="Symbol">(</a><a id="3173" href="Ledger.Conway.Script.Timelock.html#2863" class="Function">any-go?</a> <a id="3181" href="Ledger.Conway.Script.Timelock.html#3138" class="Bound">ss</a><a id="3183" class="Symbol">)</a>
        <a id="3193" class="Symbol">(</a><a id="3194" href="Ledger.Conway.Script.Timelock.html#719" class="InductiveConstructor">RequireSig</a> <a id="3205" href="Ledger.Conway.Script.Timelock.html#3205" class="Bound">x</a><a id="3206" class="Symbol">)</a>        <a id="3215" class="Symbol">→</a> <a id="3217" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">mapDec</a> <a id="3224" href="Ledger.Conway.Script.Timelock.html#1543" class="InductiveConstructor">evalSig</a> <a id="3232" href="Ledger.Conway.Script.Timelock.html#2379" class="Function">evalSig˘</a> <a id="3241" href="Class.Decidable.Core.html#264" class="Field">dec</a>
        <a id="3253" class="Symbol">(</a><a id="3254" href="Ledger.Conway.Script.Timelock.html#772" class="InductiveConstructor">RequireTimeStart</a> <a id="3271" href="Ledger.Conway.Script.Timelock.html#3271" class="Bound">a</a><a id="3272" class="Symbol">)</a>  <a id="3275" class="Symbol">→</a> <a id="3277" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">mapDec</a> <a id="3284" href="Ledger.Conway.Script.Timelock.html#1613" class="InductiveConstructor">evalTSt</a> <a id="3292" href="Ledger.Conway.Script.Timelock.html#2180" class="Function">evalTSt˘</a> <a id="3301" href="Class.Decidable.Core.html#264" class="Field">dec</a>
        <a id="3313" class="Symbol">(</a><a id="3314" href="Ledger.Conway.Script.Timelock.html#825" class="InductiveConstructor">RequireTimeExpire</a> <a id="3332" href="Ledger.Conway.Script.Timelock.html#3332" class="Bound">a</a><a id="3333" class="Symbol">)</a> <a id="3335" class="Symbol">→</a> <a id="3337" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">mapDec</a> <a id="3344" href="Ledger.Conway.Script.Timelock.html#1705" class="InductiveConstructor">evalTEx</a> <a id="3352" href="Ledger.Conway.Script.Timelock.html#2279" class="Function">evalTEx˘</a> <a id="3361" href="Class.Decidable.Core.html#264" class="Field">dec</a>
        <a id="3373" class="Symbol">(</a><a id="3374" href="Ledger.Conway.Script.Timelock.html#666" class="InductiveConstructor">RequireMOf</a> <a id="3385" href="Ledger.Conway.Script.Timelock.html#3385" class="Bound">m</a> <a id="3387" href="Ledger.Conway.Script.Timelock.html#3387" class="Bound">xs</a><a id="3389" class="Symbol">)</a>     <a id="3395" class="Symbol">→</a> <a id="3397" href="Relation.Nullary.Decidable.Core.html#5914" class="Function">mapDec</a> <a id="3404" href="Ledger.Conway.Script.Timelock.html#1448" class="InductiveConstructor">evalMOf</a> <a id="3412" href="Ledger.Conway.Script.Timelock.html#2456" class="Function">evalMOf˘</a> <a id="3421" class="Symbol">(</a><a id="3422" href="Ledger.Conway.Script.Timelock.html#2652" class="Function">MOf-go?</a> <a id="3430" href="Ledger.Conway.Script.Timelock.html#3385" class="Bound">m</a> <a id="3432" href="Ledger.Conway.Script.Timelock.html#3387" class="Bound">xs</a><a id="3434" class="Symbol">)</a>

</pre></body></html>