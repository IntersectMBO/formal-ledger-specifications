<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Types.Numeric.UnitInterval</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Comment">-- Rational number in the unit interval.</a>
<a id="66" class="Keyword">module</a> <a id="73" href="Ledger.Conway.Types.Numeric.UnitInterval.html" class="Module">Ledger.Conway.Types.Numeric.UnitInterval</a> <a id="114" class="Keyword">where</a>

<a id="121" class="Keyword">open</a> <a id="126" class="Keyword">import</a> <a id="133" href="Prelude.html" class="Module">Prelude</a>
  <a id="143" class="Keyword">hiding</a> <a id="150" class="Symbol">(</a><a id="151" href="Data.Sum.Base.html#811" class="Function Operator">[_,_]</a><a id="156" class="Symbol">;</a> <a id="158" href="Data.List.Base.html#5205" class="Function Operator">[_]</a><a id="161" class="Symbol">;</a> <a id="163" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="166" class="Symbol">)</a>

<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>
<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Class.Show.html" class="Module">Class.Show</a> <a id="225" class="Keyword">using</a> <a id="231" class="Symbol">(</a><a id="232" href="Class.Show.Core.html#125" class="Record">Show</a><a id="236" class="Symbol">;</a> <a id="238" href="Class.Show.Core.html#187" class="Field">show</a><a id="242" class="Symbol">)</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Data.Irrelevant.html" class="Module">Data.Irrelevant</a> <a id="272" class="Keyword">using</a> <a id="278" class="Symbol">(</a><a id="279" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">[_]</a><a id="282" class="Symbol">)</a>
<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="310" class="Keyword">using</a> <a id="316" class="Symbol">(</a><a id="317" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="318" class="Symbol">;</a> <a id="320" href="Data.Rational.Base.html#2465" class="Datatype Operator">_≤_</a><a id="323" class="Symbol">;</a> <a id="325" href="Data.Rational.Properties.html#19360" class="Function Operator">_≤?_</a><a id="329" class="Symbol">;</a> <a id="331" href="Data.Rational.Base.html#6315" class="Function Operator">_*_</a><a id="334" class="Symbol">;</a> <a id="336" href="Data.Rational.Base.html#5785" class="Function">nonNegative</a><a id="347" class="Symbol">)</a>
<a id="349" class="Keyword">open</a> <a id="354" class="Keyword">import</a> <a id="361" href="Data.Rational.Properties.html" class="Module">Data.Rational.Properties</a>
<a id="386" class="Keyword">open</a> <a id="391" class="Keyword">import</a> <a id="398" href="Data.Rational.Show.html" class="Module">Data.Rational.Show</a> <a id="417" class="Keyword">using</a> <a id="423" class="Symbol">()</a> <a id="426" class="Keyword">renaming</a> <a id="435" class="Symbol">(</a><a id="436" href="Data.Rational.Show.html#398" class="Function">show</a> <a id="441" class="Symbol">to</a> <a id="444" class="Function">ℚshow</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Data.Refinement.html" class="Module">Data.Refinement</a> <a id="479" class="Keyword">using</a> <a id="485" class="Symbol">(</a><a id="486" href="Data.Refinement.Base.html#1052" class="Function">Refinement-syntax</a><a id="503" class="Symbol">;</a> <a id="505" href="Data.Refinement.Base.html#759" class="Field">value</a><a id="510" class="Symbol">;</a> <a id="512" href="Data.Refinement.Base.html#747" class="InductiveConstructor Operator">_,_</a><a id="515" class="Symbol">)</a>

<a id="518" class="Keyword">open</a> <a id="523" href="Data.Rational.Properties.html#26177" class="Module">≤-Reasoning</a>

<a id="536" class="Comment">-- inUnitInterval predicate</a>
<a id="inUnitInterval"></a><a id="564" href="Ledger.Conway.Types.Numeric.UnitInterval.html#564" class="Function">inUnitInterval</a> <a id="579" class="Symbol">:</a> <a id="581" class="Symbol">(</a><a id="582" href="Ledger.Conway.Types.Numeric.UnitInterval.html#582" class="Bound">x</a> <a id="584" class="Symbol">:</a> <a id="586" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="587" class="Symbol">)</a> <a id="589" class="Symbol">→</a> <a id="591" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="596" href="Ledger.Conway.Types.Numeric.UnitInterval.html#564" class="Function">inUnitInterval</a> <a id="611" href="Ledger.Conway.Types.Numeric.UnitInterval.html#611" class="Bound">x</a> <a id="613" class="Symbol">=</a> <a id="615" class="Symbol">(</a><a id="616" class="Number">0</a> <a id="618" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="620" href="Ledger.Conway.Types.Numeric.UnitInterval.html#611" class="Bound">x</a><a id="621" class="Symbol">)</a> <a id="623" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="625" class="Symbol">(</a><a id="626" href="Ledger.Conway.Types.Numeric.UnitInterval.html#611" class="Bound">x</a> <a id="628" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="630" class="Number">1</a><a id="631" class="Symbol">)</a>

<a id="634" class="Comment">-- Decide whether a rational number is in the unit interval.</a>
<a id="isInUnitInterval"></a><a id="695" href="Ledger.Conway.Types.Numeric.UnitInterval.html#695" class="Function">isInUnitInterval</a> <a id="712" class="Symbol">:</a> <a id="714" class="Symbol">(</a><a id="715" href="Ledger.Conway.Types.Numeric.UnitInterval.html#715" class="Bound">x</a> <a id="717" class="Symbol">:</a> <a id="719" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="720" class="Symbol">)</a> <a id="722" class="Symbol">→</a> <a id="724" href="Relation.Nullary.Decidable.Core.html#1861" class="Record">Dec</a> <a id="728" class="Symbol">(</a><a id="729" href="Ledger.Conway.Types.Numeric.UnitInterval.html#564" class="Function">inUnitInterval</a> <a id="744" href="Ledger.Conway.Types.Numeric.UnitInterval.html#715" class="Bound">x</a><a id="745" class="Symbol">)</a>
<a id="747" href="Ledger.Conway.Types.Numeric.UnitInterval.html#695" class="Function">isInUnitInterval</a> <a id="764" href="Ledger.Conway.Types.Numeric.UnitInterval.html#764" class="Bound">x</a> <a id="766" class="Symbol">=</a> <a id="768" class="Symbol">(</a><a id="769" class="Number">0</a> <a id="771" href="Data.Rational.Properties.html#19360" class="Function Operator">≤?</a> <a id="774" href="Ledger.Conway.Types.Numeric.UnitInterval.html#764" class="Bound">x</a><a id="775" class="Symbol">)</a> <a id="777" href="Relation.Nullary.Decidable.Core.html#3103" class="Function Operator">×-dec</a> <a id="783" class="Symbol">(</a><a id="784" href="Ledger.Conway.Types.Numeric.UnitInterval.html#764" class="Bound">x</a> <a id="786" href="Data.Rational.Properties.html#19360" class="Function Operator">≤?</a> <a id="789" class="Number">1</a><a id="790" class="Symbol">)</a>

<a id="793" class="Comment">-- Multiplying with a number from the unit interval only decreases.</a>
<a id="inUnitInterval-*-≤y"></a><a id="861" href="Ledger.Conway.Types.Numeric.UnitInterval.html#861" class="Function">inUnitInterval-*-≤y</a> <a id="881" class="Symbol">:</a> <a id="883" class="Symbol">∀</a> <a id="885" class="Symbol">(</a><a id="886" href="Ledger.Conway.Types.Numeric.UnitInterval.html#886" class="Bound">x</a> <a id="888" href="Ledger.Conway.Types.Numeric.UnitInterval.html#888" class="Bound">y</a> <a id="890" class="Symbol">:</a> <a id="892" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="893" class="Symbol">)</a> <a id="895" class="Symbol">→</a> <a id="897" href="Ledger.Conway.Types.Numeric.UnitInterval.html#564" class="Function">inUnitInterval</a> <a id="912" href="Ledger.Conway.Types.Numeric.UnitInterval.html#886" class="Bound">x</a> <a id="914" class="Symbol">→</a> <a id="916" class="Number">0</a> <a id="918" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="920" href="Ledger.Conway.Types.Numeric.UnitInterval.html#888" class="Bound">y</a> <a id="922" class="Symbol">→</a> <a id="924" href="Ledger.Conway.Types.Numeric.UnitInterval.html#886" class="Bound">x</a> <a id="926" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="928" href="Ledger.Conway.Types.Numeric.UnitInterval.html#888" class="Bound">y</a> <a id="930" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="932" href="Ledger.Conway.Types.Numeric.UnitInterval.html#888" class="Bound">y</a>
<a id="934" href="Ledger.Conway.Types.Numeric.UnitInterval.html#861" class="Function">inUnitInterval-*-≤y</a> <a id="954" href="Ledger.Conway.Types.Numeric.UnitInterval.html#954" class="Bound">x</a> <a id="956" href="Ledger.Conway.Types.Numeric.UnitInterval.html#956" class="Bound">y</a> <a id="958" class="Symbol">(</a><a id="959" href="Ledger.Conway.Types.Numeric.UnitInterval.html#959" class="Bound">0≤x</a> <a id="963" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="965" href="Ledger.Conway.Types.Numeric.UnitInterval.html#965" class="Bound">x≤1</a><a id="968" class="Symbol">)</a> <a id="970" href="Ledger.Conway.Types.Numeric.UnitInterval.html#970" class="Bound">0≤y</a> <a id="974" class="Symbol">=</a>
  <a id="978" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="988" href="Ledger.Conway.Types.Numeric.UnitInterval.html#954" class="Bound">x</a> <a id="990" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="992" href="Ledger.Conway.Types.Numeric.UnitInterval.html#956" class="Bound">y</a>  <a id="995" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="998" href="Data.Rational.Properties.html#47711" class="Function">*-monoʳ-≤-nonNeg</a> <a id="1015" href="Ledger.Conway.Types.Numeric.UnitInterval.html#956" class="Bound">y</a> <a id="1017" class="Symbol">⦃</a> <a id="1019" href="Data.Rational.Base.html#5785" class="Function">nonNegative</a> <a id="1031" href="Ledger.Conway.Types.Numeric.UnitInterval.html#970" class="Bound">0≤y</a> <a id="1035" class="Symbol">⦄</a> <a id="1037" href="Ledger.Conway.Types.Numeric.UnitInterval.html#965" class="Bound">x≤1</a> <a id="1041" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
    <a id="1047" class="Number">1</a> <a id="1049" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="1051" href="Ledger.Conway.Types.Numeric.UnitInterval.html#956" class="Bound">y</a>  <a id="1054" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1057" href="Data.Rational.Properties.html#42576" class="Function">*-identityˡ</a> <a id="1069" class="Symbol">_</a> <a id="1071" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1077" href="Ledger.Conway.Types.Numeric.UnitInterval.html#956" class="Bound">y</a>      <a id="1084" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="1087" class="Comment">-- Left multiplication by unit interval element preserves non-negativity.</a>
<a id="inUnitInterval-*-0≤"></a><a id="1161" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1161" class="Function">inUnitInterval-*-0≤</a> <a id="1181" class="Symbol">:</a> <a id="1183" class="Symbol">∀</a> <a id="1185" class="Symbol">(</a><a id="1186" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1186" class="Bound">x</a> <a id="1188" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1188" class="Bound">y</a> <a id="1190" class="Symbol">:</a> <a id="1192" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="1193" class="Symbol">)</a> <a id="1195" class="Symbol">→</a> <a id="1197" href="Ledger.Conway.Types.Numeric.UnitInterval.html#564" class="Function">inUnitInterval</a> <a id="1212" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1188" class="Bound">y</a> <a id="1214" class="Symbol">→</a> <a id="1216" class="Number">0</a> <a id="1218" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="1220" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1186" class="Bound">x</a> <a id="1222" class="Symbol">→</a> <a id="1224" class="Number">0</a> <a id="1226" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="1228" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1186" class="Bound">x</a> <a id="1230" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="1232" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1188" class="Bound">y</a>
<a id="1234" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1161" class="Function">inUnitInterval-*-0≤</a> <a id="1254" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1254" class="Bound">x</a> <a id="1256" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1256" class="Bound">y</a> <a id="1258" class="Symbol">(</a><a id="1259" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1259" class="Bound">0≤y</a> <a id="1263" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1265" class="Symbol">_)</a> <a id="1268" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1268" class="Bound">0≤x</a> <a id="1272" class="Symbol">=</a>
  <a id="1276" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="1286" class="Number">0</a>      <a id="1293" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1296" href="Relation.Binary.PropositionalEquality.Core.html#1893" class="Function">sym</a> <a id="1300" class="Symbol">(</a><a id="1301" href="Data.Rational.Properties.html#42957" class="Function">*-zeroʳ</a> <a id="1309" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1254" class="Bound">x</a><a id="1310" class="Symbol">)</a> <a id="1312" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1318" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1254" class="Bound">x</a> <a id="1320" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="1322" class="Number">0</a>  <a id="1325" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="1328" href="Data.Rational.Properties.html#48056" class="Function">*-monoˡ-≤-nonNeg</a> <a id="1345" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1254" class="Bound">x</a> <a id="1347" class="Symbol">⦃</a> <a id="1349" href="Data.Rational.Base.html#5785" class="Function">nonNegative</a> <a id="1361" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1268" class="Bound">0≤x</a> <a id="1365" class="Symbol">⦄</a> <a id="1367" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1259" class="Bound">0≤y</a> <a id="1371" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
    <a id="1377" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1254" class="Bound">x</a> <a id="1379" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="1381" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1256" class="Bound">y</a>  <a id="1384" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="1387" class="Comment">-- Left multiplication by unit interval element preserves being upper boundeded by 1.</a>
<a id="inUnitInterval-*-≤1"></a><a id="1473" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1473" class="Function">inUnitInterval-*-≤1</a> <a id="1493" class="Symbol">:</a> <a id="1495" class="Symbol">∀</a> <a id="1497" class="Symbol">(</a><a id="1498" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1498" class="Bound">x</a> <a id="1500" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1500" class="Bound">y</a> <a id="1502" class="Symbol">:</a> <a id="1504" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="1505" class="Symbol">)</a> <a id="1507" class="Symbol">→</a> <a id="1509" href="Ledger.Conway.Types.Numeric.UnitInterval.html#564" class="Function">inUnitInterval</a> <a id="1524" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1498" class="Bound">x</a> <a id="1526" class="Symbol">→</a> <a id="1528" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1500" class="Bound">y</a> <a id="1530" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="1532" class="Number">1</a> <a id="1534" class="Symbol">→</a> <a id="1536" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1498" class="Bound">x</a> <a id="1538" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="1540" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1500" class="Bound">y</a> <a id="1542" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="1544" class="Number">1</a>
<a id="1546" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1473" class="Function">inUnitInterval-*-≤1</a> <a id="1566" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1566" class="Bound">x</a> <a id="1568" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1568" class="Bound">y</a> <a id="1570" class="Symbol">(</a><a id="1571" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1571" class="Bound">0≤x</a> <a id="1575" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1577" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1577" class="Bound">x≤1</a><a id="1580" class="Symbol">)</a> <a id="1582" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1582" class="Bound">y≤1</a> <a id="1586" class="Symbol">=</a>
  <a id="1590" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="1600" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1566" class="Bound">x</a> <a id="1602" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="1604" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1568" class="Bound">y</a>  <a id="1607" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="1610" href="Data.Rational.Properties.html#48056" class="Function">*-monoˡ-≤-nonNeg</a> <a id="1627" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1566" class="Bound">x</a> <a id="1629" class="Symbol">⦃</a> <a id="1631" href="Data.Rational.Base.html#5785" class="Function">nonNegative</a> <a id="1643" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1571" class="Bound">0≤x</a> <a id="1647" class="Symbol">⦄</a> <a id="1649" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1582" class="Bound">y≤1</a> <a id="1653" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
    <a id="1659" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1566" class="Bound">x</a> <a id="1661" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="1663" class="Number">1</a>  <a id="1666" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1669" href="Data.Rational.Properties.html#42682" class="Function">*-identityʳ</a> <a id="1681" class="Symbol">_</a> <a id="1683" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1689" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1566" class="Bound">x</a>      <a id="1696" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">≤⟨</a> <a id="1699" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1577" class="Bound">x≤1</a> <a id="1703" href="Relation.Binary.Reasoning.Syntax.html#5544" class="Function">⟩</a>
    <a id="1709" class="Number">1</a>      <a id="1716" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>

<a id="1719" class="Comment">-- UnitInterval: rational number in the unit interval [0, 1].</a>
<a id="UnitInterval"></a><a id="1781" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a> <a id="1794" class="Symbol">:</a> <a id="1796" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1801" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a> <a id="1814" class="Symbol">=</a> <a id="1816" href="Data.Refinement.Base.html#1052" class="Function">[</a> <a id="1818" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1818" class="Bound">x</a> <a id="1820" href="Data.Refinement.Base.html#1052" class="Function">∈</a> <a id="1822" href="Data.Rational.Base.html#1342" class="Record">ℚ</a> <a id="1824" href="Data.Refinement.Base.html#1052" class="Function">∣</a> <a id="1826" href="Ledger.Conway.Types.Numeric.UnitInterval.html#564" class="Function">inUnitInterval</a> <a id="1841" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1818" class="Bound">x</a> <a id="1843" href="Data.Refinement.Base.html#1052" class="Function">]</a>

<a id="1846" class="Keyword">instance</a>
  <a id="Show-UnitInterval"></a><a id="1857" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1857" class="Function">Show-UnitInterval</a> <a id="1875" class="Symbol">:</a> <a id="1877" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="1882" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a>
  <a id="1897" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1857" class="Function">Show-UnitInterval</a> <a id="1915" class="Symbol">.</a><a id="1916" href="Class.Show.Core.html#187" class="Field">show</a> <a id="1921" class="Symbol">=</a> <a id="1923" href="Ledger.Conway.Types.Numeric.UnitInterval.html#444" class="Function">ℚshow</a> <a id="1929" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1931" href="Data.Refinement.Base.html#759" class="Field">value</a>

<a id="1938" class="Comment">-- In the cardano-ledger codebase:</a>
<a id="1973" class="Comment">--  unboundRational</a>
<a id="fromUnitInterval"></a><a id="1993" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1993" class="Function">fromUnitInterval</a> <a id="2010" class="Symbol">:</a> <a id="2012" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a> <a id="2025" class="Symbol">→</a> <a id="2027" href="Data.Rational.Base.html#1342" class="Record">ℚ</a>
<a id="2029" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1993" class="Function">fromUnitInterval</a> <a id="2046" class="Symbol">=</a> <a id="2048" href="Data.Refinement.Base.html#759" class="Field">value</a>

<a id="2055" class="Comment">-- In the cardano-ledger codebase:</a>
<a id="2090" class="Comment">--  unboundRational</a>
<a id="toUnitInterval"></a><a id="2110" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2110" class="Function">toUnitInterval</a> <a id="2125" class="Symbol">:</a> <a id="2127" href="Data.Rational.Base.html#1342" class="Record">ℚ</a> <a id="2129" class="Symbol">→</a> <a id="2131" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2137" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a>
<a id="2150" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2110" class="Function">toUnitInterval</a> <a id="2165" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2165" class="Bound">x</a> <a id="2167" class="Keyword">with</a> <a id="2172" href="Ledger.Conway.Types.Numeric.UnitInterval.html#695" class="Function">isInUnitInterval</a> <a id="2189" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2165" class="Bound">x</a>
<a id="2191" class="Symbol">...</a> <a id="2195" class="Symbol">|</a> <a id="2197" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="2200" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2200" class="Bound">¬p</a> <a id="2203" class="Symbol">=</a> <a id="2205" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2213" class="Symbol">...</a> <a id="2217" class="Symbol">|</a> <a id="2219" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="2223" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2223" class="Bound">p</a> <a id="2225" class="Symbol">=</a> <a id="2227" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2232" class="Symbol">(</a><a id="2233" class="Bound">x</a> <a id="2235" href="Data.Refinement.Base.html#747" class="InductiveConstructor Operator">,</a> <a id="2237" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">[</a> <a id="2239" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2223" class="Bound">p</a> <a id="2241" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">]</a><a id="2242" class="Symbol">)</a>

<a id="2245" class="Comment">-- Helper function to make an element of the Refinement type</a>
<a id="2306" class="Comment">-- that is useful in the case where Agda can infer the evidence</a>
<a id="2370" class="Comment">-- automatically by computation.</a>
<a id="2403" class="Comment">-- Usage example:  mkUnitInterval (+ 2 / 10)</a>
<a id="mkUnitInterval"></a><a id="2448" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a> <a id="2463" class="Symbol">:</a> <a id="2465" class="Symbol">∀</a> <a id="2467" class="Symbol">(</a><a id="2468" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2468" class="Bound">x</a> <a id="2470" class="Symbol">:</a> <a id="2472" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="2473" class="Symbol">)</a> <a id="2475" class="Symbol">→</a> <a id="2477" class="Symbol">{</a><a id="2478" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="2480" class="Symbol">(</a><a id="2481" href="Relation.Nullary.Decidable.Core.html#1927" class="Field">does</a> <a id="2486" class="Symbol">(</a><a id="2487" href="Ledger.Conway.Types.Numeric.UnitInterval.html#695" class="Function">isInUnitInterval</a> <a id="2504" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2468" class="Bound">x</a><a id="2505" class="Symbol">))}</a> <a id="2509" class="Symbol">→</a> <a id="2511" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a>
<a id="2524" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a> <a id="2539" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2539" class="Bound">x</a> <a id="2541" class="Symbol">{</a><a id="2542" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2542" class="Bound">evidence</a><a id="2550" class="Symbol">}</a> <a id="2552" class="Keyword">with</a> <a id="2557" href="Ledger.Conway.Types.Numeric.UnitInterval.html#695" class="Function">isInUnitInterval</a> <a id="2574" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2539" class="Bound">x</a> <a id="2576" class="Keyword">in</a> <a id="2579" class="Argument">eq</a>
<a id="2582" class="Symbol">...</a> <a id="2586" class="Symbol">|</a> <a id="2588" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a>  <a id="2592" class="Symbol">_</a> <a id="2594" class="Keyword">rewrite</a> <a id="2602" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="2607" href="Relation.Nullary.Decidable.Core.html#1927" class="Field">does</a> <a id="2612" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2579" class="Bound">eq</a> <a id="2615" class="Symbol">=</a> <a id="2617" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="2624" class="Bound">evidence</a>
<a id="2633" class="Symbol">...</a> <a id="2637" class="Symbol">|</a> <a id="2639" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="2643" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2643" class="Bound">p</a> <a id="2645" class="Symbol">=</a> <a id="2647" class="Bound">x</a> <a id="2649" href="Data.Refinement.Base.html#747" class="InductiveConstructor Operator">,</a> <a id="2651" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">[</a> <a id="2653" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2643" class="Bound">p</a> <a id="2655" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">]</a>

<a id="2658" class="Comment">-- Clamp a rational number to the unit interval.</a>
<a id="2707" class="Comment">-- Values below 0 or above 1 are set to 0 or 1, respectively.</a>
<a id="clamp"></a><a id="2769" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2769" class="Function">clamp</a> <a id="2775" class="Symbol">:</a> <a id="2777" href="Data.Rational.Base.html#1342" class="Record">ℚ</a> <a id="2779" class="Symbol">→</a> <a id="2781" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a>
<a id="2794" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2769" class="Function">clamp</a> <a id="2800" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2800" class="Bound">x</a> <a id="2802" class="Keyword">with</a> <a id="2807" class="Number">0</a> <a id="2809" href="Data.Rational.Properties.html#19360" class="Function Operator">≤?</a> <a id="2812" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2800" class="Bound">x</a>
<a id="2814" class="Symbol">...</a> <a id="2818" class="Symbol">|</a> <a id="2820" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a>  <a id="2824" class="Symbol">_</a> <a id="2826" class="Symbol">=</a> <a id="2828" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a> <a id="2843" class="Number">0</a>
<a id="2845" class="Symbol">...</a> <a id="2849" class="Symbol">|</a> <a id="2851" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="2855" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2855" class="Bound">0≤x</a> <a id="2859" class="Keyword">with</a> <a id="2864" class="Bound">x</a> <a id="2866" href="Data.Rational.Properties.html#19360" class="Function Operator">≤?</a> <a id="2869" class="Number">1</a>
<a id="2871" class="Symbol">...</a>     <a id="2879" class="Symbol">|</a> <a id="2881" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a>  <a id="2885" class="Symbol">_</a>   <a id="2889" class="Symbol">=</a> <a id="2891" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a> <a id="2906" class="Number">1</a>
<a id="2908" class="Symbol">...</a>     <a id="2916" class="Symbol">|</a> <a id="2918" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="2922" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2922" class="Bound">x≤1</a> <a id="2926" class="Symbol">=</a> <a id="2928" class="Symbol">(</a><a id="2929" class="Bound">x</a> <a id="2931" href="Data.Refinement.Base.html#747" class="InductiveConstructor Operator">,</a> <a id="2933" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">[</a> <a id="2935" class="Bound">0≤x</a> <a id="2939" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2941" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2922" class="Bound">x≤1</a> <a id="2945" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">]</a><a id="2946" class="Symbol">)</a>

<a id="2949" class="Comment">-- UnitInterval Properties</a>

<a id="2977" class="Comment">-- The predicate for &#39;UnitInterval&#39; also holds in a proof-relevant context.</a>
<a id="fromUnitInterval-inUnitInterval"></a><a id="3053" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3053" class="Function">fromUnitInterval-inUnitInterval</a>
  <a id="3087" class="Symbol">:</a> <a id="3089" class="Symbol">∀</a> <a id="3091" class="Symbol">(</a><a id="3092" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3092" class="Bound">x</a> <a id="3094" class="Symbol">:</a> <a id="3096" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a><a id="3108" class="Symbol">)</a> <a id="3110" class="Symbol">→</a> <a id="3112" href="Ledger.Conway.Types.Numeric.UnitInterval.html#564" class="Function">inUnitInterval</a> <a id="3127" class="Symbol">(</a><a id="3128" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1993" class="Function">fromUnitInterval</a> <a id="3145" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3092" class="Bound">x</a><a id="3146" class="Symbol">)</a>
<a id="3148" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3053" class="Function">fromUnitInterval-inUnitInterval</a> <a id="3180" class="Symbol">(</a><a id="3181" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3181" class="Bound">x</a> <a id="3183" href="Data.Refinement.Base.html#747" class="InductiveConstructor Operator">,</a> <a id="3185" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">[</a> <a id="3187" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3187" class="Bound">p0</a> <a id="3190" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">]</a><a id="3191" class="Symbol">)</a> <a id="3193" class="Keyword">with</a> <a id="3198" href="Ledger.Conway.Types.Numeric.UnitInterval.html#695" class="Function">isInUnitInterval</a> <a id="3215" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3181" class="Bound">x</a>
<a id="3217" class="Symbol">...</a> <a id="3221" class="Symbol">|</a> <a id="3223" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="3226" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3226" class="Bound">¬p</a> <a id="3229" class="Symbol">=</a> <a id="3231" href="Data.Empty.html#1129" class="Function">⊥-elim-irr</a> <a id="3242" class="Symbol">(</a><a id="3243" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3226" class="Bound">¬p</a> <a id="3246" class="Bound">p0</a><a id="3248" class="Symbol">)</a>
<a id="3250" class="Symbol">...</a> <a id="3254" class="Symbol">|</a> <a id="3256" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="3260" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3260" class="Bound">p</a> <a id="3262" class="Symbol">=</a> <a id="3264" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3260" class="Bound">p</a>

<a id="3267" class="Comment">-- Left multiplication by unit interval element preserves non-negativity.</a>
<a id="UnitInterval-*-0≤"></a><a id="3341" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3341" class="Function">UnitInterval-*-0≤</a>
  <a id="3361" class="Symbol">:</a> <a id="3363" class="Symbol">∀</a> <a id="3365" class="Symbol">(</a><a id="3366" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3366" class="Bound">x</a> <a id="3368" class="Symbol">:</a> <a id="3370" href="Data.Rational.Base.html#1342" class="Record">ℚ</a><a id="3371" class="Symbol">)</a> <a id="3373" class="Symbol">(</a><a id="3374" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3374" class="Bound">y</a> <a id="3376" class="Symbol">:</a> <a id="3378" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a><a id="3390" class="Symbol">)</a> <a id="3392" class="Symbol">→</a> <a id="3394" class="Number">0</a> <a id="3396" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="3398" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3366" class="Bound">x</a> <a id="3400" class="Symbol">→</a> <a id="3402" class="Number">0</a> <a id="3404" href="Data.Rational.Base.html#2465" class="Datatype Operator">≤</a> <a id="3406" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3366" class="Bound">x</a> <a id="3408" href="Data.Rational.Base.html#6315" class="Function Operator">*</a> <a id="3410" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1993" class="Function">fromUnitInterval</a> <a id="3427" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3374" class="Bound">y</a>
<a id="3429" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3341" class="Function">UnitInterval-*-0≤</a> <a id="3447" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3447" class="Bound">x</a> <a id="3449" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3449" class="Bound">y</a> <a id="3451" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3451" class="Bound">0≤x</a> <a id="3455" class="Symbol">=</a>
  <a id="3459" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1161" class="Function">inUnitInterval-*-0≤</a> <a id="3479" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3447" class="Bound">x</a> <a id="3481" class="Symbol">(</a><a id="3482" href="Data.Refinement.Base.html#759" class="Field">value</a> <a id="3488" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3449" class="Bound">y</a><a id="3489" class="Symbol">)</a> <a id="3491" class="Symbol">(</a><a id="3492" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3053" class="Function">fromUnitInterval-inUnitInterval</a> <a id="3524" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3449" class="Bound">y</a><a id="3525" class="Symbol">)</a> <a id="3527" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3451" class="Bound">0≤x</a>

<a id="3532" class="Comment">-- to/from is the identity</a>
<a id="prop-toUnitInterval-fromUnitInterval"></a><a id="3559" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3559" class="Function">prop-toUnitInterval-fromUnitInterval</a> <a id="3596" class="Symbol">:</a> <a id="3598" class="Symbol">∀</a> <a id="3600" class="Symbol">(</a><a id="3601" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3601" class="Bound">x</a> <a id="3603" class="Symbol">:</a> <a id="3605" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1781" class="Function">UnitInterval</a><a id="3617" class="Symbol">)</a>
  <a id="3621" class="Symbol">→</a> <a id="3623" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2110" class="Function">toUnitInterval</a> <a id="3638" class="Symbol">(</a><a id="3639" href="Ledger.Conway.Types.Numeric.UnitInterval.html#1993" class="Function">fromUnitInterval</a> <a id="3656" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3601" class="Bound">x</a><a id="3657" class="Symbol">)</a> <a id="3659" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3661" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3666" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3601" class="Bound">x</a>
<a id="3668" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3559" class="Function">prop-toUnitInterval-fromUnitInterval</a> <a id="3705" class="Symbol">(</a><a id="3706" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3706" class="Bound">x</a> <a id="3708" href="Data.Refinement.Base.html#747" class="InductiveConstructor Operator">,</a> <a id="3710" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">[</a> <a id="3712" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3712" class="Bound">p0</a> <a id="3715" href="Data.Irrelevant.html#776" class="InductiveConstructor Operator">]</a><a id="3716" class="Symbol">)</a> <a id="3718" class="Keyword">with</a> <a id="3723" href="Ledger.Conway.Types.Numeric.UnitInterval.html#695" class="Function">isInUnitInterval</a> <a id="3740" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3706" class="Bound">x</a>
<a id="3742" class="Symbol">...</a> <a id="3746" class="Symbol">|</a> <a id="3748" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="3751" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3751" class="Bound">¬p</a> <a id="3754" class="Symbol">=</a> <a id="3756" href="Data.Empty.html#1129" class="Function">⊥-elim-irr</a> <a id="3767" class="Symbol">(</a><a id="3768" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3751" class="Bound">¬p</a> <a id="3771" class="Bound">p0</a><a id="3773" class="Symbol">)</a>
<a id="3775" class="Symbol">...</a> <a id="3779" class="Symbol">|</a> <a id="3781" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="3785" href="Ledger.Conway.Types.Numeric.UnitInterval.html#3785" class="Bound">p</a> <a id="3787" class="Symbol">=</a> <a id="3789" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
</pre></body></html>