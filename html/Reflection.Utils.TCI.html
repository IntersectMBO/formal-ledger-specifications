<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.Utils.TCI</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Meta.Init.html" class="Module">Meta.Init</a>

<a id="85" class="Keyword">open</a> <a id="90" class="Keyword">import</a> <a id="97" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Class.MonadError.Instances.html" class="Module">Class.MonadError.Instances</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Class.MonadReader.Instances.html" class="Module">Class.MonadReader.Instances</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>

<a id="225" class="Keyword">module</a> <a id="232" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>
  <a id="255" class="Symbol">{</a><a id="256" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="258" class="Symbol">:</a> <a id="260" class="Symbol">∀</a> <a id="262" class="Symbol">{</a><a id="263" href="Reflection.Utils.TCI.html#263" class="Bound">a</a><a id="264" class="Symbol">}</a> <a id="266" class="Symbol">→</a> <a id="268" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="272" href="Reflection.Utils.TCI.html#263" class="Bound">a</a> <a id="274" class="Symbol">→</a> <a id="276" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="280" href="Reflection.Utils.TCI.html#263" class="Bound">a</a><a id="281" class="Symbol">}</a> <a id="283" class="Symbol">⦃</a> <a id="285" href="Reflection.Utils.TCI.html#285" class="Bound">_</a> <a id="287" class="Symbol">:</a> <a id="289" href="Class.Monad.Core.html#182" class="Record">Monad</a> <a id="295" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="297" class="Symbol">⦄</a> <a id="299" class="Symbol">⦃</a> <a id="301" href="Reflection.Utils.TCI.html#301" class="Bound">me</a> <a id="304" class="Symbol">:</a> <a id="306" href="Class.MonadError.html#248" class="Record">MonadError</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="323" href="Agda.Builtin.Reflection.html#8214" class="Datatype">ErrorPart</a><a id="332" class="Symbol">)</a> <a id="334" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="336" class="Symbol">⦄</a>
  <a id="340" class="Symbol">⦃</a> <a id="342" href="Reflection.Utils.TCI.html#342" class="Bound">mre</a> <a id="346" class="Symbol">:</a> <a id="348" href="Class.MonadReader.html#205" class="Record">MonadReader</a> <a id="360" href="Class.MonadTC.html#818" class="Record">TCEnv</a> <a id="366" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="368" class="Symbol">⦄</a> <a id="370" class="Symbol">⦃</a> <a id="372" href="Reflection.Utils.TCI.html#372" class="Bound">_</a> <a id="374" class="Symbol">:</a> <a id="376" href="Class.MonadTC.html#1519" class="Record">MonadTC</a> <a id="384" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="386" class="Symbol">⦄</a> <a id="388" class="Keyword">where</a>

<a id="395" class="Keyword">import</a> <a id="402" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Data.List.html" class="Module">Data.List</a> <a id="433" class="Keyword">using</a> <a id="439" class="Symbol">(</a><a id="440" href="Data.List.Base.html#1634" class="Function">map</a><a id="443" class="Symbol">;</a> <a id="445" href="Data.List.Base.html#2734" class="Function">zipWith</a><a id="452" class="Symbol">)</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="483" class="Keyword">open</a> <a id="488" class="Keyword">import</a> <a id="495" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="522" class="Keyword">using</a> <a id="528" class="Symbol">(</a><a id="529" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌊_⌋</a><a id="532" class="Symbol">)</a>

<a id="535" class="Keyword">open</a> <a id="540" class="Keyword">import</a> <a id="547" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="559" class="Keyword">open</a> <a id="564" class="Keyword">import</a> <a id="571" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="585" class="Keyword">open</a> <a id="590" class="Keyword">import</a> <a id="597" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="616" class="Keyword">instance</a> <a id="625" href="Reflection.Utils.TCI.html#625" class="Function">_</a> <a id="627" class="Symbol">=</a> <a id="629" href="Class.Monad.Core.html#619" class="Function">Functor-M</a>

<a id="fresh-level"></a><a id="640" href="Reflection.Utils.TCI.html#640" class="Function">fresh-level</a> <a id="652" class="Symbol">:</a> <a id="654" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="656" href="Agda.Primitive.html#742" class="Postulate">Level</a>
<a id="662" href="Reflection.Utils.TCI.html#640" class="Function">fresh-level</a> <a id="674" class="Symbol">=</a> <a id="676" href="Class.MonadTC.html#6623" class="Function">newMeta</a> <a id="684" class="Symbol">(</a><a id="685" class="Keyword">quote</a> <a id="691" href="Agda.Primitive.html#742" class="Postulate">Level</a> <a id="697" href="Reflection.Syntax.html#2900" class="InductiveConstructor Operator">∙</a><a id="698" class="Symbol">)</a> <a id="700" href="Class.Monad.Core.html#299" class="Field Operator">&gt;&gt;=</a> <a id="704" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a>

<a id="withHole"></a><a id="715" href="Reflection.Utils.TCI.html#715" class="Function">withHole</a> <a id="724" class="Symbol">:</a> <a id="726" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="731" class="Symbol">→</a> <a id="733" class="Symbol">(</a><a id="734" href="Reflection.Syntax.html#3563" class="Function">Hole</a> <a id="739" class="Symbol">→</a> <a id="741" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="743" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="744" class="Symbol">)</a> <a id="746" class="Symbol">→</a> <a id="748" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="750" href="Reflection.Syntax.html#3563" class="Function">Hole</a>
<a id="755" href="Reflection.Utils.TCI.html#715" class="Function">withHole</a> <a id="764" href="Reflection.Utils.TCI.html#764" class="Bound">ty</a> <a id="767" href="Reflection.Utils.TCI.html#767" class="Bound">k</a> <a id="769" class="Symbol">=</a> <a id="771" class="Keyword">do</a>
  <a id="776" href="Reflection.Utils.TCI.html#776" class="Bound">hole′</a> <a id="782" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="784" href="Class.MonadTC.html#6623" class="Function">newMeta</a> <a id="792" href="Reflection.Utils.TCI.html#764" class="Bound">ty</a>
  <a id="797" href="Reflection.Utils.TCI.html#767" class="Bound">k</a> <a id="799" href="Reflection.Utils.TCI.html#776" class="Bound">hole′</a>
  <a id="807" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="814" href="Reflection.Utils.TCI.html#776" class="Bound">hole′</a>

<a id="apply"></a><a id="821" href="Reflection.Utils.TCI.html#821" class="Function">apply</a> <a id="827" class="Symbol">:</a> <a id="829" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="834" class="Symbol">→</a> <a id="836" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="841" class="Symbol">→</a> <a id="843" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="848" class="Symbol">(</a><a id="849" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="853" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="857" class="Symbol">)</a> <a id="859" class="Symbol">→</a> <a id="861" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="863" class="Symbol">(</a><a id="864" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="869" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="871" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="875" class="Symbol">)</a>
<a id="877" href="Reflection.Utils.TCI.html#821" class="Function">apply</a> <a id="883" href="Reflection.Utils.TCI.html#883" class="Bound">A</a> <a id="885" href="Reflection.Utils.TCI.html#885" class="Bound">t</a> <a id="887" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="896" class="Symbol">=</a> <a id="898" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="905" class="Symbol">(</a><a id="906" href="Reflection.Utils.TCI.html#883" class="Bound">A</a> <a id="908" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="910" href="Reflection.Utils.TCI.html#885" class="Bound">t</a><a id="911" class="Symbol">)</a>
<a id="913" href="Reflection.Utils.TCI.html#821" class="Function">apply</a> <a id="919" href="Reflection.Utils.TCI.html#919" class="Bound">A</a> <a id="921" href="Reflection.Utils.TCI.html#921" class="Bound">t</a> <a id="923" class="Symbol">(</a><a id="924" href="Reflection.Utils.TCI.html#924" class="Bound">a</a> <a id="926" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="928" href="Reflection.Utils.TCI.html#928" class="Bound">as</a><a id="930" class="Symbol">)</a> <a id="932" class="Symbol">=</a> <a id="934" class="Keyword">do</a>
  <a id="939" href="Reflection.Utils.TCI.html#939" class="Bound">A</a> <a id="941" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="943" href="Class.MonadTC.html#1854" class="Field">reduce</a> <a id="950" href="Reflection.Utils.TCI.html#919" class="Bound">A</a>
  <a id="954" href="Reflection.Utils.TCI.html#954" class="Bound">A</a> <a id="956" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="958" href="Reflection.Utils.TCI.html#958" class="Bound">t</a> <a id="960" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="962" href="Reflection.Utils.TCI.html#1002" class="Function">apply₁</a> <a id="969" href="Reflection.Utils.TCI.html#939" class="Bound">A</a> <a id="971" href="Reflection.Utils.TCI.html#921" class="Bound">t</a> <a id="973" href="Reflection.Utils.TCI.html#924" class="Bound">a</a>
  <a id="977" href="Reflection.Utils.TCI.html#821" class="Function">apply</a> <a id="983" href="Reflection.Utils.TCI.html#954" class="Bound">A</a> <a id="985" href="Reflection.Utils.TCI.html#958" class="Bound">t</a> <a id="987" href="Reflection.Utils.TCI.html#928" class="Bound">as</a>
  <a id="992" class="Keyword">where</a>
    <a id="1002" href="Reflection.Utils.TCI.html#1002" class="Function">apply₁</a> <a id="1009" class="Symbol">:</a> <a id="1011" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="1016" class="Symbol">→</a> <a id="1018" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1023" class="Symbol">→</a> <a id="1025" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="1029" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="1038" class="Symbol">(</a><a id="1039" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="1044" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1046" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="1050" class="Symbol">)</a>
    <a id="1056" href="Reflection.Utils.TCI.html#1002" class="Function">apply₁</a> <a id="1063" class="Symbol">(</a><a id="1064" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="1067" class="Symbol">(</a><a id="1068" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="1072" href="Reflection.Utils.TCI.html#1072" class="Bound">i₁</a><a id="1074" class="Symbol">@(</a><a id="1076" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">arg-info</a> <a id="1085" href="Reflection.Utils.TCI.html#1085" class="Bound">k</a> <a id="1087" class="Symbol">_)</a> <a id="1090" href="Reflection.Utils.TCI.html#1090" class="Bound">A</a><a id="1091" class="Symbol">)</a> <a id="1093" href="Reflection.Utils.TCI.html#1093" class="Bound">B</a><a id="1094" class="Symbol">)</a> <a id="1096" href="Reflection.Utils.TCI.html#1096" class="Bound">t₁</a> <a id="1099" class="Symbol">(</a><a id="1100" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="1104" href="Reflection.Utils.TCI.html#1104" class="Bound">i₂</a> <a id="1107" href="Reflection.Utils.TCI.html#1107" class="Bound">t₂</a><a id="1109" class="Symbol">)</a> <a id="1111" class="Symbol">=</a> <a id="1113" class="Keyword">do</a>
      <a id="1122" href="Reflection.Utils.TCI.html#1122" class="Bound">a</a> <a id="1124" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1126" href="Reflection.Utils.TCI.html#640" class="Function">fresh-level</a>
      <a id="1144" href="Reflection.Utils.TCI.html#1144" class="Bound">b</a> <a id="1146" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1148" href="Reflection.Utils.TCI.html#640" class="Function">fresh-level</a>
      <a id="1166" href="Reflection.Utils.TCI.html#1166" class="Bound">A</a> <a id="1168" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1170" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1180" class="Symbol">{</a><a id="1181" class="Argument">A</a> <a id="1183" class="Symbol">=</a> <a id="1185" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1189" href="Reflection.Utils.TCI.html#1122" class="Bound">a</a><a id="1190" class="Symbol">}</a> <a id="1192" href="Reflection.Utils.TCI.html#1090" class="Bound">A</a>
      <a id="1200" href="Reflection.Utils.TCI.html#1200" class="Bound">B</a> <a id="1202" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1204" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1214" class="Symbol">{</a><a id="1215" class="Argument">A</a> <a id="1217" class="Symbol">=</a> <a id="1219" href="Reflection.Utils.TCI.html#1166" class="Bound">A</a> <a id="1221" class="Symbol">→</a> <a id="1223" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1227" href="Reflection.Utils.TCI.html#1144" class="Bound">b</a><a id="1228" class="Symbol">}</a> <a id="1230" class="Symbol">(</a><a id="1231" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">lam</a> <a id="1235" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="1243" href="Reflection.Utils.TCI.html#1093" class="Bound">B</a><a id="1244" class="Symbol">)</a>
      <a id="1252" href="Reflection.Utils.TCI.html#1252" class="Bound">t₂</a> <a id="1255" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1257" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1267" class="Symbol">{</a><a id="1268" class="Argument">A</a> <a id="1270" class="Symbol">=</a> <a id="1272" href="Reflection.Utils.TCI.html#1166" class="Bound">A</a><a id="1273" class="Symbol">}</a> <a id="1275" href="Reflection.Utils.TCI.html#1107" class="Bound">t₂</a>
      <a id="1284" href="Reflection.Utils.TCI.html#1284" class="Bound">Bt₂</a> <a id="1288" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1290" href="Class.MonadTC.html#1891" class="Field">quoteTC</a> <a id="1298" class="Symbol">(</a><a id="1299" href="Reflection.Utils.TCI.html#1200" class="Bound">B</a> <a id="1301" href="Reflection.Utils.TCI.html#1252" class="Bound">t₂</a><a id="1303" class="Symbol">)</a>
      <a id="1311" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="1316" href="Reflection.Utils.TCI.html#1085" class="Bound">k</a> <a id="1318" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="1321" class="Symbol">λ</a> <a id="1323" class="Keyword">where</a>
        <a id="1337" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="1345" class="Symbol">→</a> <a id="1347" class="Keyword">do</a>
          <a id="1360" href="Reflection.Utils.TCI.html#1360" class="Bound">t₁</a> <a id="1363" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1365" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1375" class="Symbol">{</a><a id="1376" class="Argument">A</a> <a id="1378" class="Symbol">=</a> <a id="1380" class="Symbol">∀</a> <a id="1382" class="Symbol">(</a><a id="1383" href="Reflection.Utils.TCI.html#1383" class="Bound">x</a> <a id="1385" class="Symbol">:</a> <a id="1387" href="Reflection.Utils.TCI.html#1166" class="Bound">A</a><a id="1388" class="Symbol">)</a> <a id="1390" class="Symbol">→</a> <a id="1392" href="Reflection.Utils.TCI.html#1200" class="Bound">B</a> <a id="1394" href="Reflection.Utils.TCI.html#1383" class="Bound">x</a><a id="1395" class="Symbol">}</a> <a id="1397" href="Reflection.Utils.TCI.html#1096" class="Bound">t₁</a>
          <a id="1410" href="Reflection.Utils.TCI.html#1284" class="Bound">Bt₂</a> <a id="1414" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a> <a id="1417" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="1421" href="Class.MonadTC.html#1891" class="Field">quoteTC</a> <a id="1429" class="Symbol">(</a><a id="1430" href="Reflection.Utils.TCI.html#1360" class="Bound">t₁</a> <a id="1433" href="Reflection.Utils.TCI.html#1252" class="Bound">t₂</a><a id="1435" class="Symbol">)</a>
        <a id="1445" href="Agda.Builtin.Reflection.html#2770" class="InductiveConstructor">hidden</a> <a id="1452" class="Symbol">→</a> <a id="1454" class="Keyword">do</a>
          <a id="1467" href="Reflection.Utils.TCI.html#1467" class="Bound">t₁</a> <a id="1470" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1472" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1482" class="Symbol">{</a><a id="1483" class="Argument">A</a> <a id="1485" class="Symbol">=</a> <a id="1487" class="Symbol">∀</a> <a id="1489" class="Symbol">{</a><a id="1490" href="Reflection.Utils.TCI.html#1490" class="Bound">x</a> <a id="1492" class="Symbol">:</a> <a id="1494" href="Reflection.Utils.TCI.html#1166" class="Bound">A</a><a id="1495" class="Symbol">}</a> <a id="1497" class="Symbol">→</a> <a id="1499" href="Reflection.Utils.TCI.html#1200" class="Bound">B</a> <a id="1501" href="Reflection.Utils.TCI.html#1490" class="Bound">x</a><a id="1502" class="Symbol">}</a> <a id="1504" href="Reflection.Utils.TCI.html#1096" class="Bound">t₁</a>
          <a id="1517" href="Reflection.Utils.TCI.html#1284" class="Bound">Bt₂</a> <a id="1521" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a> <a id="1524" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="1528" href="Class.MonadTC.html#1891" class="Field">quoteTC</a> <a id="1536" class="Symbol">(</a><a id="1537" href="Reflection.Utils.TCI.html#1467" class="Bound">t₁</a> <a id="1540" class="Symbol">{</a><a id="1541" class="Argument">x</a> <a id="1543" class="Symbol">=</a> <a id="1545" href="Reflection.Utils.TCI.html#1252" class="Bound">t₂</a><a id="1547" class="Symbol">})</a>
        <a id="1558" href="Agda.Builtin.Reflection.html#2777" class="InductiveConstructor">instance′</a> <a id="1568" class="Symbol">→</a> <a id="1570" class="Keyword">do</a>
          <a id="1583" href="Reflection.Utils.TCI.html#1583" class="Bound">t₁</a> <a id="1586" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1588" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1598" class="Symbol">{</a><a id="1599" class="Argument">A</a> <a id="1601" class="Symbol">=</a> <a id="1603" class="Symbol">∀</a> <a id="1605" class="Symbol">⦃</a> <a id="1607" href="Reflection.Utils.TCI.html#1607" class="Bound">x</a> <a id="1609" class="Symbol">:</a> <a id="1611" href="Reflection.Utils.TCI.html#1166" class="Bound">A</a> <a id="1613" class="Symbol">⦄</a> <a id="1615" class="Symbol">→</a> <a id="1617" href="Reflection.Utils.TCI.html#1200" class="Bound">B</a> <a id="1619" href="Reflection.Utils.TCI.html#1607" class="Bound">x</a><a id="1620" class="Symbol">}</a> <a id="1622" href="Reflection.Utils.TCI.html#1096" class="Bound">t₁</a>
          <a id="1635" href="Reflection.Utils.TCI.html#1284" class="Bound">Bt₂</a> <a id="1639" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a> <a id="1642" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="1646" href="Class.MonadTC.html#1891" class="Field">quoteTC</a> <a id="1654" class="Symbol">(</a><a id="1655" href="Reflection.Utils.TCI.html#1583" class="Bound">t₁</a> <a id="1658" class="Symbol">⦃</a> <a id="1660" class="Argument">x</a> <a id="1662" class="Symbol">=</a> <a id="1664" href="Reflection.Utils.TCI.html#1252" class="Bound">t₂</a> <a id="1667" class="Symbol">⦄)</a>
    <a id="1674" href="Reflection.Utils.TCI.html#1002" class="Function">apply₁</a> <a id="1681" class="Symbol">(</a><a id="1682" href="Agda.Builtin.Reflection.html#5544" class="InductiveConstructor">meta</a> <a id="1687" href="Reflection.Utils.TCI.html#1687" class="Bound">x</a> <a id="1689" class="Symbol">_)</a> <a id="1692" class="Symbol">_</a> <a id="1694" class="Symbol">_</a> <a id="1696" class="Symbol">=</a> <a id="1698" href="Class.MonadTC.html#2265" class="Field">blockOnMeta</a> <a id="1710" href="Reflection.Utils.TCI.html#1687" class="Bound">x</a>
    <a id="1716" href="Reflection.Utils.TCI.html#1002" class="CatchallClause Function">apply₁</a><a id="1722" class="CatchallClause"> </a><a id="1723" href="Reflection.Utils.TCI.html#1723" class="CatchallClause Bound">A</a><a id="1724" class="CatchallClause">          </a><a id="1734" class="CatchallClause Symbol">_</a><a id="1735" class="CatchallClause"> </a><a id="1736" class="CatchallClause Symbol">_</a> <a id="1738" class="Symbol">=</a> <a id="1740" href="Class.MonadTC.html#11197" class="Function">error1</a> <a id="1747" class="String">&quot;apply: not a Π-type&quot;</a>

<a id="_-∙-_"></a><a id="1770" href="Reflection.Utils.TCI.html#1770" class="Function Operator">_-∙-_</a> <a id="1776" class="Symbol">:</a> <a id="1778" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1783" class="Symbol">→</a> <a id="1785" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1790" class="Symbol">→</a> <a id="1792" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="1794" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="1799" href="Reflection.Utils.TCI.html#1799" class="Bound">f</a> <a id="1801" href="Reflection.Utils.TCI.html#1770" class="Function Operator">-∙-</a> <a id="1805" href="Reflection.Utils.TCI.html#1805" class="Bound">x</a> <a id="1807" class="Symbol">=</a> <a id="1809" class="Keyword">do</a>
  <a id="1814" href="Reflection.Utils.TCI.html#1814" class="Bound">ty</a> <a id="1817" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1819" href="Class.MonadTC.html#1736" class="Field">inferType</a> <a id="1829" href="Reflection.Utils.TCI.html#1799" class="Bound">f</a>
  <a id="1833" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1839" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="1843" href="Reflection.Utils.TCI.html#821" class="Function">apply</a> <a id="1849" href="Reflection.Utils.TCI.html#1814" class="Bound">ty</a> <a id="1852" href="Reflection.Utils.TCI.html#1799" class="Bound">f</a> <a id="1854" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="1856" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="1861" href="Reflection.Utils.TCI.html#1805" class="Bound">x</a> <a id="1863" href="Data.List.Base.html#5205" class="Function Operator">]</a>

<a id="_-∗-_"></a><a id="1866" href="Reflection.Utils.TCI.html#1866" class="Function Operator">_-∗-_</a> <a id="1872" class="Symbol">:</a> <a id="1874" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1879" class="Symbol">→</a> <a id="1881" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1886" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1891" class="Symbol">→</a> <a id="1893" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="1895" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="1900" href="Reflection.Utils.TCI.html#1900" class="Bound">f</a> <a id="1902" href="Reflection.Utils.TCI.html#1866" class="Function Operator">-∗-</a> <a id="1906" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="1915" class="Symbol">=</a> <a id="1917" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="1924" href="Reflection.Utils.TCI.html#1900" class="Bound">f</a>
<a id="1926" href="Reflection.Utils.TCI.html#1926" class="Bound">f</a> <a id="1928" href="Reflection.Utils.TCI.html#1866" class="Function Operator">-∗-</a> <a id="1932" class="Symbol">(</a><a id="1933" href="Reflection.Utils.TCI.html#1933" class="Bound">x</a> <a id="1935" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1937" href="Reflection.Utils.TCI.html#1937" class="Bound">xs</a><a id="1939" class="Symbol">)</a> <a id="1941" class="Symbol">=</a> <a id="1943" href="Reflection.Utils.TCI.html#1926" class="Bound">f</a> <a id="1945" href="Reflection.Utils.TCI.html#1770" class="Function Operator">-∙-</a> <a id="1949" href="Reflection.Utils.TCI.html#1933" class="Bound">x</a> <a id="1951" href="Class.Monad.Core.html#299" class="Field Operator">&gt;&gt;=</a> <a id="1955" href="Reflection.Utils.TCI.html#1866" class="Function Operator">_-∗-</a> <a id="1960" href="Reflection.Utils.TCI.html#1937" class="Bound">xs</a>

<a id="instantiate"></a><a id="1964" href="Reflection.Utils.TCI.html#1964" class="Function">instantiate</a> <a id="1976" class="Symbol">:</a> <a id="1978" href="Reflection.Syntax.html#3563" class="Function">Hole</a> <a id="1983" class="Symbol">→</a> <a id="1985" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="1987" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="1992" href="Reflection.Utils.TCI.html#1964" class="Function">instantiate</a> <a id="2004" class="Symbol">=</a> <a id="2006" href="Class.MonadTC.html#1854" class="Field">reduce</a> <a id="2013" href="Class.Monad.Core.html#441" class="Function Operator">&gt;=&gt;</a> <a id="2017" href="Class.MonadTC.html#1817" class="Field">normalise</a>

<a id="ensureNoMetas"></a><a id="2028" href="Reflection.Utils.TCI.html#2028" class="Function">ensureNoMetas</a> <a id="2042" class="Symbol">:</a> <a id="2044" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2049" class="Symbol">→</a> <a id="2051" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2053" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="2055" href="Reflection.Utils.TCI.html#2028" class="Function">ensureNoMetas</a> <a id="2069" class="Symbol">=</a> <a id="2071" class="Symbol">λ</a> <a id="2073" class="Keyword">where</a>
  <a id="2081" class="Symbol">(</a><a id="2082" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="2086" href="Reflection.Utils.TCI.html#2086" class="Bound">x</a> <a id="2088" href="Reflection.Utils.TCI.html#2088" class="Bound">args</a><a id="2092" class="Symbol">)</a> <a id="2094" class="Symbol">→</a> <a id="2096" href="Reflection.Utils.TCI.html#2542" class="Function">noMetaArgs</a> <a id="2107" href="Reflection.Utils.TCI.html#2088" class="Bound">args</a>
  <a id="2114" class="Symbol">(</a><a id="2115" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="2119" href="Reflection.Utils.TCI.html#2119" class="Bound">c</a> <a id="2121" href="Reflection.Utils.TCI.html#2121" class="Bound">args</a><a id="2125" class="Symbol">)</a> <a id="2127" class="Symbol">→</a> <a id="2129" href="Reflection.Utils.TCI.html#2542" class="Function">noMetaArgs</a> <a id="2140" href="Reflection.Utils.TCI.html#2121" class="Bound">args</a>
  <a id="2147" class="Symbol">(</a><a id="2148" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="2152" href="Reflection.Utils.TCI.html#2152" class="Bound">f</a> <a id="2154" href="Reflection.Utils.TCI.html#2154" class="Bound">args</a><a id="2158" class="Symbol">)</a> <a id="2160" class="Symbol">→</a> <a id="2162" href="Reflection.Utils.TCI.html#2542" class="Function">noMetaArgs</a> <a id="2173" href="Reflection.Utils.TCI.html#2154" class="Bound">args</a>
  <a id="2180" class="Symbol">(</a><a id="2181" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">lam</a> <a id="2185" href="Reflection.Utils.TCI.html#2185" class="Bound">v</a> <a id="2187" class="Symbol">(</a><a id="2188" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2192" class="Symbol">_</a> <a id="2194" href="Reflection.Utils.TCI.html#2194" class="Bound">t</a><a id="2195" class="Symbol">))</a> <a id="2198" class="Symbol">→</a> <a id="2200" href="Reflection.Utils.TCI.html#2028" class="Function">ensureNoMetas</a> <a id="2214" href="Reflection.Utils.TCI.html#2194" class="Bound">t</a>
  <a id="2218" class="Symbol">(</a><a id="2219" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="2227" href="Reflection.Utils.TCI.html#2227" class="Bound">cs</a> <a id="2230" href="Reflection.Utils.TCI.html#2230" class="Bound">args</a><a id="2234" class="Symbol">)</a> <a id="2236" class="Symbol">→</a> <a id="2238" href="Reflection.Utils.TCI.html#2799" class="Function">noMetaClauses</a> <a id="2252" href="Reflection.Utils.TCI.html#2227" class="Bound">cs</a> <a id="2255" href="Class.Monad.Core.html#333" class="Function Operator">&gt;&gt;</a> <a id="2258" href="Reflection.Utils.TCI.html#2542" class="Function">noMetaArgs</a> <a id="2269" href="Reflection.Utils.TCI.html#2230" class="Bound">args</a>
  <a id="2276" class="Symbol">(</a><a id="2277" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="2280" href="Reflection.Utils.TCI.html#2280" class="Bound">a</a> <a id="2282" href="Reflection.Utils.TCI.html#2282" class="Bound">b</a><a id="2283" class="Symbol">)</a> <a id="2285" class="Symbol">→</a> <a id="2287" href="Reflection.Utils.TCI.html#2468" class="Function">noMetaArg</a> <a id="2297" href="Reflection.Utils.TCI.html#2280" class="Bound">a</a> <a id="2299" href="Class.Monad.Core.html#333" class="Function Operator">&gt;&gt;</a> <a id="2302" href="Reflection.Utils.TCI.html#2934" class="Function">noMetaAbs</a> <a id="2312" href="Reflection.Utils.TCI.html#2282" class="Bound">b</a>
  <a id="2316" class="Symbol">(</a><a id="2317" href="Agda.Builtin.Reflection.html#5477" class="InductiveConstructor">agda-sort</a> <a id="2327" href="Reflection.Utils.TCI.html#2327" class="Bound">s</a><a id="2328" class="Symbol">)</a> <a id="2330" class="Symbol">→</a> <a id="2332" href="Reflection.Utils.TCI.html#3008" class="Function">noMetaSort</a> <a id="2343" href="Reflection.Utils.TCI.html#2327" class="Bound">s</a>
  <a id="2347" class="Symbol">(</a><a id="2348" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="2352" href="Reflection.Utils.TCI.html#2352" class="Bound">l</a><a id="2353" class="Symbol">)</a> <a id="2355" class="Symbol">→</a> <a id="2357" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="2364" class="Symbol">_</a>
  <a id="2368" class="Comment">-- (meta x _) → errorP &quot;meta found!&quot;</a>
  <a id="2407" class="Symbol">(</a><a id="2408" href="Agda.Builtin.Reflection.html#5544" class="InductiveConstructor">meta</a> <a id="2413" href="Reflection.Utils.TCI.html#2413" class="Bound">x</a> <a id="2415" class="Symbol">_)</a> <a id="2418" class="Symbol">→</a> <a id="2420" href="Class.MonadTC.html#2265" class="Field">blockOnMeta</a> <a id="2432" href="Reflection.Utils.TCI.html#2413" class="Bound">x</a>
  <a id="2436" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a> <a id="2444" class="Symbol">→</a> <a id="2446" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="2453" class="Symbol">_</a>
   <a id="2458" class="Keyword">where</a>
    <a id="2468" href="Reflection.Utils.TCI.html#2468" class="Function">noMetaArg</a> <a id="2478" class="Symbol">:</a> <a id="2480" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="2484" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2489" class="Symbol">→</a> <a id="2491" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2493" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2499" href="Reflection.Utils.TCI.html#2468" class="Function">noMetaArg</a> <a id="2509" class="Symbol">(</a><a id="2510" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="2514" class="Symbol">_</a> <a id="2516" href="Reflection.Utils.TCI.html#2516" class="Bound">v</a><a id="2517" class="Symbol">)</a> <a id="2519" class="Symbol">=</a> <a id="2521" href="Reflection.Utils.TCI.html#2028" class="Function">ensureNoMetas</a> <a id="2535" href="Reflection.Utils.TCI.html#2516" class="Bound">v</a>

    <a id="2542" href="Reflection.Utils.TCI.html#2542" class="Function">noMetaArgs</a> <a id="2553" class="Symbol">:</a> <a id="2555" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2560" class="Symbol">(</a><a id="2561" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="2565" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2569" class="Symbol">)</a> <a id="2571" class="Symbol">→</a> <a id="2573" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2575" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2581" href="Reflection.Utils.TCI.html#2542" class="Function">noMetaArgs</a> <a id="2592" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2595" class="Symbol">=</a> <a id="2597" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="2604" class="Symbol">_</a>
    <a id="2610" href="Reflection.Utils.TCI.html#2542" class="Function">noMetaArgs</a> <a id="2621" class="Symbol">(</a><a id="2622" href="Reflection.Utils.TCI.html#2622" class="Bound">v</a> <a id="2624" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2626" href="Reflection.Utils.TCI.html#2626" class="Bound">vs</a><a id="2628" class="Symbol">)</a> <a id="2630" class="Symbol">=</a> <a id="2632" href="Reflection.Utils.TCI.html#2468" class="Function">noMetaArg</a> <a id="2642" href="Reflection.Utils.TCI.html#2622" class="Bound">v</a> <a id="2644" href="Class.Monad.Core.html#333" class="Function Operator">&gt;&gt;</a> <a id="2647" href="Reflection.Utils.TCI.html#2542" class="Function">noMetaArgs</a> <a id="2658" href="Reflection.Utils.TCI.html#2626" class="Bound">vs</a>

    <a id="2666" href="Reflection.Utils.TCI.html#2666" class="Function">noMetaClause</a> <a id="2679" class="Symbol">:</a> <a id="2681" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a> <a id="2688" class="Symbol">→</a> <a id="2690" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2692" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2698" href="Reflection.Utils.TCI.html#2666" class="Function">noMetaClause</a> <a id="2711" class="Symbol">(</a><a id="2712" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="2719" class="Symbol">_</a> <a id="2721" href="Reflection.Utils.TCI.html#2721" class="Bound">ps</a> <a id="2724" href="Reflection.Utils.TCI.html#2724" class="Bound">t</a><a id="2725" class="Symbol">)</a> <a id="2727" class="Symbol">=</a> <a id="2729" href="Reflection.Utils.TCI.html#2028" class="Function">ensureNoMetas</a> <a id="2743" href="Reflection.Utils.TCI.html#2724" class="Bound">t</a>
    <a id="2749" href="Reflection.Utils.TCI.html#2666" class="Function">noMetaClause</a> <a id="2762" class="Symbol">(</a><a id="2763" href="Agda.Builtin.Reflection.html#6188" class="InductiveConstructor">absurd-clause</a> <a id="2777" class="Symbol">_</a> <a id="2779" href="Reflection.Utils.TCI.html#2779" class="Bound">ps</a><a id="2781" class="Symbol">)</a> <a id="2783" class="Symbol">=</a> <a id="2785" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="2792" class="Symbol">_</a>

    <a id="2799" href="Reflection.Utils.TCI.html#2799" class="Function">noMetaClauses</a> <a id="2813" class="Symbol">:</a> <a id="2815" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2820" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a> <a id="2827" class="Symbol">→</a> <a id="2829" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2831" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2837" href="Reflection.Utils.TCI.html#2799" class="Function">noMetaClauses</a> <a id="2851" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2854" class="Symbol">=</a> <a id="2856" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="2863" class="Symbol">_</a>
    <a id="2869" href="Reflection.Utils.TCI.html#2799" class="Function">noMetaClauses</a> <a id="2883" class="Symbol">(</a><a id="2884" href="Reflection.Utils.TCI.html#2884" class="Bound">c</a> <a id="2886" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2888" href="Reflection.Utils.TCI.html#2888" class="Bound">cs</a><a id="2890" class="Symbol">)</a> <a id="2892" class="Symbol">=</a> <a id="2894" href="Reflection.Utils.TCI.html#2666" class="Function">noMetaClause</a> <a id="2907" href="Reflection.Utils.TCI.html#2884" class="Bound">c</a> <a id="2909" href="Class.Monad.Core.html#333" class="Function Operator">&gt;&gt;</a> <a id="2912" href="Reflection.Utils.TCI.html#2799" class="Function">noMetaClauses</a> <a id="2926" href="Reflection.Utils.TCI.html#2888" class="Bound">cs</a>

    <a id="2934" href="Reflection.Utils.TCI.html#2934" class="Function">noMetaAbs</a> <a id="2944" class="Symbol">:</a> <a id="2946" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="2950" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2955" class="Symbol">→</a> <a id="2957" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2959" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2965" href="Reflection.Utils.TCI.html#2934" class="Function">noMetaAbs</a> <a id="2975" class="Symbol">(</a><a id="2976" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2980" class="Symbol">_</a> <a id="2982" href="Reflection.Utils.TCI.html#2982" class="Bound">v</a><a id="2983" class="Symbol">)</a> <a id="2985" class="Symbol">=</a> <a id="2987" href="Reflection.Utils.TCI.html#2028" class="Function">ensureNoMetas</a> <a id="3001" href="Reflection.Utils.TCI.html#2982" class="Bound">v</a>

    <a id="3008" href="Reflection.Utils.TCI.html#3008" class="Function">noMetaSort</a> <a id="3019" class="Symbol">:</a> <a id="3021" href="Agda.Builtin.Reflection.html#5012" class="Datatype">Sort</a> <a id="3026" class="Symbol">→</a> <a id="3028" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="3030" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="3036" href="Reflection.Utils.TCI.html#3008" class="Function">noMetaSort</a> <a id="3047" class="Symbol">(</a><a id="3048" href="Agda.Builtin.Reflection.html#5630" class="InductiveConstructor">set</a> <a id="3052" href="Reflection.Utils.TCI.html#3052" class="Bound">t</a><a id="3053" class="Symbol">)</a> <a id="3055" class="Symbol">=</a> <a id="3057" href="Reflection.Utils.TCI.html#2028" class="Function">ensureNoMetas</a> <a id="3071" href="Reflection.Utils.TCI.html#3052" class="Bound">t</a>
    <a id="3077" href="Reflection.Utils.TCI.html#3008" class="CatchallClause Function">noMetaSort</a><a id="3087" class="CatchallClause"> </a><a id="3088" class="CatchallClause Symbol">_</a>       <a id="3096" class="Symbol">=</a> <a id="3098" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="3105" class="Symbol">_</a>

<a id="3108" class="Keyword">module</a> <a id="NewMeta"></a><a id="3115" href="Reflection.Utils.TCI.html#3115" class="Module">NewMeta</a> <a id="3123" class="Keyword">where</a>
  <a id="NewMeta.unifyStrict"></a><a id="3131" href="Reflection.Utils.TCI.html#3131" class="Function">unifyStrict</a> <a id="3143" class="Symbol">:</a> <a id="3145" href="Reflection.Syntax.html#3583" class="Function">THole</a> <a id="3151" class="Symbol">→</a> <a id="3153" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3158" class="Symbol">→</a> <a id="3160" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="3162" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3166" href="Reflection.Utils.TCI.html#3131" class="Function">unifyStrict</a> <a id="3178" class="Symbol">(</a><a id="3179" href="Reflection.Utils.TCI.html#3179" class="Bound">hole</a> <a id="3184" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3186" href="Reflection.Utils.TCI.html#3186" class="Bound">ty</a><a id="3188" class="Symbol">)</a> <a id="3190" href="Reflection.Utils.TCI.html#3190" class="Bound">x</a> <a id="3192" class="Symbol">=</a> <a id="3194" href="Class.MonadTC.html#8868" class="Function">withAppendDebugPath</a> <a id="3214" class="String">&quot;unifyStrict&quot;</a> <a id="3228" class="Keyword">do</a>
    <a id="3235" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="3244" class="Symbol">(</a><a id="3245" href="Reflection.Utils.TCI.html#3179" class="Bound">hole</a> <a id="3250" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3253" class="String">&quot; :=? &quot;</a> <a id="3261" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3264" href="Reflection.Utils.TCI.html#3190" class="Bound">x</a> <a id="3266" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3269" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3271" class="Symbol">)</a>
    <a id="3277" href="Reflection.Utils.TCI.html#3277" class="Bound">m</a> <a id="3279" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="3281" href="Class.MonadTC.html#6623" class="Function">newMeta</a> <a id="3289" href="Reflection.Utils.TCI.html#3186" class="Bound">ty</a>
    <a id="3296" href="Class.MonadTC.html#9125" class="Function">noConstraints</a> <a id="3310" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3312" href="Class.MonadTC.html#1651" class="Field">unify</a> <a id="3318" href="Reflection.Utils.TCI.html#3277" class="Bound">m</a> <a id="3320" href="Reflection.Utils.TCI.html#3190" class="Bound">x</a> <a id="3322" href="Class.Monad.Core.html#333" class="Function Operator">&gt;&gt;</a> <a id="3325" href="Class.MonadTC.html#1651" class="Field">unify</a> <a id="3331" href="Reflection.Utils.TCI.html#3179" class="Bound">hole</a> <a id="3336" href="Reflection.Utils.TCI.html#3277" class="Bound">m</a>
    <a id="3342" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="3351" class="Symbol">(</a><a id="3352" href="Reflection.Utils.TCI.html#3179" class="Bound">hole</a> <a id="3357" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3360" class="String">&quot; :=  &quot;</a> <a id="3368" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3371" href="Reflection.Utils.TCI.html#3190" class="Bound">x</a> <a id="3373" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3376" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3378" class="Symbol">)</a>

<a id="printTerm"></a><a id="3381" href="Reflection.Utils.TCI.html#3381" class="Function">printTerm</a> <a id="3391" class="Symbol">:</a> <a id="3393" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3400" class="Symbol">→</a> <a id="3402" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3407" class="Symbol">→</a> <a id="3409" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="3411" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="3413" href="Reflection.Utils.TCI.html#3381" class="Function">printTerm</a> <a id="3423" href="Reflection.Utils.TCI.html#3423" class="Bound">s</a> <a id="3425" href="Reflection.Utils.TCI.html#3425" class="Bound">t</a> <a id="3427" class="Symbol">=</a> <a id="3429" class="Keyword">do</a>
  <a id="3434" href="Reflection.Utils.TCI.html#3434" class="Bound">ty</a> <a id="3437" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="3439" href="Class.MonadTC.html#1736" class="Field">inferType</a> <a id="3449" href="Reflection.Utils.TCI.html#3425" class="Bound">t</a>
  <a id="3453" href="Class.MonadTC.html#8199" class="Function">debugLog</a>
    <a id="3466" class="Symbol">(</a> <a id="3468" href="Reflection.Utils.TCI.html#3423" class="Bound">s</a> <a id="3470" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3473" class="String">&quot;: {&quot;</a>
    <a id="3483" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3486" href="Reflection.Utils.TCI.html#3434" class="Bound">ty</a>
    <a id="3493" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3496" class="String">&quot; ∋ &quot;</a>
    <a id="3506" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3509" href="Reflection.Utils.TCI.html#3425" class="Bound">t</a>
    <a id="3515" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3518" class="String">&quot;}\n&quot;</a>
    <a id="3528" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3531" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3533" class="Symbol">)</a>

<a id="3536" class="Keyword">module</a> <a id="NoMeta"></a><a id="3543" href="Reflection.Utils.TCI.html#3543" class="Module">NoMeta</a> <a id="3550" class="Keyword">where</a>
  <a id="NoMeta.unifyStrict"></a><a id="3558" href="Reflection.Utils.TCI.html#3558" class="Function">unifyStrict</a> <a id="3570" class="Symbol">:</a> <a id="3572" href="Reflection.Syntax.html#3583" class="Function">THole</a> <a id="3578" class="Symbol">→</a> <a id="3580" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3585" class="Symbol">→</a> <a id="3587" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="3589" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3593" href="Reflection.Utils.TCI.html#3558" class="Function">unifyStrict</a> <a id="3605" class="Symbol">(</a><a id="3606" href="Reflection.Utils.TCI.html#3606" class="Bound">hole</a> <a id="3611" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3613" href="Reflection.Utils.TCI.html#3613" class="Bound">ty</a><a id="3615" class="Symbol">)</a> <a id="3617" href="Reflection.Utils.TCI.html#3617" class="Bound">x</a> <a id="3619" class="Symbol">=</a> <a id="3621" href="Class.MonadTC.html#8868" class="Function">withAppendDebugPath</a> <a id="3641" class="String">&quot;unifyStrictNoMeta&quot;</a> <a id="3661" class="Keyword">do</a>
    <a id="3668" class="Comment">-- unify hole x</a>
    <a id="3688" class="Comment">-- instantiate hole &gt;&gt;= ensureNoMetas</a>

    <a id="3731" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="3740" class="Symbol">(</a><a id="3741" class="String">&quot;———————————————————————————————————————\nx&quot;</a> <a id="3786" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3789" href="Reflection.Utils.TCI.html#3617" class="Bound">x</a> <a id="3791" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3794" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3796" class="Symbol">)</a>
    <a id="3802" href="Class.MonadTC.html#1651" class="Field">unify</a> <a id="3808" href="Reflection.Utils.TCI.html#3606" class="Bound">hole</a> <a id="3813" href="Reflection.Utils.TCI.html#3617" class="Bound">x</a>
    <a id="3819" href="Reflection.Utils.TCI.html#3819" class="Bound">hole</a> <a id="3824" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="3826" href="Class.MonadTC.html#1817" class="Field">normalise</a> <a id="3836" href="Reflection.Utils.TCI.html#3606" class="Bound">hole</a>
    <a id="3845" href="Reflection.Utils.TCI.html#3381" class="Function">printTerm</a> <a id="3855" class="String">&quot;hole′&quot;</a> <a id="3863" href="Reflection.Utils.TCI.html#3819" class="Bound">hole</a>
    <a id="3872" class="Comment">-- (x ∷ hole ∷ []) ← mapM instantiate (x ∷ hole ∷ [])</a>
    <a id="3930" class="Comment">--   where _ → _IMPOSSIBLE_</a>
    <a id="3962" class="Comment">-- printTerm &quot;x′&quot; x</a>
    <a id="3986" href="Reflection.Utils.TCI.html#2028" class="Function">ensureNoMetas</a> <a id="4000" href="Reflection.Utils.TCI.html#3819" class="Bound">hole</a>
    <a id="4009" href="Class.MonadTC.html#11266" class="Function">debugLog1</a> <a id="4019" class="String">&quot;No metas found :)\n&quot;</a>

<a id="4042" class="Keyword">open</a> <a id="4047" href="Reflection.Utils.TCI.html#3115" class="Module">NewMeta</a> <a id="4055" class="Keyword">public</a>
<a id="4062" class="Comment">-- open NoMeta public</a>

<a id="4085" class="Keyword">import</a> <a id="4092" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="4111" class="Symbol">as</a> <a id="4114" class="Module">NE</a>

<a id="unifyStricts"></a><a id="4118" href="Reflection.Utils.TCI.html#4118" class="Function">unifyStricts</a> <a id="4131" class="Symbol">:</a> <a id="4133" href="Reflection.Syntax.html#3583" class="Function">THole</a> <a id="4139" class="Symbol">→</a> <a id="4141" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4146" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4151" class="Symbol">→</a> <a id="4153" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="4155" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="4157" href="Reflection.Utils.TCI.html#4118" class="Function">unifyStricts</a> <a id="4170" href="Reflection.Utils.TCI.html#4170" class="Bound">ht</a> <a id="4173" class="Symbol">=</a> <a id="4175" href="Data.List.NonEmpty.Base.html#3232" class="Function">NE.foldl₁</a> <a id="4185" class="Symbol">(λ</a> <a id="4188" href="Reflection.Utils.TCI.html#4188" class="Bound">x</a> <a id="4190" href="Reflection.Utils.TCI.html#4190" class="Bound">y</a> <a id="4192" class="Symbol">→</a> <a id="4194" href="Class.MonadError.html#344" class="Field">catch</a> <a id="4200" href="Reflection.Utils.TCI.html#4188" class="Bound">x</a> <a id="4202" class="Symbol">(λ</a> <a id="4205" href="Reflection.Utils.TCI.html#4205" class="Bound">_</a> <a id="4207" class="Symbol">→</a> <a id="4209" href="Reflection.Utils.TCI.html#4190" class="Bound">y</a><a id="4210" class="Symbol">))</a>
                <a id="4229" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4231" class="Symbol">(</a><a id="4232" href="Data.List.NonEmpty.Base.html#5031" class="Function Operator">NE._∷ʳ</a> <a id="4239" href="Class.MonadTC.html#11197" class="Function">error1</a> <a id="4246" class="String">&quot;∅&quot;</a><a id="4249" class="Symbol">)</a>
                <a id="4267" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4269" href="Data.List.Base.html#1634" class="Function">map</a> <a id="4273" class="Symbol">(</a><a id="4274" class="Comment">{-noConstraints ∘ -}</a><a id="4294" href="Reflection.Utils.TCI.html#3131" class="Function">unifyStrict</a> <a id="4306" href="Reflection.Utils.TCI.html#4170" class="Bound">ht</a><a id="4308" class="Symbol">)</a>

<a id="compatible?"></a><a id="4311" href="Reflection.Utils.TCI.html#4311" class="Function">compatible?</a> <a id="4323" class="Symbol">:</a> <a id="4325" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="4330" class="Symbol">→</a> <a id="4332" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="4337" class="Symbol">→</a> <a id="4339" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="4341" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4346" href="Reflection.Utils.TCI.html#4311" class="Function">compatible?</a> <a id="4358" href="Reflection.Utils.TCI.html#4358" class="Bound">ty</a> <a id="4361" href="Reflection.Utils.TCI.html#4361" class="Bound">ty′</a> <a id="4365" class="Symbol">=</a> <a id="4367" class="Keyword">do</a>
  <a id="4372" class="Comment">-- print $ show ty ◇ &quot; ≈? &quot; ◇ show ty′</a>
  <a id="4413" href="Reflection.Utils.TCI.html#4413" class="Bound">b</a> <a id="4415" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="4417" href="Class.MonadTC.html#2420" class="Field">runSpeculative</a> <a id="4432" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4434" class="Symbol">(</a><a id="4435" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,</a> <a id="4438" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="4443" class="Symbol">)</a> <a id="4445" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a>
    <a id="4453" href="Class.MonadError.html#344" class="Field">catch</a> <a id="4459" class="Symbol">(</a><a id="4460" href="Class.MonadTC.html#1651" class="Field">unify</a> <a id="4466" class="Symbol">(</a><a id="4467" href="Reflection.Utils.Substitute.html#3874" class="Function">varsToUnknown</a> <a id="4481" href="Reflection.Utils.TCI.html#4358" class="Bound">ty</a><a id="4483" class="Symbol">)</a> <a id="4485" class="Symbol">(</a><a id="4486" href="Reflection.Utils.Substitute.html#3874" class="Function">varsToUnknown</a> <a id="4500" href="Reflection.Utils.TCI.html#4361" class="Bound">ty′</a><a id="4503" class="Symbol">)</a> <a id="4505" href="Class.Monad.Core.html#333" class="Function Operator">&gt;&gt;</a> <a id="4508" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="4515" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="4519" class="Symbol">)</a>
          <a id="4531" class="Symbol">(λ</a> <a id="4534" href="Reflection.Utils.TCI.html#4534" class="Bound">_</a> <a id="4536" class="Symbol">→</a> <a id="4538" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="4545" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="4550" class="Symbol">)</a>
  <a id="4554" class="Comment">-- print $ &quot;  ——→ &quot; ◇ show b</a>
  <a id="4585" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="4592" href="Reflection.Utils.TCI.html#4413" class="Bound">b</a>

<a id="logTelescope"></a><a id="4595" href="Reflection.Utils.TCI.html#4595" class="Function">logTelescope</a> <a id="4608" class="Symbol">:</a> <a id="4610" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4615" class="Symbol">(</a><a id="4616" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4622" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4629" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4631" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="4635" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="4639" class="Symbol">)</a> <a id="4641" class="Symbol">→</a> <a id="4643" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="4645" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="4647" href="Reflection.Utils.TCI.html#4595" class="Function">logTelescope</a> <a id="4660" href="Reflection.Utils.TCI.html#4660" class="Bound">l</a> <a id="4662" class="Symbol">=</a> <a id="4664" href="Class.MonadTC.html#8868" class="Function">withAppendDebugPath</a> <a id="4684" class="String">&quot;context&quot;</a> <a id="4694" class="Keyword">do</a>
  <a id="4699" href="Class.MonadError.html#344" class="Field">catch</a> <a id="4705" class="Symbol">(</a><a id="4706" href="Reflection.Utils.TCI.html#4793" class="Function">helper</a> <a id="4713" class="Symbol">(</a><a id="4714" href="Data.List.Base.html#5044" class="Function">length</a> <a id="4721" href="Reflection.Utils.TCI.html#4660" class="Bound">l</a><a id="4722" class="Symbol">)</a> <a id="4724" href="Reflection.Utils.TCI.html#4660" class="Bound">l</a><a id="4725" class="Symbol">)</a> <a id="4727" class="Symbol">(λ</a> <a id="4730" href="Reflection.Utils.TCI.html#4730" class="Bound">_</a> <a id="4732" class="Symbol">→</a> <a id="4734" href="Class.MonadTC.html#11266" class="Function">debugLog1</a> <a id="4744" class="String">&quot;Error while printing the context!&quot;</a><a id="4779" class="Symbol">)</a>
  <a id="4783" class="Keyword">where</a>
    <a id="4793" href="Reflection.Utils.TCI.html#4793" class="Function">helper</a> <a id="4800" class="Symbol">:</a> <a id="4802" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4804" class="Symbol">→</a> <a id="4806" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4811" class="Symbol">(</a><a id="4812" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4818" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4825" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4827" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="4831" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="4835" class="Symbol">)</a> <a id="4837" class="Symbol">→</a> <a id="4839" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="4841" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="4847" href="Reflection.Utils.TCI.html#4793" class="Function">helper</a> <a id="4854" href="Reflection.Utils.TCI.html#4854" class="Bound">n</a> <a id="4856" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4859" class="Symbol">=</a> <a id="4861" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="4868" class="Symbol">_</a>
    <a id="4874" href="Reflection.Utils.TCI.html#4793" class="Function">helper</a> <a id="4881" href="Reflection.Utils.TCI.html#4881" class="Bound">n</a> <a id="4883" class="Symbol">((</a><a id="4885" href="Reflection.Utils.TCI.html#4885" class="Bound">x</a> <a id="4887" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4889" href="Reflection.Utils.TCI.html#4889" class="Bound">ty</a><a id="4891" class="Symbol">@(</a><a id="4893" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="4897" class="Symbol">_</a> <a id="4899" href="Reflection.Utils.TCI.html#4899" class="Bound">t</a><a id="4900" class="Symbol">))</a> <a id="4903" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4905" href="Reflection.Utils.TCI.html#4905" class="Bound">l</a><a id="4906" class="Symbol">)</a> <a id="4908" class="Symbol">=</a> <a id="4910" class="Keyword">do</a>
      <a id="4919" class="Keyword">let</a> <a id="4923" href="Reflection.Utils.TCI.html#4923" class="Bound">name</a> <a id="4928" class="Symbol">=</a> <a id="4930" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4935" href="Reflection.Utils.TCI.html#4885" class="Bound">x</a> <a id="4937" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4940" class="Symbol">λ</a> <a id="4942" class="Keyword">where</a>
        <a id="4956" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>   <a id="4966" class="Symbol">→</a> <a id="4968" class="String">&quot;?&quot;</a>
        <a id="4980" class="Symbol">(</a><a id="4981" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4986" class="String">&quot;&quot;</a><a id="4988" class="Symbol">)</a> <a id="4990" class="Symbol">→</a> <a id="4992" class="String">&quot;_&quot;</a>
        <a id="5004" class="Symbol">(</a><a id="5005" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5010" href="Reflection.Utils.TCI.html#5010" class="Bound">x</a><a id="5011" class="Symbol">)</a>  <a id="5014" class="Symbol">→</a> <a id="5016" href="Reflection.Utils.TCI.html#5010" class="Bound">x</a>
      <a id="5024" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="5033" class="Symbol">(</a><a id="5034" class="String">&quot;  &quot;</a> <a id="5039" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5042" href="Reflection.Utils.TCI.html#4923" class="Bound">name</a> <a id="5047" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5050" class="String">&quot; : &quot;</a>  <a id="5057" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5060" href="Reflection.Utils.Substitute.html#3816" class="Function">mapVars</a> <a id="5068" class="Symbol">(</a><a id="5069" href="Data.Nat.Base.html#4462" class="Primitive Operator">_∸</a> <a id="5072" class="Symbol">(</a><a id="5073" href="Reflection.Utils.TCI.html#4881" class="Bound">n</a> <a id="5075" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5077" class="Symbol">(</a><a id="5078" class="Number">1</a> <a id="5080" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="5082" href="Data.List.Base.html#5044" class="Function">length</a> <a id="5089" href="Reflection.Utils.TCI.html#4905" class="Bound">l</a><a id="5090" class="Symbol">)))</a> <a id="5094" href="Reflection.Utils.TCI.html#4899" class="Bound">t</a> <a id="5096" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5099" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5101" class="Symbol">)</a>
      <a id="5109" href="Class.MonadTC.html#10352" class="Function">extendContext</a> <a id="5123" class="Symbol">(</a><a id="5124" href="Reflection.Utils.TCI.html#4923" class="Bound">name</a> <a id="5129" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5131" href="Reflection.Utils.TCI.html#4889" class="Bound">ty</a><a id="5133" class="Symbol">)</a> <a id="5135" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="5137" href="Reflection.Utils.TCI.html#4793" class="Function">helper</a> <a id="5144" href="Reflection.Utils.TCI.html#4881" class="Bound">n</a> <a id="5146" href="Reflection.Utils.TCI.html#4905" class="Bound">l</a>

<a id="logContext"></a><a id="5149" href="Reflection.Utils.TCI.html#5149" class="Function">logContext</a> <a id="5160" class="Symbol">:</a> <a id="5162" href="Reflection.AST.Term.html#2011" class="Function">Telescope</a> <a id="5172" class="Symbol">→</a> <a id="5174" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5176" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="5178" href="Reflection.Utils.TCI.html#5149" class="Function">logContext</a> <a id="5189" href="Reflection.Utils.TCI.html#5189" class="Bound">l</a> <a id="5191" class="Symbol">=</a> <a id="5193" href="Class.MonadTC.html#8868" class="Function">withAppendDebugPath</a> <a id="5213" class="String">&quot;context&quot;</a> <a id="5223" class="Keyword">do</a>
  <a id="5228" href="Class.MonadTC.html#11266" class="Function">debugLog1</a> <a id="5238" class="String">&quot;Context:&quot;</a>
  <a id="5251" href="Class.MonadError.html#344" class="Field">catch</a> <a id="5257" class="Symbol">(</a><a id="5258" href="Reflection.Utils.TCI.html#5581" class="Function">helper</a> <a id="5265" class="Symbol">(</a><a id="5266" href="Data.List.Base.html#5044" class="Function">length</a> <a id="5273" href="Reflection.Utils.TCI.html#5189" class="Bound">l</a><a id="5274" class="Symbol">)</a> <a id="5276" href="Reflection.Utils.TCI.html#5189" class="Bound">l</a><a id="5277" class="Symbol">)</a> <a id="5279" class="Symbol">(λ</a> <a id="5282" href="Reflection.Utils.TCI.html#5282" class="Bound">_</a> <a id="5284" class="Symbol">→</a> <a id="5286" href="Class.MonadTC.html#11266" class="Function">debugLog1</a> <a id="5296" class="String">&quot;Error while printing the context!&quot;</a><a id="5331" class="Symbol">)</a>
  <a id="5335" href="Class.MonadError.html#344" class="Field">catch</a> <a id="5341" class="Symbol">(</a><a id="5342" class="Keyword">do</a>
    <a id="5349" href="Reflection.Utils.TCI.html#5349" class="Bound">goalTy</a> <a id="5356" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="5358" href="Class.MonadTC.html#11576" class="Function">goalTy</a>
    <a id="5369" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="5378" class="Symbol">(</a><a id="5379" class="String">&quot;  ⊢ &quot;</a> <a id="5386" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5389" href="Reflection.Utils.TCI.html#5349" class="Bound">goalTy</a> <a id="5396" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5399" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5401" class="Symbol">))</a>
    <a id="5408" class="Symbol">λ</a> <a id="5410" href="Reflection.Utils.TCI.html#5410" class="Bound">_</a> <a id="5412" class="Symbol">→</a> <a id="5414" class="Keyword">do</a>
      <a id="5423" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="5428" href="Reflection.Utils.TCI.html#5428" class="Bound">t</a> <a id="5430" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="5432" href="Class.MonadReader.html#363" class="Function">reader</a> <a id="5439" href="Class.MonadTC.html#1026" class="Field">TCEnv.goal</a>
        <a id="5458" class="Keyword">where</a> <a id="5464" class="CatchallClause Symbol">_</a> <a id="5466" class="Symbol">→</a> <a id="5468" href="Class.MonadTC.html#11197" class="Function">error1</a> <a id="5475" class="String">&quot;Bug in logContext!&quot;</a>
      <a id="5502" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="5511" class="Symbol">(</a><a id="5512" class="String">&quot;Error while infering the goal type! Goal: &quot;</a> <a id="5557" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5560" href="Reflection.Utils.TCI.html#5428" class="Bound">t</a> <a id="5562" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5565" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5567" class="Symbol">)</a>
  <a id="5571" class="Keyword">where</a>
    <a id="5581" href="Reflection.Utils.TCI.html#5581" class="Function">helper</a> <a id="5588" class="Symbol">:</a> <a id="5590" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5592" class="Symbol">→</a> <a id="5594" href="Reflection.AST.Term.html#2011" class="Function">Telescope</a> <a id="5604" class="Symbol">→</a> <a id="5606" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5608" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="5614" href="Reflection.Utils.TCI.html#5581" class="Function">helper</a> <a id="5621" href="Reflection.Utils.TCI.html#5621" class="Bound">n</a> <a id="5623" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5626" class="Symbol">=</a> <a id="5628" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="5635" class="Symbol">_</a>
    <a id="5641" href="Reflection.Utils.TCI.html#5581" class="Function">helper</a> <a id="5648" href="Reflection.Utils.TCI.html#5648" class="Bound">n</a> <a id="5650" class="Symbol">((_</a> <a id="5654" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5656" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="5660" class="Symbol">_</a> <a id="5662" href="Reflection.Utils.TCI.html#5662" class="Bound">t</a><a id="5663" class="Symbol">)</a> <a id="5665" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5667" href="Reflection.Utils.TCI.html#5667" class="Bound">l</a><a id="5668" class="Symbol">)</a> <a id="5670" class="Symbol">=</a> <a id="5672" class="Keyword">do</a>
      <a id="5681" href="Reflection.Utils.TCI.html#5581" class="Function">helper</a> <a id="5688" href="Reflection.Utils.TCI.html#5648" class="Bound">n</a> <a id="5690" href="Reflection.Utils.TCI.html#5667" class="Bound">l</a>
      <a id="5698" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="5707" class="Symbol">(</a><a id="5708" class="String">&quot;  &quot;</a> <a id="5713" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5716" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="5718" class="Symbol">(</a><a id="5719" href="Reflection.Utils.TCI.html#5648" class="Bound">n</a> <a id="5721" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5723" class="Symbol">(</a><a id="5724" href="Data.List.Base.html#5044" class="Function">length</a> <a id="5731" href="Reflection.Utils.TCI.html#5667" class="Bound">l</a> <a id="5733" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="5735" class="Number">1</a><a id="5736" class="Symbol">))</a> <a id="5739" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5742" class="String">&quot; : &quot;</a> <a id="5748" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5751" href="Reflection.Utils.Substitute.html#3816" class="Function">mapVars</a> <a id="5759" class="Symbol">(</a><a id="5760" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+</a> <a id="5763" class="Symbol">(</a><a id="5764" href="Reflection.Utils.TCI.html#5648" class="Bound">n</a> <a id="5766" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5768" href="Data.List.Base.html#5044" class="Function">length</a> <a id="5775" href="Reflection.Utils.TCI.html#5667" class="Bound">l</a><a id="5776" class="Symbol">))</a> <a id="5779" href="Reflection.Utils.TCI.html#5662" class="Bound">t</a> <a id="5781" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5784" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5786" class="Symbol">)</a>

<a id="logCurrentContext"></a><a id="5789" href="Reflection.Utils.TCI.html#5789" class="Function">logCurrentContext</a> <a id="5807" class="Symbol">:</a> <a id="5809" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5811" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="5813" href="Reflection.Utils.TCI.html#5789" class="Function">logCurrentContext</a> <a id="5831" class="Symbol">=</a> <a id="5833" href="Class.MonadTC.html#11433" class="Function">markDontFail</a> <a id="5846" class="String">&quot;logCurrentContext&quot;</a> <a id="5866" class="Symbol">(</a><a id="5867" href="Reflection.Utils.TCI.html#5149" class="Function">logContext</a> <a id="5878" href="Class.Monad.Core.html#388" class="Function Operator">=&lt;&lt;</a> <a id="5882" href="Class.MonadTC.html#10503" class="Function">getContext</a><a id="5892" class="Symbol">)</a>

<a id="inDebugPath"></a><a id="5895" href="Reflection.Utils.TCI.html#5895" class="Function">inDebugPath</a> <a id="5907" class="Symbol">:</a> <a id="5909" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="5916" class="Symbol">→</a> <a id="5918" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5920" href="Meta.Prelude.html#195" class="Generalizable">A</a> <a id="5922" class="Symbol">→</a> <a id="5924" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5926" href="Meta.Prelude.html#195" class="Generalizable">A</a>
<a id="5928" href="Reflection.Utils.TCI.html#5895" class="Function">inDebugPath</a> <a id="5940" href="Reflection.Utils.TCI.html#5940" class="Bound">path</a> <a id="5945" href="Reflection.Utils.TCI.html#5945" class="Bound">x</a> <a id="5947" class="Symbol">=</a> <a id="5949" href="Class.MonadTC.html#8868" class="Function">withAppendDebugPath</a> <a id="5969" href="Reflection.Utils.TCI.html#5940" class="Bound">path</a> <a id="5974" class="Keyword">do</a>
  <a id="5979" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="5988" class="Symbol">((</a><a id="5990" class="String">&quot;*****&quot;</a> <a id="5998" href="Data.String.Base.html#3151" class="Function Operator">&lt;+&gt;</a> <a id="6002" href="Reflection.Utils.TCI.html#5940" class="Bound">path</a> <a id="6007" href="Data.String.Base.html#3151" class="Function Operator">&lt;+&gt;</a> <a id="6011" class="String">&quot;*****&quot;</a><a id="6018" class="Symbol">)</a> <a id="6020" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="6023" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6025" class="Symbol">)</a>
  <a id="6029" class="Comment">-- This throws an internal error if the macro is run in a type signature</a>
  <a id="6104" class="Comment">-- (Agda issue #7187)</a>
  <a id="6128" class="Comment">-- logCurrentContext</a>
  <a id="6151" href="Reflection.Utils.TCI.html#5945" class="Bound">x</a>

<a id="viewAndReduceTy"></a><a id="6154" href="Reflection.Utils.TCI.html#6154" class="Function">viewAndReduceTy</a> <a id="6170" class="Symbol">:</a> <a id="6172" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="6177" class="Symbol">→</a> <a id="6179" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6181" href="Reflection.Utils.Core.html#536" class="Function">TypeView</a>
<a id="6190" href="Reflection.Utils.TCI.html#6154" class="Function">viewAndReduceTy</a> <a id="6206" href="Reflection.Utils.TCI.html#6206" class="Bound">ty</a> <a id="6209" class="Symbol">=</a> <a id="6211" href="Reflection.Utils.TCI.html#6280" class="Function">helper</a> <a id="6218" href="Reflection.Utils.TCI.html#6206" class="Bound">ty</a> <a id="6221" href="Class.Monad.Core.html#388" class="Function Operator">=&lt;&lt;</a> <a id="6225" class="Symbol">(</a><a id="6226" href="Data.List.Base.html#5044" class="Function">length</a> <a id="6233" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="6235" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="6241" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="6243" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a><a id="6249" class="Symbol">)</a> <a id="6251" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="6255" href="Class.MonadTC.html#1817" class="Field">normalise</a> <a id="6265" href="Reflection.Utils.TCI.html#6206" class="Bound">ty</a>
  <a id="6270" class="Keyword">where</a>
    <a id="6280" href="Reflection.Utils.TCI.html#6280" class="Function">helper</a> <a id="6287" class="Symbol">:</a> <a id="6289" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="6294" class="Symbol">→</a> <a id="6296" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6298" class="Symbol">→</a> <a id="6300" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6302" href="Reflection.Utils.Core.html#536" class="Function">TypeView</a>
    <a id="6315" href="Reflection.Utils.TCI.html#6280" class="Function">helper</a> <a id="6322" href="Reflection.Utils.TCI.html#6322" class="Bound">ty</a>    <a id="6328" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="6333" class="Symbol">=</a> <a id="6335" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="6342" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6344" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="6351" href="Reflection.Utils.TCI.html#6322" class="Bound">ty</a>
    <a id="6358" href="Reflection.Utils.TCI.html#6280" class="Function">helper</a> <a id="6365" href="Reflection.Utils.TCI.html#6365" class="Bound">ty</a> <a id="6368" class="Symbol">(</a><a id="6369" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6373" href="Reflection.Utils.TCI.html#6373" class="Bound">k</a><a id="6374" class="Symbol">)</a> <a id="6376" class="Keyword">with</a> <a id="6381" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="6388" href="Reflection.Utils.TCI.html#6365" class="Bound">ty</a>
    <a id="6395" class="Symbol">...</a> <a id="6399" class="Symbol">|</a> <a id="6401" class="Symbol">(</a><a id="6402" href="Reflection.Utils.TCI.html#6402" class="Bound">tel</a> <a id="6406" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6408" href="Reflection.Utils.TCI.html#6408" class="Bound">ty&#39;</a><a id="6411" class="Symbol">)</a> <a id="6413" class="Symbol">=</a> <a id="6415" href="Class.MonadTC.html#10879" class="Function">extendContext&#39;</a> <a id="6430" class="Symbol">(</a><a id="6431" href="Data.List.Base.html#1634" class="Function">map</a> <a id="6435" class="Symbol">(λ</a> <a id="6438" class="Keyword">where</a> <a id="6444" class="Symbol">(</a><a id="6445" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="6449" href="Reflection.Utils.TCI.html#6449" class="Bound">s</a> <a id="6451" href="Reflection.Utils.TCI.html#6451" class="Bound">t</a><a id="6452" class="Symbol">)</a> <a id="6454" class="Symbol">→</a> <a id="6456" href="Reflection.Utils.TCI.html#6449" class="Bound">s</a> <a id="6458" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6460" href="Reflection.Utils.TCI.html#6451" class="Bound">t</a><a id="6461" class="Symbol">)</a> <a id="6463" href="Reflection.Utils.TCI.html#6402" class="Bound">tel</a><a id="6466" class="Symbol">)</a> <a id="6468" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="6470" class="Keyword">do</a>
      <a id="6479" href="Reflection.Utils.TCI.html#6479" class="Bound">rTy</a> <a id="6483" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="6485" href="Class.MonadTC.html#1854" class="Field">reduce</a> <a id="6492" href="Reflection.Utils.TCI.html#6408" class="Bound">ty&#39;</a>
      <a id="6502" class="Symbol">(</a><a id="6503" href="Reflection.Utils.TCI.html#6503" class="Bound">tel&#39;</a> <a id="6508" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6510" href="Reflection.Utils.TCI.html#6510" class="Bound">rTy&#39;</a><a id="6514" class="Symbol">)</a> <a id="6516" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="6518" href="Reflection.Utils.TCI.html#6280" class="Function">helper</a> <a id="6525" href="Reflection.Utils.TCI.html#6479" class="Bound">rTy</a> <a id="6529" class="Bound">k</a>
      <a id="6537" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="6544" class="Symbol">(</a><a id="6545" href="Reflection.Utils.TCI.html#6402" class="Bound">tel</a> <a id="6549" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="6552" href="Reflection.Utils.TCI.html#6503" class="Bound">tel&#39;</a> <a id="6557" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6559" href="Reflection.Utils.TCI.html#6510" class="Bound">rTy&#39;</a><a id="6563" class="Symbol">)</a>

<a id="getType&#39;"></a><a id="6566" href="Reflection.Utils.TCI.html#6566" class="Function">getType&#39;</a> <a id="6575" class="Symbol">:</a> <a id="6577" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6582" class="Symbol">→</a> <a id="6584" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6586" href="Reflection.Utils.Core.html#536" class="Function">TypeView</a>
<a id="6595" href="Reflection.Utils.TCI.html#6566" class="Function">getType&#39;</a> <a id="6604" href="Reflection.Utils.TCI.html#6604" class="Bound">n</a> <a id="6606" class="Symbol">=</a> <a id="6608" href="Reflection.Utils.TCI.html#6154" class="Function">viewAndReduceTy</a> <a id="6624" href="Class.Monad.Core.html#388" class="Function Operator">=&lt;&lt;</a> <a id="6628" href="Class.MonadTC.html#2185" class="Field">getType</a> <a id="6636" href="Reflection.Utils.TCI.html#6604" class="Bound">n</a>

<a id="getTypeDB"></a><a id="6639" href="Reflection.Utils.TCI.html#6639" class="Function">getTypeDB</a> <a id="6649" class="Symbol">:</a> <a id="6651" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6653" class="Symbol">→</a> <a id="6655" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6657" href="Reflection.Utils.Core.html#536" class="Function">TypeView</a>
<a id="6666" href="Reflection.Utils.TCI.html#6639" class="Function">getTypeDB</a> <a id="6676" href="Reflection.Utils.TCI.html#6676" class="Bound">n</a> <a id="6678" class="Symbol">=</a> <a id="6680" href="Reflection.Utils.TCI.html#6154" class="Function">viewAndReduceTy</a> <a id="6696" href="Class.Monad.Core.html#388" class="Function Operator">=&lt;&lt;</a> <a id="6700" href="Class.MonadTC.html#1736" class="Field">inferType</a> <a id="6710" class="Symbol">(</a><a id="6711" href="Reflection.Syntax.html#1453" class="InductiveConstructor">♯</a> <a id="6713" href="Reflection.Utils.TCI.html#6676" class="Bound">n</a><a id="6714" class="Symbol">)</a>

<a id="getDataDef"></a><a id="6717" href="Reflection.Utils.TCI.html#6717" class="Function">getDataDef</a> <a id="6728" class="Symbol">:</a> <a id="6730" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6735" class="Symbol">→</a> <a id="6737" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6739" href="Reflection.Utils.Core.html#1201" class="Record">DataDef</a>
<a id="6747" href="Reflection.Utils.TCI.html#6717" class="Function">getDataDef</a> <a id="6758" href="Reflection.Utils.TCI.html#6758" class="Bound">n</a> <a id="6760" class="Symbol">=</a> <a id="6762" href="Reflection.Utils.TCI.html#5895" class="Function">inDebugPath</a> <a id="6774" class="String">&quot;getDataDef&quot;</a> <a id="6787" class="Keyword">do</a>
  <a id="6792" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="6801" class="Symbol">(</a><a id="6802" class="String">&quot;Find details for datatype: &quot;</a> <a id="6832" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="6835" href="Reflection.Utils.TCI.html#6758" class="Bound">n</a> <a id="6837" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="6840" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6842" class="Symbol">)</a>
  <a id="6846" class="Symbol">(</a><a id="6847" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="6857" href="Reflection.Utils.TCI.html#6857" class="Bound">pars</a> <a id="6862" href="Reflection.Utils.TCI.html#6862" class="Bound">cs</a><a id="6864" class="Symbol">)</a> <a id="6866" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="6868" href="Class.MonadTC.html#2222" class="Field">getDefinition</a> <a id="6882" href="Reflection.Utils.TCI.html#6758" class="Bound">n</a>
    <a id="6888" class="Keyword">where</a> <a id="6894" class="CatchallClause Symbol">_</a> <a id="6896" class="Symbol">→</a> <a id="6898" href="Class.MonadTC.html#11197" class="Function">error1</a> <a id="6905" class="String">&quot;Not a data definition!&quot;</a>
  <a id="6932" href="Class.MonadTC.html#8509" class="Function">debugLogᵐ</a> <a id="6942" class="Symbol">(</a><a id="6943" class="String">&quot;Constructor names: &quot;</a> <a id="6965" href="Class.MonadTC.html#7757" class="Function Operator">∷ᵈᵐ</a> <a id="6969" href="Reflection.Utils.TCI.html#6862" class="Bound">cs</a> <a id="6972" href="Class.MonadTC.html#7899" class="Function Operator">ᵛ</a> <a id="6974" href="Class.MonadTC.html#7757" class="Function Operator">∷ᵈᵐ</a> <a id="6978" href="Class.MonadTC.html#7694" class="Function">[]ᵐ</a><a id="6981" class="Symbol">)</a>
  <a id="6985" href="Reflection.Utils.TCI.html#6985" class="Bound">cs&#39;</a> <a id="6989" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="6991" href="Class.Traversable.Core.html#297" class="Function">traverse</a> <a id="7000" class="Symbol">⦃</a> <a id="7002" href="Class.Functor.Instances.html#445" class="Function">Functor-List</a> <a id="7015" class="Symbol">⦄</a> <a id="7017" class="Symbol">(λ</a> <a id="7020" href="Reflection.Utils.TCI.html#7020" class="Bound">n</a> <a id="7022" class="Symbol">→</a> <a id="7024" class="Symbol">(</a><a id="7025" href="Reflection.Utils.TCI.html#7020" class="Bound">n</a> <a id="7027" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="7029" class="Symbol">)</a> <a id="7031" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7035" href="Reflection.Utils.TCI.html#6566" class="Function">getType&#39;</a> <a id="7044" href="Reflection.Utils.TCI.html#7020" class="Bound">n</a><a id="7045" class="Symbol">)</a> <a id="7047" href="Reflection.Utils.TCI.html#6862" class="Bound">cs</a>
  <a id="7052" href="Class.MonadTC.html#8509" class="Function">debugLogᵐ</a> <a id="7062" class="Symbol">(</a><a id="7063" class="String">&quot;Result: &quot;</a> <a id="7074" href="Class.MonadTC.html#7757" class="Function Operator">∷ᵈᵐ</a> <a id="7078" href="Reflection.Utils.TCI.html#6985" class="Bound">cs&#39;</a> <a id="7082" href="Class.MonadTC.html#7974" class="Function Operator">ᵛⁿ</a> <a id="7085" href="Class.MonadTC.html#7757" class="Function Operator">∷ᵈᵐ</a> <a id="7089" href="Class.MonadTC.html#7694" class="Function">[]ᵐ</a><a id="7092" class="Symbol">)</a>
  <a id="7096" href="Reflection.Utils.TCI.html#7096" class="Bound">args</a> <a id="7101" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="7103" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7109" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7113" href="Reflection.Utils.TCI.html#6566" class="Function">getType&#39;</a> <a id="7122" href="Reflection.Utils.TCI.html#6758" class="Bound">n</a>
  <a id="7126" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="7133" class="Keyword">record</a> <a id="7140" class="Symbol">{</a> <a id="7142" href="Reflection.Utils.Core.html#1233" class="Field">name</a> <a id="7147" class="Symbol">=</a> <a id="7149" href="Reflection.Utils.TCI.html#6758" class="Bound">n</a> <a id="7151" class="Symbol">;</a> <a id="7153" href="Reflection.Utils.Core.html#1249" class="Field">constructors</a> <a id="7166" class="Symbol">=</a> <a id="7168" href="Reflection.Utils.TCI.html#6985" class="Bound">cs&#39;</a> <a id="7172" class="Symbol">;</a> <a id="7174" href="Reflection.Utils.Core.html#1291" class="Field">params</a> <a id="7181" class="Symbol">=</a> <a id="7183" href="Data.List.Base.html#8687" class="Function">take</a> <a id="7188" href="Reflection.Utils.TCI.html#6857" class="Bound">pars</a> <a id="7193" href="Reflection.Utils.TCI.html#7096" class="Bound">args</a> <a id="7198" class="Symbol">;</a> <a id="7200" href="Reflection.Utils.Core.html#1326" class="Field">indices</a> <a id="7208" class="Symbol">=</a> <a id="7210" href="Data.List.Base.html#8807" class="Function">drop</a> <a id="7215" href="Reflection.Utils.TCI.html#6857" class="Bound">pars</a> <a id="7220" href="Reflection.Utils.TCI.html#7096" class="Bound">args</a> <a id="7225" class="Symbol">}</a>

<a id="getRecordDef"></a><a id="7228" href="Reflection.Utils.TCI.html#7228" class="Function">getRecordDef</a> <a id="7241" class="Symbol">:</a> <a id="7243" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7248" class="Symbol">→</a> <a id="7250" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7252" href="Reflection.Utils.Core.html#1366" class="Record">RecordDef</a>
<a id="7262" href="Reflection.Utils.TCI.html#7228" class="Function">getRecordDef</a> <a id="7275" href="Reflection.Utils.TCI.html#7275" class="Bound">n</a> <a id="7277" class="Symbol">=</a> <a id="7279" class="Keyword">do</a>
  <a id="7284" class="Symbol">(</a><a id="7285" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record-type</a> <a id="7297" href="Reflection.Utils.TCI.html#7297" class="Bound">c</a> <a id="7299" href="Reflection.Utils.TCI.html#7299" class="Bound">fs</a><a id="7301" class="Symbol">)</a> <a id="7303" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="7305" href="Class.MonadTC.html#2222" class="Field">getDefinition</a> <a id="7319" href="Reflection.Utils.TCI.html#7275" class="Bound">n</a>
    <a id="7325" class="Keyword">where</a> <a id="7331" class="CatchallClause Symbol">_</a> <a id="7333" class="Symbol">→</a> <a id="7335" href="Class.MonadTC.html#11197" class="Function">error1</a> <a id="7342" class="String">&quot;Not a record definition!&quot;</a>
  <a id="7371" href="Reflection.Utils.TCI.html#7371" class="Bound">args</a> <a id="7376" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="7378" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7384" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7388" href="Reflection.Utils.TCI.html#6566" class="Function">getType&#39;</a> <a id="7397" href="Reflection.Utils.TCI.html#7275" class="Bound">n</a>
  <a id="7401" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="7408" class="Symbol">(</a><a id="7409" class="Keyword">record</a> <a id="7416" class="Symbol">{</a> <a id="7418" href="Reflection.Utils.Core.html#1400" class="Field">name</a> <a id="7423" class="Symbol">=</a> <a id="7425" href="Reflection.Utils.TCI.html#7297" class="Bound">c</a> <a id="7427" class="Symbol">;</a> <a id="7429" href="Reflection.Utils.Core.html#1416" class="Field">fields</a> <a id="7436" class="Symbol">=</a> <a id="7438" href="Reflection.Utils.TCI.html#7299" class="Bound">fs</a> <a id="7441" class="Symbol">;</a> <a id="7443" href="Reflection.Utils.Core.html#1445" class="Field">params</a> <a id="7450" class="Symbol">=</a> <a id="7452" href="Reflection.Utils.TCI.html#7371" class="Bound">args</a> <a id="7457" class="Symbol">})</a>

<a id="getDataOrRecordDef"></a><a id="7461" href="Reflection.Utils.TCI.html#7461" class="Function">getDataOrRecordDef</a> <a id="7480" class="Symbol">:</a> <a id="7482" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7487" class="Symbol">→</a> <a id="7489" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7491" class="Symbol">(</a><a id="7492" href="Reflection.Utils.Core.html#1201" class="Record">DataDef</a> <a id="7500" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="7502" href="Reflection.Utils.Core.html#1366" class="Record">RecordDef</a><a id="7511" class="Symbol">)</a>
<a id="7513" href="Reflection.Utils.TCI.html#7461" class="Function">getDataOrRecordDef</a> <a id="7532" href="Reflection.Utils.TCI.html#7532" class="Bound">n</a> <a id="7534" class="Symbol">=</a>
  <a id="7538" href="Class.MonadError.html#344" class="Field">catch</a> <a id="7544" class="Symbol">(</a><a id="7545" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="7550" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7554" href="Reflection.Utils.TCI.html#6717" class="Function">getDataDef</a> <a id="7565" href="Reflection.Utils.TCI.html#7532" class="Bound">n</a><a id="7566" class="Symbol">)</a>
    <a id="7572" class="Symbol">λ</a> <a id="7574" href="Reflection.Utils.TCI.html#7574" class="Bound">_</a> <a id="7576" class="Symbol">→</a> <a id="7578" href="Class.MonadError.html#344" class="Field">catch</a> <a id="7584" class="Symbol">(</a><a id="7585" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="7590" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7594" href="Reflection.Utils.TCI.html#7228" class="Function">getRecordDef</a> <a id="7607" href="Reflection.Utils.TCI.html#7532" class="Bound">n</a><a id="7608" class="Symbol">)</a>
    <a id="7614" class="Symbol">λ</a> <a id="7616" href="Reflection.Utils.TCI.html#7616" class="Bound">_</a> <a id="7618" class="Symbol">→</a> <a id="7620" href="Class.MonadTC.html#11197" class="Function">error1</a> <a id="7627" class="String">&quot;Neither a data not a record definition!&quot;</a>

<a id="getParams"></a><a id="7670" href="Reflection.Utils.TCI.html#7670" class="Function">getParams</a> <a id="7680" class="Symbol">:</a> <a id="7682" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7687" class="Symbol">→</a> <a id="7689" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7691" class="Symbol">(</a><a id="7692" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7697" class="Symbol">(</a><a id="7698" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="7702" class="Symbol">(</a><a id="7703" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="7707" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="7711" class="Symbol">)))</a>
<a id="7715" href="Reflection.Utils.TCI.html#7670" class="Function">getParams</a> <a id="7725" href="Reflection.Utils.TCI.html#7725" class="Bound">n</a> <a id="7727" class="Symbol">=</a> <a id="7729" href="Data.Sum.Base.html#811" class="Function Operator">Data.Sum.[</a> <a id="7740" href="Reflection.Utils.Core.html#1291" class="Field">DataDef.params</a> <a id="7755" href="Data.Sum.Base.html#811" class="Function Operator">,</a> <a id="7757" href="Reflection.Utils.Core.html#1445" class="Field">RecordDef.params</a> <a id="7774" href="Data.Sum.Base.html#811" class="Function Operator">]</a> <a id="7776" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7780" href="Reflection.Utils.TCI.html#7461" class="Function">getDataOrRecordDef</a> <a id="7799" href="Reflection.Utils.TCI.html#7725" class="Bound">n</a>

<a id="getParamsAndIndices"></a><a id="7802" href="Reflection.Utils.TCI.html#7802" class="Function">getParamsAndIndices</a> <a id="7822" class="Symbol">:</a> <a id="7824" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7829" class="Symbol">→</a> <a id="7831" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7833" class="Symbol">(</a><a id="7834" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7839" class="Symbol">(</a><a id="7840" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="7844" class="Symbol">(</a><a id="7845" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="7849" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="7853" class="Symbol">)))</a>
<a id="7857" href="Reflection.Utils.TCI.html#7802" class="Function">getParamsAndIndices</a> <a id="7877" href="Reflection.Utils.TCI.html#7877" class="Bound">n</a> <a id="7879" class="Symbol">=</a>
  <a id="7883" href="Data.Sum.Base.html#811" class="Function Operator">Data.Sum.[</a> <a id="7894" class="Symbol">(λ</a> <a id="7897" href="Reflection.Utils.TCI.html#7897" class="Bound">d</a> <a id="7899" class="Symbol">→</a> <a id="7901" href="Reflection.Utils.Core.html#1291" class="Field">DataDef.params</a> <a id="7916" href="Reflection.Utils.TCI.html#7897" class="Bound">d</a> <a id="7918" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="7921" href="Reflection.Utils.Core.html#1326" class="Field">DataDef.indices</a> <a id="7937" href="Reflection.Utils.TCI.html#7897" class="Bound">d</a><a id="7938" class="Symbol">)</a> <a id="7940" href="Data.Sum.Base.html#811" class="Function Operator">,</a> <a id="7942" href="Reflection.Utils.Core.html#1445" class="Field">RecordDef.params</a> <a id="7959" href="Data.Sum.Base.html#811" class="Function Operator">]</a> <a id="7961" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7965" href="Reflection.Utils.TCI.html#7461" class="Function">getDataOrRecordDef</a> <a id="7984" href="Reflection.Utils.TCI.html#7877" class="Bound">n</a>

<a id="getFuel"></a><a id="7987" href="Reflection.Utils.TCI.html#7987" class="Function">getFuel</a> <a id="7995" class="Symbol">:</a> <a id="7997" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="8004" class="Symbol">→</a> <a id="8006" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8008" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="8010" href="Reflection.Utils.TCI.html#7987" class="Function">getFuel</a> <a id="8018" href="Reflection.Utils.TCI.html#8018" class="Bound">s</a> <a id="8020" class="Symbol">=</a> <a id="8022" class="Keyword">do</a>
  <a id="8027" href="Reflection.Utils.TCI.html#8027" class="Bound">fuels</a> <a id="8033" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="8035" href="Class.MonadReader.html#363" class="Function">reader</a> <a id="8042" class="Symbol">(λ</a> <a id="8045" class="Keyword">where</a> <a id="8051" class="Keyword">record</a> <a id="8058" class="Symbol">{</a> <a id="8060" href="Class.MonadTC.html#1059" class="Field">options</a> <a id="8068" class="Symbol">=</a> <a id="8070" class="Keyword">record</a> <a id="8077" class="Symbol">{</a> <a id="8079" href="Class.MonadTC.html#679" class="Field">fuel</a> <a id="8084" class="Symbol">=</a> <a id="8086" href="Reflection.Utils.TCI.html#8086" class="Bound">f</a> <a id="8088" class="Symbol">}</a> <a id="8090" class="Symbol">}</a> <a id="8092" class="Symbol">→</a> <a id="8094" href="Reflection.Utils.TCI.html#8086" class="Bound">f</a> <a id="8096" class="Symbol">)</a>
  <a id="8100" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="8105" href="Meta.Prelude.html#1078" class="Function">lookupᵇ</a> <a id="8113" class="Symbol">(λ</a> <a id="8116" href="Reflection.Utils.TCI.html#8116" class="Bound">s</a> <a id="8118" href="Reflection.Utils.TCI.html#8118" class="Bound">s&#39;</a> <a id="8121" class="Symbol">→</a> <a id="8123" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌊</a> <a id="8125" href="Reflection.Utils.TCI.html#8116" class="Bound">s</a> <a id="8127" href="Class.DecEq.Core.html#159" class="Field Operator">≟</a> <a id="8129" href="Reflection.Utils.TCI.html#8118" class="Bound">s&#39;</a> <a id="8132" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌋</a><a id="8133" class="Symbol">)</a> <a id="8135" href="Reflection.Utils.TCI.html#8027" class="Bound">fuels</a> <a id="8141" href="Reflection.Utils.TCI.html#8018" class="Bound">s</a> <a id="8143" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="8146" class="Symbol">λ</a> <a id="8148" class="Keyword">where</a>
    <a id="8158" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>  <a id="8167" class="Symbol">→</a> <a id="8169" href="Class.MonadTC.html#11197" class="Function">error1</a> <a id="8176" class="Symbol">(</a><a id="8177" class="String">&quot;Key&quot;</a> <a id="8183" href="Data.String.Base.html#3151" class="Function Operator">&lt;+&gt;</a> <a id="8187" href="Reflection.Utils.TCI.html#8018" class="Bound">s</a> <a id="8189" href="Data.String.Base.html#3151" class="Function Operator">&lt;+&gt;</a> <a id="8193" class="String">&quot;doesn&#39;t exist in the fuels map&quot;</a><a id="8225" class="Symbol">)</a>
    <a id="8231" class="Symbol">(</a><a id="8232" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8237" href="Reflection.Utils.TCI.html#8237" class="Bound">f</a><a id="8238" class="Symbol">)</a> <a id="8240" class="Symbol">→</a> <a id="8242" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="8249" href="Reflection.Utils.TCI.html#8237" class="Bound">f</a>

<a id="isSort"></a><a id="8252" href="Reflection.Utils.TCI.html#8252" class="Function">isSort</a> <a id="8259" class="Symbol">:</a> <a id="8261" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8266" class="Symbol">→</a> <a id="8268" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8270" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="8275" href="Reflection.Utils.TCI.html#8252" class="Function">isSort</a> <a id="8282" href="Reflection.Utils.TCI.html#8282" class="Bound">t</a> <a id="8284" class="Symbol">=</a> <a id="8286" class="Keyword">do</a>
  <a id="8291" class="Symbol">(</a><a id="8292" href="Agda.Builtin.Reflection.html#5477" class="InductiveConstructor">agda-sort</a> <a id="8302" class="Symbol">_)</a> <a id="8305" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="8307" href="Class.MonadTC.html#1817" class="Field">normalise</a> <a id="8317" href="Reflection.Utils.TCI.html#8282" class="Bound">t</a>
    <a id="8323" class="Keyword">where</a> <a id="8329" class="CatchallClause Symbol">_</a> <a id="8331" class="Symbol">→</a> <a id="8333" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="8340" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
  <a id="8348" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="8355" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>

<a id="isNArySort"></a><a id="8361" href="Reflection.Utils.TCI.html#8361" class="Function">isNArySort</a> <a id="8372" class="Symbol">:</a> <a id="8374" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8379" class="Symbol">→</a> <a id="8381" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8383" class="Symbol">(</a><a id="8384" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="8389" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="8391" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="8392" class="Symbol">)</a>
<a id="8394" href="Reflection.Utils.TCI.html#8361" class="Function">isNArySort</a> <a id="8405" href="Reflection.Utils.TCI.html#8405" class="Bound">t</a> <a id="8407" class="Symbol">=</a> <a id="8409" class="Keyword">do</a>
  <a id="8414" class="Symbol">(</a><a id="8415" href="Reflection.Utils.TCI.html#8415" class="Bound">tel</a> <a id="8419" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8421" href="Reflection.Utils.TCI.html#8421" class="Bound">ty</a><a id="8423" class="Symbol">)</a> <a id="8425" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="8427" href="Reflection.Utils.TCI.html#6154" class="Function">viewAndReduceTy</a> <a id="8443" href="Reflection.Utils.TCI.html#8405" class="Bound">t</a>
  <a id="8447" href="Reflection.Utils.TCI.html#8447" class="Bound">b</a> <a id="8449" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="8451" href="Reflection.Utils.TCI.html#8252" class="Function">isSort</a> <a id="8458" href="Reflection.Utils.TCI.html#8421" class="Bound">ty</a>
  <a id="8463" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="8470" class="Symbol">(</a><a id="8471" href="Reflection.Utils.TCI.html#8447" class="Bound">b</a> <a id="8473" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8475" href="Data.List.Base.html#5044" class="Function">length</a> <a id="8482" href="Reflection.Utils.TCI.html#8415" class="Bound">tel</a><a id="8485" class="Symbol">)</a>

<a id="isDefT"></a><a id="8488" href="Reflection.Utils.TCI.html#8488" class="Function">isDefT</a> <a id="8495" class="Symbol">:</a> <a id="8497" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8502" class="Symbol">→</a> <a id="8504" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8509" class="Symbol">→</a> <a id="8511" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8513" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="8518" href="Reflection.Utils.TCI.html#8488" class="Function">isDefT</a> <a id="8525" href="Reflection.Utils.TCI.html#8525" class="Bound">n</a> <a id="8527" href="Reflection.Utils.TCI.html#8527" class="Bound">t</a> <a id="8529" class="Symbol">=</a> <a id="8531" class="Keyword">do</a>
  <a id="8536" class="Symbol">(</a><a id="8537" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8541" href="Reflection.Utils.TCI.html#8541" class="Bound">n&#39;</a> <a id="8544" class="Symbol">_)</a> <a id="8547" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="8549" href="Class.MonadTC.html#1817" class="Field">normalise</a> <a id="8559" href="Reflection.Utils.TCI.html#8527" class="Bound">t</a>
    <a id="8565" class="Keyword">where</a> <a id="8571" class="CatchallClause Symbol">_</a> <a id="8573" class="Symbol">→</a> <a id="8575" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="8582" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
  <a id="8590" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="8597" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌊</a> <a id="8599" href="Reflection.Utils.TCI.html#8525" class="Bound">n</a> <a id="8601" href="Class.DecEq.Core.html#159" class="Field Operator">≟</a> <a id="8603" href="Reflection.Utils.TCI.html#8541" class="Bound">n&#39;</a> <a id="8606" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌋</a>

<a id="8609" class="Comment">-- run a computation that returns a term, resetting the TC state but</a>
<a id="8678" class="Comment">-- ensuring that the term doesn&#39;t contain any metavariables</a>
<a id="withSafeReset"></a><a id="8738" href="Reflection.Utils.TCI.html#8738" class="Function">withSafeReset</a> <a id="8752" class="Symbol">:</a> <a id="8754" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8756" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8761" class="Symbol">→</a> <a id="8763" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8765" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="8770" href="Reflection.Utils.TCI.html#8738" class="Function">withSafeReset</a> <a id="8784" href="Reflection.Utils.TCI.html#8784" class="Bound">x</a> <a id="8786" class="Symbol">=</a> <a id="8788" href="Class.MonadTC.html#2560" class="Function">runAndReset</a> <a id="8800" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="8802" class="Keyword">do</a>
  <a id="8807" href="Reflection.Utils.TCI.html#8807" class="Bound">t</a> <a id="8809" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="8811" href="Reflection.Utils.TCI.html#8784" class="Bound">x</a>
  <a id="8815" class="Keyword">let</a> <a id="8819" href="Reflection.Utils.TCI.html#8819" class="Bound">m</a> <a id="8821" class="Symbol">=</a> <a id="8823" href="Reflection.Utils.Metas.html#246" class="Function">findMetas</a> <a id="8833" href="Reflection.Utils.TCI.html#8807" class="Bound">t</a>
  <a id="8837" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="8840" href="Data.List.Base.html#4703" class="Function">null</a> <a id="8845" href="Reflection.Utils.TCI.html#8819" class="Bound">m</a>
    <a id="8851" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="8856" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="8863" href="Reflection.Utils.TCI.html#8807" class="Bound">t</a>
    <a id="8869" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="8874" class="Keyword">do</a>
      <a id="8883" href="Class.MonadTC.html#8509" class="Function">debugLogᵐ</a> <a id="8893" class="Symbol">(</a><a id="8894" class="String">&quot;Remaining metavariables:&quot;</a> <a id="8921" href="Class.MonadTC.html#7757" class="Function Operator">∷ᵈᵐ</a> <a id="8925" href="Reflection.Utils.TCI.html#8819" class="Bound">m</a> <a id="8927" href="Class.MonadTC.html#7974" class="Function Operator">ᵛⁿ</a> <a id="8930" href="Class.MonadTC.html#7757" class="Function Operator">∷ᵈᵐ</a> <a id="8934" href="Class.MonadTC.html#7694" class="Function">[]ᵐ</a><a id="8937" class="Symbol">)</a>
      <a id="8945" href="Class.MonadTC.html#8199" class="Function">debugLog</a> <a id="8954" class="Symbol">(</a><a id="8955" class="String">&quot;In term: &quot;</a> <a id="8967" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="8970" href="Reflection.Utils.TCI.html#8807" class="Bound">t</a> <a id="8972" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="8975" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8977" class="Symbol">)</a>
      <a id="8985" href="Class.MonadTC.html#11197" class="Function">error1</a> <a id="8992" class="String">&quot;Unsolved metavariables remaining in withSafeReset!&quot;</a>

<a id="9046" class="Comment">-- apply a list of terms to a name, picking the correct constructor of the term datatype &amp; visibility</a>
<a id="applyWithVisibility"></a><a id="9148" href="Reflection.Utils.TCI.html#9148" class="Function">applyWithVisibility</a> <a id="9168" class="Symbol">:</a> <a id="9170" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9175" class="Symbol">→</a> <a id="9177" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9182" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="9187" class="Symbol">→</a> <a id="9189" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="9191" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="9196" href="Reflection.Utils.TCI.html#9148" class="Function">applyWithVisibility</a> <a id="9216" href="Reflection.Utils.TCI.html#9216" class="Bound">n</a> <a id="9218" href="Reflection.Utils.TCI.html#9218" class="Bound">l</a> <a id="9220" class="Symbol">=</a> <a id="9222" class="Keyword">do</a>
  <a id="9227" class="Symbol">(</a><a id="9228" href="Reflection.Utils.TCI.html#9228" class="Bound">argTys</a> <a id="9235" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9237" class="Symbol">_)</a> <a id="9240" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="9242" href="Reflection.Utils.TCI.html#6566" class="Function">getType&#39;</a> <a id="9251" href="Reflection.Utils.TCI.html#9216" class="Bound">n</a>
  <a id="9255" href="Class.MonadTC.html#3147" class="Function">nameConstr</a> <a id="9266" href="Reflection.Utils.TCI.html#9216" class="Bound">n</a> <a id="9268" class="Symbol">(</a><a id="9269" href="Data.List.Base.html#2734" class="Function">zipWith</a> <a id="9277" class="Symbol">(λ</a> <a id="9280" class="Keyword">where</a> <a id="9286" class="Symbol">(</a><a id="9287" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="9291" class="Symbol">_</a> <a id="9293" class="Symbol">(</a><a id="9294" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="9298" href="Reflection.Utils.TCI.html#9298" class="Bound">i</a> <a id="9300" class="Symbol">_))</a> <a id="9304" class="Symbol">→</a> <a id="9306" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="9310" href="Reflection.Utils.TCI.html#9298" class="Bound">i</a><a id="9311" class="Symbol">)</a> <a id="9313" href="Reflection.Utils.TCI.html#9228" class="Bound">argTys</a> <a id="9320" href="Reflection.Utils.TCI.html#9218" class="Bound">l</a><a id="9321" class="Symbol">)</a>

<a id="applyWithVisibilityDB"></a><a id="9324" href="Reflection.Utils.TCI.html#9324" class="Function">applyWithVisibilityDB</a> <a id="9346" class="Symbol">:</a> <a id="9348" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="9350" class="Symbol">→</a> <a id="9352" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9357" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="9362" class="Symbol">→</a> <a id="9364" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="9366" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="9371" href="Reflection.Utils.TCI.html#9324" class="Function">applyWithVisibilityDB</a> <a id="9393" href="Reflection.Utils.TCI.html#9393" class="Bound">n</a> <a id="9395" href="Reflection.Utils.TCI.html#9395" class="Bound">l</a> <a id="9397" class="Symbol">=</a> <a id="9399" class="Keyword">do</a>
  <a id="9404" class="Symbol">(</a><a id="9405" href="Reflection.Utils.TCI.html#9405" class="Bound">argTys</a> <a id="9412" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9414" class="Symbol">_)</a> <a id="9417" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="9419" href="Reflection.Utils.TCI.html#6639" class="Function">getTypeDB</a> <a id="9429" href="Reflection.Utils.TCI.html#9393" class="Bound">n</a>
  <a id="9433" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="9440" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="9442" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="9446" href="Reflection.Utils.TCI.html#9393" class="Bound">n</a> <a id="9448" class="Symbol">(</a><a id="9449" href="Data.List.Base.html#2734" class="Function">zipWith</a> <a id="9457" class="Symbol">(λ</a> <a id="9460" class="Keyword">where</a> <a id="9466" class="Symbol">(</a><a id="9467" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="9471" class="Symbol">_</a> <a id="9473" class="Symbol">(</a><a id="9474" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="9478" href="Reflection.Utils.TCI.html#9478" class="Bound">i</a> <a id="9480" class="Symbol">_))</a> <a id="9484" class="Symbol">→</a> <a id="9486" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="9490" href="Reflection.Utils.TCI.html#9478" class="Bound">i</a><a id="9491" class="Symbol">)</a> <a id="9493" href="Reflection.Utils.TCI.html#9405" class="Bound">argTys</a> <a id="9500" href="Reflection.Utils.TCI.html#9395" class="Bound">l</a><a id="9501" class="Symbol">)</a>
</pre></body></html>