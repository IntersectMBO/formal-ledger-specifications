<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.Utils.TCI</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">open</a> <a id="42" class="Keyword">import</a> <a id="49" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Meta.Init.html" class="Module">Meta.Init</a>

<a id="85" class="Keyword">open</a> <a id="90" class="Keyword">import</a> <a id="97" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Class.MonadError.Instances.html" class="Module">Class.MonadError.Instances</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Class.MonadReader.Instances.html" class="Module">Class.MonadReader.Instances</a>
<a id="188" class="Keyword">open</a> <a id="193" class="Keyword">import</a> <a id="200" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>

<a id="225" class="Keyword">module</a> <a id="232" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>
  <a id="255" class="Symbol">{</a><a id="256" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="258" class="Symbol">:</a> <a id="260" class="Symbol">∀</a> <a id="262" class="Symbol">{</a><a id="263" href="Reflection.Utils.TCI.html#263" class="Bound">a</a><a id="264" class="Symbol">}</a> <a id="266" class="Symbol">→</a> <a id="268" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="272" href="Reflection.Utils.TCI.html#263" class="Bound">a</a> <a id="274" class="Symbol">→</a> <a id="276" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="280" href="Reflection.Utils.TCI.html#263" class="Bound">a</a><a id="281" class="Symbol">}</a> <a id="283" class="Symbol">⦃</a> <a id="285" href="Reflection.Utils.TCI.html#285" class="Bound">_</a> <a id="287" class="Symbol">:</a> <a id="289" href="Class.Monad.Core.html#182" class="Record">Monad</a> <a id="295" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="297" class="Symbol">⦄</a> <a id="299" class="Symbol">⦃</a> <a id="301" href="Reflection.Utils.TCI.html#301" class="Bound">me</a> <a id="304" class="Symbol">:</a> <a id="306" href="Class.MonadError.html#285" class="Record">MonadError</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="323" href="Agda.Builtin.Reflection.html#8214" class="Datatype">ErrorPart</a><a id="332" class="Symbol">)</a> <a id="334" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="336" class="Symbol">⦄</a>
  <a id="340" class="Symbol">⦃</a> <a id="342" href="Reflection.Utils.TCI.html#342" class="Bound">mre</a> <a id="346" class="Symbol">:</a> <a id="348" href="Class.MonadReader.html#258" class="Record">MonadReader</a> <a id="360" href="Class.MonadTC.html#818" class="Record">TCEnv</a> <a id="366" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="368" class="Symbol">⦄</a> <a id="370" class="Symbol">⦃</a> <a id="372" href="Reflection.Utils.TCI.html#372" class="Bound">_</a> <a id="374" class="Symbol">:</a> <a id="376" href="Class.MonadTC.html#1519" class="Record">MonadTC</a> <a id="384" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="386" class="Symbol">⦄</a> <a id="388" class="Keyword">where</a>

<a id="395" class="Keyword">import</a> <a id="402" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="411" class="Keyword">open</a> <a id="416" class="Keyword">import</a> <a id="423" href="Data.List.html" class="Module">Data.List</a> <a id="433" class="Keyword">using</a> <a id="439" class="Symbol">(</a><a id="440" href="Data.List.Base.html#1612" class="Function">map</a><a id="443" class="Symbol">;</a> <a id="445" href="Data.List.Base.html#2712" class="Function">zipWith</a><a id="452" class="Symbol">)</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="483" class="Keyword">open</a> <a id="488" class="Keyword">import</a> <a id="495" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="522" class="Keyword">using</a> <a id="528" class="Symbol">(</a><a id="529" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊_⌋</a><a id="532" class="Symbol">)</a>

<a id="535" class="Keyword">open</a> <a id="540" class="Keyword">import</a> <a id="547" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="559" class="Keyword">open</a> <a id="564" class="Keyword">import</a> <a id="571" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="585" class="Keyword">open</a> <a id="590" class="Keyword">import</a> <a id="597" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="fresh-level"></a><a id="616" href="Reflection.Utils.TCI.html#616" class="Function">fresh-level</a> <a id="628" class="Symbol">:</a> <a id="630" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="632" href="Agda.Primitive.html#742" class="Postulate">Level</a>
<a id="638" href="Reflection.Utils.TCI.html#616" class="Function">fresh-level</a> <a id="650" class="Symbol">=</a> <a id="652" href="Class.MonadTC.html#6590" class="Function">newMeta</a> <a id="660" class="Symbol">(</a><a id="661" class="Keyword">quote</a> <a id="667" href="Agda.Primitive.html#742" class="Postulate">Level</a> <a id="673" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a><a id="674" class="Symbol">)</a> <a id="676" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="680" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a>

<a id="withHole"></a><a id="691" href="Reflection.Utils.TCI.html#691" class="Function">withHole</a> <a id="700" class="Symbol">:</a> <a id="702" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="707" class="Symbol">→</a> <a id="709" class="Symbol">(</a><a id="710" href="Reflection.Syntax.html#3681" class="Function">Hole</a> <a id="715" class="Symbol">→</a> <a id="717" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="719" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="720" class="Symbol">)</a> <a id="722" class="Symbol">→</a> <a id="724" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="726" href="Reflection.Syntax.html#3681" class="Function">Hole</a>
<a id="731" href="Reflection.Utils.TCI.html#691" class="Function">withHole</a> <a id="740" href="Reflection.Utils.TCI.html#740" class="Bound">ty</a> <a id="743" href="Reflection.Utils.TCI.html#743" class="Bound">k</a> <a id="745" class="Symbol">=</a> <a id="747" class="Keyword">do</a>
  <a id="752" href="Reflection.Utils.TCI.html#752" class="Bound">hole′</a> <a id="758" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="760" href="Class.MonadTC.html#6590" class="Function">newMeta</a> <a id="768" href="Reflection.Utils.TCI.html#740" class="Bound">ty</a>
  <a id="773" href="Reflection.Utils.TCI.html#743" class="Bound">k</a> <a id="775" href="Reflection.Utils.TCI.html#752" class="Bound">hole′</a>
  <a id="783" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="790" href="Reflection.Utils.TCI.html#752" class="Bound">hole′</a>

<a id="apply"></a><a id="797" href="Reflection.Utils.TCI.html#797" class="Function">apply</a> <a id="803" class="Symbol">:</a> <a id="805" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="810" class="Symbol">→</a> <a id="812" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="817" class="Symbol">→</a> <a id="819" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="824" class="Symbol">(</a><a id="825" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="829" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="833" class="Symbol">)</a> <a id="835" class="Symbol">→</a> <a id="837" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="839" class="Symbol">(</a><a id="840" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="845" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="847" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="851" class="Symbol">)</a>
<a id="853" href="Reflection.Utils.TCI.html#797" class="Function">apply</a> <a id="859" href="Reflection.Utils.TCI.html#859" class="Bound">A</a> <a id="861" href="Reflection.Utils.TCI.html#861" class="Bound">t</a> <a id="863" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="872" class="Symbol">=</a> <a id="874" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="881" class="Symbol">(</a><a id="882" href="Reflection.Utils.TCI.html#859" class="Bound">A</a> <a id="884" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="886" href="Reflection.Utils.TCI.html#861" class="Bound">t</a><a id="887" class="Symbol">)</a>
<a id="889" href="Reflection.Utils.TCI.html#797" class="Function">apply</a> <a id="895" href="Reflection.Utils.TCI.html#895" class="Bound">A</a> <a id="897" href="Reflection.Utils.TCI.html#897" class="Bound">t</a> <a id="899" class="Symbol">(</a><a id="900" href="Reflection.Utils.TCI.html#900" class="Bound">a</a> <a id="902" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="904" href="Reflection.Utils.TCI.html#904" class="Bound">as</a><a id="906" class="Symbol">)</a> <a id="908" class="Symbol">=</a> <a id="910" class="Keyword">do</a>
  <a id="915" href="Reflection.Utils.TCI.html#915" class="Bound">A</a> <a id="917" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="919" href="Class.MonadTC.html#1854" class="Field">reduce</a> <a id="926" href="Reflection.Utils.TCI.html#895" class="Bound">A</a>
  <a id="930" href="Reflection.Utils.TCI.html#930" class="Bound">A</a> <a id="932" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="934" href="Reflection.Utils.TCI.html#934" class="Bound">t</a> <a id="936" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="938" href="Reflection.Utils.TCI.html#978" class="Function">apply₁</a> <a id="945" href="Reflection.Utils.TCI.html#915" class="Bound">A</a> <a id="947" href="Reflection.Utils.TCI.html#897" class="Bound">t</a> <a id="949" href="Reflection.Utils.TCI.html#900" class="Bound">a</a>
  <a id="953" href="Reflection.Utils.TCI.html#797" class="Function">apply</a> <a id="959" href="Reflection.Utils.TCI.html#930" class="Bound">A</a> <a id="961" href="Reflection.Utils.TCI.html#934" class="Bound">t</a> <a id="963" href="Reflection.Utils.TCI.html#904" class="Bound">as</a>
  <a id="968" class="Keyword">where</a>
    <a id="978" href="Reflection.Utils.TCI.html#978" class="Function">apply₁</a> <a id="985" class="Symbol">:</a> <a id="987" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="992" class="Symbol">→</a> <a id="994" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="999" class="Symbol">→</a> <a id="1001" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="1005" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1010" class="Symbol">→</a> <a id="1012" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="1020" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1022" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="1026" class="Symbol">)</a>
    <a id="1032" href="Reflection.Utils.TCI.html#978" class="Function">apply₁</a> <a id="1039" class="Symbol">(</a><a id="1040" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="1043" class="Symbol">(</a><a id="1044" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="1048" href="Reflection.Utils.TCI.html#1048" class="Bound">i₁</a><a id="1050" class="Symbol">@(</a><a id="1052" href="Agda.Builtin.Reflection.html#3637" class="InductiveConstructor">arg-info</a> <a id="1061" href="Reflection.Utils.TCI.html#1061" class="Bound">k</a> <a id="1063" class="Symbol">_)</a> <a id="1066" href="Reflection.Utils.TCI.html#1066" class="Bound">A</a><a id="1067" class="Symbol">)</a> <a id="1069" href="Reflection.Utils.TCI.html#1069" class="Bound">B</a><a id="1070" class="Symbol">)</a> <a id="1072" href="Reflection.Utils.TCI.html#1072" class="Bound">t₁</a> <a id="1075" class="Symbol">(</a><a id="1076" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="1080" href="Reflection.Utils.TCI.html#1080" class="Bound">i₂</a> <a id="1083" href="Reflection.Utils.TCI.html#1083" class="Bound">t₂</a><a id="1085" class="Symbol">)</a> <a id="1087" class="Symbol">=</a> <a id="1089" class="Keyword">do</a>
      <a id="1098" href="Reflection.Utils.TCI.html#1098" class="Bound">a</a> <a id="1100" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1102" href="Reflection.Utils.TCI.html#616" class="Function">fresh-level</a>
      <a id="1120" href="Reflection.Utils.TCI.html#1120" class="Bound">b</a> <a id="1122" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1124" href="Reflection.Utils.TCI.html#616" class="Function">fresh-level</a>
      <a id="1142" href="Reflection.Utils.TCI.html#1142" class="Bound">A</a> <a id="1144" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1146" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1156" class="Symbol">{</a><a id="1157" class="Argument">A</a> <a id="1159" class="Symbol">=</a> <a id="1161" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1165" href="Reflection.Utils.TCI.html#1098" class="Bound">a</a><a id="1166" class="Symbol">}</a> <a id="1168" href="Reflection.Utils.TCI.html#1066" class="Bound">A</a>
      <a id="1176" href="Reflection.Utils.TCI.html#1176" class="Bound">B</a> <a id="1178" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1180" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1190" class="Symbol">{</a><a id="1191" class="Argument">A</a> <a id="1193" class="Symbol">=</a> <a id="1195" href="Reflection.Utils.TCI.html#1142" class="Bound">A</a> <a id="1197" class="Symbol">→</a> <a id="1199" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1203" href="Reflection.Utils.TCI.html#1120" class="Bound">b</a><a id="1204" class="Symbol">}</a> <a id="1206" class="Symbol">(</a><a id="1207" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">lam</a> <a id="1211" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="1219" href="Reflection.Utils.TCI.html#1069" class="Bound">B</a><a id="1220" class="Symbol">)</a>
      <a id="1228" href="Reflection.Utils.TCI.html#1228" class="Bound">t₂</a> <a id="1231" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1233" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1243" class="Symbol">{</a><a id="1244" class="Argument">A</a> <a id="1246" class="Symbol">=</a> <a id="1248" href="Reflection.Utils.TCI.html#1142" class="Bound">A</a><a id="1249" class="Symbol">}</a> <a id="1251" href="Reflection.Utils.TCI.html#1083" class="Bound">t₂</a>
      <a id="1260" href="Reflection.Utils.TCI.html#1260" class="Bound">Bt₂</a> <a id="1264" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1266" href="Class.MonadTC.html#1891" class="Field">quoteTC</a> <a id="1274" class="Symbol">(</a><a id="1275" href="Reflection.Utils.TCI.html#1176" class="Bound">B</a> <a id="1277" href="Reflection.Utils.TCI.html#1228" class="Bound">t₂</a><a id="1279" class="Symbol">)</a>
      <a id="1287" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1292" href="Reflection.Utils.TCI.html#1061" class="Bound">k</a> <a id="1294" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1297" class="Symbol">λ</a> <a id="1299" class="Keyword">where</a>
        <a id="1313" href="Agda.Builtin.Reflection.html#2762" class="InductiveConstructor">visible</a> <a id="1321" class="Symbol">→</a> <a id="1323" class="Keyword">do</a>
          <a id="1336" href="Reflection.Utils.TCI.html#1336" class="Bound">t₁</a> <a id="1339" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1341" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1351" class="Symbol">{</a><a id="1352" class="Argument">A</a> <a id="1354" class="Symbol">=</a> <a id="1356" class="Symbol">∀</a> <a id="1358" class="Symbol">(</a><a id="1359" href="Reflection.Utils.TCI.html#1359" class="Bound">x</a> <a id="1361" class="Symbol">:</a> <a id="1363" href="Reflection.Utils.TCI.html#1142" class="Bound">A</a><a id="1364" class="Symbol">)</a> <a id="1366" class="Symbol">→</a> <a id="1368" href="Reflection.Utils.TCI.html#1176" class="Bound">B</a> <a id="1370" href="Reflection.Utils.TCI.html#1359" class="Bound">x</a><a id="1371" class="Symbol">}</a> <a id="1373" href="Reflection.Utils.TCI.html#1072" class="Bound">t₁</a>
          <a id="1386" href="Reflection.Utils.TCI.html#1260" class="Bound">Bt₂</a> <a id="1390" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a> <a id="1393" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="1397" href="Class.MonadTC.html#1891" class="Field">quoteTC</a> <a id="1405" class="Symbol">(</a><a id="1406" href="Reflection.Utils.TCI.html#1336" class="Bound">t₁</a> <a id="1409" href="Reflection.Utils.TCI.html#1228" class="Bound">t₂</a><a id="1411" class="Symbol">)</a>
        <a id="1421" href="Agda.Builtin.Reflection.html#2770" class="InductiveConstructor">hidden</a> <a id="1428" class="Symbol">→</a> <a id="1430" class="Keyword">do</a>
          <a id="1443" href="Reflection.Utils.TCI.html#1443" class="Bound">t₁</a> <a id="1446" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1448" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1458" class="Symbol">{</a><a id="1459" class="Argument">A</a> <a id="1461" class="Symbol">=</a> <a id="1463" class="Symbol">∀</a> <a id="1465" class="Symbol">{</a><a id="1466" href="Reflection.Utils.TCI.html#1466" class="Bound">x</a> <a id="1468" class="Symbol">:</a> <a id="1470" href="Reflection.Utils.TCI.html#1142" class="Bound">A</a><a id="1471" class="Symbol">}</a> <a id="1473" class="Symbol">→</a> <a id="1475" href="Reflection.Utils.TCI.html#1176" class="Bound">B</a> <a id="1477" href="Reflection.Utils.TCI.html#1466" class="Bound">x</a><a id="1478" class="Symbol">}</a> <a id="1480" href="Reflection.Utils.TCI.html#1072" class="Bound">t₁</a>
          <a id="1493" href="Reflection.Utils.TCI.html#1260" class="Bound">Bt₂</a> <a id="1497" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a> <a id="1500" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="1504" href="Class.MonadTC.html#1891" class="Field">quoteTC</a> <a id="1512" class="Symbol">(</a><a id="1513" href="Reflection.Utils.TCI.html#1443" class="Bound">t₁</a> <a id="1516" class="Symbol">{</a><a id="1517" class="Argument">x</a> <a id="1519" class="Symbol">=</a> <a id="1521" href="Reflection.Utils.TCI.html#1228" class="Bound">t₂</a><a id="1523" class="Symbol">})</a>
        <a id="1534" href="Agda.Builtin.Reflection.html#2777" class="InductiveConstructor">instance′</a> <a id="1544" class="Symbol">→</a> <a id="1546" class="Keyword">do</a>
          <a id="1559" href="Reflection.Utils.TCI.html#1559" class="Bound">t₁</a> <a id="1562" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1564" href="Class.MonadTC.html#1925" class="Field">unquoteTC</a> <a id="1574" class="Symbol">{</a><a id="1575" class="Argument">A</a> <a id="1577" class="Symbol">=</a> <a id="1579" class="Symbol">∀</a> <a id="1581" class="Symbol">⦃</a> <a id="1583" href="Reflection.Utils.TCI.html#1583" class="Bound">x</a> <a id="1585" class="Symbol">:</a> <a id="1587" href="Reflection.Utils.TCI.html#1142" class="Bound">A</a> <a id="1589" class="Symbol">⦄</a> <a id="1591" class="Symbol">→</a> <a id="1593" href="Reflection.Utils.TCI.html#1176" class="Bound">B</a> <a id="1595" href="Reflection.Utils.TCI.html#1583" class="Bound">x</a><a id="1596" class="Symbol">}</a> <a id="1598" href="Reflection.Utils.TCI.html#1072" class="Bound">t₁</a>
          <a id="1611" href="Reflection.Utils.TCI.html#1260" class="Bound">Bt₂</a> <a id="1615" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a> <a id="1618" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="1622" href="Class.MonadTC.html#1891" class="Field">quoteTC</a> <a id="1630" class="Symbol">(</a><a id="1631" href="Reflection.Utils.TCI.html#1559" class="Bound">t₁</a> <a id="1634" class="Symbol">⦃</a> <a id="1636" class="Argument">x</a> <a id="1638" class="Symbol">=</a> <a id="1640" href="Reflection.Utils.TCI.html#1228" class="Bound">t₂</a> <a id="1643" class="Symbol">⦄)</a>
    <a id="1650" href="Reflection.Utils.TCI.html#978" class="Function">apply₁</a> <a id="1657" class="Symbol">(</a><a id="1658" href="Agda.Builtin.Reflection.html#5544" class="InductiveConstructor">meta</a> <a id="1663" href="Reflection.Utils.TCI.html#1663" class="Bound">x</a> <a id="1665" class="Symbol">_)</a> <a id="1668" class="Symbol">_</a> <a id="1670" class="Symbol">_</a> <a id="1672" class="Symbol">=</a> <a id="1674" href="Class.MonadTC.html#2265" class="Field">blockOnMeta</a> <a id="1686" href="Reflection.Utils.TCI.html#1663" class="Bound">x</a>
    <a id="1692" href="Reflection.Utils.TCI.html#978" class="CatchallClause Function">apply₁</a><a id="1698" class="CatchallClause"> </a><a id="1699" href="Reflection.Utils.TCI.html#1699" class="CatchallClause Bound">A</a><a id="1700" class="CatchallClause">          </a><a id="1710" class="CatchallClause Symbol">_</a><a id="1711" class="CatchallClause"> </a><a id="1712" class="CatchallClause Symbol">_</a> <a id="1714" class="Symbol">=</a> <a id="1716" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="1723" class="String">&quot;apply: not a Π-type&quot;</a>

<a id="_-∙-_"></a><a id="1746" href="Reflection.Utils.TCI.html#1746" class="Function Operator">_-∙-_</a> <a id="1752" class="Symbol">:</a> <a id="1754" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1759" class="Symbol">→</a> <a id="1761" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1766" class="Symbol">→</a> <a id="1768" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="1770" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="1775" href="Reflection.Utils.TCI.html#1775" class="Bound">f</a> <a id="1777" href="Reflection.Utils.TCI.html#1746" class="Function Operator">-∙-</a> <a id="1781" href="Reflection.Utils.TCI.html#1781" class="Bound">x</a> <a id="1783" class="Symbol">=</a> <a id="1785" class="Keyword">do</a>
  <a id="1790" href="Reflection.Utils.TCI.html#1790" class="Bound">ty</a> <a id="1793" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1795" href="Class.MonadTC.html#1736" class="Field">inferType</a> <a id="1805" href="Reflection.Utils.TCI.html#1775" class="Bound">f</a>
  <a id="1809" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1815" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="1819" href="Reflection.Utils.TCI.html#797" class="Function">apply</a> <a id="1825" href="Reflection.Utils.TCI.html#1790" class="Bound">ty</a> <a id="1828" href="Reflection.Utils.TCI.html#1775" class="Bound">f</a> <a id="1830" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="1832" href="Reflection.AST.Argument.html#1271" class="InductiveConstructor">vArg</a> <a id="1837" href="Reflection.Utils.TCI.html#1781" class="Bound">x</a> <a id="1839" href="Data.List.Base.html#4907" class="Function Operator">]</a>

<a id="_-∗-_"></a><a id="1842" href="Reflection.Utils.TCI.html#1842" class="Function Operator">_-∗-_</a> <a id="1848" class="Symbol">:</a> <a id="1850" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1855" class="Symbol">→</a> <a id="1857" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1862" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1867" class="Symbol">→</a> <a id="1869" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="1871" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="1876" href="Reflection.Utils.TCI.html#1876" class="Bound">f</a> <a id="1878" href="Reflection.Utils.TCI.html#1842" class="Function Operator">-∗-</a> <a id="1882" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>       <a id="1891" class="Symbol">=</a> <a id="1893" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="1900" href="Reflection.Utils.TCI.html#1876" class="Bound">f</a>
<a id="1902" href="Reflection.Utils.TCI.html#1902" class="Bound">f</a> <a id="1904" href="Reflection.Utils.TCI.html#1842" class="Function Operator">-∗-</a> <a id="1908" class="Symbol">(</a><a id="1909" href="Reflection.Utils.TCI.html#1909" class="Bound">x</a> <a id="1911" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1913" href="Reflection.Utils.TCI.html#1913" class="Bound">xs</a><a id="1915" class="Symbol">)</a> <a id="1917" class="Symbol">=</a> <a id="1919" href="Reflection.Utils.TCI.html#1902" class="Bound">f</a> <a id="1921" href="Reflection.Utils.TCI.html#1746" class="Function Operator">-∙-</a> <a id="1925" href="Reflection.Utils.TCI.html#1909" class="Bound">x</a> <a id="1927" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="1931" href="Reflection.Utils.TCI.html#1842" class="Function Operator">_-∗-</a> <a id="1936" href="Reflection.Utils.TCI.html#1913" class="Bound">xs</a>

<a id="instantiate"></a><a id="1940" href="Reflection.Utils.TCI.html#1940" class="Function">instantiate</a> <a id="1952" class="Symbol">:</a> <a id="1954" href="Reflection.Syntax.html#3681" class="Function">Hole</a> <a id="1959" class="Symbol">→</a> <a id="1961" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="1963" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="1968" href="Reflection.Utils.TCI.html#1940" class="Function">instantiate</a> <a id="1980" class="Symbol">=</a> <a id="1982" href="Class.MonadTC.html#1854" class="Field">reduce</a> <a id="1989" href="Class.Monad.Core.html#521" class="Function Operator">&gt;=&gt;</a> <a id="1993" href="Class.MonadTC.html#1817" class="Field">normalise</a>

<a id="ensureNoMetas"></a><a id="2004" href="Reflection.Utils.TCI.html#2004" class="Function">ensureNoMetas</a> <a id="2018" class="Symbol">:</a> <a id="2020" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2025" class="Symbol">→</a> <a id="2027" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2029" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="2031" href="Reflection.Utils.TCI.html#2004" class="Function">ensureNoMetas</a> <a id="2045" class="Symbol">=</a> <a id="2047" class="Symbol">λ</a> <a id="2049" class="Keyword">where</a>
  <a id="2057" class="Symbol">(</a><a id="2058" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="2062" href="Reflection.Utils.TCI.html#2062" class="Bound">x</a> <a id="2064" href="Reflection.Utils.TCI.html#2064" class="Bound">args</a><a id="2068" class="Symbol">)</a> <a id="2070" class="Symbol">→</a> <a id="2072" href="Reflection.Utils.TCI.html#2513" class="Function">noMetaArgs</a> <a id="2083" href="Reflection.Utils.TCI.html#2064" class="Bound">args</a>
  <a id="2090" class="Symbol">(</a><a id="2091" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="2095" href="Reflection.Utils.TCI.html#2095" class="Bound">c</a> <a id="2097" href="Reflection.Utils.TCI.html#2097" class="Bound">args</a><a id="2101" class="Symbol">)</a> <a id="2103" class="Symbol">→</a> <a id="2105" href="Reflection.Utils.TCI.html#2513" class="Function">noMetaArgs</a> <a id="2116" href="Reflection.Utils.TCI.html#2097" class="Bound">args</a>
  <a id="2123" class="Symbol">(</a><a id="2124" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="2128" href="Reflection.Utils.TCI.html#2128" class="Bound">f</a> <a id="2130" href="Reflection.Utils.TCI.html#2130" class="Bound">args</a><a id="2134" class="Symbol">)</a> <a id="2136" class="Symbol">→</a> <a id="2138" href="Reflection.Utils.TCI.html#2513" class="Function">noMetaArgs</a> <a id="2149" href="Reflection.Utils.TCI.html#2130" class="Bound">args</a>
  <a id="2156" class="Symbol">(</a><a id="2157" href="Agda.Builtin.Reflection.html#5308" class="InductiveConstructor">lam</a> <a id="2161" href="Reflection.Utils.TCI.html#2161" class="Bound">v</a> <a id="2163" class="Symbol">(</a><a id="2164" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2168" class="Symbol">_</a> <a id="2170" href="Reflection.Utils.TCI.html#2170" class="Bound">t</a><a id="2171" class="Symbol">))</a> <a id="2174" class="Symbol">→</a> <a id="2176" href="Reflection.Utils.TCI.html#2004" class="Function">ensureNoMetas</a> <a id="2190" href="Reflection.Utils.TCI.html#2170" class="Bound">t</a>
  <a id="2194" class="Symbol">(</a><a id="2195" href="Agda.Builtin.Reflection.html#5361" class="InductiveConstructor">pat-lam</a> <a id="2203" href="Reflection.Utils.TCI.html#2203" class="Bound">cs</a> <a id="2206" href="Reflection.Utils.TCI.html#2206" class="Bound">args</a><a id="2210" class="Symbol">)</a> <a id="2212" class="Symbol">→</a> <a id="2214" href="Reflection.Utils.TCI.html#2770" class="Function">noMetaClauses</a> <a id="2228" href="Reflection.Utils.TCI.html#2203" class="Bound">cs</a> <a id="2231" href="Class.Monad.Core.html#371" class="Function Operator">&gt;&gt;</a> <a id="2234" href="Reflection.Utils.TCI.html#2513" class="Function">noMetaArgs</a> <a id="2245" href="Reflection.Utils.TCI.html#2206" class="Bound">args</a>
  <a id="2252" class="Symbol">(</a><a id="2253" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="2256" href="Reflection.Utils.TCI.html#2256" class="Bound">a</a> <a id="2258" href="Reflection.Utils.TCI.html#2258" class="Bound">b</a><a id="2259" class="Symbol">)</a> <a id="2261" class="Symbol">→</a> <a id="2263" href="Reflection.Utils.TCI.html#2439" class="Function">noMetaArg</a> <a id="2273" href="Reflection.Utils.TCI.html#2256" class="Bound">a</a> <a id="2275" href="Class.Monad.Core.html#371" class="Function Operator">&gt;&gt;</a> <a id="2278" href="Reflection.Utils.TCI.html#2905" class="Function">noMetaAbs</a> <a id="2288" href="Reflection.Utils.TCI.html#2258" class="Bound">b</a>
  <a id="2292" class="Symbol">(</a><a id="2293" href="Agda.Builtin.Reflection.html#5477" class="InductiveConstructor">sort</a> <a id="2298" href="Reflection.Utils.TCI.html#2298" class="Bound">s</a><a id="2299" class="Symbol">)</a> <a id="2301" class="Symbol">→</a> <a id="2303" href="Reflection.Utils.TCI.html#2979" class="Function">noMetaSort</a> <a id="2314" href="Reflection.Utils.TCI.html#2298" class="Bound">s</a>
  <a id="2318" class="Symbol">(</a><a id="2319" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">lit</a> <a id="2323" href="Reflection.Utils.TCI.html#2323" class="Bound">l</a><a id="2324" class="Symbol">)</a> <a id="2326" class="Symbol">→</a> <a id="2328" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="2335" class="Symbol">_</a>
  <a id="2339" class="Comment">-- (meta x _) → errorP &quot;meta found!&quot;</a>
  <a id="2378" class="Symbol">(</a><a id="2379" href="Agda.Builtin.Reflection.html#5544" class="InductiveConstructor">meta</a> <a id="2384" href="Reflection.Utils.TCI.html#2384" class="Bound">x</a> <a id="2386" class="Symbol">_)</a> <a id="2389" class="Symbol">→</a> <a id="2391" href="Class.MonadTC.html#2265" class="Field">blockOnMeta</a> <a id="2403" href="Reflection.Utils.TCI.html#2384" class="Bound">x</a>
  <a id="2407" href="Agda.Builtin.Reflection.html#5594" class="InductiveConstructor">unknown</a> <a id="2415" class="Symbol">→</a> <a id="2417" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="2424" class="Symbol">_</a>
   <a id="2429" class="Keyword">where</a>
    <a id="2439" href="Reflection.Utils.TCI.html#2439" class="Function">noMetaArg</a> <a id="2449" class="Symbol">:</a> <a id="2451" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="2455" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2460" class="Symbol">→</a> <a id="2462" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2464" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2470" href="Reflection.Utils.TCI.html#2439" class="Function">noMetaArg</a> <a id="2480" class="Symbol">(</a><a id="2481" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="2485" class="Symbol">_</a> <a id="2487" href="Reflection.Utils.TCI.html#2487" class="Bound">v</a><a id="2488" class="Symbol">)</a> <a id="2490" class="Symbol">=</a> <a id="2492" href="Reflection.Utils.TCI.html#2004" class="Function">ensureNoMetas</a> <a id="2506" href="Reflection.Utils.TCI.html#2487" class="Bound">v</a>

    <a id="2513" href="Reflection.Utils.TCI.html#2513" class="Function">noMetaArgs</a> <a id="2524" class="Symbol">:</a> <a id="2526" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2531" class="Symbol">(</a><a id="2532" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="2536" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2540" class="Symbol">)</a> <a id="2542" class="Symbol">→</a> <a id="2544" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2546" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2552" href="Reflection.Utils.TCI.html#2513" class="Function">noMetaArgs</a> <a id="2563" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2566" class="Symbol">=</a> <a id="2568" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="2575" class="Symbol">_</a>
    <a id="2581" href="Reflection.Utils.TCI.html#2513" class="Function">noMetaArgs</a> <a id="2592" class="Symbol">(</a><a id="2593" href="Reflection.Utils.TCI.html#2593" class="Bound">v</a> <a id="2595" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2597" href="Reflection.Utils.TCI.html#2597" class="Bound">vs</a><a id="2599" class="Symbol">)</a> <a id="2601" class="Symbol">=</a> <a id="2603" href="Reflection.Utils.TCI.html#2439" class="Function">noMetaArg</a> <a id="2613" href="Reflection.Utils.TCI.html#2593" class="Bound">v</a> <a id="2615" href="Class.Monad.Core.html#371" class="Function Operator">&gt;&gt;</a> <a id="2618" href="Reflection.Utils.TCI.html#2513" class="Function">noMetaArgs</a> <a id="2629" href="Reflection.Utils.TCI.html#2597" class="Bound">vs</a>

    <a id="2637" href="Reflection.Utils.TCI.html#2637" class="Function">noMetaClause</a> <a id="2650" class="Symbol">:</a> <a id="2652" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a> <a id="2659" class="Symbol">→</a> <a id="2661" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2663" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2669" href="Reflection.Utils.TCI.html#2637" class="Function">noMetaClause</a> <a id="2682" class="Symbol">(</a><a id="2683" href="Agda.Builtin.Reflection.html#6106" class="InductiveConstructor">clause</a> <a id="2690" class="Symbol">_</a> <a id="2692" href="Reflection.Utils.TCI.html#2692" class="Bound">ps</a> <a id="2695" href="Reflection.Utils.TCI.html#2695" class="Bound">t</a><a id="2696" class="Symbol">)</a> <a id="2698" class="Symbol">=</a> <a id="2700" href="Reflection.Utils.TCI.html#2004" class="Function">ensureNoMetas</a> <a id="2714" href="Reflection.Utils.TCI.html#2695" class="Bound">t</a>
    <a id="2720" href="Reflection.Utils.TCI.html#2637" class="Function">noMetaClause</a> <a id="2733" class="Symbol">(</a><a id="2734" href="Agda.Builtin.Reflection.html#6188" class="InductiveConstructor">absurd-clause</a> <a id="2748" class="Symbol">_</a> <a id="2750" href="Reflection.Utils.TCI.html#2750" class="Bound">ps</a><a id="2752" class="Symbol">)</a> <a id="2754" class="Symbol">=</a> <a id="2756" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="2763" class="Symbol">_</a>

    <a id="2770" href="Reflection.Utils.TCI.html#2770" class="Function">noMetaClauses</a> <a id="2784" class="Symbol">:</a> <a id="2786" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2791" href="Agda.Builtin.Reflection.html#5050" class="Datatype">Clause</a> <a id="2798" class="Symbol">→</a> <a id="2800" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2802" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2808" href="Reflection.Utils.TCI.html#2770" class="Function">noMetaClauses</a> <a id="2822" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2825" class="Symbol">=</a> <a id="2827" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="2834" class="Symbol">_</a>
    <a id="2840" href="Reflection.Utils.TCI.html#2770" class="Function">noMetaClauses</a> <a id="2854" class="Symbol">(</a><a id="2855" href="Reflection.Utils.TCI.html#2855" class="Bound">c</a> <a id="2857" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2859" href="Reflection.Utils.TCI.html#2859" class="Bound">cs</a><a id="2861" class="Symbol">)</a> <a id="2863" class="Symbol">=</a> <a id="2865" href="Reflection.Utils.TCI.html#2637" class="Function">noMetaClause</a> <a id="2878" href="Reflection.Utils.TCI.html#2855" class="Bound">c</a> <a id="2880" href="Class.Monad.Core.html#371" class="Function Operator">&gt;&gt;</a> <a id="2883" href="Reflection.Utils.TCI.html#2770" class="Function">noMetaClauses</a> <a id="2897" href="Reflection.Utils.TCI.html#2859" class="Bound">cs</a>

    <a id="2905" href="Reflection.Utils.TCI.html#2905" class="Function">noMetaAbs</a> <a id="2915" class="Symbol">:</a> <a id="2917" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="2921" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2926" class="Symbol">→</a> <a id="2928" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="2930" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="2936" href="Reflection.Utils.TCI.html#2905" class="Function">noMetaAbs</a> <a id="2946" class="Symbol">(</a><a id="2947" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="2951" class="Symbol">_</a> <a id="2953" href="Reflection.Utils.TCI.html#2953" class="Bound">v</a><a id="2954" class="Symbol">)</a> <a id="2956" class="Symbol">=</a> <a id="2958" href="Reflection.Utils.TCI.html#2004" class="Function">ensureNoMetas</a> <a id="2972" href="Reflection.Utils.TCI.html#2953" class="Bound">v</a>

    <a id="2979" href="Reflection.Utils.TCI.html#2979" class="Function">noMetaSort</a> <a id="2990" class="Symbol">:</a> <a id="2992" href="Agda.Builtin.Reflection.html#5012" class="Datatype">Sort</a> <a id="2997" class="Symbol">→</a> <a id="2999" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="3001" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="3007" href="Reflection.Utils.TCI.html#2979" class="Function">noMetaSort</a> <a id="3018" class="Symbol">(</a><a id="3019" href="Agda.Builtin.Reflection.html#5630" class="InductiveConstructor">set</a> <a id="3023" href="Reflection.Utils.TCI.html#3023" class="Bound">t</a><a id="3024" class="Symbol">)</a> <a id="3026" class="Symbol">=</a> <a id="3028" href="Reflection.Utils.TCI.html#2004" class="Function">ensureNoMetas</a> <a id="3042" href="Reflection.Utils.TCI.html#3023" class="Bound">t</a>
    <a id="3048" href="Reflection.Utils.TCI.html#2979" class="CatchallClause Function">noMetaSort</a><a id="3058" class="CatchallClause"> </a><a id="3059" class="CatchallClause Symbol">_</a>       <a id="3067" class="Symbol">=</a> <a id="3069" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="3076" class="Symbol">_</a>

<a id="3079" class="Keyword">module</a> <a id="NewMeta"></a><a id="3086" href="Reflection.Utils.TCI.html#3086" class="Module">NewMeta</a> <a id="3094" class="Keyword">where</a>
  <a id="NewMeta.unifyStrict"></a><a id="3102" href="Reflection.Utils.TCI.html#3102" class="Function">unifyStrict</a> <a id="3114" class="Symbol">:</a> <a id="3116" href="Reflection.Syntax.html#3701" class="Function">THole</a> <a id="3122" class="Symbol">→</a> <a id="3124" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3129" class="Symbol">→</a> <a id="3131" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="3133" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3137" href="Reflection.Utils.TCI.html#3102" class="Function">unifyStrict</a> <a id="3149" class="Symbol">(</a><a id="3150" href="Reflection.Utils.TCI.html#3150" class="Bound">hole</a> <a id="3155" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3157" href="Reflection.Utils.TCI.html#3157" class="Bound">ty</a><a id="3159" class="Symbol">)</a> <a id="3161" href="Reflection.Utils.TCI.html#3161" class="Bound">x</a> <a id="3163" class="Symbol">=</a> <a id="3165" href="Class.MonadTC.html#8802" class="Function">withAppendDebugPath</a> <a id="3185" class="String">&quot;unifyStrict&quot;</a> <a id="3199" class="Keyword">do</a>
    <a id="3206" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="3215" class="Symbol">(</a><a id="3216" href="Reflection.Utils.TCI.html#3150" class="Bound">hole</a> <a id="3221" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3224" class="String">&quot; :=? &quot;</a> <a id="3232" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3235" href="Reflection.Utils.TCI.html#3161" class="Bound">x</a> <a id="3237" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3240" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3242" class="Symbol">)</a>
    <a id="3248" href="Reflection.Utils.TCI.html#3248" class="Bound">m</a> <a id="3250" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3252" href="Class.MonadTC.html#6590" class="Function">newMeta</a> <a id="3260" href="Reflection.Utils.TCI.html#3157" class="Bound">ty</a>
    <a id="3267" href="Class.MonadTC.html#9059" class="Function">noConstraints</a> <a id="3281" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3283" href="Class.MonadTC.html#1651" class="Field">unify</a> <a id="3289" href="Reflection.Utils.TCI.html#3248" class="Bound">m</a> <a id="3291" href="Reflection.Utils.TCI.html#3161" class="Bound">x</a> <a id="3293" href="Class.Monad.Core.html#371" class="Function Operator">&gt;&gt;</a> <a id="3296" href="Class.MonadTC.html#1651" class="Field">unify</a> <a id="3302" href="Reflection.Utils.TCI.html#3150" class="Bound">hole</a> <a id="3307" href="Reflection.Utils.TCI.html#3248" class="Bound">m</a>
    <a id="3313" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="3322" class="Symbol">(</a><a id="3323" href="Reflection.Utils.TCI.html#3150" class="Bound">hole</a> <a id="3328" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3331" class="String">&quot; :=  &quot;</a> <a id="3339" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3342" href="Reflection.Utils.TCI.html#3161" class="Bound">x</a> <a id="3344" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3347" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3349" class="Symbol">)</a>

<a id="printTerm"></a><a id="3352" href="Reflection.Utils.TCI.html#3352" class="Function">printTerm</a> <a id="3362" class="Symbol">:</a> <a id="3364" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="3371" class="Symbol">→</a> <a id="3373" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3378" class="Symbol">→</a> <a id="3380" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="3382" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="3384" href="Reflection.Utils.TCI.html#3352" class="Function">printTerm</a> <a id="3394" href="Reflection.Utils.TCI.html#3394" class="Bound">s</a> <a id="3396" href="Reflection.Utils.TCI.html#3396" class="Bound">t</a> <a id="3398" class="Symbol">=</a> <a id="3400" class="Keyword">do</a>
  <a id="3405" href="Reflection.Utils.TCI.html#3405" class="Bound">ty</a> <a id="3408" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3410" href="Class.MonadTC.html#1736" class="Field">inferType</a> <a id="3420" href="Reflection.Utils.TCI.html#3396" class="Bound">t</a>
  <a id="3424" href="Class.MonadTC.html#8133" class="Function">debugLog</a>
    <a id="3437" class="Symbol">(</a> <a id="3439" href="Reflection.Utils.TCI.html#3394" class="Bound">s</a> <a id="3441" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3444" class="String">&quot;: {&quot;</a>
    <a id="3454" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3457" href="Reflection.Utils.TCI.html#3405" class="Bound">ty</a>
    <a id="3464" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3467" class="String">&quot; ∋ &quot;</a>
    <a id="3477" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3480" href="Reflection.Utils.TCI.html#3396" class="Bound">t</a>
    <a id="3486" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3489" class="String">&quot;}\n&quot;</a>
    <a id="3499" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3502" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3504" class="Symbol">)</a>

<a id="3507" class="Keyword">module</a> <a id="NoMeta"></a><a id="3514" href="Reflection.Utils.TCI.html#3514" class="Module">NoMeta</a> <a id="3521" class="Keyword">where</a>
  <a id="NoMeta.unifyStrict"></a><a id="3529" href="Reflection.Utils.TCI.html#3529" class="Function">unifyStrict</a> <a id="3541" class="Symbol">:</a> <a id="3543" href="Reflection.Syntax.html#3701" class="Function">THole</a> <a id="3549" class="Symbol">→</a> <a id="3551" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="3556" class="Symbol">→</a> <a id="3558" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="3560" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="3564" href="Reflection.Utils.TCI.html#3529" class="Function">unifyStrict</a> <a id="3576" class="Symbol">(</a><a id="3577" href="Reflection.Utils.TCI.html#3577" class="Bound">hole</a> <a id="3582" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3584" href="Reflection.Utils.TCI.html#3584" class="Bound">ty</a><a id="3586" class="Symbol">)</a> <a id="3588" href="Reflection.Utils.TCI.html#3588" class="Bound">x</a> <a id="3590" class="Symbol">=</a> <a id="3592" href="Class.MonadTC.html#8802" class="Function">withAppendDebugPath</a> <a id="3612" class="String">&quot;unifyStrictNoMeta&quot;</a> <a id="3632" class="Keyword">do</a>
    <a id="3639" class="Comment">-- unify hole x</a>
    <a id="3659" class="Comment">-- instantiate hole &gt;&gt;= ensureNoMetas</a>

    <a id="3702" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="3711" class="Symbol">(</a><a id="3712" class="String">&quot;———————————————————————————————————————\nx&quot;</a> <a id="3757" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3760" href="Reflection.Utils.TCI.html#3588" class="Bound">x</a> <a id="3762" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="3765" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3767" class="Symbol">)</a>
    <a id="3773" href="Class.MonadTC.html#1651" class="Field">unify</a> <a id="3779" href="Reflection.Utils.TCI.html#3577" class="Bound">hole</a> <a id="3784" href="Reflection.Utils.TCI.html#3588" class="Bound">x</a>
    <a id="3790" href="Reflection.Utils.TCI.html#3790" class="Bound">hole</a> <a id="3795" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="3797" href="Class.MonadTC.html#1817" class="Field">normalise</a> <a id="3807" href="Reflection.Utils.TCI.html#3577" class="Bound">hole</a>
    <a id="3816" href="Reflection.Utils.TCI.html#3352" class="Function">printTerm</a> <a id="3826" class="String">&quot;hole′&quot;</a> <a id="3834" href="Reflection.Utils.TCI.html#3790" class="Bound">hole</a>
    <a id="3843" class="Comment">-- (x ∷ hole ∷ []) ← mapM instantiate (x ∷ hole ∷ [])</a>
    <a id="3901" class="Comment">--   where _ → _IMPOSSIBLE_</a>
    <a id="3933" class="Comment">-- printTerm &quot;x′&quot; x</a>
    <a id="3957" href="Reflection.Utils.TCI.html#2004" class="Function">ensureNoMetas</a> <a id="3971" href="Reflection.Utils.TCI.html#3790" class="Bound">hole</a>
    <a id="3980" href="Class.MonadTC.html#11200" class="Function">debugLog1</a> <a id="3990" class="String">&quot;No metas found :)\n&quot;</a>

<a id="4013" class="Keyword">open</a> <a id="4018" href="Reflection.Utils.TCI.html#3086" class="Module">NewMeta</a> <a id="4026" class="Keyword">public</a>
<a id="4033" class="Comment">-- open NoMeta public</a>

<a id="4056" class="Keyword">import</a> <a id="4063" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="4082" class="Symbol">as</a> <a id="4085" class="Module">NE</a>

<a id="unifyStricts"></a><a id="4089" href="Reflection.Utils.TCI.html#4089" class="Function">unifyStricts</a> <a id="4102" class="Symbol">:</a> <a id="4104" href="Reflection.Syntax.html#3701" class="Function">THole</a> <a id="4110" class="Symbol">→</a> <a id="4112" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4117" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="4122" class="Symbol">→</a> <a id="4124" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="4126" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="4128" href="Reflection.Utils.TCI.html#4089" class="Function">unifyStricts</a> <a id="4141" href="Reflection.Utils.TCI.html#4141" class="Bound">ht</a> <a id="4144" class="Symbol">=</a> <a id="4146" href="Data.List.NonEmpty.Base.html#3288" class="Function">NE.foldl₁</a> <a id="4156" class="Symbol">(λ</a> <a id="4159" href="Reflection.Utils.TCI.html#4159" class="Bound">x</a> <a id="4161" href="Reflection.Utils.TCI.html#4161" class="Bound">y</a> <a id="4163" class="Symbol">→</a> <a id="4165" href="Class.MonadError.html#381" class="Field">catch</a> <a id="4171" href="Reflection.Utils.TCI.html#4159" class="Bound">x</a> <a id="4173" class="Symbol">(λ</a> <a id="4176" href="Reflection.Utils.TCI.html#4176" class="Bound">_</a> <a id="4178" class="Symbol">→</a> <a id="4180" href="Reflection.Utils.TCI.html#4161" class="Bound">y</a><a id="4181" class="Symbol">))</a>
                <a id="4200" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4202" class="Symbol">(</a><a id="4203" href="Data.List.NonEmpty.Base.html#5087" class="Function Operator">NE._∷ʳ</a> <a id="4210" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="4217" class="String">&quot;∅&quot;</a><a id="4220" class="Symbol">)</a>
                <a id="4238" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="4240" href="Data.List.Base.html#1612" class="Function">map</a> <a id="4244" class="Symbol">(</a><a id="4245" class="Comment">{-noConstraints ∘ -}</a><a id="4265" href="Reflection.Utils.TCI.html#3102" class="Function">unifyStrict</a> <a id="4277" href="Reflection.Utils.TCI.html#4141" class="Bound">ht</a><a id="4279" class="Symbol">)</a>

<a id="compatible?"></a><a id="4282" href="Reflection.Utils.TCI.html#4282" class="Function">compatible?</a> <a id="4294" class="Symbol">:</a> <a id="4296" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="4301" class="Symbol">→</a> <a id="4303" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="4308" class="Symbol">→</a> <a id="4310" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="4312" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="4317" href="Reflection.Utils.TCI.html#4282" class="Function">compatible?</a> <a id="4329" href="Reflection.Utils.TCI.html#4329" class="Bound">ty</a> <a id="4332" href="Reflection.Utils.TCI.html#4332" class="Bound">ty′</a> <a id="4336" class="Symbol">=</a> <a id="4338" class="Keyword">do</a>
  <a id="4343" class="Comment">-- print $ show ty ◇ &quot; ≈? &quot; ◇ show ty′</a>
  <a id="4384" href="Reflection.Utils.TCI.html#4384" class="Bound">b</a> <a id="4386" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4388" href="Class.MonadTC.html#2420" class="Field">runSpeculative</a> <a id="4403" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="4405" class="Symbol">(</a><a id="4406" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,</a> <a id="4409" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="4414" class="Symbol">)</a> <a id="4416" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a>
    <a id="4424" href="Class.MonadError.html#381" class="Field">catch</a> <a id="4430" class="Symbol">(</a><a id="4431" href="Class.MonadTC.html#1651" class="Field">unify</a> <a id="4437" class="Symbol">(</a><a id="4438" href="Reflection.Utils.Substitute.html#3859" class="Function">varsToUnknown</a> <a id="4452" href="Reflection.Utils.TCI.html#4329" class="Bound">ty</a><a id="4454" class="Symbol">)</a> <a id="4456" class="Symbol">(</a><a id="4457" href="Reflection.Utils.Substitute.html#3859" class="Function">varsToUnknown</a> <a id="4471" href="Reflection.Utils.TCI.html#4332" class="Bound">ty′</a><a id="4474" class="Symbol">)</a> <a id="4476" href="Class.Monad.Core.html#371" class="Function Operator">&gt;&gt;</a> <a id="4479" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="4486" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="4490" class="Symbol">)</a>
          <a id="4502" class="Symbol">(λ</a> <a id="4505" href="Reflection.Utils.TCI.html#4505" class="Bound">_</a> <a id="4507" class="Symbol">→</a> <a id="4509" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="4516" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="4521" class="Symbol">)</a>
  <a id="4525" class="Comment">-- print $ &quot;  ——→ &quot; ◇ show b</a>
  <a id="4556" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="4563" href="Reflection.Utils.TCI.html#4384" class="Bound">b</a>

<a id="logTelescope"></a><a id="4566" href="Reflection.Utils.TCI.html#4566" class="Function">logTelescope</a> <a id="4579" class="Symbol">:</a> <a id="4581" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4586" class="Symbol">(</a><a id="4587" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4593" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4600" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4602" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="4606" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="4610" class="Symbol">)</a> <a id="4612" class="Symbol">→</a> <a id="4614" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="4616" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="4618" href="Reflection.Utils.TCI.html#4566" class="Function">logTelescope</a> <a id="4631" href="Reflection.Utils.TCI.html#4631" class="Bound">l</a> <a id="4633" class="Symbol">=</a> <a id="4635" href="Class.MonadTC.html#8802" class="Function">withAppendDebugPath</a> <a id="4655" class="String">&quot;context&quot;</a> <a id="4665" class="Keyword">do</a>
  <a id="4670" href="Class.MonadError.html#381" class="Field">catch</a> <a id="4676" class="Symbol">(</a><a id="4677" href="Reflection.Utils.TCI.html#4764" class="Function">helper</a> <a id="4684" class="Symbol">(</a><a id="4685" href="Data.List.Base.html#4746" class="Function">length</a> <a id="4692" href="Reflection.Utils.TCI.html#4631" class="Bound">l</a><a id="4693" class="Symbol">)</a> <a id="4695" href="Reflection.Utils.TCI.html#4631" class="Bound">l</a><a id="4696" class="Symbol">)</a> <a id="4698" class="Symbol">(λ</a> <a id="4701" href="Reflection.Utils.TCI.html#4701" class="Bound">_</a> <a id="4703" class="Symbol">→</a> <a id="4705" href="Class.MonadTC.html#11200" class="Function">debugLog1</a> <a id="4715" class="String">&quot;Error while printing the context!&quot;</a><a id="4750" class="Symbol">)</a>
  <a id="4754" class="Keyword">where</a>
    <a id="4764" href="Reflection.Utils.TCI.html#4764" class="Function">helper</a> <a id="4771" class="Symbol">:</a> <a id="4773" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4775" class="Symbol">→</a> <a id="4777" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4782" class="Symbol">(</a><a id="4783" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4789" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4796" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4798" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="4802" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="4806" class="Symbol">)</a> <a id="4808" class="Symbol">→</a> <a id="4810" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="4812" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="4818" href="Reflection.Utils.TCI.html#4764" class="Function">helper</a> <a id="4825" href="Reflection.Utils.TCI.html#4825" class="Bound">n</a> <a id="4827" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="4830" class="Symbol">=</a> <a id="4832" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="4839" class="Symbol">_</a>
    <a id="4845" href="Reflection.Utils.TCI.html#4764" class="Function">helper</a> <a id="4852" href="Reflection.Utils.TCI.html#4852" class="Bound">n</a> <a id="4854" class="Symbol">((</a><a id="4856" href="Reflection.Utils.TCI.html#4856" class="Bound">x</a> <a id="4858" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4860" href="Reflection.Utils.TCI.html#4860" class="Bound">ty</a><a id="4862" class="Symbol">@(</a><a id="4864" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="4868" class="Symbol">_</a> <a id="4870" href="Reflection.Utils.TCI.html#4870" class="Bound">t</a><a id="4871" class="Symbol">))</a> <a id="4874" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4876" href="Reflection.Utils.TCI.html#4876" class="Bound">l</a><a id="4877" class="Symbol">)</a> <a id="4879" class="Symbol">=</a> <a id="4881" class="Keyword">do</a>
      <a id="4890" class="Keyword">let</a> <a id="4894" href="Reflection.Utils.TCI.html#4894" class="Bound">name</a> <a id="4899" class="Symbol">=</a> <a id="4901" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="4906" href="Reflection.Utils.TCI.html#4856" class="Bound">x</a> <a id="4908" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="4911" class="Symbol">λ</a> <a id="4913" class="Keyword">where</a>
        <a id="4927" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>   <a id="4937" class="Symbol">→</a> <a id="4939" class="String">&quot;?&quot;</a>
        <a id="4951" class="Symbol">(</a><a id="4952" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4957" class="String">&quot;&quot;</a><a id="4959" class="Symbol">)</a> <a id="4961" class="Symbol">→</a> <a id="4963" class="String">&quot;_&quot;</a>
        <a id="4975" class="Symbol">(</a><a id="4976" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4981" href="Reflection.Utils.TCI.html#4981" class="Bound">x</a><a id="4982" class="Symbol">)</a>  <a id="4985" class="Symbol">→</a> <a id="4987" href="Reflection.Utils.TCI.html#4981" class="Bound">x</a>
      <a id="4995" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="5004" class="Symbol">(</a><a id="5005" class="String">&quot;  &quot;</a> <a id="5010" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5013" href="Reflection.Utils.TCI.html#4894" class="Bound">name</a> <a id="5018" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5021" class="String">&quot; : &quot;</a>  <a id="5028" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5031" href="Reflection.Utils.Substitute.html#3801" class="Function">mapVars</a> <a id="5039" class="Symbol">(</a><a id="5040" href="Data.Nat.Base.html#4462" class="Primitive Operator">_∸</a> <a id="5043" class="Symbol">(</a><a id="5044" href="Reflection.Utils.TCI.html#4852" class="Bound">n</a> <a id="5046" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5048" class="Symbol">(</a><a id="5049" class="Number">1</a> <a id="5051" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="5053" href="Data.List.Base.html#4746" class="Function">length</a> <a id="5060" href="Reflection.Utils.TCI.html#4876" class="Bound">l</a><a id="5061" class="Symbol">)))</a> <a id="5065" href="Reflection.Utils.TCI.html#4870" class="Bound">t</a> <a id="5067" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5070" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5072" class="Symbol">)</a>
      <a id="5080" href="Class.MonadTC.html#10286" class="Function">extendContext</a> <a id="5094" class="Symbol">(</a><a id="5095" href="Reflection.Utils.TCI.html#4894" class="Bound">name</a> <a id="5100" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5102" href="Reflection.Utils.TCI.html#4860" class="Bound">ty</a><a id="5104" class="Symbol">)</a> <a id="5106" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="5108" href="Reflection.Utils.TCI.html#4764" class="Function">helper</a> <a id="5115" href="Reflection.Utils.TCI.html#4852" class="Bound">n</a> <a id="5117" href="Reflection.Utils.TCI.html#4876" class="Bound">l</a>

<a id="logContext"></a><a id="5120" href="Reflection.Utils.TCI.html#5120" class="Function">logContext</a> <a id="5131" class="Symbol">:</a> <a id="5133" href="Reflection.AST.Term.html#1887" class="Function">Telescope</a> <a id="5143" class="Symbol">→</a> <a id="5145" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5147" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="5149" href="Reflection.Utils.TCI.html#5120" class="Function">logContext</a> <a id="5160" href="Reflection.Utils.TCI.html#5160" class="Bound">l</a> <a id="5162" class="Symbol">=</a> <a id="5164" href="Class.MonadTC.html#8802" class="Function">withAppendDebugPath</a> <a id="5184" class="String">&quot;context&quot;</a> <a id="5194" class="Keyword">do</a>
  <a id="5199" href="Class.MonadTC.html#11200" class="Function">debugLog1</a> <a id="5209" class="String">&quot;Context:&quot;</a>
  <a id="5222" href="Class.MonadError.html#381" class="Field">catch</a> <a id="5228" class="Symbol">(</a><a id="5229" href="Reflection.Utils.TCI.html#5552" class="Function">helper</a> <a id="5236" class="Symbol">(</a><a id="5237" href="Data.List.Base.html#4746" class="Function">length</a> <a id="5244" href="Reflection.Utils.TCI.html#5160" class="Bound">l</a><a id="5245" class="Symbol">)</a> <a id="5247" href="Reflection.Utils.TCI.html#5160" class="Bound">l</a><a id="5248" class="Symbol">)</a> <a id="5250" class="Symbol">(λ</a> <a id="5253" href="Reflection.Utils.TCI.html#5253" class="Bound">_</a> <a id="5255" class="Symbol">→</a> <a id="5257" href="Class.MonadTC.html#11200" class="Function">debugLog1</a> <a id="5267" class="String">&quot;Error while printing the context!&quot;</a><a id="5302" class="Symbol">)</a>
  <a id="5306" href="Class.MonadError.html#381" class="Field">catch</a> <a id="5312" class="Symbol">(</a><a id="5313" class="Keyword">do</a>
    <a id="5320" href="Reflection.Utils.TCI.html#5320" class="Bound">goalTy</a> <a id="5327" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="5329" href="Class.MonadTC.html#11510" class="Function">goalTy</a>
    <a id="5340" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="5349" class="Symbol">(</a><a id="5350" class="String">&quot;  ⊢ &quot;</a> <a id="5357" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5360" href="Reflection.Utils.TCI.html#5320" class="Bound">goalTy</a> <a id="5367" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5370" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5372" class="Symbol">))</a>
    <a id="5379" class="Symbol">λ</a> <a id="5381" href="Reflection.Utils.TCI.html#5381" class="Bound">_</a> <a id="5383" class="Symbol">→</a> <a id="5385" class="Keyword">do</a>
      <a id="5394" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="5399" href="Reflection.Utils.TCI.html#5399" class="Bound">t</a> <a id="5401" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="5403" href="Class.MonadReader.html#400" class="Function">reader</a> <a id="5410" href="Class.MonadTC.html#1026" class="Field">TCEnv.goal</a>
        <a id="5429" class="Keyword">where</a> <a id="5435" class="CatchallClause Symbol">_</a> <a id="5437" class="Symbol">→</a> <a id="5439" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="5446" class="String">&quot;Bug in logContext!&quot;</a>
      <a id="5473" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="5482" class="Symbol">(</a><a id="5483" class="String">&quot;Error while infering the goal type! Goal: &quot;</a> <a id="5528" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5531" href="Reflection.Utils.TCI.html#5399" class="Bound">t</a> <a id="5533" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5536" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5538" class="Symbol">)</a>
  <a id="5542" class="Keyword">where</a>
    <a id="5552" href="Reflection.Utils.TCI.html#5552" class="Function">helper</a> <a id="5559" class="Symbol">:</a> <a id="5561" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5563" class="Symbol">→</a> <a id="5565" href="Reflection.AST.Term.html#1887" class="Function">Telescope</a> <a id="5575" class="Symbol">→</a> <a id="5577" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5579" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
    <a id="5585" href="Reflection.Utils.TCI.html#5552" class="Function">helper</a> <a id="5592" href="Reflection.Utils.TCI.html#5592" class="Bound">n</a> <a id="5594" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5597" class="Symbol">=</a> <a id="5599" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="5606" class="Symbol">_</a>
    <a id="5612" href="Reflection.Utils.TCI.html#5552" class="Function">helper</a> <a id="5619" href="Reflection.Utils.TCI.html#5619" class="Bound">n</a> <a id="5621" class="Symbol">((_</a> <a id="5625" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5627" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="5631" class="Symbol">_</a> <a id="5633" href="Reflection.Utils.TCI.html#5633" class="Bound">t</a><a id="5634" class="Symbol">)</a> <a id="5636" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5638" href="Reflection.Utils.TCI.html#5638" class="Bound">l</a><a id="5639" class="Symbol">)</a> <a id="5641" class="Symbol">=</a> <a id="5643" class="Keyword">do</a>
      <a id="5652" href="Reflection.Utils.TCI.html#5552" class="Function">helper</a> <a id="5659" href="Reflection.Utils.TCI.html#5619" class="Bound">n</a> <a id="5661" href="Reflection.Utils.TCI.html#5638" class="Bound">l</a>
      <a id="5669" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="5678" class="Symbol">(</a><a id="5679" class="String">&quot;  &quot;</a> <a id="5684" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5687" href="Reflection.Syntax.html#1576" class="InductiveConstructor">♯</a> <a id="5689" class="Symbol">(</a><a id="5690" href="Reflection.Utils.TCI.html#5619" class="Bound">n</a> <a id="5692" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5694" class="Symbol">(</a><a id="5695" href="Data.List.Base.html#4746" class="Function">length</a> <a id="5702" href="Reflection.Utils.TCI.html#5638" class="Bound">l</a> <a id="5704" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="5706" class="Number">1</a><a id="5707" class="Symbol">))</a> <a id="5710" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5713" class="String">&quot; : &quot;</a> <a id="5719" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5722" href="Reflection.Utils.Substitute.html#3801" class="Function">mapVars</a> <a id="5730" class="Symbol">(</a><a id="5731" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">_+</a> <a id="5734" class="Symbol">(</a><a id="5735" href="Reflection.Utils.TCI.html#5619" class="Bound">n</a> <a id="5737" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5739" href="Data.List.Base.html#4746" class="Function">length</a> <a id="5746" href="Reflection.Utils.TCI.html#5638" class="Bound">l</a><a id="5747" class="Symbol">))</a> <a id="5750" href="Reflection.Utils.TCI.html#5633" class="Bound">t</a> <a id="5752" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5755" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5757" class="Symbol">)</a>

<a id="logCurrentContext"></a><a id="5760" href="Reflection.Utils.TCI.html#5760" class="Function">logCurrentContext</a> <a id="5778" class="Symbol">:</a> <a id="5780" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5782" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="5784" href="Reflection.Utils.TCI.html#5760" class="Function">logCurrentContext</a> <a id="5802" class="Symbol">=</a> <a id="5804" href="Class.MonadTC.html#11367" class="Function">markDontFail</a> <a id="5817" class="String">&quot;logCurrentContext&quot;</a> <a id="5837" class="Symbol">(</a><a id="5838" href="Reflection.Utils.TCI.html#5120" class="Function">logContext</a> <a id="5849" href="Class.Monad.Core.html#426" class="Function Operator">=&lt;&lt;</a> <a id="5853" href="Class.MonadTC.html#10437" class="Function">getContext</a><a id="5863" class="Symbol">)</a>

<a id="inDebugPath"></a><a id="5866" href="Reflection.Utils.TCI.html#5866" class="Function">inDebugPath</a> <a id="5878" class="Symbol">:</a> <a id="5880" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="5887" class="Symbol">→</a> <a id="5889" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5891" href="Meta.Prelude.html#195" class="Generalizable">A</a> <a id="5893" class="Symbol">→</a> <a id="5895" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="5897" href="Meta.Prelude.html#195" class="Generalizable">A</a>
<a id="5899" href="Reflection.Utils.TCI.html#5866" class="Function">inDebugPath</a> <a id="5911" href="Reflection.Utils.TCI.html#5911" class="Bound">path</a> <a id="5916" href="Reflection.Utils.TCI.html#5916" class="Bound">x</a> <a id="5918" class="Symbol">=</a> <a id="5920" href="Class.MonadTC.html#8802" class="Function">withAppendDebugPath</a> <a id="5940" href="Reflection.Utils.TCI.html#5911" class="Bound">path</a> <a id="5945" class="Keyword">do</a>
  <a id="5950" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="5959" class="Symbol">((</a><a id="5961" class="String">&quot;*****&quot;</a> <a id="5969" href="Data.String.Base.html#3151" class="Function Operator">&lt;+&gt;</a> <a id="5973" href="Reflection.Utils.TCI.html#5911" class="Bound">path</a> <a id="5978" href="Data.String.Base.html#3151" class="Function Operator">&lt;+&gt;</a> <a id="5982" class="String">&quot;*****&quot;</a><a id="5989" class="Symbol">)</a> <a id="5991" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="5994" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5996" class="Symbol">)</a>
  <a id="6000" class="Comment">-- This throws an internal error if the macro is run in a type signature</a>
  <a id="6075" class="Comment">-- (Agda issue #7187)</a>
  <a id="6099" class="Comment">-- logCurrentContext</a>
  <a id="6122" href="Reflection.Utils.TCI.html#5916" class="Bound">x</a>

<a id="viewAndReduceTy"></a><a id="6125" href="Reflection.Utils.TCI.html#6125" class="Function">viewAndReduceTy</a> <a id="6141" class="Symbol">:</a> <a id="6143" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="6148" class="Symbol">→</a> <a id="6150" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6152" href="Reflection.Utils.Core.html#536" class="Function">TypeView</a>
<a id="6161" href="Reflection.Utils.TCI.html#6125" class="Function">viewAndReduceTy</a> <a id="6177" href="Reflection.Utils.TCI.html#6177" class="Bound">ty</a> <a id="6180" class="Symbol">=</a> <a id="6182" href="Reflection.Utils.TCI.html#6251" class="Function">helper</a> <a id="6189" href="Reflection.Utils.TCI.html#6177" class="Bound">ty</a> <a id="6192" href="Class.Monad.Core.html#426" class="Function Operator">=&lt;&lt;</a> <a id="6196" class="Symbol">(</a><a id="6197" href="Data.List.Base.html#4746" class="Function">length</a> <a id="6204" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="6206" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="6212" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="6214" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a><a id="6220" class="Symbol">)</a> <a id="6222" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="6226" href="Class.MonadTC.html#1817" class="Field">normalise</a> <a id="6236" href="Reflection.Utils.TCI.html#6177" class="Bound">ty</a>
  <a id="6241" class="Keyword">where</a>
    <a id="6251" href="Reflection.Utils.TCI.html#6251" class="Function">helper</a> <a id="6258" class="Symbol">:</a> <a id="6260" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="6265" class="Symbol">→</a> <a id="6267" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6269" class="Symbol">→</a> <a id="6271" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6273" href="Reflection.Utils.Core.html#536" class="Function">TypeView</a>
    <a id="6286" href="Reflection.Utils.TCI.html#6251" class="Function">helper</a> <a id="6293" href="Reflection.Utils.TCI.html#6293" class="Bound">ty</a>    <a id="6299" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="6304" class="Symbol">=</a> <a id="6306" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="6313" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="6315" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="6322" href="Reflection.Utils.TCI.html#6293" class="Bound">ty</a>
    <a id="6329" href="Reflection.Utils.TCI.html#6251" class="Function">helper</a> <a id="6336" href="Reflection.Utils.TCI.html#6336" class="Bound">ty</a> <a id="6339" class="Symbol">(</a><a id="6340" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6344" href="Reflection.Utils.TCI.html#6344" class="Bound">k</a><a id="6345" class="Symbol">)</a> <a id="6347" class="Keyword">with</a> <a id="6352" href="Reflection.Utils.Core.html#577" class="Function">viewTy</a> <a id="6359" href="Reflection.Utils.TCI.html#6336" class="Bound">ty</a>
    <a id="6366" class="Symbol">...</a> <a id="6370" class="Symbol">|</a> <a id="6372" class="Symbol">(</a><a id="6373" href="Reflection.Utils.TCI.html#6373" class="Bound">tel</a> <a id="6377" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6379" href="Reflection.Utils.TCI.html#6379" class="Bound">ty&#39;</a><a id="6382" class="Symbol">)</a> <a id="6384" class="Symbol">=</a> <a id="6386" href="Class.MonadTC.html#10813" class="Function">extendContext&#39;</a> <a id="6401" class="Symbol">(</a><a id="6402" href="Data.List.Base.html#1612" class="Function">map</a> <a id="6406" class="Symbol">(λ</a> <a id="6409" class="Keyword">where</a> <a id="6415" class="Symbol">(</a><a id="6416" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="6420" href="Reflection.Utils.TCI.html#6420" class="Bound">s</a> <a id="6422" href="Reflection.Utils.TCI.html#6422" class="Bound">t</a><a id="6423" class="Symbol">)</a> <a id="6425" class="Symbol">→</a> <a id="6427" href="Reflection.Utils.TCI.html#6420" class="Bound">s</a> <a id="6429" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6431" href="Reflection.Utils.TCI.html#6422" class="Bound">t</a><a id="6432" class="Symbol">)</a> <a id="6434" href="Reflection.Utils.TCI.html#6373" class="Bound">tel</a><a id="6437" class="Symbol">)</a> <a id="6439" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="6441" class="Keyword">do</a>
      <a id="6450" href="Reflection.Utils.TCI.html#6450" class="Bound">rTy</a> <a id="6454" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6456" href="Class.MonadTC.html#1854" class="Field">reduce</a> <a id="6463" href="Reflection.Utils.TCI.html#6379" class="Bound">ty&#39;</a>
      <a id="6473" class="Symbol">(</a><a id="6474" href="Reflection.Utils.TCI.html#6474" class="Bound">tel&#39;</a> <a id="6479" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6481" href="Reflection.Utils.TCI.html#6481" class="Bound">rTy&#39;</a><a id="6485" class="Symbol">)</a> <a id="6487" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6489" href="Reflection.Utils.TCI.html#6251" class="Function">helper</a> <a id="6496" href="Reflection.Utils.TCI.html#6450" class="Bound">rTy</a> <a id="6500" class="Bound">k</a>
      <a id="6508" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="6515" class="Symbol">(</a><a id="6516" href="Reflection.Utils.TCI.html#6373" class="Bound">tel</a> <a id="6520" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="6523" href="Reflection.Utils.TCI.html#6474" class="Bound">tel&#39;</a> <a id="6528" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6530" href="Reflection.Utils.TCI.html#6481" class="Bound">rTy&#39;</a><a id="6534" class="Symbol">)</a>

<a id="getType&#39;"></a><a id="6537" href="Reflection.Utils.TCI.html#6537" class="Function">getType&#39;</a> <a id="6546" class="Symbol">:</a> <a id="6548" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6553" class="Symbol">→</a> <a id="6555" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6557" href="Reflection.Utils.Core.html#536" class="Function">TypeView</a>
<a id="6566" href="Reflection.Utils.TCI.html#6537" class="Function">getType&#39;</a> <a id="6575" href="Reflection.Utils.TCI.html#6575" class="Bound">n</a> <a id="6577" class="Symbol">=</a> <a id="6579" href="Reflection.Utils.TCI.html#6125" class="Function">viewAndReduceTy</a> <a id="6595" href="Class.Monad.Core.html#426" class="Function Operator">=&lt;&lt;</a> <a id="6599" href="Class.MonadTC.html#2185" class="Field">getType</a> <a id="6607" href="Reflection.Utils.TCI.html#6575" class="Bound">n</a>

<a id="getTypeDB"></a><a id="6610" href="Reflection.Utils.TCI.html#6610" class="Function">getTypeDB</a> <a id="6620" class="Symbol">:</a> <a id="6622" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6624" class="Symbol">→</a> <a id="6626" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6628" href="Reflection.Utils.Core.html#536" class="Function">TypeView</a>
<a id="6637" href="Reflection.Utils.TCI.html#6610" class="Function">getTypeDB</a> <a id="6647" href="Reflection.Utils.TCI.html#6647" class="Bound">n</a> <a id="6649" class="Symbol">=</a> <a id="6651" href="Reflection.Utils.TCI.html#6125" class="Function">viewAndReduceTy</a> <a id="6667" href="Class.Monad.Core.html#426" class="Function Operator">=&lt;&lt;</a> <a id="6671" href="Class.MonadTC.html#1736" class="Field">inferType</a> <a id="6681" class="Symbol">(</a><a id="6682" href="Reflection.Syntax.html#1576" class="InductiveConstructor">♯</a> <a id="6684" href="Reflection.Utils.TCI.html#6647" class="Bound">n</a><a id="6685" class="Symbol">)</a>

<a id="getDataDef"></a><a id="6688" href="Reflection.Utils.TCI.html#6688" class="Function">getDataDef</a> <a id="6699" class="Symbol">:</a> <a id="6701" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="6706" class="Symbol">→</a> <a id="6708" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="6710" href="Reflection.Utils.Core.html#1294" class="Record">DataDef</a>
<a id="6718" href="Reflection.Utils.TCI.html#6688" class="Function">getDataDef</a> <a id="6729" href="Reflection.Utils.TCI.html#6729" class="Bound">n</a> <a id="6731" class="Symbol">=</a> <a id="6733" href="Reflection.Utils.TCI.html#5866" class="Function">inDebugPath</a> <a id="6745" class="String">&quot;getDataDef&quot;</a> <a id="6758" class="Keyword">do</a>
  <a id="6763" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="6772" class="Symbol">(</a><a id="6773" class="String">&quot;Find details for datatype: &quot;</a> <a id="6803" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="6806" href="Reflection.Utils.TCI.html#6729" class="Bound">n</a> <a id="6808" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="6811" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="6813" class="Symbol">)</a>
  <a id="6817" class="Symbol">(</a><a id="6818" href="Agda.Builtin.Reflection.html#7558" class="InductiveConstructor">data-type</a> <a id="6828" href="Reflection.Utils.TCI.html#6828" class="Bound">pars</a> <a id="6833" href="Reflection.Utils.TCI.html#6833" class="Bound">cs</a><a id="6835" class="Symbol">)</a> <a id="6837" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6839" href="Class.MonadTC.html#2222" class="Field">getDefinition</a> <a id="6853" href="Reflection.Utils.TCI.html#6729" class="Bound">n</a>
    <a id="6859" class="Keyword">where</a> <a id="6865" class="CatchallClause Symbol">_</a> <a id="6867" class="Symbol">→</a> <a id="6869" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="6876" class="String">&quot;Not a data definition!&quot;</a>
  <a id="6903" href="Class.MonadTC.html#8443" class="Function">debugLogᵐ</a> <a id="6913" class="Symbol">(</a><a id="6914" class="String">&quot;Constructor names: &quot;</a> <a id="6936" href="Class.MonadTC.html#7691" class="Function Operator">∷ᵈᵐ</a> <a id="6940" href="Reflection.Utils.TCI.html#6833" class="Bound">cs</a> <a id="6943" href="Class.MonadTC.html#7833" class="Function Operator">ᵛ</a> <a id="6945" href="Class.MonadTC.html#7691" class="Function Operator">∷ᵈᵐ</a> <a id="6949" href="Class.MonadTC.html#7628" class="Function">[]ᵐ</a><a id="6952" class="Symbol">)</a>
  <a id="6956" href="Reflection.Utils.TCI.html#6956" class="Bound">cs&#39;</a> <a id="6960" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="6962" href="Class.Traversable.Core.html#587" class="Function">traverse</a> <a id="6971" class="Symbol">⦃</a> <a id="6973" href="Class.Functor.Instances.html#440" class="Function">Functor-List</a> <a id="6986" class="Symbol">⦄</a> <a id="6988" class="Symbol">(λ</a> <a id="6991" href="Reflection.Utils.TCI.html#6991" class="Bound">n</a> <a id="6993" class="Symbol">→</a> <a id="6995" class="Symbol">(</a><a id="6996" href="Reflection.Utils.TCI.html#6991" class="Bound">n</a> <a id="6998" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="7000" class="Symbol">)</a> <a id="7002" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7006" href="Reflection.Utils.TCI.html#6537" class="Function">getType&#39;</a> <a id="7015" href="Reflection.Utils.TCI.html#6991" class="Bound">n</a><a id="7016" class="Symbol">)</a> <a id="7018" href="Reflection.Utils.TCI.html#6833" class="Bound">cs</a>
  <a id="7023" href="Class.MonadTC.html#8443" class="Function">debugLogᵐ</a> <a id="7033" class="Symbol">(</a><a id="7034" class="String">&quot;Result: &quot;</a> <a id="7045" href="Class.MonadTC.html#7691" class="Function Operator">∷ᵈᵐ</a> <a id="7049" href="Reflection.Utils.TCI.html#6956" class="Bound">cs&#39;</a> <a id="7053" href="Class.MonadTC.html#7908" class="Function Operator">ᵛⁿ</a> <a id="7056" href="Class.MonadTC.html#7691" class="Function Operator">∷ᵈᵐ</a> <a id="7060" href="Class.MonadTC.html#7628" class="Function">[]ᵐ</a><a id="7063" class="Symbol">)</a>
  <a id="7067" href="Reflection.Utils.TCI.html#7067" class="Bound">args</a> <a id="7072" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7074" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7080" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7084" href="Reflection.Utils.TCI.html#6537" class="Function">getType&#39;</a> <a id="7093" href="Reflection.Utils.TCI.html#6729" class="Bound">n</a>
  <a id="7097" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="7104" class="Keyword">record</a> <a id="7111" class="Symbol">{</a> <a id="7113" href="Reflection.Utils.Core.html#1326" class="Field">name</a> <a id="7118" class="Symbol">=</a> <a id="7120" href="Reflection.Utils.TCI.html#6729" class="Bound">n</a> <a id="7122" class="Symbol">;</a> <a id="7124" href="Reflection.Utils.Core.html#1342" class="Field">constructors</a> <a id="7137" class="Symbol">=</a> <a id="7139" href="Reflection.Utils.TCI.html#6956" class="Bound">cs&#39;</a> <a id="7143" class="Symbol">;</a> <a id="7145" href="Reflection.Utils.Core.html#1384" class="Field">params</a> <a id="7152" class="Symbol">=</a> <a id="7154" href="Data.List.Base.html#8389" class="Function">take</a> <a id="7159" href="Reflection.Utils.TCI.html#6828" class="Bound">pars</a> <a id="7164" href="Reflection.Utils.TCI.html#7067" class="Bound">args</a> <a id="7169" class="Symbol">;</a> <a id="7171" href="Reflection.Utils.Core.html#1419" class="Field">indices</a> <a id="7179" class="Symbol">=</a> <a id="7181" href="Data.List.Base.html#8509" class="Function">drop</a> <a id="7186" href="Reflection.Utils.TCI.html#6828" class="Bound">pars</a> <a id="7191" href="Reflection.Utils.TCI.html#7067" class="Bound">args</a> <a id="7196" class="Symbol">}</a>

<a id="getRecordDef"></a><a id="7199" href="Reflection.Utils.TCI.html#7199" class="Function">getRecordDef</a> <a id="7212" class="Symbol">:</a> <a id="7214" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7219" class="Symbol">→</a> <a id="7221" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7223" href="Reflection.Utils.Core.html#1459" class="Record">RecordDef</a>
<a id="7233" href="Reflection.Utils.TCI.html#7199" class="Function">getRecordDef</a> <a id="7246" href="Reflection.Utils.TCI.html#7246" class="Bound">n</a> <a id="7248" class="Symbol">=</a> <a id="7250" class="Keyword">do</a>
  <a id="7255" class="Symbol">(</a><a id="7256" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record′</a> <a id="7264" href="Reflection.Utils.TCI.html#7264" class="Bound">c</a> <a id="7266" href="Reflection.Utils.TCI.html#7266" class="Bound">fs</a><a id="7268" class="Symbol">)</a> <a id="7270" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7272" href="Class.MonadTC.html#2222" class="Field">getDefinition</a> <a id="7286" href="Reflection.Utils.TCI.html#7246" class="Bound">n</a>
    <a id="7292" class="Keyword">where</a> <a id="7298" class="CatchallClause Symbol">_</a> <a id="7300" class="Symbol">→</a> <a id="7302" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="7309" class="String">&quot;Not a record definition!&quot;</a>
  <a id="7338" href="Reflection.Utils.TCI.html#7338" class="Bound">args</a> <a id="7343" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7345" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7351" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7355" href="Reflection.Utils.TCI.html#6537" class="Function">getType&#39;</a> <a id="7364" href="Reflection.Utils.TCI.html#7246" class="Bound">n</a>
  <a id="7368" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="7375" class="Symbol">(</a><a id="7376" class="Keyword">record</a> <a id="7383" class="Symbol">{</a> <a id="7385" href="Reflection.Utils.Core.html#1493" class="Field">name</a> <a id="7390" class="Symbol">=</a> <a id="7392" href="Reflection.Utils.TCI.html#7264" class="Bound">c</a> <a id="7394" class="Symbol">;</a> <a id="7396" href="Reflection.Utils.Core.html#1509" class="Field">fields</a> <a id="7403" class="Symbol">=</a> <a id="7405" href="Reflection.Utils.TCI.html#7266" class="Bound">fs</a> <a id="7408" class="Symbol">;</a> <a id="7410" href="Reflection.Utils.Core.html#1538" class="Field">params</a> <a id="7417" class="Symbol">=</a> <a id="7419" href="Reflection.Utils.TCI.html#7338" class="Bound">args</a> <a id="7424" class="Symbol">})</a>

<a id="getDataOrRecordDef"></a><a id="7428" href="Reflection.Utils.TCI.html#7428" class="Function">getDataOrRecordDef</a> <a id="7447" class="Symbol">:</a> <a id="7449" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7454" class="Symbol">→</a> <a id="7456" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7458" class="Symbol">(</a><a id="7459" href="Reflection.Utils.Core.html#1294" class="Record">DataDef</a> <a id="7467" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="7469" href="Reflection.Utils.Core.html#1459" class="Record">RecordDef</a><a id="7478" class="Symbol">)</a>
<a id="7480" href="Reflection.Utils.TCI.html#7428" class="Function">getDataOrRecordDef</a> <a id="7499" href="Reflection.Utils.TCI.html#7499" class="Bound">n</a> <a id="7501" class="Symbol">=</a>
  <a id="7505" href="Class.MonadError.html#381" class="Field">catch</a> <a id="7511" class="Symbol">(</a><a id="7512" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="7517" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7521" href="Reflection.Utils.TCI.html#6688" class="Function">getDataDef</a> <a id="7532" href="Reflection.Utils.TCI.html#7499" class="Bound">n</a><a id="7533" class="Symbol">)</a>
    <a id="7539" class="Symbol">λ</a> <a id="7541" href="Reflection.Utils.TCI.html#7541" class="Bound">_</a> <a id="7543" class="Symbol">→</a> <a id="7545" href="Class.MonadError.html#381" class="Field">catch</a> <a id="7551" class="Symbol">(</a><a id="7552" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="7557" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7561" href="Reflection.Utils.TCI.html#7199" class="Function">getRecordDef</a> <a id="7574" href="Reflection.Utils.TCI.html#7499" class="Bound">n</a><a id="7575" class="Symbol">)</a>
    <a id="7581" class="Symbol">λ</a> <a id="7583" href="Reflection.Utils.TCI.html#7583" class="Bound">_</a> <a id="7585" class="Symbol">→</a> <a id="7587" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="7594" class="String">&quot;Neither a data not a record definition!&quot;</a>

<a id="getParams"></a><a id="7637" href="Reflection.Utils.TCI.html#7637" class="Function">getParams</a> <a id="7647" class="Symbol">:</a> <a id="7649" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7654" class="Symbol">→</a> <a id="7656" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7658" class="Symbol">(</a><a id="7659" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7664" class="Symbol">(</a><a id="7665" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="7669" class="Symbol">(</a><a id="7670" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="7674" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="7678" class="Symbol">)))</a>
<a id="7682" href="Reflection.Utils.TCI.html#7637" class="Function">getParams</a> <a id="7692" href="Reflection.Utils.TCI.html#7692" class="Bound">n</a> <a id="7694" class="Symbol">=</a> <a id="7696" href="Data.Sum.Base.html#811" class="Function Operator">Data.Sum.[</a> <a id="7707" href="Reflection.Utils.Core.html#1384" class="Field">DataDef.params</a> <a id="7722" href="Data.Sum.Base.html#811" class="Function Operator">,</a> <a id="7724" href="Reflection.Utils.Core.html#1538" class="Field">RecordDef.params</a> <a id="7741" href="Data.Sum.Base.html#811" class="Function Operator">]</a> <a id="7743" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7747" href="Reflection.Utils.TCI.html#7428" class="Function">getDataOrRecordDef</a> <a id="7766" href="Reflection.Utils.TCI.html#7692" class="Bound">n</a>

<a id="getParamsAndIndices"></a><a id="7769" href="Reflection.Utils.TCI.html#7769" class="Function">getParamsAndIndices</a> <a id="7789" class="Symbol">:</a> <a id="7791" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="7796" class="Symbol">→</a> <a id="7798" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7800" class="Symbol">(</a><a id="7801" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7806" class="Symbol">(</a><a id="7807" href="Agda.Builtin.Reflection.html#4249" class="Datatype">Abs</a> <a id="7811" class="Symbol">(</a><a id="7812" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="7816" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="7820" class="Symbol">)))</a>
<a id="7824" href="Reflection.Utils.TCI.html#7769" class="Function">getParamsAndIndices</a> <a id="7844" href="Reflection.Utils.TCI.html#7844" class="Bound">n</a> <a id="7846" class="Symbol">=</a>
  <a id="7850" href="Data.Sum.Base.html#811" class="Function Operator">Data.Sum.[</a> <a id="7861" class="Symbol">(λ</a> <a id="7864" href="Reflection.Utils.TCI.html#7864" class="Bound">d</a> <a id="7866" class="Symbol">→</a> <a id="7868" href="Reflection.Utils.Core.html#1384" class="Field">DataDef.params</a> <a id="7883" href="Reflection.Utils.TCI.html#7864" class="Bound">d</a> <a id="7885" href="Data.List.Base.html#1712" class="Function Operator">++</a> <a id="7888" href="Reflection.Utils.Core.html#1419" class="Field">DataDef.indices</a> <a id="7904" href="Reflection.Utils.TCI.html#7864" class="Bound">d</a><a id="7905" class="Symbol">)</a> <a id="7907" href="Data.Sum.Base.html#811" class="Function Operator">,</a> <a id="7909" href="Reflection.Utils.Core.html#1538" class="Field">RecordDef.params</a> <a id="7926" href="Data.Sum.Base.html#811" class="Function Operator">]</a> <a id="7928" href="Class.Functor.Core.html#242" class="Field Operator">&lt;$&gt;</a> <a id="7932" href="Reflection.Utils.TCI.html#7428" class="Function">getDataOrRecordDef</a> <a id="7951" href="Reflection.Utils.TCI.html#7844" class="Bound">n</a>

<a id="getFuel"></a><a id="7954" href="Reflection.Utils.TCI.html#7954" class="Function">getFuel</a> <a id="7962" class="Symbol">:</a> <a id="7964" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="7971" class="Symbol">→</a> <a id="7973" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="7975" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="7977" href="Reflection.Utils.TCI.html#7954" class="Function">getFuel</a> <a id="7985" href="Reflection.Utils.TCI.html#7985" class="Bound">s</a> <a id="7987" class="Symbol">=</a> <a id="7989" class="Keyword">do</a>
  <a id="7994" href="Reflection.Utils.TCI.html#7994" class="Bound">fuels</a> <a id="8000" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="8002" href="Class.MonadReader.html#400" class="Function">reader</a> <a id="8009" class="Symbol">(λ</a> <a id="8012" class="Keyword">where</a> <a id="8018" class="Keyword">record</a> <a id="8025" class="Symbol">{</a> <a id="8027" href="Class.MonadTC.html#1059" class="Field">options</a> <a id="8035" class="Symbol">=</a> <a id="8037" class="Keyword">record</a> <a id="8044" class="Symbol">{</a> <a id="8046" href="Class.MonadTC.html#679" class="Field">fuel</a> <a id="8051" class="Symbol">=</a> <a id="8053" href="Reflection.Utils.TCI.html#8053" class="Bound">f</a> <a id="8055" class="Symbol">}</a> <a id="8057" class="Symbol">}</a> <a id="8059" class="Symbol">→</a> <a id="8061" href="Reflection.Utils.TCI.html#8053" class="Bound">f</a> <a id="8063" class="Symbol">)</a>
  <a id="8067" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="8072" href="Meta.Prelude.html#1085" class="Function">lookupᵇ</a> <a id="8080" class="Symbol">(λ</a> <a id="8083" href="Reflection.Utils.TCI.html#8083" class="Bound">s</a> <a id="8085" href="Reflection.Utils.TCI.html#8085" class="Bound">s&#39;</a> <a id="8088" class="Symbol">→</a> <a id="8090" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="8092" href="Reflection.Utils.TCI.html#8083" class="Bound">s</a> <a id="8094" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="8096" href="Reflection.Utils.TCI.html#8085" class="Bound">s&#39;</a> <a id="8099" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a><a id="8100" class="Symbol">)</a> <a id="8102" href="Reflection.Utils.TCI.html#7994" class="Bound">fuels</a> <a id="8108" href="Reflection.Utils.TCI.html#7985" class="Bound">s</a> <a id="8110" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="8113" class="Symbol">λ</a> <a id="8115" class="Keyword">where</a>
    <a id="8125" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>  <a id="8134" class="Symbol">→</a> <a id="8136" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="8143" class="Symbol">(</a><a id="8144" class="String">&quot;Key&quot;</a> <a id="8150" href="Data.String.Base.html#3151" class="Function Operator">&lt;+&gt;</a> <a id="8154" href="Reflection.Utils.TCI.html#7985" class="Bound">s</a> <a id="8156" href="Data.String.Base.html#3151" class="Function Operator">&lt;+&gt;</a> <a id="8160" class="String">&quot;doesn&#39;t exist in the fuels map&quot;</a><a id="8192" class="Symbol">)</a>
    <a id="8198" class="Symbol">(</a><a id="8199" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="8204" href="Reflection.Utils.TCI.html#8204" class="Bound">f</a><a id="8205" class="Symbol">)</a> <a id="8207" class="Symbol">→</a> <a id="8209" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="8216" href="Reflection.Utils.TCI.html#8204" class="Bound">f</a>

<a id="isSort"></a><a id="8219" href="Reflection.Utils.TCI.html#8219" class="Function">isSort</a> <a id="8226" class="Symbol">:</a> <a id="8228" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8233" class="Symbol">→</a> <a id="8235" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8237" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="8242" href="Reflection.Utils.TCI.html#8219" class="Function">isSort</a> <a id="8249" href="Reflection.Utils.TCI.html#8249" class="Bound">t</a> <a id="8251" class="Symbol">=</a> <a id="8253" class="Keyword">do</a>
  <a id="8258" class="Symbol">(</a><a id="8259" href="Agda.Builtin.Reflection.html#5477" class="InductiveConstructor">sort</a> <a id="8264" class="Symbol">_)</a> <a id="8267" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="8269" href="Class.MonadTC.html#1817" class="Field">normalise</a> <a id="8279" href="Reflection.Utils.TCI.html#8249" class="Bound">t</a>
    <a id="8285" class="Keyword">where</a> <a id="8291" class="CatchallClause Symbol">_</a> <a id="8293" class="Symbol">→</a> <a id="8295" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="8302" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
  <a id="8310" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="8317" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>

<a id="isNArySort"></a><a id="8323" href="Reflection.Utils.TCI.html#8323" class="Function">isNArySort</a> <a id="8334" class="Symbol">:</a> <a id="8336" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8341" class="Symbol">→</a> <a id="8343" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8345" class="Symbol">(</a><a id="8346" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="8351" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="8353" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="8354" class="Symbol">)</a>
<a id="8356" href="Reflection.Utils.TCI.html#8323" class="Function">isNArySort</a> <a id="8367" href="Reflection.Utils.TCI.html#8367" class="Bound">t</a> <a id="8369" class="Symbol">=</a> <a id="8371" class="Keyword">do</a>
  <a id="8376" class="Symbol">(</a><a id="8377" href="Reflection.Utils.TCI.html#8377" class="Bound">tel</a> <a id="8381" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8383" href="Reflection.Utils.TCI.html#8383" class="Bound">ty</a><a id="8385" class="Symbol">)</a> <a id="8387" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="8389" href="Reflection.Utils.TCI.html#6125" class="Function">viewAndReduceTy</a> <a id="8405" href="Reflection.Utils.TCI.html#8367" class="Bound">t</a>
  <a id="8409" href="Reflection.Utils.TCI.html#8409" class="Bound">b</a> <a id="8411" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="8413" href="Reflection.Utils.TCI.html#8219" class="Function">isSort</a> <a id="8420" href="Reflection.Utils.TCI.html#8383" class="Bound">ty</a>
  <a id="8425" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="8432" class="Symbol">(</a><a id="8433" href="Reflection.Utils.TCI.html#8409" class="Bound">b</a> <a id="8435" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8437" href="Data.List.Base.html#4746" class="Function">length</a> <a id="8444" href="Reflection.Utils.TCI.html#8377" class="Bound">tel</a><a id="8447" class="Symbol">)</a>

<a id="isDefT"></a><a id="8450" href="Reflection.Utils.TCI.html#8450" class="Function">isDefT</a> <a id="8457" class="Symbol">:</a> <a id="8459" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="8464" class="Symbol">→</a> <a id="8466" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8471" class="Symbol">→</a> <a id="8473" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8475" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="8480" href="Reflection.Utils.TCI.html#8450" class="Function">isDefT</a> <a id="8487" href="Reflection.Utils.TCI.html#8487" class="Bound">n</a> <a id="8489" href="Reflection.Utils.TCI.html#8489" class="Bound">t</a> <a id="8491" class="Symbol">=</a> <a id="8493" class="Keyword">do</a>
  <a id="8498" class="Symbol">(</a><a id="8499" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="8503" href="Reflection.Utils.TCI.html#8503" class="Bound">n&#39;</a> <a id="8506" class="Symbol">_)</a> <a id="8509" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="8511" href="Class.MonadTC.html#1817" class="Field">normalise</a> <a id="8521" href="Reflection.Utils.TCI.html#8489" class="Bound">t</a>
    <a id="8527" class="Keyword">where</a> <a id="8533" class="CatchallClause Symbol">_</a> <a id="8535" class="Symbol">→</a> <a id="8537" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="8544" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
  <a id="8552" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="8559" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="8561" href="Reflection.Utils.TCI.html#8487" class="Bound">n</a> <a id="8563" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="8565" href="Reflection.Utils.TCI.html#8503" class="Bound">n&#39;</a> <a id="8568" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="8571" class="Comment">-- run a computation that returns a term, resetting the TC state but</a>
<a id="8640" class="Comment">-- ensuring that the term doesn&#39;t contain any metavariables</a>
<a id="withSafeReset"></a><a id="8700" href="Reflection.Utils.TCI.html#8700" class="Function">withSafeReset</a> <a id="8714" class="Symbol">:</a> <a id="8716" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8718" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="8723" class="Symbol">→</a> <a id="8725" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="8727" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="8732" href="Reflection.Utils.TCI.html#8700" class="Function">withSafeReset</a> <a id="8746" href="Reflection.Utils.TCI.html#8746" class="Bound">x</a> <a id="8748" class="Symbol">=</a> <a id="8750" href="Class.MonadTC.html#2527" class="Function">runAndReset</a> <a id="8762" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="8764" class="Keyword">do</a>
  <a id="8769" href="Reflection.Utils.TCI.html#8769" class="Bound">t</a> <a id="8771" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="8773" href="Reflection.Utils.TCI.html#8746" class="Bound">x</a>
  <a id="8777" class="Keyword">let</a> <a id="8781" href="Reflection.Utils.TCI.html#8781" class="Bound">m</a> <a id="8783" class="Symbol">=</a> <a id="8785" href="Reflection.Utils.Metas.html#246" class="Function">findMetas</a> <a id="8795" href="Reflection.Utils.TCI.html#8769" class="Bound">t</a>
  <a id="8799" href="Data.Bool.Base.html#1515" class="Function Operator">if</a> <a id="8802" href="Data.List.Base.html#4681" class="Function">null</a> <a id="8807" href="Reflection.Utils.TCI.html#8781" class="Bound">m</a>
    <a id="8813" href="Data.Bool.Base.html#1515" class="Function Operator">then</a> <a id="8818" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="8825" href="Reflection.Utils.TCI.html#8769" class="Bound">t</a>
    <a id="8831" href="Data.Bool.Base.html#1515" class="Function Operator">else</a> <a id="8836" class="Keyword">do</a>
      <a id="8845" href="Class.MonadTC.html#8443" class="Function">debugLogᵐ</a> <a id="8855" class="Symbol">(</a><a id="8856" class="String">&quot;Remaining metavariables:&quot;</a> <a id="8883" href="Class.MonadTC.html#7691" class="Function Operator">∷ᵈᵐ</a> <a id="8887" href="Reflection.Utils.TCI.html#8781" class="Bound">m</a> <a id="8889" href="Class.MonadTC.html#7908" class="Function Operator">ᵛⁿ</a> <a id="8892" href="Class.MonadTC.html#7691" class="Function Operator">∷ᵈᵐ</a> <a id="8896" href="Class.MonadTC.html#7628" class="Function">[]ᵐ</a><a id="8899" class="Symbol">)</a>
      <a id="8907" href="Class.MonadTC.html#8133" class="Function">debugLog</a> <a id="8916" class="Symbol">(</a><a id="8917" class="String">&quot;In term: &quot;</a> <a id="8929" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="8932" href="Reflection.Utils.TCI.html#8769" class="Bound">t</a> <a id="8934" href="Reflection.Debug.html#1067" class="Function Operator">∷ᵈ</a> <a id="8937" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8939" class="Symbol">)</a>
      <a id="8947" href="Class.MonadTC.html#11131" class="Function">error1</a> <a id="8954" class="String">&quot;Unsolved metavariables remaining in withSafeReset!&quot;</a>

<a id="9008" class="Comment">-- apply a list of terms to a name, picking the correct constructor of the term datatype &amp; visibility</a>
<a id="applyWithVisibility"></a><a id="9110" href="Reflection.Utils.TCI.html#9110" class="Function">applyWithVisibility</a> <a id="9130" class="Symbol">:</a> <a id="9132" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="9137" class="Symbol">→</a> <a id="9139" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9144" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="9149" class="Symbol">→</a> <a id="9151" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="9153" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="9158" href="Reflection.Utils.TCI.html#9110" class="Function">applyWithVisibility</a> <a id="9178" href="Reflection.Utils.TCI.html#9178" class="Bound">n</a> <a id="9180" href="Reflection.Utils.TCI.html#9180" class="Bound">l</a> <a id="9182" class="Symbol">=</a> <a id="9184" class="Keyword">do</a>
  <a id="9189" class="Symbol">(</a><a id="9190" href="Reflection.Utils.TCI.html#9190" class="Bound">argTys</a> <a id="9197" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9199" class="Symbol">_)</a> <a id="9202" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="9204" href="Reflection.Utils.TCI.html#6537" class="Function">getType&#39;</a> <a id="9213" href="Reflection.Utils.TCI.html#9178" class="Bound">n</a>
  <a id="9217" href="Class.MonadTC.html#3114" class="Function">nameConstr</a> <a id="9228" href="Reflection.Utils.TCI.html#9178" class="Bound">n</a> <a id="9230" class="Symbol">(</a><a id="9231" href="Data.List.Base.html#2712" class="Function">zipWith</a> <a id="9239" class="Symbol">(λ</a> <a id="9242" class="Keyword">where</a> <a id="9248" class="Symbol">(</a><a id="9249" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="9253" class="Symbol">_</a> <a id="9255" class="Symbol">(</a><a id="9256" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="9260" href="Reflection.Utils.TCI.html#9260" class="Bound">i</a> <a id="9262" class="Symbol">_))</a> <a id="9266" class="Symbol">→</a> <a id="9268" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="9272" href="Reflection.Utils.TCI.html#9260" class="Bound">i</a><a id="9273" class="Symbol">)</a> <a id="9275" href="Reflection.Utils.TCI.html#9190" class="Bound">argTys</a> <a id="9282" href="Reflection.Utils.TCI.html#9180" class="Bound">l</a><a id="9283" class="Symbol">)</a>

<a id="applyWithVisibilityDB"></a><a id="9286" href="Reflection.Utils.TCI.html#9286" class="Function">applyWithVisibilityDB</a> <a id="9308" class="Symbol">:</a> <a id="9310" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="9312" class="Symbol">→</a> <a id="9314" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9319" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="9324" class="Symbol">→</a> <a id="9326" href="Reflection.Utils.TCI.html#256" class="Bound">M</a> <a id="9328" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="9333" href="Reflection.Utils.TCI.html#9286" class="Function">applyWithVisibilityDB</a> <a id="9355" href="Reflection.Utils.TCI.html#9355" class="Bound">n</a> <a id="9357" href="Reflection.Utils.TCI.html#9357" class="Bound">l</a> <a id="9359" class="Symbol">=</a> <a id="9361" class="Keyword">do</a>
  <a id="9366" class="Symbol">(</a><a id="9367" href="Reflection.Utils.TCI.html#9367" class="Bound">argTys</a> <a id="9374" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="9376" class="Symbol">_)</a> <a id="9379" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="9381" href="Reflection.Utils.TCI.html#6610" class="Function">getTypeDB</a> <a id="9391" href="Reflection.Utils.TCI.html#9355" class="Bound">n</a>
  <a id="9395" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="9402" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="9404" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="9408" href="Reflection.Utils.TCI.html#9355" class="Bound">n</a> <a id="9410" class="Symbol">(</a><a id="9411" href="Data.List.Base.html#2712" class="Function">zipWith</a> <a id="9419" class="Symbol">(λ</a> <a id="9422" class="Keyword">where</a> <a id="9428" class="Symbol">(</a><a id="9429" href="Agda.Builtin.Reflection.html#4285" class="InductiveConstructor">abs</a> <a id="9433" class="Symbol">_</a> <a id="9435" class="Symbol">(</a><a id="9436" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="9440" href="Reflection.Utils.TCI.html#9440" class="Bound">i</a> <a id="9442" class="Symbol">_))</a> <a id="9446" class="Symbol">→</a> <a id="9448" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="9452" href="Reflection.Utils.TCI.html#9440" class="Bound">i</a><a id="9453" class="Symbol">)</a> <a id="9455" href="Reflection.Utils.TCI.html#9367" class="Bound">argTys</a> <a id="9462" href="Reflection.Utils.TCI.html#9357" class="Bound">l</a><a id="9463" class="Symbol">)</a>
</pre></body></html>