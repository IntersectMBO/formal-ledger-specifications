<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Utxo</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--no-qualified-instances</a> <a id="38" class="Symbol">#-}</a>

<a id="43" class="Keyword">module</a> <a id="50" href="Ledger.Conway.Foreign.HSLedger.Utxo.html" class="Module">Ledger.Conway.Foreign.HSLedger.Utxo</a> <a id="86" class="Keyword">where</a>

<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="121" class="Keyword">open</a> <a id="126" class="Keyword">import</a> <a id="133" href="Ledger.Conway.Foreign.ExternalFunctions.html" class="Module">Ledger.Conway.Foreign.ExternalFunctions</a>

<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="203" class="Keyword">renaming</a> <a id="212" class="Symbol">(</a><a id="213" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="218" class="Symbol">to</a> <a id="221" class="Function Operator">_+ˢ_</a><a id="225" class="Symbol">)</a> <a id="227" class="Keyword">hiding</a> <a id="234" class="Symbol">(</a><a id="235" href="Data.String.Base.html#1626" class="Primitive">show</a><a id="239" class="Symbol">;</a> <a id="241" href="Data.String.Base.html#2489" class="Function">length</a><a id="247" class="Symbol">;</a> <a id="249" href="Data.String.Base.html#5404" class="Function">map</a><a id="252" class="Symbol">;</a> <a id="254" href="Data.String.Base.html#1591" class="Primitive">fromList</a><a id="262" class="Symbol">)</a>

<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Ledger.Conway.Foreign.HSLedger.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Core</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Ledger.Conway.Foreign.HSLedger.Certs.html" class="Module">Ledger.Conway.Foreign.HSLedger.Certs</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Ledger.Conway.Foreign.HSLedger.Transaction.html" class="Module">Ledger.Conway.Foreign.HSLedger.Transaction</a>

<a id="520" class="Keyword">open</a> <a id="525" class="Keyword">import</a> <a id="532" href="Foreign.Haskell.Coerce.html" class="Module">Foreign.Haskell.Coerce</a>

<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a> <a id="609" class="Keyword">hiding</a> <a id="616" class="Symbol">(</a><a id="617" href="Ledger.Conway.Specification.Transaction.html#4437" class="Record">TxWitnesses</a><a id="628" class="Symbol">;</a> <a id="630" href="Ledger.Conway.Specification.Transaction.html#6190" class="Function">refScripts</a><a id="640" class="Symbol">;</a> <a id="642" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a><a id="653" class="Symbol">;</a> <a id="655" href="Ledger.Core.Specification.Address.html#486" class="Function">isKeyHashObj</a><a id="667" class="Symbol">)</a>
<a id="669" class="Keyword">open</a> <a id="674" class="Keyword">import</a> <a id="681" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a> <a id="727" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2198" class="Function">DummyTransactionStructure</a> <a id="753" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2253" class="Function">DummyAbstractFunctions</a>
<a id="776" class="Keyword">open</a> <a id="781" class="Keyword">import</a> <a id="788" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="819" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2198" class="Function">DummyTransactionStructure</a> <a id="845" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2253" class="Function">DummyAbstractFunctions</a>
<a id="868" class="Keyword">open</a> <a id="873" class="Keyword">import</a> <a id="880" href="Ledger.Conway.Conformance.Utxow.html" class="Module">Ledger.Conway.Conformance.Utxow</a> <a id="912" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2198" class="Function">DummyTransactionStructure</a> <a id="938" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2253" class="Function">DummyAbstractFunctions</a>

<a id="962" class="Keyword">instance</a>
  <a id="HsTy-UTxOEnv"></a><a id="973" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#973" class="Function">HsTy-UTxOEnv</a> <a id="986" class="Symbol">=</a> <a id="988" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="999" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="1007" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="1009" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="1025" class="String">&quot;MkUTxOEnv&quot;</a>
                                    <a id="1073" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="1075" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="1087" class="String">&quot;ue&quot;</a>
  <a id="Conv-UTxOEnv"></a><a id="1094" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1094" class="Function">Conv-UTxOEnv</a> <a id="1107" class="Symbol">=</a> <a id="1109" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="1121" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a>

  <a id="HsTy-UTxOState"></a><a id="1132" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1132" class="Function">HsTy-UTxOState</a> <a id="1147" class="Symbol">=</a> <a id="1149" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="1160" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a> <a id="1170" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="1172" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="1188" class="String">&quot;MkUTxOState&quot;</a>
  <a id="Conv-UTxOState"></a><a id="1204" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1204" class="Function">Conv-UTxOState</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="1233" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a>

<a id="1244" class="Keyword">unquoteDecl</a> <a id="1256" class="Symbol">=</a> <a id="1258" class="Keyword">do</a>
  hsTypeAlias UTxO
  hsTypeAlias Redeemer

<a id="1304" class="Keyword">module</a> <a id="1311" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1311" class="Module">_</a> <a id="1313" class="Symbol">(</a><a id="1314" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1314" class="Bound">ext</a> <a id="1318" class="Symbol">:</a> <a id="1320" href="Ledger.Conway.Foreign.ExternalFunctions.html#132" class="Record">ExternalFunctions</a><a id="1337" class="Symbol">)</a> <a id="1339" class="Keyword">where</a>
  <a id="1347" class="Keyword">open</a> <a id="1352" class="Keyword">import</a> <a id="1359" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html" class="Module">Ledger.Conway.Foreign.HSLedger.ExternalStructures</a> <a id="1409" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1314" class="Bound">ext</a> <a id="1413" class="Keyword">hiding</a> <a id="1420" class="Symbol">(</a><a id="1421" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a><a id="1423" class="Symbol">;</a> <a id="1425" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a><a id="1431" class="Symbol">;</a> <a id="1433" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a><a id="1439" class="Symbol">)</a>
  <a id="1443" class="Keyword">open</a> <a id="1448" class="Keyword">import</a> <a id="1455" href="Ledger.Conway.Conformance.Utxow.Properties.html" class="Module">Ledger.Conway.Conformance.Utxow.Properties</a> <a id="1498" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#2962" class="Function">HSTransactionStructure</a> <a id="1521" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#3527" class="Function">HSAbstractFunctions</a>
  <a id="1543" class="Keyword">open</a> <a id="1548" class="Keyword">import</a> <a id="1555" href="Ledger.Conway.Conformance.Utxo.Properties.html" class="Module">Ledger.Conway.Conformance.Utxo.Properties</a> <a id="1597" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#2962" class="Function">HSTransactionStructure</a> <a id="1620" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#3527" class="Function">HSAbstractFunctions</a>

  <a id="1643" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1643" class="Function">utxo-step</a> <a id="1653" class="Symbol">:</a> <a id="1655" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1662" class="Symbol">(</a><a id="1663" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="1671" class="Symbol">→</a> <a id="1673" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1688" class="Symbol">→</a> <a id="1690" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="1708" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1715" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a><a id="1724" class="Symbol">)</a>
  <a id="1728" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1643" class="Function">utxo-step</a> <a id="1738" class="Symbol">=</a> <a id="1740" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1743" class="Symbol">(</a><a id="1744" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="1751" class="Symbol">⦃</a> <a id="1753" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="1761" class="Symbol">⦄</a> <a id="1763" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1765" href="Interface.ComputationalRelation.html#2981" class="Function">compute</a> <a id="1773" href="Ledger.Conway.Conformance.Utxo.Properties.html#2237" class="Function">Computational-UTXO</a><a id="1791" class="Symbol">)</a>

  <a id="1796" class="Symbol">{-#</a> <a id="1800" class="Keyword">COMPILE</a> <a id="1808" class="Keyword">GHC</a> <a id="1812" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1643" class="Function">utxo-step</a> <a id="1822" class="Pragma">as</a> <a id="1825" class="Pragma">utxoStep</a> <a id="1834" class="Symbol">#-}</a>

  <a id="1841" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1841" class="Function">utxow-step</a> <a id="1852" class="Symbol">:</a> <a id="1854" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1861" class="Symbol">(</a><a id="1862" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="1870" class="Symbol">→</a> <a id="1872" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a> <a id="1882" class="Symbol">→</a> <a id="1884" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="1887" class="Symbol">→</a> <a id="1889" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="1907" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1914" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a><a id="1923" class="Symbol">)</a>
  <a id="1927" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1841" class="Function">utxow-step</a> <a id="1938" class="Symbol">=</a> <a id="1940" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1943" class="Symbol">(</a><a id="1944" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="1951" class="Symbol">⦃</a> <a id="1953" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="1961" class="Symbol">⦄</a> <a id="1963" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1965" href="Interface.ComputationalRelation.html#2981" class="Function">compute</a> <a id="1973" href="Ledger.Conway.Conformance.Utxow.Properties.html#623" class="Function">Computational-UTXOW</a><a id="1992" class="Symbol">)</a>

  <a id="1997" class="Symbol">{-#</a> <a id="2001" class="Keyword">COMPILE</a> <a id="2009" class="Keyword">GHC</a> <a id="2013" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1841" class="Function">utxow-step</a> <a id="2024" class="Pragma">as</a> <a id="2027" class="Pragma">utxowStep</a> <a id="2037" class="Symbol">#-}</a>

  <a id="2044" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2044" class="Function">utxo-debug</a> <a id="2055" class="Symbol">:</a> <a id="2057" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="2064" class="Symbol">(</a><a id="2065" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="2073" class="Symbol">→</a> <a id="2075" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a> <a id="2085" class="Symbol">→</a> <a id="2087" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="2090" class="Symbol">→</a> <a id="2092" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2098" class="Symbol">)</a>
  <a id="2102" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2044" class="Function">utxo-debug</a> <a id="2113" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2113" class="Bound">env</a> <a id="2117" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a> <a id="2120" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2120" class="Bound">tx</a> <a id="2123" class="Symbol">=</a>
    <a id="2129" class="Keyword">let</a> <a id="2133" class="Keyword">open</a> <a id="2138" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="2141" class="Symbol">(</a><a id="2142" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2147" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2120" class="Bound">tx</a><a id="2149" class="Symbol">)</a>
        <a id="2159" class="Keyword">open</a> <a id="2164" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="2171" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a>
        <a id="2184" class="Keyword">open</a> <a id="2189" href="Ledger.Conway.Specification.Utxo.html#1230" class="Module">UTxOState</a> <a id="2199" class="Symbol">(</a><a id="2200" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2205" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2207" class="Symbol">)</a>
        <a id="2217" class="Keyword">open</a> <a id="2222" href="Ledger.Conway.Specification.Utxo.html#1121" class="Module">UTxOEnv</a> <a id="2230" class="Symbol">(</a><a id="2231" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2236" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2113" class="Bound">env</a><a id="2239" class="Symbol">)</a>
     <a id="2246" class="Keyword">in</a> <a id="2249" href="Data.String.Base.html#2826" class="Function">unlines</a> <a id="2257" href="Function.Base.html#1993" class="Function Operator">$</a>
          <a id="2269" class="String">&quot;Consumed:&quot;</a> <a id="2281" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2293" class="Symbol">(</a><a id="2294" class="String">&quot;\tInputs:      \t&quot;</a> <a id="2314" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2317" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2322" class="Symbol">(</a><a id="2323" href="Ledger.Conway.Specification.Utxo.html#2367" class="Function">balance</a> <a id="2331" class="Symbol">(</a><a id="2332" href="Ledger.Conway.Specification.Utxo.html#1294" class="Function">utxo</a> <a id="2337" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2339" href="Ledger.Conway.Specification.Transaction.html#3032" class="Function">txIns</a><a id="2344" class="Symbol">)))</a> <a id="2348" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2360" class="Symbol">(</a><a id="2361" class="String">&quot;\tMint:        \t&quot;</a> <a id="2381" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2384" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2389" href="Ledger.Conway.Specification.Transaction.html#3638" class="Function">mint</a><a id="2393" class="Symbol">)</a> <a id="2395" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2407" class="Symbol">(</a><a id="2408" class="String">&quot;\tRefunds:     \t&quot;</a> <a id="2428" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2431" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2436" class="Symbol">(</a><a id="2437" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Ledger.Conway.Specification.Utxo.html#10581" class="Function">depositRefunds</a> <a id="2460" href="Ledger.Conway.Specification.Utxo.html#1175" class="Function">pparams</a> <a id="2468" class="Symbol">(</a><a id="2469" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2474" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2476" class="Symbol">)</a> <a id="2478" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a><a id="2482" class="Symbol">)))</a> <a id="2486" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2498" class="Symbol">(</a><a id="2499" class="String">&quot;\tWithdrawals: \t&quot;</a> <a id="2519" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2522" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2527" class="Symbol">(</a><a id="2528" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2535" class="Symbol">(</a><a id="2536" href="Ledger.Prelude.HasCoin.html#170" class="Field">getCoin</a> <a id="2544" href="Ledger.Conway.Specification.Transaction.html#3288" class="Function">txWithdrawals</a><a id="2557" class="Symbol">)))</a> <a id="2561" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2573" class="Symbol">(</a><a id="2574" class="String">&quot;\tTotal:       \t&quot;</a> <a id="2594" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2597" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2602" class="Symbol">(</a><a id="2603" href="Ledger.Conway.Specification.Utxo.html#10839" class="Function">consumed</a> <a id="2612" href="Ledger.Conway.Specification.Utxo.html#1175" class="Function">pparams</a> <a id="2620" class="Symbol">(</a><a id="2621" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2626" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2628" class="Symbol">)</a> <a id="2630" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a><a id="2634" class="Symbol">))</a> <a id="2637" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2649" class="String">&quot;Produced:&quot;</a> <a id="2661" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2673" class="Symbol">(</a><a id="2674" class="String">&quot;\tOutputs:     \t&quot;</a> <a id="2694" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2697" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2702" class="Symbol">(</a><a id="2703" href="Ledger.Conway.Specification.Utxo.html#2367" class="Function">balance</a> <a id="2711" class="Symbol">(</a><a id="2712" href="Ledger.Conway.Specification.Utxo.html#2296" class="Function">outs</a> <a id="2717" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a><a id="2721" class="Symbol">)))</a> <a id="2725" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2737" class="Symbol">(</a><a id="2738" class="String">&quot;\tDonations:   \t&quot;</a> <a id="2758" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2761" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2766" class="Symbol">(</a><a id="2767" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2774" href="Ledger.Conway.Specification.Transaction.html#3424" class="Function">txDonation</a><a id="2784" class="Symbol">))</a> <a id="2787" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2799" class="Symbol">(</a><a id="2800" class="String">&quot;\tDeposits:    \t&quot;</a> <a id="2820" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2823" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2828" class="Symbol">(</a><a id="2829" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2836" class="Symbol">(</a><a id="2837" href="Ledger.Conway.Specification.Utxo.html#10713" class="Function">newDeposits</a> <a id="2849" href="Ledger.Conway.Specification.Utxo.html#1175" class="Function">pparams</a> <a id="2857" class="Symbol">(</a><a id="2858" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2863" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2865" class="Symbol">)</a> <a id="2867" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a><a id="2871" class="Symbol">)))</a> <a id="2875" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2887" class="Symbol">(</a><a id="2888" class="String">&quot;\tFees:        \t&quot;</a> <a id="2908" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2911" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2916" class="Symbol">(</a><a id="2917" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2924" href="Ledger.Conway.Specification.Transaction.html#3254" class="Function">txFee</a><a id="2929" class="Symbol">))</a> <a id="2932" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2944" class="Symbol">(</a><a id="2945" class="String">&quot;\tTotal:       \t&quot;</a> <a id="2965" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2968" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2973" class="Symbol">(</a><a id="2974" href="Ledger.Conway.Specification.Utxo.html#11053" class="Function">produced</a> <a id="2983" href="Ledger.Conway.Specification.Utxo.html#1175" class="Function">pparams</a> <a id="2991" class="Symbol">(</a><a id="2992" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2997" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2999" class="Symbol">)</a> <a id="3001" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a><a id="3005" class="Symbol">))</a> <a id="3008" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3020" class="String">&quot;&quot;</a> <a id="3023" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3035" class="String">&quot;Reference Scripts Info:&quot;</a> <a id="3061" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3073" class="Symbol">(</a><a id="3074" class="String">&quot;\tTotal size: \t&quot;</a> <a id="3093" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="3096" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3101" class="Symbol">(</a><a id="3102" href="Ledger.Conway.Specification.Utxo.html#2520" class="Function">refScriptsSize</a> <a id="3117" href="Ledger.Conway.Specification.Utxo.html#1294" class="Function">utxo</a> <a id="3122" class="Symbol">(</a><a id="3123" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3128" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2120" class="Bound">tx</a><a id="3130" class="Symbol">)))</a> <a id="3134" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3146" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="3152" class="Symbol">{-#</a> <a id="3156" class="Keyword">COMPILE</a> <a id="3164" class="Keyword">GHC</a> <a id="3168" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2044" class="Function">utxo-debug</a> <a id="3179" class="Pragma">as</a> <a id="3182" class="Pragma">utxoDebug</a> <a id="3192" class="Symbol">#-}</a>

  <a id="3199" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3199" class="Function">utxow-debug</a> <a id="3211" class="Symbol">:</a> <a id="3213" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3220" class="Symbol">(</a><a id="3221" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="3229" class="Symbol">→</a> <a id="3231" href="Ledger.Conway.Specification.Utxo.html#1230" class="Record">UTxOState</a> <a id="3241" class="Symbol">→</a> <a id="3243" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="3246" class="Symbol">→</a> <a id="3248" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3254" class="Symbol">)</a>
  <a id="3258" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3199" class="Function">utxow-debug</a> <a id="3270" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3270" class="Bound">env</a> <a id="3274" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3274" class="Bound">st</a> <a id="3277" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3277" class="Bound">tx</a> <a id="3280" class="Symbol">=</a>
    <a id="3286" class="Keyword">let</a> <a id="3290" class="Keyword">open</a> <a id="3295" href="Ledger.Conway.Specification.Transaction.html#4682" class="Module">Tx</a> <a id="3298" class="Symbol">(</a><a id="3299" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3304" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3277" class="Bound">tx</a><a id="3306" class="Symbol">)</a>
        <a id="3316" class="Keyword">open</a> <a id="3321" href="Ledger.Conway.Specification.Transaction.html#2996" class="Module">TxBody</a> <a id="3328" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a>
        <a id="3341" class="Keyword">open</a> <a id="3346" href="Ledger.Conway.Specification.Utxo.html#1230" class="Module">UTxOState</a> <a id="3356" class="Symbol">(</a><a id="3357" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3362" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3274" class="Bound">st</a><a id="3364" class="Symbol">)</a>
        <a id="3374" class="Keyword">open</a> <a id="3379" href="Ledger.Conway.Specification.Utxo.html#1121" class="Module">UTxOEnv</a> <a id="3387" class="Symbol">(</a><a id="3388" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3393" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3270" class="Bound">env</a><a id="3396" class="Symbol">)</a>
        <a id="3406" class="Keyword">open</a> <a id="3411" href="Ledger.Conway.Specification.Transaction.html#4437" class="Module">TxWitnesses</a> <a id="3423" class="Symbol">(</a><a id="3424" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3431" class="Symbol">⦃</a> <a id="3433" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3441" class="Symbol">⦄</a> <a id="3443" href="Ledger.Conway.Specification.Transaction.html#4738" class="Function">wits</a><a id="3447" class="Symbol">)</a>
        <a id="3457" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3457" class="Bound">neededScriptHashes</a> <a id="3476" class="Symbol">=</a> <a id="3478" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3489" class="Symbol">(</a><a id="3490" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a>  <a id="3503" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3505" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3510" class="Symbol">)</a> <a id="3512" class="Symbol">(</a><a id="3513" href="Ledger.Conway.Specification.Script.Validation.html#2485" class="Function">credsNeeded</a> <a id="3525" href="Ledger.Conway.Specification.Utxo.html#1294" class="Function">utxo</a> <a id="3530" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a><a id="3534" class="Symbol">)</a>
        <a id="3544" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3544" class="Bound">neededVKeyHashes</a>   <a id="3563" class="Symbol">=</a> <a id="3565" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3576" class="Symbol">(</a><a id="3577" href="Ledger.Core.Specification.Address.html#486" class="Function">isKeyHashObj</a> <a id="3590" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3592" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3597" class="Symbol">)</a> <a id="3599" class="Symbol">(</a><a id="3600" href="Ledger.Conway.Specification.Script.Validation.html#2485" class="Function">credsNeeded</a> <a id="3612" href="Ledger.Conway.Specification.Utxo.html#1294" class="Function">utxo</a> <a id="3617" href="Ledger.Conway.Specification.Transaction.html#4714" class="Function">body</a><a id="3621" class="Symbol">)</a>
        <a id="3631" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3631" class="Bound">refScriptHashes</a> <a id="3647" class="Symbol">=</a> <a id="3649" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
          <a id="3664" href="Interface.Hashable.html#205" class="Field">hash</a> 
          <a id="3680" class="Symbol">(</a><a id="3681" href="Ledger.Conway.Specification.Transaction.html#6190" class="Function">refScripts</a> <a id="3692" class="Symbol">(</a><a id="3693" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3700" class="Symbol">⦃</a> <a id="3702" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3710" class="Symbol">⦄</a> <a id="3712" class="Symbol">(</a><a id="3713" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3718" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3277" class="Bound">tx</a><a id="3720" class="Symbol">))</a> <a id="3723" class="Symbol">(</a><a id="3724" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3731" class="Symbol">⦃</a> <a id="3733" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3741" class="Symbol">⦄</a> <a id="3743" href="Ledger.Conway.Specification.Utxo.html#1294" class="Function">utxo</a><a id="3747" class="Symbol">))</a>
        <a id="3758" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3758" class="Bound">witsScriptHashes</a>  <a id="3776" class="Symbol">=</a> <a id="3778" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3783" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="3788" href="Ledger.Conway.Specification.Transaction.html#4506" class="Function">scripts</a>
     <a id="3801" class="Keyword">in</a> <a id="3804" href="Data.String.Base.html#2826" class="Function">unlines</a>
       <a id="3819" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3821" class="String">&quot;neededVKeyHashes utxo txb = &quot;</a>
       <a id="3859" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3861" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3866" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3544" class="Bound">neededVKeyHashes</a>
       <a id="3890" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3892" class="String">&quot;\nwitsKeyHashes = &quot;</a>
       <a id="3920" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3922" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3927" class="Symbol">(</a><a id="3928" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3933" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="3938" class="Symbol">(</a><a id="3939" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3943" href="Ledger.Conway.Specification.Transaction.html#4478" class="Function">vkSigs</a><a id="3949" class="Symbol">))</a>
       <a id="3959" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3961" class="String">&quot;\nneededScriptHashes = &quot;</a>
       <a id="3994" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3996" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4001" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3457" class="Bound">neededScriptHashes</a>
       <a id="4027" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4029" class="String">&quot;\nrefScriptHashes = &quot;</a>
       <a id="4059" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4061" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4066" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3631" class="Bound">refScriptHashes</a>
       <a id="4089" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4091" class="String">&quot;\nwitsScriptHashes = &quot;</a>
       <a id="4122" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4124" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4129" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3758" class="Bound">witsScriptHashes</a>
       <a id="4153" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4155" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="4161" class="Symbol">{-#</a> <a id="4165" class="Keyword">COMPILE</a> <a id="4173" class="Keyword">GHC</a> <a id="4177" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3199" class="Function">utxow-debug</a> <a id="4189" class="Pragma">as</a> <a id="4192" class="Pragma">utxowDebug</a> <a id="4203" class="Symbol">#-}</a>
</pre></body></html>