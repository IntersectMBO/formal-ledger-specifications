<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Utxo</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--no-qualified-instances</a> <a id="38" class="Symbol">#-}</a>

<a id="43" class="Keyword">module</a> <a id="50" href="Ledger.Conway.Foreign.HSLedger.Utxo.html" class="Module">Ledger.Conway.Foreign.HSLedger.Utxo</a> <a id="86" class="Keyword">where</a>

<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="121" class="Keyword">open</a> <a id="126" class="Keyword">import</a> <a id="133" href="Ledger.Conway.Foreign.ExternalFunctions.html" class="Module">Ledger.Conway.Foreign.ExternalFunctions</a>

<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="203" class="Keyword">renaming</a> <a id="212" class="Symbol">(</a><a id="213" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="218" class="Symbol">to</a> <a id="221" class="Function Operator">_+ˢ_</a><a id="225" class="Symbol">)</a> <a id="227" class="Keyword">hiding</a> <a id="234" class="Symbol">(</a><a id="235" href="Data.String.Base.html#1626" class="Primitive">show</a><a id="239" class="Symbol">;</a> <a id="241" href="Data.String.Base.html#2489" class="Function">length</a><a id="247" class="Symbol">;</a> <a id="249" href="Data.String.Base.html#5404" class="Function">map</a><a id="252" class="Symbol">;</a> <a id="254" href="Data.String.Base.html#1591" class="Primitive">fromList</a><a id="262" class="Symbol">)</a>

<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Ledger.Conway.Foreign.HSLedger.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Core</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Ledger.Conway.Foreign.HSLedger.Certs.html" class="Module">Ledger.Conway.Foreign.HSLedger.Certs</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Ledger.Conway.Foreign.HSLedger.Transaction.html" class="Module">Ledger.Conway.Foreign.HSLedger.Transaction</a>

<a id="520" class="Keyword">open</a> <a id="525" class="Keyword">import</a> <a id="532" href="Foreign.Haskell.Coerce.html" class="Module">Foreign.Haskell.Coerce</a>

<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a> <a id="609" class="Keyword">hiding</a> <a id="616" class="Symbol">(</a><a id="617" href="Ledger.Conway.Specification.Transaction.html#4255" class="Record">TxWitnesses</a><a id="628" class="Symbol">;</a> <a id="630" href="Ledger.Conway.Specification.Transaction.html#5827" class="Function">refScripts</a><a id="640" class="Symbol">;</a> <a id="642" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a><a id="653" class="Symbol">;</a> <a id="655" href="Ledger.Core.Specification.Address.html#486" class="Function">isKeyHashObj</a><a id="667" class="Symbol">)</a>
<a id="669" class="Keyword">open</a> <a id="674" class="Keyword">import</a> <a id="681" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a> <a id="727" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2198" class="Function">DummyTransactionStructure</a> <a id="753" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2253" class="Function">DummyAbstractFunctions</a>
<a id="776" class="Keyword">open</a> <a id="781" class="Keyword">import</a> <a id="788" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="819" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2198" class="Function">DummyTransactionStructure</a> <a id="845" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2253" class="Function">DummyAbstractFunctions</a>
<a id="868" class="Keyword">open</a> <a id="873" class="Keyword">import</a> <a id="880" href="Ledger.Conway.Conformance.Utxow.html" class="Module">Ledger.Conway.Conformance.Utxow</a> <a id="912" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2198" class="Function">DummyTransactionStructure</a> <a id="938" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2253" class="Function">DummyAbstractFunctions</a>

<a id="962" class="Keyword">instance</a>
  <a id="HsTy-UTxOEnv"></a><a id="973" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#973" class="Function">HsTy-UTxOEnv</a> <a id="986" class="Symbol">=</a> <a id="988" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="999" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="1007" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="1009" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="1025" class="String">&quot;MkUTxOEnv&quot;</a>
                                    <a id="1073" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="1075" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="1087" class="String">&quot;ue&quot;</a>
  <a id="Conv-UTxOEnv"></a><a id="1094" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1094" class="Function">Conv-UTxOEnv</a> <a id="1107" class="Symbol">=</a> <a id="1109" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="1121" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a>

  <a id="HsTy-UTxOState"></a><a id="1132" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1132" class="Function">HsTy-UTxOState</a> <a id="1147" class="Symbol">=</a> <a id="1149" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="1160" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a> <a id="1170" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="1172" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="1188" class="String">&quot;MkUTxOState&quot;</a>
  <a id="Conv-UTxOState"></a><a id="1204" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1204" class="Function">Conv-UTxOState</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="1233" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a>

<a id="1244" class="Keyword">unquoteDecl</a> <a id="1256" class="Symbol">=</a> <a id="1258" class="Keyword">do</a>
  hsTypeAlias UTxO
  hsTypeAlias Redeemer

<a id="1304" class="Keyword">module</a> <a id="1311" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1311" class="Module">_</a> <a id="1313" class="Symbol">(</a><a id="1314" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1314" class="Bound">ext</a> <a id="1318" class="Symbol">:</a> <a id="1320" href="Ledger.Conway.Foreign.ExternalFunctions.html#132" class="Record">ExternalFunctions</a><a id="1337" class="Symbol">)</a> <a id="1339" class="Keyword">where</a>
  <a id="1347" class="Keyword">open</a> <a id="1352" class="Keyword">import</a> <a id="1359" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html" class="Module">Ledger.Conway.Foreign.HSLedger.ExternalStructures</a> <a id="1409" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1314" class="Bound">ext</a> <a id="1413" class="Keyword">hiding</a> <a id="1420" class="Symbol">(</a><a id="1421" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a><a id="1423" class="Symbol">;</a> <a id="1425" href="Ledger.Conway.Specification.Transaction.html#2987" class="Record">TxBody</a><a id="1431" class="Symbol">;</a> <a id="1433" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a><a id="1439" class="Symbol">)</a>
  <a id="1443" class="Keyword">open</a> <a id="1448" class="Keyword">import</a> <a id="1455" href="Ledger.Conway.Conformance.Utxow.Properties.html" class="Module">Ledger.Conway.Conformance.Utxow.Properties</a> <a id="1498" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#2962" class="Function">HSTransactionStructure</a> <a id="1521" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#3527" class="Function">HSAbstractFunctions</a>
  <a id="1543" class="Keyword">open</a> <a id="1548" class="Keyword">import</a> <a id="1555" href="Ledger.Conway.Conformance.Utxo.Properties.html" class="Module">Ledger.Conway.Conformance.Utxo.Properties</a> <a id="1597" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#2962" class="Function">HSTransactionStructure</a> <a id="1620" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#3527" class="Function">HSAbstractFunctions</a>

  <a id="1643" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1643" class="Function">utxo-step</a> <a id="1653" class="Symbol">:</a> <a id="1655" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1662" class="Symbol">(</a><a id="1663" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="1671" class="Symbol">→</a> <a id="1673" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a> <a id="1683" class="Symbol">→</a> <a id="1685" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a> <a id="1688" class="Symbol">→</a> <a id="1690" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="1708" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1715" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a><a id="1724" class="Symbol">)</a>
  <a id="1728" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1643" class="Function">utxo-step</a> <a id="1738" class="Symbol">=</a> <a id="1740" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1743" class="Symbol">(</a><a id="1744" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="1751" class="Symbol">⦃</a> <a id="1753" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="1761" class="Symbol">⦄</a> <a id="1763" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1765" href="Interface.ComputationalRelation.html#2976" class="Function">compute</a> <a id="1773" href="Ledger.Conway.Conformance.Utxo.Properties.html#2237" class="Function">Computational-UTXO</a><a id="1791" class="Symbol">)</a>

  <a id="1796" class="Symbol">{-#</a> <a id="1800" class="Keyword">COMPILE</a> <a id="1808" class="Keyword">GHC</a> <a id="1812" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1643" class="Function">utxo-step</a> <a id="1822" class="Pragma">as</a> <a id="1825" class="Pragma">utxoStep</a> <a id="1834" class="Symbol">#-}</a>

  <a id="1841" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1841" class="Function">utxow-step</a> <a id="1852" class="Symbol">:</a> <a id="1854" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1861" class="Symbol">(</a><a id="1862" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="1870" class="Symbol">→</a> <a id="1872" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a> <a id="1882" class="Symbol">→</a> <a id="1884" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a> <a id="1887" class="Symbol">→</a> <a id="1889" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="1907" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1914" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a><a id="1923" class="Symbol">)</a>
  <a id="1927" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1841" class="Function">utxow-step</a> <a id="1938" class="Symbol">=</a> <a id="1940" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1943" class="Symbol">(</a><a id="1944" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="1951" class="Symbol">⦃</a> <a id="1953" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="1961" class="Symbol">⦄</a> <a id="1963" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1965" href="Interface.ComputationalRelation.html#2976" class="Function">compute</a> <a id="1973" href="Ledger.Conway.Conformance.Utxow.Properties.html#623" class="Function">Computational-UTXOW</a><a id="1992" class="Symbol">)</a>

  <a id="1997" class="Symbol">{-#</a> <a id="2001" class="Keyword">COMPILE</a> <a id="2009" class="Keyword">GHC</a> <a id="2013" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1841" class="Function">utxow-step</a> <a id="2024" class="Pragma">as</a> <a id="2027" class="Pragma">utxowStep</a> <a id="2037" class="Symbol">#-}</a>

  <a id="2044" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2044" class="Function">utxo-debug</a> <a id="2055" class="Symbol">:</a> <a id="2057" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="2064" class="Symbol">(</a><a id="2065" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="2073" class="Symbol">→</a> <a id="2075" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a> <a id="2085" class="Symbol">→</a> <a id="2087" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a> <a id="2090" class="Symbol">→</a> <a id="2092" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2098" class="Symbol">)</a>
  <a id="2102" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2044" class="Function">utxo-debug</a> <a id="2113" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2113" class="Bound">env</a> <a id="2117" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a> <a id="2120" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2120" class="Bound">tx</a> <a id="2123" class="Symbol">=</a>
    <a id="2129" class="Keyword">let</a> <a id="2133" class="Keyword">open</a> <a id="2138" href="Ledger.Conway.Specification.Transaction.html#4500" class="Module">Tx</a> <a id="2141" class="Symbol">(</a><a id="2142" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2147" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2120" class="Bound">tx</a><a id="2149" class="Symbol">)</a>
        <a id="2159" class="Keyword">open</a> <a id="2164" href="Ledger.Conway.Specification.Transaction.html#2987" class="Module">TxBody</a> <a id="2171" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a>
        <a id="2184" class="Keyword">open</a> <a id="2189" href="Ledger.Conway.Specification.Utxo.html#1473" class="Module">UTxOState</a> <a id="2199" class="Symbol">(</a><a id="2200" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2205" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2207" class="Symbol">)</a>
        <a id="2217" class="Keyword">open</a> <a id="2222" href="Ledger.Conway.Specification.Utxo.html#1121" class="Module">UTxOEnv</a> <a id="2230" class="Symbol">(</a><a id="2231" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2236" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2113" class="Bound">env</a><a id="2239" class="Symbol">)</a>
     <a id="2246" class="Keyword">in</a> <a id="2249" href="Data.String.Base.html#2826" class="Function">unlines</a> <a id="2257" href="Function.Base.html#1993" class="Function Operator">$</a>
          <a id="2269" class="String">&quot;Consumed:&quot;</a> <a id="2281" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2293" class="Symbol">(</a><a id="2294" class="String">&quot;\tInputs:      \t&quot;</a> <a id="2314" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2317" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2322" class="Symbol">(</a><a id="2323" href="Ledger.Conway.Specification.Utxo.html#2317" class="Function">balance</a> <a id="2331" class="Symbol">(</a><a id="2332" href="Ledger.Conway.Specification.Utxo.html#1537" class="Function">utxo</a> <a id="2337" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2339" href="Ledger.Conway.Specification.Transaction.html#3023" class="Function">txins</a><a id="2344" class="Symbol">)))</a> <a id="2348" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2360" class="Symbol">(</a><a id="2361" class="String">&quot;\tMint:        \t&quot;</a> <a id="2381" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2384" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2389" href="Ledger.Conway.Specification.Transaction.html#3145" class="Function">mint</a><a id="2393" class="Symbol">)</a> <a id="2395" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2407" class="Symbol">(</a><a id="2408" class="String">&quot;\tRefunds:     \t&quot;</a> <a id="2428" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2431" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2436" class="Symbol">(</a><a id="2437" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Ledger.Conway.Specification.Utxo.html#10505" class="Function">depositRefunds</a> <a id="2460" href="Ledger.Conway.Specification.Utxo.html#1175" class="Function">pparams</a> <a id="2468" class="Symbol">(</a><a id="2469" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2474" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2476" class="Symbol">)</a> <a id="2478" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a><a id="2482" class="Symbol">)))</a> <a id="2486" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2498" class="Symbol">(</a><a id="2499" class="String">&quot;\tWithdrawals: \t&quot;</a> <a id="2519" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2522" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2527" class="Symbol">(</a><a id="2528" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2535" class="Symbol">(</a><a id="2536" href="Ledger.Prelude.HasCoin.html#170" class="Field">getCoin</a> <a id="2544" href="Ledger.Conway.Specification.Transaction.html#3255" class="Function">txwdrls</a><a id="2551" class="Symbol">)))</a> <a id="2555" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2567" class="Symbol">(</a><a id="2568" class="String">&quot;\tTotal:       \t&quot;</a> <a id="2588" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2591" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2596" class="Symbol">(</a><a id="2597" href="Ledger.Conway.Specification.Utxo.html#10763" class="Function">consumed</a> <a id="2606" href="Ledger.Conway.Specification.Utxo.html#1175" class="Function">pparams</a> <a id="2614" class="Symbol">(</a><a id="2615" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2620" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2622" class="Symbol">)</a> <a id="2624" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a><a id="2628" class="Symbol">))</a> <a id="2631" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2643" class="String">&quot;Produced:&quot;</a> <a id="2655" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2667" class="Symbol">(</a><a id="2668" class="String">&quot;\tOutputs:     \t&quot;</a> <a id="2688" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2691" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2696" class="Symbol">(</a><a id="2697" href="Ledger.Conway.Specification.Utxo.html#2317" class="Function">balance</a> <a id="2705" class="Symbol">(</a><a id="2706" href="Ledger.Conway.Specification.Utxo.html#2246" class="Function">outs</a> <a id="2711" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a><a id="2715" class="Symbol">)))</a> <a id="2719" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2731" class="Symbol">(</a><a id="2732" class="String">&quot;\tDonations:   \t&quot;</a> <a id="2752" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2755" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2760" class="Symbol">(</a><a id="2761" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2768" href="Ledger.Conway.Specification.Transaction.html#3359" class="Function">txdonation</a><a id="2778" class="Symbol">))</a> <a id="2781" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2793" class="Symbol">(</a><a id="2794" class="String">&quot;\tDeposits:    \t&quot;</a> <a id="2814" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2817" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2822" class="Symbol">(</a><a id="2823" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2830" class="Symbol">(</a><a id="2831" href="Ledger.Conway.Specification.Utxo.html#10637" class="Function">newDeposits</a> <a id="2843" href="Ledger.Conway.Specification.Utxo.html#1175" class="Function">pparams</a> <a id="2851" class="Symbol">(</a><a id="2852" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2857" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2859" class="Symbol">)</a> <a id="2861" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a><a id="2865" class="Symbol">)))</a> <a id="2869" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2881" class="Symbol">(</a><a id="2882" class="String">&quot;\tFees:        \t&quot;</a> <a id="2902" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2905" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2910" class="Symbol">(</a><a id="2911" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#883" class="Function">inject</a> <a id="2918" href="Ledger.Conway.Specification.Transaction.html#3117" class="Function">txfee</a><a id="2923" class="Symbol">))</a> <a id="2926" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2938" class="Symbol">(</a><a id="2939" class="String">&quot;\tTotal:       \t&quot;</a> <a id="2959" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2962" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2967" class="Symbol">(</a><a id="2968" href="Ledger.Conway.Specification.Utxo.html#10971" class="Function">produced</a> <a id="2977" href="Ledger.Conway.Specification.Utxo.html#1175" class="Function">pparams</a> <a id="2985" class="Symbol">(</a><a id="2986" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2991" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2117" class="Bound">st</a><a id="2993" class="Symbol">)</a> <a id="2995" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a><a id="2999" class="Symbol">))</a> <a id="3002" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3014" class="String">&quot;&quot;</a> <a id="3017" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3029" class="String">&quot;Reference Scripts Info:&quot;</a> <a id="3055" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3067" class="Symbol">(</a><a id="3068" class="String">&quot;\tTotal size: \t&quot;</a> <a id="3087" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="3090" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3095" class="Symbol">(</a><a id="3096" href="Ledger.Conway.Specification.Utxo.html#2470" class="Function">refScriptsSize</a> <a id="3111" href="Ledger.Conway.Specification.Utxo.html#1537" class="Function">utxo</a> <a id="3116" class="Symbol">(</a><a id="3117" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3122" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2120" class="Bound">tx</a><a id="3124" class="Symbol">)))</a> <a id="3128" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3140" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="3146" class="Symbol">{-#</a> <a id="3150" class="Keyword">COMPILE</a> <a id="3158" class="Keyword">GHC</a> <a id="3162" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2044" class="Function">utxo-debug</a> <a id="3173" class="Pragma">as</a> <a id="3176" class="Pragma">utxoDebug</a> <a id="3186" class="Symbol">#-}</a>

  <a id="3193" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3193" class="Function">utxow-debug</a> <a id="3205" class="Symbol">:</a> <a id="3207" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3214" class="Symbol">(</a><a id="3215" href="Ledger.Conway.Specification.Utxo.html#1121" class="Record">UTxOEnv</a> <a id="3223" class="Symbol">→</a> <a id="3225" href="Ledger.Conway.Specification.Utxo.html#1473" class="Record">UTxOState</a> <a id="3235" class="Symbol">→</a> <a id="3237" href="Ledger.Conway.Specification.Transaction.html#4500" class="Record">Tx</a> <a id="3240" class="Symbol">→</a> <a id="3242" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3248" class="Symbol">)</a>
  <a id="3252" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3193" class="Function">utxow-debug</a> <a id="3264" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3264" class="Bound">env</a> <a id="3268" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3268" class="Bound">st</a> <a id="3271" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3271" class="Bound">tx</a> <a id="3274" class="Symbol">=</a>
    <a id="3280" class="Keyword">let</a> <a id="3284" class="Keyword">open</a> <a id="3289" href="Ledger.Conway.Specification.Transaction.html#4500" class="Module">Tx</a> <a id="3292" class="Symbol">(</a><a id="3293" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3298" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3271" class="Bound">tx</a><a id="3300" class="Symbol">)</a>
        <a id="3310" class="Keyword">open</a> <a id="3315" href="Ledger.Conway.Specification.Transaction.html#2987" class="Module">TxBody</a> <a id="3322" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a>
        <a id="3335" class="Keyword">open</a> <a id="3340" href="Ledger.Conway.Specification.Utxo.html#1473" class="Module">UTxOState</a> <a id="3350" class="Symbol">(</a><a id="3351" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3356" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3268" class="Bound">st</a><a id="3358" class="Symbol">)</a>
        <a id="3368" class="Keyword">open</a> <a id="3373" href="Ledger.Conway.Specification.Utxo.html#1121" class="Module">UTxOEnv</a> <a id="3381" class="Symbol">(</a><a id="3382" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3387" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3264" class="Bound">env</a><a id="3390" class="Symbol">)</a>
        <a id="3400" class="Keyword">open</a> <a id="3405" href="Ledger.Conway.Specification.Transaction.html#4255" class="Module">TxWitnesses</a> <a id="3417" class="Symbol">(</a><a id="3418" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3425" class="Symbol">⦃</a> <a id="3427" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3435" class="Symbol">⦄</a> <a id="3437" href="Ledger.Conway.Specification.Transaction.html#4556" class="Function">wits</a><a id="3441" class="Symbol">)</a>
        <a id="3451" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3451" class="Bound">neededScriptHashes</a> <a id="3470" class="Symbol">=</a> <a id="3472" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3483" class="Symbol">(</a><a id="3484" href="Ledger.Core.Specification.Address.html#767" class="Function">isScriptObj</a>  <a id="3497" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3499" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3504" class="Symbol">)</a> <a id="3506" class="Symbol">(</a><a id="3507" href="Ledger.Conway.Specification.Script.Validation.html#2391" class="Function">credsNeeded</a> <a id="3519" href="Ledger.Conway.Specification.Utxo.html#1537" class="Function">utxo</a> <a id="3524" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a><a id="3528" class="Symbol">)</a>
        <a id="3538" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3538" class="Bound">neededVKeyHashes</a>   <a id="3557" class="Symbol">=</a> <a id="3559" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3570" class="Symbol">(</a><a id="3571" href="Ledger.Core.Specification.Address.html#486" class="Function">isKeyHashObj</a> <a id="3584" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3586" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3591" class="Symbol">)</a> <a id="3593" class="Symbol">(</a><a id="3594" href="Ledger.Conway.Specification.Script.Validation.html#2391" class="Function">credsNeeded</a> <a id="3606" href="Ledger.Conway.Specification.Utxo.html#1537" class="Function">utxo</a> <a id="3611" href="Ledger.Conway.Specification.Transaction.html#4532" class="Function">body</a><a id="3615" class="Symbol">)</a>
        <a id="3625" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3625" class="Bound">refScriptHashes</a> <a id="3641" class="Symbol">=</a> <a id="3643" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
          <a id="3658" href="Interface.Hashable.html#205" class="Field">hash</a> 
          <a id="3674" class="Symbol">(</a><a id="3675" href="Ledger.Conway.Specification.Transaction.html#5827" class="Function">refScripts</a> <a id="3686" class="Symbol">(</a><a id="3687" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3694" class="Symbol">⦃</a> <a id="3696" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3704" class="Symbol">⦄</a> <a id="3706" class="Symbol">(</a><a id="3707" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3712" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3271" class="Bound">tx</a><a id="3714" class="Symbol">))</a> <a id="3717" class="Symbol">(</a><a id="3718" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3725" class="Symbol">⦃</a> <a id="3727" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3735" class="Symbol">⦄</a> <a id="3737" href="Ledger.Conway.Specification.Utxo.html#1537" class="Function">utxo</a><a id="3741" class="Symbol">))</a>
        <a id="3752" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3752" class="Bound">witsScriptHashes</a>  <a id="3770" class="Symbol">=</a> <a id="3772" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3777" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="3782" href="Ledger.Conway.Specification.Transaction.html#4324" class="Function">scripts</a>
     <a id="3795" class="Keyword">in</a> <a id="3798" href="Data.String.Base.html#2826" class="Function">unlines</a>
       <a id="3813" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3815" class="String">&quot;neededVKeyHashes utxo txb = &quot;</a>
       <a id="3853" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3855" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3860" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3538" class="Bound">neededVKeyHashes</a>
       <a id="3884" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3886" class="String">&quot;\nwitsKeyHashes = &quot;</a>
       <a id="3914" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3916" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3921" class="Symbol">(</a><a id="3922" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3927" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="3932" class="Symbol">(</a><a id="3933" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3937" href="Ledger.Conway.Specification.Transaction.html#4296" class="Function">vkSigs</a><a id="3943" class="Symbol">))</a>
       <a id="3953" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3955" class="String">&quot;\nneededScriptHashes = &quot;</a>
       <a id="3988" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3990" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3995" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3451" class="Bound">neededScriptHashes</a>
       <a id="4021" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4023" class="String">&quot;\nrefScriptHashes = &quot;</a>
       <a id="4053" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4055" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4060" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3625" class="Bound">refScriptHashes</a>
       <a id="4083" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4085" class="String">&quot;\nwitsScriptHashes = &quot;</a>
       <a id="4116" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4118" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4123" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3752" class="Bound">witsScriptHashes</a>
       <a id="4147" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4149" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="4155" class="Symbol">{-#</a> <a id="4159" class="Keyword">COMPILE</a> <a id="4167" class="Keyword">GHC</a> <a id="4171" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3193" class="Function">utxow-debug</a> <a id="4183" class="Pragma">as</a> <a id="4186" class="Pragma">utxowDebug</a> <a id="4197" class="Symbol">#-}</a>
</pre></body></html>