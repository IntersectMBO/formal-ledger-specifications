<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Utxo</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--no-qualified-instances</a> <a id="38" class="Symbol">#-}</a>

<a id="43" class="Keyword">module</a> <a id="50" href="Ledger.Conway.Foreign.HSLedger.Utxo.html" class="Module">Ledger.Conway.Foreign.HSLedger.Utxo</a> <a id="86" class="Keyword">where</a>

<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="121" class="Keyword">open</a> <a id="126" class="Keyword">import</a> <a id="133" href="Ledger.Conway.Foreign.ExternalFunctions.html" class="Module">Ledger.Conway.Foreign.ExternalFunctions</a>

<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="203" class="Keyword">renaming</a> <a id="212" class="Symbol">(</a><a id="213" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="218" class="Symbol">to</a> <a id="221" class="Function Operator">_+ˢ_</a><a id="225" class="Symbol">)</a> <a id="227" class="Keyword">hiding</a> <a id="234" class="Symbol">(</a><a id="235" href="Data.String.Base.html#1626" class="Primitive">show</a><a id="239" class="Symbol">;</a> <a id="241" href="Data.String.Base.html#2489" class="Function">length</a><a id="247" class="Symbol">;</a> <a id="249" href="Data.String.Base.html#5404" class="Function">map</a><a id="252" class="Symbol">;</a> <a id="254" href="Data.String.Base.html#1591" class="Primitive">fromList</a><a id="262" class="Symbol">)</a>

<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Ledger.Conway.Foreign.HSLedger.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Core</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Ledger.Conway.Foreign.HSLedger.Certs.html" class="Module">Ledger.Conway.Foreign.HSLedger.Certs</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Ledger.Conway.Foreign.HSLedger.Transaction.html" class="Module">Ledger.Conway.Foreign.HSLedger.Transaction</a>

<a id="520" class="Keyword">open</a> <a id="525" class="Keyword">import</a> <a id="532" href="Foreign.Haskell.Coerce.html" class="Module">Foreign.Haskell.Coerce</a>

<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a> <a id="609" class="Keyword">hiding</a> <a id="616" class="Symbol">(</a><a id="617" href="Ledger.Core.Specification.Transaction.html#2887" class="Record">TxWitnesses</a><a id="628" class="Symbol">;</a> <a id="630" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a><a id="641" class="Symbol">;</a> <a id="643" href="Ledger.Core.Specification.Address.html#484" class="Function">isKeyHashObj</a><a id="655" class="Symbol">)</a>
<a id="657" class="Keyword">open</a> <a id="662" class="Keyword">import</a> <a id="669" href="Ledger.Conway.Specification.Script.Validation.html" class="Module">Ledger.Conway.Specification.Script.Validation</a> <a id="715" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2250" class="Function">DummyTransactionStructure</a> <a id="741" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2305" class="Function">DummyAbstractFunctions</a>
<a id="764" class="Keyword">open</a> <a id="769" class="Keyword">import</a> <a id="776" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="807" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2250" class="Function">DummyTransactionStructure</a> <a id="833" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2305" class="Function">DummyAbstractFunctions</a>
<a id="856" class="Keyword">open</a> <a id="861" class="Keyword">import</a> <a id="868" href="Ledger.Conway.Conformance.Utxow.html" class="Module">Ledger.Conway.Conformance.Utxow</a> <a id="900" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2250" class="Function">DummyTransactionStructure</a> <a id="926" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2305" class="Function">DummyAbstractFunctions</a>

<a id="950" class="Keyword">instance</a>
  <a id="HsTy-UTxOEnv"></a><a id="961" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#961" class="Function">HsTy-UTxOEnv</a> <a id="974" class="Symbol">=</a> <a id="976" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="987" href="Ledger.Conway.Specification.Utxo.html#1197" class="Record">UTxOEnv</a> <a id="995" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="997" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="1013" class="String">&quot;MkUTxOEnv&quot;</a>
                                    <a id="1061" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="1063" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="1075" class="String">&quot;ue&quot;</a>
  <a id="Conv-UTxOEnv"></a><a id="1082" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1082" class="Function">Conv-UTxOEnv</a> <a id="1095" class="Symbol">=</a> <a id="1097" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="1109" href="Ledger.Conway.Specification.Utxo.html#1197" class="Record">UTxOEnv</a>

  <a id="HsTy-UTxOState"></a><a id="1120" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1120" class="Function">HsTy-UTxOState</a> <a id="1135" class="Symbol">=</a> <a id="1137" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="1148" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a> <a id="1158" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="1160" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="1176" class="String">&quot;MkUTxOState&quot;</a>
  <a id="Conv-UTxOState"></a><a id="1192" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1192" class="Function">Conv-UTxOState</a> <a id="1207" class="Symbol">=</a> <a id="1209" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="1221" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a>

<a id="1232" class="Keyword">unquoteDecl</a> <a id="1244" class="Symbol">=</a> <a id="1246" class="Keyword">do</a>
  hsTypeAlias UTxO
  hsTypeAlias Redeemer

<a id="1292" class="Keyword">module</a> <a id="1299" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1299" class="Module">_</a> <a id="1301" class="Symbol">(</a><a id="1302" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1302" class="Bound">ext</a> <a id="1306" class="Symbol">:</a> <a id="1308" href="Ledger.Conway.Foreign.ExternalFunctions.html#132" class="Record">ExternalFunctions</a><a id="1325" class="Symbol">)</a> <a id="1327" class="Keyword">where</a>
  <a id="1335" class="Keyword">open</a> <a id="1340" class="Keyword">import</a> <a id="1347" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html" class="Module">Ledger.Conway.Foreign.HSLedger.ExternalStructures</a> <a id="1397" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1302" class="Bound">ext</a> <a id="1401" class="Keyword">hiding</a> <a id="1408" class="Symbol">(</a><a id="1409" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a><a id="1415" class="Symbol">)</a>
  <a id="1419" class="Keyword">open</a> <a id="1424" class="Keyword">import</a> <a id="1431" href="Ledger.Conway.Conformance.Utxow.Properties.html" class="Module">Ledger.Conway.Conformance.Utxow.Properties</a> <a id="1474" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#2960" class="Function">HSTransactionStructure</a> <a id="1497" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#3523" class="Function">HSAbstractFunctions</a>
  <a id="1519" class="Keyword">open</a> <a id="1524" class="Keyword">import</a> <a id="1531" href="Ledger.Conway.Conformance.Utxo.Properties.html" class="Module">Ledger.Conway.Conformance.Utxo.Properties</a> <a id="1573" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#2960" class="Function">HSTransactionStructure</a> <a id="1596" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#3523" class="Function">HSAbstractFunctions</a>

  <a id="1619" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1619" class="Function">utxo-step</a> <a id="1629" class="Symbol">:</a> <a id="1631" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1638" class="Symbol">(</a><a id="1639" href="Ledger.Conway.Specification.Utxo.html#1197" class="Record">UTxOEnv</a> <a id="1647" class="Symbol">→</a> <a id="1649" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a> <a id="1659" class="Symbol">→</a> <a id="1661" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="1664" class="Symbol">→</a> <a id="1666" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="1684" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1691" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a><a id="1700" class="Symbol">)</a>
  <a id="1704" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1619" class="Function">utxo-step</a> <a id="1714" class="Symbol">=</a> <a id="1716" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1719" class="Symbol">(</a><a id="1720" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="1727" class="Symbol">⦃</a> <a id="1729" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="1737" class="Symbol">⦄</a> <a id="1739" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1741" href="Interface.ComputationalRelation.html#2981" class="Function">compute</a> <a id="1749" href="Ledger.Conway.Conformance.Utxo.Properties.html#2231" class="Function">Computational-UTXO</a><a id="1767" class="Symbol">)</a>

  <a id="1772" class="Symbol">{-#</a> <a id="1776" class="Keyword">COMPILE</a> <a id="1784" class="Keyword">GHC</a> <a id="1788" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1619" class="Function">utxo-step</a> <a id="1798" class="Pragma">as</a> <a id="1801" class="Pragma">utxoStep</a> <a id="1810" class="Symbol">#-}</a>

  <a id="1817" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1817" class="Function">utxow-step</a> <a id="1828" class="Symbol">:</a> <a id="1830" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1837" class="Symbol">(</a><a id="1838" href="Ledger.Conway.Specification.Utxo.html#1197" class="Record">UTxOEnv</a> <a id="1846" class="Symbol">→</a> <a id="1848" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a> <a id="1858" class="Symbol">→</a> <a id="1860" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="1863" class="Symbol">→</a> <a id="1865" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="1883" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1890" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a><a id="1899" class="Symbol">)</a>
  <a id="1903" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1817" class="Function">utxow-step</a> <a id="1914" class="Symbol">=</a> <a id="1916" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1919" class="Symbol">(</a><a id="1920" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="1927" class="Symbol">⦃</a> <a id="1929" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="1937" class="Symbol">⦄</a> <a id="1939" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1941" href="Interface.ComputationalRelation.html#2981" class="Function">compute</a> <a id="1949" href="Ledger.Conway.Conformance.Utxow.Properties.html#611" class="Function">Computational-UTXOW</a><a id="1968" class="Symbol">)</a>

  <a id="1973" class="Symbol">{-#</a> <a id="1977" class="Keyword">COMPILE</a> <a id="1985" class="Keyword">GHC</a> <a id="1989" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1817" class="Function">utxow-step</a> <a id="2000" class="Pragma">as</a> <a id="2003" class="Pragma">utxowStep</a> <a id="2013" class="Symbol">#-}</a>

  <a id="2020" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2020" class="Function">utxo-debug</a> <a id="2031" class="Symbol">:</a> <a id="2033" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="2040" class="Symbol">(</a><a id="2041" href="Ledger.Conway.Specification.Utxo.html#1197" class="Record">UTxOEnv</a> <a id="2049" class="Symbol">→</a> <a id="2051" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a> <a id="2061" class="Symbol">→</a> <a id="2063" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="2066" class="Symbol">→</a> <a id="2068" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2074" class="Symbol">)</a>
  <a id="2078" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2020" class="Function">utxo-debug</a> <a id="2089" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2089" class="Bound">env</a> <a id="2093" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2093" class="Bound">st</a> <a id="2096" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2096" class="Bound">tx</a> <a id="2099" class="Symbol">=</a>
    <a id="2105" class="Keyword">let</a> <a id="2109" class="Keyword">open</a> <a id="2114" href="Ledger.Conway.Specification.Transaction.html#1719" class="Module">Tx</a> <a id="2117" class="Symbol">(</a><a id="2118" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2123" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2096" class="Bound">tx</a><a id="2125" class="Symbol">)</a>
        <a id="2135" class="Keyword">open</a> <a id="2140" href="Ledger.Conway.Specification.Transaction.html#350" class="Module">TxBody</a> <a id="2147" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a>
        <a id="2160" class="Keyword">open</a> <a id="2165" href="Ledger.Conway.Specification.Utxo.html#1306" class="Module">UTxOState</a> <a id="2175" class="Symbol">(</a><a id="2176" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2181" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2093" class="Bound">st</a><a id="2183" class="Symbol">)</a>
        <a id="2193" class="Keyword">open</a> <a id="2198" href="Ledger.Conway.Specification.Utxo.html#1197" class="Module">UTxOEnv</a> <a id="2206" class="Symbol">(</a><a id="2207" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2212" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2089" class="Bound">env</a><a id="2215" class="Symbol">)</a>
     <a id="2222" class="Keyword">in</a> <a id="2225" href="Data.String.Base.html#2826" class="Function">unlines</a> <a id="2233" href="Function.Base.html#1993" class="Function Operator">$</a>
          <a id="2245" class="String">&quot;Consumed:&quot;</a> <a id="2257" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2269" class="Symbol">(</a><a id="2270" class="String">&quot;\tInputs:      \t&quot;</a> <a id="2290" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2293" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2298" class="Symbol">(</a><a id="2299" href="Ledger.Conway.Specification.Utxo.html#2443" class="Function">balance</a> <a id="2307" class="Symbol">(</a><a id="2308" href="Ledger.Conway.Specification.Utxo.html#1370" class="Function">utxo</a> <a id="2313" href="Axiom.Set.Map.html#13534" class="Function Operator">∣</a> <a id="2315" href="Ledger.Conway.Specification.Transaction.html#382" class="Function">txIns</a><a id="2320" class="Symbol">)))</a> <a id="2324" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2336" class="Symbol">(</a><a id="2337" class="String">&quot;\tMint:        \t&quot;</a> <a id="2357" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2360" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2365" href="Ledger.Conway.Specification.Transaction.html#958" class="Function">mint</a><a id="2369" class="Symbol">)</a> <a id="2371" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2383" class="Symbol">(</a><a id="2384" class="String">&quot;\tRefunds:     \t&quot;</a> <a id="2404" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2407" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2412" class="Symbol">(</a><a id="2413" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a> <a id="2420" class="Symbol">(</a><a id="2421" href="Ledger.Conway.Specification.Utxo.html#10657" class="Function">depositRefunds</a> <a id="2436" href="Ledger.Conway.Specification.Utxo.html#1251" class="Function">pparams</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2450" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2093" class="Bound">st</a><a id="2452" class="Symbol">)</a> <a id="2454" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a><a id="2458" class="Symbol">)))</a> <a id="2462" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2474" class="Symbol">(</a><a id="2475" class="String">&quot;\tWithdrawals: \t&quot;</a> <a id="2495" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2498" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2503" class="Symbol">(</a><a id="2504" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a> <a id="2511" class="Symbol">(</a><a id="2512" href="Ledger.Prelude.HasCoin.html#171" class="Field">getCoin</a> <a id="2520" href="Ledger.Conway.Specification.Transaction.html#624" class="Function">txWithdrawals</a><a id="2533" class="Symbol">)))</a> <a id="2537" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2549" class="Symbol">(</a><a id="2550" class="String">&quot;\tTotal:       \t&quot;</a> <a id="2570" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2573" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2578" class="Symbol">(</a><a id="2579" href="Ledger.Conway.Specification.Utxo.html#10915" class="Function">consumed</a> <a id="2588" href="Ledger.Conway.Specification.Utxo.html#1251" class="Function">pparams</a> <a id="2596" class="Symbol">(</a><a id="2597" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2602" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2093" class="Bound">st</a><a id="2604" class="Symbol">)</a> <a id="2606" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a><a id="2610" class="Symbol">))</a> <a id="2613" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2625" class="String">&quot;Produced:&quot;</a> <a id="2637" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2649" class="Symbol">(</a><a id="2650" class="String">&quot;\tOutputs:     \t&quot;</a> <a id="2670" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2673" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2678" class="Symbol">(</a><a id="2679" href="Ledger.Conway.Specification.Utxo.html#2443" class="Function">balance</a> <a id="2687" class="Symbol">(</a><a id="2688" href="Ledger.Conway.Specification.Utxo.html#2372" class="Function">outs</a> <a id="2693" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a><a id="2697" class="Symbol">)))</a> <a id="2701" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2713" class="Symbol">(</a><a id="2714" class="String">&quot;\tDonations:   \t&quot;</a> <a id="2734" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2737" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2742" class="Symbol">(</a><a id="2743" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a> <a id="2750" href="Ledger.Conway.Specification.Transaction.html#754" class="Function">txDonation</a><a id="2760" class="Symbol">))</a> <a id="2763" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2775" class="Symbol">(</a><a id="2776" class="String">&quot;\tDeposits:    \t&quot;</a> <a id="2796" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2799" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2804" class="Symbol">(</a><a id="2805" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a> <a id="2812" class="Symbol">(</a><a id="2813" href="Ledger.Conway.Specification.Utxo.html#10789" class="Function">newDeposits</a> <a id="2825" href="Ledger.Conway.Specification.Utxo.html#1251" class="Function">pparams</a> <a id="2833" class="Symbol">(</a><a id="2834" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2839" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2093" class="Bound">st</a><a id="2841" class="Symbol">)</a> <a id="2843" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a><a id="2847" class="Symbol">)))</a> <a id="2851" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2863" class="Symbol">(</a><a id="2864" class="String">&quot;\tFees:        \t&quot;</a> <a id="2884" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2887" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2892" class="Symbol">(</a><a id="2893" href="Ledger.Core.Specification.TokenAlgebra.Base.html#880" class="Function">inject</a> <a id="2900" href="Ledger.Conway.Specification.Transaction.html#592" class="Function">txFee</a><a id="2905" class="Symbol">))</a> <a id="2908" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2920" class="Symbol">(</a><a id="2921" class="String">&quot;\tTotal:       \t&quot;</a> <a id="2941" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2944" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2949" class="Symbol">(</a><a id="2950" href="Ledger.Conway.Specification.Utxo.html#11129" class="Function">produced</a> <a id="2959" href="Ledger.Conway.Specification.Utxo.html#1251" class="Function">pparams</a> <a id="2967" class="Symbol">(</a><a id="2968" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2973" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2093" class="Bound">st</a><a id="2975" class="Symbol">)</a> <a id="2977" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a><a id="2981" class="Symbol">))</a> <a id="2984" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2996" class="String">&quot;&quot;</a> <a id="2999" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3011" class="String">&quot;Reference Scripts Info:&quot;</a> <a id="3037" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3049" class="Symbol">(</a><a id="3050" class="String">&quot;\tTotal size: \t&quot;</a> <a id="3069" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="3072" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3077" class="Symbol">(</a><a id="3078" href="Ledger.Conway.Specification.Utxo.html#2596" class="Function">refScriptsSize</a> <a id="3093" href="Ledger.Conway.Specification.Utxo.html#1370" class="Function">utxo</a> <a id="3098" class="Symbol">(</a><a id="3099" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3104" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2096" class="Bound">tx</a><a id="3106" class="Symbol">)))</a> <a id="3110" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3122" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="3128" class="Symbol">{-#</a> <a id="3132" class="Keyword">COMPILE</a> <a id="3140" class="Keyword">GHC</a> <a id="3144" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2020" class="Function">utxo-debug</a> <a id="3155" class="Pragma">as</a> <a id="3158" class="Pragma">utxoDebug</a> <a id="3168" class="Symbol">#-}</a>

  <a id="3175" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3175" class="Function">utxow-debug</a> <a id="3187" class="Symbol">:</a> <a id="3189" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3196" class="Symbol">(</a><a id="3197" href="Ledger.Conway.Specification.Utxo.html#1197" class="Record">UTxOEnv</a> <a id="3205" class="Symbol">→</a> <a id="3207" href="Ledger.Conway.Specification.Utxo.html#1306" class="Record">UTxOState</a> <a id="3217" class="Symbol">→</a> <a id="3219" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="3222" class="Symbol">→</a> <a id="3224" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3230" class="Symbol">)</a>
  <a id="3234" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3175" class="Function">utxow-debug</a> <a id="3246" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3246" class="Bound">env</a> <a id="3250" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3250" class="Bound">st</a> <a id="3253" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3253" class="Bound">tx</a> <a id="3256" class="Symbol">=</a>
    <a id="3262" class="Keyword">let</a> <a id="3266" class="Keyword">open</a> <a id="3271" href="Ledger.Conway.Specification.Transaction.html#1719" class="Module">Tx</a> <a id="3274" class="Symbol">(</a><a id="3275" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3280" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3253" class="Bound">tx</a><a id="3282" class="Symbol">)</a>
        <a id="3292" class="Keyword">open</a> <a id="3297" href="Ledger.Conway.Specification.Transaction.html#350" class="Module">TxBody</a> <a id="3304" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a>
        <a id="3317" class="Keyword">open</a> <a id="3322" href="Ledger.Conway.Specification.Utxo.html#1306" class="Module">UTxOState</a> <a id="3332" class="Symbol">(</a><a id="3333" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3338" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3250" class="Bound">st</a><a id="3340" class="Symbol">)</a>
        <a id="3350" class="Keyword">open</a> <a id="3355" href="Ledger.Conway.Specification.Utxo.html#1197" class="Module">UTxOEnv</a> <a id="3363" class="Symbol">(</a><a id="3364" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3369" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3246" class="Bound">env</a><a id="3372" class="Symbol">)</a>
        <a id="3382" class="Keyword">open</a> <a id="3387" href="Ledger.Core.Specification.Transaction.html#2887" class="Module">TxWitnesses</a> <a id="3399" class="Symbol">(</a><a id="3400" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3407" class="Symbol">⦃</a> <a id="3409" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3417" class="Symbol">⦄</a> <a id="3419" href="Ledger.Conway.Specification.Transaction.html#1769" class="Function">wits</a><a id="3423" class="Symbol">)</a>
        <a id="3433" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3433" class="Bound">neededScriptHashes</a> <a id="3452" class="Symbol">=</a> <a id="3454" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3465" class="Symbol">(</a><a id="3466" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a>  <a id="3479" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3481" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3486" class="Symbol">)</a> <a id="3488" class="Symbol">(</a><a id="3489" href="Ledger.Conway.Specification.Script.Validation.html#2560" class="Function">credsNeeded</a> <a id="3501" href="Ledger.Conway.Specification.Utxo.html#1370" class="Function">utxo</a> <a id="3506" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a><a id="3510" class="Symbol">)</a>
        <a id="3520" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3520" class="Bound">neededVKeyHashes</a>   <a id="3539" class="Symbol">=</a> <a id="3541" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3552" class="Symbol">(</a><a id="3553" href="Ledger.Core.Specification.Address.html#484" class="Function">isKeyHashObj</a> <a id="3566" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3568" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3573" class="Symbol">)</a> <a id="3575" class="Symbol">(</a><a id="3576" href="Ledger.Conway.Specification.Script.Validation.html#2560" class="Function">credsNeeded</a> <a id="3588" href="Ledger.Conway.Specification.Utxo.html#1370" class="Function">utxo</a> <a id="3593" href="Ledger.Conway.Specification.Transaction.html#1747" class="Function">body</a><a id="3597" class="Symbol">)</a>
        <a id="3607" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3607" class="Bound">refScriptHashes</a> <a id="3623" class="Symbol">=</a> <a id="3625" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
          <a id="3640" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> 
          <a id="3656" class="Symbol">(</a><a id="3657" href="Ledger.Conway.Specification.Transaction.html#2595" class="Function">refScripts</a> <a id="3668" class="Symbol">(</a><a id="3669" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3676" class="Symbol">⦃</a> <a id="3678" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3686" class="Symbol">⦄</a> <a id="3688" class="Symbol">(</a><a id="3689" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3694" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3253" class="Bound">tx</a><a id="3696" class="Symbol">))</a> <a id="3699" class="Symbol">(</a><a id="3700" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3707" class="Symbol">⦃</a> <a id="3709" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3717" class="Symbol">⦄</a> <a id="3719" href="Ledger.Conway.Specification.Utxo.html#1370" class="Function">utxo</a><a id="3723" class="Symbol">))</a>
        <a id="3734" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3734" class="Bound">witsScriptHashes</a>  <a id="3752" class="Symbol">=</a> <a id="3754" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3759" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="3764" href="Ledger.Core.Specification.Transaction.html#2956" class="Function">scripts</a>
     <a id="3777" class="Keyword">in</a> <a id="3780" href="Data.String.Base.html#2826" class="Function">unlines</a>
       <a id="3795" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="3797" class="String">&quot;neededVKeyHashes utxo txb = &quot;</a>
       <a id="3835" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3837" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3842" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3520" class="Bound">neededVKeyHashes</a>
       <a id="3866" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3868" class="String">&quot;\nwitsKeyHashes = &quot;</a>
       <a id="3896" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3898" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3903" class="Symbol">(</a><a id="3904" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3909" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="3914" class="Symbol">(</a><a id="3915" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3919" href="Ledger.Core.Specification.Transaction.html#2928" class="Function">vkSigs</a><a id="3925" class="Symbol">))</a>
       <a id="3935" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3937" class="String">&quot;\nneededScriptHashes = &quot;</a>
       <a id="3970" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3972" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3977" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3433" class="Bound">neededScriptHashes</a>
       <a id="4003" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4005" class="String">&quot;\nrefScriptHashes = &quot;</a>
       <a id="4035" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4037" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4042" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3607" class="Bound">refScriptHashes</a>
       <a id="4065" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4067" class="String">&quot;\nwitsScriptHashes = &quot;</a>
       <a id="4098" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4100" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4105" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3734" class="Bound">witsScriptHashes</a>
       <a id="4129" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4131" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="4137" class="Symbol">{-#</a> <a id="4141" class="Keyword">COMPILE</a> <a id="4149" class="Keyword">GHC</a> <a id="4153" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3175" class="Function">utxow-debug</a> <a id="4165" class="Pragma">as</a> <a id="4168" class="Pragma">utxowDebug</a> <a id="4179" class="Symbol">#-}</a>
</pre></body></html>