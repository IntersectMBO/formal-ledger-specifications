<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Utxo</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--no-qualified-instances</a> <a id="38" class="Symbol">#-}</a>

<a id="43" class="Keyword">module</a> <a id="50" href="Ledger.Conway.Foreign.HSLedger.Utxo.html" class="Module">Ledger.Conway.Foreign.HSLedger.Utxo</a> <a id="86" class="Keyword">where</a>

<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="121" class="Keyword">open</a> <a id="126" class="Keyword">import</a> <a id="133" href="Ledger.Conway.Foreign.ExternalFunctions.html" class="Module">Ledger.Conway.Foreign.ExternalFunctions</a>

<a id="174" class="Keyword">open</a> <a id="179" class="Keyword">import</a> <a id="186" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="203" class="Keyword">renaming</a> <a id="212" class="Symbol">(</a><a id="213" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="218" class="Symbol">to</a> <a id="221" class="Function Operator">_+ˢ_</a><a id="225" class="Symbol">)</a> <a id="227" class="Keyword">hiding</a> <a id="234" class="Symbol">(</a><a id="235" href="Data.String.Base.html#1626" class="Primitive">show</a><a id="239" class="Symbol">;</a> <a id="241" href="Data.String.Base.html#2489" class="Function">length</a><a id="247" class="Symbol">;</a> <a id="249" href="Data.String.Base.html#5404" class="Function">map</a><a id="252" class="Symbol">;</a> <a id="254" href="Data.String.Base.html#1591" class="Primitive">fromList</a><a id="262" class="Symbol">)</a>

<a id="265" class="Keyword">open</a> <a id="270" class="Keyword">import</a> <a id="277" href="Ledger.Conway.Foreign.HSLedger.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Core</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Ledger.Conway.Foreign.HSLedger.Certs.html" class="Module">Ledger.Conway.Foreign.HSLedger.Certs</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="464" class="Keyword">open</a> <a id="469" class="Keyword">import</a> <a id="476" href="Ledger.Conway.Foreign.HSLedger.Transaction.html" class="Module">Ledger.Conway.Foreign.HSLedger.Transaction</a>

<a id="520" class="Keyword">open</a> <a id="525" class="Keyword">import</a> <a id="532" href="Foreign.Haskell.Coerce.html" class="Module">Foreign.Haskell.Coerce</a>

<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a> <a id="609" class="Keyword">hiding</a> <a id="616" class="Symbol">(</a><a id="617" href="Ledger.Conway.Transaction.html#3982" class="Record">TxWitnesses</a><a id="628" class="Symbol">;</a> <a id="630" href="Ledger.Conway.Transaction.html#5554" class="Function">refScripts</a><a id="640" class="Symbol">;</a> <a id="642" href="Ledger.Conway.Address.html#755" class="Function">isScriptObj</a><a id="653" class="Symbol">;</a> <a id="655" href="Ledger.Conway.Address.html#474" class="Function">isKeyHashObj</a><a id="667" class="Symbol">)</a>
<a id="669" class="Keyword">open</a> <a id="674" class="Keyword">import</a> <a id="681" href="Ledger.Conway.Script.Validation.html" class="Module">Ledger.Conway.Script.Validation</a> <a id="713" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2207" class="Function">DummyTransactionStructure</a> <a id="739" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2262" class="Function">DummyAbstractFunctions</a>
<a id="762" class="Keyword">open</a> <a id="767" class="Keyword">import</a> <a id="774" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="805" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2207" class="Function">DummyTransactionStructure</a> <a id="831" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2262" class="Function">DummyAbstractFunctions</a>
<a id="854" class="Keyword">open</a> <a id="859" class="Keyword">import</a> <a id="866" href="Ledger.Conway.Conformance.Utxow.html" class="Module">Ledger.Conway.Conformance.Utxow</a> <a id="898" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2207" class="Function">DummyTransactionStructure</a> <a id="924" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html#2262" class="Function">DummyAbstractFunctions</a>

<a id="948" class="Keyword">instance</a>
  <a id="HsTy-UTxOEnv"></a><a id="959" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#959" class="Function">HsTy-UTxOEnv</a> <a id="972" class="Symbol">=</a> <a id="974" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="985" href="Ledger.Conway.Utxo.html#1038" class="Record">UTxOEnv</a> <a id="993" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="995" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="1011" class="String">&quot;MkUTxOEnv&quot;</a>
                                    <a id="1059" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="1061" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="1073" class="String">&quot;ue&quot;</a>
  <a id="Conv-UTxOEnv"></a><a id="1080" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1080" class="Function">Conv-UTxOEnv</a> <a id="1093" class="Symbol">=</a> <a id="1095" href="Foreign.Convertible.Deriving.html#6819" class="Macro">autoConvert</a> <a id="1107" href="Ledger.Conway.Utxo.html#1038" class="Record">UTxOEnv</a>

  <a id="HsTy-UTxOState"></a><a id="1118" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1118" class="Function">HsTy-UTxOState</a> <a id="1133" class="Symbol">=</a> <a id="1135" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="1146" href="Ledger.Conway.Utxo.html#1390" class="Record">UTxOState</a> <a id="1156" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="1158" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="1174" class="String">&quot;MkUTxOState&quot;</a>
  <a id="Conv-UTxOState"></a><a id="1190" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1190" class="Function">Conv-UTxOState</a> <a id="1205" class="Symbol">=</a> <a id="1207" href="Foreign.Convertible.Deriving.html#6819" class="Macro">autoConvert</a> <a id="1219" href="Ledger.Conway.Utxo.html#1390" class="Record">UTxOState</a>

<a id="1230" class="Keyword">unquoteDecl</a> <a id="1242" class="Symbol">=</a> <a id="1244" class="Keyword">do</a>
  hsTypeAlias UTxO
  hsTypeAlias Redeemer

<a id="1290" class="Keyword">module</a> <a id="1297" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1297" class="Module">_</a> <a id="1299" class="Symbol">(</a><a id="1300" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1300" class="Bound">ext</a> <a id="1304" class="Symbol">:</a> <a id="1306" href="Ledger.Conway.Foreign.ExternalFunctions.html#132" class="Record">ExternalFunctions</a><a id="1323" class="Symbol">)</a> <a id="1325" class="Keyword">where</a>
  <a id="1333" class="Keyword">open</a> <a id="1338" class="Keyword">import</a> <a id="1345" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html" class="Module">Ledger.Conway.Foreign.HSLedger.ExternalStructures</a> <a id="1395" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1300" class="Bound">ext</a> <a id="1399" class="Keyword">hiding</a> <a id="1406" class="Symbol">(</a><a id="1407" href="Ledger.Conway.Transaction.html#4227" class="Record">Tx</a><a id="1409" class="Symbol">;</a> <a id="1411" href="Ledger.Conway.Transaction.html#2714" class="Record">TxBody</a><a id="1417" class="Symbol">;</a> <a id="1419" href="Ledger.Conway.TokenAlgebra.Base.html#869" class="Function">inject</a><a id="1425" class="Symbol">)</a>
  <a id="1429" class="Keyword">open</a> <a id="1434" class="Keyword">import</a> <a id="1441" href="Ledger.Conway.Conformance.Utxow.Properties.html" class="Module">Ledger.Conway.Conformance.Utxow.Properties</a> <a id="1484" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#2875" class="Function">HSTransactionStructure</a> <a id="1507" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#3403" class="Function">HSAbstractFunctions</a>
  <a id="1529" class="Keyword">open</a> <a id="1534" class="Keyword">import</a> <a id="1541" href="Ledger.Conway.Conformance.Utxo.Properties.html" class="Module">Ledger.Conway.Conformance.Utxo.Properties</a> <a id="1583" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#2875" class="Function">HSTransactionStructure</a> <a id="1606" href="Ledger.Conway.Foreign.HSLedger.ExternalStructures.html#3403" class="Function">HSAbstractFunctions</a>

  <a id="1629" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1629" class="Function">utxo-step</a> <a id="1639" class="Symbol">:</a> <a id="1641" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1648" class="Symbol">(</a><a id="1649" href="Ledger.Conway.Utxo.html#1038" class="Record">UTxOEnv</a> <a id="1657" class="Symbol">→</a> <a id="1659" href="Ledger.Conway.Utxo.html#1390" class="Record">UTxOState</a> <a id="1669" class="Symbol">→</a> <a id="1671" href="Ledger.Conway.Transaction.html#4227" class="Record">Tx</a> <a id="1674" class="Symbol">→</a> <a id="1676" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="1694" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1701" href="Ledger.Conway.Utxo.html#1390" class="Record">UTxOState</a><a id="1710" class="Symbol">)</a>
  <a id="1714" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1629" class="Function">utxo-step</a> <a id="1724" class="Symbol">=</a> <a id="1726" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1729" class="Symbol">(</a><a id="1730" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="1737" class="Symbol">⦃</a> <a id="1739" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="1747" class="Symbol">⦄</a> <a id="1749" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1751" href="Interface.ComputationalRelation.html#2976" class="Function">compute</a> <a id="1759" href="Ledger.Conway.Conformance.Utxo.Properties.html#2181" class="Function">Computational-UTXO</a><a id="1777" class="Symbol">)</a>

  <a id="1782" class="Symbol">{-#</a> <a id="1786" class="Keyword">COMPILE</a> <a id="1794" class="Keyword">GHC</a> <a id="1798" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1629" class="Function">utxo-step</a> <a id="1808" class="Pragma">as</a> <a id="1811" class="Pragma">utxoStep</a> <a id="1820" class="Symbol">#-}</a>

  <a id="1827" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1827" class="Function">utxow-step</a> <a id="1838" class="Symbol">:</a> <a id="1840" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1847" class="Symbol">(</a><a id="1848" href="Ledger.Conway.Utxo.html#1038" class="Record">UTxOEnv</a> <a id="1856" class="Symbol">→</a> <a id="1858" href="Ledger.Conway.Utxo.html#1390" class="Record">UTxOState</a> <a id="1868" class="Symbol">→</a> <a id="1870" href="Ledger.Conway.Transaction.html#4227" class="Record">Tx</a> <a id="1873" class="Symbol">→</a> <a id="1875" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="1893" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1900" href="Ledger.Conway.Utxo.html#1390" class="Record">UTxOState</a><a id="1909" class="Symbol">)</a>
  <a id="1913" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1827" class="Function">utxow-step</a> <a id="1924" class="Symbol">=</a> <a id="1926" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1929" class="Symbol">(</a><a id="1930" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="1937" class="Symbol">⦃</a> <a id="1939" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="1947" class="Symbol">⦄</a> <a id="1949" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1951" href="Interface.ComputationalRelation.html#2976" class="Function">compute</a> <a id="1959" href="Ledger.Conway.Conformance.Utxow.Properties.html#583" class="Function">Computational-UTXOW</a><a id="1978" class="Symbol">)</a>

  <a id="1983" class="Symbol">{-#</a> <a id="1987" class="Keyword">COMPILE</a> <a id="1995" class="Keyword">GHC</a> <a id="1999" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#1827" class="Function">utxow-step</a> <a id="2010" class="Pragma">as</a> <a id="2013" class="Pragma">utxowStep</a> <a id="2023" class="Symbol">#-}</a>

  <a id="2030" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2030" class="Function">utxo-debug</a> <a id="2041" class="Symbol">:</a> <a id="2043" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="2050" class="Symbol">(</a><a id="2051" href="Ledger.Conway.Utxo.html#1038" class="Record">UTxOEnv</a> <a id="2059" class="Symbol">→</a> <a id="2061" href="Ledger.Conway.Utxo.html#1390" class="Record">UTxOState</a> <a id="2071" class="Symbol">→</a> <a id="2073" href="Ledger.Conway.Transaction.html#4227" class="Record">Tx</a> <a id="2076" class="Symbol">→</a> <a id="2078" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="2084" class="Symbol">)</a>
  <a id="2088" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2030" class="Function">utxo-debug</a> <a id="2099" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2099" class="Bound">env</a> <a id="2103" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2103" class="Bound">st</a> <a id="2106" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2106" class="Bound">tx</a> <a id="2109" class="Symbol">=</a>
    <a id="2115" class="Keyword">let</a> <a id="2119" class="Keyword">open</a> <a id="2124" href="Ledger.Conway.Transaction.html#4227" class="Module">Tx</a> <a id="2127" class="Symbol">(</a><a id="2128" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2133" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2106" class="Bound">tx</a><a id="2135" class="Symbol">)</a>
        <a id="2145" class="Keyword">open</a> <a id="2150" href="Ledger.Conway.Transaction.html#2714" class="Module">TxBody</a> <a id="2157" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a>
        <a id="2170" class="Keyword">open</a> <a id="2175" href="Ledger.Conway.Utxo.html#1390" class="Module">UTxOState</a> <a id="2185" class="Symbol">(</a><a id="2186" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2191" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2103" class="Bound">st</a><a id="2193" class="Symbol">)</a>
        <a id="2203" class="Keyword">open</a> <a id="2208" href="Ledger.Conway.Utxo.html#1038" class="Module">UTxOEnv</a> <a id="2216" class="Symbol">(</a><a id="2217" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2222" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2099" class="Bound">env</a><a id="2225" class="Symbol">)</a>
     <a id="2232" class="Keyword">in</a> <a id="2235" href="Data.String.Base.html#2826" class="Function">unlines</a> <a id="2243" href="Function.Base.html#1974" class="Function Operator">$</a>
          <a id="2255" class="String">&quot;Consumed:&quot;</a> <a id="2267" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2279" class="Symbol">(</a><a id="2280" class="String">&quot;\tInputs:      \t&quot;</a> <a id="2300" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2303" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2308" class="Symbol">(</a><a id="2309" href="Ledger.Conway.Utxo.html#2239" class="Function">balance</a> <a id="2317" class="Symbol">(</a><a id="2318" href="Ledger.Conway.Utxo.html#1454" class="Function">utxo</a> <a id="2323" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2325" href="Ledger.Conway.Transaction.html#2750" class="Function">txins</a><a id="2330" class="Symbol">)))</a> <a id="2334" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2346" class="Symbol">(</a><a id="2347" class="String">&quot;\tMint:        \t&quot;</a> <a id="2367" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2370" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2375" href="Ledger.Conway.Transaction.html#2872" class="Function">mint</a><a id="2379" class="Symbol">)</a> <a id="2381" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2393" class="Symbol">(</a><a id="2394" class="String">&quot;\tRefunds:     \t&quot;</a> <a id="2414" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2417" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2422" class="Symbol">(</a><a id="2423" href="Ledger.Conway.TokenAlgebra.Base.html#869" class="Function">inject</a> <a id="2430" class="Symbol">(</a><a id="2431" href="Ledger.Conway.Utxo.html#10433" class="Function">depositRefunds</a> <a id="2446" href="Ledger.Conway.Utxo.html#1092" class="Function">pparams</a> <a id="2454" class="Symbol">(</a><a id="2455" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2460" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2103" class="Bound">st</a><a id="2462" class="Symbol">)</a> <a id="2464" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a><a id="2468" class="Symbol">)))</a> <a id="2472" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2484" class="Symbol">(</a><a id="2485" class="String">&quot;\tWithdrawals: \t&quot;</a> <a id="2505" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2508" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2513" class="Symbol">(</a><a id="2514" href="Ledger.Conway.TokenAlgebra.Base.html#869" class="Function">inject</a> <a id="2521" class="Symbol">(</a><a id="2522" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="2530" href="Ledger.Conway.Transaction.html#2982" class="Function">txwdrls</a><a id="2537" class="Symbol">)))</a> <a id="2541" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2553" class="Symbol">(</a><a id="2554" class="String">&quot;\tTotal:       \t&quot;</a> <a id="2574" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2577" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2582" class="Symbol">(</a><a id="2583" href="Ledger.Conway.Utxo.html#10691" class="Function">consumed</a> <a id="2592" href="Ledger.Conway.Utxo.html#1092" class="Function">pparams</a> <a id="2600" class="Symbol">(</a><a id="2601" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2606" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2103" class="Bound">st</a><a id="2608" class="Symbol">)</a> <a id="2610" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a><a id="2614" class="Symbol">))</a> <a id="2617" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2629" class="String">&quot;Produced:&quot;</a> <a id="2641" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2653" class="Symbol">(</a><a id="2654" class="String">&quot;\tOutputs:     \t&quot;</a> <a id="2674" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2677" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2682" class="Symbol">(</a><a id="2683" href="Ledger.Conway.Utxo.html#2239" class="Function">balance</a> <a id="2691" class="Symbol">(</a><a id="2692" href="Ledger.Conway.Utxo.html#2168" class="Function">outs</a> <a id="2697" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a><a id="2701" class="Symbol">)))</a> <a id="2705" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2717" class="Symbol">(</a><a id="2718" class="String">&quot;\tDonations:   \t&quot;</a> <a id="2738" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2741" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2746" class="Symbol">(</a><a id="2747" href="Ledger.Conway.TokenAlgebra.Base.html#869" class="Function">inject</a> <a id="2754" href="Ledger.Conway.Transaction.html#3086" class="Function">txdonation</a><a id="2764" class="Symbol">))</a> <a id="2767" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2779" class="Symbol">(</a><a id="2780" class="String">&quot;\tDeposits:    \t&quot;</a> <a id="2800" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2803" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2808" class="Symbol">(</a><a id="2809" href="Ledger.Conway.TokenAlgebra.Base.html#869" class="Function">inject</a> <a id="2816" class="Symbol">(</a><a id="2817" href="Ledger.Conway.Utxo.html#10565" class="Function">newDeposits</a> <a id="2829" href="Ledger.Conway.Utxo.html#1092" class="Function">pparams</a> <a id="2837" class="Symbol">(</a><a id="2838" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2843" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2103" class="Bound">st</a><a id="2845" class="Symbol">)</a> <a id="2847" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a><a id="2851" class="Symbol">)))</a> <a id="2855" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2867" class="Symbol">(</a><a id="2868" class="String">&quot;\tFees:        \t&quot;</a> <a id="2888" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2891" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2896" class="Symbol">(</a><a id="2897" href="Ledger.Conway.TokenAlgebra.Base.html#869" class="Function">inject</a> <a id="2904" href="Ledger.Conway.Transaction.html#2844" class="Function">txfee</a><a id="2909" class="Symbol">))</a> <a id="2912" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="2924" class="Symbol">(</a><a id="2925" class="String">&quot;\tTotal:       \t&quot;</a> <a id="2945" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="2948" href="Class.Show.Core.html#187" class="Field">show</a> <a id="2953" class="Symbol">(</a><a id="2954" href="Ledger.Conway.Utxo.html#10899" class="Function">produced</a> <a id="2963" href="Ledger.Conway.Utxo.html#1092" class="Function">pparams</a> <a id="2971" class="Symbol">(</a><a id="2972" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2977" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2103" class="Bound">st</a><a id="2979" class="Symbol">)</a> <a id="2981" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a><a id="2985" class="Symbol">))</a> <a id="2988" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3000" class="String">&quot;&quot;</a> <a id="3003" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3015" class="String">&quot;Reference Scripts Info:&quot;</a> <a id="3041" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3053" class="Symbol">(</a><a id="3054" class="String">&quot;\tTotal size: \t&quot;</a> <a id="3073" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#221" class="Function Operator">+ˢ</a> <a id="3076" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3081" class="Symbol">(</a><a id="3082" href="Ledger.Conway.Utxo.html#2394" class="Function">refScriptsSize</a> <a id="3097" href="Ledger.Conway.Utxo.html#1454" class="Function">utxo</a> <a id="3102" class="Symbol">(</a><a id="3103" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3108" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2106" class="Bound">tx</a><a id="3110" class="Symbol">)))</a> <a id="3114" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="3126" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="3132" class="Symbol">{-#</a> <a id="3136" class="Keyword">COMPILE</a> <a id="3144" class="Keyword">GHC</a> <a id="3148" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#2030" class="Function">utxo-debug</a> <a id="3159" class="Pragma">as</a> <a id="3162" class="Pragma">utxoDebug</a> <a id="3172" class="Symbol">#-}</a>

  <a id="3179" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3179" class="Function">utxow-debug</a> <a id="3191" class="Symbol">:</a> <a id="3193" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3200" class="Symbol">(</a><a id="3201" href="Ledger.Conway.Utxo.html#1038" class="Record">UTxOEnv</a> <a id="3209" class="Symbol">→</a> <a id="3211" href="Ledger.Conway.Utxo.html#1390" class="Record">UTxOState</a> <a id="3221" class="Symbol">→</a> <a id="3223" href="Ledger.Conway.Transaction.html#4227" class="Record">Tx</a> <a id="3226" class="Symbol">→</a> <a id="3228" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="3234" class="Symbol">)</a>
  <a id="3238" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3179" class="Function">utxow-debug</a> <a id="3250" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3250" class="Bound">env</a> <a id="3254" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3254" class="Bound">st</a> <a id="3257" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3257" class="Bound">tx</a> <a id="3260" class="Symbol">=</a>
    <a id="3266" class="Keyword">let</a> <a id="3270" class="Keyword">open</a> <a id="3275" href="Ledger.Conway.Transaction.html#4227" class="Module">Tx</a> <a id="3278" class="Symbol">(</a><a id="3279" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3284" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3257" class="Bound">tx</a><a id="3286" class="Symbol">)</a>
        <a id="3296" class="Keyword">open</a> <a id="3301" href="Ledger.Conway.Transaction.html#2714" class="Module">TxBody</a> <a id="3308" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a>
        <a id="3321" class="Keyword">open</a> <a id="3326" href="Ledger.Conway.Utxo.html#1390" class="Module">UTxOState</a> <a id="3336" class="Symbol">(</a><a id="3337" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3342" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3254" class="Bound">st</a><a id="3344" class="Symbol">)</a>
        <a id="3354" class="Keyword">open</a> <a id="3359" href="Ledger.Conway.Utxo.html#1038" class="Module">UTxOEnv</a> <a id="3367" class="Symbol">(</a><a id="3368" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3373" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3250" class="Bound">env</a><a id="3376" class="Symbol">)</a>
        <a id="3386" class="Keyword">open</a> <a id="3391" href="Ledger.Conway.Transaction.html#3982" class="Module">TxWitnesses</a> <a id="3403" class="Symbol">(</a><a id="3404" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3411" class="Symbol">⦃</a> <a id="3413" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3421" class="Symbol">⦄</a> <a id="3423" href="Ledger.Conway.Transaction.html#4283" class="Function">wits</a><a id="3427" class="Symbol">)</a>
        <a id="3437" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3437" class="Bound">neededScriptHashes</a> <a id="3456" class="Symbol">=</a> <a id="3458" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3469" class="Symbol">(</a><a id="3470" href="Ledger.Conway.Address.html#755" class="Function">isScriptObj</a>  <a id="3483" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3485" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3490" class="Symbol">)</a> <a id="3492" class="Symbol">(</a><a id="3493" href="Ledger.Conway.Script.Validation.html#2335" class="Function">credsNeeded</a> <a id="3505" href="Ledger.Conway.Utxo.html#1454" class="Function">utxo</a> <a id="3510" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a><a id="3514" class="Symbol">)</a>
        <a id="3524" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3524" class="Bound">neededVKeyHashes</a>   <a id="3543" class="Symbol">=</a> <a id="3545" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3556" class="Symbol">(</a><a id="3557" href="Ledger.Conway.Address.html#474" class="Function">isKeyHashObj</a> <a id="3570" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3572" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3577" class="Symbol">)</a> <a id="3579" class="Symbol">(</a><a id="3580" href="Ledger.Conway.Script.Validation.html#2335" class="Function">credsNeeded</a> <a id="3592" href="Ledger.Conway.Utxo.html#1454" class="Function">utxo</a> <a id="3597" href="Ledger.Conway.Transaction.html#4259" class="Function">body</a><a id="3601" class="Symbol">)</a>
        <a id="3611" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3611" class="Bound">refScriptHashes</a> <a id="3627" class="Symbol">=</a> <a id="3629" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a>
          <a id="3644" href="Interface.Hashable.html#205" class="Field">hash</a> 
          <a id="3660" class="Symbol">(</a><a id="3661" href="Ledger.Conway.Transaction.html#5554" class="Function">refScripts</a> <a id="3672" class="Symbol">(</a><a id="3673" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3680" class="Symbol">⦃</a> <a id="3682" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3690" class="Symbol">⦄</a> <a id="3692" class="Symbol">(</a><a id="3693" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3698" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3257" class="Bound">tx</a><a id="3700" class="Symbol">))</a> <a id="3703" class="Symbol">(</a><a id="3704" href="Foreign.Haskell.Coerce.html#2740" class="Postulate">coerce</a> <a id="3711" class="Symbol">⦃</a> <a id="3713" href="Foreign.Haskell.Coerce.html#2408" class="InductiveConstructor">TrustMe</a> <a id="3721" class="Symbol">⦄</a> <a id="3723" href="Ledger.Conway.Utxo.html#1454" class="Function">utxo</a><a id="3727" class="Symbol">))</a>
        <a id="3738" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3738" class="Bound">witsScriptHashes</a>  <a id="3756" class="Symbol">=</a> <a id="3758" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3763" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="3768" href="Ledger.Conway.Transaction.html#4051" class="Function">scripts</a>
     <a id="3781" class="Keyword">in</a> <a id="3784" href="Data.String.Base.html#2826" class="Function">unlines</a>
       <a id="3799" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3801" class="String">&quot;neededVKeyHashes utxo txb = &quot;</a>
       <a id="3839" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3841" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3846" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3524" class="Bound">neededVKeyHashes</a>
       <a id="3870" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3872" class="String">&quot;\nwitsKeyHashes = &quot;</a>
       <a id="3900" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3902" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3907" class="Symbol">(</a><a id="3908" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3913" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="3918" class="Symbol">(</a><a id="3919" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3923" href="Ledger.Conway.Transaction.html#4023" class="Function">vkSigs</a><a id="3929" class="Symbol">))</a>
       <a id="3939" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3941" class="String">&quot;\nneededScriptHashes = &quot;</a>
       <a id="3974" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3976" href="Class.Show.Core.html#187" class="Field">show</a> <a id="3981" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3437" class="Bound">neededScriptHashes</a>
       <a id="4007" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4009" class="String">&quot;\nrefScriptHashes = &quot;</a>
       <a id="4039" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4041" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4046" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3611" class="Bound">refScriptHashes</a>
       <a id="4069" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4071" class="String">&quot;\nwitsScriptHashes = &quot;</a>
       <a id="4102" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4104" href="Class.Show.Core.html#187" class="Field">show</a> <a id="4109" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3738" class="Bound">witsScriptHashes</a>
       <a id="4133" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4135" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="4141" class="Symbol">{-#</a> <a id="4145" class="Keyword">COMPILE</a> <a id="4153" class="Keyword">GHC</a> <a id="4157" href="Ledger.Conway.Foreign.HSLedger.Utxo.html#3179" class="Function">utxow-debug</a> <a id="4169" class="Pragma">as</a> <a id="4172" class="Pragma">utxowDebug</a> <a id="4183" class="Symbol">#-}</a>
</pre></body></html>