<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.TokenAlgebra</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>
<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Prelude.html" class="Module">Prelude</a> <a id="45" class="Keyword">using</a> <a id="51" class="Symbol">(</a><a id="52" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="56" class="Symbol">)</a>
<a id="58" class="Keyword">module</a> <a id="65" href="Ledger.Conway.TokenAlgebra.html" class="Module">Ledger.Conway.TokenAlgebra</a> <a id="92" class="Symbol">(</a>


  <a id="98" href="Ledger.Conway.TokenAlgebra.html#98" class="Bound">PolicyId</a>



  <a id="112" class="Symbol">:</a> <a id="114" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="118" class="Symbol">)</a> <a id="120" class="Keyword">where</a>
<a id="126" class="Keyword">open</a> <a id="131" class="Keyword">import</a> <a id="138" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="154" class="Keyword">open</a> <a id="159" class="Keyword">import</a> <a id="166" href="Algebra.html" class="Module">Algebra</a>              <a id="187" class="Keyword">using</a> <a id="193" class="Symbol">(</a><a id="194" href="Algebra.Bundles.html#7315" class="Record">Monoid</a><a id="200" class="Symbol">)</a>
<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Algebra.Morphism.html" class="Module">Algebra.Morphism</a>     <a id="235" class="Keyword">using</a> <a id="241" class="Symbol">(</a><a id="242" class="Keyword">module</a> <a id="249" href="Algebra.Morphism.Structures.html#4053" class="Module">MonoidMorphisms</a> <a id="265" class="Symbol">)</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>  <a id="300" class="Keyword">using</a> <a id="306" class="Symbol">(</a><a id="307" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="317" class="Symbol">)</a>
<a id="319" class="Keyword">open</a> <a id="324" class="Keyword">import</a> <a id="331" href="Relation.Binary.html" class="Module">Relation.Binary</a>      <a id="352" class="Keyword">using</a> <a id="358" class="Symbol">(</a><a id="359" href="Relation.Binary.Core.html#896" class="Function">Rel</a><a id="362" class="Symbol">)</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Relation.Unary.html" class="Module">Relation.Unary</a>       <a id="397" class="Keyword">using</a> <a id="403" class="Symbol">(</a><a id="404" href="Relation.Unary.html#1178" class="Function">Pred</a><a id="408" class="Symbol">)</a>

<a id="MemoryEstimate"></a><a id="411" href="Ledger.Conway.TokenAlgebra.html#411" class="Function">MemoryEstimate</a> <a id="426" class="Symbol">:</a> <a id="428" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="432" href="Ledger.Conway.TokenAlgebra.html#411" class="Function">MemoryEstimate</a> <a id="447" class="Symbol">=</a> <a id="449" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>


<a id="453" class="Keyword">record</a> <a id="TokenAlgebra"></a><a id="460" href="Ledger.Conway.TokenAlgebra.html#460" class="Record">TokenAlgebra</a> <a id="473" class="Symbol">:</a> <a id="475" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="481" class="Keyword">where</a>
  <a id="489" class="Keyword">field</a>
    <a id="TokenAlgebra.Value"></a><a id="499" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a> <a id="505" class="Symbol">:</a> <a id="507" href="Agda.Primitive.html#388" class="Primitive">Set</a>
    <a id="515" class="Symbol">⦃</a> <a id="TokenAlgebra.Value-CommutativeMonoid"></a><a id="517" href="Ledger.Conway.TokenAlgebra.html#517" class="Field">Value-CommutativeMonoid</a> <a id="541" class="Symbol">⦄</a> <a id="543" class="Symbol">:</a> <a id="545" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="563" href="Level.html#521" class="Function">0ℓ</a> <a id="566" href="Level.html#521" class="Function">0ℓ</a> <a id="569" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a>



  <a id="580" class="Keyword">open</a> <a id="585" href="Algebra.Bundles.html#7886" class="Module">Algebra.CommutativeMonoid</a> <a id="611" class="Symbol">(</a><a id="612" href="Class.CommutativeMonoid.Core.html#507" class="Function">Conversion.toBundle</a> <a id="632" href="Ledger.Conway.TokenAlgebra.html#517" class="Field">Value-CommutativeMonoid</a><a id="655" class="Symbol">)</a> <a id="657" class="Keyword">public</a>
    <a id="668" class="Keyword">using</a> <a id="674" class="Symbol">(</a><a id="675" href="Algebra.Bundles.html#8008" class="Field Operator">_≈_</a> <a id="679" class="Symbol">;</a> <a id="681" href="Algebra.Bundles.html#8086" class="Field">ε</a> <a id="683" class="Symbol">;</a> <a id="685" href="Algebra.Bundles.html#8230" class="Function">monoid</a> <a id="692" class="Symbol">;</a> <a id="694" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a><a id="703" class="Symbol">)</a>
    <a id="709" class="Keyword">renaming</a> <a id="718" class="Symbol">(</a><a id="719" href="Algebra.Bundles.html#8048" class="Field Operator">_∙_</a> <a id="723" class="Symbol">to</a> <a id="726" class="Field Operator">_+ᵛ_</a><a id="730" class="Symbol">)</a>

  <a id="735" class="Keyword">open</a> <a id="740" href="Algebra.Morphism.Structures.html#4053" class="Module">MonoidMorphisms</a> <a id="756" class="Symbol">(</a><a id="757" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a><a id="766" class="Symbol">)</a> <a id="768" class="Symbol">(</a><a id="769" href="Algebra.Bundles.html#7708" class="Function">Monoid.rawMonoid</a> <a id="786" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="796" class="Symbol">)</a> <a id="798" class="Keyword">public</a>
  <a id="807" class="Keyword">field</a>


    <a id="TokenAlgebra.coin"></a><a id="819" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a>                      <a id="845" class="Symbol">:</a> <a id="847" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a> <a id="853" class="Symbol">→</a> <a id="855" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="TokenAlgebra.inject"></a><a id="864" href="Ledger.Conway.TokenAlgebra.html#864" class="Field">inject</a>                    <a id="890" class="Symbol">:</a> <a id="892" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="897" class="Symbol">→</a> <a id="899" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a>
    <a id="TokenAlgebra.policies"></a><a id="909" href="Ledger.Conway.TokenAlgebra.html#909" class="Field">policies</a>                  <a id="935" class="Symbol">:</a> <a id="937" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a> <a id="943" class="Symbol">→</a> <a id="945" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="947" href="Ledger.Conway.TokenAlgebra.html#98" class="Bound">PolicyId</a>
    <a id="TokenAlgebra.size"></a><a id="960" href="Ledger.Conway.TokenAlgebra.html#960" class="Field">size</a>                      <a id="986" class="Symbol">:</a> <a id="988" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a> <a id="994" class="Symbol">→</a> <a id="996" href="Ledger.Conway.TokenAlgebra.html#411" class="Function">MemoryEstimate</a>
    <a id="TokenAlgebra._≤ᵗ_"></a><a id="1015" href="Ledger.Conway.TokenAlgebra.html#1015" class="Field Operator">_≤ᵗ_</a>                      <a id="1041" class="Symbol">:</a> <a id="1043" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a> <a id="1049" class="Symbol">→</a> <a id="1051" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a> <a id="1057" class="Symbol">→</a> <a id="1059" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="TokenAlgebra.coin∘inject≗id"></a><a id="1068" href="Ledger.Conway.TokenAlgebra.html#1068" class="Field">coin∘inject≗id</a>            <a id="1094" class="Symbol">:</a> <a id="1096" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a> <a id="1101" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1103" href="Ledger.Conway.TokenAlgebra.html#864" class="Field">inject</a> <a id="1110" href="Relation.Binary.PropositionalEquality.Core.html#1012" class="Function Operator">≗</a> <a id="1112" href="Function.Base.html#704" class="Function">id</a>
    <a id="TokenAlgebra.coinIsMonoidHomomorphism"></a><a id="1119" href="Ledger.Conway.TokenAlgebra.html#1119" class="Field">coinIsMonoidHomomorphism</a>  <a id="1145" class="Symbol">:</a> <a id="1147" href="Algebra.Morphism.Structures.html#4393" class="Record">IsMonoidHomomorphism</a> <a id="1168" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a>



    <a id="1180" class="Symbol">⦃</a> <a id="TokenAlgebra.DecEq-Value"></a><a id="1182" href="Ledger.Conway.TokenAlgebra.html#1182" class="Field">DecEq-Value</a> <a id="1194" class="Symbol">⦄</a> <a id="1196" class="Symbol">:</a> <a id="1198" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1204" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a>
    <a id="1214" class="Symbol">⦃</a> <a id="TokenAlgebra.Dec-≤ᵗ"></a><a id="1216" href="Ledger.Conway.TokenAlgebra.html#1216" class="Field">Dec-≤ᵗ</a> <a id="1223" class="Symbol">⦄</a>      <a id="1230" class="Symbol">:</a> <a id="1232" href="Ledger.Conway.TokenAlgebra.html#1015" class="Field Operator">_≤ᵗ_</a> <a id="1237" href="Class.Decidable.Core.html#773" class="Function Operator">⁇²</a>

  <a id="1243" class="Keyword">instance</a>
    <a id="TokenAlgebra.addValue"></a><a id="1256" href="Ledger.Conway.TokenAlgebra.html#1256" class="Function">addValue</a> <a id="1265" class="Symbol">:</a> <a id="1267" href="Class.HasAdd.Core.html#104" class="Record">HasAdd</a> <a id="1274" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a>
    <a id="1284" href="Ledger.Conway.TokenAlgebra.html#1256" class="Function">addValue</a> <a id="1293" class="Symbol">=</a> <a id="1295" class="Keyword">record</a> <a id="1302" class="Symbol">{</a> <a id="1304" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="1308" class="Symbol">=</a> <a id="1310" href="Ledger.Conway.TokenAlgebra.html#726" class="Function Operator">_+ᵛ_</a> <a id="1315" class="Symbol">}</a>

  <a id="TokenAlgebra.coin-inject-lemma"></a><a id="1320" href="Ledger.Conway.TokenAlgebra.html#1320" class="Function">coin-inject-lemma</a> <a id="1338" class="Symbol">:</a> <a id="1340" class="Symbol">∀</a> <a id="1342" class="Symbol">{</a><a id="1343" href="Ledger.Conway.TokenAlgebra.html#1343" class="Bound">val</a><a id="1346" class="Symbol">}</a> <a id="1348" class="Symbol">{</a><a id="1349" href="Ledger.Conway.TokenAlgebra.html#1349" class="Bound">c</a><a id="1350" class="Symbol">}</a> <a id="1352" class="Symbol">→</a> <a id="1354" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a> <a id="1359" class="Symbol">(</a><a id="1360" href="Ledger.Conway.TokenAlgebra.html#1343" class="Bound">val</a> <a id="1364" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1366" href="Ledger.Conway.TokenAlgebra.html#864" class="Field">inject</a> <a id="1373" href="Ledger.Conway.TokenAlgebra.html#1349" class="Bound">c</a><a id="1374" class="Symbol">)</a> <a id="1376" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1378" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a> <a id="1383" href="Ledger.Conway.TokenAlgebra.html#1343" class="Bound">val</a> <a id="1387" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1389" href="Ledger.Conway.TokenAlgebra.html#1349" class="Bound">c</a>
  <a id="1393" href="Ledger.Conway.TokenAlgebra.html#1320" class="Function">coin-inject-lemma</a> <a id="1411" class="Symbol">{</a><a id="1412" href="Ledger.Conway.TokenAlgebra.html#1412" class="Bound">val</a><a id="1415" class="Symbol">}</a> <a id="1417" class="Symbol">{</a><a id="1418" href="Ledger.Conway.TokenAlgebra.html#1418" class="Bound">c</a><a id="1419" class="Symbol">}</a> <a id="1421" class="Symbol">=</a> <a id="1423" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="1433" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a> <a id="1438" class="Symbol">(</a><a id="1439" href="Ledger.Conway.TokenAlgebra.html#1412" class="Bound">val</a> <a id="1443" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1445" href="Ledger.Conway.TokenAlgebra.html#864" class="Field">inject</a> <a id="1452" href="Ledger.Conway.TokenAlgebra.html#1418" class="Bound">c</a><a id="1453" class="Symbol">)</a>         <a id="1463" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1466" href="Algebra.Morphism.Structures.html#2891" class="Function">homo</a> <a id="1471" href="Ledger.Conway.TokenAlgebra.html#1119" class="Field">coinIsMonoidHomomorphism</a> <a id="1496" href="Ledger.Conway.TokenAlgebra.html#1412" class="Bound">val</a> <a id="1500" class="Symbol">(</a><a id="1501" href="Ledger.Conway.TokenAlgebra.html#864" class="Field">inject</a> <a id="1508" href="Ledger.Conway.TokenAlgebra.html#1418" class="Bound">c</a><a id="1509" class="Symbol">)</a> <a id="1511" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1517" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a> <a id="1522" href="Ledger.Conway.TokenAlgebra.html#1412" class="Bound">val</a> <a id="1526" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1528" class="Symbol">(</a><a id="1529" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a> <a id="1534" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1536" href="Ledger.Conway.TokenAlgebra.html#864" class="Field">inject</a><a id="1542" class="Symbol">)</a> <a id="1544" href="Ledger.Conway.TokenAlgebra.html#1418" class="Bound">c</a>  <a id="1547" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1550" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="1555" class="Symbol">(</a><a id="1556" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a> <a id="1561" href="Ledger.Conway.TokenAlgebra.html#1412" class="Bound">val</a> <a id="1565" href="Class.HasAdd.Core.html#162" class="Field Operator">+_</a><a id="1567" class="Symbol">)</a> <a id="1569" class="Symbol">(</a><a id="1570" href="Ledger.Conway.TokenAlgebra.html#1068" class="Field">coin∘inject≗id</a> <a id="1585" href="Ledger.Conway.TokenAlgebra.html#1418" class="Bound">c</a><a id="1586" class="Symbol">)</a> <a id="1588" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1594" href="Ledger.Conway.TokenAlgebra.html#819" class="Field">coin</a> <a id="1599" href="Ledger.Conway.TokenAlgebra.html#1412" class="Bound">val</a> <a id="1603" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1605" href="Ledger.Conway.TokenAlgebra.html#1418" class="Bound">c</a>                  <a id="1624" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
    <a id="1630" class="Keyword">where</a>
    <a id="1640" class="Keyword">open</a> <a id="1645" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>
    <a id="1661" class="Keyword">open</a> <a id="1666" href="Algebra.Morphism.Structures.html#4393" class="Module">MonoidMorphisms.IsMonoidHomomorphism</a>


  <a id="TokenAlgebra.sumᵛ"></a><a id="1707" href="Ledger.Conway.TokenAlgebra.html#1707" class="Function">sumᵛ</a> <a id="1712" class="Symbol">:</a> <a id="1714" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1719" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a> <a id="1725" class="Symbol">→</a> <a id="1727" href="Ledger.Conway.TokenAlgebra.html#499" class="Field">Value</a>
  <a id="1735" href="Ledger.Conway.TokenAlgebra.html#1707" class="Function">sumᵛ</a> <a id="1740" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1743" class="Symbol">=</a> <a id="1745" href="Ledger.Conway.TokenAlgebra.html#864" class="Field">inject</a> <a id="1752" class="Number">0</a>
  <a id="1756" href="Ledger.Conway.TokenAlgebra.html#1707" class="Function">sumᵛ</a> <a id="1761" class="Symbol">(</a><a id="1762" href="Ledger.Conway.TokenAlgebra.html#1762" class="Bound">x</a> <a id="1764" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1766" href="Ledger.Conway.TokenAlgebra.html#1766" class="Bound">l</a><a id="1767" class="Symbol">)</a> <a id="1769" class="Symbol">=</a> <a id="1771" href="Ledger.Conway.TokenAlgebra.html#1762" class="Bound">x</a> <a id="1773" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1775" href="Ledger.Conway.TokenAlgebra.html#1707" class="Function">sumᵛ</a> <a id="1780" href="Ledger.Conway.TokenAlgebra.html#1766" class="Bound">l</a>

</pre></body></html>