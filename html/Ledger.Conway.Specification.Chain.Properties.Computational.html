<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Chain.Properties.Computational</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Ledger.Conway.Specification.Transaction.html#999" class="Record">TransactionStructure</a><a id="104" class="Symbol">)</a>
<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a> <a id="155" class="Keyword">using</a> <a id="161" class="Symbol">(</a><a id="162" href="Ledger.Conway.Specification.Abstract.html#654" class="Record">AbstractFunctions</a><a id="179" class="Symbol">)</a>

<a id="182" class="Keyword">module</a> <a id="189" href="Ledger.Conway.Specification.Chain.Properties.Computational.html" class="Module">Ledger.Conway.Specification.Chain.Properties.Computational</a>
  <a id="250" class="Symbol">(</a><a id="251" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a> <a id="255" class="Symbol">:</a> <a id="257" class="Symbol">_)</a> <a id="260" class="Symbol">(</a><a id="261" class="Keyword">open</a> <a id="266" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="287" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a><a id="290" class="Symbol">)</a>
  <a id="294" class="Symbol">(</a><a id="295" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#295" class="Bound">abs</a> <a id="299" class="Symbol">:</a> <a id="301" href="Ledger.Conway.Specification.Abstract.html#654" class="Record">AbstractFunctions</a> <a id="319" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a><a id="322" class="Symbol">)</a> <a id="324" class="Symbol">(</a><a id="325" class="Keyword">open</a> <a id="330" href="Ledger.Conway.Specification.Abstract.html#654" class="Module">AbstractFunctions</a> <a id="348" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#295" class="Bound">abs</a><a id="351" class="Symbol">)</a>
  <a id="355" class="Keyword">where</a>
<a id="361" class="Keyword">open</a> <a id="366" class="Keyword">import</a> <a id="373" href="Ledger.Conway.Specification.BlockBody.Properties.Computational.html" class="Module">Ledger.Conway.Specification.BlockBody.Properties.Computational</a> <a id="436" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a> <a id="440" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#295" class="Bound">abs</a>
<a id="444" class="Keyword">open</a> <a id="449" class="Keyword">import</a> <a id="456" href="Ledger.Conway.Specification.Chain.html" class="Module">Ledger.Conway.Specification.Chain</a> <a id="490" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a> <a id="494" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#295" class="Bound">abs</a>
<a id="498" class="Keyword">open</a> <a id="503" class="Keyword">import</a> <a id="510" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="544" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a> <a id="557" class="Keyword">using</a> <a id="563" class="Symbol">(</a><a id="564" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a><a id="574" class="Symbol">)</a>
<a id="576" class="Keyword">open</a> <a id="581" class="Keyword">import</a> <a id="588" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="622" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a> <a id="626" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#295" class="Bound">abs</a>
<a id="630" class="Keyword">open</a> <a id="635" class="Keyword">import</a> <a id="642" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="677" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a> <a id="681" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#295" class="Bound">abs</a>
<a id="685" class="Keyword">open</a> <a id="690" class="Keyword">import</a> <a id="697" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a> <a id="738" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a> <a id="742" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#295" class="Bound">abs</a>
<a id="746" class="Keyword">open</a> <a id="751" class="Keyword">import</a> <a id="758" href="Ledger.Conway.Specification.RewardUpdate.Properties.Computational.html" class="Module">Ledger.Conway.Specification.RewardUpdate.Properties.Computational</a> <a id="824" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#251" class="Bound">txs</a> <a id="828" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#295" class="Bound">abs</a>
<a id="832" class="Keyword">open</a> <a id="837" class="Keyword">import</a> <a id="844" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="860" class="Keyword">open</a> <a id="865" href="Interface.ComputationalRelation.html#2804" class="Module">Computational</a> <a id="879" class="Symbol">⦃...⦄</a>

<a id="886" class="Keyword">module</a> <a id="893" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#893" class="Module">_</a>
  <a id="897" class="Symbol">(</a><a id="898" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#898" class="Bound">nes</a> <a id="902" class="Symbol">:</a> <a id="904" href="Ledger.Conway.Specification.Epoch.html#3119" class="Record">NewEpochState</a><a id="917" class="Symbol">)</a>
  <a id="921" class="Symbol">(</a><a id="922" class="Keyword">open</a> <a id="927" href="Ledger.Conway.Specification.Epoch.html#1703" class="Module">EpochState</a> <a id="938" class="Symbol">(</a><a id="939" href="Ledger.Conway.Specification.Epoch.html#3240" class="Field">NewEpochState.epochState</a> <a id="964" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#898" class="Bound">nes</a><a id="967" class="Symbol">)</a> <a id="969" class="Keyword">using</a> <a id="975" class="Symbol">(</a><a id="976" href="Ledger.Conway.Specification.Epoch.html#1820" class="Field">ls</a><a id="978" class="Symbol">)</a> <a id="980" class="Keyword">renaming</a> <a id="989" class="Symbol">(</a><a id="990" href="Ledger.Conway.Specification.Epoch.html#1844" class="Field">es</a> <a id="993" class="Symbol">to</a> <a id="996" class="Field">es&#39;</a><a id="999" class="Symbol">))</a>
  <a id="1004" class="Symbol">(</a><a id="1005" class="Keyword">open</a> <a id="1010" href="Ledger.Conway.Specification.Enact.html#448" class="Module">EnactState</a> <a id="1021" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#996" class="Function">es&#39;</a> <a id="1025" class="Keyword">using</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Ledger.Conway.Specification.Enact.html#658" class="Field">pparams</a><a id="1039" class="Symbol">))</a>
  <a id="1044" class="Symbol">(</a><a id="1045" class="Keyword">open</a> <a id="1050" href="Ledger.Conway.Specification.PParams.html#1685" class="Module">PParams</a> <a id="1058" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="1060" href="Ledger.Conway.Specification.Enact.html#658" class="Function">pparams</a> <a id="1068" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="1070" class="Keyword">using</a> <a id="1076" class="Symbol">(</a><a id="1077" href="Ledger.Conway.Specification.PParams.html#2597" class="Field">maxRefScriptSizePerBlock</a><a id="1101" class="Symbol">))</a>
  <a id="1106" class="Symbol">(</a><a id="1107" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1107" class="Bound">ts</a> <a id="1110" class="Symbol">:</a> <a id="1112" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1117" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a><a id="1119" class="Symbol">)</a>
  <a id="1123" class="Keyword">where</a>
  <a id="1131" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1131" class="Function">refScriptSize≤?Bound</a> <a id="1152" class="Symbol">:</a> <a id="1154" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1158" class="Symbol">(</a><a id="1159" href="Ledger.Conway.Specification.Chain.html#2183" class="Function">totalRefScriptsSize</a> <a id="1179" href="Ledger.Conway.Specification.Epoch.html#1820" class="Function">ls</a> <a id="1182" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1107" class="Bound">ts</a> <a id="1185" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="1187" href="Ledger.Conway.Specification.PParams.html#2597" class="Function">maxRefScriptSizePerBlock</a><a id="1211" class="Symbol">)</a>
  <a id="1215" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1131" class="Function">refScriptSize≤?Bound</a> <a id="1236" class="Symbol">=</a> <a id="1238" href="Ledger.Conway.Specification.Chain.html#2183" class="Function">totalRefScriptsSize</a> <a id="1258" href="Ledger.Conway.Specification.Epoch.html#1820" class="Function">ls</a> <a id="1261" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1107" class="Bound">ts</a> <a id="1264" href="Class.HasOrder.Core.html#1016" class="Function Operator">≤?</a> <a id="1267" href="Ledger.Conway.Specification.PParams.html#2597" class="Function">maxRefScriptSizePerBlock</a>

<a id="1293" class="Keyword">instance</a>
  <a id="Computational-CHAIN"></a><a id="1304" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1304" class="Function">Computational-CHAIN</a> <a id="1324" class="Symbol">:</a> <a id="1326" href="Interface.ComputationalRelation.html#2804" class="Record">Computational</a> <a id="1340" href="Ledger.Conway.Specification.Chain.html#2378" class="Datatype Operator">_⊢_⇀⦇_,CHAIN⦈_</a> <a id="1355" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1364" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1304" class="Function">Computational-CHAIN</a> <a id="1384" class="Symbol">.</a><a id="1385" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1398" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1398" class="Bound">Γ</a> <a id="1400" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1400" class="Bound">s</a> <a id="1402" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1402" class="Bound">b</a> <a id="1404" class="Symbol">=</a> <a id="1406" class="Keyword">do</a>
    <a id="1413" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1413" class="Bound">nes</a> <a id="1417" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1419" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1419" class="Bound">tickStep</a> <a id="1428" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1430" href="Class.Bifunctor.html#1045" class="Function">map₁</a> <a id="1435" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="1442" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1444" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1457" class="Symbol">{</a><a id="1458" class="Argument">STS</a> <a id="1462" class="Symbol">=</a> <a id="1464" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">_⊢_⇀⦇_,TICK⦈_</a><a id="1477" class="Symbol">}</a> <a id="1479" class="Symbol">_</a> <a id="1481" class="Symbol">_</a> <a id="1483" class="Symbol">_</a>
    <a id="1489" class="Symbol">(_</a> <a id="1492" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1494" class="Symbol">_)</a> <a id="1497" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1499" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1499" class="Bound">bbStep</a> <a id="1506" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1508" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1521" class="Symbol">_</a> <a id="1523" class="Symbol">(</a><a id="1524" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a> <a id="1533" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1413" class="Bound">nes</a> <a id="1537" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1539" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1413" class="Bound">nes</a> <a id="1543" class="Symbol">.</a><a id="1544" href="Ledger.Conway.Specification.Epoch.html#3211" class="Field">NewEpochState.bcur</a><a id="1562" class="Symbol">)</a> <a id="1564" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1402" class="Bound">b</a>
    <a id="1570" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1575" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1131" class="Function">refScriptSize≤?Bound</a> <a id="1596" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1413" class="Bound">nes</a> <a id="1600" class="Symbol">(</a><a id="1601" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1402" class="Bound">b</a> <a id="1603" class="Symbol">.</a><a id="1604" href="Ledger.Conway.Specification.BlockBody.html#752" class="Field">Block.ts</a><a id="1612" class="Symbol">)</a> <a id="1614" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1617" class="Symbol">λ</a> <a id="1619" class="Keyword">where</a>
      <a id="1631" class="Symbol">(</a><a id="1632" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1635" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1635" class="Bound">¬p</a><a id="1637" class="Symbol">)</a> <a id="1639" class="Symbol">→</a> <a id="1641" href="Interface.ComputationalRelation.html#352" class="InductiveConstructor">failure</a> <a id="1649" class="String">&quot;totalRefScriptsSize &gt; maxRefScriptSizePerBlock&quot;</a>
      <a id="1704" class="Symbol">(</a><a id="1705" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1709" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1709" class="Bound">p</a><a id="1710" class="Symbol">)</a> <a id="1712" class="Symbol">→</a> <a id="1714" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1722" class="Symbol">(_</a> <a id="1725" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1727" href="Ledger.Conway.Specification.Chain.html#2452" class="InductiveConstructor">CHAIN</a> <a id="1733" class="Symbol">(</a><a id="1734" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1709" class="Bound">p</a> <a id="1736" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1738" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1419" class="Bound">tickStep</a> <a id="1747" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1749" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1499" class="Bound">bbStep</a><a id="1755" class="Symbol">))</a>

  <a id="1761" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1304" class="Function">Computational-CHAIN</a> <a id="1781" class="Symbol">.</a><a id="1782" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="1795" class="Symbol">_</a> <a id="1797" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1797" class="Bound">s</a> <a id="1799" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1799" class="Bound">b</a> <a id="1801" class="Symbol">_</a> <a id="1803" class="Symbol">(</a><a id="1804" href="Ledger.Conway.Specification.Chain.html#2452" class="InductiveConstructor">CHAIN</a> <a id="1810" class="Symbol">{</a><a id="1811" class="Argument">nes</a> <a id="1815" class="Symbol">=</a> <a id="1817" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1817" class="Bound">nes</a><a id="1820" class="Symbol">}</a> <a id="1822" class="Symbol">(</a><a id="1823" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1823" class="Bound">p</a> <a id="1825" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1827" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1827" class="Bound">tickStep</a> <a id="1836" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1838" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1838" class="Bound">bbStep</a><a id="1844" class="Symbol">))</a>
    <a id="1851" class="Keyword">with</a> <a id="1856" href="Interface.ComputationalRelation.html#4355" class="Function">recomputeProof</a> <a id="1871" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1827" class="Bound">tickStep</a> <a id="1880" class="Symbol">|</a> <a id="1882" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="1895" class="Symbol">_</a> <a id="1897" class="Symbol">_</a> <a id="1899" class="Symbol">_</a> <a id="1901" class="Symbol">_</a> <a id="1903" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1827" class="Bound">tickStep</a>
  <a id="1914" class="Symbol">...</a> <a id="1918" class="Symbol">|</a> <a id="1920" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1928" class="Symbol">_</a> <a id="1930" class="Symbol">|</a> <a id="1932" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1941" class="Keyword">with</a> <a id="1946" href="Interface.ComputationalRelation.html#4355" class="Function">recomputeProof</a> <a id="1961" class="Bound">bbStep</a> <a id="1968" class="Symbol">|</a> <a id="1970" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="1983" class="Symbol">_</a> <a id="1985" class="Symbol">_</a> <a id="1987" class="Symbol">_</a> <a id="1989" class="Symbol">_</a> <a id="1991" class="Bound">bbStep</a>
  <a id="2000" class="Symbol">...</a> <a id="2004" class="Symbol">|</a> <a id="2006" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="2014" class="Symbol">_</a> <a id="2016" class="Symbol">|</a> <a id="2018" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="2027" class="Keyword">with</a> <a id="2032" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1131" class="Function">refScriptSize≤?Bound</a> <a id="2053" class="Bound">nes</a> <a id="2057" class="Symbol">(</a><a id="2058" href="Ledger.Conway.Specification.BlockBody.html#752" class="Field">Block.ts</a> <a id="2067" class="Bound">b</a><a id="2068" class="Symbol">)</a>
  <a id="2072" class="Symbol">...</a> <a id="2076" class="Symbol">|</a> <a id="2078" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2082" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2082" class="Bound">p</a> <a id="2084" class="Symbol">=</a> <a id="2086" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="2093" class="Symbol">...</a> <a id="2097" class="Symbol">|</a> <a id="2099" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2102" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2102" class="Bound">¬p</a> <a id="2105" class="Symbol">=</a> <a id="2107" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="2114" class="Symbol">(</a><a id="2115" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2102" class="Bound">¬p</a> <a id="2118" class="Bound">p</a><a id="2119" class="Symbol">)</a>
</pre></body></html>