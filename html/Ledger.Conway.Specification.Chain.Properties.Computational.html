<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Chain.Properties.Computational</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="78" class="Keyword">using</a> <a id="84" class="Symbol">(</a><a id="85" href="Ledger.Conway.Specification.Transaction.html#991" class="Record">TransactionStructure</a><a id="105" class="Symbol">)</a>
<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a> <a id="156" class="Keyword">using</a> <a id="162" class="Symbol">(</a><a id="163" href="Ledger.Conway.Specification.Abstract.html#655" class="Record">AbstractFunctions</a><a id="180" class="Symbol">)</a>

<a id="183" class="Keyword">module</a> <a id="190" href="Ledger.Conway.Specification.Chain.Properties.Computational.html" class="Module">Ledger.Conway.Specification.Chain.Properties.Computational</a>
  <a id="251" class="Symbol">(</a><a id="252" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a> <a id="256" class="Symbol">:</a> <a id="258" class="Symbol">_)</a> <a id="261" class="Symbol">(</a><a id="262" class="Keyword">open</a> <a id="267" href="Ledger.Conway.Specification.Transaction.html#991" class="Module">TransactionStructure</a> <a id="288" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a><a id="291" class="Symbol">)</a>
  <a id="295" class="Symbol">(</a><a id="296" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#296" class="Bound">abs</a> <a id="300" class="Symbol">:</a> <a id="302" href="Ledger.Conway.Specification.Abstract.html#655" class="Record">AbstractFunctions</a> <a id="320" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a><a id="323" class="Symbol">)</a> <a id="325" class="Symbol">(</a><a id="326" class="Keyword">open</a> <a id="331" href="Ledger.Conway.Specification.Abstract.html#655" class="Module">AbstractFunctions</a> <a id="349" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#296" class="Bound">abs</a><a id="352" class="Symbol">)</a>
  <a id="356" class="Keyword">where</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Ledger.Conway.Specification.BlockBody.Properties.Computational.html" class="Module">Ledger.Conway.Specification.BlockBody.Properties.Computational</a> <a id="437" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a> <a id="441" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#296" class="Bound">abs</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Ledger.Conway.Specification.Chain.html" class="Module">Ledger.Conway.Specification.Chain</a> <a id="491" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a> <a id="495" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#296" class="Bound">abs</a>
<a id="499" class="Keyword">open</a> <a id="504" class="Keyword">import</a> <a id="511" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="545" href="Ledger.Conway.Specification.Transaction.html#2065" class="Function">govStructure</a> <a id="558" class="Keyword">using</a> <a id="564" class="Symbol">(</a><a id="565" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a><a id="575" class="Symbol">)</a>
<a id="577" class="Keyword">open</a> <a id="582" class="Keyword">import</a> <a id="589" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="623" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a> <a id="627" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#296" class="Bound">abs</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="678" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a> <a id="682" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#296" class="Bound">abs</a>
<a id="686" class="Keyword">open</a> <a id="691" class="Keyword">import</a> <a id="698" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a> <a id="739" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a> <a id="743" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#296" class="Bound">abs</a>
<a id="747" class="Keyword">open</a> <a id="752" class="Keyword">import</a> <a id="759" href="Ledger.Conway.Specification.RewardUpdate.Properties.Computational.html" class="Module">Ledger.Conway.Specification.RewardUpdate.Properties.Computational</a> <a id="825" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#252" class="Bound">txs</a> <a id="829" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#296" class="Bound">abs</a>
<a id="833" class="Keyword">open</a> <a id="838" class="Keyword">import</a> <a id="845" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="861" class="Keyword">open</a> <a id="866" href="Interface.ComputationalRelation.html#2804" class="Module">Computational</a> <a id="880" class="Symbol">⦃...⦄</a>

<a id="887" class="Keyword">module</a> <a id="894" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#894" class="Module">_</a>
  <a id="898" class="Symbol">(</a><a id="899" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#899" class="Bound">nes</a> <a id="903" class="Symbol">:</a> <a id="905" href="Ledger.Conway.Specification.Epoch.html#3364" class="Record">NewEpochState</a><a id="918" class="Symbol">)</a>
  <a id="922" class="Symbol">(</a><a id="923" class="Keyword">open</a> <a id="928" href="Ledger.Conway.Specification.Epoch.html#1837" class="Module">EpochState</a> <a id="939" class="Symbol">(</a><a id="940" href="Ledger.Conway.Specification.Epoch.html#3485" class="Field">NewEpochState.epochState</a> <a id="965" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#899" class="Bound">nes</a><a id="968" class="Symbol">)</a> <a id="970" class="Keyword">using</a> <a id="976" class="Symbol">(</a><a id="977" href="Ledger.Conway.Specification.Epoch.html#1954" class="Field">ls</a><a id="979" class="Symbol">)</a> <a id="981" class="Keyword">renaming</a> <a id="990" class="Symbol">(</a><a id="991" href="Ledger.Conway.Specification.Epoch.html#1978" class="Field">es</a> <a id="994" class="Symbol">to</a> <a id="997" class="Field">es&#39;</a><a id="1000" class="Symbol">))</a>
  <a id="1005" class="Symbol">(</a><a id="1006" class="Keyword">open</a> <a id="1011" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a> <a id="1022" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#997" class="Function">es&#39;</a> <a id="1026" class="Keyword">using</a> <a id="1032" class="Symbol">(</a><a id="1033" href="Ledger.Conway.Specification.Enact.html#654" class="Field">pparams</a><a id="1040" class="Symbol">))</a>
  <a id="1045" class="Symbol">(</a><a id="1046" class="Keyword">open</a> <a id="1051" href="Ledger.Conway.Specification.PParams.html#1687" class="Module">PParams</a> <a id="1059" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="1061" href="Ledger.Conway.Specification.Enact.html#654" class="Function">pparams</a> <a id="1069" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="1071" class="Keyword">using</a> <a id="1077" class="Symbol">(</a><a id="1078" href="Ledger.Conway.Specification.PParams.html#2599" class="Field">maxRefScriptSizePerBlock</a><a id="1102" class="Symbol">))</a>
  <a id="1107" class="Symbol">(</a><a id="1108" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1108" class="Bound">ts</a> <a id="1111" class="Symbol">:</a> <a id="1113" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1118" href="Ledger.Conway.Specification.Transaction.html#4668" class="Record">Tx</a><a id="1120" class="Symbol">)</a>
  <a id="1124" class="Keyword">where</a>
  <a id="1132" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1132" class="Function">refScriptSize≤?Bound</a> <a id="1153" class="Symbol">:</a> <a id="1155" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1159" class="Symbol">(</a><a id="1160" href="Ledger.Conway.Specification.Chain.html#2182" class="Function">totalRefScriptsSize</a> <a id="1180" href="Ledger.Conway.Specification.Epoch.html#1954" class="Function">ls</a> <a id="1183" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1108" class="Bound">ts</a> <a id="1186" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="1188" href="Ledger.Conway.Specification.PParams.html#2599" class="Function">maxRefScriptSizePerBlock</a><a id="1212" class="Symbol">)</a>
  <a id="1216" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1132" class="Function">refScriptSize≤?Bound</a> <a id="1237" class="Symbol">=</a> <a id="1239" href="Ledger.Conway.Specification.Chain.html#2182" class="Function">totalRefScriptsSize</a> <a id="1259" href="Ledger.Conway.Specification.Epoch.html#1954" class="Function">ls</a> <a id="1262" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1108" class="Bound">ts</a> <a id="1265" href="Class.HasOrder.Core.html#1016" class="Function Operator">≤?</a> <a id="1268" href="Ledger.Conway.Specification.PParams.html#2599" class="Function">maxRefScriptSizePerBlock</a>

<a id="1294" class="Keyword">instance</a>
  <a id="Computational-CHAIN"></a><a id="1305" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1305" class="Function">Computational-CHAIN</a> <a id="1325" class="Symbol">:</a> <a id="1327" href="Interface.ComputationalRelation.html#2804" class="Record">Computational</a> <a id="1341" href="Ledger.Conway.Specification.Chain.html#2374" class="Datatype Operator">_⊢_⇀⦇_,CHAIN⦈_</a> <a id="1356" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1365" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1305" class="Function">Computational-CHAIN</a> <a id="1385" class="Symbol">.</a><a id="1386" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1399" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1399" class="Bound">Γ</a> <a id="1401" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1401" class="Bound">s</a> <a id="1403" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1403" class="Bound">b</a> <a id="1405" class="Symbol">=</a> <a id="1407" class="Keyword">do</a>
    <a id="1414" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1414" class="Bound">nes</a> <a id="1418" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1420" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1420" class="Bound">tickStep</a> <a id="1429" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1431" href="Class.Bifunctor.html#1045" class="Function">map₁</a> <a id="1436" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="1443" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1445" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1458" class="Symbol">{</a><a id="1459" class="Argument">STS</a> <a id="1463" class="Symbol">=</a> <a id="1465" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">_⊢_⇀⦇_,TICK⦈_</a><a id="1478" class="Symbol">}</a> <a id="1480" class="Symbol">_</a> <a id="1482" class="Symbol">_</a> <a id="1484" class="Symbol">_</a>
    <a id="1490" class="Symbol">(_</a> <a id="1493" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1495" class="Symbol">_)</a> <a id="1498" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1500" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1500" class="Bound">bbStep</a> <a id="1507" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1509" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1522" class="Symbol">_</a> <a id="1524" class="Symbol">(</a><a id="1525" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a> <a id="1534" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1414" class="Bound">nes</a> <a id="1538" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1540" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1414" class="Bound">nes</a> <a id="1544" class="Symbol">.</a><a id="1545" href="Ledger.Conway.Specification.Epoch.html#3456" class="Field">NewEpochState.bcur</a><a id="1563" class="Symbol">)</a> <a id="1565" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1403" class="Bound">b</a>
    <a id="1571" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1576" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1132" class="Function">refScriptSize≤?Bound</a> <a id="1597" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1414" class="Bound">nes</a> <a id="1601" class="Symbol">(</a><a id="1602" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1403" class="Bound">b</a> <a id="1604" class="Symbol">.</a><a id="1605" href="Ledger.Conway.Specification.BlockBody.html#752" class="Field">Block.ts</a><a id="1613" class="Symbol">)</a> <a id="1615" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1618" class="Symbol">λ</a> <a id="1620" class="Keyword">where</a>
      <a id="1632" class="Symbol">(</a><a id="1633" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1636" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1636" class="Bound">¬p</a><a id="1638" class="Symbol">)</a> <a id="1640" class="Symbol">→</a> <a id="1642" href="Interface.ComputationalRelation.html#352" class="InductiveConstructor">failure</a> <a id="1650" class="String">&quot;totalRefScriptsSize &gt; maxRefScriptSizePerBlock&quot;</a>
      <a id="1705" class="Symbol">(</a><a id="1706" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1710" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1710" class="Bound">p</a><a id="1711" class="Symbol">)</a> <a id="1713" class="Symbol">→</a> <a id="1715" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1723" class="Symbol">(_</a> <a id="1726" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1728" href="Ledger.Conway.Specification.Chain.html#2443" class="InductiveConstructor">CHAIN</a> <a id="1734" class="Symbol">(</a><a id="1735" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1710" class="Bound">p</a> <a id="1737" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1739" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1420" class="Bound">tickStep</a> <a id="1748" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1750" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1500" class="Bound">bbStep</a><a id="1756" class="Symbol">))</a>

  <a id="1762" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1305" class="Function">Computational-CHAIN</a> <a id="1782" class="Symbol">.</a><a id="1783" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="1796" class="Symbol">_</a> <a id="1798" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1798" class="Bound">s</a> <a id="1800" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1800" class="Bound">b</a> <a id="1802" class="Symbol">_</a> <a id="1804" class="Symbol">(</a><a id="1805" href="Ledger.Conway.Specification.Chain.html#2443" class="InductiveConstructor">CHAIN</a> <a id="1811" class="Symbol">{</a><a id="1812" class="Argument">nes</a> <a id="1816" class="Symbol">=</a> <a id="1818" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1818" class="Bound">nes</a><a id="1821" class="Symbol">}</a> <a id="1823" class="Symbol">(</a><a id="1824" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1824" class="Bound">p</a> <a id="1826" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1828" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1828" class="Bound">tickStep</a> <a id="1837" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1839" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1839" class="Bound">bbStep</a><a id="1845" class="Symbol">))</a>
    <a id="1852" class="Keyword">with</a> <a id="1857" href="Interface.ComputationalRelation.html#4355" class="Function">recomputeProof</a> <a id="1872" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1828" class="Bound">tickStep</a> <a id="1881" class="Symbol">|</a> <a id="1883" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="1896" class="Symbol">_</a> <a id="1898" class="Symbol">_</a> <a id="1900" class="Symbol">_</a> <a id="1902" class="Symbol">_</a> <a id="1904" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1828" class="Bound">tickStep</a>
  <a id="1915" class="Symbol">...</a> <a id="1919" class="Symbol">|</a> <a id="1921" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1929" class="Symbol">_</a> <a id="1931" class="Symbol">|</a> <a id="1933" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1942" class="Keyword">with</a> <a id="1947" href="Interface.ComputationalRelation.html#4355" class="Function">recomputeProof</a> <a id="1962" class="Bound">bbStep</a> <a id="1969" class="Symbol">|</a> <a id="1971" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="1984" class="Symbol">_</a> <a id="1986" class="Symbol">_</a> <a id="1988" class="Symbol">_</a> <a id="1990" class="Symbol">_</a> <a id="1992" class="Bound">bbStep</a>
  <a id="2001" class="Symbol">...</a> <a id="2005" class="Symbol">|</a> <a id="2007" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="2015" class="Symbol">_</a> <a id="2017" class="Symbol">|</a> <a id="2019" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="2028" class="Keyword">with</a> <a id="2033" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1132" class="Function">refScriptSize≤?Bound</a> <a id="2054" class="Bound">nes</a> <a id="2058" class="Symbol">(</a><a id="2059" href="Ledger.Conway.Specification.BlockBody.html#752" class="Field">Block.ts</a> <a id="2068" class="Bound">b</a><a id="2069" class="Symbol">)</a>
  <a id="2073" class="Symbol">...</a> <a id="2077" class="Symbol">|</a> <a id="2079" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2083" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2083" class="Bound">p</a> <a id="2085" class="Symbol">=</a> <a id="2087" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="2094" class="Symbol">...</a> <a id="2098" class="Symbol">|</a> <a id="2100" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2103" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2103" class="Bound">¬p</a> <a id="2106" class="Symbol">=</a> <a id="2108" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="2115" class="Symbol">(</a><a id="2116" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2103" class="Bound">¬p</a> <a id="2119" class="Bound">p</a><a id="2120" class="Symbol">)</a>

</pre></body></html>