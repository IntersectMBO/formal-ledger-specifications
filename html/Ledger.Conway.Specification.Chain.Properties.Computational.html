<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Chain.Properties.Computational</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>
<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="126" class="Keyword">module</a> <a id="133" href="Ledger.Conway.Specification.Chain.Properties.Computational.html" class="Module">Ledger.Conway.Specification.Chain.Properties.Computational</a>
  <a id="194" class="Symbol">(</a><a id="195" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a> <a id="199" class="Symbol">:</a> <a id="201" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="221" class="Symbol">)</a> <a id="223" class="Symbol">(</a><a id="224" class="Keyword">open</a> <a id="229" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="250" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a><a id="253" class="Symbol">)</a>
  <a id="257" class="Symbol">(</a><a id="258" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a> <a id="262" class="Symbol">:</a> <a id="264" href="Ledger.Conway.Specification.Abstract.html#653" class="Record">AbstractFunctions</a> <a id="282" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a><a id="285" class="Symbol">)</a> <a id="287" class="Symbol">(</a><a id="288" class="Keyword">open</a> <a id="293" href="Ledger.Conway.Specification.Abstract.html#653" class="Module">AbstractFunctions</a> <a id="311" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a><a id="314" class="Symbol">)</a>
  <a id="318" class="Keyword">where</a>

<a id="325" class="Keyword">open</a> <a id="330" class="Keyword">import</a> <a id="337" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="353" class="Keyword">open</a> <a id="358" class="Keyword">import</a> <a id="365" href="Ledger.Conway.Specification.BlockBody.Properties.Computational.html" class="Module">Ledger.Conway.Specification.BlockBody.Properties.Computational</a> <a id="428" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a> <a id="432" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Ledger.Conway.Specification.Chain.html" class="Module">Ledger.Conway.Specification.Chain</a> <a id="482" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a> <a id="486" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a>
<a id="490" class="Keyword">open</a> <a id="495" class="Keyword">import</a> <a id="502" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="536" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a> <a id="549" class="Keyword">using</a> <a id="555" class="Symbol">(</a><a id="556" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a><a id="566" class="Symbol">)</a>
<a id="568" class="Keyword">open</a> <a id="573" class="Keyword">import</a> <a id="580" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="614" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a> <a id="618" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a>
<a id="622" class="Keyword">open</a> <a id="627" class="Keyword">import</a> <a id="634" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="669" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a> <a id="673" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a>
<a id="677" class="Keyword">open</a> <a id="682" class="Keyword">import</a> <a id="689" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a> <a id="730" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a> <a id="734" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a>
<a id="738" class="Keyword">open</a> <a id="743" class="Keyword">import</a> <a id="750" href="Ledger.Conway.Specification.RewardUpdate.Properties.Computational.html" class="Module">Ledger.Conway.Specification.RewardUpdate.Properties.Computational</a> <a id="816" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a> <a id="820" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a>
<a id="824" class="Keyword">open</a> <a id="829" class="Keyword">import</a> <a id="836" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="876" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#195" class="Bound">txs</a> <a id="880" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#258" class="Bound">abs</a>

<a id="885" class="Keyword">open</a> <a id="890" href="Interface.ComputationalRelation.html#2804" class="Module">Computational</a> <a id="904" class="Symbol">⦃...⦄</a>

<a id="911" class="Keyword">module</a> <a id="918" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#918" class="Module">_</a>
  <a id="922" class="Symbol">(</a><a id="923" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#923" class="Bound">nes</a> <a id="927" class="Symbol">:</a> <a id="929" href="Ledger.Conway.Specification.Epoch.html#3362" class="Record">NewEpochState</a><a id="942" class="Symbol">)</a>
  <a id="946" class="Symbol">(</a><a id="947" class="Keyword">open</a> <a id="952" href="Ledger.Conway.Specification.Epoch.html#1835" class="Module">EpochState</a> <a id="963" class="Symbol">(</a><a id="964" href="Ledger.Conway.Specification.Epoch.html#3483" class="Field">NewEpochState.epochState</a> <a id="989" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#923" class="Bound">nes</a><a id="992" class="Symbol">)</a> <a id="994" class="Keyword">using</a> <a id="1000" class="Symbol">(</a><a id="1001" href="Ledger.Conway.Specification.Epoch.html#1952" class="Field">ls</a><a id="1003" class="Symbol">)</a> <a id="1005" class="Keyword">renaming</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Ledger.Conway.Specification.Epoch.html#1976" class="Field">es</a> <a id="1018" class="Symbol">to</a> <a id="1021" class="Field">es&#39;</a><a id="1024" class="Symbol">))</a>
  <a id="1029" class="Symbol">(</a><a id="1030" class="Keyword">open</a> <a id="1035" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a> <a id="1046" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1021" class="Function">es&#39;</a> <a id="1050" class="Keyword">using</a> <a id="1056" class="Symbol">(</a><a id="1057" href="Ledger.Conway.Specification.Enact.html#654" class="Field">pparams</a><a id="1064" class="Symbol">))</a>
  <a id="1069" class="Symbol">(</a><a id="1070" class="Keyword">open</a> <a id="1075" href="Ledger.Conway.Specification.PParams.html#1687" class="Module">PParams</a> <a id="1083" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="1085" href="Ledger.Conway.Specification.Enact.html#654" class="Function">pparams</a> <a id="1093" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="1095" class="Keyword">using</a> <a id="1101" class="Symbol">(</a><a id="1102" href="Ledger.Conway.Specification.PParams.html#2599" class="Field">maxRefScriptSizePerBlock</a><a id="1126" class="Symbol">))</a>
  <a id="1131" class="Symbol">(</a><a id="1132" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1132" class="Bound">ts</a> <a id="1135" class="Symbol">:</a> <a id="1137" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1142" href="Ledger.Conway.Specification.Transaction.html#1721" class="Record">Tx</a><a id="1144" class="Symbol">)</a>
  <a id="1148" class="Keyword">where</a>
  <a id="1156" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1156" class="Function">refScriptSize≤?Bound</a> <a id="1177" class="Symbol">:</a> <a id="1179" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1183" class="Symbol">(</a><a id="1184" href="Ledger.Conway.Specification.Chain.html#2348" class="Function">totalRefScriptsSize</a> <a id="1204" href="Ledger.Conway.Specification.Epoch.html#1952" class="Function">ls</a> <a id="1207" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1132" class="Bound">ts</a> <a id="1210" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="1212" href="Ledger.Conway.Specification.PParams.html#2599" class="Function">maxRefScriptSizePerBlock</a><a id="1236" class="Symbol">)</a>
  <a id="1240" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1156" class="Function">refScriptSize≤?Bound</a> <a id="1261" class="Symbol">=</a> <a id="1263" href="Ledger.Conway.Specification.Chain.html#2348" class="Function">totalRefScriptsSize</a> <a id="1283" href="Ledger.Conway.Specification.Epoch.html#1952" class="Function">ls</a> <a id="1286" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1132" class="Bound">ts</a> <a id="1289" href="Class.HasOrder.Core.html#1016" class="Function Operator">≤?</a> <a id="1292" href="Ledger.Conway.Specification.PParams.html#2599" class="Function">maxRefScriptSizePerBlock</a>

<a id="1318" class="Keyword">instance</a>
  <a id="Computational-CHAIN"></a><a id="1329" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1329" class="Function">Computational-CHAIN</a> <a id="1349" class="Symbol">:</a> <a id="1351" href="Interface.ComputationalRelation.html#2804" class="Record">Computational</a> <a id="1365" href="Ledger.Conway.Specification.Chain.html#2503" class="Datatype Operator">_⊢_⇀⦇_,CHAIN⦈_</a> <a id="1380" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1389" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1329" class="Function">Computational-CHAIN</a> <a id="1409" class="Symbol">.</a><a id="1410" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1423" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1423" class="Bound">Γ</a> <a id="1425" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1425" class="Bound">s</a> <a id="1427" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1427" class="Bound">b</a> <a id="1429" class="Symbol">=</a> <a id="1431" class="Keyword">do</a>
    <a id="1438" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1438" class="Bound">nes</a> <a id="1442" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1444" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1444" class="Bound">tickStep</a> <a id="1453" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1455" href="Class.Bifunctor.html#1045" class="Function">map₁</a> <a id="1460" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="1467" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1469" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1482" class="Symbol">{</a><a id="1483" class="Argument">STS</a> <a id="1487" class="Symbol">=</a> <a id="1489" href="Ledger.Conway.Specification.RewardUpdate.html#1202" class="Datatype Operator">_⊢_⇀⦇_,TICK⦈_</a><a id="1502" class="Symbol">}</a> <a id="1504" class="Symbol">_</a> <a id="1506" class="Symbol">_</a> <a id="1508" class="Symbol">_</a>
    <a id="1514" class="Symbol">(_</a> <a id="1517" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1519" class="Symbol">_)</a> <a id="1522" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1524" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1524" class="Bound">bbStep</a> <a id="1531" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1533" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1546" class="Symbol">_</a> <a id="1548" class="Symbol">(</a><a id="1549" href="Ledger.Conway.Specification.Ledger.html#1193" class="Field">LStateOf</a> <a id="1558" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1438" class="Bound">nes</a> <a id="1562" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1564" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1438" class="Bound">nes</a> <a id="1568" class="Symbol">.</a><a id="1569" href="Ledger.Conway.Specification.Epoch.html#3454" class="Field">NewEpochState.bcur</a><a id="1587" class="Symbol">)</a> <a id="1589" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1427" class="Bound">b</a>
    <a id="1595" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1600" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1156" class="Function">refScriptSize≤?Bound</a> <a id="1621" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1438" class="Bound">nes</a> <a id="1625" class="Symbol">(</a><a id="1626" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1427" class="Bound">b</a> <a id="1628" class="Symbol">.</a><a id="1629" href="Ledger.Conway.Specification.BlockBody.html#801" class="Field">Block.ts</a><a id="1637" class="Symbol">)</a> <a id="1639" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1642" class="Symbol">λ</a> <a id="1644" class="Keyword">where</a>
      <a id="1656" class="Symbol">(</a><a id="1657" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1660" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1660" class="Bound">¬p</a><a id="1662" class="Symbol">)</a> <a id="1664" class="Symbol">→</a> <a id="1666" href="Interface.ComputationalRelation.html#352" class="InductiveConstructor">failure</a> <a id="1674" class="String">&quot;totalRefScriptsSize &gt; maxRefScriptSizePerBlock&quot;</a>
      <a id="1729" class="Symbol">(</a><a id="1730" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1734" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1734" class="Bound">p</a><a id="1735" class="Symbol">)</a> <a id="1737" class="Symbol">→</a> <a id="1739" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1747" class="Symbol">(_</a> <a id="1750" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1752" href="Ledger.Conway.Specification.Chain.html#2572" class="InductiveConstructor">CHAIN</a> <a id="1758" class="Symbol">(</a><a id="1759" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1734" class="Bound">p</a> <a id="1761" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1763" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1444" class="Bound">tickStep</a> <a id="1772" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1774" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1524" class="Bound">bbStep</a><a id="1780" class="Symbol">))</a>

  <a id="1786" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1329" class="Function">Computational-CHAIN</a> <a id="1806" class="Symbol">.</a><a id="1807" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="1820" class="Symbol">_</a> <a id="1822" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1822" class="Bound">s</a> <a id="1824" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1824" class="Bound">b</a> <a id="1826" class="Symbol">_</a> <a id="1828" class="Symbol">(</a><a id="1829" href="Ledger.Conway.Specification.Chain.html#2572" class="InductiveConstructor">CHAIN</a> <a id="1835" class="Symbol">{</a><a id="1836" class="Argument">nes</a> <a id="1840" class="Symbol">=</a> <a id="1842" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1842" class="Bound">nes</a><a id="1845" class="Symbol">}</a> <a id="1847" class="Symbol">(</a><a id="1848" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1848" class="Bound">p</a> <a id="1850" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1852" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1852" class="Bound">tickStep</a> <a id="1861" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1863" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1863" class="Bound">bbStep</a><a id="1869" class="Symbol">))</a>
    <a id="1876" class="Keyword">with</a> <a id="1881" href="Interface.ComputationalRelation.html#4355" class="Function">recomputeProof</a> <a id="1896" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1852" class="Bound">tickStep</a> <a id="1905" class="Symbol">|</a> <a id="1907" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="1920" class="Symbol">_</a> <a id="1922" class="Symbol">_</a> <a id="1924" class="Symbol">_</a> <a id="1926" class="Symbol">_</a> <a id="1928" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1852" class="Bound">tickStep</a>
  <a id="1939" class="Symbol">...</a> <a id="1943" class="Symbol">|</a> <a id="1945" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1953" class="Symbol">_</a> <a id="1955" class="Symbol">|</a> <a id="1957" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1966" class="Keyword">with</a> <a id="1971" href="Interface.ComputationalRelation.html#4355" class="Function">recomputeProof</a> <a id="1986" class="Bound">bbStep</a> <a id="1993" class="Symbol">|</a> <a id="1995" href="Interface.ComputationalRelation.html#3101" class="Field">completeness</a> <a id="2008" class="Symbol">_</a> <a id="2010" class="Symbol">_</a> <a id="2012" class="Symbol">_</a> <a id="2014" class="Symbol">_</a> <a id="2016" class="Bound">bbStep</a>
  <a id="2025" class="Symbol">...</a> <a id="2029" class="Symbol">|</a> <a id="2031" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="2039" class="Symbol">_</a> <a id="2041" class="Symbol">|</a> <a id="2043" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="2052" class="Keyword">with</a> <a id="2057" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#1156" class="Function">refScriptSize≤?Bound</a> <a id="2078" class="Bound">nes</a> <a id="2082" class="Symbol">(</a><a id="2083" href="Ledger.Conway.Specification.BlockBody.html#801" class="Field">Block.ts</a> <a id="2092" class="Bound">b</a><a id="2093" class="Symbol">)</a>
  <a id="2097" class="Symbol">...</a> <a id="2101" class="Symbol">|</a> <a id="2103" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2107" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2107" class="Bound">p</a> <a id="2109" class="Symbol">=</a> <a id="2111" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="2118" class="Symbol">...</a> <a id="2122" class="Symbol">|</a> <a id="2124" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2127" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2127" class="Bound">¬p</a> <a id="2130" class="Symbol">=</a> <a id="2132" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="2139" class="Symbol">(</a><a id="2140" href="Ledger.Conway.Specification.Chain.Properties.Computational.html#2127" class="Bound">¬p</a> <a id="2143" class="Bound">p</a><a id="2144" class="Symbol">)</a>

</pre></body></html>