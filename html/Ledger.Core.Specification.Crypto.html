<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Core.Specification.Crypto</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>
<a id="25" class="Keyword">module</a> <a id="32" href="Ledger.Core.Specification.Crypto.html" class="Module">Ledger.Core.Specification.Crypto</a> <a id="65" class="Keyword">where</a>

<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="99" class="Keyword">hiding</a> <a id="106" class="Symbol">(</a><a id="107" href="Data.Bool.Base.html#1348" class="Function">T</a><a id="108" class="Symbol">)</a>

<a id="111" class="Keyword">record</a> <a id="isHashableSet"></a><a id="118" href="Ledger.Core.Specification.Crypto.html#118" class="Record">isHashableSet</a> <a id="132" class="Symbol">(</a><a id="133" href="Ledger.Core.Specification.Crypto.html#133" class="Bound">T</a> <a id="135" class="Symbol">:</a> <a id="137" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="141" class="Symbol">)</a> <a id="143" class="Symbol">:</a> <a id="145" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="151" class="Keyword">where</a>
  <a id="159" class="Keyword">constructor</a> <a id="mkIsHashableSet"></a><a id="171" href="Ledger.Core.Specification.Crypto.html#171" class="InductiveConstructor">mkIsHashableSet</a>
  <a id="189" class="Keyword">field</a> <a id="isHashableSet.THash"></a><a id="195" href="Ledger.Core.Specification.Crypto.html#195" class="Field">THash</a> <a id="201" class="Symbol">:</a> <a id="203" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="216" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-THash"></a><a id="218" href="Ledger.Core.Specification.Crypto.html#218" class="Field">DecEq-THash</a> <a id="230" class="Symbol">⦄</a> <a id="232" class="Symbol">:</a> <a id="234" href="Class.DecEq.Core.html#117" class="Record">DecEq</a>      <a id="245" href="Ledger.Core.Specification.Crypto.html#195" class="Field">THash</a>
        <a id="259" class="Symbol">⦃</a> <a id="isHashableSet.Show-THash"></a><a id="261" href="Ledger.Core.Specification.Crypto.html#261" class="Field">Show-THash</a>  <a id="273" class="Symbol">⦄</a> <a id="275" class="Symbol">:</a> <a id="277" href="Class.Show.Core.html#125" class="Record">Show</a>       <a id="288" href="Ledger.Core.Specification.Crypto.html#195" class="Field">THash</a>
        <a id="302" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-T"></a><a id="304" href="Ledger.Core.Specification.Crypto.html#304" class="Field">DecEq-T</a>     <a id="316" class="Symbol">⦄</a> <a id="318" class="Symbol">:</a> <a id="320" href="Class.DecEq.Core.html#117" class="Record">DecEq</a>    <a id="329" href="Ledger.Core.Specification.Crypto.html#133" class="Bound">T</a>
        <a id="339" class="Symbol">⦃</a> <a id="isHashableSet.T-Hashable"></a><a id="341" href="Ledger.Core.Specification.Crypto.html#341" class="Field">T-Hashable</a>  <a id="353" class="Symbol">⦄</a> <a id="355" class="Symbol">:</a> <a id="357" href="Interface.Hashable.html#158" class="Record">Hashable</a> <a id="366" href="Ledger.Core.Specification.Crypto.html#133" class="Bound">T</a> <a id="368" href="Ledger.Core.Specification.Crypto.html#195" class="Field">THash</a>
<a id="374" class="Keyword">open</a> <a id="379" href="Ledger.Core.Specification.Crypto.html#118" class="Module">isHashableSet</a>

<a id="394" class="Keyword">record</a> <a id="HashableSet"></a><a id="401" href="Ledger.Core.Specification.Crypto.html#401" class="Record">HashableSet</a> <a id="413" class="Symbol">:</a> <a id="415" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="421" class="Keyword">where</a>
  <a id="429" class="Keyword">constructor</a> <a id="mkHashableSet"></a><a id="441" href="Ledger.Core.Specification.Crypto.html#441" class="InductiveConstructor">mkHashableSet</a>
  <a id="457" class="Keyword">field</a> <a id="HashableSet.T"></a><a id="463" href="Ledger.Core.Specification.Crypto.html#463" class="Field">T</a> <a id="465" class="Symbol">:</a> <a id="467" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="471" class="Symbol">;</a> <a id="473" class="Symbol">⦃</a> <a id="HashableSet.T-isHashable"></a><a id="475" href="Ledger.Core.Specification.Crypto.html#475" class="Field">T-isHashable</a> <a id="488" class="Symbol">⦄</a> <a id="490" class="Symbol">:</a> <a id="492" href="Ledger.Core.Specification.Crypto.html#118" class="Record">isHashableSet</a> <a id="506" href="Ledger.Core.Specification.Crypto.html#463" class="Field">T</a>
  <a id="510" class="Keyword">open</a> <a id="515" href="Ledger.Core.Specification.Crypto.html#118" class="Module">isHashableSet</a> <a id="529" href="Ledger.Core.Specification.Crypto.html#475" class="Field">T-isHashable</a> <a id="542" class="Keyword">public</a>


<a id="551" class="Keyword">record</a> <a id="PKKScheme"></a><a id="558" href="Ledger.Core.Specification.Crypto.html#558" class="Record">PKKScheme</a> <a id="568" class="Symbol">:</a> <a id="570" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="576" class="Keyword">where</a>
  <a id="584" class="Keyword">field</a>


    <a id="PKKScheme.SKey"></a><a id="596" href="Ledger.Core.Specification.Crypto.html#596" class="Field">SKey</a> <a id="PKKScheme.VKey"></a><a id="601" href="Ledger.Core.Specification.Crypto.html#601" class="Field">VKey</a> <a id="PKKScheme.Sig"></a><a id="606" href="Ledger.Core.Specification.Crypto.html#606" class="Field">Sig</a> <a id="PKKScheme.Ser"></a><a id="610" href="Ledger.Core.Specification.Crypto.html#610" class="Field">Ser</a>  <a id="615" class="Symbol">:</a> <a id="617" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.isKeyPair"></a><a id="626" href="Ledger.Core.Specification.Crypto.html#626" class="Field">isKeyPair</a>          <a id="645" class="Symbol">:</a> <a id="647" href="Ledger.Core.Specification.Crypto.html#596" class="Field">SKey</a> <a id="652" class="Symbol">→</a> <a id="654" href="Ledger.Core.Specification.Crypto.html#601" class="Field">VKey</a> <a id="659" class="Symbol">→</a> <a id="661" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.isSigned"></a><a id="670" href="Ledger.Core.Specification.Crypto.html#670" class="Field">isSigned</a>           <a id="689" class="Symbol">:</a> <a id="691" href="Ledger.Core.Specification.Crypto.html#601" class="Field">VKey</a> <a id="696" class="Symbol">→</a> <a id="698" href="Ledger.Core.Specification.Crypto.html#610" class="Field">Ser</a> <a id="702" class="Symbol">→</a> <a id="704" href="Ledger.Core.Specification.Crypto.html#606" class="Field">Sig</a> <a id="708" class="Symbol">→</a> <a id="710" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.sign"></a><a id="719" href="Ledger.Core.Specification.Crypto.html#719" class="Field">sign</a>               <a id="738" class="Symbol">:</a> <a id="740" href="Ledger.Core.Specification.Crypto.html#596" class="Field">SKey</a> <a id="745" class="Symbol">→</a> <a id="747" href="Ledger.Core.Specification.Crypto.html#610" class="Field">Ser</a> <a id="751" class="Symbol">→</a> <a id="753" href="Ledger.Core.Specification.Crypto.html#606" class="Field">Sig</a>

  <a id="PKKScheme.KeyPair"></a><a id="760" href="Ledger.Core.Specification.Crypto.html#760" class="Function">KeyPair</a> <a id="768" class="Symbol">=</a> <a id="770" href="Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="773" href="Ledger.Core.Specification.Crypto.html#773" class="Bound">sk</a> <a id="776" href="Data.Product.Base.html#1244" class="Function">∈</a> <a id="778" href="Ledger.Core.Specification.Crypto.html#596" class="Field">SKey</a> <a id="783" href="Data.Product.Base.html#1244" class="Function">]</a> <a id="785" href="Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="788" href="Ledger.Core.Specification.Crypto.html#788" class="Bound">vk</a> <a id="791" href="Data.Product.Base.html#1244" class="Function">∈</a> <a id="793" href="Ledger.Core.Specification.Crypto.html#601" class="Field">VKey</a> <a id="798" href="Data.Product.Base.html#1244" class="Function">]</a> <a id="800" href="Ledger.Core.Specification.Crypto.html#626" class="Field">isKeyPair</a> <a id="810" href="Ledger.Core.Specification.Crypto.html#773" class="Bound">sk</a> <a id="813" href="Ledger.Core.Specification.Crypto.html#788" class="Bound">vk</a>



  <a id="821" class="Keyword">field</a>
    <a id="831" class="Symbol">⦃</a> <a id="PKKScheme.Dec-isSigned"></a><a id="833" href="Ledger.Core.Specification.Crypto.html#833" class="Field">Dec-isSigned</a> <a id="846" class="Symbol">⦄</a> <a id="848" class="Symbol">:</a> <a id="850" href="Ledger.Core.Specification.Crypto.html#670" class="Field">isSigned</a> <a id="859" href="Class.Decidable.Core.html#784" class="Function Operator">⁇³</a>


    <a id="PKKScheme.isSigned-correct"></a><a id="868" href="Ledger.Core.Specification.Crypto.html#868" class="Field">isSigned-correct</a>  <a id="886" class="Symbol">:</a> <a id="888" class="Symbol">(</a><a id="889" href="Ledger.Core.Specification.Crypto.html#889" class="Bound">(</a><a id="890" href="Ledger.Core.Specification.Crypto.html#890" class="Bound">sk</a> <a id="893" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="895" href="Ledger.Core.Specification.Crypto.html#895" class="Bound">vk</a> <a id="898" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="900" href="Ledger.Core.Specification.Crypto.html#889" class="Bound">_)</a> <a id="903" class="Symbol">:</a> <a id="905" href="Ledger.Core.Specification.Crypto.html#760" class="Function">KeyPair</a><a id="912" class="Symbol">)</a> <a id="914" class="Symbol">(</a><a id="915" href="Ledger.Core.Specification.Crypto.html#915" class="Bound">d</a> <a id="917" class="Symbol">:</a> <a id="919" href="Ledger.Core.Specification.Crypto.html#610" class="Field">Ser</a><a id="922" class="Symbol">)</a> <a id="924" class="Symbol">(</a><a id="925" href="Ledger.Core.Specification.Crypto.html#925" class="Bound">σ</a> <a id="927" class="Symbol">:</a> <a id="929" href="Ledger.Core.Specification.Crypto.html#606" class="Field">Sig</a><a id="932" class="Symbol">)</a>
                      <a id="956" class="Symbol">→</a> <a id="958" href="Ledger.Core.Specification.Crypto.html#719" class="Field">sign</a> <a id="963" href="Ledger.Core.Specification.Crypto.html#890" class="Bound">sk</a> <a id="966" href="Ledger.Core.Specification.Crypto.html#915" class="Bound">d</a> <a id="968" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="970" href="Ledger.Core.Specification.Crypto.html#925" class="Bound">σ</a> <a id="972" class="Symbol">→</a> <a id="974" href="Ledger.Core.Specification.Crypto.html#670" class="Field">isSigned</a> <a id="983" href="Ledger.Core.Specification.Crypto.html#895" class="Bound">vk</a> <a id="986" href="Ledger.Core.Specification.Crypto.html#915" class="Bound">d</a> <a id="988" href="Ledger.Core.Specification.Crypto.html#925" class="Bound">σ</a>


    <a id="996" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Sig"></a><a id="998" href="Ledger.Core.Specification.Crypto.html#998" class="Field">DecEq-Sig</a>  <a id="1009" class="Symbol">⦄</a> <a id="1011" class="Symbol">:</a> <a id="1013" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1019" href="Ledger.Core.Specification.Crypto.html#606" class="Field">Sig</a>
    <a id="1027" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Ser"></a><a id="1029" href="Ledger.Core.Specification.Crypto.html#1029" class="Field">DecEq-Ser</a>  <a id="1040" class="Symbol">⦄</a> <a id="1042" class="Symbol">:</a> <a id="1044" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1050" href="Ledger.Core.Specification.Crypto.html#610" class="Field">Ser</a>

<a id="1055" class="Keyword">record</a> <a id="CryptoStructure"></a><a id="1062" href="Ledger.Core.Specification.Crypto.html#1062" class="Record">CryptoStructure</a> <a id="1078" class="Symbol">:</a> <a id="1080" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="1086" class="Keyword">where</a>
  <a id="1094" class="Keyword">field</a> <a id="CryptoStructure.pkk"></a><a id="1100" href="Ledger.Core.Specification.Crypto.html#1100" class="Field">pkk</a> <a id="1104" class="Symbol">:</a> <a id="1106" href="Ledger.Core.Specification.Crypto.html#558" class="Record">PKKScheme</a>

  <a id="1119" class="Keyword">open</a> <a id="1124" href="Ledger.Core.Specification.Crypto.html#558" class="Module">PKKScheme</a> <a id="1134" href="Ledger.Core.Specification.Crypto.html#1100" class="Field">pkk</a> <a id="1138" class="Keyword">public</a>

  <a id="1148" class="Keyword">field</a> <a id="1154" class="Symbol">⦃</a> <a id="CryptoStructure.khs"></a><a id="1156" href="Ledger.Core.Specification.Crypto.html#1156" class="Field">khs</a> <a id="1160" class="Symbol">⦄</a>    <a id="1165" class="Symbol">:</a> <a id="1167" href="Ledger.Core.Specification.Crypto.html#118" class="Record">isHashableSet</a> <a id="1181" href="Ledger.Core.Specification.Crypto.html#601" class="Function">VKey</a>
        <a id="CryptoStructure.ScriptHash"></a><a id="1194" href="Ledger.Core.Specification.Crypto.html#1194" class="Field">ScriptHash</a> <a id="1205" class="Symbol">:</a> <a id="1207" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="1211" class="Symbol">;</a> <a id="1213" class="Symbol">⦃</a> <a id="CryptoStructure.DecEq-ScriptHash"></a><a id="1215" href="Ledger.Core.Specification.Crypto.html#1215" class="Field">DecEq-ScriptHash</a> <a id="1232" class="Symbol">⦄</a> <a id="1234" class="Symbol">:</a> <a id="1236" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1242" href="Ledger.Core.Specification.Crypto.html#1194" class="Field">ScriptHash</a> <a id="1253" class="Symbol">;</a> <a id="1255" class="Symbol">⦃</a> <a id="CryptoStructure.Show-ScriptHash"></a><a id="1257" href="Ledger.Core.Specification.Crypto.html#1257" class="Field">Show-ScriptHash</a> <a id="1273" class="Symbol">⦄</a> <a id="1275" class="Symbol">:</a> <a id="1277" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="1282" href="Ledger.Core.Specification.Crypto.html#1194" class="Field">ScriptHash</a>

  <a id="1296" class="Keyword">open</a> <a id="1301" href="Ledger.Core.Specification.Crypto.html#118" class="Module">isHashableSet</a> <a id="1315" href="Ledger.Core.Specification.Crypto.html#1156" class="Field">khs</a> <a id="1319" class="Keyword">renaming</a> <a id="1328" class="Symbol">(</a><a id="1329" href="Ledger.Core.Specification.Crypto.html#195" class="Field">THash</a> <a id="1335" class="Symbol">to</a> <a id="1338" class="Field">KeyHash</a><a id="1345" class="Symbol">)</a> <a id="1347" class="Keyword">hiding</a> <a id="1354" class="Symbol">(</a><a id="1355" href="Ledger.Core.Specification.Crypto.html#304" class="Field">DecEq-T</a><a id="1362" class="Symbol">)</a> <a id="1364" class="Keyword">public</a>

<a id="1372" class="Comment">-- TODO: KES and VRF</a>

</pre></body></html>