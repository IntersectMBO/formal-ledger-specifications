<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Core.Specification.Crypto</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">

<a id="3" class="Symbol">{-#</a> <a id="7" class="Keyword">OPTIONS</a> <a id="15" class="Pragma">--safe</a> <a id="22" class="Symbol">#-}</a>
<a id="26" class="Keyword">module</a> <a id="33" href="Ledger.Core.Specification.Crypto.html" class="Module">Ledger.Core.Specification.Crypto</a> <a id="66" class="Keyword">where</a>

<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="100" class="Keyword">hiding</a> <a id="107" class="Symbol">(</a><a id="108" href="Data.Bool.Base.html#1358" class="Function">T</a><a id="109" class="Symbol">)</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Ledger.Prelude.Numeric.UnitInterval.html" class="Module">Ledger.Prelude.Numeric.UnitInterval</a>

<a id="160" class="Keyword">record</a> <a id="isHashableSet"></a><a id="167" href="Ledger.Core.Specification.Crypto.html#167" class="Record">isHashableSet</a> <a id="181" class="Symbol">(</a><a id="182" href="Ledger.Core.Specification.Crypto.html#182" class="Bound">T</a> <a id="184" class="Symbol">:</a> <a id="186" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="190" class="Symbol">)</a> <a id="192" class="Symbol">:</a> <a id="194" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="200" class="Keyword">where</a>
  <a id="208" class="Keyword">constructor</a> <a id="mkIsHashableSet"></a><a id="220" href="Ledger.Core.Specification.Crypto.html#220" class="InductiveConstructor">mkIsHashableSet</a>
  <a id="238" class="Keyword">field</a> <a id="isHashableSet.THash"></a><a id="244" href="Ledger.Core.Specification.Crypto.html#244" class="Field">THash</a> <a id="250" class="Symbol">:</a> <a id="252" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="265" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-THash"></a><a id="267" href="Ledger.Core.Specification.Crypto.html#267" class="Field">DecEq-THash</a> <a id="279" class="Symbol">⦄</a> <a id="281" class="Symbol">:</a> <a id="283" href="Class.DecEq.Core.html#126" class="Record">DecEq</a>      <a id="294" href="Ledger.Core.Specification.Crypto.html#244" class="Field">THash</a>
        <a id="308" class="Symbol">⦃</a> <a id="isHashableSet.Show-THash"></a><a id="310" href="Ledger.Core.Specification.Crypto.html#310" class="Field">Show-THash</a>  <a id="322" class="Symbol">⦄</a> <a id="324" class="Symbol">:</a> <a id="326" href="Class.Show.Core.html#125" class="Record">Show</a>       <a id="337" href="Ledger.Core.Specification.Crypto.html#244" class="Field">THash</a>
        <a id="351" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-T"></a><a id="353" href="Ledger.Core.Specification.Crypto.html#353" class="Field">DecEq-T</a>     <a id="365" class="Symbol">⦄</a> <a id="367" class="Symbol">:</a> <a id="369" href="Class.DecEq.Core.html#126" class="Record">DecEq</a>    <a id="378" href="Ledger.Core.Specification.Crypto.html#182" class="Bound">T</a>
        <a id="388" class="Symbol">⦃</a> <a id="isHashableSet.T-Hashable"></a><a id="390" href="Ledger.Core.Specification.Crypto.html#390" class="Field">T-Hashable</a>  <a id="402" class="Symbol">⦄</a> <a id="404" class="Symbol">:</a> <a id="406" href="Interface.TypeClasses.Hashable.html#172" class="Record">Hashable</a> <a id="415" href="Ledger.Core.Specification.Crypto.html#182" class="Bound">T</a> <a id="417" href="Ledger.Core.Specification.Crypto.html#244" class="Field">THash</a>
<a id="423" class="Keyword">open</a> <a id="428" href="Ledger.Core.Specification.Crypto.html#167" class="Module">isHashableSet</a>

<a id="443" class="Keyword">record</a> <a id="HashableSet"></a><a id="450" href="Ledger.Core.Specification.Crypto.html#450" class="Record">HashableSet</a> <a id="462" class="Symbol">:</a> <a id="464" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="470" class="Keyword">where</a>
  <a id="478" class="Keyword">constructor</a> <a id="mkHashableSet"></a><a id="490" href="Ledger.Core.Specification.Crypto.html#490" class="InductiveConstructor">mkHashableSet</a>
  <a id="506" class="Keyword">field</a> <a id="HashableSet.T"></a><a id="512" href="Ledger.Core.Specification.Crypto.html#512" class="Field">T</a> <a id="514" class="Symbol">:</a> <a id="516" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="520" class="Symbol">;</a> <a id="522" class="Symbol">⦃</a> <a id="HashableSet.T-isHashable"></a><a id="524" href="Ledger.Core.Specification.Crypto.html#524" class="Field">T-isHashable</a> <a id="537" class="Symbol">⦄</a> <a id="539" class="Symbol">:</a> <a id="541" href="Ledger.Core.Specification.Crypto.html#167" class="Record">isHashableSet</a> <a id="555" href="Ledger.Core.Specification.Crypto.html#512" class="Field">T</a>
  <a id="559" class="Keyword">open</a> <a id="564" href="Ledger.Core.Specification.Crypto.html#167" class="Module">isHashableSet</a> <a id="578" href="Ledger.Core.Specification.Crypto.html#524" class="Field">T-isHashable</a> <a id="591" class="Keyword">public</a>


<a id="600" class="Keyword">record</a> <a id="PKKScheme"></a><a id="607" href="Ledger.Core.Specification.Crypto.html#607" class="Record">PKKScheme</a> <a id="617" class="Symbol">:</a> <a id="619" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="625" class="Keyword">where</a>
  <a id="633" class="Keyword">field</a>


    <a id="PKKScheme.SKey"></a><a id="645" href="Ledger.Core.Specification.Crypto.html#645" class="Field">SKey</a> <a id="PKKScheme.VKey"></a><a id="650" href="Ledger.Core.Specification.Crypto.html#650" class="Field">VKey</a> <a id="PKKScheme.Sig"></a><a id="655" href="Ledger.Core.Specification.Crypto.html#655" class="Field">Sig</a> <a id="PKKScheme.Ser"></a><a id="659" href="Ledger.Core.Specification.Crypto.html#659" class="Field">Ser</a>  <a id="664" class="Symbol">:</a> <a id="666" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.isKeyPair"></a><a id="675" href="Ledger.Core.Specification.Crypto.html#675" class="Field">isKeyPair</a>          <a id="694" class="Symbol">:</a> <a id="696" href="Ledger.Core.Specification.Crypto.html#645" class="Field">SKey</a> <a id="701" class="Symbol">→</a> <a id="703" href="Ledger.Core.Specification.Crypto.html#650" class="Field">VKey</a> <a id="708" class="Symbol">→</a> <a id="710" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.isSigned"></a><a id="719" href="Ledger.Core.Specification.Crypto.html#719" class="Field">isSigned</a>           <a id="738" class="Symbol">:</a> <a id="740" href="Ledger.Core.Specification.Crypto.html#650" class="Field">VKey</a> <a id="745" class="Symbol">→</a> <a id="747" href="Ledger.Core.Specification.Crypto.html#659" class="Field">Ser</a> <a id="751" class="Symbol">→</a> <a id="753" href="Ledger.Core.Specification.Crypto.html#655" class="Field">Sig</a> <a id="757" class="Symbol">→</a> <a id="759" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.sign"></a><a id="768" href="Ledger.Core.Specification.Crypto.html#768" class="Field">sign</a>               <a id="787" class="Symbol">:</a> <a id="789" href="Ledger.Core.Specification.Crypto.html#645" class="Field">SKey</a> <a id="794" class="Symbol">→</a> <a id="796" href="Ledger.Core.Specification.Crypto.html#659" class="Field">Ser</a> <a id="800" class="Symbol">→</a> <a id="802" href="Ledger.Core.Specification.Crypto.html#655" class="Field">Sig</a>

  <a id="PKKScheme.KeyPair"></a><a id="809" href="Ledger.Core.Specification.Crypto.html#809" class="Function">KeyPair</a> <a id="817" class="Symbol">=</a> <a id="819" href="Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="822" href="Ledger.Core.Specification.Crypto.html#822" class="Bound">sk</a> <a id="825" href="Data.Product.Base.html#1244" class="Function">∈</a> <a id="827" href="Ledger.Core.Specification.Crypto.html#645" class="Field">SKey</a> <a id="832" href="Data.Product.Base.html#1244" class="Function">]</a> <a id="834" href="Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="837" href="Ledger.Core.Specification.Crypto.html#837" class="Bound">vk</a> <a id="840" href="Data.Product.Base.html#1244" class="Function">∈</a> <a id="842" href="Ledger.Core.Specification.Crypto.html#650" class="Field">VKey</a> <a id="847" href="Data.Product.Base.html#1244" class="Function">]</a> <a id="849" href="Ledger.Core.Specification.Crypto.html#675" class="Field">isKeyPair</a> <a id="859" href="Ledger.Core.Specification.Crypto.html#822" class="Bound">sk</a> <a id="862" href="Ledger.Core.Specification.Crypto.html#837" class="Bound">vk</a>


  <a id="869" class="Keyword">field</a>
    <a id="879" class="Symbol">⦃</a> <a id="PKKScheme.Dec-isSigned"></a><a id="881" href="Ledger.Core.Specification.Crypto.html#881" class="Field">Dec-isSigned</a> <a id="894" class="Symbol">⦄</a> <a id="896" class="Symbol">:</a> <a id="898" href="Ledger.Core.Specification.Crypto.html#719" class="Field">isSigned</a> <a id="907" href="Class.Decidable.Core.html#601" class="Function Operator">⁇³</a>


    <a id="PKKScheme.isSigned-correct"></a><a id="916" href="Ledger.Core.Specification.Crypto.html#916" class="Field">isSigned-correct</a>  <a id="934" class="Symbol">:</a> <a id="936" class="Symbol">(</a><a id="937" href="Ledger.Core.Specification.Crypto.html#937" class="Bound">(</a><a id="938" href="Ledger.Core.Specification.Crypto.html#938" class="Bound">sk</a> <a id="941" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="943" href="Ledger.Core.Specification.Crypto.html#943" class="Bound">vk</a> <a id="946" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="948" href="Ledger.Core.Specification.Crypto.html#937" class="Bound">_)</a> <a id="951" class="Symbol">:</a> <a id="953" href="Ledger.Core.Specification.Crypto.html#809" class="Function">KeyPair</a><a id="960" class="Symbol">)</a> <a id="962" class="Symbol">(</a><a id="963" href="Ledger.Core.Specification.Crypto.html#963" class="Bound">d</a> <a id="965" class="Symbol">:</a> <a id="967" href="Ledger.Core.Specification.Crypto.html#659" class="Field">Ser</a><a id="970" class="Symbol">)</a> <a id="972" class="Symbol">(</a><a id="973" href="Ledger.Core.Specification.Crypto.html#973" class="Bound">σ</a> <a id="975" class="Symbol">:</a> <a id="977" href="Ledger.Core.Specification.Crypto.html#655" class="Field">Sig</a><a id="980" class="Symbol">)</a>
                      <a id="1004" class="Symbol">→</a> <a id="1006" href="Ledger.Core.Specification.Crypto.html#768" class="Field">sign</a> <a id="1011" href="Ledger.Core.Specification.Crypto.html#938" class="Bound">sk</a> <a id="1014" href="Ledger.Core.Specification.Crypto.html#963" class="Bound">d</a> <a id="1016" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1018" href="Ledger.Core.Specification.Crypto.html#973" class="Bound">σ</a> <a id="1020" class="Symbol">→</a> <a id="1022" href="Ledger.Core.Specification.Crypto.html#719" class="Field">isSigned</a> <a id="1031" href="Ledger.Core.Specification.Crypto.html#943" class="Bound">vk</a> <a id="1034" href="Ledger.Core.Specification.Crypto.html#963" class="Bound">d</a> <a id="1036" href="Ledger.Core.Specification.Crypto.html#973" class="Bound">σ</a>


    <a id="1044" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Sig"></a><a id="1046" href="Ledger.Core.Specification.Crypto.html#1046" class="Field">DecEq-Sig</a>  <a id="1057" class="Symbol">⦄</a> <a id="1059" class="Symbol">:</a> <a id="1061" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="1067" href="Ledger.Core.Specification.Crypto.html#655" class="Field">Sig</a>
    <a id="1075" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Ser"></a><a id="1077" href="Ledger.Core.Specification.Crypto.html#1077" class="Field">DecEq-Ser</a>  <a id="1088" class="Symbol">⦄</a> <a id="1090" class="Symbol">:</a> <a id="1092" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="1098" href="Ledger.Core.Specification.Crypto.html#659" class="Field">Ser</a>

<a id="1103" class="Keyword">record</a> <a id="CryptoStructure"></a><a id="1110" href="Ledger.Core.Specification.Crypto.html#1110" class="Record">CryptoStructure</a> <a id="1126" class="Symbol">:</a> <a id="1128" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="1134" class="Keyword">where</a>
  <a id="1142" class="Keyword">field</a> <a id="CryptoStructure.pkk"></a><a id="1148" href="Ledger.Core.Specification.Crypto.html#1148" class="Field">pkk</a> <a id="1152" class="Symbol">:</a> <a id="1154" href="Ledger.Core.Specification.Crypto.html#607" class="Record">PKKScheme</a>

  <a id="1167" class="Keyword">open</a> <a id="1172" href="Ledger.Core.Specification.Crypto.html#607" class="Module">PKKScheme</a> <a id="1182" href="Ledger.Core.Specification.Crypto.html#1148" class="Field">pkk</a> <a id="1186" class="Keyword">public</a>

  <a id="1196" class="Keyword">field</a> <a id="1202" class="Symbol">⦃</a> <a id="CryptoStructure.khs"></a><a id="1204" href="Ledger.Core.Specification.Crypto.html#1204" class="Field">khs</a> <a id="1208" class="Symbol">⦄</a>    <a id="1213" class="Symbol">:</a> <a id="1215" href="Ledger.Core.Specification.Crypto.html#167" class="Record">isHashableSet</a> <a id="1229" href="Ledger.Core.Specification.Crypto.html#650" class="Function">VKey</a>
        <a id="CryptoStructure.ScriptHash"></a><a id="1242" href="Ledger.Core.Specification.Crypto.html#1242" class="Field">ScriptHash</a> <a id="1253" class="Symbol">:</a> <a id="1255" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="1259" class="Symbol">;</a> <a id="1261" class="Symbol">⦃</a> <a id="CryptoStructure.DecEq-ScriptHash"></a><a id="1263" href="Ledger.Core.Specification.Crypto.html#1263" class="Field">DecEq-ScriptHash</a> <a id="1280" class="Symbol">⦄</a> <a id="1282" class="Symbol">:</a> <a id="1284" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="1290" href="Ledger.Core.Specification.Crypto.html#1242" class="Field">ScriptHash</a> <a id="1301" class="Symbol">;</a> <a id="1303" class="Symbol">⦃</a> <a id="CryptoStructure.Show-ScriptHash"></a><a id="1305" href="Ledger.Core.Specification.Crypto.html#1305" class="Field">Show-ScriptHash</a> <a id="1321" class="Symbol">⦄</a> <a id="1323" class="Symbol">:</a> <a id="1325" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="1330" href="Ledger.Core.Specification.Crypto.html#1242" class="Field">ScriptHash</a>

  <a id="1344" class="Keyword">open</a> <a id="1349" href="Ledger.Core.Specification.Crypto.html#167" class="Module">isHashableSet</a> <a id="1363" href="Ledger.Core.Specification.Crypto.html#1204" class="Field">khs</a> <a id="1367" class="Keyword">renaming</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Ledger.Core.Specification.Crypto.html#244" class="Field">THash</a> <a id="1383" class="Symbol">to</a> <a id="1386" class="Field">KeyHash</a><a id="1393" class="Symbol">)</a> <a id="1395" class="Keyword">hiding</a> <a id="1402" class="Symbol">(</a><a id="1403" href="Ledger.Core.Specification.Crypto.html#353" class="Field">DecEq-T</a><a id="1410" class="Symbol">)</a> <a id="1412" class="Keyword">public</a>

<a id="1420" class="Comment">-- TODO: KES and VRF</a>

</pre></body></html>