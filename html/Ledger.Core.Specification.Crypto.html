<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Core.Specification.Crypto</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>
<a id="25" class="Keyword">module</a> <a id="32" href="Ledger.Core.Specification.Crypto.html" class="Module">Ledger.Core.Specification.Crypto</a> <a id="65" class="Keyword">where</a>

<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="99" class="Keyword">hiding</a> <a id="106" class="Symbol">(</a><a id="107" href="Data.Bool.Base.html#1358" class="Function">T</a><a id="108" class="Symbol">)</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Ledger.Prelude.Numeric.UnitInterval.html" class="Module">Ledger.Prelude.Numeric.UnitInterval</a>

<a id="159" class="Keyword">record</a> <a id="isHashableSet"></a><a id="166" href="Ledger.Core.Specification.Crypto.html#166" class="Record">isHashableSet</a> <a id="180" class="Symbol">(</a><a id="181" href="Ledger.Core.Specification.Crypto.html#181" class="Bound">T</a> <a id="183" class="Symbol">:</a> <a id="185" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="189" class="Symbol">)</a> <a id="191" class="Symbol">:</a> <a id="193" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="199" class="Keyword">where</a>
  <a id="207" class="Keyword">constructor</a> <a id="mkIsHashableSet"></a><a id="219" href="Ledger.Core.Specification.Crypto.html#219" class="InductiveConstructor">mkIsHashableSet</a>
  <a id="237" class="Keyword">field</a> <a id="isHashableSet.THash"></a><a id="243" href="Ledger.Core.Specification.Crypto.html#243" class="Field">THash</a> <a id="249" class="Symbol">:</a> <a id="251" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="264" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-THash"></a><a id="266" href="Ledger.Core.Specification.Crypto.html#266" class="Field">DecEq-THash</a> <a id="278" class="Symbol">⦄</a> <a id="280" class="Symbol">:</a> <a id="282" href="Class.DecEq.Core.html#126" class="Record">DecEq</a>      <a id="293" href="Ledger.Core.Specification.Crypto.html#243" class="Field">THash</a>
        <a id="307" class="Symbol">⦃</a> <a id="isHashableSet.Show-THash"></a><a id="309" href="Ledger.Core.Specification.Crypto.html#309" class="Field">Show-THash</a>  <a id="321" class="Symbol">⦄</a> <a id="323" class="Symbol">:</a> <a id="325" href="Class.Show.Core.html#125" class="Record">Show</a>       <a id="336" href="Ledger.Core.Specification.Crypto.html#243" class="Field">THash</a>
        <a id="350" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-T"></a><a id="352" href="Ledger.Core.Specification.Crypto.html#352" class="Field">DecEq-T</a>     <a id="364" class="Symbol">⦄</a> <a id="366" class="Symbol">:</a> <a id="368" href="Class.DecEq.Core.html#126" class="Record">DecEq</a>    <a id="377" href="Ledger.Core.Specification.Crypto.html#181" class="Bound">T</a>
        <a id="387" class="Symbol">⦃</a> <a id="isHashableSet.T-Hashable"></a><a id="389" href="Ledger.Core.Specification.Crypto.html#389" class="Field">T-Hashable</a>  <a id="401" class="Symbol">⦄</a> <a id="403" class="Symbol">:</a> <a id="405" href="Interface.Hashable.html#158" class="Record">Hashable</a> <a id="414" href="Ledger.Core.Specification.Crypto.html#181" class="Bound">T</a> <a id="416" href="Ledger.Core.Specification.Crypto.html#243" class="Field">THash</a>
<a id="422" class="Keyword">open</a> <a id="427" href="Ledger.Core.Specification.Crypto.html#166" class="Module">isHashableSet</a>

<a id="442" class="Keyword">record</a> <a id="HashableSet"></a><a id="449" href="Ledger.Core.Specification.Crypto.html#449" class="Record">HashableSet</a> <a id="461" class="Symbol">:</a> <a id="463" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="469" class="Keyword">where</a>
  <a id="477" class="Keyword">constructor</a> <a id="mkHashableSet"></a><a id="489" href="Ledger.Core.Specification.Crypto.html#489" class="InductiveConstructor">mkHashableSet</a>
  <a id="505" class="Keyword">field</a> <a id="HashableSet.T"></a><a id="511" href="Ledger.Core.Specification.Crypto.html#511" class="Field">T</a> <a id="513" class="Symbol">:</a> <a id="515" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="519" class="Symbol">;</a> <a id="521" class="Symbol">⦃</a> <a id="HashableSet.T-isHashable"></a><a id="523" href="Ledger.Core.Specification.Crypto.html#523" class="Field">T-isHashable</a> <a id="536" class="Symbol">⦄</a> <a id="538" class="Symbol">:</a> <a id="540" href="Ledger.Core.Specification.Crypto.html#166" class="Record">isHashableSet</a> <a id="554" href="Ledger.Core.Specification.Crypto.html#511" class="Field">T</a>
  <a id="558" class="Keyword">open</a> <a id="563" href="Ledger.Core.Specification.Crypto.html#166" class="Module">isHashableSet</a> <a id="577" href="Ledger.Core.Specification.Crypto.html#523" class="Field">T-isHashable</a> <a id="590" class="Keyword">public</a>


<a id="599" class="Keyword">record</a> <a id="PKKScheme"></a><a id="606" href="Ledger.Core.Specification.Crypto.html#606" class="Record">PKKScheme</a> <a id="616" class="Symbol">:</a> <a id="618" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="624" class="Keyword">where</a>
  <a id="632" class="Keyword">field</a>


    <a id="PKKScheme.SKey"></a><a id="644" href="Ledger.Core.Specification.Crypto.html#644" class="Field">SKey</a> <a id="PKKScheme.VKey"></a><a id="649" href="Ledger.Core.Specification.Crypto.html#649" class="Field">VKey</a> <a id="PKKScheme.Sig"></a><a id="654" href="Ledger.Core.Specification.Crypto.html#654" class="Field">Sig</a> <a id="PKKScheme.Ser"></a><a id="658" href="Ledger.Core.Specification.Crypto.html#658" class="Field">Ser</a>  <a id="663" class="Symbol">:</a> <a id="665" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.isKeyPair"></a><a id="674" href="Ledger.Core.Specification.Crypto.html#674" class="Field">isKeyPair</a>          <a id="693" class="Symbol">:</a> <a id="695" href="Ledger.Core.Specification.Crypto.html#644" class="Field">SKey</a> <a id="700" class="Symbol">→</a> <a id="702" href="Ledger.Core.Specification.Crypto.html#649" class="Field">VKey</a> <a id="707" class="Symbol">→</a> <a id="709" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.isSigned"></a><a id="718" href="Ledger.Core.Specification.Crypto.html#718" class="Field">isSigned</a>           <a id="737" class="Symbol">:</a> <a id="739" href="Ledger.Core.Specification.Crypto.html#649" class="Field">VKey</a> <a id="744" class="Symbol">→</a> <a id="746" href="Ledger.Core.Specification.Crypto.html#658" class="Field">Ser</a> <a id="750" class="Symbol">→</a> <a id="752" href="Ledger.Core.Specification.Crypto.html#654" class="Field">Sig</a> <a id="756" class="Symbol">→</a> <a id="758" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="PKKScheme.sign"></a><a id="767" href="Ledger.Core.Specification.Crypto.html#767" class="Field">sign</a>               <a id="786" class="Symbol">:</a> <a id="788" href="Ledger.Core.Specification.Crypto.html#644" class="Field">SKey</a> <a id="793" class="Symbol">→</a> <a id="795" href="Ledger.Core.Specification.Crypto.html#658" class="Field">Ser</a> <a id="799" class="Symbol">→</a> <a id="801" href="Ledger.Core.Specification.Crypto.html#654" class="Field">Sig</a>

  <a id="PKKScheme.KeyPair"></a><a id="808" href="Ledger.Core.Specification.Crypto.html#808" class="Function">KeyPair</a> <a id="816" class="Symbol">=</a> <a id="818" href="Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="821" href="Ledger.Core.Specification.Crypto.html#821" class="Bound">sk</a> <a id="824" href="Data.Product.Base.html#1244" class="Function">∈</a> <a id="826" href="Ledger.Core.Specification.Crypto.html#644" class="Field">SKey</a> <a id="831" href="Data.Product.Base.html#1244" class="Function">]</a> <a id="833" href="Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="836" href="Ledger.Core.Specification.Crypto.html#836" class="Bound">vk</a> <a id="839" href="Data.Product.Base.html#1244" class="Function">∈</a> <a id="841" href="Ledger.Core.Specification.Crypto.html#649" class="Field">VKey</a> <a id="846" href="Data.Product.Base.html#1244" class="Function">]</a> <a id="848" href="Ledger.Core.Specification.Crypto.html#674" class="Field">isKeyPair</a> <a id="858" href="Ledger.Core.Specification.Crypto.html#821" class="Bound">sk</a> <a id="861" href="Ledger.Core.Specification.Crypto.html#836" class="Bound">vk</a>



  <a id="869" class="Keyword">field</a>
    <a id="879" class="Symbol">⦃</a> <a id="PKKScheme.Dec-isSigned"></a><a id="881" href="Ledger.Core.Specification.Crypto.html#881" class="Field">Dec-isSigned</a> <a id="894" class="Symbol">⦄</a> <a id="896" class="Symbol">:</a> <a id="898" href="Ledger.Core.Specification.Crypto.html#718" class="Field">isSigned</a> <a id="907" href="Class.Decidable.Core.html#601" class="Function Operator">⁇³</a>


    <a id="PKKScheme.isSigned-correct"></a><a id="916" href="Ledger.Core.Specification.Crypto.html#916" class="Field">isSigned-correct</a>  <a id="934" class="Symbol">:</a> <a id="936" class="Symbol">(</a><a id="937" href="Ledger.Core.Specification.Crypto.html#937" class="Bound">(</a><a id="938" href="Ledger.Core.Specification.Crypto.html#938" class="Bound">sk</a> <a id="941" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="943" href="Ledger.Core.Specification.Crypto.html#943" class="Bound">vk</a> <a id="946" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="948" href="Ledger.Core.Specification.Crypto.html#937" class="Bound">_)</a> <a id="951" class="Symbol">:</a> <a id="953" href="Ledger.Core.Specification.Crypto.html#808" class="Function">KeyPair</a><a id="960" class="Symbol">)</a> <a id="962" class="Symbol">(</a><a id="963" href="Ledger.Core.Specification.Crypto.html#963" class="Bound">d</a> <a id="965" class="Symbol">:</a> <a id="967" href="Ledger.Core.Specification.Crypto.html#658" class="Field">Ser</a><a id="970" class="Symbol">)</a> <a id="972" class="Symbol">(</a><a id="973" href="Ledger.Core.Specification.Crypto.html#973" class="Bound">σ</a> <a id="975" class="Symbol">:</a> <a id="977" href="Ledger.Core.Specification.Crypto.html#654" class="Field">Sig</a><a id="980" class="Symbol">)</a>
                      <a id="1004" class="Symbol">→</a> <a id="1006" href="Ledger.Core.Specification.Crypto.html#767" class="Field">sign</a> <a id="1011" href="Ledger.Core.Specification.Crypto.html#938" class="Bound">sk</a> <a id="1014" href="Ledger.Core.Specification.Crypto.html#963" class="Bound">d</a> <a id="1016" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1018" href="Ledger.Core.Specification.Crypto.html#973" class="Bound">σ</a> <a id="1020" class="Symbol">→</a> <a id="1022" href="Ledger.Core.Specification.Crypto.html#718" class="Field">isSigned</a> <a id="1031" href="Ledger.Core.Specification.Crypto.html#943" class="Bound">vk</a> <a id="1034" href="Ledger.Core.Specification.Crypto.html#963" class="Bound">d</a> <a id="1036" href="Ledger.Core.Specification.Crypto.html#973" class="Bound">σ</a>


    <a id="1044" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Sig"></a><a id="1046" href="Ledger.Core.Specification.Crypto.html#1046" class="Field">DecEq-Sig</a>  <a id="1057" class="Symbol">⦄</a> <a id="1059" class="Symbol">:</a> <a id="1061" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="1067" href="Ledger.Core.Specification.Crypto.html#654" class="Field">Sig</a>
    <a id="1075" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Ser"></a><a id="1077" href="Ledger.Core.Specification.Crypto.html#1077" class="Field">DecEq-Ser</a>  <a id="1088" class="Symbol">⦄</a> <a id="1090" class="Symbol">:</a> <a id="1092" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="1098" href="Ledger.Core.Specification.Crypto.html#658" class="Field">Ser</a>

<a id="1103" class="Keyword">record</a> <a id="CryptoStructure"></a><a id="1110" href="Ledger.Core.Specification.Crypto.html#1110" class="Record">CryptoStructure</a> <a id="1126" class="Symbol">:</a> <a id="1128" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="1134" class="Keyword">where</a>
  <a id="1142" class="Keyword">field</a> <a id="CryptoStructure.pkk"></a><a id="1148" href="Ledger.Core.Specification.Crypto.html#1148" class="Field">pkk</a> <a id="1152" class="Symbol">:</a> <a id="1154" href="Ledger.Core.Specification.Crypto.html#606" class="Record">PKKScheme</a>

  <a id="1167" class="Keyword">open</a> <a id="1172" href="Ledger.Core.Specification.Crypto.html#606" class="Module">PKKScheme</a> <a id="1182" href="Ledger.Core.Specification.Crypto.html#1148" class="Field">pkk</a> <a id="1186" class="Keyword">public</a>

  <a id="1196" class="Keyword">field</a> <a id="1202" class="Symbol">⦃</a> <a id="CryptoStructure.khs"></a><a id="1204" href="Ledger.Core.Specification.Crypto.html#1204" class="Field">khs</a> <a id="1208" class="Symbol">⦄</a>    <a id="1213" class="Symbol">:</a> <a id="1215" href="Ledger.Core.Specification.Crypto.html#166" class="Record">isHashableSet</a> <a id="1229" href="Ledger.Core.Specification.Crypto.html#649" class="Function">VKey</a>
        <a id="CryptoStructure.ScriptHash"></a><a id="1242" href="Ledger.Core.Specification.Crypto.html#1242" class="Field">ScriptHash</a> <a id="1253" class="Symbol">:</a> <a id="1255" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="1259" class="Symbol">;</a> <a id="1261" class="Symbol">⦃</a> <a id="CryptoStructure.DecEq-ScriptHash"></a><a id="1263" href="Ledger.Core.Specification.Crypto.html#1263" class="Field">DecEq-ScriptHash</a> <a id="1280" class="Symbol">⦄</a> <a id="1282" class="Symbol">:</a> <a id="1284" href="Class.DecEq.Core.html#126" class="Record">DecEq</a> <a id="1290" href="Ledger.Core.Specification.Crypto.html#1242" class="Field">ScriptHash</a> <a id="1301" class="Symbol">;</a> <a id="1303" class="Symbol">⦃</a> <a id="CryptoStructure.Show-ScriptHash"></a><a id="1305" href="Ledger.Core.Specification.Crypto.html#1305" class="Field">Show-ScriptHash</a> <a id="1321" class="Symbol">⦄</a> <a id="1323" class="Symbol">:</a> <a id="1325" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="1330" href="Ledger.Core.Specification.Crypto.html#1242" class="Field">ScriptHash</a>

  <a id="1344" class="Keyword">open</a> <a id="1349" href="Ledger.Core.Specification.Crypto.html#166" class="Module">isHashableSet</a> <a id="1363" href="Ledger.Core.Specification.Crypto.html#1204" class="Field">khs</a> <a id="1367" class="Keyword">renaming</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Ledger.Core.Specification.Crypto.html#243" class="Field">THash</a> <a id="1383" class="Symbol">to</a> <a id="1386" class="Field">KeyHash</a><a id="1393" class="Symbol">)</a> <a id="1395" class="Keyword">hiding</a> <a id="1402" class="Symbol">(</a><a id="1403" href="Ledger.Core.Specification.Crypto.html#352" class="Field">DecEq-T</a><a id="1410" class="Symbol">)</a> <a id="1412" class="Keyword">public</a>

<a id="1420" class="Comment">-- TODO: KES and VRF</a>

</pre></body></html>