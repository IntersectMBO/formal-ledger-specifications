<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.TokenAlgebra.ValueVector</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">open</a> <a id="29" class="Keyword">import</a> <a id="36" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="51" class="Keyword">hiding</a> <a id="58" class="Symbol">(</a><a id="59" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">_∙_</a><a id="62" class="Symbol">;</a> <a id="64" href="Class.Monoid.Core.html#195" class="Field">ε</a><a id="65" class="Symbol">)</a>

<a id="68" class="Keyword">module</a> <a id="75" href="Ledger.Conway.TokenAlgebra.ValueVector.html" class="Module">Ledger.Conway.TokenAlgebra.ValueVector</a> <a id="114" class="Symbol">(</a><a id="115" href="Ledger.Conway.TokenAlgebra.ValueVector.html#115" class="Bound">PolicyId</a> <a id="124" class="Symbol">:</a> <a id="126" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="130" class="Symbol">)</a> <a id="132" class="Symbol">(</a><a id="133" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a> <a id="135" class="Symbol">:</a> <a id="137" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="138" class="Symbol">)</a> <a id="140" class="Keyword">where</a>

<a id="147" class="Keyword">import</a> <a id="154" href="Algebra.html" class="Module">Algebra</a> <a id="162" class="Symbol">as</a> <a id="165" class="Module">Alg</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="stdlib.Algebra.Morphism.Construct.DirectProduct.html" class="Module">stdlib.Algebra.Morphism.Construct.DirectProduct</a>
<a id="229" class="Keyword">open</a> <a id="234" class="Keyword">import</a> <a id="241" href="Algebra.Construct.DirectProduct.html" class="Module">Algebra.Construct.DirectProduct</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="305" class="Keyword">using</a> <a id="311" class="Symbol">(</a><a id="312" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a><a id="333" class="Symbol">)</a>
<a id="335" class="Keyword">import</a> <a id="342" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html" class="Module">Data.Product.Relation.Binary.Pointwise.NonDependent</a> <a id="394" class="Symbol">as</a> <a id="397" class="Module">Product</a>
<a id="405" class="Keyword">open</a> <a id="410" class="Keyword">import</a> <a id="417" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="426" class="Symbol">as</a> <a id="429" class="Module">Vec</a>
  <a id="435" class="Keyword">hiding</a> <a id="442" class="Symbol">(</a><a id="443" href="Data.Vec.Base.html#8496" class="Function">fromList</a><a id="451" class="Symbol">)</a>
<a id="453" class="Keyword">import</a> <a id="460" href="stdlib.Data.Vec.Instances.html" class="Module">stdlib.Data.Vec.Instances</a> <a id="486" class="Symbol">as</a> <a id="489" class="Module">Vec</a>
<a id="493" class="Keyword">import</a> <a id="500" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Binary.Pointwise.Inductive</a> <a id="545" class="Symbol">as</a> <a id="548" class="Module">Vec</a>

<a id="553" class="Keyword">open</a> <a id="558" class="Keyword">import</a> <a id="565" href="Ledger.Conway.TokenAlgebra.html" class="Module">Ledger.Conway.TokenAlgebra</a> <a id="592" href="Ledger.Conway.TokenAlgebra.ValueVector.html#115" class="Bound">PolicyId</a>

<a id="Quantity"></a><a id="602" href="Ledger.Conway.TokenAlgebra.ValueVector.html#602" class="Function">Quantity</a> <a id="611" class="Symbol">=</a> <a id="613" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Vec-commutativeMonoid"></a><a id="616" href="Ledger.Conway.TokenAlgebra.ValueVector.html#616" class="Function">Vec-commutativeMonoid</a> <a id="638" class="Symbol">=</a> <a id="640" href="stdlib.Data.Vec.Instances.html#3630" class="Function">Vec.commutativeMonoid</a> <a id="662" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a> <a id="664" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>

<a id="687" class="Keyword">module</a> <a id="+-0-commutativeMonoid"></a><a id="694" href="Ledger.Conway.TokenAlgebra.ValueVector.html#694" class="Module">+-0-commutativeMonoid</a> <a id="716" class="Symbol">=</a> <a id="718" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="740" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>
<a id="762" class="Keyword">module</a> <a id="Vec-commutativeMonoid"></a><a id="769" href="Ledger.Conway.TokenAlgebra.ValueVector.html#769" class="Module">Vec-commutativeMonoid</a> <a id="791" class="Symbol">=</a> <a id="793" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="815" href="Ledger.Conway.TokenAlgebra.ValueVector.html#616" class="Function">Vec-commutativeMonoid</a>

<a id="838" class="Keyword">module</a> <a id="845" href="Ledger.Conway.TokenAlgebra.ValueVector.html#845" class="Module">_</a> <a id="847" class="Symbol">(</a><a id="848" href="Ledger.Conway.TokenAlgebra.ValueVector.html#848" class="Bound">Policies</a> <a id="857" class="Symbol">:</a> <a id="859" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="863" href="Ledger.Conway.TokenAlgebra.ValueVector.html#115" class="Bound">PolicyId</a> <a id="872" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a><a id="873" class="Symbol">)</a> <a id="875" class="Keyword">where</a>
  <a id="883" href="Ledger.Conway.TokenAlgebra.ValueVector.html#883" class="Function">Value-TokenAlgebra</a> <a id="902" class="Symbol">:</a> <a id="904" href="Ledger.Conway.TokenAlgebra.html#460" class="Record">TokenAlgebra</a>
  <a id="919" href="Ledger.Conway.TokenAlgebra.ValueVector.html#883" class="Function">Value-TokenAlgebra</a> <a id="938" class="Symbol">=</a> <a id="940" class="Keyword">record</a> <a id="947" class="Symbol">{</a><a id="948" href="Ledger.Conway.TokenAlgebra.ValueVector.html#975" class="Module">go</a><a id="950" class="Symbol">}</a>
    <a id="956" class="Keyword">where</a>
      <a id="968" class="Keyword">module</a> <a id="975" href="Ledger.Conway.TokenAlgebra.ValueVector.html#975" class="Module">go</a> <a id="978" class="Keyword">where</a>
        <a id="992" href="Ledger.Conway.TokenAlgebra.ValueVector.html#992" class="Function">Value</a> <a id="998" class="Symbol">:</a> <a id="1000" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="1013" href="Ledger.Conway.TokenAlgebra.ValueVector.html#992" class="Function">Value</a> <a id="1019" class="Symbol">=</a> <a id="1021" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1026" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1028" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="1032" href="Ledger.Conway.TokenAlgebra.ValueVector.html#602" class="Function">Quantity</a> <a id="1041" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a>

        <a id="1052" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1052" class="Function">Value-CommutativeMonoid</a> <a id="1076" class="Symbol">:</a> <a id="1078" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="1096" href="Level.html#521" class="Function">0ℓ</a> <a id="1099" href="Level.html#521" class="Function">0ℓ</a> <a id="1102" href="Ledger.Conway.TokenAlgebra.ValueVector.html#992" class="Function">Value</a>
        <a id="1116" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1052" class="Function">Value-CommutativeMonoid</a> <a id="1140" class="Symbol">=</a> <a id="1142" href="Class.CommutativeMonoid.Core.html#639" class="Function">Conversion.fromBundle</a> <a id="1164" class="Symbol">(</a><a id="1165" href="Algebra.Construct.DirectProduct.html#7719" class="Function">commutativeMonoid</a> <a id="1183" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a> <a id="1205" href="Ledger.Conway.TokenAlgebra.ValueVector.html#616" class="Function">Vec-commutativeMonoid</a><a id="1226" class="Symbol">)</a>

        <a id="1237" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1237" class="Function">coin</a> <a id="1242" class="Symbol">:</a> <a id="1244" href="Ledger.Conway.TokenAlgebra.ValueVector.html#992" class="Function">Value</a> <a id="1250" class="Symbol">→</a> <a id="1252" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
        <a id="1265" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1237" class="Function">coin</a> <a id="1270" class="Symbol">=</a> <a id="1272" href="Data.Product.Base.html#636" class="Field">proj₁</a>
  
        <a id="1289" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1289" class="Function">inject</a> <a id="1296" class="Symbol">:</a> <a id="1298" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1303" class="Symbol">→</a> <a id="1305" href="Ledger.Conway.TokenAlgebra.ValueVector.html#992" class="Function">Value</a>
        <a id="1319" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1289" class="Function">inject</a> <a id="1326" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1326" class="Bound">c</a> <a id="1328" class="Symbol">=</a> <a id="1330" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1326" class="Bound">c</a> <a id="1332" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1334" href="Data.Vec.Base.html#6493" class="Function">Vec.replicate</a> <a id="1348" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a> <a id="1350" class="Number">0</a>
  
        <a id="1363" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1363" class="Function">policies</a>                   <a id="1390" class="Symbol">=</a> <a id="1392" class="Symbol">λ</a> <a id="1394" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1394" class="Bound">_</a> <a id="1396" class="Symbol">→</a> <a id="1398" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1407" class="Symbol">(</a><a id="1408" href="Data.Vec.Base.html#8402" class="Function">toList</a> <a id="1415" href="Ledger.Conway.TokenAlgebra.ValueVector.html#848" class="Bound">Policies</a><a id="1423" class="Symbol">)</a>
        <a id="1433" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1433" class="Function">size</a>                       <a id="1460" class="Symbol">=</a> <a id="1462" class="Symbol">λ</a> <a id="1464" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1464" class="Bound">_</a> <a id="1466" class="Symbol">→</a> <a id="1468" class="Number">1</a> <a id="1470" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1472" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a>
        <a id="1482" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1482" class="Function Operator">_≤ᵗ_</a>                       <a id="1509" class="Symbol">=</a> <a id="1511" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html#1147" class="Function">Product.Pointwise</a> <a id="1529" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤_</a> <a id="1533" class="Symbol">(</a><a id="1534" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#1434" class="Datatype">Vec.Pointwise</a> <a id="1548" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤_</a><a id="1551" class="Symbol">)</a>

        <a id="1562" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1562" class="Function">coin∘inject≗id</a>             <a id="1589" class="Symbol">=</a> <a id="1591" class="Symbol">λ</a> <a id="1593" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1593" class="Bound">_</a> <a id="1595" class="Symbol">→</a> <a id="1597" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
        <a id="1610" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1610" class="Function">coinIsMonoidHomomorphism</a>   <a id="1637" class="Symbol">=</a> <a id="1639" href="stdlib.Algebra.Morphism.Construct.DirectProduct.html#1168" class="Function">isMonoidHomomorphism</a> <a id="1660" href="Algebra.Bundles.html#7708" class="Function">+-0-commutativeMonoid.rawMonoid</a> <a id="1692" href="Algebra.Bundles.html#7708" class="Function">Vec-commutativeMonoid.rawMonoid</a> <a id="1724" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

        <a id="1738" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1738" class="Function">Dec-≤ᵗ</a> <a id="1745" class="Symbol">:</a> <a id="1747" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1482" class="Function Operator">_≤ᵗ_</a> <a id="1752" href="Class.Decidable.Core.html#773" class="Function Operator">⁇²</a>
        <a id="1763" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1738" class="Function">Dec-≤ᵗ</a> <a id="1770" class="Symbol">{(</a><a id="1772" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1772" class="Bound">c₁</a> <a id="1775" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1777" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1777" class="Bound">v₁</a><a id="1779" class="Symbol">)}</a> <a id="1782" class="Symbol">{(</a><a id="1784" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1784" class="Bound">c₂</a> <a id="1787" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1789" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1789" class="Bound">v₂</a><a id="1791" class="Symbol">)}</a> <a id="1794" class="Symbol">=</a> <a id="1796" href="Class.Decidable.Instances.html#567" class="Function">Dec-×</a> <a id="1802" class="Symbol">⦃</a> <a id="1804" href="Class.Decidable.Instances.html#2218" class="Function">ℕ-Dec-≤</a> <a id="1812" class="Symbol">⦄</a> <a id="1814" class="Symbol">⦃</a> <a id="1816" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1818" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#3736" class="Function">Vec.decidable</a> <a id="1832" href="Class.Decidable.Core.html#1102" class="Function">dec²</a> <a id="1837" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1777" class="Bound">v₁</a> <a id="1840" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1789" class="Bound">v₂</a> <a id="1843" class="Symbol">⦄</a>
</pre></body></html>