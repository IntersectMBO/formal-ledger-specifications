<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.TokenAlgebra.ValueVector</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">open</a> <a id="29" class="Keyword">import</a> <a id="36" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="51" class="Keyword">hiding</a> <a id="58" class="Symbol">(</a><a id="59" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">_∙_</a><a id="62" class="Symbol">;</a> <a id="64" href="Class.Monoid.Core.html#195" class="Field">ε</a><a id="65" class="Symbol">)</a>

<a id="68" class="Keyword">module</a> <a id="75" href="Ledger.Conway.TokenAlgebra.ValueVector.html" class="Module">Ledger.Conway.TokenAlgebra.ValueVector</a> <a id="114" class="Symbol">(</a><a id="115" href="Ledger.Conway.TokenAlgebra.ValueVector.html#115" class="Bound">PolicyId</a> <a id="124" class="Symbol">:</a> <a id="126" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="130" class="Symbol">)</a> <a id="132" class="Symbol">(</a><a id="133" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a> <a id="135" class="Symbol">:</a> <a id="137" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="138" class="Symbol">)</a> <a id="140" class="Keyword">where</a>

<a id="147" class="Keyword">import</a> <a id="154" href="Algebra.html" class="Module">Algebra</a> <a id="162" class="Symbol">as</a> <a id="165" class="Module">Alg</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="stdlib.Algebra.Morphism.Construct.DirectProduct.html" class="Module">stdlib.Algebra.Morphism.Construct.DirectProduct</a>
<a id="229" class="Keyword">open</a> <a id="234" class="Keyword">import</a> <a id="241" href="Algebra.Construct.DirectProduct.html" class="Module">Algebra.Construct.DirectProduct</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="305" class="Keyword">using</a> <a id="311" class="Symbol">(</a><a id="312" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a><a id="333" class="Symbol">)</a>
<a id="335" class="Keyword">import</a> <a id="342" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html" class="Module">Data.Product.Relation.Binary.Pointwise.NonDependent</a> <a id="394" class="Symbol">as</a> <a id="397" class="Module">Product</a>
<a id="405" class="Keyword">open</a> <a id="410" class="Keyword">import</a> <a id="417" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="426" class="Symbol">as</a> <a id="429" class="Module">Vec</a>
  <a id="435" class="Keyword">hiding</a> <a id="442" class="Symbol">(</a><a id="443" href="Data.Vec.Base.html#8496" class="Function">fromList</a><a id="451" class="Symbol">)</a>
<a id="453" class="Keyword">import</a> <a id="460" href="stdlib.Data.Vec.Instances.html" class="Module">stdlib.Data.Vec.Instances</a> <a id="486" class="Symbol">as</a> <a id="489" class="Module">Vec</a>
<a id="493" class="Keyword">import</a> <a id="500" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Binary.Pointwise.Inductive</a> <a id="545" class="Symbol">as</a> <a id="548" class="Module">Vec</a>

<a id="553" class="Keyword">open</a> <a id="558" class="Keyword">import</a> <a id="565" href="Ledger.Conway.TokenAlgebra.Base.html" class="Module">Ledger.Conway.TokenAlgebra.Base</a> <a id="597" href="Ledger.Conway.TokenAlgebra.ValueVector.html#115" class="Bound">PolicyId</a>

<a id="Quantity"></a><a id="607" href="Ledger.Conway.TokenAlgebra.ValueVector.html#607" class="Function">Quantity</a> <a id="616" class="Symbol">=</a> <a id="618" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Vec-commutativeMonoid"></a><a id="621" href="Ledger.Conway.TokenAlgebra.ValueVector.html#621" class="Function">Vec-commutativeMonoid</a> <a id="643" class="Symbol">=</a> <a id="645" href="stdlib.Data.Vec.Instances.html#3630" class="Function">Vec.commutativeMonoid</a> <a id="667" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a> <a id="669" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>

<a id="692" class="Keyword">module</a> <a id="+-0-commutativeMonoid"></a><a id="699" href="Ledger.Conway.TokenAlgebra.ValueVector.html#699" class="Module">+-0-commutativeMonoid</a> <a id="721" class="Symbol">=</a> <a id="723" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="745" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>
<a id="767" class="Keyword">module</a> <a id="Vec-commutativeMonoid"></a><a id="774" href="Ledger.Conway.TokenAlgebra.ValueVector.html#774" class="Module">Vec-commutativeMonoid</a> <a id="796" class="Symbol">=</a> <a id="798" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="820" href="Ledger.Conway.TokenAlgebra.ValueVector.html#621" class="Function">Vec-commutativeMonoid</a>

<a id="843" class="Keyword">module</a> <a id="850" href="Ledger.Conway.TokenAlgebra.ValueVector.html#850" class="Module">_</a> <a id="852" class="Symbol">(</a><a id="853" href="Ledger.Conway.TokenAlgebra.ValueVector.html#853" class="Bound">Policies</a> <a id="862" class="Symbol">:</a> <a id="864" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="868" href="Ledger.Conway.TokenAlgebra.ValueVector.html#115" class="Bound">PolicyId</a> <a id="877" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a><a id="878" class="Symbol">)</a> <a id="880" class="Keyword">where</a>
  <a id="888" href="Ledger.Conway.TokenAlgebra.ValueVector.html#888" class="Function">Value-TokenAlgebra</a> <a id="907" class="Symbol">:</a> <a id="909" href="Ledger.Conway.TokenAlgebra.Base.html#465" class="Record">TokenAlgebra</a>
  <a id="924" href="Ledger.Conway.TokenAlgebra.ValueVector.html#888" class="Function">Value-TokenAlgebra</a> <a id="943" class="Symbol">=</a> <a id="945" class="Keyword">record</a> <a id="952" class="Symbol">{</a><a id="953" href="Ledger.Conway.TokenAlgebra.ValueVector.html#980" class="Module">go</a><a id="955" class="Symbol">}</a>
    <a id="961" class="Keyword">where</a>
      <a id="973" class="Keyword">module</a> <a id="980" href="Ledger.Conway.TokenAlgebra.ValueVector.html#980" class="Module">go</a> <a id="983" class="Keyword">where</a>
        <a id="997" href="Ledger.Conway.TokenAlgebra.ValueVector.html#997" class="Function">Value</a> <a id="1003" class="Symbol">:</a> <a id="1005" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="1018" href="Ledger.Conway.TokenAlgebra.ValueVector.html#997" class="Function">Value</a> <a id="1024" class="Symbol">=</a> <a id="1026" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1031" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1033" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="1037" href="Ledger.Conway.TokenAlgebra.ValueVector.html#607" class="Function">Quantity</a> <a id="1046" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a>

        <a id="1057" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1057" class="Function">Value-CommutativeMonoid</a> <a id="1081" class="Symbol">:</a> <a id="1083" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="1101" href="Level.html#521" class="Function">0ℓ</a> <a id="1104" href="Level.html#521" class="Function">0ℓ</a> <a id="1107" href="Ledger.Conway.TokenAlgebra.ValueVector.html#997" class="Function">Value</a>
        <a id="1121" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1057" class="Function">Value-CommutativeMonoid</a> <a id="1145" class="Symbol">=</a> <a id="1147" href="Class.CommutativeMonoid.Core.html#639" class="Function">Conversion.fromBundle</a> <a id="1169" class="Symbol">(</a><a id="1170" href="Algebra.Construct.DirectProduct.html#7719" class="Function">commutativeMonoid</a> <a id="1188" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a> <a id="1210" href="Ledger.Conway.TokenAlgebra.ValueVector.html#621" class="Function">Vec-commutativeMonoid</a><a id="1231" class="Symbol">)</a>

        <a id="1242" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1242" class="Function">coin</a> <a id="1247" class="Symbol">:</a> <a id="1249" href="Ledger.Conway.TokenAlgebra.ValueVector.html#997" class="Function">Value</a> <a id="1255" class="Symbol">→</a> <a id="1257" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
        <a id="1270" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1242" class="Function">coin</a> <a id="1275" class="Symbol">=</a> <a id="1277" href="Data.Product.Base.html#636" class="Field">proj₁</a>
  
        <a id="1294" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1294" class="Function">inject</a> <a id="1301" class="Symbol">:</a> <a id="1303" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1308" class="Symbol">→</a> <a id="1310" href="Ledger.Conway.TokenAlgebra.ValueVector.html#997" class="Function">Value</a>
        <a id="1324" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1294" class="Function">inject</a> <a id="1331" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1331" class="Bound">c</a> <a id="1333" class="Symbol">=</a> <a id="1335" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1331" class="Bound">c</a> <a id="1337" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1339" href="Data.Vec.Base.html#6493" class="Function">Vec.replicate</a> <a id="1353" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a> <a id="1355" class="Number">0</a>
  
        <a id="1368" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1368" class="Function">policies</a>                   <a id="1395" class="Symbol">=</a> <a id="1397" class="Symbol">λ</a> <a id="1399" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1399" class="Bound">_</a> <a id="1401" class="Symbol">→</a> <a id="1403" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1412" class="Symbol">(</a><a id="1413" href="Data.Vec.Base.html#8402" class="Function">toList</a> <a id="1420" href="Ledger.Conway.TokenAlgebra.ValueVector.html#853" class="Bound">Policies</a><a id="1428" class="Symbol">)</a>
        <a id="1438" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1438" class="Function">size</a>                       <a id="1465" class="Symbol">=</a> <a id="1467" class="Symbol">λ</a> <a id="1469" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1469" class="Bound">_</a> <a id="1471" class="Symbol">→</a> <a id="1473" class="Number">1</a> <a id="1475" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1477" href="Ledger.Conway.TokenAlgebra.ValueVector.html#133" class="Bound">n</a>
        <a id="1487" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1487" class="Function Operator">_≤ᵗ_</a>                       <a id="1514" class="Symbol">=</a> <a id="1516" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html#1147" class="Function">Product.Pointwise</a> <a id="1534" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤_</a> <a id="1538" class="Symbol">(</a><a id="1539" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#1434" class="Datatype">Vec.Pointwise</a> <a id="1553" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤_</a><a id="1556" class="Symbol">)</a>

        <a id="1567" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1567" class="Function">coin∘inject≗id</a>             <a id="1594" class="Symbol">=</a> <a id="1596" class="Symbol">λ</a> <a id="1598" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1598" class="Bound">_</a> <a id="1600" class="Symbol">→</a> <a id="1602" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
        <a id="1615" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1615" class="Function">coinIsMonoidHomomorphism</a>   <a id="1642" class="Symbol">=</a> <a id="1644" href="stdlib.Algebra.Morphism.Construct.DirectProduct.html#1168" class="Function">isMonoidHomomorphism</a> <a id="1665" href="Algebra.Bundles.html#7708" class="Function">+-0-commutativeMonoid.rawMonoid</a> <a id="1697" href="Algebra.Bundles.html#7708" class="Function">Vec-commutativeMonoid.rawMonoid</a> <a id="1729" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

        <a id="1743" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1743" class="Function">Dec-≤ᵗ</a> <a id="1750" class="Symbol">:</a> <a id="1752" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1487" class="Function Operator">_≤ᵗ_</a> <a id="1757" href="Class.Decidable.Core.html#773" class="Function Operator">⁇²</a>
        <a id="1768" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1743" class="Function">Dec-≤ᵗ</a> <a id="1775" class="Symbol">{(</a><a id="1777" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1777" class="Bound">c₁</a> <a id="1780" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1782" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1782" class="Bound">v₁</a><a id="1784" class="Symbol">)}</a> <a id="1787" class="Symbol">{(</a><a id="1789" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1789" class="Bound">c₂</a> <a id="1792" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1794" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1794" class="Bound">v₂</a><a id="1796" class="Symbol">)}</a> <a id="1799" class="Symbol">=</a> <a id="1801" href="Class.Decidable.Instances.html#567" class="Function">Dec-×</a> <a id="1807" class="Symbol">⦃</a> <a id="1809" href="Class.Decidable.Instances.html#2218" class="Function">ℕ-Dec-≤</a> <a id="1817" class="Symbol">⦄</a> <a id="1819" class="Symbol">⦃</a> <a id="1821" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1823" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#3736" class="Function">Vec.decidable</a> <a id="1837" href="Class.Decidable.Core.html#1102" class="Function">dec²</a> <a id="1842" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1782" class="Bound">v₁</a> <a id="1845" href="Ledger.Conway.TokenAlgebra.ValueVector.html#1794" class="Bound">v₂</a> <a id="1848" class="Symbol">⦄</a>
</pre></body></html>