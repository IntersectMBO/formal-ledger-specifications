<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Transaction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>
<a id="25" class="Comment">--------------------------------------------------------------------------------</a>
<a id="106" class="Comment">-- NOTE: Everything in this module is part of TransactionStructure</a>
<a id="173" class="Comment">--------------------------------------------------------------------------------</a>
<a id="254" class="Keyword">module</a> <a id="261" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a> <a id="280" class="Keyword">where</a>

<a id="287" class="Keyword">import</a> <a id="294" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="310" class="Symbol">as</a> <a id="313" class="Module">M</a>

<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="343" class="Keyword">renaming</a> <a id="352" class="Symbol">(</a><a id="353" href="abstract-set-theory.FiniteSetTheory.html#2895" class="Function">filterᵐ</a> <a id="361" class="Symbol">to</a> <a id="364" class="Function">filter</a><a id="370" class="Symbol">)</a>

<a id="373" class="Keyword">open</a> <a id="378" class="Keyword">import</a> <a id="385" href="Ledger.Crypto.html" class="Module">Ledger.Crypto</a>
<a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="Ledger.Types.Epoch.html" class="Module">Ledger.Types.Epoch</a>
<a id="430" class="Keyword">open</a> <a id="435" class="Keyword">import</a> <a id="442" href="Ledger.Types.GovStructure.html" class="Module">Ledger.Types.GovStructure</a>
<a id="468" class="Keyword">import</a> <a id="475" href="Ledger.PParams.html" class="Module">Ledger.PParams</a>
<a id="490" class="Keyword">import</a> <a id="497" href="Ledger.Script.html" class="Module">Ledger.Script</a>
<a id="511" class="Keyword">import</a> <a id="518" href="Ledger.GovernanceActions.html" class="Module">Ledger.GovernanceActions</a>
<a id="543" class="Keyword">import</a> <a id="550" href="Ledger.Certs.html" class="Module">Ledger.Certs</a>
<a id="563" class="Keyword">import</a> <a id="570" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a>
<a id="590" class="Keyword">import</a> <a id="597" href="Ledger.Address.html" class="Module">Ledger.Address</a>

<a id="613" class="Keyword">open</a> <a id="618" class="Keyword">import</a> <a id="625" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a>
<a id="645" class="Keyword">open</a> <a id="650" class="Keyword">import</a> <a id="657" href="MyDebugOptions.html" class="Module">MyDebugOptions</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="711" class="Keyword">using</a> <a id="717" class="Symbol">(</a><a id="718" href="Relation.Nullary.Decidable.Core.html#4636" class="Function Operator">⌊_⌋</a><a id="721" class="Symbol">)</a>

<a id="724" class="Keyword">data</a> <a id="Tag"></a><a id="729" href="Ledger.Transaction.html#729" class="Datatype">Tag</a> <a id="733" class="Symbol">:</a> <a id="735" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="740" class="Keyword">where</a>
  <a id="Tag.Spend"></a><a id="748" href="Ledger.Transaction.html#748" class="InductiveConstructor">Spend</a> <a id="Tag.Mint"></a><a id="754" href="Ledger.Transaction.html#754" class="InductiveConstructor">Mint</a> <a id="Tag.Cert"></a><a id="759" href="Ledger.Transaction.html#759" class="InductiveConstructor">Cert</a> <a id="Tag.Rewrd"></a><a id="764" href="Ledger.Transaction.html#764" class="InductiveConstructor">Rewrd</a> <a id="Tag.Vote"></a><a id="770" href="Ledger.Transaction.html#770" class="InductiveConstructor">Vote</a> <a id="Tag.Propose"></a><a id="775" href="Ledger.Transaction.html#775" class="InductiveConstructor">Propose</a> <a id="783" class="Symbol">:</a> <a id="785" href="Ledger.Transaction.html#729" class="Datatype">Tag</a>
<a id="789" class="Keyword">unquoteDecl</a> <a id="DecEq-Tag"></a><a id="801" href="Ledger.Transaction.html#801" class="Function">DecEq-Tag</a> <a id="811" class="Symbol">=</a> <a id="813" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="826" class="Symbol">((</a><a id="828" class="Keyword">quote</a> <a id="834" href="Ledger.Transaction.html#729" class="Datatype">Tag</a> <a id="838" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="840" href="Ledger.Transaction.html#801" class="Function">DecEq-Tag</a><a id="849" class="Symbol">)</a> <a id="851" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="853" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="855" class="Symbol">)</a>



<a id="860" class="Keyword">record</a> <a id="TransactionStructure"></a><a id="867" href="Ledger.Transaction.html#867" class="Record">TransactionStructure</a> <a id="888" class="Symbol">:</a> <a id="890" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="896" class="Keyword">where</a>
  <a id="904" class="Keyword">field</a>


    <a id="TransactionStructure.Ix"></a><a id="916" href="Ledger.Transaction.html#916" class="Field">Ix</a> <a id="TransactionStructure.TxId"></a><a id="919" href="Ledger.Transaction.html#919" class="Field">TxId</a> <a id="TransactionStructure.AuxiliaryData"></a><a id="924" href="Ledger.Transaction.html#924" class="Field">AuxiliaryData</a> <a id="938" class="Symbol">:</a> <a id="940" href="Agda.Primitive.html#388" class="Primitive">Type</a>



    <a id="952" class="Symbol">⦃</a> <a id="TransactionStructure.DecEq-Ix"></a><a id="954" href="Ledger.Transaction.html#954" class="Field">DecEq-Ix</a>   <a id="965" class="Symbol">⦄</a> <a id="967" class="Symbol">:</a> <a id="969" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="975" href="Ledger.Transaction.html#916" class="Field">Ix</a>
    <a id="982" class="Symbol">⦃</a> <a id="TransactionStructure.DecEq-TxId"></a><a id="984" href="Ledger.Transaction.html#984" class="Field">DecEq-TxId</a> <a id="995" class="Symbol">⦄</a> <a id="997" class="Symbol">:</a> <a id="999" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1005" href="Ledger.Transaction.html#919" class="Field">TxId</a>
    <a id="TransactionStructure.adHashingScheme"></a><a id="1014" href="Ledger.Transaction.html#1014" class="Field">adHashingScheme</a> <a id="1030" class="Symbol">:</a> <a id="1032" href="Ledger.Crypto.html#99" class="Record">isHashableSet</a> <a id="1046" href="Ledger.Transaction.html#924" class="Field">AuxiliaryData</a>
  <a id="1062" class="Keyword">open</a> <a id="1067" href="Ledger.Crypto.html#99" class="Module">isHashableSet</a> <a id="1081" href="Ledger.Transaction.html#1014" class="Field">adHashingScheme</a> <a id="1097" class="Keyword">renaming</a> <a id="1106" class="Symbol">(</a><a id="1107" href="Ledger.Crypto.html#176" class="Field">THash</a> <a id="1113" class="Symbol">to</a> <a id="1116" class="Field">ADHash</a><a id="1122" class="Symbol">)</a> <a id="1124" class="Keyword">public</a>

  <a id="1134" class="Keyword">field</a> <a id="TransactionStructure.globalConstants"></a><a id="1140" href="Ledger.Transaction.html#1140" class="Field">globalConstants</a> <a id="1156" class="Symbol">:</a> <a id="1158" class="Symbol">_</a>
  <a id="1162" class="Keyword">open</a> <a id="1167" href="Ledger.Types.Epoch.html#1895" class="Module">GlobalConstants</a> <a id="1183" href="Ledger.Transaction.html#1140" class="Field">globalConstants</a> <a id="1199" class="Keyword">public</a>

  <a id="1209" class="Keyword">field</a> <a id="TransactionStructure.crypto"></a><a id="1215" href="Ledger.Transaction.html#1215" class="Field">crypto</a> <a id="1222" class="Symbol">:</a> <a id="1224" class="Symbol">_</a>
  <a id="1228" class="Keyword">open</a> <a id="1233" href="Ledger.Crypto.html#1043" class="Module">Crypto</a> <a id="1240" href="Ledger.Transaction.html#1215" class="Field">crypto</a> <a id="1247" class="Keyword">public</a>
  <a id="1256" class="Keyword">open</a> <a id="1261" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="1281" href="Ledger.Crypto.html#1166" class="Function">ScriptHash</a> <a id="1292" class="Keyword">public</a>
  <a id="1301" class="Keyword">open</a> <a id="1306" href="Ledger.Address.html" class="Module">Ledger.Address</a> <a id="1321" href="Ledger.Types.Epoch.html#1934" class="Function">Network</a> <a id="1329" href="Ledger.Crypto.html#1310" class="Function">KeyHash</a> <a id="1337" href="Ledger.Crypto.html#1166" class="Function">ScriptHash</a> <a id="1348" class="Symbol">⦃</a> <a id="1350" href="Function.Base.html#4736" class="Function">it</a> <a id="1353" class="Symbol">⦄</a> <a id="1355" class="Symbol">⦃</a> <a id="1357" href="Function.Base.html#4736" class="Function">it</a> <a id="1360" class="Symbol">⦄</a> <a id="1362" class="Symbol">⦃</a> <a id="1364" href="Function.Base.html#4736" class="Function">it</a> <a id="1367" class="Symbol">⦄</a> <a id="1369" class="Keyword">public</a>

  <a id="1379" class="Keyword">field</a> <a id="TransactionStructure.epochStructure"></a><a id="1385" href="Ledger.Transaction.html#1385" class="Field">epochStructure</a> <a id="1400" class="Symbol">:</a> <a id="1402" class="Symbol">_</a>
  <a id="1406" class="Keyword">open</a> <a id="1411" href="Ledger.Types.Epoch.html#408" class="Module">EpochStructure</a> <a id="1426" href="Ledger.Transaction.html#1385" class="Field">epochStructure</a> <a id="1441" class="Keyword">public</a>
  <a id="1450" class="Keyword">open</a> <a id="1455" href="Ledger.Script.html" class="Module">Ledger.Script</a> <a id="1469" href="Ledger.Transaction.html#1215" class="Field">crypto</a> <a id="1476" href="Ledger.Transaction.html#1385" class="Field">epochStructure</a> <a id="1491" class="Keyword">public</a>

  <a id="1501" class="Keyword">field</a> <a id="TransactionStructure.scriptStructure"></a><a id="1507" href="Ledger.Transaction.html#1507" class="Field">scriptStructure</a> <a id="1523" class="Symbol">:</a> <a id="1525" class="Symbol">_</a>
  <a id="1529" class="Keyword">open</a> <a id="1534" href="Ledger.Script.html#5001" class="Module">ScriptStructure</a> <a id="1550" href="Ledger.Transaction.html#1507" class="Field">scriptStructure</a> <a id="1566" class="Keyword">public</a>
  <a id="1575" class="Keyword">open</a> <a id="1580" href="Ledger.PParams.html" class="Module">Ledger.PParams</a> <a id="1595" href="Ledger.Transaction.html#1215" class="Field">crypto</a> <a id="1602" href="Ledger.Transaction.html#1385" class="Field">epochStructure</a> <a id="1617" href="Ledger.Transaction.html#1507" class="Field">scriptStructure</a> <a id="1633" class="Keyword">public</a>

  <a id="1643" class="Keyword">field</a> <a id="TransactionStructure.govParams"></a><a id="1649" href="Ledger.Transaction.html#1649" class="Field">govParams</a> <a id="1659" class="Symbol">:</a> <a id="1661" class="Symbol">_</a>
  <a id="1665" class="Keyword">open</a> <a id="1670" href="Ledger.PParams.html#13316" class="Module">GovParams</a> <a id="1680" href="Ledger.Transaction.html#1649" class="Field">govParams</a> <a id="1690" class="Keyword">public</a>

  <a id="1700" class="Keyword">field</a> <a id="TransactionStructure.tokenAlgebra"></a><a id="1706" href="Ledger.Transaction.html#1706" class="Field">tokenAlgebra</a> <a id="1719" class="Symbol">:</a> <a id="1721" href="Ledger.TokenAlgebra.html#453" class="Record">TokenAlgebra</a>
  <a id="1736" class="Keyword">open</a> <a id="1741" href="Ledger.TokenAlgebra.html#453" class="Module">TokenAlgebra</a> <a id="1754" href="Ledger.Transaction.html#1706" class="Field">tokenAlgebra</a> <a id="1767" class="Keyword">public</a>

  <a id="1777" class="Keyword">field</a> <a id="TransactionStructure.txidBytes"></a><a id="1783" href="Ledger.Transaction.html#1783" class="Field">txidBytes</a> <a id="1793" class="Symbol">:</a> <a id="1795" href="Ledger.Transaction.html#919" class="Field">TxId</a> <a id="1800" class="Symbol">→</a> <a id="1802" href="Ledger.Crypto.html#591" class="Function">Ser</a>

  <a id="TransactionStructure.govStructure"></a><a id="1809" href="Ledger.Transaction.html#1809" class="Function">govStructure</a> <a id="1822" class="Symbol">:</a> <a id="1824" href="Ledger.Types.GovStructure.html#235" class="Record">GovStructure</a>
  <a id="1839" href="Ledger.Transaction.html#1809" class="Function">govStructure</a> <a id="1852" class="Symbol">=</a> <a id="1854" class="Keyword">record</a>
    <a id="1865" class="Comment">-- TODO: figure out what to do with the hash</a>
    <a id="1914" class="Symbol">{</a> <a id="1916" href="Ledger.Types.GovStructure.html#270" class="Field">TxId</a> <a id="1921" class="Symbol">=</a> <a id="1923" href="Ledger.Transaction.html#919" class="Field">TxId</a><a id="1927" class="Symbol">;</a> <a id="1929" href="Ledger.Types.GovStructure.html#275" class="Field">DocHash</a> <a id="1937" class="Symbol">=</a> <a id="1939" href="Ledger.Transaction.html#1116" class="Function">ADHash</a>
    <a id="1950" class="Symbol">;</a> <a id="1952" href="Ledger.Types.GovStructure.html#335" class="Field">crypto</a> <a id="1959" class="Symbol">=</a> <a id="1961" href="Ledger.Transaction.html#1215" class="Field">crypto</a>
    <a id="1972" class="Symbol">;</a> <a id="1974" href="Ledger.Types.GovStructure.html#383" class="Field">epochStructure</a> <a id="1989" class="Symbol">=</a> <a id="1991" href="Ledger.Transaction.html#1385" class="Field">epochStructure</a>
    <a id="2010" class="Symbol">;</a> <a id="2012" href="Ledger.Types.GovStructure.html#455" class="Field">scriptStructure</a> <a id="2028" class="Symbol">=</a> <a id="2030" href="Ledger.Transaction.html#1507" class="Field">scriptStructure</a>
    <a id="2050" class="Symbol">;</a> <a id="2052" href="Ledger.Types.GovStructure.html#634" class="Field">govParams</a> <a id="2062" class="Symbol">=</a> <a id="2064" href="Ledger.Transaction.html#1649" class="Field">govParams</a>
    <a id="2078" class="Symbol">;</a> <a id="2080" href="Ledger.Types.GovStructure.html#699" class="Field">globalConstants</a> <a id="2096" class="Symbol">=</a> <a id="2098" href="Ledger.Transaction.html#1140" class="Field">globalConstants</a>
    <a id="2118" class="Symbol">}</a>

  <a id="2123" class="Keyword">module</a> <a id="TransactionStructure.GovernanceActions"></a><a id="2130" href="Ledger.Transaction.html#2130" class="Module">GovernanceActions</a> <a id="2148" class="Symbol">=</a> <a id="2150" href="Ledger.GovernanceActions.html" class="Module">Ledger.GovernanceActions</a> <a id="2175" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
  <a id="2190" class="Keyword">open</a> <a id="2195" href="Ledger.Transaction.html#2130" class="Module">GovernanceActions</a> <a id="2213" class="Keyword">hiding</a> <a id="2220" class="Symbol">(</a><a id="2221" href="Ledger.GovernanceActions.html#1687" class="Datatype">Vote</a><a id="2225" class="Symbol">;</a> <a id="2227" href="Ledger.GovernanceActions.html#1707" class="InductiveConstructor">yes</a><a id="2230" class="Symbol">;</a> <a id="2232" href="Ledger.GovernanceActions.html#1711" class="InductiveConstructor">no</a><a id="2234" class="Symbol">;</a> <a id="2236" href="Ledger.GovernanceActions.html#1714" class="InductiveConstructor">abstain</a><a id="2243" class="Symbol">)</a> <a id="2245" class="Keyword">public</a>

  <a id="2255" class="Keyword">open</a> <a id="2260" class="Keyword">import</a> <a id="2267" href="Ledger.Certs.html" class="Module">Ledger.Certs</a> <a id="2280" href="Ledger.Transaction.html#1809" class="Function">govStructure</a> <a id="2293" class="Keyword">using</a> <a id="2299" class="Symbol">(</a><a id="2300" href="Ledger.Certs.html#754" class="Datatype">DCert</a><a id="2305" class="Symbol">)</a>


  <a id="TransactionStructure.TxIn"></a><a id="2311" href="Ledger.Transaction.html#2311" class="Function">TxIn</a>     <a id="2320" class="Symbol">=</a> <a id="2322" href="Ledger.Transaction.html#919" class="Field">TxId</a> <a id="2327" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2329" href="Ledger.Transaction.html#916" class="Field">Ix</a>
  <a id="TransactionStructure.TxOut"></a><a id="2334" href="Ledger.Transaction.html#2334" class="Function">TxOut</a>    <a id="2343" class="Symbol">=</a> <a id="2345" href="Ledger.Address.html#1648" class="Function">Addr</a> <a id="2350" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2352" href="Ledger.TokenAlgebra.html#492" class="Function">Value</a> <a id="2358" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2360" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2366" class="Symbol">(</a><a id="2367" href="Ledger.Script.html#1766" class="Function">Datum</a> <a id="2373" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="2375" href="Ledger.Script.html#1719" class="Function">DataHash</a><a id="2383" class="Symbol">)</a> <a id="2385" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2387" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2393" href="Ledger.Script.html#5396" class="Function">Script</a>
  <a id="TransactionStructure.UTxO"></a><a id="2402" href="Ledger.Transaction.html#2402" class="Function">UTxO</a>     <a id="2411" class="Symbol">=</a> <a id="2413" href="Ledger.Transaction.html#2311" class="Function">TxIn</a> <a id="2418" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2420" href="Ledger.Transaction.html#2334" class="Function">TxOut</a>
  <a id="TransactionStructure.Wdrl"></a><a id="2428" href="Ledger.Transaction.html#2428" class="Function">Wdrl</a>     <a id="2437" class="Symbol">=</a> <a id="2439" href="Ledger.Address.html#1211" class="Record">RwdAddr</a> <a id="2447" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2449" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="TransactionStructure.RdmrPtr"></a><a id="2456" href="Ledger.Transaction.html#2456" class="Function">RdmrPtr</a>  <a id="2465" class="Symbol">=</a> <a id="2467" href="Ledger.Transaction.html#729" class="Datatype">Tag</a> <a id="2471" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2473" href="Ledger.Transaction.html#916" class="Field">Ix</a>

  <a id="TransactionStructure.ProposedPPUpdates"></a><a id="2479" href="Ledger.Transaction.html#2479" class="Function">ProposedPPUpdates</a>  <a id="2498" class="Symbol">=</a> <a id="2500" href="Ledger.Crypto.html#1310" class="Function">KeyHash</a> <a id="2508" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2510" href="Ledger.PParams.html#13414" class="Function">PParamsUpdate</a>
  <a id="TransactionStructure.Update"></a><a id="2526" href="Ledger.Transaction.html#2526" class="Function">Update</a>             <a id="2545" class="Symbol">=</a> <a id="2547" href="Ledger.Transaction.html#2479" class="Function">ProposedPPUpdates</a> <a id="2565" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2567" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a>


  <a id="2577" class="Keyword">record</a> <a id="TransactionStructure.TxBody"></a><a id="2584" href="Ledger.Transaction.html#2584" class="Record">TxBody</a> <a id="2591" class="Symbol">:</a> <a id="2593" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2598" class="Keyword">where</a>
    <a id="2608" class="Keyword">field</a>
      <a id="2620" href="Ledger.Transaction.html#2620" class="Field">txins</a>          <a id="2635" class="Symbol">:</a> <a id="2637" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2639" href="Ledger.Transaction.html#2311" class="Function">TxIn</a>
      <a id="2650" href="Ledger.Transaction.html#2650" class="Field">refInputs</a>      <a id="2665" class="Symbol">:</a> <a id="2667" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2669" href="Ledger.Transaction.html#2311" class="Function">TxIn</a>
      <a id="2680" href="Ledger.Transaction.html#2680" class="Field">txouts</a>         <a id="2695" class="Symbol">:</a> <a id="2697" href="Ledger.Transaction.html#916" class="Field">Ix</a> <a id="2700" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2702" href="Ledger.Transaction.html#2334" class="Function">TxOut</a>
      <a id="2714" href="Ledger.Transaction.html#2714" class="Field">txfee</a>          <a id="2729" class="Symbol">:</a> <a id="2731" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
      <a id="2742" href="Ledger.Transaction.html#2742" class="Field">mint</a>           <a id="2757" class="Symbol">:</a> <a id="2759" href="Ledger.TokenAlgebra.html#492" class="Function">Value</a>
      <a id="2771" href="Ledger.Transaction.html#2771" class="Field">txvldt</a>         <a id="2786" class="Symbol">:</a> <a id="2788" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2794" href="Ledger.Types.Epoch.html#552" class="Function">Slot</a> <a id="2799" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2801" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2807" href="Ledger.Types.Epoch.html#552" class="Function">Slot</a>
      <a id="2818" href="Ledger.Transaction.html#2818" class="Field">txcerts</a>        <a id="2833" class="Symbol">:</a> <a id="2835" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2840" href="Ledger.Certs.html#754" class="Datatype">DCert</a>
      <a id="2852" href="Ledger.Transaction.html#2852" class="Field">txwdrls</a>        <a id="2867" class="Symbol">:</a> <a id="2869" href="Ledger.Transaction.html#2428" class="Function">Wdrl</a>
      <a id="2880" href="Ledger.Transaction.html#2880" class="Field">txvote</a>         <a id="2895" class="Symbol">:</a> <a id="2897" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2902" href="Ledger.GovernanceActions.html#1738" class="Record">GovVote</a>
      <a id="2916" href="Ledger.Transaction.html#2916" class="Field">txprop</a>         <a id="2931" class="Symbol">:</a> <a id="2933" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2938" href="Ledger.GovernanceActions.html#1883" class="Record">GovProposal</a>
      <a id="2956" href="Ledger.Transaction.html#2956" class="Field">txdonation</a>     <a id="2971" class="Symbol">:</a> <a id="2973" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
      <a id="2984" href="Ledger.Transaction.html#2984" class="Field">txup</a>           <a id="2999" class="Symbol">:</a> <a id="3001" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3007" href="Ledger.Transaction.html#2526" class="Function">Update</a>
      <a id="3020" href="Ledger.Transaction.html#3020" class="Field">txADhash</a>       <a id="3035" class="Symbol">:</a> <a id="3037" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3043" href="Ledger.Transaction.html#1116" class="Function">ADHash</a>
      <a id="3056" href="Ledger.Transaction.html#3056" class="Field">txNetworkId</a>    <a id="3071" class="Symbol">:</a> <a id="3073" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3079" href="Ledger.Types.Epoch.html#1934" class="Function">Network</a>
      <a id="3093" href="Ledger.Transaction.html#3093" class="Field">curTreasury</a>    <a id="3108" class="Symbol">:</a> <a id="3110" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3116" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
      <a id="3127" href="Ledger.Transaction.html#3127" class="Field">txsize</a>         <a id="3142" class="Symbol">:</a> <a id="3144" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
      <a id="3152" href="Ledger.Transaction.html#3152" class="Field">txid</a>           <a id="3167" class="Symbol">:</a> <a id="3169" href="Ledger.Transaction.html#919" class="Field">TxId</a>
      <a id="3180" href="Ledger.Transaction.html#3180" class="Field">collateral</a>     <a id="3195" class="Symbol">:</a> <a id="3197" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3199" href="Ledger.Transaction.html#2311" class="Function">TxIn</a>
      <a id="3210" href="Ledger.Transaction.html#3210" class="Field">reqSigHash</a>     <a id="3225" class="Symbol">:</a> <a id="3227" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3229" href="Ledger.Crypto.html#1310" class="Function">KeyHash</a>
      <a id="3243" href="Ledger.Transaction.html#3243" class="Field">scriptIntHash</a>  <a id="3258" class="Symbol">:</a> <a id="3260" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3266" href="Ledger.Crypto.html#1166" class="Function">ScriptHash</a>


  <a id="3281" class="Keyword">record</a> <a id="TransactionStructure.TxWitnesses"></a><a id="3288" href="Ledger.Transaction.html#3288" class="Record">TxWitnesses</a> <a id="3300" class="Symbol">:</a> <a id="3302" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3307" class="Keyword">where</a>
    <a id="3317" class="Keyword">field</a>
      <a id="3329" href="Ledger.Transaction.html#3329" class="Field">vkSigs</a>   <a id="3338" class="Symbol">:</a> <a id="3340" href="Ledger.Crypto.html#582" class="Function">VKey</a> <a id="3345" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3347" href="Ledger.Crypto.html#587" class="Function">Sig</a>
      <a id="3357" href="Ledger.Transaction.html#3357" class="Field">scripts</a>  <a id="3366" class="Symbol">:</a> <a id="3368" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3370" href="Ledger.Script.html#5396" class="Function">Script</a>
      <a id="3383" href="Ledger.Transaction.html#3383" class="Field">txdats</a>   <a id="3392" class="Symbol">:</a> <a id="3394" href="Ledger.Script.html#1719" class="Function">DataHash</a> <a id="3403" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3405" href="Ledger.Script.html#1766" class="Function">Datum</a>
      <a id="3417" href="Ledger.Transaction.html#3417" class="Field">txrdmrs</a>  <a id="3426" class="Symbol">:</a> <a id="3428" href="Ledger.Transaction.html#2456" class="Function">RdmrPtr</a>  <a id="3437" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3439" href="Ledger.Script.html#1784" class="Function">Redeemer</a> <a id="3448" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3450" href="Ledger.Script.html#1014" class="Function">ExUnits</a>

    <a id="TransactionStructure.TxWitnesses.scriptsP1"></a><a id="3463" href="Ledger.Transaction.html#3463" class="Function">scriptsP1</a> <a id="3473" class="Symbol">:</a> <a id="3475" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3477" href="Ledger.Script.html#638" class="Function">P1Script</a>
    <a id="3490" href="Ledger.Transaction.html#3463" class="Function">scriptsP1</a> <a id="3500" class="Symbol">=</a> <a id="3502" href="Axiom.Set.html#7805" class="Function">mapPartial</a> <a id="3513" href="Data.Sum.html#787" class="Function">isInj₁</a> <a id="3520" href="Ledger.Transaction.html#3357" class="Field">scripts</a>

  <a id="3531" class="Keyword">record</a> <a id="TransactionStructure.Tx"></a><a id="3538" href="Ledger.Transaction.html#3538" class="Record">Tx</a> <a id="3541" class="Symbol">:</a> <a id="3543" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3548" class="Keyword">where</a>
    <a id="3558" class="Keyword">field</a>
      <a id="3570" href="Ledger.Transaction.html#3570" class="Field">body</a>     <a id="3579" class="Symbol">:</a> <a id="3581" href="Ledger.Transaction.html#2584" class="Record">TxBody</a>
      <a id="3594" href="Ledger.Transaction.html#3594" class="Field">wits</a>     <a id="3603" class="Symbol">:</a> <a id="3605" href="Ledger.Transaction.html#3288" class="Record">TxWitnesses</a>
      <a id="3623" href="Ledger.Transaction.html#3623" class="Field">isValid</a>  <a id="3632" class="Symbol">:</a> <a id="3634" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
      <a id="3645" href="Ledger.Transaction.html#3645" class="Field">txAD</a>     <a id="3654" class="Symbol">:</a> <a id="3656" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3662" href="Ledger.Transaction.html#924" class="Field">AuxiliaryData</a>


  <a id="TransactionStructure.getValue"></a><a id="3680" href="Ledger.Transaction.html#3680" class="Function">getValue</a> <a id="3689" class="Symbol">:</a> <a id="3691" href="Ledger.Transaction.html#2334" class="Function">TxOut</a> <a id="3697" class="Symbol">→</a> <a id="3699" href="Ledger.TokenAlgebra.html#492" class="Function">Value</a>
  <a id="3707" href="Ledger.Transaction.html#3680" class="Function">getValue</a> <a id="3716" class="Symbol">(_</a> <a id="3719" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3721" href="Ledger.Transaction.html#3721" class="Bound">v</a> <a id="3723" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3725" class="Symbol">_)</a> <a id="3728" class="Symbol">=</a> <a id="3730" href="Ledger.Transaction.html#3721" class="Bound">v</a>

  <a id="TransactionStructure.TxOutʰ"></a><a id="3735" href="Ledger.Transaction.html#3735" class="Function">TxOutʰ</a> <a id="3742" class="Symbol">=</a> <a id="3744" href="Ledger.Address.html#1648" class="Function">Addr</a> <a id="3749" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3751" href="Ledger.TokenAlgebra.html#492" class="Function">Value</a> <a id="3757" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3759" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3765" class="Symbol">(</a><a id="3766" href="Ledger.Script.html#1766" class="Function">Datum</a> <a id="3772" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3774" href="Ledger.Script.html#1719" class="Function">DataHash</a><a id="3782" class="Symbol">)</a> <a id="3784" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3786" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3792" href="Ledger.Crypto.html#1166" class="Function">ScriptHash</a>

  <a id="TransactionStructure.txOutHash"></a><a id="3806" href="Ledger.Transaction.html#3806" class="Function">txOutHash</a> <a id="3816" class="Symbol">:</a> <a id="3818" href="Ledger.Transaction.html#2334" class="Function">TxOut</a> <a id="3824" class="Symbol">→</a> <a id="3826" href="Ledger.Transaction.html#3735" class="Function">TxOutʰ</a>
  <a id="3835" href="Ledger.Transaction.html#3806" class="Function">txOutHash</a> <a id="3845" class="Symbol">(</a><a id="3846" href="Ledger.Transaction.html#3846" class="Bound">a</a> <a id="3848" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3850" href="Ledger.Transaction.html#3850" class="Bound">v</a> <a id="3852" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3854" href="Ledger.Transaction.html#3854" class="Bound">d</a> <a id="3856" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3858" href="Ledger.Transaction.html#3858" class="Bound">s</a><a id="3859" class="Symbol">)</a> <a id="3861" class="Symbol">=</a> <a id="3863" href="Ledger.Transaction.html#3846" class="Bound">a</a> <a id="3865" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3867" class="Symbol">(</a><a id="3868" href="Ledger.Transaction.html#3850" class="Bound">v</a> <a id="3870" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3872" class="Symbol">(</a><a id="3873" href="Ledger.Transaction.html#3854" class="Bound">d</a> <a id="3875" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3877" href="Data.Maybe.Base.html#1934" class="Function">M.map</a> <a id="3883" href="Interface.Hashable.html#205" class="Field">hash</a> <a id="3888" href="Ledger.Transaction.html#3858" class="Bound">s</a><a id="3889" class="Symbol">))</a>

  <a id="TransactionStructure.getValueʰ"></a><a id="3895" href="Ledger.Transaction.html#3895" class="Function">getValueʰ</a> <a id="3905" class="Symbol">:</a> <a id="3907" href="Ledger.Transaction.html#3735" class="Function">TxOutʰ</a> <a id="3914" class="Symbol">→</a> <a id="3916" href="Ledger.TokenAlgebra.html#492" class="Function">Value</a>
  <a id="3924" href="Ledger.Transaction.html#3895" class="Function">getValueʰ</a> <a id="3934" class="Symbol">(_</a> <a id="3937" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3939" href="Ledger.Transaction.html#3939" class="Bound">v</a> <a id="3941" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3943" class="Symbol">_)</a> <a id="3946" class="Symbol">=</a> <a id="3948" href="Ledger.Transaction.html#3939" class="Bound">v</a>

  <a id="TransactionStructure.txinsVKey"></a><a id="3953" href="Ledger.Transaction.html#3953" class="Function">txinsVKey</a> <a id="3963" class="Symbol">:</a> <a id="3965" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3967" href="Ledger.Transaction.html#2311" class="Function">TxIn</a> <a id="3972" class="Symbol">→</a> <a id="3974" href="Ledger.Transaction.html#2402" class="Function">UTxO</a> <a id="3979" class="Symbol">→</a> <a id="3981" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3983" href="Ledger.Transaction.html#2311" class="Function">TxIn</a>
  <a id="3990" href="Ledger.Transaction.html#3953" class="Function">txinsVKey</a> <a id="4000" href="Ledger.Transaction.html#4000" class="Bound">txins</a> <a id="4006" href="Ledger.Transaction.html#4006" class="Bound">utxo</a> <a id="4011" class="Symbol">=</a> <a id="4013" href="Ledger.Transaction.html#4000" class="Bound">txins</a> <a id="4019" href="Axiom.Set.html#9292" class="Function Operator">∩</a> <a id="4021" href="Class.IsSet.html#916" class="Function">dom</a> <a id="4025" class="Symbol">(</a><a id="4026" href="Ledger.Transaction.html#4006" class="Bound">utxo</a> <a id="4031" href="abstract-set-theory.FiniteSetTheory.html#3088" class="Function Operator">∣^&#39;</a> <a id="4035" class="Symbol">(</a><a id="4036" href="Ledger.Address.html#1903" class="Function">isVKeyAddr</a> <a id="4047" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4049" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="4054" class="Symbol">))</a>

  <a id="TransactionStructure.scriptOuts"></a><a id="4060" href="Ledger.Transaction.html#4060" class="Function">scriptOuts</a> <a id="4071" class="Symbol">:</a> <a id="4073" href="Ledger.Transaction.html#2402" class="Function">UTxO</a> <a id="4078" class="Symbol">→</a> <a id="4080" href="Ledger.Transaction.html#2402" class="Function">UTxO</a>
  <a id="4087" href="Ledger.Transaction.html#4060" class="Function">scriptOuts</a> <a id="4098" href="Ledger.Transaction.html#4098" class="Bound">utxo</a> <a id="4103" class="Symbol">=</a> <a id="4105" href="Ledger.Transaction.html#364" class="Function">filter</a> <a id="4112" class="Symbol">(λ</a> <a id="4115" class="Symbol">(_</a> <a id="4118" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4120" href="Ledger.Transaction.html#4120" class="Bound">addr</a> <a id="4125" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4127" class="Symbol">_)</a> <a id="4130" class="Symbol">→</a> <a id="4132" href="Ledger.Address.html#1931" class="Function">isScriptAddr</a> <a id="4145" href="Ledger.Transaction.html#4120" class="Bound">addr</a><a id="4149" class="Symbol">)</a> <a id="4151" href="Ledger.Transaction.html#4098" class="Bound">utxo</a>

  <a id="TransactionStructure.txinsScript"></a><a id="4159" href="Ledger.Transaction.html#4159" class="Function">txinsScript</a> <a id="4171" class="Symbol">:</a> <a id="4173" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="4175" href="Ledger.Transaction.html#2311" class="Function">TxIn</a> <a id="4180" class="Symbol">→</a> <a id="4182" href="Ledger.Transaction.html#2402" class="Function">UTxO</a> <a id="4187" class="Symbol">→</a> <a id="4189" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="4191" href="Ledger.Transaction.html#2311" class="Function">TxIn</a>
  <a id="4198" href="Ledger.Transaction.html#4159" class="Function">txinsScript</a> <a id="4210" href="Ledger.Transaction.html#4210" class="Bound">txins</a> <a id="4216" href="Ledger.Transaction.html#4216" class="Bound">utxo</a> <a id="4221" class="Symbol">=</a> <a id="4223" href="Ledger.Transaction.html#4210" class="Bound">txins</a> <a id="4229" href="Axiom.Set.html#9292" class="Function Operator">∩</a> <a id="4231" href="Class.IsSet.html#916" class="Function">dom</a> <a id="4235" class="Symbol">(</a><a id="4236" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4242" class="Symbol">(</a><a id="4243" href="Ledger.Transaction.html#4060" class="Function">scriptOuts</a> <a id="4254" href="Ledger.Transaction.html#4216" class="Bound">utxo</a><a id="4258" class="Symbol">))</a>

  <a id="TransactionStructure.refScripts"></a><a id="4264" href="Ledger.Transaction.html#4264" class="Function">refScripts</a> <a id="4275" class="Symbol">:</a> <a id="4277" href="Ledger.Transaction.html#3538" class="Record">Tx</a> <a id="4280" class="Symbol">→</a> <a id="4282" href="Ledger.Transaction.html#2402" class="Function">UTxO</a> <a id="4287" class="Symbol">→</a> <a id="4289" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4294" href="Ledger.Script.html#5396" class="Function">Script</a>
  <a id="4303" href="Ledger.Transaction.html#4264" class="Function">refScripts</a> <a id="4314" href="Ledger.Transaction.html#4314" class="Bound">tx</a> <a id="4317" href="Ledger.Transaction.html#4317" class="Bound">utxo</a> <a id="4322" class="Symbol">=</a>
    <a id="4328" href="Data.List.Base.html#4628" class="Function">mapMaybe</a> <a id="4337" class="Symbol">(</a><a id="4338" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4344" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4346" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4352" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4354" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="4359" class="Symbol">)</a> <a id="4361" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4363" href="abstract-set-theory.FiniteSetTheory.html#2463" class="Function">setToList</a> <a id="4373" class="Symbol">(</a><a id="4374" href="Class.IsSet.html#959" class="Function">range</a> <a id="4380" class="Symbol">(</a><a id="4381" href="Ledger.Transaction.html#4317" class="Bound">utxo</a> <a id="4386" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="4388" class="Symbol">(</a><a id="4389" href="Ledger.Transaction.html#2620" class="Function">txins</a> <a id="4395" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="4397" href="Ledger.Transaction.html#2650" class="Function">refInputs</a><a id="4406" class="Symbol">)))</a>
    <a id="4414" class="Keyword">where</a> <a id="4420" class="Keyword">open</a> <a id="4425" href="Ledger.Transaction.html#3538" class="Module">Tx</a><a id="4427" class="Symbol">;</a> <a id="4429" class="Keyword">open</a> <a id="4434" href="Ledger.Transaction.html#2584" class="Module">TxBody</a> <a id="4441" class="Symbol">(</a><a id="4442" href="Ledger.Transaction.html#4314" class="Bound">tx</a> <a id="4445" class="Symbol">.</a><a id="4446" href="Ledger.Transaction.html#3570" class="Field">body</a><a id="4450" class="Symbol">)</a>

  <a id="TransactionStructure.txscripts"></a><a id="4455" href="Ledger.Transaction.html#4455" class="Function">txscripts</a> <a id="4465" class="Symbol">:</a> <a id="4467" href="Ledger.Transaction.html#3538" class="Record">Tx</a> <a id="4470" class="Symbol">→</a> <a id="4472" href="Ledger.Transaction.html#2402" class="Function">UTxO</a> <a id="4477" class="Symbol">→</a> <a id="4479" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="4481" href="Ledger.Script.html#5396" class="Function">Script</a>
  <a id="4490" href="Ledger.Transaction.html#4455" class="Function">txscripts</a> <a id="4500" href="Ledger.Transaction.html#4500" class="Bound">tx</a> <a id="4503" href="Ledger.Transaction.html#4503" class="Bound">utxo</a> <a id="4508" class="Symbol">=</a> <a id="4510" href="Ledger.Transaction.html#3357" class="Field">scripts</a> <a id="4518" class="Symbol">(</a><a id="4519" href="Ledger.Transaction.html#4500" class="Bound">tx</a> <a id="4522" class="Symbol">.</a><a id="4523" href="Ledger.Transaction.html#3594" class="Field">wits</a><a id="4527" class="Symbol">)</a> <a id="4529" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="4531" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="4540" class="Symbol">(</a><a id="4541" href="Ledger.Transaction.html#4264" class="Function">refScripts</a> <a id="4552" href="Ledger.Transaction.html#4500" class="Bound">tx</a> <a id="4555" href="Ledger.Transaction.html#4503" class="Bound">utxo</a><a id="4559" class="Symbol">)</a>
    <a id="4565" class="Keyword">where</a> <a id="4571" class="Keyword">open</a> <a id="4576" href="Ledger.Transaction.html#3538" class="Module">Tx</a><a id="4578" class="Symbol">;</a> <a id="4580" class="Keyword">open</a> <a id="4585" href="Ledger.Transaction.html#3288" class="Module">TxWitnesses</a>

  <a id="TransactionStructure.lookupScriptHash"></a><a id="4600" href="Ledger.Transaction.html#4600" class="Function">lookupScriptHash</a> <a id="4617" class="Symbol">:</a> <a id="4619" href="Ledger.Crypto.html#1166" class="Function">ScriptHash</a> <a id="4630" class="Symbol">→</a> <a id="4632" href="Ledger.Transaction.html#3538" class="Record">Tx</a> <a id="4635" class="Symbol">→</a> <a id="4637" href="Ledger.Transaction.html#2402" class="Function">UTxO</a> <a id="4642" class="Symbol">→</a> <a id="4644" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4650" href="Ledger.Script.html#5396" class="Function">Script</a>
  <a id="4659" href="Ledger.Transaction.html#4600" class="Function">lookupScriptHash</a> <a id="4676" href="Ledger.Transaction.html#4676" class="Bound">sh</a> <a id="4679" href="Ledger.Transaction.html#4679" class="Bound">tx</a> <a id="4682" href="Ledger.Transaction.html#4682" class="Bound">utxo</a> <a id="4687" class="Symbol">=</a>
    <a id="4693" href="Class.ToBool.html#534" class="Function Operator">if</a> <a id="4696" href="Ledger.Transaction.html#4676" class="Bound">sh</a> <a id="4699" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="4701" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4706" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4712" class="Symbol">(</a><a id="4713" href="Ledger.Transaction.html#4782" class="Function">m</a> <a id="4715" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="4716" class="Symbol">)</a> <a id="4718" href="Class.ToBool.html#534" class="Function Operator">then</a>
      <a id="4729" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4734" class="Symbol">(</a><a id="4735" href="Axiom.Set.Map.html#13563" class="Function">lookupᵐ</a> <a id="4743" href="Ledger.Transaction.html#4782" class="Function">m</a> <a id="4745" href="Ledger.Transaction.html#4676" class="Bound">sh</a><a id="4747" class="Symbol">)</a>
    <a id="4753" href="Class.ToBool.html#534" class="Function Operator">else</a>
      <a id="4764" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
    <a id="4776" class="Keyword">where</a> <a id="4782" href="Ledger.Transaction.html#4782" class="Function">m</a> <a id="4784" class="Symbol">=</a> <a id="4786" href="Ledger.Set.HashMap.html#313" class="Function">setToHashMap</a> <a id="4799" class="Symbol">(</a><a id="4800" href="Ledger.Transaction.html#4455" class="Function">txscripts</a> <a id="4810" href="Ledger.Transaction.html#4679" class="Bound">tx</a> <a id="4813" href="Ledger.Transaction.html#4682" class="Bound">utxo</a><a id="4817" class="Symbol">)</a>


  <a id="TransactionStructure.isP2Script"></a><a id="4823" href="Ledger.Transaction.html#4823" class="Function">isP2Script</a> <a id="4834" class="Symbol">:</a> <a id="4836" href="Ledger.Script.html#5396" class="Function">Script</a> <a id="4843" class="Symbol">→</a> <a id="4845" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="4852" href="Ledger.Transaction.html#4823" class="Function">isP2Script</a> <a id="4863" class="Symbol">=</a> <a id="4865" href="Data.Bool.Base.html#1348" class="Function">T</a> <a id="4867" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4869" href="Data.Maybe.Base.html#1117" class="Function">is-just</a> <a id="4877" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4879" href="Data.Sum.html#870" class="Function">isInj₂</a>

  <a id="TransactionStructure.isP2Script?"></a><a id="4889" href="Ledger.Transaction.html#4889" class="Function">isP2Script?</a> <a id="4901" class="Symbol">:</a> <a id="4903" class="Symbol">∀</a> <a id="4905" class="Symbol">{</a><a id="4906" href="Ledger.Transaction.html#4906" class="Bound">s</a><a id="4907" class="Symbol">}</a> <a id="4909" class="Symbol">→</a> <a id="4911" href="Ledger.Transaction.html#4823" class="Function">isP2Script</a> <a id="4922" href="Ledger.Transaction.html#4906" class="Bound">s</a> <a id="4924" href="Class.Decidable.Core.html#208" class="Record Operator">⁇</a>
  <a id="4928" href="Ledger.Transaction.html#4889" class="Function">isP2Script?</a> <a id="4940" class="Symbol">{</a><a id="4941" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="4946" href="Ledger.Transaction.html#4946" class="Bound">x</a><a id="4947" class="Symbol">}</a> <a id="4949" class="Symbol">.</a><a id="4950" href="Class.Decidable.Core.html#264" class="Field">dec</a> <a id="4954" class="Symbol">=</a> <a id="4956" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="4959" class="Symbol">λ</a> <a id="4961" class="Symbol">()</a>
  <a id="4966" href="Ledger.Transaction.html#4889" class="Function">isP2Script?</a> <a id="4978" class="Symbol">{</a><a id="4979" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="4984" href="Ledger.Transaction.html#4984" class="Bound">y</a><a id="4985" class="Symbol">}</a> <a id="4987" class="Symbol">.</a><a id="4988" href="Class.Decidable.Core.html#264" class="Field">dec</a> <a id="4992" class="Symbol">=</a> <a id="4994" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="4998" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

  <a id="5004" class="Keyword">instance</a>
    <a id="TransactionStructure.HasCoin-TxOut"></a><a id="5017" href="Ledger.Transaction.html#5017" class="Function">HasCoin-TxOut</a> <a id="5031" class="Symbol">:</a> <a id="5033" href="Ledger.Interface.HasCoin.html#124" class="Record">HasCoin</a> <a id="5041" href="Ledger.Transaction.html#2334" class="Function">TxOut</a>
    <a id="5051" href="Ledger.Transaction.html#5017" class="Function">HasCoin-TxOut</a> <a id="5065" class="Symbol">.</a><a id="5066" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="5074" class="Symbol">=</a> <a id="5076" href="Ledger.TokenAlgebra.html#812" class="Function">coin</a> <a id="5081" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5083" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5089" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5091" href="Data.Product.Base.html#650" class="Field">proj₂</a>

</pre></body></html>