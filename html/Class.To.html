<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Class.To</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="Class.To.html" class="Module">Class.To</a> <a id="40" class="Keyword">where</a>

<a id="47" class="Keyword">record</a> <a id="To"></a><a id="54" href="Class.To.html#54" class="Record">To</a> <a id="57" class="Symbol">(</a><a id="58" href="Class.To.html#58" class="Bound">X</a> <a id="60" class="Symbol">:</a> <a id="62" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="65" class="Symbol">)</a> <a id="67" class="Symbol">(</a><a id="68" href="Class.To.html#68" class="Bound">Y</a> <a id="70" class="Symbol">:</a> <a id="72" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="75" class="Symbol">)</a> <a id="77" class="Symbol">:</a> <a id="79" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="83" class="Keyword">where</a>
  <a id="91" class="Keyword">field</a> 
    <a id="To.⟦_⟧"></a><a id="102" href="Class.To.html#102" class="Field Operator">⟦_⟧</a> <a id="106" class="Symbol">:</a> <a id="108" href="Class.To.html#58" class="Bound">X</a> <a id="110" class="Symbol">→</a> <a id="112" href="Class.To.html#68" class="Bound">Y</a>
  <a id="116" class="Keyword">infix</a> <a id="122" class="Number">5</a> <a id="124" href="Class.To.html#102" class="Field Operator">⟦_⟧</a>

<a id="129" class="Keyword">open</a> <a id="134" href="Class.To.html#54" class="Module">To</a> <a id="137" class="Symbol">⦃...⦄</a> <a id="143" class="Keyword">public</a>

<a id="151" class="Comment">-- Metaprogram to derive instances</a>
<a id="186" class="Keyword">open</a> <a id="191" class="Keyword">import</a> <a id="198" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="217" class="Symbol">as</a> <a id="220" class="Module">NE</a> <a id="223" class="Keyword">using</a> <a id="229" class="Symbol">(</a><a id="230" href="Data.List.NonEmpty.Base.html#1229" class="Record">List⁺</a><a id="235" class="Symbol">;</a> <a id="237" href="Data.List.NonEmpty.Base.html#1275" class="InductiveConstructor Operator">_∷_</a><a id="240" class="Symbol">)</a>
<a id="242" class="Keyword">open</a> <a id="247" class="Keyword">import</a> <a id="254" href="Data.List.html" class="Module">Data.List</a>
<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Meta.html" class="Module">Meta</a>
<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="MetaPrelude.html" class="Module">MetaPrelude</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="335" class="Keyword">open</a> <a id="340" class="Keyword">import</a> <a id="347" href="Reflection.Utils.Debug.html" class="Module">Reflection.Utils.Debug</a>

<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Class.MonadTC.html" class="Module">Class.MonadTC</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="421" class="Keyword">open</a> <a id="426" class="Keyword">import</a> <a id="433" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="478" class="Keyword">open</a> <a id="483" class="Keyword">import</a> <a id="490" href="Data.Product.Nary.NonDependent.html" class="Module">Data.Product.Nary.NonDependent</a> <a id="521" class="Keyword">using</a> <a id="527" class="Symbol">(</a><a id="528" href="Data.Product.Nary.NonDependent.html#3869" class="Function">uncurryₙ</a><a id="536" class="Symbol">)</a>

<a id="539" class="Keyword">open</a> <a id="544" href="Reflection.TCI.html#2233" class="Module">MonadTCI</a>

<a id="getCodPi"></a><a id="554" href="Class.To.html#554" class="Function">getCodPi</a> <a id="563" class="Symbol">:</a> <a id="565" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="570" class="Symbol">→</a> <a id="572" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a>
<a id="577" href="Class.To.html#554" class="Function">getCodPi</a> <a id="586" class="Symbol">(</a><a id="587" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="590" href="Class.To.html#590" class="Bound">a</a> <a id="592" href="Class.To.html#592" class="Bound">b</a><a id="593" class="Symbol">)</a> <a id="595" class="Symbol">=</a> <a id="597" href="Class.To.html#664" class="Function">adjustTerm</a> <a id="608" class="Number">1</a> <a id="610" class="Symbol">(</a><a id="611" href="Reflection.AST.Abstraction.html#1816" class="Function">unAbs</a> <a id="617" href="Class.To.html#592" class="Bound">b</a><a id="618" class="Symbol">)</a>
  <a id="622" class="Keyword">where</a>
    <a id="632" class="Comment">-- adjust De Bruijn indexes</a>
    <a id="664" href="Class.To.html#664" class="Function">adjustTerm</a> <a id="675" class="Symbol">:</a> <a id="677" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="679" class="Symbol">→</a> <a id="681" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="686" class="Symbol">→</a> <a id="688" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="697" href="Class.To.html#697" class="Function">adjustArg</a> <a id="707" class="Symbol">:</a> <a id="709" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="711" class="Symbol">→</a> <a id="713" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="717" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="722" class="Symbol">→</a> <a id="724" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="728" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="737" href="Class.To.html#737" class="Function">adjustArgs</a> <a id="748" class="Symbol">:</a> <a id="750" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="752" class="Symbol">→</a> <a id="754" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="759" class="Symbol">(</a><a id="760" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="764" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="768" class="Symbol">)</a> <a id="770" class="Symbol">→</a> <a id="772" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="777" class="Symbol">(</a><a id="778" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="782" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="786" class="Symbol">)</a>

    <a id="793" href="Class.To.html#664" class="Function">adjustTerm</a> <a id="804" href="Class.To.html#804" class="Bound">n</a> <a id="806" class="Symbol">(</a><a id="807" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="811" href="Class.To.html#811" class="Bound">n&#39;</a> <a id="814" href="Class.To.html#814" class="Bound">args</a><a id="818" class="Symbol">)</a> <a id="820" class="Symbol">=</a> <a id="822" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="826" class="Symbol">(</a><a id="827" href="Class.To.html#811" class="Bound">n&#39;</a> <a id="830" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="832" href="Class.To.html#804" class="Bound">n</a><a id="833" class="Symbol">)</a> <a id="835" class="Symbol">(</a><a id="836" href="Class.To.html#737" class="Function">adjustArgs</a> <a id="847" href="Class.To.html#804" class="Bound">n</a> <a id="849" href="Class.To.html#814" class="Bound">args</a><a id="853" class="Symbol">)</a>
    <a id="859" href="Class.To.html#664" class="Function">adjustTerm</a> <a id="870" href="Class.To.html#870" class="Bound">n</a> <a id="872" class="Symbol">(</a><a id="873" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="877" href="Class.To.html#877" class="Bound">c</a> <a id="879" href="Class.To.html#879" class="Bound">args</a><a id="883" class="Symbol">)</a> <a id="885" class="Symbol">=</a> <a id="887" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="891" href="Class.To.html#877" class="Bound">c</a> <a id="893" class="Symbol">(</a><a id="894" href="Class.To.html#737" class="Function">adjustArgs</a> <a id="905" href="Class.To.html#870" class="Bound">n</a> <a id="907" href="Class.To.html#879" class="Bound">args</a><a id="911" class="Symbol">)</a>
    <a id="917" href="Class.To.html#664" class="Function">adjustTerm</a> <a id="928" href="Class.To.html#928" class="Bound">n</a> <a id="930" class="Symbol">(</a><a id="931" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="935" href="Class.To.html#935" class="Bound">f</a> <a id="937" href="Class.To.html#937" class="Bound">args</a><a id="941" class="Symbol">)</a> <a id="943" class="Symbol">=</a> <a id="945" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="949" href="Class.To.html#935" class="Bound">f</a> <a id="951" class="Symbol">(</a><a id="952" href="Class.To.html#737" class="Function">adjustArgs</a> <a id="963" href="Class.To.html#928" class="Bound">n</a> <a id="965" href="Class.To.html#937" class="Bound">args</a><a id="969" class="Symbol">)</a>
    <a id="975" href="Class.To.html#664" class="CatchallClause Function">adjustTerm</a><a id="985" class="CatchallClause"> </a><a id="986" href="Class.To.html#986" class="CatchallClause Bound">n</a><a id="987" class="CatchallClause"> </a><a id="988" href="Class.To.html#988" class="CatchallClause Bound">d</a> <a id="990" class="Symbol">=</a> <a id="992" href="Class.To.html#988" class="Bound">d</a>

    <a id="999" href="Class.To.html#697" class="Function">adjustArg</a> <a id="1009" href="Class.To.html#1009" class="Bound">n</a> <a id="1011" class="Symbol">(</a><a id="1012" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="1016" href="Class.To.html#1016" class="Bound">i</a> <a id="1018" href="Class.To.html#1018" class="Bound">x</a><a id="1019" class="Symbol">)</a> <a id="1021" class="Symbol">=</a> <a id="1023" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="1027" href="Class.To.html#1016" class="Bound">i</a> <a id="1029" class="Symbol">(</a><a id="1030" href="Class.To.html#664" class="Function">adjustTerm</a> <a id="1041" href="Class.To.html#1009" class="Bound">n</a> <a id="1043" href="Class.To.html#1018" class="Bound">x</a><a id="1044" class="Symbol">)</a>

    <a id="1051" href="Class.To.html#737" class="Function">adjustArgs</a> <a id="1062" href="Class.To.html#1062" class="Bound">n</a> <a id="1064" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1067" class="Symbol">=</a> <a id="1069" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="1076" href="Class.To.html#737" class="Function">adjustArgs</a> <a id="1087" href="Class.To.html#1087" class="Bound">n</a> <a id="1089" class="Symbol">(</a><a id="1090" href="Class.To.html#1090" class="Bound">x</a> <a id="1092" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1094" href="Class.To.html#1094" class="Bound">xs</a><a id="1096" class="Symbol">)</a> <a id="1098" class="Symbol">=</a> <a id="1100" href="Class.To.html#697" class="Function">adjustArg</a> <a id="1110" href="Class.To.html#1087" class="Bound">n</a> <a id="1112" href="Class.To.html#1090" class="Bound">x</a> <a id="1114" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1116" href="Class.To.html#737" class="Function">adjustArgs</a> <a id="1127" href="Class.To.html#1087" class="Bound">n</a> <a id="1129" href="Class.To.html#1094" class="Bound">xs</a>
<a id="1132" href="Class.To.html#554" class="CatchallClause Function">getCodPi</a><a id="1140" class="CatchallClause"> </a><a id="1141" href="Class.To.html#1141" class="CatchallClause Bound">ty</a> <a id="1144" class="Symbol">=</a> <a id="1146" href="Class.To.html#1141" class="Bound">ty</a>

<a id="1150" class="Comment">-- Map a nonempty record def. to</a>
<a id="1183" class="Comment">-- 1. its constructor</a>
<a id="1205" class="Comment">-- 2. the type of its fields</a>
<a id="1234" class="Comment">-- 3. the number of fields</a>
<a id="fromRecDef"></a><a id="1261" href="Class.To.html#1261" class="Function">fromRecDef</a> <a id="1272" class="Symbol">:</a> <a id="1274" href="Agda.Builtin.Reflection.html#7485" class="Datatype">Definition</a> <a id="1285" class="Symbol">→</a> <a id="1287" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="1290" class="Symbol">(</a><a id="1291" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1296" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1298" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1303" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="1307" class="Symbol">)</a>
<a id="1309" href="Class.To.html#1261" class="Function">fromRecDef</a> <a id="1320" class="Symbol">(</a><a id="1321" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record′</a> <a id="1329" href="Class.To.html#1329" class="Bound">c</a> <a id="1331" href="Class.To.html#1331" class="Bound">fs</a><a id="1333" class="Symbol">)</a> <a id="1335" class="Symbol">=</a>
  <a id="1339" class="Keyword">do</a> <a id="1342" href="Class.To.html#1342" class="Bound">tys</a> <a id="1346" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1348" href="Class.Traversable.Core.html#297" class="Function">traverse</a> <a id="1357" class="Symbol">(λ</a> <a id="1360" href="Class.To.html#1360" class="Bound">f</a> <a id="1362" class="Symbol">→</a> <a id="1364" href="Class.Functor.Core.html#272" class="Function">fmap</a> <a id="1369" class="Symbol">⦃</a> <a id="1371" href="Class.Monad.Core.html#619" class="Function">Functor-M</a> <a id="1381" class="Symbol">⦄</a> <a id="1383" href="Class.To.html#554" class="Function">getCodPi</a> <a id="1392" class="Symbol">(</a><a id="1393" href="Reflection.TCI.html#3575" class="Function">getType</a> <a id="1401" class="Symbol">(</a><a id="1402" href="Reflection.AST.Argument.html#2658" class="Function">unArg</a> <a id="1408" href="Class.To.html#1360" class="Bound">f</a><a id="1409" class="Symbol">)))</a> <a id="1413" href="Class.To.html#1331" class="Bound">fs</a>
     <a id="1421" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="1428" class="Symbol">(</a><a id="1429" href="Class.To.html#1329" class="Bound">c</a> <a id="1431" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1433" href="Class.To.html#1342" class="Bound">tys</a><a id="1436" class="Symbol">)</a>
<a id="1438" href="Class.To.html#1261" class="CatchallClause Function">fromRecDef</a><a id="1448" class="CatchallClause"> </a><a id="1449" href="Class.To.html#1449" class="CatchallClause Bound">d</a>  <a id="1452" class="Symbol">=</a> <a id="1454" href="Reflection.TCI.html#2352" class="Function">typeError</a> <a id="1464" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="1466" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">strErr</a> <a id="1473" class="String">&quot;Expected a record type&quot;</a> <a id="1498" href="Data.List.Base.html#5205" class="Function Operator">]</a>

<a id="1501" class="Comment">-- Map a record to its name.</a>
<a id="1530" class="Comment">-- This will be superseeded in 2.8.0 by `quote R.constructor`</a>
<a id="getRecConstrName"></a><a id="1592" href="Class.To.html#1592" class="Function">getRecConstrName</a> <a id="1609" class="Symbol">:</a> <a id="1611" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1616" class="Symbol">→</a> <a id="1618" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="1621" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
<a id="1626" href="Class.To.html#1592" class="Function">getRecConstrName</a> <a id="1643" href="Class.To.html#1643" class="Bound">rn</a> <a id="1646" class="Symbol">=</a>
  <a id="1650" class="Keyword">do</a> <a id="1653" href="Class.To.html#1653" class="Bound">d</a> <a id="1655" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="1657" href="Reflection.TCI.html#3675" class="Function">getDefinition</a> <a id="1671" href="Class.To.html#1643" class="Bound">rn</a>
     <a id="1679" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="1684" href="Class.To.html#1653" class="Bound">d</a> <a id="1686" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="1689" class="Symbol">λ</a> <a id="1691" class="Keyword">where</a>
       <a id="1704" class="Symbol">(</a><a id="1705" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record′</a> <a id="1713" href="Class.To.html#1713" class="Bound">c</a> <a id="1715" class="Symbol">_)</a> <a id="1718" class="Symbol">→</a> <a id="1720" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="1727" href="Class.To.html#1713" class="Bound">c</a>
       <a id="1736" class="CatchallClause Symbol">_</a> <a id="1738" class="Symbol">→</a> <a id="1740" href="Reflection.TCI.html#2352" class="Function">typeError</a> <a id="1750" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="1752" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">strErr</a> <a id="1759" class="String">&quot;Expected a record got something else&quot;</a> <a id="1798" href="Data.List.Base.html#5205" class="Function Operator">]</a>

<a id="1801" class="Comment">-- Derive instance of To</a>
<a id="derive-To-single"></a><a id="1826" href="Class.To.html#1826" class="Function">derive-To-single</a> <a id="1843" class="Symbol">:</a> <a id="1845" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1850" class="Comment">-- name of the record type</a>
                 <a id="1894" class="Symbol">→</a> <a id="1896" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1901" class="Comment">-- name of the instance to be defined</a>
                 <a id="1956" class="Symbol">→</a> <a id="1958" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="1961" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1963" href="Class.To.html#1826" class="Function">derive-To-single</a> <a id="1980" href="Class.To.html#1980" class="Bound">recTyName</a> <a id="1990" href="Class.To.html#1990" class="Bound">instName</a> <a id="1999" class="Symbol">=</a>
  <a id="2003" class="Keyword">do</a> <a id="2006" class="Symbol">(</a><a id="2007" href="Class.To.html#2007" class="Bound">To-ctrName</a> <a id="2018" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2020" class="Symbol">_)</a> <a id="2023" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="2025" href="Reflection.TCI.html#3675" class="Function">getDefinition</a> <a id="2039" class="Symbol">(</a><a id="2040" class="Keyword">quote</a> <a id="2046" href="Class.To.html#54" class="Record">To</a><a id="2048" class="Symbol">)</a> <a id="2050" href="Class.Monad.Core.html#299" class="Field Operator">&gt;&gt;=</a> <a id="2054" href="Class.To.html#1261" class="Function">fromRecDef</a> <a id="2065" class="Comment">-- this will be superseeded by &#39;quote To.constructor&#39; in Agda 2.8.0</a>
     <a id="2138" class="Symbol">(</a><a id="2139" href="Class.To.html#2139" class="Bound">ctrName</a> <a id="2147" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2149" href="Class.To.html#2149" class="Bound">fTys</a><a id="2153" class="Symbol">@(</a><a id="2155" href="Class.To.html#2155" class="Bound">fTy</a> <a id="2159" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2161" href="Class.To.html#2161" class="Bound">fTys&#39;</a><a id="2166" class="Symbol">))</a> <a id="2169" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="2171" href="Reflection.TCI.html#3675" class="Function">getDefinition</a> <a id="2185" href="Class.To.html#1980" class="Bound">recTyName</a>  <a id="2196" href="Class.Monad.Core.html#299" class="Field Operator">&gt;&gt;=</a> <a id="2200" href="Class.To.html#1261" class="Function">fromRecDef</a>
       <a id="2218" class="Keyword">where</a> <a id="2224" class="Symbol">(_</a> <a id="2227" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2229" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2231" class="Symbol">)</a> <a id="2233" class="Symbol">→</a> <a id="2235" href="Reflection.TCI.html#2352" class="Function">typeError</a> <a id="2245" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="2247" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">strErr</a> <a id="2254" class="String">&quot;Expecting a nonempty record type&quot;</a> <a id="2289" href="Data.List.Base.html#5205" class="Function Operator">]</a>
     <a id="2296" href="Class.To.html#2296" class="Bound">arity</a>            <a id="2313" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="2315" href="Reflection.TCI.html#2944" class="Function">quoteTC</a> <a id="2323" class="Symbol">(</a><a id="2324" href="Data.List.Base.html#5044" class="Function">length</a> <a id="2331" href="Class.To.html#2149" class="Bound">fTys</a><a id="2335" class="Symbol">)</a>
     <a id="2342" href="Class.To.html#2342" class="Bound">bot</a>              <a id="2359" href="Class.Monad.Core.html#299" class="Field Operator">←</a> <a id="2361" href="Reflection.TCI.html#2944" class="Function">quoteTC</a> <a id="2369" href="Data.Empty.html#914" class="Function">⊥</a>
     <a id="2376" class="Keyword">let</a> <a id="2380" href="Class.To.html#2380" class="Bound">tyProd</a> <a id="2387" class="Symbol">=</a> <a id="2389" href="Data.List.NonEmpty.Base.html#2978" class="Function">NE.foldr₁</a> <a id="2399" class="Symbol">(λ</a> <a id="2402" href="Class.To.html#2402" class="Bound">ty</a> <a id="2405" href="Class.To.html#2405" class="Bound">tys</a> <a id="2409" class="Symbol">→</a> <a id="2411" class="Symbol">(</a><a id="2412" class="Keyword">quote</a> <a id="2418" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="2421" class="Symbol">)</a> <a id="2423" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">∙⟦</a> <a id="2426" href="Class.To.html#2402" class="Bound">ty</a> <a id="2429" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">∣</a> <a id="2431" href="Class.To.html#2405" class="Bound">tys</a> <a id="2435" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">⟧</a><a id="2436" class="Symbol">)</a> <a id="2438" class="Symbol">(</a><a id="2439" href="Class.To.html#2155" class="Bound">fTy</a> <a id="2443" href="Data.List.NonEmpty.Base.html#1275" class="InductiveConstructor Operator">∷</a> <a id="2445" href="Class.To.html#2161" class="Bound">fTys&#39;</a><a id="2450" class="Symbol">)</a>
     <a id="2457" class="Keyword">let</a> <a id="2461" href="Class.To.html#2461" class="Bound">defTm</a>  <a id="2468" class="Symbol">=</a> <a id="2470" class="Symbol">(</a><a id="2471" class="Keyword">quote</a> <a id="2477" href="Class.To.html#54" class="Record">To</a><a id="2479" class="Symbol">)</a> <a id="2481" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">∙⟦</a> <a id="2484" href="Class.To.html#2380" class="Bound">tyProd</a> <a id="2491" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">∣</a> <a id="2493" href="Class.To.html#1980" class="Bound">recTyName</a> <a id="2503" href="Reflection.Syntax.html#2899" class="InductiveConstructor Operator">∙</a> <a id="2505" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">⟧</a>
     <a id="2512" class="Keyword">let</a> <a id="2516" href="Class.To.html#2516" class="Bound">instTm</a> <a id="2523" class="Symbol">=</a> <a id="2525" href="Class.To.html#2007" class="Bound">To-ctrName</a> <a id="2536" href="Reflection.Syntax.html#3186" class="InductiveConstructor Operator">◆⟦</a> <a id="2539" class="Keyword">quote</a> <a id="2545" href="Data.Product.Nary.NonDependent.html#3869" class="Function">uncurryₙ</a> <a id="2554" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">∙⟦</a> <a id="2557" href="Class.To.html#2296" class="Bound">arity</a> <a id="2563" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">∣</a> <a id="2565" href="Class.To.html#2139" class="Bound">ctrName</a> <a id="2573" href="Reflection.Syntax.html#3162" class="InductiveConstructor Operator">◆</a> <a id="2575" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">⟧</a> <a id="2577" href="Reflection.Syntax.html#3186" class="InductiveConstructor Operator">⟧</a>
     <a id="2584" href="Reflection.TCI.html#3300" class="Function">declareDef</a> <a id="2595" class="Symbol">(</a><a id="2596" href="Reflection.AST.Argument.html#1453" class="InductiveConstructor">iArg</a> <a id="2601" href="Class.To.html#1990" class="Bound">instName</a><a id="2609" class="Symbol">)</a> <a id="2611" href="Class.To.html#2461" class="Bound">defTm</a>
     <a id="2622" href="Reflection.TCI.html#3484" class="Function">defineFun</a> <a id="2632" href="Class.To.html#1990" class="Bound">instName</a> <a id="2641" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="2643" href="Reflection.Syntax.html#1755" class="InductiveConstructor Operator">⟦⇒</a> <a id="2646" href="Class.To.html#2516" class="Bound">instTm</a> <a id="2653" href="Reflection.Syntax.html#1755" class="InductiveConstructor Operator">⟧</a> <a id="2655" href="Data.List.Base.html#5205" class="Function Operator">]</a>

<a id="2658" class="Keyword">module</a> <a id="2665" href="Class.To.html#2665" class="Module">_</a> <a id="2667" class="Symbol">⦃</a> <a id="2669" href="Class.To.html#2669" class="Bound">_</a> <a id="2671" class="Symbol">:</a> <a id="2673" href="Class.MonadTC.html#618" class="Record">TCOptions</a> <a id="2683" class="Symbol">⦄</a> <a id="2685" class="Keyword">where</a>
  <a id="2693" href="Class.To.html#2693" class="Function">derive-To</a> <a id="2703" class="Symbol">:</a> <a id="2705" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2710" class="Symbol">(</a><a id="2711" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2716" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2718" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="2722" class="Symbol">)</a> <a id="2724" class="Symbol">→</a> <a id="2726" href="Reflection.Tactic.html#512" class="Function">UnquoteDecl</a>
  <a id="2740" href="Class.To.html#2693" class="Function">derive-To</a> <a id="2750" href="Class.To.html#2750" class="Bound">rcs</a> <a id="2754" class="Symbol">=</a> <a id="2756" href="Reflection.Tactic.html#904" class="Function">initUnquoteWithGoal</a> <a id="2776" class="Symbol">(</a><a id="2777" class="Keyword">quote</a> <a id="2783" href="Class.To.html#54" class="Record">To</a> <a id="2786" href="Reflection.Syntax.html#2899" class="InductiveConstructor Operator">∙</a><a id="2787" class="Symbol">)</a> <a id="2789" class="Symbol">(</a><a id="2790" href="Class.Traversable.Core.html#297" class="Function">traverse</a> <a id="2799" class="Symbol">(</a><a id="2800" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="2808" href="Class.To.html#1826" class="Function">derive-To-single</a><a id="2824" class="Symbol">)</a> <a id="2826" href="Class.To.html#2750" class="Bound">rcs</a> <a id="2830" href="Class.Monad.Core.html#333" class="Function Operator">&gt;&gt;</a> <a id="2833" href="Class.Monad.Core.html#278" class="Field">return</a> <a id="2840" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="2842" class="Symbol">)</a>

<a id="2845" class="Comment">-- Example usage</a>
<a id="2862" class="Keyword">private</a>
  <a id="2872" class="Keyword">record</a> <a id="R"></a><a id="2879" href="Class.To.html#2879" class="Record">R</a> <a id="2881" class="Symbol">:</a> <a id="2883" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2887" class="Keyword">where</a>
    <a id="2897" class="Keyword">field</a> <a id="R.r"></a><a id="2903" href="Class.To.html#2903" class="Field">r</a> <a id="2905" class="Symbol">:</a> <a id="2907" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>

  <a id="2915" class="Keyword">record</a> <a id="R&#39;"></a><a id="2922" href="Class.To.html#2922" class="Record">R&#39;</a> <a id="2925" class="Symbol">:</a> <a id="2927" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2931" class="Keyword">where</a>
    <a id="2941" class="Keyword">field</a> <a id="R&#39;.x"></a><a id="2947" href="Class.To.html#2947" class="Field">x</a> <a id="2949" class="Symbol">:</a> <a id="2951" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
          <a id="R&#39;.y"></a><a id="2966" href="Class.To.html#2966" class="Field">y</a> <a id="2968" class="Symbol">:</a> <a id="2970" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2972" class="Symbol">→</a> <a id="2974" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

  <a id="2979" class="Keyword">unquoteDecl</a> <a id="To-R"></a><a id="2991" href="Class.To.html#2991" class="Function">To-R</a> <a id="To-R&#39;"></a><a id="2996" href="Class.To.html#2996" class="Function">To-R&#39;</a> <a id="3002" class="Symbol">=</a> <a id="3004" href="Class.To.html#2693" class="Function">derive-To</a> <a id="3014" class="Symbol">⦃</a> <a id="3016" href="Class.MonadTC.html#704" class="Function">defaultTCOptions</a> <a id="3033" class="Symbol">⦄</a> <a id="3035" class="Symbol">((</a><a id="3037" class="Keyword">quote</a> <a id="3043" href="Class.To.html#2879" class="Record">R</a> <a id="3045" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3047" href="Class.To.html#2991" class="Function">To-R</a><a id="3051" class="Symbol">)</a> <a id="3053" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3055" class="Symbol">(</a><a id="3056" class="Keyword">quote</a> <a id="3062" href="Class.To.html#2922" class="Record">R&#39;</a> <a id="3065" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3067" href="Class.To.html#2996" class="Function">To-R&#39;</a><a id="3072" class="Symbol">)</a> <a id="3074" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3076" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3078" class="Symbol">)</a>

  <a id="p"></a><a id="3083" href="Class.To.html#3083" class="Function">p</a> <a id="3085" class="Symbol">:</a> <a id="3087" href="Class.To.html#2879" class="Record">R</a>
  <a id="3091" href="Class.To.html#3083" class="Function">p</a> <a id="3093" class="Symbol">=</a> <a id="3095" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="3097" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="3102" href="Class.To.html#102" class="Field Operator">⟧</a>

  <a id="q"></a><a id="3107" href="Class.To.html#3107" class="Function">q</a> <a id="3109" class="Symbol">:</a> <a id="3111" href="Class.To.html#2922" class="Record">R&#39;</a>
  <a id="3116" href="Class.To.html#3107" class="Function">q</a> <a id="3118" class="Symbol">=</a> <a id="3120" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="3122" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="3127" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3129" class="Symbol">(λ</a> <a id="3132" href="Class.To.html#3132" class="Bound">x</a> <a id="3134" class="Symbol">→</a> <a id="3136" href="Class.To.html#3132" class="Bound">x</a><a id="3137" class="Symbol">)</a> <a id="3139" href="Class.To.html#102" class="Field Operator">⟧</a>

  <a id="3144" class="Keyword">module</a> <a id="3151" href="Class.To.html#3151" class="Module">_</a> <a id="3153" class="Symbol">(</a><a id="3154" href="Class.To.html#3154" class="Bound">x</a> <a id="3156" class="Symbol">:</a> <a id="3158" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="3161" class="Symbol">)</a> <a id="3163" class="Keyword">where</a>
    <a id="3173" class="Keyword">record</a> <a id="3180" href="Class.To.html#3180" class="Record">R&#39;&#39;</a> <a id="3184" class="Symbol">:</a> <a id="3186" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3190" class="Keyword">where</a>
      <a id="3202" class="Keyword">field</a> <a id="3208" href="Class.To.html#3208" class="Field">a</a> <a id="3210" class="Symbol">:</a> <a id="3212" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
            <a id="3226" href="Class.To.html#3226" class="Field">b</a> <a id="3228" href="Class.To.html#3228" class="Field">c</a> <a id="3230" class="Symbol">:</a> <a id="3232" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>

    <a id="3242" class="Keyword">instance</a>
      <a id="3257" class="Keyword">unquoteDecl</a> <a id="3269" href="Class.To.html#3269" class="Function">To-R&#39;&#39;</a> <a id="3276" class="Symbol">=</a> <a id="3278" href="Class.To.html#2693" class="Function">derive-To</a> <a id="3288" class="Symbol">⦃</a> <a id="3290" href="Class.MonadTC.html#704" class="Function">defaultTCOptions</a> <a id="3307" class="Symbol">⦄</a> <a id="3309" class="Symbol">((</a><a id="3311" class="Keyword">quote</a> <a id="3317" href="Class.To.html#3180" class="Record">R&#39;&#39;</a> <a id="3321" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3323" href="Class.To.html#3269" class="Function">To-R&#39;&#39;</a><a id="3329" class="Symbol">)</a> <a id="3331" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>  <a id="3334" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3336" class="Symbol">)</a>
</pre></body></html>