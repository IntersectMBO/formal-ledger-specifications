<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Dijkstra.Specification.Utxow</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="53" class="Keyword">open</a> <a id="58" class="Keyword">import</a> <a id="65" href="Ledger.Dijkstra.Specification.Abstract.html" class="Module">Ledger.Dijkstra.Specification.Abstract</a>
<a id="104" class="Keyword">open</a> <a id="109" class="Keyword">import</a> <a id="116" href="Ledger.Dijkstra.Specification.Transaction.html" class="Module">Ledger.Dijkstra.Specification.Transaction</a>

<a id="159" class="Keyword">module</a> <a id="166" href="Ledger.Dijkstra.Specification.Utxow.html" class="Module">Ledger.Dijkstra.Specification.Utxow</a>
  <a id="204" class="Symbol">(</a><a id="205" href="Ledger.Dijkstra.Specification.Utxow.html#205" class="Bound">txs</a> <a id="209" class="Symbol">:</a> <a id="211" class="Symbol">_)</a> <a id="214" class="Symbol">(</a><a id="215" class="Keyword">open</a> <a id="220" href="Ledger.Dijkstra.Specification.Transaction.html#1329" class="Module">TransactionStructure</a> <a id="241" href="Ledger.Dijkstra.Specification.Utxow.html#205" class="Bound">txs</a><a id="244" class="Symbol">)</a>
  <a id="248" class="Symbol">(</a><a id="249" href="Ledger.Dijkstra.Specification.Utxow.html#249" class="Bound">abs</a> <a id="253" class="Symbol">:</a> <a id="255" href="Ledger.Dijkstra.Specification.Abstract.html#912" class="Record">AbstractFunctions</a> <a id="273" href="Ledger.Dijkstra.Specification.Utxow.html#205" class="Bound">txs</a><a id="276" class="Symbol">)</a> <a id="278" class="Symbol">(</a><a id="279" class="Keyword">open</a> <a id="284" href="Ledger.Dijkstra.Specification.Abstract.html#912" class="Module">AbstractFunctions</a> <a id="302" href="Ledger.Dijkstra.Specification.Utxow.html#249" class="Bound">abs</a><a id="305" class="Symbol">)</a>
  <a id="309" class="Keyword">where</a>

<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Ledger.Dijkstra.Specification.Utxo.html" class="Module">Ledger.Dijkstra.Specification.Utxo</a> <a id="363" href="Ledger.Dijkstra.Specification.Utxow.html#205" class="Bound">txs</a> <a id="367" href="Ledger.Dijkstra.Specification.Utxow.html#249" class="Bound">abs</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Ledger.Dijkstra.Specification.Script.Validation.html" class="Module">Ledger.Dijkstra.Specification.Script.Validation</a> <a id="431" href="Ledger.Dijkstra.Specification.Utxow.html#205" class="Bound">txs</a> <a id="435" href="Ledger.Dijkstra.Specification.Utxow.html#249" class="Bound">abs</a>

<a id="440" class="Keyword">private</a> <a id="448" class="Keyword">variable</a>
  <a id="459" href="Ledger.Dijkstra.Specification.Utxow.html#459" class="Generalizable">ℓ</a>     <a id="465" class="Symbol">:</a> <a id="467" href="Ledger.Dijkstra.Specification.Transaction.html#768" class="Datatype">TxLevel</a>
  <a id="477" href="Ledger.Dijkstra.Specification.Utxow.html#477" class="Generalizable">A</a>     <a id="483" class="Symbol">:</a> <a id="485" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="492" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a>     <a id="498" class="Symbol">:</a> <a id="500" href="Ledger.Dijkstra.Specification.Utxow.html#477" class="Generalizable">A</a>
  <a id="504" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a> <a id="506" href="Ledger.Dijkstra.Specification.Utxow.html#506" class="Generalizable">s&#39;</a>  <a id="510" class="Symbol">:</a> <a id="512" href="Ledger.Dijkstra.Specification.Utxo.html#1583" class="Record">UTxOState</a>
  <a id="524" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a> <a id="530" class="Symbol">:</a> <a id="532" href="Ledger.Dijkstra.Specification.Transaction.html#5320" class="Function">TopLevelTx</a>
  <a id="545" href="Ledger.Dijkstra.Specification.Utxow.html#545" class="Generalizable">txSub</a> <a id="551" class="Symbol">:</a> <a id="553" href="Ledger.Dijkstra.Specification.Transaction.html#5370" class="Function">SubLevelTx</a>


<a id="566" class="Keyword">module</a> <a id="573" href="Ledger.Dijkstra.Specification.Utxow.html#573" class="Module">_</a> <a id="575" class="Symbol">(</a><a id="576" href="Ledger.Dijkstra.Specification.Utxow.html#576" class="Bound">tx</a> <a id="579" class="Symbol">:</a> <a id="581" href="Ledger.Dijkstra.Specification.Transaction.html#5320" class="Function">TopLevelTx</a><a id="591" class="Symbol">)</a> <a id="593" class="Keyword">where</a>
  <a id="601" class="Keyword">open</a> <a id="606" href="Ledger.Dijkstra.Specification.Transaction.html#3522" class="Module">Tx</a> <a id="609" href="Ledger.Dijkstra.Specification.Utxow.html#576" class="Bound">tx</a>
  <a id="614" class="Keyword">open</a> <a id="619" href="Ledger.Dijkstra.Specification.Transaction.html#3794" class="Module">TxBody</a> <a id="626" href="Ledger.Dijkstra.Specification.Transaction.html#3594" class="Field">txBody</a>

  <a id="636" class="Keyword">module</a> <a id="643" href="Ledger.Dijkstra.Specification.Utxow.html#643" class="Module">_</a> <a id="645" class="Symbol">(</a><a id="646" href="Ledger.Dijkstra.Specification.Utxow.html#646" class="Bound">utxo</a> <a id="651" class="Symbol">:</a> <a id="653" href="Ledger.Dijkstra.Specification.Transaction.html#3158" class="Function">UTxO</a><a id="657" class="Symbol">)</a> <a id="659" class="Keyword">where</a>
    <a id="669" href="Ledger.Dijkstra.Specification.Utxow.html#669" class="Function">UsesBootstrapAddress</a> <a id="690" class="Symbol">:</a> <a id="692" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="701" href="Ledger.Dijkstra.Specification.Utxow.html#669" class="Function">UsesBootstrapAddress</a> <a id="722" class="Symbol">=</a> <a id="724" href="Class.IsSet.html#736" class="Function">∃[</a> <a id="727" href="Ledger.Dijkstra.Specification.Utxow.html#727" class="Bound">o</a> <a id="729" href="Class.IsSet.html#736" class="Function">∈</a> <a id="731" class="Symbol">(</a><a id="732" href="Class.IsSet.html#959" class="Function">range</a> <a id="738" href="Ledger.Dijkstra.Specification.Transaction.html#4005" class="Function">txOuts</a><a id="744" class="Symbol">)</a> <a id="746" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="748" href="Class.IsSet.html#959" class="Function">range</a> <a id="754" class="Symbol">(</a><a id="755" href="Ledger.Dijkstra.Specification.Utxow.html#646" class="Bound">utxo</a> <a id="760" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="762" class="Symbol">(</a><a id="763" href="Ledger.Dijkstra.Specification.Transaction.html#3870" class="Function">txIns</a> <a id="769" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="771" href="Ledger.Dijkstra.Specification.Transaction.html#3908" class="Function">referenceInputs</a><a id="786" class="Symbol">))</a> <a id="789" href="Class.IsSet.html#736" class="Function">]</a> <a id="791" href="Ledger.Core.Specification.Address.html#3584" class="Datatype">isBootstrapAddr</a> <a id="807" class="Symbol">(</a><a id="808" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="814" href="Ledger.Dijkstra.Specification.Utxow.html#727" class="Bound">o</a><a id="815" class="Symbol">)</a>

    <a id="822" href="Ledger.Dijkstra.Specification.Utxow.html#822" class="Function">HasInlineDatum</a> <a id="837" class="Symbol">:</a> <a id="839" href="Ledger.Dijkstra.Specification.Transaction.html#3077" class="Function">TxOut</a> <a id="845" class="Symbol">→</a> <a id="847" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="856" href="Ledger.Dijkstra.Specification.Utxow.html#822" class="Function">HasInlineDatum</a> <a id="871" href="Ledger.Dijkstra.Specification.Utxow.html#871" class="Bound">txout</a> <a id="877" class="Symbol">=</a> <a id="879" href="Data.Maybe.html#845" class="Function">Is-just</a> <a id="887" class="Symbol">(</a><a id="888" href="Ledger.Dijkstra.Specification.Transaction.html#14740" class="Function">txOutToDatum</a> <a id="901" href="Ledger.Dijkstra.Specification.Utxow.html#871" class="Bound">txout</a><a id="906" class="Symbol">)</a>

    <a id="913" href="Ledger.Dijkstra.Specification.Utxow.html#913" class="Function">UsesV2Features</a> <a id="928" class="Symbol">:</a> <a id="930" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="939" href="Ledger.Dijkstra.Specification.Utxow.html#913" class="Function">UsesV2Features</a> <a id="954" class="Symbol">=</a> <a id="956" href="Class.IsSet.html#736" class="Function">∃[</a> <a id="959" href="Ledger.Dijkstra.Specification.Utxow.html#959" class="Bound">o</a> <a id="961" href="Class.IsSet.html#736" class="Function">∈</a> <a id="963" class="Symbol">(</a><a id="964" href="Class.IsSet.html#959" class="Function">range</a> <a id="970" href="Ledger.Dijkstra.Specification.Transaction.html#4005" class="Function">txOuts</a><a id="976" class="Symbol">)</a> <a id="978" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="980" href="Class.IsSet.html#959" class="Function">range</a> <a id="986" class="Symbol">(</a><a id="987" href="Ledger.Dijkstra.Specification.Utxow.html#646" class="Bound">utxo</a> <a id="992" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="994" class="Symbol">(</a><a id="995" href="Ledger.Dijkstra.Specification.Transaction.html#3870" class="Function">txIns</a> <a id="1001" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="1003" href="Ledger.Dijkstra.Specification.Transaction.html#3908" class="Function">referenceInputs</a><a id="1018" class="Symbol">))</a> <a id="1021" href="Class.IsSet.html#736" class="Function">]</a> <a id="1023" href="Ledger.Dijkstra.Specification.Utxow.html#822" class="Function">HasInlineDatum</a> <a id="1038" href="Ledger.Dijkstra.Specification.Utxow.html#959" class="Bound">o</a>

  <a id="1043" class="Keyword">data</a> <a id="1048" href="Ledger.Dijkstra.Specification.Utxow.html#1048" class="Datatype">UsesV3Features</a> <a id="1063" class="Symbol">:</a> <a id="1065" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1069" class="Keyword">where</a>
    <a id="1079" href="Ledger.Dijkstra.Specification.Utxow.html#1079" class="InductiveConstructor">hasVotes</a>     <a id="1092" class="Symbol">:</a> <a id="1094" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1096" class="Symbol">(</a><a id="1097" href="stdlib.Data.List.html#154" class="Function">Is-[]</a> <a id="1103" href="Ledger.Dijkstra.Specification.Transaction.html#4363" class="Function">txGovVotes</a><a id="1113" class="Symbol">)</a>     <a id="1119" class="Symbol">→</a> <a id="1121" href="Ledger.Dijkstra.Specification.Utxow.html#1048" class="Datatype">UsesV3Features</a>
    <a id="1140" href="Ledger.Dijkstra.Specification.Utxow.html#1140" class="InductiveConstructor">hasProposals</a> <a id="1153" class="Symbol">:</a> <a id="1155" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1157" class="Symbol">(</a><a id="1158" href="stdlib.Data.List.html#154" class="Function">Is-[]</a> <a id="1164" href="Ledger.Dijkstra.Specification.Transaction.html#4407" class="Function">txGovProposals</a><a id="1178" class="Symbol">)</a> <a id="1180" class="Symbol">→</a> <a id="1182" href="Ledger.Dijkstra.Specification.Utxow.html#1048" class="Datatype">UsesV3Features</a>
    <a id="1201" href="Ledger.Dijkstra.Specification.Utxow.html#1201" class="InductiveConstructor">hasDonation</a>  <a id="1214" class="Symbol">:</a> <a id="1216" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="1224" href="Ledger.Dijkstra.Specification.Transaction.html#4322" class="Function">txDonation</a>       <a id="1241" class="Symbol">→</a> <a id="1243" href="Ledger.Dijkstra.Specification.Utxow.html#1048" class="Datatype">UsesV3Features</a>
    <a id="1262" href="Ledger.Dijkstra.Specification.Utxow.html#1262" class="InductiveConstructor">hasTreasure</a>  <a id="1275" class="Symbol">:</a> <a id="1277" href="Data.Maybe.html#845" class="Function">Is-just</a> <a id="1285" href="Ledger.Dijkstra.Specification.Transaction.html#4500" class="Function">currentTreasury</a>  <a id="1302" class="Symbol">→</a> <a id="1304" href="Ledger.Dijkstra.Specification.Utxow.html#1048" class="Datatype">UsesV3Features</a>

  <a id="1322" class="Keyword">data</a> <a id="1327" href="Ledger.Dijkstra.Specification.Utxow.html#1327" class="Datatype">UsesV4Features</a> <a id="1342" class="Symbol">:</a> <a id="1344" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1348" class="Keyword">where</a>
    <a id="1358" href="Ledger.Dijkstra.Specification.Utxow.html#1358" class="InductiveConstructor">hasSubtransactions</a>  <a id="1378" class="Symbol">:</a> <a id="1380" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1382" class="Symbol">(</a><a id="1383" href="stdlib.Data.List.html#154" class="Function">Is-[]</a> <a id="1389" href="Ledger.Dijkstra.Specification.Transaction.html#4658" class="Function">txSubTransactions</a><a id="1406" class="Symbol">)</a> <a id="1408" class="Symbol">→</a> <a id="1410" href="Ledger.Dijkstra.Specification.Utxow.html#1327" class="Datatype">UsesV4Features</a>
    <a id="1429" href="Ledger.Dijkstra.Specification.Utxow.html#1429" class="InductiveConstructor">hasGuards</a>           <a id="1449" class="Symbol">:</a> <a id="1451" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1453" class="Symbol">(</a><a id="1454" href="Ledger.Prelude.html#2820" class="Function">Is-∅</a> <a id="1459" href="Ledger.Dijkstra.Specification.Transaction.html#4736" class="Function">txGuards</a><a id="1467" class="Symbol">)</a>           <a id="1479" class="Symbol">→</a> <a id="1481" href="Ledger.Dijkstra.Specification.Utxow.html#1327" class="Datatype">UsesV4Features</a>


<a id="1498" class="Keyword">module</a> <a id="1505" href="Ledger.Dijkstra.Specification.Utxow.html#1505" class="Module">_</a> <a id="1507" class="Symbol">{</a><a id="1508" href="Ledger.Dijkstra.Specification.Utxow.html#1508" class="Bound">tx</a> <a id="1511" class="Symbol">:</a> <a id="1513" href="Ledger.Dijkstra.Specification.Transaction.html#5320" class="Function">TopLevelTx</a><a id="1523" class="Symbol">}</a> <a id="1525" class="Keyword">where</a>
  <a id="1533" class="Keyword">open</a> <a id="1538" href="Ledger.Dijkstra.Specification.Transaction.html#3522" class="Module">Tx</a> <a id="1541" href="Ledger.Dijkstra.Specification.Utxow.html#1508" class="Bound">tx</a>
  <a id="1546" class="Keyword">open</a> <a id="1551" href="Ledger.Dijkstra.Specification.Transaction.html#3794" class="Module">TxBody</a> <a id="1558" href="Ledger.Dijkstra.Specification.Transaction.html#3594" class="Field">txBody</a>

  <a id="1568" class="Keyword">instance</a>
    <a id="1581" href="Ledger.Dijkstra.Specification.Utxow.html#1581" class="Function">Dec-UsesV3Features</a> <a id="1600" class="Symbol">:</a> <a id="1602" href="Ledger.Dijkstra.Specification.Utxow.html#1048" class="Datatype">UsesV3Features</a> <a id="1617" href="Ledger.Dijkstra.Specification.Utxow.html#1508" class="Bound">tx</a> <a id="1620" href="Class.Decidable.Core.html#217" class="Record Operator">⁇</a>
    <a id="1626" href="Ledger.Dijkstra.Specification.Utxow.html#1581" class="Function">Dec-UsesV3Features</a> <a id="1645" class="Symbol">.</a><a id="1646" href="Class.Decidable.Core.html#273" class="Field">dec</a>
      <a id="1656" class="Keyword">with</a> <a id="1661" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="1663" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1665" class="Symbol">(</a><a id="1666" href="stdlib.Data.List.html#154" class="Function">Is-[]</a> <a id="1672" href="Ledger.Dijkstra.Specification.Transaction.html#4363" class="Function">txGovVotes</a><a id="1682" class="Symbol">)</a> <a id="1684" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="1686" class="Symbol">|</a> <a id="1688" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="1690" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1692" class="Symbol">(</a><a id="1693" href="stdlib.Data.List.html#154" class="Function">Is-[]</a> <a id="1699" href="Ledger.Dijkstra.Specification.Transaction.html#4407" class="Function">txGovProposals</a><a id="1713" class="Symbol">)</a> <a id="1715" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a>
         <a id="1726" class="Symbol">|</a> <a id="1728" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="1730" href="Data.Nat.Base.html#3266" class="Record">NonZero</a> <a id="1738" href="Ledger.Dijkstra.Specification.Transaction.html#4322" class="Function">txDonation</a>   <a id="1751" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="1753" class="Symbol">|</a> <a id="1755" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="1757" href="Data.Maybe.html#845" class="Function">Is-just</a> <a id="1765" href="Ledger.Dijkstra.Specification.Transaction.html#4500" class="Function">currentTreasury</a>  <a id="1782" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a>
    <a id="1788" class="Symbol">...</a> <a id="1792" class="Symbol">|</a> <a id="1794" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1798" href="Ledger.Dijkstra.Specification.Utxow.html#1798" class="Bound">p</a> <a id="1800" class="Symbol">|</a> <a id="1802" class="Symbol">_</a> <a id="1804" class="Symbol">|</a> <a id="1806" class="Symbol">_</a> <a id="1808" class="Symbol">|</a> <a id="1810" class="Symbol">_</a> <a id="1812" class="Symbol">=</a> <a id="1814" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1818" class="Symbol">(</a><a id="1819" href="Ledger.Dijkstra.Specification.Utxow.html#1079" class="InductiveConstructor">hasVotes</a> <a id="1828" href="Ledger.Dijkstra.Specification.Utxow.html#1798" class="Bound">p</a><a id="1829" class="Symbol">)</a>
    <a id="1835" class="CatchallClause Symbol">...</a><a id="1838" class="CatchallClause"> </a><a id="1839" class="CatchallClause Symbol">|</a><a id="1840" class="CatchallClause"> </a><a id="1841" class="CatchallClause Symbol">_</a><a id="1842" class="CatchallClause"> </a><a id="1843" class="CatchallClause Symbol">|</a><a id="1844" class="CatchallClause"> </a><a id="1845" href="Relation.Nullary.Decidable.Core.html#2099" class="CatchallClause InductiveConstructor">yes</a><a id="1848" class="CatchallClause"> </a><a id="1849" href="Ledger.Dijkstra.Specification.Utxow.html#1849" class="CatchallClause Bound">p</a><a id="1850" class="CatchallClause"> </a><a id="1851" class="CatchallClause Symbol">|</a><a id="1852" class="CatchallClause"> </a><a id="1853" class="CatchallClause Symbol">_</a><a id="1854" class="CatchallClause"> </a><a id="1855" class="CatchallClause Symbol">|</a><a id="1856" class="CatchallClause"> </a><a id="1857" class="CatchallClause Symbol">_</a> <a id="1859" class="Symbol">=</a> <a id="1861" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1865" class="Symbol">(</a><a id="1866" href="Ledger.Dijkstra.Specification.Utxow.html#1140" class="InductiveConstructor">hasProposals</a> <a id="1879" href="Ledger.Dijkstra.Specification.Utxow.html#1849" class="Bound">p</a><a id="1880" class="Symbol">)</a>
    <a id="1886" class="CatchallClause Symbol">...</a><a id="1889" class="CatchallClause"> </a><a id="1890" class="CatchallClause Symbol">|</a><a id="1891" class="CatchallClause"> </a><a id="1892" class="CatchallClause Symbol">_</a><a id="1893" class="CatchallClause"> </a><a id="1894" class="CatchallClause Symbol">|</a><a id="1895" class="CatchallClause"> </a><a id="1896" class="CatchallClause Symbol">_</a><a id="1897" class="CatchallClause"> </a><a id="1898" class="CatchallClause Symbol">|</a><a id="1899" class="CatchallClause"> </a><a id="1900" href="Relation.Nullary.Decidable.Core.html#2099" class="CatchallClause InductiveConstructor">yes</a><a id="1903" class="CatchallClause"> </a><a id="1904" href="Ledger.Dijkstra.Specification.Utxow.html#1904" class="CatchallClause Bound">p</a><a id="1905" class="CatchallClause"> </a><a id="1906" class="CatchallClause Symbol">|</a><a id="1907" class="CatchallClause"> </a><a id="1908" class="CatchallClause Symbol">_</a> <a id="1910" class="Symbol">=</a> <a id="1912" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1916" class="Symbol">(</a><a id="1917" href="Ledger.Dijkstra.Specification.Utxow.html#1201" class="InductiveConstructor">hasDonation</a> <a id="1929" href="Ledger.Dijkstra.Specification.Utxow.html#1904" class="Bound">p</a><a id="1930" class="Symbol">)</a>
    <a id="1936" class="CatchallClause Symbol">...</a><a id="1939" class="CatchallClause"> </a><a id="1940" class="CatchallClause Symbol">|</a><a id="1941" class="CatchallClause"> </a><a id="1942" class="CatchallClause Symbol">_</a><a id="1943" class="CatchallClause"> </a><a id="1944" class="CatchallClause Symbol">|</a><a id="1945" class="CatchallClause"> </a><a id="1946" class="CatchallClause Symbol">_</a><a id="1947" class="CatchallClause"> </a><a id="1948" class="CatchallClause Symbol">|</a><a id="1949" class="CatchallClause"> </a><a id="1950" class="CatchallClause Symbol">_</a><a id="1951" class="CatchallClause"> </a><a id="1952" class="CatchallClause Symbol">|</a><a id="1953" class="CatchallClause"> </a><a id="1954" href="Relation.Nullary.Decidable.Core.html#2099" class="CatchallClause InductiveConstructor">yes</a><a id="1957" class="CatchallClause"> </a><a id="1958" href="Ledger.Dijkstra.Specification.Utxow.html#1958" class="CatchallClause Bound">p</a> <a id="1960" class="Symbol">=</a> <a id="1962" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1966" class="Symbol">(</a><a id="1967" href="Ledger.Dijkstra.Specification.Utxow.html#1262" class="InductiveConstructor">hasTreasure</a> <a id="1979" href="Ledger.Dijkstra.Specification.Utxow.html#1958" class="Bound">p</a><a id="1980" class="Symbol">)</a>
    <a id="1986" class="Symbol">...</a> <a id="1990" class="Symbol">|</a> <a id="1992" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1995" href="Ledger.Dijkstra.Specification.Utxow.html#1995" class="Bound">p₁</a> <a id="1998" class="Symbol">|</a> <a id="2000" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2003" href="Ledger.Dijkstra.Specification.Utxow.html#2003" class="Bound">p₂</a> <a id="2006" class="Symbol">|</a> <a id="2008" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2011" href="Ledger.Dijkstra.Specification.Utxow.html#2011" class="Bound">p₃</a> <a id="2014" class="Symbol">|</a> <a id="2016" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2019" href="Ledger.Dijkstra.Specification.Utxow.html#2019" class="Bound">p₄</a>
      <a id="2028" class="Symbol">=</a> <a id="2030" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2033" class="Symbol">λ</a> <a id="2035" class="Symbol">{</a> <a id="2037" class="Symbol">(</a><a id="2038" href="Ledger.Dijkstra.Specification.Utxow.html#1079" class="InductiveConstructor">hasVotes</a> <a id="2047" href="Ledger.Dijkstra.Specification.Utxow.html#2047" class="Bound">x</a><a id="2048" class="Symbol">)</a> <a id="2050" class="Symbol">→</a> <a id="2052" href="Ledger.Dijkstra.Specification.Utxow.html#1995" class="Bound">p₁</a> <a id="2055" href="Ledger.Dijkstra.Specification.Utxow.html#2047" class="Bound">x</a> <a id="2057" class="Symbol">;</a> <a id="2059" class="Symbol">(</a><a id="2060" href="Ledger.Dijkstra.Specification.Utxow.html#1140" class="InductiveConstructor">hasProposals</a> <a id="2073" href="Ledger.Dijkstra.Specification.Utxow.html#2073" class="Bound">x</a><a id="2074" class="Symbol">)</a> <a id="2076" class="Symbol">→</a> <a id="2078" href="Ledger.Dijkstra.Specification.Utxow.html#2003" class="Bound">p₂</a> <a id="2081" href="Ledger.Dijkstra.Specification.Utxow.html#2073" class="Bound">x</a> <a id="2083" class="Symbol">;</a> <a id="2085" class="Symbol">(</a><a id="2086" href="Ledger.Dijkstra.Specification.Utxow.html#1201" class="InductiveConstructor">hasDonation</a> <a id="2098" href="Ledger.Dijkstra.Specification.Utxow.html#2098" class="Bound">x</a><a id="2099" class="Symbol">)</a> <a id="2101" class="Symbol">→</a> <a id="2103" href="Ledger.Dijkstra.Specification.Utxow.html#2011" class="Bound">p₃</a> <a id="2106" href="Ledger.Dijkstra.Specification.Utxow.html#2098" class="Bound">x</a> <a id="2108" class="Symbol">;</a> <a id="2110" class="Symbol">(</a><a id="2111" href="Ledger.Dijkstra.Specification.Utxow.html#1262" class="InductiveConstructor">hasTreasure</a> <a id="2123" href="Ledger.Dijkstra.Specification.Utxow.html#2123" class="Bound">x</a><a id="2124" class="Symbol">)</a> <a id="2126" class="Symbol">→</a> <a id="2128" href="Ledger.Dijkstra.Specification.Utxow.html#2019" class="Bound">p₄</a> <a id="2131" href="Ledger.Dijkstra.Specification.Utxow.html#2123" class="Bound">x</a><a id="2132" class="Symbol">}</a>

<a id="2135" class="Keyword">module</a> <a id="2142" href="Ledger.Dijkstra.Specification.Utxow.html#2142" class="Module">_</a> <a id="2144" class="Symbol">{</a><a id="2145" href="Ledger.Dijkstra.Specification.Utxow.html#2145" class="Bound">tx</a> <a id="2148" class="Symbol">:</a> <a id="2150" href="Ledger.Dijkstra.Specification.Transaction.html#5320" class="Function">TopLevelTx</a><a id="2160" class="Symbol">}</a> <a id="2162" class="Keyword">where</a>
  <a id="2170" class="Keyword">open</a> <a id="2175" href="Ledger.Dijkstra.Specification.Transaction.html#3522" class="Module">Tx</a> <a id="2178" href="Ledger.Dijkstra.Specification.Utxow.html#2145" class="Bound">tx</a>
  <a id="2183" class="Keyword">open</a> <a id="2188" href="Ledger.Dijkstra.Specification.Transaction.html#3794" class="Module">TxBody</a> <a id="2195" href="Ledger.Dijkstra.Specification.Transaction.html#3594" class="Field">txBody</a>

  <a id="2205" class="Keyword">instance</a>
    <a id="2218" href="Ledger.Dijkstra.Specification.Utxow.html#2218" class="Function">Dec-UsesV4Features</a> <a id="2237" class="Symbol">:</a> <a id="2239" href="Ledger.Dijkstra.Specification.Utxow.html#1327" class="Datatype">UsesV4Features</a> <a id="2254" href="Ledger.Dijkstra.Specification.Utxow.html#2145" class="Bound">tx</a> <a id="2257" href="Class.Decidable.Core.html#217" class="Record Operator">⁇</a>
    <a id="2263" href="Ledger.Dijkstra.Specification.Utxow.html#2218" class="Function">Dec-UsesV4Features</a> <a id="2282" class="Symbol">.</a><a id="2283" href="Class.Decidable.Core.html#273" class="Field">dec</a>
      <a id="2293" class="Keyword">with</a> <a id="2298" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="2300" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="2302" class="Symbol">(</a><a id="2303" href="stdlib.Data.List.html#154" class="Function">Is-[]</a> <a id="2309" href="Ledger.Dijkstra.Specification.Transaction.html#4658" class="Function">txSubTransactions</a><a id="2326" class="Symbol">)</a> <a id="2328" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="2330" class="Symbol">|</a> <a id="2332" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a> <a id="2334" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="2336" class="Symbol">(</a><a id="2337" href="Ledger.Prelude.html#2820" class="Function">Is-∅</a> <a id="2342" href="Ledger.Dijkstra.Specification.Transaction.html#4736" class="Function">txGuards</a><a id="2350" class="Symbol">)</a> <a id="2352" href="Class.Decidable.Core.html#470" class="Function Operator">¿</a>
    <a id="2358" class="Symbol">...</a> <a id="2362" class="Symbol">|</a> <a id="2364" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2368" href="Ledger.Dijkstra.Specification.Utxow.html#2368" class="Bound">p</a> <a id="2370" class="Symbol">|</a> <a id="2372" class="Symbol">_</a> <a id="2374" class="Symbol">=</a> <a id="2376" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2380" class="Symbol">(</a><a id="2381" href="Ledger.Dijkstra.Specification.Utxow.html#1358" class="InductiveConstructor">hasSubtransactions</a> <a id="2400" href="Ledger.Dijkstra.Specification.Utxow.html#2368" class="Bound">p</a><a id="2401" class="Symbol">)</a>
    <a id="2407" class="CatchallClause Symbol">...</a><a id="2410" class="CatchallClause"> </a><a id="2411" class="CatchallClause Symbol">|</a><a id="2412" class="CatchallClause"> </a><a id="2413" class="CatchallClause Symbol">_</a><a id="2414" class="CatchallClause"> </a><a id="2415" class="CatchallClause Symbol">|</a><a id="2416" class="CatchallClause"> </a><a id="2417" href="Relation.Nullary.Decidable.Core.html#2099" class="CatchallClause InductiveConstructor">yes</a><a id="2420" class="CatchallClause"> </a><a id="2421" href="Ledger.Dijkstra.Specification.Utxow.html#2421" class="CatchallClause Bound">p</a> <a id="2423" class="Symbol">=</a> <a id="2425" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="2429" class="Symbol">(</a><a id="2430" href="Ledger.Dijkstra.Specification.Utxow.html#1429" class="InductiveConstructor">hasGuards</a> <a id="2440" href="Ledger.Dijkstra.Specification.Utxow.html#2421" class="Bound">p</a><a id="2441" class="Symbol">)</a>
    <a id="2447" class="Symbol">...</a> <a id="2451" class="Symbol">|</a> <a id="2453" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2456" href="Ledger.Dijkstra.Specification.Utxow.html#2456" class="Bound">p₁</a> <a id="2459" class="Symbol">|</a> <a id="2461" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2464" href="Ledger.Dijkstra.Specification.Utxow.html#2464" class="Bound">p₂</a>
      <a id="2473" class="Symbol">=</a> <a id="2475" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2478" class="Symbol">λ</a> <a id="2480" class="Symbol">{</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Ledger.Dijkstra.Specification.Utxow.html#1358" class="InductiveConstructor">hasSubtransactions</a> <a id="2502" href="Ledger.Dijkstra.Specification.Utxow.html#2502" class="Bound">x</a><a id="2503" class="Symbol">)</a> <a id="2505" class="Symbol">→</a> <a id="2507" href="Ledger.Dijkstra.Specification.Utxow.html#2456" class="Bound">p₁</a> <a id="2510" href="Ledger.Dijkstra.Specification.Utxow.html#2502" class="Bound">x</a> <a id="2512" class="Symbol">;</a> <a id="2514" class="Symbol">(</a><a id="2515" href="Ledger.Dijkstra.Specification.Utxow.html#1429" class="InductiveConstructor">hasGuards</a> <a id="2525" href="Ledger.Dijkstra.Specification.Utxow.html#2525" class="Bound">x</a><a id="2526" class="Symbol">)</a> <a id="2528" class="Symbol">→</a> <a id="2530" href="Ledger.Dijkstra.Specification.Utxow.html#2464" class="Bound">p₂</a> <a id="2533" href="Ledger.Dijkstra.Specification.Utxow.html#2525" class="Bound">x</a><a id="2534" class="Symbol">}</a>


<a id="languages"></a><a id="2538" href="Ledger.Dijkstra.Specification.Utxow.html#2538" class="Function">languages</a> <a id="2548" class="Symbol">:</a>  <a id="2551" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2553" href="Ledger.Dijkstra.Specification.Script.Base.html#2432" class="Function">P2Script</a> <a id="2562" class="Symbol">→</a> <a id="2564" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2566" href="Ledger.Dijkstra.Specification.Script.Base.html#972" class="Function">Language</a>
<a id="2575" href="Ledger.Dijkstra.Specification.Utxow.html#2538" class="Function">languages</a> <a id="2585" href="Ledger.Dijkstra.Specification.Utxow.html#2585" class="Bound">p2Scripts</a> <a id="2595" class="Symbol">=</a> <a id="2597" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2602" href="Ledger.Dijkstra.Specification.Script.Base.html#2029" class="Function">language</a> <a id="2611" href="Ledger.Dijkstra.Specification.Utxow.html#2585" class="Bound">p2Scripts</a>

<a id="allowedLanguagesLegacyMode"></a><a id="2622" href="Ledger.Dijkstra.Specification.Utxow.html#2622" class="Function">allowedLanguagesLegacyMode</a> <a id="2649" class="Symbol">:</a> <a id="2651" href="Ledger.Dijkstra.Specification.Transaction.html#5320" class="Function">TopLevelTx</a> <a id="2662" class="Symbol">→</a> <a id="2664" href="Ledger.Dijkstra.Specification.Transaction.html#3158" class="Function">UTxO</a> <a id="2669" class="Symbol">→</a> <a id="2671" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2673" href="Ledger.Dijkstra.Specification.Script.Base.html#972" class="Function">Language</a>
<a id="2682" href="Ledger.Dijkstra.Specification.Utxow.html#2622" class="Function">allowedLanguagesLegacyMode</a> <a id="2709" href="Ledger.Dijkstra.Specification.Utxow.html#2709" class="Bound">tx</a> <a id="2712" href="Ledger.Dijkstra.Specification.Utxow.html#2712" class="Bound">utxo</a> <a id="2717" class="Symbol">=</a>
  <a id="2721" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2724" href="Ledger.Dijkstra.Specification.Utxow.html#669" class="Function">UsesBootstrapAddress</a> <a id="2745" href="Ledger.Dijkstra.Specification.Utxow.html#2709" class="Bound">tx</a> <a id="2748" href="Ledger.Dijkstra.Specification.Utxow.html#2712" class="Bound">utxo</a>
    <a id="2757" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2762" href="Class.HasEmptySet.html#287" class="Field">∅</a>
    <a id="2768" href="Class.ToBool.html#342" class="Function Operator">else</a>
  <a id="2775" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2778" href="Ledger.Dijkstra.Specification.Utxow.html#1327" class="Datatype">UsesV4Features</a> <a id="2793" href="Ledger.Dijkstra.Specification.Utxow.html#2709" class="Bound">tx</a>
    <a id="2800" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2805" href="Class.HasEmptySet.html#287" class="Field">∅</a>
    <a id="2811" href="Class.ToBool.html#342" class="Function Operator">else</a>
  <a id="2818" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2821" href="Ledger.Dijkstra.Specification.Utxow.html#1048" class="Datatype">UsesV3Features</a> <a id="2836" href="Ledger.Dijkstra.Specification.Utxow.html#2709" class="Bound">tx</a>
    <a id="2843" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2848" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2857" class="Symbol">(</a><a id="2858" href="Ledger.Dijkstra.Specification.Script.Base.html#1073" class="Function">PlutusV4</a> <a id="2867" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2869" href="Ledger.Dijkstra.Specification.Script.Base.html#1064" class="Function">PlutusV3</a> <a id="2878" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2880" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2882" class="Symbol">)</a>
    <a id="2888" href="Class.ToBool.html#342" class="Function Operator">else</a>
  <a id="2895" href="Class.ToBool.html#342" class="Function Operator">if</a> <a id="2898" href="Ledger.Dijkstra.Specification.Utxow.html#913" class="Function">UsesV2Features</a> <a id="2913" href="Ledger.Dijkstra.Specification.Utxow.html#2709" class="Bound">tx</a> <a id="2916" href="Ledger.Dijkstra.Specification.Utxow.html#2712" class="Bound">utxo</a>
    <a id="2925" href="Class.ToBool.html#342" class="Function Operator">then</a> <a id="2930" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2939" class="Symbol">(</a><a id="2940" href="Ledger.Dijkstra.Specification.Script.Base.html#1073" class="Function">PlutusV4</a> <a id="2949" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2951" href="Ledger.Dijkstra.Specification.Script.Base.html#1064" class="Function">PlutusV3</a> <a id="2960" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2962" href="Ledger.Dijkstra.Specification.Script.Base.html#1055" class="Function">PlutusV2</a> <a id="2971" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2973" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2975" class="Symbol">)</a>
    <a id="2981" href="Class.ToBool.html#342" class="Function Operator">else</a> <a id="2986" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="2995" class="Symbol">(</a><a id="2996" href="Ledger.Dijkstra.Specification.Script.Base.html#1073" class="Function">PlutusV4</a> <a id="3005" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3007" href="Ledger.Dijkstra.Specification.Script.Base.html#1064" class="Function">PlutusV3</a> <a id="3016" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3018" href="Ledger.Dijkstra.Specification.Script.Base.html#1055" class="Function">PlutusV2</a> <a id="3027" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3029" href="Ledger.Dijkstra.Specification.Script.Base.html#1046" class="Function">PlutusV1</a> <a id="3038" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3040" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3042" class="Symbol">)</a>


<a id="3046" class="Keyword">data</a> <a id="_⊢_⇀⦇_,SUBUTXOW⦈_"></a><a id="3051" href="Ledger.Dijkstra.Specification.Utxow.html#3051" class="Datatype Operator">_⊢_⇀⦇_,SUBUTXOW⦈_</a> <a id="3069" class="Symbol">:</a> <a id="3071" href="Ledger.Dijkstra.Specification.Utxo.html#1323" class="Record">SubUTxOEnv</a> <a id="3082" class="Symbol">→</a> <a id="3084" href="Ledger.Dijkstra.Specification.Utxo.html#1583" class="Record">UTxOState</a> <a id="3094" class="Symbol">→</a> <a id="3096" href="Ledger.Dijkstra.Specification.Transaction.html#5370" class="Function">SubLevelTx</a> <a id="3107" class="Symbol">→</a> <a id="3109" href="Ledger.Dijkstra.Specification.Utxo.html#1583" class="Record">UTxOState</a> <a id="3119" class="Symbol">→</a> <a id="3121" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3126" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,SUBUTXOW⦈_.SUBUTXOW"></a><a id="3135" href="Ledger.Dijkstra.Specification.Utxow.html#3135" class="InductiveConstructor">SUBUTXOW</a> <a id="3144" class="Symbol">:</a>
    <a id="3150" class="Keyword">let</a>
         <a id="3163" class="Keyword">open</a> <a id="3168" href="Ledger.Dijkstra.Specification.Transaction.html#3522" class="Module">Tx</a> <a id="3171" href="Ledger.Dijkstra.Specification.Utxow.html#545" class="Generalizable">txSub</a>
         <a id="3186" class="Keyword">open</a> <a id="3191" href="Ledger.Dijkstra.Specification.Transaction.html#3794" class="Module">TxBody</a> <a id="3198" href="Ledger.Dijkstra.Specification.Transaction.html#3594" class="Function">txBody</a>
         <a id="3214" class="Keyword">open</a> <a id="3219" href="Ledger.Dijkstra.Specification.Transaction.html#5008" class="Module">TxWitnesses</a> <a id="3231" href="Ledger.Dijkstra.Specification.Transaction.html#3632" class="Function">txWitnesses</a>
         <a id="3252" class="Keyword">open</a> <a id="3257" href="Ledger.Dijkstra.Specification.Utxo.html#1050" class="Module">UTxOEnv</a>

         <a id="3275" href="Ledger.Dijkstra.Specification.Utxow.html#3275" class="Bound">utxo₀</a>               <a id="3295" class="Symbol">=</a> <a id="3297" href="Ledger.Dijkstra.Specification.Transaction.html#3454" class="Field">UTxOOf</a> <a id="3304" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a>
         <a id="3315" href="Ledger.Dijkstra.Specification.Utxow.html#3315" class="Bound">utxo</a>                <a id="3335" class="Symbol">=</a> <a id="3337" href="Ledger.Dijkstra.Specification.Transaction.html#3454" class="Field">UTxOOf</a> <a id="3344" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a>

         <a id="3356" href="Ledger.Dijkstra.Specification.Utxow.html#3356" class="Bound">witsKeyHashes</a>       <a id="3376" class="Symbol">:</a> <a id="3378" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3380" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
         <a id="3397" href="Ledger.Dijkstra.Specification.Utxow.html#3356" class="Bound">witsKeyHashes</a>       <a id="3417" class="Symbol">=</a> <a id="3419" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3424" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="3429" class="Symbol">(</a><a id="3430" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3434" href="Ledger.Dijkstra.Specification.Transaction.html#5089" class="Function">vKeySigs</a><a id="3442" class="Symbol">)</a>

         <a id="3454" href="Ledger.Dijkstra.Specification.Utxow.html#3454" class="Bound">p1Scripts</a> <a id="3464" class="Symbol">:</a> <a id="3466" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3468" href="Ledger.Dijkstra.Specification.Script.Base.html#647" class="Function">P1Script</a>
         <a id="3486" href="Ledger.Dijkstra.Specification.Utxow.html#3454" class="Bound">p1Scripts</a> <a id="3496" class="Symbol">=</a> <a id="3498" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3509" href="Ledger.Dijkstra.Specification.Script.Base.html#3042" class="Function">toP1Script</a> <a id="3520" class="Symbol">(</a><a id="3521" href="Ledger.Dijkstra.Specification.Utxo.html#2169" class="Field">ScriptPoolOf</a> <a id="3534" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a><a id="3535" class="Symbol">)</a>

         <a id="3547" href="Ledger.Dijkstra.Specification.Utxow.html#3547" class="Bound">p2Scripts</a> <a id="3557" class="Symbol">:</a> <a id="3559" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3561" href="Ledger.Dijkstra.Specification.Script.Base.html#2432" class="Function">P2Script</a>
         <a id="3579" href="Ledger.Dijkstra.Specification.Utxow.html#3547" class="Bound">p2Scripts</a> <a id="3589" class="Symbol">=</a> <a id="3591" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3602" href="Ledger.Dijkstra.Specification.Script.Base.html#3285" class="Function">toP2Script</a> <a id="3613" class="Symbol">(</a><a id="3614" href="Ledger.Dijkstra.Specification.Utxo.html#2169" class="Field">ScriptPoolOf</a> <a id="3627" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a><a id="3628" class="Symbol">)</a>

         <a id="3640" href="Ledger.Dijkstra.Specification.Utxow.html#3640" class="Bound">neededScriptHashes</a>  <a id="3660" class="Symbol">:</a> <a id="3662" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3664" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
         <a id="3684" href="Ledger.Dijkstra.Specification.Utxow.html#3640" class="Bound">neededScriptHashes</a>  <a id="3704" class="Symbol">=</a> <a id="3706" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3717" class="Symbol">(</a><a id="3718" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a>  <a id="3731" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3733" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3738" class="Symbol">)</a> <a id="3740" class="Symbol">(</a><a id="3741" href="Ledger.Dijkstra.Specification.Script.Validation.html#4832" class="Function">credsNeeded</a> <a id="3753" href="Ledger.Dijkstra.Specification.Utxow.html#3275" class="Bound">utxo₀</a> <a id="3759" href="Ledger.Dijkstra.Specification.Utxow.html#545" class="Generalizable">txSub</a><a id="3764" class="Symbol">)</a>

         <a id="3776" href="Ledger.Dijkstra.Specification.Utxow.html#3776" class="Bound">neededVKeyHashes</a> <a id="3793" class="Symbol">:</a> <a id="3795" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3797" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
         <a id="3814" href="Ledger.Dijkstra.Specification.Utxow.html#3776" class="Bound">neededVKeyHashes</a> <a id="3831" class="Symbol">=</a> <a id="3833" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3844" class="Symbol">(</a><a id="3845" href="Ledger.Core.Specification.Address.html#484" class="Function">isKeyHashObj</a> <a id="3858" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="3860" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="3865" class="Symbol">)</a> <a id="3867" class="Symbol">(</a><a id="3868" href="Ledger.Dijkstra.Specification.Script.Validation.html#4832" class="Function">credsNeeded</a> <a id="3880" href="Ledger.Dijkstra.Specification.Utxow.html#3275" class="Bound">utxo₀</a> <a id="3886" href="Ledger.Dijkstra.Specification.Utxow.html#545" class="Generalizable">txSub</a><a id="3891" class="Symbol">)</a>

         <a id="3903" href="Ledger.Dijkstra.Specification.Utxow.html#3903" class="Bound">neededDataHashes</a> <a id="3920" class="Symbol">:</a> <a id="3922" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="3924" href="Ledger.Dijkstra.Specification.Script.Base.html#1788" class="Function">DataHash</a>
         <a id="3942" href="Ledger.Dijkstra.Specification.Utxow.html#3903" class="Bound">neededDataHashes</a> <a id="3959" class="Symbol">=</a> <a id="3961" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="3972" class="Symbol">(λ</a> <a id="3975" href="Ledger.Dijkstra.Specification.Utxow.html#3975" class="Bound">txOut</a><a id="3980" class="Symbol">@(</a><a id="3982" href="Ledger.Dijkstra.Specification.Utxow.html#3982" class="Bound">a</a> <a id="3984" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3986" class="Symbol">_</a> <a id="3988" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3990" href="Ledger.Dijkstra.Specification.Utxow.html#3990" class="Bound">d</a> <a id="3992" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3994" class="Symbol">_)</a> <a id="3997" class="Symbol">→</a> <a id="3999" class="Keyword">do</a> <a id="4002" href="Ledger.Dijkstra.Specification.Utxow.html#4002" class="Bound">sh</a> <a id="4005" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4007" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="4019" class="Symbol">(</a><a id="4020" href="Ledger.Core.Specification.Address.html#3056" class="Function">payCred</a> <a id="4028" href="Ledger.Dijkstra.Specification.Utxow.html#3982" class="Bound">a</a><a id="4029" class="Symbol">)</a>
                                                                     <a id="4100" class="Symbol">_</a>  <a id="4103" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="4105" href="Ledger.Prelude.html#2610" class="Function">lookupHash</a> <a id="4116" href="Ledger.Dijkstra.Specification.Utxow.html#4002" class="Bound">sh</a> <a id="4119" href="Ledger.Dijkstra.Specification.Utxow.html#3547" class="Bound">p2Scripts</a>
                                                                     <a id="4198" href="Ledger.Dijkstra.Specification.Utxow.html#3990" class="Bound">d</a> <a id="4200" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="4204" href="Data.Sum.html#870" class="Function">isInj₂</a><a id="4210" class="Symbol">)</a>
                                       <a id="4251" class="Symbol">(</a><a id="4252" href="Class.IsSet.html#959" class="Function">range</a> <a id="4258" class="Symbol">(</a><a id="4259" href="Ledger.Dijkstra.Specification.Utxow.html#3275" class="Bound">utxo₀</a> <a id="4265" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="4267" href="Ledger.Dijkstra.Specification.Transaction.html#3870" class="Function">txIns</a><a id="4272" class="Symbol">))</a>

    <a id="4280" class="Keyword">in</a>
    <a id="4287" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a>  <a id="4290" href="Class.IsSet.html#576" class="Function">∀[</a> <a id="4293" href="Ledger.Dijkstra.Specification.Utxow.html#4293" class="Bound">(</a><a id="4294" href="Ledger.Dijkstra.Specification.Utxow.html#4294" class="Bound">vk</a> <a id="4297" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4299" href="Ledger.Dijkstra.Specification.Utxow.html#4299" class="Bound">σ</a><a id="4300" href="Ledger.Dijkstra.Specification.Utxow.html#4293" class="Bound">)</a> <a id="4302" href="Class.IsSet.html#576" class="Function">∈</a> <a id="4304" href="Ledger.Dijkstra.Specification.Transaction.html#5089" class="Function">vKeySigs</a> <a id="4313" href="Class.IsSet.html#576" class="Function">]</a> <a id="4315" href="Ledger.Core.Specification.Crypto.html#719" class="Function">isSigned</a> <a id="4324" href="Ledger.Dijkstra.Specification.Utxow.html#4294" class="Bound">vk</a> <a id="4327" class="Symbol">(</a><a id="4328" href="Ledger.Dijkstra.Specification.Transaction.html#2389" class="Field">txidBytes</a> <a id="4338" href="Ledger.Dijkstra.Specification.Transaction.html#4047" class="Function">txId</a><a id="4342" class="Symbol">)</a> <a id="4344" href="Ledger.Dijkstra.Specification.Utxow.html#4299" class="Bound">σ</a>
    <a id="4350" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="4353" href="Class.IsSet.html#576" class="Function">∀[</a> <a id="4356" href="Ledger.Dijkstra.Specification.Utxow.html#4356" class="Bound">s</a> <a id="4358" href="Class.IsSet.html#576" class="Function">∈</a> <a id="4360" href="Ledger.Dijkstra.Specification.Utxow.html#3454" class="Bound">p1Scripts</a> <a id="4370" href="Class.IsSet.html#576" class="Function">]</a> <a id="4372" class="Symbol">(</a><a id="4373" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="4378" href="Ledger.Dijkstra.Specification.Utxow.html#4356" class="Bound">s</a> <a id="4380" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="4382" href="Ledger.Dijkstra.Specification.Utxow.html#3640" class="Bound">neededScriptHashes</a> <a id="4401" class="Symbol">→</a> <a id="4403" href="Ledger.Dijkstra.Specification.Script.Base.html#671" class="Function">validP1Script</a> <a id="4417" href="Ledger.Dijkstra.Specification.Utxow.html#3356" class="Bound">witsKeyHashes</a> <a id="4431" href="Ledger.Dijkstra.Specification.Transaction.html#4223" class="Function">txVldt</a> <a id="4438" href="Ledger.Dijkstra.Specification.Utxow.html#4356" class="Bound">s</a><a id="4439" class="Symbol">)</a>
    <a id="4445" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="4448" href="Ledger.Dijkstra.Specification.Utxow.html#3776" class="Bound">neededVKeyHashes</a> <a id="4465" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="4467" href="Ledger.Dijkstra.Specification.Utxow.html#3356" class="Bound">witsKeyHashes</a>
    <a id="4485" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="4488" href="Class.IsSet.html#576" class="Function">∀[</a> <a id="4491" href="Ledger.Dijkstra.Specification.Utxow.html#4491" class="Bound">s</a> <a id="4493" href="Class.IsSet.html#576" class="Function">∈</a> <a id="4495" href="Ledger.Dijkstra.Specification.Utxow.html#3547" class="Bound">p2Scripts</a> <a id="4505" href="Class.IsSet.html#576" class="Function">]</a> <a id="4507" class="Symbol">(</a><a id="4508" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="4513" href="Ledger.Dijkstra.Specification.Utxow.html#4491" class="Bound">s</a> <a id="4515" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="4517" href="Ledger.Dijkstra.Specification.Utxow.html#3640" class="Bound">neededScriptHashes</a> <a id="4536" class="Symbol">→</a> <a id="4538" href="Ledger.Dijkstra.Specification.Script.Base.html#2029" class="Function">language</a> <a id="4547" href="Ledger.Dijkstra.Specification.Utxow.html#4491" class="Bound">s</a> <a id="4549" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4551" href="Ledger.Dijkstra.Specification.Script.Base.html#1073" class="Function">PlutusV4</a><a id="4559" class="Symbol">)</a>
    <a id="4565" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="4568" href="Ledger.Dijkstra.Specification.Utxow.html#3640" class="Bound">neededScriptHashes</a> <a id="4587" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="4589" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4594" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="4599" href="Ledger.Dijkstra.Specification.Utxow.html#3454" class="Bound">p1Scripts</a> <a id="4609" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="4611" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4616" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="4621" href="Ledger.Dijkstra.Specification.Utxow.html#3547" class="Bound">p2Scripts</a>
    <a id="4635" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="4638" href="Ledger.Dijkstra.Specification.Utxow.html#3903" class="Bound">neededDataHashes</a> <a id="4655" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="4657" href="Class.IsSet.html#916" class="Function">dom</a> <a id="4661" class="Symbol">(</a><a id="4662" href="Ledger.Dijkstra.Specification.Utxo.html#2289" class="Field">DataPoolOf</a> <a id="4673" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a><a id="4674" class="Symbol">)</a>
    <a id="4680" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="4683" href="Ledger.Dijkstra.Specification.Transaction.html#4278" class="Function">txADhash</a> <a id="4692" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4694" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="4698" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="4703" href="Ledger.Dijkstra.Specification.Transaction.html#3747" class="Function">txAuxData</a>
    <a id="4717" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="4720" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a> <a id="4722" href="Ledger.Dijkstra.Specification.Utxo.html#9296" class="Datatype Operator">⊢</a> <a id="4724" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a> <a id="4726" href="Ledger.Dijkstra.Specification.Utxo.html#9296" class="Datatype Operator">⇀⦇</a> <a id="4729" href="Ledger.Dijkstra.Specification.Utxow.html#545" class="Generalizable">txSub</a> <a id="4735" href="Ledger.Dijkstra.Specification.Utxo.html#9296" class="Datatype Operator">,SUBUTXO⦈</a> <a id="4745" href="Ledger.Dijkstra.Specification.Utxow.html#506" class="Generalizable">s&#39;</a>
      <a id="4754" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
       <a id="4794" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a> <a id="4796" href="Ledger.Dijkstra.Specification.Utxow.html#3051" class="Datatype Operator">⊢</a> <a id="4798" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a> <a id="4800" href="Ledger.Dijkstra.Specification.Utxow.html#3051" class="Datatype Operator">⇀⦇</a> <a id="4803" href="Ledger.Dijkstra.Specification.Utxow.html#545" class="Generalizable">txSub</a> <a id="4809" href="Ledger.Dijkstra.Specification.Utxow.html#3051" class="Datatype Operator">,SUBUTXOW⦈</a> <a id="4820" href="Ledger.Dijkstra.Specification.Utxow.html#506" class="Generalizable">s&#39;</a>


<a id="4825" class="Keyword">data</a> <a id="_⊢_⇀⦇_,UTXOW⦈_"></a><a id="4830" href="Ledger.Dijkstra.Specification.Utxow.html#4830" class="Datatype Operator">_⊢_⇀⦇_,UTXOW⦈_</a> <a id="4845" class="Symbol">:</a> <a id="4847" href="Ledger.Dijkstra.Specification.Utxo.html#1050" class="Record">UTxOEnv</a> <a id="4855" class="Symbol">→</a> <a id="4857" href="Ledger.Dijkstra.Specification.Utxo.html#1583" class="Record">UTxOState</a> <a id="4867" class="Symbol">→</a> <a id="4869" href="Ledger.Dijkstra.Specification.Transaction.html#5320" class="Function">TopLevelTx</a> <a id="4880" class="Symbol">→</a> <a id="4882" href="Ledger.Dijkstra.Specification.Utxo.html#1583" class="Record">UTxOState</a> <a id="4892" class="Symbol">→</a> <a id="4894" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4899" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,UTXOW⦈_.UTXOW-normal"></a><a id="4908" href="Ledger.Dijkstra.Specification.Utxow.html#4908" class="InductiveConstructor">UTXOW-normal</a> <a id="4921" class="Symbol">:</a>
    <a id="4927" class="Keyword">let</a>
         <a id="4940" class="Keyword">open</a> <a id="4945" href="Ledger.Dijkstra.Specification.Transaction.html#3522" class="Module">Tx</a> <a id="4948" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a>
         <a id="4963" class="Keyword">open</a> <a id="4968" href="Ledger.Dijkstra.Specification.Transaction.html#3794" class="Module">TxBody</a> <a id="4975" href="Ledger.Dijkstra.Specification.Transaction.html#3594" class="Function">txBody</a>
         <a id="4991" class="Keyword">open</a> <a id="4996" href="Ledger.Dijkstra.Specification.Transaction.html#5008" class="Module">TxWitnesses</a> <a id="5008" href="Ledger.Dijkstra.Specification.Transaction.html#3632" class="Function">txWitnesses</a>
         <a id="5029" class="Keyword">open</a> <a id="5034" href="Ledger.Dijkstra.Specification.Utxo.html#1050" class="Module">UTxOEnv</a>

         <a id="5052" href="Ledger.Dijkstra.Specification.Utxow.html#5052" class="Bound">utxo₀</a> <a id="5058" class="Symbol">=</a> <a id="5060" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a> <a id="5062" class="Symbol">.</a><a id="5063" href="Ledger.Dijkstra.Specification.Utxo.html#1177" class="Field">utxo₀</a>
         <a id="5078" href="Ledger.Dijkstra.Specification.Utxow.html#5078" class="Bound">utxo</a>  <a id="5084" class="Symbol">=</a> <a id="5086" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a> <a id="5088" class="Symbol">.</a><a id="5089" href="Ledger.Dijkstra.Specification.Utxo.html#1643" class="Field">UTxOState.utxo</a>

         <a id="5114" href="Ledger.Dijkstra.Specification.Utxow.html#5114" class="Bound">witsKeyHashes</a> <a id="5128" class="Symbol">:</a> <a id="5130" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="5132" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
         <a id="5149" href="Ledger.Dijkstra.Specification.Utxow.html#5114" class="Bound">witsKeyHashes</a> <a id="5163" class="Symbol">=</a> <a id="5165" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5170" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="5175" class="Symbol">(</a><a id="5176" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5180" href="Ledger.Dijkstra.Specification.Transaction.html#5089" class="Function">vKeySigs</a><a id="5188" class="Symbol">)</a>

         <a id="5200" href="Ledger.Dijkstra.Specification.Utxow.html#5200" class="Bound">p1Scripts</a> <a id="5210" class="Symbol">:</a> <a id="5212" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="5214" href="Ledger.Dijkstra.Specification.Script.Base.html#647" class="Function">P1Script</a>
         <a id="5232" href="Ledger.Dijkstra.Specification.Utxow.html#5200" class="Bound">p1Scripts</a> <a id="5242" class="Symbol">=</a> <a id="5244" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="5255" href="Ledger.Dijkstra.Specification.Script.Base.html#3042" class="Function">toP1Script</a> <a id="5266" class="Symbol">(</a><a id="5267" href="Ledger.Dijkstra.Specification.Utxo.html#2169" class="Field">ScriptPoolOf</a> <a id="5280" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a><a id="5281" class="Symbol">)</a>

         <a id="5293" href="Ledger.Dijkstra.Specification.Utxow.html#5293" class="Bound">p2Scripts</a> <a id="5303" class="Symbol">:</a> <a id="5305" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="5307" href="Ledger.Dijkstra.Specification.Script.Base.html#2432" class="Function">P2Script</a>
         <a id="5325" href="Ledger.Dijkstra.Specification.Utxow.html#5293" class="Bound">p2Scripts</a> <a id="5335" class="Symbol">=</a> <a id="5337" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="5348" href="Ledger.Dijkstra.Specification.Script.Base.html#3285" class="Function">toP2Script</a> <a id="5359" class="Symbol">(</a><a id="5360" href="Ledger.Dijkstra.Specification.Utxo.html#2169" class="Field">ScriptPoolOf</a> <a id="5373" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a><a id="5374" class="Symbol">)</a>

         <a id="5386" href="Ledger.Dijkstra.Specification.Utxow.html#5386" class="Bound">neededScriptHashes</a> <a id="5405" class="Symbol">:</a> <a id="5407" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="5409" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
         <a id="5429" href="Ledger.Dijkstra.Specification.Utxow.html#5386" class="Bound">neededScriptHashes</a> <a id="5448" class="Symbol">=</a> <a id="5450" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="5461" class="Symbol">(</a><a id="5462" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a>  <a id="5475" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5477" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="5482" class="Symbol">)</a> <a id="5484" class="Symbol">(</a><a id="5485" href="Ledger.Dijkstra.Specification.Script.Validation.html#4832" class="Function">credsNeeded</a> <a id="5497" href="Ledger.Dijkstra.Specification.Utxow.html#5052" class="Bound">utxo₀</a> <a id="5503" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a><a id="5508" class="Symbol">)</a>

         <a id="5520" href="Ledger.Dijkstra.Specification.Utxow.html#5520" class="Bound">neededVKeyHashes</a> <a id="5537" class="Symbol">:</a> <a id="5539" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="5541" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
         <a id="5558" href="Ledger.Dijkstra.Specification.Utxow.html#5520" class="Bound">neededVKeyHashes</a> <a id="5575" class="Symbol">=</a> <a id="5577" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="5588" class="Symbol">(</a><a id="5589" href="Ledger.Core.Specification.Address.html#484" class="Function">isKeyHashObj</a> <a id="5602" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="5604" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="5609" class="Symbol">)</a> <a id="5611" class="Symbol">(</a><a id="5612" href="Ledger.Dijkstra.Specification.Script.Validation.html#4832" class="Function">credsNeeded</a> <a id="5624" href="Ledger.Dijkstra.Specification.Utxow.html#5052" class="Bound">utxo₀</a> <a id="5630" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a><a id="5635" class="Symbol">)</a>

         <a id="5647" href="Ledger.Dijkstra.Specification.Utxow.html#5647" class="Bound">neededDataHashes</a> <a id="5664" class="Symbol">:</a> <a id="5666" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="5668" href="Ledger.Dijkstra.Specification.Script.Base.html#1788" class="Function">DataHash</a>
         <a id="5686" href="Ledger.Dijkstra.Specification.Utxow.html#5647" class="Bound">neededDataHashes</a> <a id="5703" class="Symbol">=</a> <a id="5705" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="5716" class="Symbol">(λ</a> <a id="5719" href="Ledger.Dijkstra.Specification.Utxow.html#5719" class="Bound">txOut</a><a id="5724" class="Symbol">@(</a><a id="5726" href="Ledger.Dijkstra.Specification.Utxow.html#5726" class="Bound">a</a> <a id="5728" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5730" class="Symbol">_</a> <a id="5732" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5734" href="Ledger.Dijkstra.Specification.Utxow.html#5734" class="Bound">d</a> <a id="5736" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5738" class="Symbol">_)</a> <a id="5741" class="Symbol">→</a> <a id="5743" class="Keyword">do</a> <a id="5746" href="Ledger.Dijkstra.Specification.Utxow.html#5746" class="Bound">sh</a> <a id="5749" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="5751" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="5763" class="Symbol">(</a><a id="5764" href="Ledger.Core.Specification.Address.html#3056" class="Function">payCred</a> <a id="5772" href="Ledger.Dijkstra.Specification.Utxow.html#5726" class="Bound">a</a><a id="5773" class="Symbol">)</a>
                                                                     <a id="5844" class="Symbol">_</a>  <a id="5847" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="5849" href="Ledger.Prelude.html#2610" class="Function">lookupHash</a> <a id="5860" href="Ledger.Dijkstra.Specification.Utxow.html#5746" class="Bound">sh</a> <a id="5863" href="Ledger.Dijkstra.Specification.Utxow.html#5293" class="Bound">p2Scripts</a>
                                                                     <a id="5942" href="Ledger.Dijkstra.Specification.Utxow.html#5734" class="Bound">d</a> <a id="5944" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="5948" href="Data.Sum.html#870" class="Function">isInj₂</a><a id="5954" class="Symbol">)</a>
                                       <a id="5995" class="Symbol">(</a><a id="5996" href="Class.IsSet.html#959" class="Function">range</a> <a id="6002" class="Symbol">(</a><a id="6003" href="Ledger.Dijkstra.Specification.Utxow.html#5052" class="Bound">utxo₀</a> <a id="6009" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="6011" href="Ledger.Dijkstra.Specification.Transaction.html#3870" class="Function">txIns</a><a id="6016" class="Symbol">))</a>

    <a id="6024" class="Keyword">in</a>
    <a id="6031" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a>  <a id="6034" href="Class.IsSet.html#576" class="Function">∀[</a> <a id="6037" href="Ledger.Dijkstra.Specification.Utxow.html#6037" class="Bound">s</a> <a id="6039" href="Class.IsSet.html#576" class="Function">∈</a> <a id="6041" href="Ledger.Dijkstra.Specification.Utxow.html#5293" class="Bound">p2Scripts</a> <a id="6051" href="Class.IsSet.html#576" class="Function">]</a> <a id="6053" class="Symbol">(</a><a id="6054" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="6059" href="Ledger.Dijkstra.Specification.Utxow.html#6037" class="Bound">s</a> <a id="6061" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="6063" href="Ledger.Dijkstra.Specification.Utxow.html#5386" class="Bound">neededScriptHashes</a> <a id="6082" class="Symbol">→</a> <a id="6084" href="Ledger.Dijkstra.Specification.Script.Base.html#2029" class="Function">language</a> <a id="6093" href="Ledger.Dijkstra.Specification.Utxow.html#6037" class="Bound">s</a> <a id="6095" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6097" href="Ledger.Dijkstra.Specification.Script.Base.html#1073" class="Function">PlutusV4</a><a id="6105" class="Symbol">)</a>
    <a id="6111" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="6114" href="Class.IsSet.html#576" class="Function">∀[</a> <a id="6117" href="Ledger.Dijkstra.Specification.Utxow.html#6117" class="Bound">(</a><a id="6118" href="Ledger.Dijkstra.Specification.Utxow.html#6118" class="Bound">vk</a> <a id="6121" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6123" href="Ledger.Dijkstra.Specification.Utxow.html#6123" class="Bound">σ</a><a id="6124" href="Ledger.Dijkstra.Specification.Utxow.html#6117" class="Bound">)</a> <a id="6126" href="Class.IsSet.html#576" class="Function">∈</a> <a id="6128" href="Ledger.Dijkstra.Specification.Transaction.html#5089" class="Function">vKeySigs</a> <a id="6137" href="Class.IsSet.html#576" class="Function">]</a> <a id="6139" href="Ledger.Core.Specification.Crypto.html#719" class="Function">isSigned</a> <a id="6148" href="Ledger.Dijkstra.Specification.Utxow.html#6118" class="Bound">vk</a> <a id="6151" class="Symbol">(</a><a id="6152" href="Ledger.Dijkstra.Specification.Transaction.html#2389" class="Field">txidBytes</a> <a id="6162" href="Ledger.Dijkstra.Specification.Transaction.html#4047" class="Function">txId</a><a id="6166" class="Symbol">)</a> <a id="6168" href="Ledger.Dijkstra.Specification.Utxow.html#6123" class="Bound">σ</a>
    <a id="6174" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="6177" href="Class.IsSet.html#576" class="Function">∀[</a> <a id="6180" href="Ledger.Dijkstra.Specification.Utxow.html#6180" class="Bound">s</a> <a id="6182" href="Class.IsSet.html#576" class="Function">∈</a> <a id="6184" href="Ledger.Dijkstra.Specification.Utxow.html#5200" class="Bound">p1Scripts</a> <a id="6194" href="Class.IsSet.html#576" class="Function">]</a> <a id="6196" class="Symbol">(</a><a id="6197" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="6202" href="Ledger.Dijkstra.Specification.Utxow.html#6180" class="Bound">s</a> <a id="6204" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="6206" href="Ledger.Dijkstra.Specification.Utxow.html#5386" class="Bound">neededScriptHashes</a> <a id="6225" class="Symbol">→</a> <a id="6227" href="Ledger.Dijkstra.Specification.Script.Base.html#671" class="Function">validP1Script</a> <a id="6241" href="Ledger.Dijkstra.Specification.Utxow.html#5114" class="Bound">witsKeyHashes</a> <a id="6255" href="Ledger.Dijkstra.Specification.Transaction.html#4223" class="Function">txVldt</a> <a id="6262" href="Ledger.Dijkstra.Specification.Utxow.html#6180" class="Bound">s</a><a id="6263" class="Symbol">)</a>
    <a id="6269" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="6272" href="Ledger.Dijkstra.Specification.Utxow.html#5520" class="Bound">neededVKeyHashes</a> <a id="6289" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="6291" href="Ledger.Dijkstra.Specification.Utxow.html#5114" class="Bound">witsKeyHashes</a>
    <a id="6309" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="6312" href="Ledger.Dijkstra.Specification.Utxow.html#5386" class="Bound">neededScriptHashes</a> <a id="6331" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="6333" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="6338" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="6343" href="Ledger.Dijkstra.Specification.Utxow.html#5200" class="Bound">p1Scripts</a> <a id="6353" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="6355" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="6360" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="6365" href="Ledger.Dijkstra.Specification.Utxow.html#5293" class="Bound">p2Scripts</a>
    <a id="6379" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="6382" href="Ledger.Dijkstra.Specification.Utxow.html#5647" class="Bound">neededDataHashes</a> <a id="6399" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="6401" href="Class.IsSet.html#916" class="Function">dom</a> <a id="6405" class="Symbol">(</a><a id="6406" href="Ledger.Dijkstra.Specification.Utxo.html#2289" class="Field">DataPoolOf</a> <a id="6417" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a><a id="6418" class="Symbol">)</a>
    <a id="6424" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="6427" href="Ledger.Dijkstra.Specification.Transaction.html#4278" class="Function">txADhash</a> <a id="6436" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6438" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="6442" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="6447" href="Ledger.Dijkstra.Specification.Transaction.html#3747" class="Function">txAuxData</a>
    <a id="6461" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="6463" class="Symbol">(</a><a id="6464" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a> <a id="6466" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6468" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="6473" class="Symbol">)</a> <a id="6475" href="Ledger.Dijkstra.Specification.Utxo.html#9806" class="Datatype Operator">⊢</a> <a id="6477" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a> <a id="6479" href="Ledger.Dijkstra.Specification.Utxo.html#9806" class="Datatype Operator">⇀⦇</a> <a id="6482" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a> <a id="6488" href="Ledger.Dijkstra.Specification.Utxo.html#9806" class="Datatype Operator">,UTXO⦈</a> <a id="6495" href="Ledger.Dijkstra.Specification.Utxow.html#506" class="Generalizable">s&#39;</a>
      <a id="6504" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="6543" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a> <a id="6545" href="Ledger.Dijkstra.Specification.Utxow.html#4830" class="Datatype Operator">⊢</a> <a id="6547" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a> <a id="6549" href="Ledger.Dijkstra.Specification.Utxow.html#4830" class="Datatype Operator">⇀⦇</a> <a id="6552" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a> <a id="6558" href="Ledger.Dijkstra.Specification.Utxow.html#4830" class="Datatype Operator">,UTXOW⦈</a> <a id="6566" href="Ledger.Dijkstra.Specification.Utxow.html#506" class="Generalizable">s&#39;</a>

  <a id="_⊢_⇀⦇_,UTXOW⦈_.UTXOW-legacy"></a><a id="6572" href="Ledger.Dijkstra.Specification.Utxow.html#6572" class="InductiveConstructor">UTXOW-legacy</a> <a id="6585" class="Symbol">:</a>
    <a id="6591" class="Keyword">let</a>
         <a id="6604" class="Keyword">open</a> <a id="6609" href="Ledger.Dijkstra.Specification.Transaction.html#3522" class="Module">Tx</a> <a id="6612" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a>
         <a id="6627" class="Keyword">open</a> <a id="6632" href="Ledger.Dijkstra.Specification.Transaction.html#3794" class="Module">TxBody</a> <a id="6639" href="Ledger.Dijkstra.Specification.Transaction.html#3594" class="Function">txBody</a>
         <a id="6655" class="Keyword">open</a> <a id="6660" href="Ledger.Dijkstra.Specification.Transaction.html#5008" class="Module">TxWitnesses</a> <a id="6672" href="Ledger.Dijkstra.Specification.Transaction.html#3632" class="Function">txWitnesses</a>
         <a id="6693" class="Keyword">open</a> <a id="6698" href="Ledger.Dijkstra.Specification.Utxo.html#1050" class="Module">UTxOEnv</a>

         <a id="6716" href="Ledger.Dijkstra.Specification.Utxow.html#6716" class="Bound">utxo₀</a> <a id="6722" class="Symbol">=</a> <a id="6724" href="Ledger.Dijkstra.Specification.Transaction.html#3454" class="Field">UTxOOf</a> <a id="6731" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a>
         <a id="6742" href="Ledger.Dijkstra.Specification.Utxow.html#6742" class="Bound">utxo</a>  <a id="6748" class="Symbol">=</a> <a id="6750" href="Ledger.Dijkstra.Specification.Transaction.html#3454" class="Field">UTxOOf</a> <a id="6757" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a>

         <a id="6769" href="Ledger.Dijkstra.Specification.Utxow.html#6769" class="Bound">witsKeyHashes</a> <a id="6783" class="Symbol">:</a> <a id="6785" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="6787" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
         <a id="6804" href="Ledger.Dijkstra.Specification.Utxow.html#6769" class="Bound">witsKeyHashes</a> <a id="6818" class="Symbol">=</a> <a id="6820" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="6825" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="6830" class="Symbol">(</a><a id="6831" href="Class.IsSet.html#916" class="Function">dom</a> <a id="6835" href="Ledger.Dijkstra.Specification.Transaction.html#5089" class="Function">vKeySigs</a><a id="6843" class="Symbol">)</a>

         <a id="6855" href="Ledger.Dijkstra.Specification.Utxow.html#6855" class="Bound">topLevelScripts</a> <a id="6871" class="Symbol">:</a> <a id="6873" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="6875" href="Ledger.Dijkstra.Specification.Script.Base.html#2510" class="Function">Script</a>
         <a id="6891" href="Ledger.Dijkstra.Specification.Utxow.html#6855" class="Bound">topLevelScripts</a> <a id="6907" class="Symbol">=</a>  <a id="6910" href="Ledger.Dijkstra.Specification.Transaction.html#17228" class="Function">witnessScripts</a> <a id="6925" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a>
                          <a id="6957" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="6959" href="Ledger.Dijkstra.Specification.Transaction.html#16655" class="Function">spendScripts</a> <a id="6972" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a> <a id="6978" href="Ledger.Dijkstra.Specification.Utxow.html#6716" class="Bound">utxo₀</a>
                          <a id="7010" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="7012" href="Ledger.Dijkstra.Specification.Transaction.html#16802" class="Function">referenceScripts</a> <a id="7029" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a> <a id="7035" href="Ledger.Dijkstra.Specification.Utxow.html#6716" class="Bound">utxo₀</a>

         <a id="7051" href="Ledger.Dijkstra.Specification.Utxow.html#7051" class="Bound">p1Scripts</a> <a id="7061" class="Symbol">:</a> <a id="7063" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="7065" href="Ledger.Dijkstra.Specification.Script.Base.html#647" class="Function">P1Script</a>
         <a id="7083" href="Ledger.Dijkstra.Specification.Utxow.html#7051" class="Bound">p1Scripts</a> <a id="7093" class="Symbol">=</a> <a id="7095" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="7106" href="Ledger.Dijkstra.Specification.Script.Base.html#3042" class="Function">toP1Script</a> <a id="7117" href="Ledger.Dijkstra.Specification.Utxow.html#6855" class="Bound">topLevelScripts</a>

         <a id="7143" href="Ledger.Dijkstra.Specification.Utxow.html#7143" class="Bound">p2Scripts</a> <a id="7153" class="Symbol">:</a> <a id="7155" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="7157" href="Ledger.Dijkstra.Specification.Script.Base.html#2432" class="Function">P2Script</a>
         <a id="7175" href="Ledger.Dijkstra.Specification.Utxow.html#7143" class="Bound">p2Scripts</a> <a id="7185" class="Symbol">=</a> <a id="7187" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="7198" href="Ledger.Dijkstra.Specification.Script.Base.html#3285" class="Function">toP2Script</a> <a id="7209" href="Ledger.Dijkstra.Specification.Utxow.html#6855" class="Bound">topLevelScripts</a>

         <a id="7235" href="Ledger.Dijkstra.Specification.Utxow.html#7235" class="Bound">neededScriptHashes</a>  <a id="7255" class="Symbol">:</a> <a id="7257" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="7259" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
         <a id="7279" href="Ledger.Dijkstra.Specification.Utxow.html#7235" class="Bound">neededScriptHashes</a>  <a id="7299" class="Symbol">=</a> <a id="7301" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="7312" class="Symbol">(</a><a id="7313" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a>  <a id="7326" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="7328" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="7333" class="Symbol">)</a> <a id="7335" class="Symbol">(</a><a id="7336" href="Ledger.Dijkstra.Specification.Script.Validation.html#4832" class="Function">credsNeeded</a> <a id="7348" href="Ledger.Dijkstra.Specification.Utxow.html#6716" class="Bound">utxo₀</a> <a id="7354" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a><a id="7359" class="Symbol">)</a>

         <a id="7371" href="Ledger.Dijkstra.Specification.Utxow.html#7371" class="Bound">neededVKeyHashes</a> <a id="7388" class="Symbol">:</a> <a id="7390" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="7392" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
         <a id="7409" href="Ledger.Dijkstra.Specification.Utxow.html#7371" class="Bound">neededVKeyHashes</a> <a id="7426" class="Symbol">=</a> <a id="7428" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="7439" class="Symbol">(</a><a id="7440" href="Ledger.Core.Specification.Address.html#484" class="Function">isKeyHashObj</a> <a id="7453" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="7455" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="7460" class="Symbol">)</a> <a id="7462" class="Symbol">(</a><a id="7463" href="Ledger.Dijkstra.Specification.Script.Validation.html#4832" class="Function">credsNeeded</a> <a id="7475" href="Ledger.Dijkstra.Specification.Utxow.html#6716" class="Bound">utxo₀</a> <a id="7481" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a><a id="7486" class="Symbol">)</a>

         <a id="7498" href="Ledger.Dijkstra.Specification.Utxow.html#7498" class="Bound">txDataHashes</a>     <a id="7515" class="Symbol">:</a> <a id="7517" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="7519" href="Ledger.Dijkstra.Specification.Script.Base.html#1788" class="Function">DataHash</a>
         <a id="7537" href="Ledger.Dijkstra.Specification.Utxow.html#7498" class="Bound">txDataHashes</a>     <a id="7554" class="Symbol">=</a> <a id="7556" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="7561" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="7566" href="Ledger.Dijkstra.Specification.Transaction.html#5155" class="Function">txData</a>

         <a id="7583" href="Ledger.Dijkstra.Specification.Utxow.html#7583" class="Bound">neededDataHashes</a> <a id="7600" class="Symbol">:</a> <a id="7602" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="7604" href="Ledger.Dijkstra.Specification.Script.Base.html#1788" class="Function">DataHash</a>
         <a id="7622" href="Ledger.Dijkstra.Specification.Utxow.html#7583" class="Bound">neededDataHashes</a> <a id="7639" class="Symbol">=</a> <a id="7641" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="7652" class="Symbol">(λ</a> <a id="7655" href="Ledger.Dijkstra.Specification.Utxow.html#7655" class="Bound">txOut</a><a id="7660" class="Symbol">@(</a><a id="7662" href="Ledger.Dijkstra.Specification.Utxow.html#7662" class="Bound">a</a> <a id="7664" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7666" class="Symbol">_</a> <a id="7668" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7670" href="Ledger.Dijkstra.Specification.Utxow.html#7670" class="Bound">d</a> <a id="7672" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7674" class="Symbol">_)</a> <a id="7677" class="Symbol">→</a> <a id="7679" class="Keyword">do</a> <a id="7682" href="Ledger.Dijkstra.Specification.Utxow.html#7682" class="Bound">sh</a> <a id="7685" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7687" href="Ledger.Core.Specification.Address.html#765" class="Function">isScriptObj</a> <a id="7699" class="Symbol">(</a><a id="7700" href="Ledger.Core.Specification.Address.html#3056" class="Function">payCred</a> <a id="7708" href="Ledger.Dijkstra.Specification.Utxow.html#7662" class="Bound">a</a><a id="7709" class="Symbol">)</a>
                                                                     <a id="7780" class="Symbol">_</a>  <a id="7783" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="7785" href="Ledger.Prelude.html#2610" class="Function">lookupHash</a> <a id="7796" href="Ledger.Dijkstra.Specification.Utxow.html#7682" class="Bound">sh</a> <a id="7799" href="Ledger.Dijkstra.Specification.Utxow.html#7143" class="Bound">p2Scripts</a>
                                                                     <a id="7878" href="Ledger.Dijkstra.Specification.Utxow.html#7670" class="Bound">d</a> <a id="7880" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="7884" href="Data.Sum.html#870" class="Function">isInj₂</a><a id="7890" class="Symbol">)</a>
                                       <a id="7931" class="Symbol">(</a><a id="7932" href="Class.IsSet.html#959" class="Function">range</a> <a id="7938" class="Symbol">(</a><a id="7939" href="Ledger.Dijkstra.Specification.Utxow.html#6716" class="Bound">utxo₀</a> <a id="7945" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="7947" href="Ledger.Dijkstra.Specification.Transaction.html#3870" class="Function">txIns</a><a id="7952" class="Symbol">))</a>

         <a id="7965" href="Ledger.Dijkstra.Specification.Utxow.html#7965" class="Bound">refInputsDataHashes</a> <a id="7985" class="Symbol">=</a> <a id="7987" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="7998" href="Ledger.Dijkstra.Specification.Script.Validation.html#5250" class="Function">txOutToDataHash</a> <a id="8014" class="Symbol">(</a><a id="8015" href="Class.IsSet.html#959" class="Function">range</a> <a id="8021" class="Symbol">(</a><a id="8022" href="Ledger.Dijkstra.Specification.Utxow.html#6742" class="Bound">utxo</a> <a id="8027" href="Axiom.Set.Map.html#13536" class="Function Operator">∣</a> <a id="8029" href="Ledger.Dijkstra.Specification.Transaction.html#3908" class="Function">referenceInputs</a><a id="8044" class="Symbol">))</a>
         <a id="8056" href="Ledger.Dijkstra.Specification.Utxow.html#8056" class="Bound">outputsDataHashes</a>   <a id="8076" class="Symbol">=</a> <a id="8078" href="Axiom.Set.html#7990" class="Function">mapPartial</a> <a id="8089" href="Ledger.Dijkstra.Specification.Script.Validation.html#5250" class="Function">txOutToDataHash</a> <a id="8105" class="Symbol">(</a><a id="8106" href="Class.IsSet.html#959" class="Function">range</a> <a id="8112" href="Ledger.Dijkstra.Specification.Transaction.html#4005" class="Function">txOuts</a><a id="8118" class="Symbol">)</a>

    <a id="8125" class="Keyword">in</a>
    <a id="8132" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a>  <a id="8135" href="Class.IsSet.html#736" class="Function">∃[</a> <a id="8138" href="Ledger.Dijkstra.Specification.Utxow.html#8138" class="Bound">h</a> <a id="8140" href="Class.IsSet.html#736" class="Function">∈</a> <a id="8142" href="Ledger.Dijkstra.Specification.Utxow.html#7235" class="Bound">neededScriptHashes</a> <a id="8161" href="Class.IsSet.html#736" class="Function">]</a> <a id="8163" href="Class.IsSet.html#736" class="Function">∃[</a> <a id="8166" href="Ledger.Dijkstra.Specification.Utxow.html#8166" class="Bound">s</a> <a id="8168" href="Class.IsSet.html#736" class="Function">∈</a> <a id="8170" href="Ledger.Dijkstra.Specification.Utxow.html#7143" class="Bound">p2Scripts</a> <a id="8180" href="Class.IsSet.html#736" class="Function">]</a> <a id="8182" href="Ledger.Dijkstra.Specification.Utxow.html#8138" class="Bound">h</a> <a id="8184" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="8186" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="8191" href="Ledger.Dijkstra.Specification.Utxow.html#8166" class="Bound">s</a> <a id="8193" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="8195" href="Ledger.Dijkstra.Specification.Script.Base.html#2029" class="Function">language</a> <a id="8204" href="Ledger.Dijkstra.Specification.Utxow.html#8166" class="Bound">s</a> <a id="8206" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="8208" href="Axiom.Set.html#5903" class="Function">fromList</a> <a id="8217" class="Symbol">(</a><a id="8218" href="Ledger.Dijkstra.Specification.Script.Base.html#1046" class="Function">PlutusV1</a> <a id="8227" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8229" href="Ledger.Dijkstra.Specification.Script.Base.html#1055" class="Function">PlutusV2</a> <a id="8238" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8240" href="Ledger.Dijkstra.Specification.Script.Base.html#1064" class="Function">PlutusV3</a> <a id="8249" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8251" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8253" class="Symbol">)</a>
    <a id="8259" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8262" href="Class.IsSet.html#576" class="Function">∀[</a> <a id="8265" href="Ledger.Dijkstra.Specification.Utxow.html#8265" class="Bound">(</a><a id="8266" href="Ledger.Dijkstra.Specification.Utxow.html#8266" class="Bound">vk</a> <a id="8269" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8271" href="Ledger.Dijkstra.Specification.Utxow.html#8271" class="Bound">σ</a><a id="8272" href="Ledger.Dijkstra.Specification.Utxow.html#8265" class="Bound">)</a> <a id="8274" href="Class.IsSet.html#576" class="Function">∈</a> <a id="8276" href="Ledger.Dijkstra.Specification.Transaction.html#5089" class="Function">vKeySigs</a> <a id="8285" href="Class.IsSet.html#576" class="Function">]</a> <a id="8287" href="Ledger.Core.Specification.Crypto.html#719" class="Function">isSigned</a> <a id="8296" href="Ledger.Dijkstra.Specification.Utxow.html#8266" class="Bound">vk</a> <a id="8299" class="Symbol">(</a><a id="8300" href="Ledger.Dijkstra.Specification.Transaction.html#2389" class="Field">txidBytes</a> <a id="8310" href="Ledger.Dijkstra.Specification.Transaction.html#4047" class="Function">txId</a><a id="8314" class="Symbol">)</a> <a id="8316" href="Ledger.Dijkstra.Specification.Utxow.html#8271" class="Bound">σ</a>
    <a id="8322" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8325" href="Class.IsSet.html#576" class="Function">∀[</a> <a id="8328" href="Ledger.Dijkstra.Specification.Utxow.html#8328" class="Bound">s</a> <a id="8330" href="Class.IsSet.html#576" class="Function">∈</a> <a id="8332" href="Ledger.Dijkstra.Specification.Utxow.html#7051" class="Bound">p1Scripts</a> <a id="8342" href="Class.IsSet.html#576" class="Function">]</a> <a id="8344" class="Symbol">(</a><a id="8345" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="8350" href="Ledger.Dijkstra.Specification.Utxow.html#8328" class="Bound">s</a> <a id="8352" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="8354" href="Ledger.Dijkstra.Specification.Utxow.html#7235" class="Bound">neededScriptHashes</a> <a id="8373" class="Symbol">→</a> <a id="8375" href="Ledger.Dijkstra.Specification.Script.Base.html#671" class="Function">validP1Script</a> <a id="8389" href="Ledger.Dijkstra.Specification.Utxow.html#6769" class="Bound">witsKeyHashes</a> <a id="8403" href="Ledger.Dijkstra.Specification.Transaction.html#4223" class="Function">txVldt</a> <a id="8410" href="Ledger.Dijkstra.Specification.Utxow.html#8328" class="Bound">s</a><a id="8411" class="Symbol">)</a>
    <a id="8417" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8420" href="Ledger.Dijkstra.Specification.Utxow.html#7235" class="Bound">neededScriptHashes</a> <a id="8439" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="8441" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="8446" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="8451" href="Ledger.Dijkstra.Specification.Utxow.html#6855" class="Bound">topLevelScripts</a>
    <a id="8471" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8474" href="Ledger.Dijkstra.Specification.Utxow.html#7371" class="Bound">neededVKeyHashes</a> <a id="8491" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="8493" href="Ledger.Dijkstra.Specification.Utxow.html#6769" class="Bound">witsKeyHashes</a>
    <a id="8511" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8514" href="Ledger.Dijkstra.Specification.Utxow.html#7583" class="Bound">neededDataHashes</a> <a id="8531" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="8533" href="Ledger.Dijkstra.Specification.Utxow.html#7498" class="Bound">txDataHashes</a>
    <a id="8550" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8553" href="Ledger.Dijkstra.Specification.Utxow.html#7498" class="Bound">txDataHashes</a>     <a id="8570" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="8572" href="Ledger.Dijkstra.Specification.Utxow.html#7583" class="Bound">neededDataHashes</a> <a id="8589" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="8591" href="Ledger.Dijkstra.Specification.Utxow.html#8056" class="Bound">outputsDataHashes</a> <a id="8609" href="Axiom.Set.html#9137" class="Function Operator">∪</a> <a id="8611" href="Ledger.Dijkstra.Specification.Utxow.html#7965" class="Bound">refInputsDataHashes</a>
    <a id="8635" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8638" href="Ledger.Dijkstra.Specification.Utxow.html#2538" class="Function">languages</a> <a id="8648" href="Ledger.Dijkstra.Specification.Utxow.html#7143" class="Bound">p2Scripts</a> <a id="8658" href="Interface.TypeClasses.HasSubset.html#172" class="Field Operator">⊆</a> <a id="8660" href="Ledger.Dijkstra.Specification.Utxow.html#2622" class="Function">allowedLanguagesLegacyMode</a> <a id="8687" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a> <a id="8693" href="Ledger.Dijkstra.Specification.Utxow.html#6742" class="Bound">utxo</a>
    <a id="8702" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8705" href="Ledger.Dijkstra.Specification.Transaction.html#4278" class="Function">txADhash</a> <a id="8714" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="8716" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="8720" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="8725" href="Ledger.Dijkstra.Specification.Transaction.html#3747" class="Function">txAuxData</a>
    <a id="8739" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a>  <a id="8742" class="Symbol">(</a><a id="8743" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a> <a id="8745" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8747" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="8751" class="Symbol">)</a> <a id="8753" href="Ledger.Dijkstra.Specification.Utxo.html#9806" class="Datatype Operator">⊢</a> <a id="8755" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a> <a id="8757" href="Ledger.Dijkstra.Specification.Utxo.html#9806" class="Datatype Operator">⇀⦇</a> <a id="8760" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a> <a id="8766" href="Ledger.Dijkstra.Specification.Utxo.html#9806" class="Datatype Operator">,UTXO⦈</a> <a id="8773" href="Ledger.Dijkstra.Specification.Utxow.html#506" class="Generalizable">s&#39;</a>
      <a id="8782" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="8821" href="Ledger.Dijkstra.Specification.Utxow.html#492" class="Generalizable">Γ</a> <a id="8823" href="Ledger.Dijkstra.Specification.Utxow.html#4830" class="Datatype Operator">⊢</a> <a id="8825" href="Ledger.Dijkstra.Specification.Utxow.html#504" class="Generalizable">s</a> <a id="8827" href="Ledger.Dijkstra.Specification.Utxow.html#4830" class="Datatype Operator">⇀⦇</a> <a id="8830" href="Ledger.Dijkstra.Specification.Utxow.html#524" class="Generalizable">txTop</a> <a id="8836" href="Ledger.Dijkstra.Specification.Utxow.html#4830" class="Datatype Operator">,UTXOW⦈</a> <a id="8844" href="Ledger.Dijkstra.Specification.Utxow.html#506" class="Generalizable">s&#39;</a>

</pre></body></html>