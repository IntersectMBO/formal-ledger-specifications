<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Foreign.Convertible.DerivingTest</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Keyword">module</a> <a id="9" href="Foreign.Convertible.DerivingTest.html" class="Module">Foreign.Convertible.DerivingTest</a> <a id="42" class="Keyword">where</a>

<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Level.html" class="Module">Level</a>
<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="MetaPrelude.html" class="Module">MetaPrelude</a>
<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Meta.html" class="Module">Meta</a>

<a id="109" class="Keyword">import</a> <a id="116" href="Data.List.html" class="Module">Data.List</a> <a id="126" class="Symbol">as</a> <a id="129" class="Module">L</a>
<a id="131" class="Keyword">import</a> <a id="138" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="157" class="Symbol">as</a> <a id="160" class="Module">NE</a>
<a id="163" class="Keyword">import</a> <a id="170" href="Data.String.html" class="Module">Data.String</a> <a id="182" class="Symbol">as</a> <a id="185" class="Module">S</a>
<a id="187" class="Keyword">import</a> <a id="194" href="Data.Product.html" class="Module">Data.Product</a> <a id="207" class="Symbol">as</a> <a id="210" class="Module">P</a>

<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="242" class="Keyword">open</a> <a id="247" class="Keyword">import</a> <a id="254" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="312" class="Keyword">open</a> <a id="317" class="Keyword">import</a> <a id="324" href="Reflection.AST.Term.html" class="Module">Reflection.AST.Term</a>
<a id="344" class="Keyword">open</a> <a id="349" class="Keyword">import</a> <a id="356" href="Reflection.AST.DeBruijn.html" class="Module">Reflection.AST.DeBruijn</a>
<a id="380" class="Keyword">import</a> <a id="387" href="Reflection.TCM.html" class="Module">Reflection.TCM</a> <a id="402" class="Symbol">as</a> <a id="405" class="Module">R</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>
<a id="469" class="Keyword">import</a> <a id="476" href="Function.Identity.Effectful.html" class="Module">Function.Identity.Effectful</a> <a id="504" class="Symbol">as</a> <a id="507" class="Module">Identity</a>

<a id="517" class="Keyword">open</a> <a id="522" class="Keyword">import</a> <a id="529" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="541" class="Keyword">open</a> <a id="546" class="Keyword">import</a> <a id="553" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="591" class="Keyword">open</a> <a id="596" class="Keyword">import</a> <a id="603" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="651" class="Keyword">open</a> <a id="656" class="Keyword">import</a> <a id="663" href="Class.Traversable.html" class="Module">Class.Traversable</a>
<a id="681" class="Keyword">open</a> <a id="686" class="Keyword">import</a> <a id="693" href="Class.Show.html" class="Module">Class.Show</a>
<a id="704" class="Keyword">open</a> <a id="709" class="Keyword">import</a> <a id="716" href="Class.MonadReader.html" class="Module">Class.MonadReader</a>

<a id="735" class="Keyword">open</a> <a id="740" class="Keyword">import</a> <a id="747" href="Foreign.Convertible.html" class="Module">Foreign.Convertible</a>
<a id="767" class="Keyword">open</a> <a id="772" class="Keyword">import</a> <a id="779" href="Foreign.Convertible.Deriving.html" class="Module">Foreign.Convertible.Deriving</a>

<a id="809" class="Comment">-- Tests</a>

<a id="819" class="Keyword">open</a> <a id="824" class="Keyword">import</a> <a id="831" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a>
<a id="847" class="Keyword">open</a> <a id="852" class="Keyword">import</a> <a id="859" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a>

<a id="874" class="Keyword">data</a> <a id="HsMaybe"></a><a id="879" href="Foreign.Convertible.DerivingTest.html#879" class="Datatype">HsMaybe</a> <a id="887" class="Symbol">(</a><a id="888" href="Foreign.Convertible.DerivingTest.html#888" class="Bound">a</a> <a id="890" class="Symbol">:</a> <a id="892" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="895" class="Symbol">)</a> <a id="897" class="Symbol">:</a> <a id="899" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="903" class="Keyword">where</a>
  <a id="HsMaybe.just"></a><a id="911" href="Foreign.Convertible.DerivingTest.html#911" class="InductiveConstructor">just</a>    <a id="919" class="Symbol">:</a> <a id="921" class="Symbol">(</a><a id="922" href="Foreign.Convertible.DerivingTest.html#922" class="Bound">x</a> <a id="924" class="Symbol">:</a> <a id="926" href="Foreign.Convertible.DerivingTest.html#888" class="Bound">a</a><a id="927" class="Symbol">)</a> <a id="929" class="Symbol">→</a> <a id="931" href="Foreign.Convertible.DerivingTest.html#879" class="Datatype">HsMaybe</a> <a id="939" href="Foreign.Convertible.DerivingTest.html#888" class="Bound">a</a>
  <a id="HsMaybe.nothing"></a><a id="943" href="Foreign.Convertible.DerivingTest.html#943" class="InductiveConstructor">nothing</a> <a id="951" class="Symbol">:</a> <a id="953" href="Foreign.Convertible.DerivingTest.html#879" class="Datatype">HsMaybe</a> <a id="961" href="Foreign.Convertible.DerivingTest.html#888" class="Bound">a</a>

<a id="964" class="Keyword">data</a> <a id="HsEither"></a><a id="969" href="Foreign.Convertible.DerivingTest.html#969" class="Datatype">HsEither</a> <a id="978" class="Symbol">(</a><a id="979" href="Foreign.Convertible.DerivingTest.html#979" class="Bound">a</a> <a id="981" href="Foreign.Convertible.DerivingTest.html#981" class="Bound">b</a> <a id="983" class="Symbol">:</a> <a id="985" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="988" class="Symbol">)</a> <a id="990" class="Symbol">:</a> <a id="992" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="996" class="Keyword">where</a>
  <a id="HsEither.left"></a><a id="1004" href="Foreign.Convertible.DerivingTest.html#1004" class="InductiveConstructor">left</a> <a id="1009" class="Symbol">:</a> <a id="1011" href="Foreign.Convertible.DerivingTest.html#979" class="Bound">a</a> <a id="1013" class="Symbol">→</a> <a id="1015" href="Foreign.Convertible.DerivingTest.html#969" class="Datatype">HsEither</a> <a id="1024" href="Foreign.Convertible.DerivingTest.html#979" class="Bound">a</a> <a id="1026" href="Foreign.Convertible.DerivingTest.html#981" class="Bound">b</a>
  <a id="HsEither.right"></a><a id="1030" href="Foreign.Convertible.DerivingTest.html#1030" class="InductiveConstructor">right</a> <a id="1036" class="Symbol">:</a> <a id="1038" href="Foreign.Convertible.DerivingTest.html#981" class="Bound">b</a> <a id="1040" class="Symbol">→</a> <a id="1042" href="Foreign.Convertible.DerivingTest.html#969" class="Datatype">HsEither</a> <a id="1051" href="Foreign.Convertible.DerivingTest.html#979" class="Bound">a</a> <a id="1053" href="Foreign.Convertible.DerivingTest.html#981" class="Bound">b</a>

<a id="1056" class="Comment">-- We should be able to generate this</a>
<a id="ConvertibleMaybe"></a><a id="1094" href="Foreign.Convertible.DerivingTest.html#1094" class="Function">ConvertibleMaybe</a> <a id="1111" class="Symbol">:</a> <a id="1113" class="Symbol">∀</a> <a id="1115" class="Symbol">{</a><a id="1116" href="Foreign.Convertible.DerivingTest.html#1116" class="Bound">a</a> <a id="1118" href="Foreign.Convertible.DerivingTest.html#1118" class="Bound">a&#39;</a><a id="1120" class="Symbol">}</a> <a id="1122" class="Symbol">→</a> <a id="1124" class="Symbol">⦃</a> <a id="1126" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="1138" href="Foreign.Convertible.DerivingTest.html#1116" class="Bound">a</a> <a id="1140" href="Foreign.Convertible.DerivingTest.html#1118" class="Bound">a&#39;</a> <a id="1143" class="Symbol">⦄</a> <a id="1145" class="Symbol">→</a> <a id="1147" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="1159" class="Symbol">(</a><a id="1160" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1166" href="Foreign.Convertible.DerivingTest.html#1116" class="Bound">a</a><a id="1167" class="Symbol">)</a> <a id="1169" class="Symbol">(</a><a id="1170" href="Foreign.Convertible.DerivingTest.html#879" class="Datatype">HsMaybe</a> <a id="1178" href="Foreign.Convertible.DerivingTest.html#1118" class="Bound">a&#39;</a><a id="1180" class="Symbol">)</a>
<a id="1182" href="Foreign.Convertible.DerivingTest.html#1094" class="Function">ConvertibleMaybe</a> <a id="1199" class="Symbol">.</a><a id="1200" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1203" class="Symbol">(</a><a id="1204" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1209" href="Foreign.Convertible.DerivingTest.html#1209" class="Bound">x</a><a id="1210" class="Symbol">)</a>   <a id="1214" class="Symbol">=</a> <a id="1216" href="Foreign.Convertible.DerivingTest.html#911" class="InductiveConstructor">just</a> <a id="1221" class="Symbol">(</a><a id="1222" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1225" href="Foreign.Convertible.DerivingTest.html#1209" class="Bound">x</a><a id="1226" class="Symbol">)</a>
<a id="1228" href="Foreign.Convertible.DerivingTest.html#1094" class="Function">ConvertibleMaybe</a> <a id="1245" class="Symbol">.</a><a id="1246" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1249" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>    <a id="1260" class="Symbol">=</a> <a id="1262" href="Foreign.Convertible.DerivingTest.html#943" class="InductiveConstructor">nothing</a>
<a id="1270" href="Foreign.Convertible.DerivingTest.html#1094" class="Function">ConvertibleMaybe</a> <a id="1287" class="Symbol">.</a><a id="1288" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="1293" class="Symbol">(</a><a id="1294" href="Foreign.Convertible.DerivingTest.html#911" class="InductiveConstructor">just</a> <a id="1299" href="Foreign.Convertible.DerivingTest.html#1299" class="Bound">x</a><a id="1300" class="Symbol">)</a> <a id="1302" class="Symbol">=</a> <a id="1304" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1309" class="Symbol">(</a><a id="1310" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="1315" href="Foreign.Convertible.DerivingTest.html#1299" class="Bound">x</a><a id="1316" class="Symbol">)</a>
<a id="1318" href="Foreign.Convertible.DerivingTest.html#1094" class="Function">ConvertibleMaybe</a> <a id="1335" class="Symbol">.</a><a id="1336" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="1341" href="Foreign.Convertible.DerivingTest.html#943" class="InductiveConstructor">nothing</a>  <a id="1350" class="Symbol">=</a> <a id="1352" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>

<a id="1361" class="Comment">-- With deriveConvertible</a>
<a id="1387" class="Keyword">unquoteDecl</a> <a id="iConvertMaybe"></a><a id="1399" href="Foreign.Convertible.DerivingTest.html#1399" class="Function">iConvertMaybe</a>  <a id="1414" class="Symbol">=</a> <a id="1416" href="Foreign.Convertible.Deriving.html#5986" class="Function">deriveConvertible</a> <a id="1434" href="Foreign.Convertible.DerivingTest.html#1399" class="Function">iConvertMaybe</a> <a id="1448" class="Symbol">(</a><a id="1449" class="Keyword">quote</a> <a id="1455" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="1460" class="Symbol">)</a> <a id="1462" class="Symbol">(</a><a id="1463" class="Keyword">quote</a> <a id="1469" href="Foreign.Convertible.DerivingTest.html#879" class="Datatype">HsMaybe</a><a id="1476" class="Symbol">)</a>

<a id="1479" class="Comment">-- or with ConvertibleType and autoConvertible</a>
<a id="1526" class="Keyword">instance</a>
  <a id="iConvertEither"></a><a id="1537" href="Foreign.Convertible.DerivingTest.html#1537" class="Function">iConvertEither</a> <a id="1552" class="Symbol">:</a> <a id="1554" href="Foreign.Convertible.Deriving.html#6640" class="Macro">ConvertibleType</a> <a id="1570" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a> <a id="1574" href="Foreign.Convertible.DerivingTest.html#969" class="Datatype">HsEither</a>
  <a id="1585" href="Foreign.Convertible.DerivingTest.html#1537" class="Function">iConvertEither</a> <a id="1600" class="Symbol">=</a> <a id="1602" href="Foreign.Convertible.Deriving.html#6809" class="Macro">autoConvertible</a>

<a id="1619" class="Keyword">instance</a>
  <a id="ConvertibleNat"></a><a id="1630" href="Foreign.Convertible.DerivingTest.html#1630" class="Function">ConvertibleNat</a> <a id="1645" class="Symbol">=</a> <a id="1647" href="Foreign.Convertible.html#308" class="Function">Convertible-Refl</a> <a id="1664" class="Symbol">{</a><a id="1665" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1666" class="Symbol">}</a>

<a id="test"></a><a id="1669" href="Foreign.Convertible.DerivingTest.html#1669" class="Function">test</a> <a id="1674" class="Symbol">:</a> <a id="1676" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1678" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="1680" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1686" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1688" class="Symbol">→</a> <a id="1690" href="Foreign.Convertible.DerivingTest.html#969" class="Datatype">HsEither</a> <a id="1699" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1701" class="Symbol">(</a><a id="1702" href="Foreign.Convertible.DerivingTest.html#879" class="Datatype">HsMaybe</a> <a id="1710" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1711" class="Symbol">)</a>
<a id="1713" href="Foreign.Convertible.DerivingTest.html#1669" class="Function">test</a> <a id="1718" class="Symbol">=</a> <a id="1720" href="Foreign.Convertible.html#149" class="Field">to</a>

<a id="1724" href="Foreign.Convertible.DerivingTest.html#1724" class="Function">_</a> <a id="1726" class="Symbol">:</a> <a id="1728" href="Foreign.Convertible.DerivingTest.html#1669" class="Function">test</a> <a id="1733" class="Symbol">(</a><a id="1734" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1739" class="Symbol">(</a><a id="1740" class="InductiveConstructor">just</a> <a id="1745" class="Number">5</a><a id="1746" class="Symbol">))</a> <a id="1749" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1751" href="Foreign.Convertible.DerivingTest.html#1030" class="InductiveConstructor">right</a> <a id="1757" class="Symbol">(</a><a id="1758" class="InductiveConstructor">just</a> <a id="1763" class="Number">5</a><a id="1764" class="Symbol">)</a>
<a id="1766" class="Symbol">_</a> <a id="1768" class="Symbol">=</a> <a id="1770" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="1776" class="Comment">-- There was a problem due to Agda#7182 with record types in parameterised modules.</a>

<a id="1861" class="Keyword">module</a> <a id="Param"></a><a id="1868" href="Foreign.Convertible.DerivingTest.html#1868" class="Module">Param</a> <a id="1874" class="Symbol">(</a><a id="1875" href="Foreign.Convertible.DerivingTest.html#1875" class="Bound">A</a> <a id="1877" class="Symbol">:</a> <a id="1879" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1882" class="Symbol">)</a> <a id="1884" class="Keyword">where</a>
  <a id="1892" class="Keyword">record</a> <a id="Param.AgdaThing"></a><a id="1899" href="Foreign.Convertible.DerivingTest.html#1899" class="Record">AgdaThing</a> <a id="1909" class="Symbol">:</a> <a id="1911" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1915" class="Keyword">where</a>
    <a id="1925" class="Keyword">field</a> <a id="Param.AgdaThing.theThing"></a><a id="1931" href="Foreign.Convertible.DerivingTest.html#1931" class="Field">theThing</a> <a id="1940" class="Symbol">:</a> <a id="1942" href="Foreign.Convertible.DerivingTest.html#1875" class="Bound">A</a>

<a id="1945" class="Keyword">record</a> <a id="HsThing"></a><a id="1952" href="Foreign.Convertible.DerivingTest.html#1952" class="Record">HsThing</a> <a id="1960" class="Symbol">:</a> <a id="1962" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1966" class="Keyword">where</a>
  <a id="1974" class="Keyword">field</a> <a id="HsThing.theThing"></a><a id="1980" href="Foreign.Convertible.DerivingTest.html#1980" class="Field">theThing</a> <a id="1989" class="Symbol">:</a> <a id="1991" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="1994" class="Keyword">open</a> <a id="1999" href="Foreign.Convertible.DerivingTest.html#1868" class="Module">Param</a> <a id="2005" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2007" class="Keyword">unquoteDecl</a> <a id="iConvertThing"></a><a id="2019" href="Foreign.Convertible.DerivingTest.html#2019" class="Function">iConvertThing</a> <a id="2033" class="Symbol">=</a> <a id="2035" href="Foreign.Convertible.Deriving.html#5986" class="Function">deriveConvertible</a> <a id="2053" href="Foreign.Convertible.DerivingTest.html#2019" class="Function">iConvertThing</a> <a id="2067" class="Symbol">(</a><a id="2068" class="Keyword">quote</a> <a id="2074" href="Foreign.Convertible.DerivingTest.html#1899" class="Record">AgdaThing</a><a id="2083" class="Symbol">)</a> <a id="2085" class="Symbol">(</a><a id="2086" class="Keyword">quote</a> <a id="2092" href="Foreign.Convertible.DerivingTest.html#1952" class="Record">HsThing</a><a id="2099" class="Symbol">)</a>

<a id="convThing"></a><a id="2102" href="Foreign.Convertible.DerivingTest.html#2102" class="Function">convThing</a> <a id="2112" class="Symbol">:</a> <a id="2114" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2126" href="Foreign.Convertible.DerivingTest.html#1899" class="Record">AgdaThing</a> <a id="2136" href="Foreign.Convertible.DerivingTest.html#1952" class="Record">HsThing</a>
<a id="2144" href="Foreign.Convertible.DerivingTest.html#2102" class="Function">convThing</a> <a id="2154" class="Symbol">=</a> <a id="2156" href="Foreign.Convertible.Deriving.html#6809" class="Macro">autoConvertible</a>
</pre></body></html>