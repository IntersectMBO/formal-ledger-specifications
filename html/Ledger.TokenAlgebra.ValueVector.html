<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.TokenAlgebra.ValueVector</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">open</a> <a id="29" class="Keyword">import</a> <a id="36" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="51" class="Keyword">hiding</a> <a id="58" class="Symbol">(</a><a id="59" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">_∙_</a><a id="62" class="Symbol">;</a> <a id="64" href="Class.Monoid.Core.html#195" class="Field">ε</a><a id="65" class="Symbol">)</a>

<a id="68" class="Keyword">module</a> <a id="75" href="Ledger.TokenAlgebra.ValueVector.html" class="Module">Ledger.TokenAlgebra.ValueVector</a> <a id="107" class="Symbol">(</a><a id="108" href="Ledger.TokenAlgebra.ValueVector.html#108" class="Bound">PolicyId</a> <a id="117" class="Symbol">:</a> <a id="119" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="123" class="Symbol">)</a> <a id="125" class="Symbol">(</a><a id="126" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a> <a id="128" class="Symbol">:</a> <a id="130" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="131" class="Symbol">)</a> <a id="133" class="Keyword">where</a>

<a id="140" class="Keyword">import</a> <a id="147" href="Algebra.html" class="Module">Algebra</a> <a id="155" class="Symbol">as</a> <a id="158" class="Module">Alg</a>
<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="stdlib.Algebra.Morphism.Construct.DirectProduct.html" class="Module">stdlib.Algebra.Morphism.Construct.DirectProduct</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Algebra.Construct.DirectProduct.html" class="Module">Algebra.Construct.DirectProduct</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="298" class="Keyword">using</a> <a id="304" class="Symbol">(</a><a id="305" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a><a id="326" class="Symbol">)</a>
<a id="328" class="Keyword">import</a> <a id="335" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html" class="Module">Data.Product.Relation.Binary.Pointwise.NonDependent</a> <a id="387" class="Symbol">as</a> <a id="390" class="Module">Product</a>
<a id="398" class="Keyword">open</a> <a id="403" class="Keyword">import</a> <a id="410" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="419" class="Symbol">as</a> <a id="422" class="Module">Vec</a>
  <a id="428" class="Keyword">hiding</a> <a id="435" class="Symbol">(</a><a id="436" href="Data.Vec.Base.html#8496" class="Function">fromList</a><a id="444" class="Symbol">)</a>
<a id="446" class="Keyword">import</a> <a id="453" href="stdlib.Data.Vec.Instances.html" class="Module">stdlib.Data.Vec.Instances</a> <a id="479" class="Symbol">as</a> <a id="482" class="Module">Vec</a>
<a id="486" class="Keyword">import</a> <a id="493" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Binary.Pointwise.Inductive</a> <a id="538" class="Symbol">as</a> <a id="541" class="Module">Vec</a>

<a id="546" class="Keyword">open</a> <a id="551" class="Keyword">import</a> <a id="558" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="578" href="Ledger.TokenAlgebra.ValueVector.html#108" class="Bound">PolicyId</a>

<a id="Quantity"></a><a id="588" href="Ledger.TokenAlgebra.ValueVector.html#588" class="Function">Quantity</a> <a id="597" class="Symbol">=</a> <a id="599" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Vec-commutativeMonoid"></a><a id="602" href="Ledger.TokenAlgebra.ValueVector.html#602" class="Function">Vec-commutativeMonoid</a> <a id="624" class="Symbol">=</a> <a id="626" href="stdlib.Data.Vec.Instances.html#3630" class="Function">Vec.commutativeMonoid</a> <a id="648" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a> <a id="650" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>

<a id="673" class="Keyword">module</a> <a id="+-0-commutativeMonoid"></a><a id="680" href="Ledger.TokenAlgebra.ValueVector.html#680" class="Module">+-0-commutativeMonoid</a> <a id="702" class="Symbol">=</a> <a id="704" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="726" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>
<a id="748" class="Keyword">module</a> <a id="Vec-commutativeMonoid"></a><a id="755" href="Ledger.TokenAlgebra.ValueVector.html#755" class="Module">Vec-commutativeMonoid</a> <a id="777" class="Symbol">=</a> <a id="779" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="801" href="Ledger.TokenAlgebra.ValueVector.html#602" class="Function">Vec-commutativeMonoid</a>

<a id="824" class="Keyword">module</a> <a id="831" href="Ledger.TokenAlgebra.ValueVector.html#831" class="Module">_</a> <a id="833" class="Symbol">(</a><a id="834" href="Ledger.TokenAlgebra.ValueVector.html#834" class="Bound">Policies</a> <a id="843" class="Symbol">:</a> <a id="845" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="849" href="Ledger.TokenAlgebra.ValueVector.html#108" class="Bound">PolicyId</a> <a id="858" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a><a id="859" class="Symbol">)</a> <a id="861" class="Keyword">where</a>
  <a id="869" href="Ledger.TokenAlgebra.ValueVector.html#869" class="Function">Value-TokenAlgebra</a> <a id="888" class="Symbol">:</a> <a id="890" href="Ledger.TokenAlgebra.html#453" class="Record">TokenAlgebra</a>
  <a id="905" href="Ledger.TokenAlgebra.ValueVector.html#869" class="Function">Value-TokenAlgebra</a> <a id="924" class="Symbol">=</a> <a id="926" class="Keyword">record</a> <a id="933" class="Symbol">{</a><a id="934" href="Ledger.TokenAlgebra.ValueVector.html#961" class="Module">go</a><a id="936" class="Symbol">}</a>
    <a id="942" class="Keyword">where</a>
      <a id="954" class="Keyword">module</a> <a id="961" href="Ledger.TokenAlgebra.ValueVector.html#961" class="Module">go</a> <a id="964" class="Keyword">where</a>
        <a id="978" href="Ledger.TokenAlgebra.ValueVector.html#978" class="Function">Value</a> <a id="984" class="Symbol">:</a> <a id="986" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="999" href="Ledger.TokenAlgebra.ValueVector.html#978" class="Function">Value</a> <a id="1005" class="Symbol">=</a> <a id="1007" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1012" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1014" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="1018" href="Ledger.TokenAlgebra.ValueVector.html#588" class="Function">Quantity</a> <a id="1027" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a>

        <a id="1038" href="Ledger.TokenAlgebra.ValueVector.html#1038" class="Function">Value-CommutativeMonoid</a> <a id="1062" class="Symbol">:</a> <a id="1064" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="1082" href="Level.html#521" class="Function">0ℓ</a> <a id="1085" href="Level.html#521" class="Function">0ℓ</a> <a id="1088" href="Ledger.TokenAlgebra.ValueVector.html#978" class="Function">Value</a>
        <a id="1102" href="Ledger.TokenAlgebra.ValueVector.html#1038" class="Function">Value-CommutativeMonoid</a> <a id="1126" class="Symbol">=</a> <a id="1128" href="Class.CommutativeMonoid.Core.html#639" class="Function">Conversion.fromBundle</a> <a id="1150" class="Symbol">(</a><a id="1151" href="Algebra.Construct.DirectProduct.html#7719" class="Function">commutativeMonoid</a> <a id="1169" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a> <a id="1191" href="Ledger.TokenAlgebra.ValueVector.html#602" class="Function">Vec-commutativeMonoid</a><a id="1212" class="Symbol">)</a>

        <a id="1223" href="Ledger.TokenAlgebra.ValueVector.html#1223" class="Function">coin</a> <a id="1228" class="Symbol">:</a> <a id="1230" href="Ledger.TokenAlgebra.ValueVector.html#978" class="Function">Value</a> <a id="1236" class="Symbol">→</a> <a id="1238" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
        <a id="1251" href="Ledger.TokenAlgebra.ValueVector.html#1223" class="Function">coin</a> <a id="1256" class="Symbol">=</a> <a id="1258" href="Data.Product.Base.html#636" class="Field">proj₁</a>
  
        <a id="1275" href="Ledger.TokenAlgebra.ValueVector.html#1275" class="Function">inject</a> <a id="1282" class="Symbol">:</a> <a id="1284" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1289" class="Symbol">→</a> <a id="1291" href="Ledger.TokenAlgebra.ValueVector.html#978" class="Function">Value</a>
        <a id="1305" href="Ledger.TokenAlgebra.ValueVector.html#1275" class="Function">inject</a> <a id="1312" href="Ledger.TokenAlgebra.ValueVector.html#1312" class="Bound">c</a> <a id="1314" class="Symbol">=</a> <a id="1316" href="Ledger.TokenAlgebra.ValueVector.html#1312" class="Bound">c</a> <a id="1318" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1320" href="Data.Vec.Base.html#6493" class="Function">Vec.replicate</a> <a id="1334" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a> <a id="1336" class="Number">0</a>
  
        <a id="1349" href="Ledger.TokenAlgebra.ValueVector.html#1349" class="Function">policies</a>                   <a id="1376" class="Symbol">=</a> <a id="1378" class="Symbol">λ</a> <a id="1380" href="Ledger.TokenAlgebra.ValueVector.html#1380" class="Bound">_</a> <a id="1382" class="Symbol">→</a> <a id="1384" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1393" class="Symbol">(</a><a id="1394" href="Data.Vec.Base.html#8402" class="Function">toList</a> <a id="1401" href="Ledger.TokenAlgebra.ValueVector.html#834" class="Bound">Policies</a><a id="1409" class="Symbol">)</a>
        <a id="1419" href="Ledger.TokenAlgebra.ValueVector.html#1419" class="Function">size</a>                       <a id="1446" class="Symbol">=</a> <a id="1448" class="Symbol">λ</a> <a id="1450" href="Ledger.TokenAlgebra.ValueVector.html#1450" class="Bound">_</a> <a id="1452" class="Symbol">→</a> <a id="1454" class="Number">1</a> <a id="1456" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1458" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a>
        <a id="1468" href="Ledger.TokenAlgebra.ValueVector.html#1468" class="Function Operator">_≤ᵗ_</a>                       <a id="1495" class="Symbol">=</a> <a id="1497" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html#1147" class="Function">Product.Pointwise</a> <a id="1515" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤_</a> <a id="1519" class="Symbol">(</a><a id="1520" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#1434" class="Datatype">Vec.Pointwise</a> <a id="1534" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤_</a><a id="1537" class="Symbol">)</a>

        <a id="1548" href="Ledger.TokenAlgebra.ValueVector.html#1548" class="Function">coin∘inject≗id</a>             <a id="1575" class="Symbol">=</a> <a id="1577" class="Symbol">λ</a> <a id="1579" href="Ledger.TokenAlgebra.ValueVector.html#1579" class="Bound">_</a> <a id="1581" class="Symbol">→</a> <a id="1583" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
        <a id="1596" href="Ledger.TokenAlgebra.ValueVector.html#1596" class="Function">coinIsMonoidHomomorphism</a>   <a id="1623" class="Symbol">=</a> <a id="1625" href="stdlib.Algebra.Morphism.Construct.DirectProduct.html#1168" class="Function">isMonoidHomomorphism</a> <a id="1646" href="Algebra.Bundles.html#7708" class="Function">+-0-commutativeMonoid.rawMonoid</a> <a id="1678" href="Algebra.Bundles.html#7708" class="Function">Vec-commutativeMonoid.rawMonoid</a> <a id="1710" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

        <a id="1724" href="Ledger.TokenAlgebra.ValueVector.html#1724" class="Function">Dec-≤ᵗ</a> <a id="1731" class="Symbol">:</a> <a id="1733" href="Ledger.TokenAlgebra.ValueVector.html#1468" class="Function Operator">_≤ᵗ_</a> <a id="1738" href="Class.Decidable.Core.html#773" class="Function Operator">⁇²</a>
        <a id="1749" href="Ledger.TokenAlgebra.ValueVector.html#1724" class="Function">Dec-≤ᵗ</a> <a id="1756" class="Symbol">{(</a><a id="1758" href="Ledger.TokenAlgebra.ValueVector.html#1758" class="Bound">c₁</a> <a id="1761" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1763" href="Ledger.TokenAlgebra.ValueVector.html#1763" class="Bound">v₁</a><a id="1765" class="Symbol">)}</a> <a id="1768" class="Symbol">{(</a><a id="1770" href="Ledger.TokenAlgebra.ValueVector.html#1770" class="Bound">c₂</a> <a id="1773" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1775" href="Ledger.TokenAlgebra.ValueVector.html#1775" class="Bound">v₂</a><a id="1777" class="Symbol">)}</a> <a id="1780" class="Symbol">=</a> <a id="1782" href="Class.Decidable.Instances.html#567" class="Function">Dec-×</a> <a id="1788" class="Symbol">⦃</a> <a id="1790" href="Class.Decidable.Instances.html#2218" class="Function">ℕ-Dec-≤</a> <a id="1798" class="Symbol">⦄</a> <a id="1800" class="Symbol">⦃</a> <a id="1802" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1804" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#3736" class="Function">Vec.decidable</a> <a id="1818" href="Class.Decidable.Core.html#1102" class="Function">dec²</a> <a id="1823" href="Ledger.TokenAlgebra.ValueVector.html#1763" class="Bound">v₁</a> <a id="1826" href="Ledger.TokenAlgebra.ValueVector.html#1775" class="Bound">v₂</a> <a id="1829" class="Symbol">⦄</a>
</pre></body></html>