<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.TokenAlgebra.ValueVector</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">open</a> <a id="29" class="Keyword">import</a> <a id="36" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="51" class="Keyword">hiding</a> <a id="58" class="Symbol">(</a><a id="59" href="Interface.STS.html#131" class="Function Operator">_∙_</a><a id="62" class="Symbol">;</a> <a id="64" href="Class.Monoid.Core.html#195" class="Field">ε</a><a id="65" class="Symbol">)</a>

<a id="68" class="Keyword">module</a> <a id="75" href="Ledger.TokenAlgebra.ValueVector.html" class="Module">Ledger.TokenAlgebra.ValueVector</a> <a id="107" class="Symbol">(</a><a id="108" href="Ledger.TokenAlgebra.ValueVector.html#108" class="Bound">PolicyId</a> <a id="117" class="Symbol">:</a> <a id="119" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="123" class="Symbol">)</a> <a id="125" class="Symbol">(</a><a id="126" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a> <a id="128" class="Symbol">:</a> <a id="130" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="131" class="Symbol">)</a> <a id="133" class="Keyword">where</a>

<a id="140" class="Keyword">import</a> <a id="147" href="Algebra.html" class="Module">Algebra</a> <a id="155" class="Symbol">as</a> <a id="158" class="Module">Alg</a>
<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="Algebra.Morphism.Construct.DirectProduct.Ext.html" class="Module">Algebra.Morphism.Construct.DirectProduct.Ext</a>
<a id="219" class="Keyword">open</a> <a id="224" class="Keyword">import</a> <a id="231" href="Algebra.Construct.DirectProduct.html" class="Module">Algebra.Construct.DirectProduct</a>
<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="295" class="Keyword">using</a> <a id="301" class="Symbol">(</a><a id="302" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a><a id="323" class="Symbol">)</a>
<a id="325" class="Keyword">import</a> <a id="332" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html" class="Module">Data.Product.Relation.Binary.Pointwise.NonDependent</a> <a id="384" class="Symbol">as</a> <a id="387" class="Module">Product</a>
<a id="395" class="Keyword">open</a> <a id="400" class="Keyword">import</a> <a id="407" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="416" class="Symbol">as</a> <a id="419" class="Module">Vec</a>
  <a id="425" class="Keyword">hiding</a> <a id="432" class="Symbol">(</a><a id="433" href="Data.Vec.Base.html#8496" class="Function">fromList</a><a id="441" class="Symbol">)</a>
<a id="443" class="Keyword">import</a> <a id="450" href="Data.Vec.Instances.Ext.html" class="Module">Data.Vec.Instances.Ext</a> <a id="473" class="Symbol">as</a> <a id="476" class="Module">Vec</a>
<a id="480" class="Keyword">import</a> <a id="487" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Binary.Pointwise.Inductive</a> <a id="532" class="Symbol">as</a> <a id="535" class="Module">Vec</a>

<a id="540" class="Keyword">open</a> <a id="545" class="Keyword">import</a> <a id="552" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="572" href="Ledger.TokenAlgebra.ValueVector.html#108" class="Bound">PolicyId</a>

<a id="Quantity"></a><a id="582" href="Ledger.TokenAlgebra.ValueVector.html#582" class="Function">Quantity</a> <a id="591" class="Symbol">=</a> <a id="593" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Vec-commutativeMonoid"></a><a id="596" href="Ledger.TokenAlgebra.ValueVector.html#596" class="Function">Vec-commutativeMonoid</a> <a id="618" class="Symbol">=</a> <a id="620" href="Data.Vec.Instances.Ext.html#3627" class="Function">Vec.commutativeMonoid</a> <a id="642" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a> <a id="644" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>

<a id="667" class="Keyword">module</a> <a id="+-0-commutativeMonoid"></a><a id="674" href="Ledger.TokenAlgebra.ValueVector.html#674" class="Module">+-0-commutativeMonoid</a> <a id="696" class="Symbol">=</a> <a id="698" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="720" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>
<a id="742" class="Keyword">module</a> <a id="Vec-commutativeMonoid"></a><a id="749" href="Ledger.TokenAlgebra.ValueVector.html#749" class="Module">Vec-commutativeMonoid</a> <a id="771" class="Symbol">=</a> <a id="773" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="795" href="Ledger.TokenAlgebra.ValueVector.html#596" class="Function">Vec-commutativeMonoid</a>

<a id="818" class="Keyword">module</a> <a id="825" href="Ledger.TokenAlgebra.ValueVector.html#825" class="Module">_</a> <a id="827" class="Symbol">(</a><a id="828" href="Ledger.TokenAlgebra.ValueVector.html#828" class="Bound">Policies</a> <a id="837" class="Symbol">:</a> <a id="839" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="843" href="Ledger.TokenAlgebra.ValueVector.html#108" class="Bound">PolicyId</a> <a id="852" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a><a id="853" class="Symbol">)</a> <a id="855" class="Keyword">where</a>
  <a id="863" href="Ledger.TokenAlgebra.ValueVector.html#863" class="Function">Value-TokenAlgebra</a> <a id="882" class="Symbol">:</a> <a id="884" href="Ledger.TokenAlgebra.html#453" class="Record">TokenAlgebra</a>
  <a id="899" href="Ledger.TokenAlgebra.ValueVector.html#863" class="Function">Value-TokenAlgebra</a> <a id="918" class="Symbol">=</a> <a id="920" class="Keyword">record</a> <a id="927" class="Symbol">{</a><a id="928" href="Ledger.TokenAlgebra.ValueVector.html#955" class="Module">go</a><a id="930" class="Symbol">}</a>
    <a id="936" class="Keyword">where</a>
      <a id="948" class="Keyword">module</a> <a id="955" href="Ledger.TokenAlgebra.ValueVector.html#955" class="Module">go</a> <a id="958" class="Keyword">where</a>
        <a id="972" href="Ledger.TokenAlgebra.ValueVector.html#972" class="Function">Value</a> <a id="978" class="Symbol">:</a> <a id="980" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="993" href="Ledger.TokenAlgebra.ValueVector.html#972" class="Function">Value</a> <a id="999" class="Symbol">=</a> <a id="1001" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1006" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1008" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="1012" href="Ledger.TokenAlgebra.ValueVector.html#582" class="Function">Quantity</a> <a id="1021" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a>

        <a id="1032" href="Ledger.TokenAlgebra.ValueVector.html#1032" class="Function">Value-CommutativeMonoid</a> <a id="1056" class="Symbol">:</a> <a id="1058" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="1076" href="Level.html#521" class="Function">0ℓ</a> <a id="1079" href="Level.html#521" class="Function">0ℓ</a> <a id="1082" href="Ledger.TokenAlgebra.ValueVector.html#972" class="Function">Value</a>
        <a id="1096" href="Ledger.TokenAlgebra.ValueVector.html#1032" class="Function">Value-CommutativeMonoid</a> <a id="1120" class="Symbol">=</a> <a id="1122" href="Class.CommutativeMonoid.Core.html#639" class="Function">Conversion.fromBundle</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Algebra.Construct.DirectProduct.html#7719" class="Function">commutativeMonoid</a> <a id="1163" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a> <a id="1185" href="Ledger.TokenAlgebra.ValueVector.html#596" class="Function">Vec-commutativeMonoid</a><a id="1206" class="Symbol">)</a>

        <a id="1217" href="Ledger.TokenAlgebra.ValueVector.html#1217" class="Function">coin</a> <a id="1222" class="Symbol">:</a> <a id="1224" href="Ledger.TokenAlgebra.ValueVector.html#972" class="Function">Value</a> <a id="1230" class="Symbol">→</a> <a id="1232" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
        <a id="1245" href="Ledger.TokenAlgebra.ValueVector.html#1217" class="Function">coin</a> <a id="1250" class="Symbol">=</a> <a id="1252" href="Data.Product.Base.html#636" class="Field">proj₁</a>
  
        <a id="1269" href="Ledger.TokenAlgebra.ValueVector.html#1269" class="Function">inject</a> <a id="1276" class="Symbol">:</a> <a id="1278" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="1283" class="Symbol">→</a> <a id="1285" href="Ledger.TokenAlgebra.ValueVector.html#972" class="Function">Value</a>
        <a id="1299" href="Ledger.TokenAlgebra.ValueVector.html#1269" class="Function">inject</a> <a id="1306" href="Ledger.TokenAlgebra.ValueVector.html#1306" class="Bound">c</a> <a id="1308" class="Symbol">=</a> <a id="1310" href="Ledger.TokenAlgebra.ValueVector.html#1306" class="Bound">c</a> <a id="1312" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1314" href="Data.Vec.Base.html#6493" class="Function">Vec.replicate</a> <a id="1328" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a> <a id="1330" class="Number">0</a>
  
        <a id="1343" href="Ledger.TokenAlgebra.ValueVector.html#1343" class="Function">policies</a>                   <a id="1370" class="Symbol">=</a> <a id="1372" class="Symbol">λ</a> <a id="1374" href="Ledger.TokenAlgebra.ValueVector.html#1374" class="Bound">_</a> <a id="1376" class="Symbol">→</a> <a id="1378" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1387" class="Symbol">(</a><a id="1388" href="Data.Vec.Base.html#8402" class="Function">toList</a> <a id="1395" href="Ledger.TokenAlgebra.ValueVector.html#828" class="Bound">Policies</a><a id="1403" class="Symbol">)</a>
        <a id="1413" href="Ledger.TokenAlgebra.ValueVector.html#1413" class="Function">size</a>                       <a id="1440" class="Symbol">=</a> <a id="1442" class="Symbol">λ</a> <a id="1444" href="Ledger.TokenAlgebra.ValueVector.html#1444" class="Bound">_</a> <a id="1446" class="Symbol">→</a> <a id="1448" class="Number">1</a> <a id="1450" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1452" href="Ledger.TokenAlgebra.ValueVector.html#126" class="Bound">n</a>
        <a id="1462" href="Ledger.TokenAlgebra.ValueVector.html#1462" class="Function Operator">_≤ᵗ_</a>                       <a id="1489" class="Symbol">=</a> <a id="1491" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html#1147" class="Function">Product.Pointwise</a> <a id="1509" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤_</a> <a id="1513" class="Symbol">(</a><a id="1514" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#1434" class="Datatype">Vec.Pointwise</a> <a id="1528" href="Class.HasOrder.Core.html#608" class="Field Operator">_≤_</a><a id="1531" class="Symbol">)</a>

        <a id="1542" href="Ledger.TokenAlgebra.ValueVector.html#1542" class="Function">coin∘inject≗id</a>             <a id="1569" class="Symbol">=</a> <a id="1571" class="Symbol">λ</a> <a id="1573" href="Ledger.TokenAlgebra.ValueVector.html#1573" class="Bound">_</a> <a id="1575" class="Symbol">→</a> <a id="1577" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
        <a id="1590" href="Ledger.TokenAlgebra.ValueVector.html#1590" class="Function">coinIsMonoidHomomorphism</a>   <a id="1617" class="Symbol">=</a> <a id="1619" href="Algebra.Morphism.Construct.DirectProduct.Ext.html#1165" class="Function">isMonoidHomomorphism</a> <a id="1640" href="Algebra.Bundles.html#7708" class="Function">+-0-commutativeMonoid.rawMonoid</a> <a id="1672" href="Algebra.Bundles.html#7708" class="Function">Vec-commutativeMonoid.rawMonoid</a> <a id="1704" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

        <a id="1718" href="Ledger.TokenAlgebra.ValueVector.html#1718" class="Function">Dec-≤ᵗ</a> <a id="1725" class="Symbol">:</a> <a id="1727" href="Ledger.TokenAlgebra.ValueVector.html#1462" class="Function Operator">_≤ᵗ_</a> <a id="1732" href="Class.Decidable.Core.html#773" class="Function Operator">⁇²</a>
        <a id="1743" href="Ledger.TokenAlgebra.ValueVector.html#1718" class="Function">Dec-≤ᵗ</a> <a id="1750" class="Symbol">{(</a><a id="1752" href="Ledger.TokenAlgebra.ValueVector.html#1752" class="Bound">c₁</a> <a id="1755" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1757" href="Ledger.TokenAlgebra.ValueVector.html#1757" class="Bound">v₁</a><a id="1759" class="Symbol">)}</a> <a id="1762" class="Symbol">{(</a><a id="1764" href="Ledger.TokenAlgebra.ValueVector.html#1764" class="Bound">c₂</a> <a id="1767" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1769" href="Ledger.TokenAlgebra.ValueVector.html#1769" class="Bound">v₂</a><a id="1771" class="Symbol">)}</a> <a id="1774" class="Symbol">=</a> <a id="1776" href="Class.Decidable.Instances.html#567" class="Function">Dec-×</a> <a id="1782" class="Symbol">⦃</a> <a id="1784" href="Class.Decidable.Instances.html#2218" class="Function">ℕ-Dec-≤</a> <a id="1792" class="Symbol">⦄</a> <a id="1794" class="Symbol">⦃</a> <a id="1796" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1798" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#3736" class="Function">Vec.decidable</a> <a id="1812" href="Class.Decidable.Core.html#1102" class="Function">dec²</a> <a id="1817" href="Ledger.TokenAlgebra.ValueVector.html#1757" class="Bound">v₁</a> <a id="1820" href="Ledger.TokenAlgebra.ValueVector.html#1769" class="Bound">v₂</a> <a id="1823" class="Symbol">⦄</a>
</pre></body></html>