<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ScriptVerification.Lib</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="28" class="Keyword">hiding</a> <a id="35" class="Symbol">(</a><a id="36" href="Axiom.Set.html#5718" class="Function">fromList</a><a id="44" class="Symbol">;</a> <a id="46" href="Class.Monoid.Core.html#195" class="Field">ε</a><a id="47" class="Symbol">;</a> <a id="49" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="52" class="Symbol">);</a> <a id="55" class="Keyword">open</a> <a id="60" href="Interface.ComputationalRelation.html#2799" class="Module">Computational</a>
<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="ScriptVerification.Prelude.html" class="Module">ScriptVerification.Prelude</a>

<a id="114" class="Keyword">module</a> <a id="121" href="ScriptVerification.Lib.html" class="Module">ScriptVerification.Lib</a> <a id="144" class="Symbol">(</a><a id="145" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="147" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="149" class="Symbol">:</a> <a id="151" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="155" class="Symbol">)</a>
  <a id="159" class="Symbol">(</a><a id="160" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a> <a id="170" class="Symbol">:</a> <a id="172" href="ScriptVerification.Prelude.html#118" class="Record">ScriptImplementation</a> <a id="193" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="195" href="ScriptVerification.Lib.html#147" class="Bound">D</a><a id="196" class="Symbol">)</a> <a id="198" class="Symbol">(</a><a id="199" class="Keyword">open</a> <a id="204" href="ScriptVerification.Prelude.html#118" class="Module">ScriptImplementation</a> <a id="225" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a><a id="234" class="Symbol">)</a>
  <a id="238" class="Keyword">where</a>

<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="ScriptVerification.LedgerImplementation.html" class="Module">ScriptVerification.LedgerImplementation</a> <a id="297" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="299" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="301" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Ledger.ScriptValidation.html" class="Module">Ledger.ScriptValidation</a> <a id="347" href="ScriptVerification.LedgerImplementation.html#4155" class="Function">SVTransactionStructure</a> <a id="370" href="ScriptVerification.LedgerImplementation.html#4724" class="Function">SVAbstractFunctions</a>
<a id="390" class="Keyword">open</a> <a id="395" class="Keyword">import</a> <a id="402" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="456" href="ScriptVerification.LedgerImplementation.html#4155" class="Function">SVTransactionStructure</a> <a id="479" href="ScriptVerification.LedgerImplementation.html#4724" class="Function">SVAbstractFunctions</a>
<a id="499" class="Keyword">open</a> <a id="504" class="Keyword">import</a> <a id="511" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a>
<a id="530" class="Keyword">open</a> <a id="535" href="Ledger.Transaction.html#840" class="Module">TransactionStructure</a> <a id="556" href="ScriptVerification.LedgerImplementation.html#4155" class="Function">SVTransactionStructure</a>
<a id="579" class="Keyword">open</a> <a id="584" class="Keyword">import</a> <a id="591" href="Ledger.Types.Epoch.html" class="Module">Ledger.Types.Epoch</a>
<a id="610" class="Keyword">open</a> <a id="615" class="Keyword">import</a> <a id="622" href="Ledger.Types.Numeric.html" class="Module">Ledger.Types.Numeric</a> <a id="643" class="Keyword">using</a> <a id="649" class="Symbol">(</a><a id="650" href="Ledger.Types.Numeric.UnitInterval.html#2789" class="Function">mkUnitInterval</a><a id="664" class="Symbol">)</a>
<a id="666" class="Keyword">open</a> <a id="671" href="Ledger.Types.Epoch.html#475" class="Module">EpochStructure</a> <a id="686" href="ScriptVerification.LedgerImplementation.html#2152" class="Function">SVEpochStructure</a>
<a id="703" class="Keyword">open</a> <a id="708" class="Keyword">import</a> <a id="715" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="728" class="Keyword">using</a> <a id="734" class="Symbol">(</a><a id="735" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="736" class="Symbol">;</a> <a id="738" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a><a id="740" class="Symbol">)</a>
<a id="742" class="Keyword">open</a> <a id="747" class="Keyword">import</a> <a id="754" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="768" class="Keyword">using</a> <a id="774" class="Symbol">(</a><a id="775" href="Data.Rational.Base.html#4367" class="Function">½</a><a id="776" class="Symbol">;</a> <a id="778" href="Data.Rational.Base.html#4346" class="Function">1ℚ</a> <a id="781" class="Symbol">;</a> <a id="783" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="788" class="Symbol">;</a> <a id="790" href="Data.Rational.Base.html#3884" class="Function Operator">_/_</a><a id="793" class="Symbol">)</a>
<a id="795" class="Keyword">open</a> <a id="800" class="Keyword">import</a> <a id="807" href="Data.Nat.Coprimality.html" class="Module">Data.Nat.Coprimality</a> <a id="828" class="Keyword">using</a> <a id="834" class="Symbol">(</a><a id="835" href="Data.Nat.Coprimality.html#1190" class="Function">Coprime</a><a id="842" class="Symbol">;</a> <a id="844" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a><a id="857" class="Symbol">)</a>
<a id="859" class="Keyword">open</a> <a id="864" href="ScriptVerification.LedgerImplementation.html#1078" class="Module">Implementation</a>

<a id="createEnv"></a><a id="880" href="ScriptVerification.Lib.html#880" class="Function">createEnv</a> <a id="890" class="Symbol">:</a> <a id="892" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="894" class="Symbol">→</a> <a id="896" href="Ledger.Utxo.html#2353" class="Record">UTxOEnv</a>
<a id="904" href="ScriptVerification.Lib.html#880" class="Function">createEnv</a> <a id="914" href="ScriptVerification.Lib.html#914" class="Bound">s</a> <a id="916" class="Symbol">=</a> <a id="918" class="Keyword">record</a> <a id="925" class="Symbol">{</a> <a id="927" href="Ledger.Utxo.html#2386" class="Field">slot</a> <a id="932" class="Symbol">=</a> <a id="934" href="ScriptVerification.Lib.html#914" class="Bound">s</a> <a id="936" class="Symbol">;</a> <a id="938" href="Ledger.Utxo.html#2431" class="Field">treasury</a> <a id="947" class="Symbol">=</a> <a id="949" class="Number">0</a> <a id="951" class="Symbol">;</a>
                   <a id="972" href="Ledger.Utxo.html#2407" class="Field">pparams</a> <a id="980" class="Symbol">=</a> <a id="982" class="Keyword">record</a>
                               <a id="1020" class="Symbol">{</a> <a id="1022" href="Ledger.PParams.html#1609" class="Field">maxBlockSize</a> <a id="1035" class="Symbol">=</a> <a id="1037" class="Number">90112</a>
                               <a id="1074" class="Symbol">;</a> <a id="1076" href="Ledger.PParams.html#1651" class="Field">maxTxSize</a> <a id="1086" class="Symbol">=</a> <a id="1088" class="Number">16384</a>
                               <a id="1125" class="Symbol">;</a> <a id="1127" href="Ledger.PParams.html#1693" class="Field">maxHeaderSize</a> <a id="1141" class="Symbol">=</a> <a id="1143" class="Number">1100</a>
                               <a id="1179" class="Symbol">;</a> <a id="1181" href="Ledger.PParams.html#1831" class="Field">maxValSize</a> <a id="1192" class="Symbol">=</a> <a id="1194" class="Number">5000</a>
                               <a id="1230" class="Symbol">;</a> <a id="1232" href="Ledger.PParams.html#1873" class="Field">maxCollateralInputs</a> <a id="1252" class="Symbol">=</a> <a id="1254" class="Number">3</a>
                               <a id="1287" class="Symbol">;</a> <a id="1289" href="Ledger.PParams.html#1917" class="Field">pv</a> <a id="1292" class="Symbol">=</a> <a id="1294" class="Number">8</a> <a id="1296" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1298" class="Number">0</a>
                               <a id="1331" class="Symbol">;</a> <a id="1333" href="Ledger.PParams.html#1735" class="Field">maxTxExUnits</a> <a id="1346" class="Symbol">=</a> <a id="1348" class="Number">10000000000</a> <a id="1360" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1362" class="Number">14000000</a>
                               <a id="1402" class="Symbol">;</a> <a id="1404" href="Ledger.PParams.html#1783" class="Field">maxBlockExUnits</a> <a id="1420" class="Symbol">=</a> <a id="1422" class="Number">40000000000</a> <a id="1434" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1436" class="Number">62000000</a>
                               <a id="1476" class="Symbol">;</a> <a id="1478" href="Ledger.PParams.html#1992" class="Field">a</a> <a id="1480" class="Symbol">=</a> <a id="1482" class="Number">44</a>
                               <a id="1516" class="Symbol">;</a> <a id="1518" href="Ledger.PParams.html#2034" class="Field">b</a> <a id="1520" class="Symbol">=</a> <a id="1522" class="Number">155381</a>
                               <a id="1560" class="Symbol">;</a> <a id="1562" href="Ledger.PParams.html#2610" class="Field">minUTxOValue</a> <a id="1575" class="Symbol">=</a> <a id="1577" class="Number">0</a>
                               <a id="1610" class="Symbol">;</a> <a id="1612" href="Ledger.PParams.html#2121" class="Field">poolDeposit</a> <a id="1624" class="Symbol">=</a> <a id="1626" class="Number">500000000</a> <a id="1636" class="Comment">-- lovelace</a>
                               <a id="1679" class="Symbol">;</a> <a id="1681" href="Ledger.PParams.html#2076" class="Field">keyDeposit</a> <a id="1692" class="Symbol">=</a> <a id="1694" class="Number">500000000</a> <a id="1704" class="Comment">-- lovelace</a>
                               <a id="1747" class="Symbol">;</a> <a id="1749" href="Ledger.PParams.html#2166" class="Field">monetaryExpansion</a> <a id="1767" class="Symbol">=</a> <a id="1769" href="Ledger.Types.Numeric.UnitInterval.html#2789" class="Function">mkUnitInterval</a> <a id="1784" class="Symbol">(</a><a id="1785" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">+</a> <a id="1787" class="Number">3</a> <a id="1789" href="Data.Rational.Base.html#3884" class="Function Operator">/</a> <a id="1791" class="Number">1000</a><a id="1795" class="Symbol">)</a>
                               <a id="1828" class="Symbol">;</a> <a id="1830" href="Ledger.PParams.html#2236" class="Field">treasuryCut</a> <a id="1842" class="Symbol">=</a> <a id="1844" href="Ledger.Types.Numeric.UnitInterval.html#2789" class="Function">mkUnitInterval</a> <a id="1859" class="Symbol">(</a><a id="1860" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">+</a> <a id="1862" class="Number">2</a> <a id="1864" href="Data.Rational.Base.html#3884" class="Function Operator">/</a> <a id="1866" class="Number">10</a><a id="1868" class="Symbol">)</a>
                               <a id="1901" class="Symbol">;</a> <a id="1903" href="Ledger.PParams.html#2306" class="Field">coinsPerUTxOByte</a> <a id="1920" class="Symbol">=</a> <a id="1922" class="Number">0</a>  <a id="1925" class="Comment">--lovelace</a>
                               <a id="1967" class="Comment">-- ^^^ was 4310, but that value resulted in failed tests once</a>
                               <a id="2060" class="Comment">-- we replaced `minUTxOValue` with `coinsPerUTxOByte`; see `HelloWorld.agda`</a>
                               <a id="2168" class="Comment">-- line 153: `isSuccess succeedExample ≡ true`</a>
                               <a id="2246" class="Symbol">;</a> <a id="2248" href="Ledger.PParams.html#2398" class="Field">minFeeRefScriptCoinsPerByte</a> <a id="2276" class="Symbol">=</a> <a id="2278" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="2283" class="Number">15</a> <a id="2286" class="Number">1</a> <a id="2288" class="Symbol">(</a><a id="2289" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a> <a id="2303" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2307" class="Symbol">)</a> <a id="2309" class="Comment">-- see [1]</a>
                               <a id="2351" class="Symbol">;</a> <a id="2353" href="Ledger.PParams.html#2351" class="Field">prices</a> <a id="2360" class="Symbol">=</a> <a id="2362" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2365" class="Comment">-- fix this</a>
                               <a id="2408" class="Symbol">;</a> <a id="2410" href="Ledger.PParams.html#2440" class="Field">maxRefScriptSizePerTx</a> <a id="2432" class="Symbol">=</a> <a id="2434" class="Number">200</a> <a id="2438" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="2440" class="Number">1024</a> <a id="2445" class="Comment">-- 200KiB</a>
                               <a id="2486" class="Symbol">;</a> <a id="2488" href="Ledger.PParams.html#2482" class="Field">maxRefScriptSizePerBlock</a> <a id="2513" class="Symbol">=</a> <a id="2515" class="Number">1024</a> <a id="2520" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="2522" class="Number">1024</a> <a id="2527" class="Comment">-- 1MiB</a>
                               <a id="2566" class="Symbol">;</a> <a id="2568" href="Ledger.PParams.html#2524" class="Field">refScriptCostStride</a>  <a id="2589" class="Symbol">=</a> <a id="2591" class="Number">25</a>
                               <a id="2625" class="Symbol">;</a> <a id="2627" href="Ledger.PParams.html#2566" class="Field">refScriptCostMultiplier</a> <a id="2651" class="Symbol">=</a> <a id="2653" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="2658" class="Number">6</a> <a id="2660" class="Number">5</a> <a id="2662" class="Symbol">(</a><a id="2663" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a> <a id="2677" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2681" class="Symbol">)</a> <a id="2683" class="Comment">-- see [1]</a>
                               <a id="2725" class="Symbol">;</a> <a id="2727" href="Ledger.PParams.html#2770" class="Field">a0</a> <a id="2730" class="Symbol">=</a> <a id="2732" href="Data.Rational.Base.html#4346" class="Function">1ℚ</a> <a id="2735" class="Comment">-- don&#39;t know</a>
                               <a id="2780" class="Symbol">;</a> <a id="2782" href="Ledger.PParams.html#2682" class="Field">Emax</a> <a id="2787" class="Symbol">=</a> <a id="2789" class="Number">18</a>
                               <a id="2823" class="Symbol">;</a> <a id="2825" href="Ledger.PParams.html#2728" class="Field">nopt</a> <a id="2830" class="Symbol">=</a> <a id="2832" class="Number">0</a> <a id="2834" class="Comment">-- don&#39;t know</a>
                               <a id="2879" class="Symbol">;</a> <a id="2881" href="Ledger.PParams.html#2812" class="Field">collateralPercentage</a> <a id="2902" class="Symbol">=</a> <a id="2904" class="Number">150</a>
                               <a id="2939" class="Symbol">;</a> <a id="2941" href="Ledger.PParams.html#2948" class="Field">costmdls</a> <a id="2950" class="Symbol">=</a> <a id="2952" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2955" class="Comment">-- fix this</a>
                               <a id="2998" class="Symbol">;</a> <a id="3000" href="Ledger.PParams.html#3055" class="Field">drepThresholds</a> <a id="3015" class="Symbol">=</a> <a id="3017" class="Keyword">record</a> <a id="3024" class="Comment">-- unknown so setting all to 50%</a>
                                                    <a id="3109" class="Symbol">{</a> <a id="3111" href="Ledger.PParams.html#1452" class="Field">P1</a> <a id="3114" class="Symbol">=</a> <a id="3116" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3170" class="Symbol">;</a> <a id="3172" href="Ledger.PParams.html#1455" class="Field">P2a</a> <a id="3176" class="Symbol">=</a> <a id="3178" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3232" class="Symbol">;</a> <a id="3234" href="Ledger.PParams.html#1459" class="Field">P2b</a> <a id="3238" class="Symbol">=</a> <a id="3240" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3294" class="Symbol">;</a> <a id="3296" href="Ledger.PParams.html#1463" class="Field">P3</a> <a id="3299" class="Symbol">=</a> <a id="3301" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3355" class="Symbol">;</a> <a id="3357" href="Ledger.PParams.html#1466" class="Field">P4</a> <a id="3360" class="Symbol">=</a> <a id="3362" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3416" class="Symbol">;</a> <a id="3418" href="Ledger.PParams.html#1469" class="Field">P5a</a> <a id="3422" class="Symbol">=</a> <a id="3424" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3478" class="Symbol">;</a> <a id="3480" href="Ledger.PParams.html#1473" class="Field">P5b</a> <a id="3484" class="Symbol">=</a> <a id="3486" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3540" class="Symbol">;</a> <a id="3542" href="Ledger.PParams.html#1477" class="Field">P5c</a> <a id="3546" class="Symbol">=</a> <a id="3548" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3602" class="Symbol">;</a> <a id="3604" href="Ledger.PParams.html#1481" class="Field">P5d</a> <a id="3608" class="Symbol">=</a> <a id="3610" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3664" class="Symbol">;</a> <a id="3666" href="Ledger.PParams.html#1485" class="Field">P6</a> <a id="3669" class="Symbol">=</a> <a id="3671" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3725" class="Symbol">}</a>
                               <a id="3758" class="Symbol">;</a> <a id="3760" href="Ledger.PParams.html#3000" class="Field">poolThresholds</a> <a id="3775" class="Symbol">=</a> <a id="3777" class="Keyword">record</a>
                                                    <a id="3836" class="Symbol">{</a> <a id="3838" href="Ledger.PParams.html#1540" class="Field">Q1</a> <a id="3841" class="Symbol">=</a> <a id="3843" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3897" class="Symbol">;</a> <a id="3899" href="Ledger.PParams.html#1543" class="Field">Q2a</a> <a id="3903" class="Symbol">=</a> <a id="3905" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3959" class="Symbol">;</a> <a id="3961" href="Ledger.PParams.html#1547" class="Field">Q2b</a> <a id="3965" class="Symbol">=</a> <a id="3967" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4021" class="Symbol">;</a> <a id="4023" href="Ledger.PParams.html#1551" class="Field">Q4</a> <a id="4026" class="Symbol">=</a> <a id="4028" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4082" class="Symbol">;</a> <a id="4084" href="Ledger.PParams.html#1554" class="Field">Q5</a> <a id="4087" class="Symbol">=</a> <a id="4089" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4143" class="Symbol">}</a>
                               <a id="4176" class="Symbol">;</a> <a id="4178" href="Ledger.PParams.html#3194" class="Field">govActionLifetime</a> <a id="4196" class="Symbol">=</a> <a id="4198" class="Number">10</a> <a id="4201" class="Comment">-- unknown</a>
                               <a id="4243" class="Symbol">;</a> <a id="4245" href="Ledger.PParams.html#3236" class="Field">govActionDeposit</a> <a id="4262" class="Symbol">=</a> <a id="4264" class="Number">1000000</a> <a id="4272" class="Comment">-- unknown (set to 1 ada)</a>
                               <a id="4329" class="Symbol">;</a> <a id="4331" href="Ledger.PParams.html#3281" class="Field">drepDeposit</a> <a id="4343" class="Symbol">=</a> <a id="4345" class="Number">1000000</a> <a id="4353" class="Comment">-- unknown (set to 1 ada)</a>
                               <a id="4410" class="Symbol">;</a> <a id="4412" href="Ledger.PParams.html#3326" class="Field">drepActivity</a> <a id="4425" class="Symbol">=</a> <a id="4427" class="Number">13</a> <a id="4430" class="Comment">-- unknown</a>
                               <a id="4472" class="Symbol">;</a> <a id="4474" href="Ledger.PParams.html#3110" class="Field">ccMinSize</a> <a id="4484" class="Symbol">=</a> <a id="4486" class="Number">10</a> <a id="4489" class="Comment">-- unknown</a>
                               <a id="4531" class="Symbol">;</a> <a id="4533" href="Ledger.PParams.html#3152" class="Field">ccMaxTermLength</a> <a id="4549" class="Symbol">=</a> <a id="4551" class="Number">73</a> <a id="4554" class="Comment">-- unknown set to 1 year (73 epochs)</a>
                               <a id="4622" class="Symbol">}</a> <a id="4624" class="Symbol">}</a>

<a id="createUTxO"></a><a id="4627" href="ScriptVerification.Lib.html#4627" class="Function">createUTxO</a> <a id="4638" class="Symbol">:</a> <a id="4640" class="Symbol">(</a><a id="4641" href="ScriptVerification.Lib.html#4641" class="Bound">index</a> <a id="4647" class="Symbol">:</a> <a id="4649" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4650" class="Symbol">)</a>
           <a id="4663" class="Symbol">→</a> <a id="4665" class="Symbol">(</a><a id="4666" href="ScriptVerification.Lib.html#4666" class="Bound">wallet</a> <a id="4673" class="Symbol">:</a> <a id="4675" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4676" class="Symbol">)</a>
           <a id="4689" class="Symbol">→</a> <a id="4691" class="Symbol">(</a><a id="4692" href="ScriptVerification.Lib.html#4692" class="Bound">value</a> <a id="4698" class="Symbol">:</a> <a id="4700" href="Ledger.TokenAlgebra.html#492" class="Function">Value</a><a id="4705" class="Symbol">)</a>
           <a id="4718" class="Symbol">→</a> <a id="4720" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4726" class="Symbol">(</a><a id="4727" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="4729" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4731" href="Ledger.Script.html#1726" class="Function">DataHash</a><a id="4739" class="Symbol">)</a>
           <a id="4752" class="Symbol">→</a> <a id="4754" href="Ledger.Transaction.html#2270" class="Function">TxIn</a> <a id="4759" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4761" href="Ledger.Transaction.html#2293" class="Function">TxOut</a>
<a id="4767" href="ScriptVerification.Lib.html#4627" class="Function">createUTxO</a> <a id="4778" href="ScriptVerification.Lib.html#4778" class="Bound">index</a> <a id="4784" href="ScriptVerification.Lib.html#4784" class="Bound">wallet</a> <a id="4791" href="ScriptVerification.Lib.html#4791" class="Bound">value</a> <a id="4797" href="ScriptVerification.Lib.html#4797" class="Bound">d</a> <a id="4799" class="Symbol">=</a> <a id="4801" class="Symbol">(</a><a id="4802" href="ScriptVerification.Lib.html#4778" class="Bound">index</a> <a id="4808" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4810" href="ScriptVerification.Lib.html#4778" class="Bound">index</a><a id="4815" class="Symbol">)</a>
                                <a id="4849" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4851" class="Symbol">(</a><a id="4852" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="4857" class="Symbol">(</a><a id="4858" class="Keyword">record</a> <a id="4865" class="Symbol">{</a> <a id="4867" href="Ledger.Address.html#1131" class="Field">net</a> <a id="4871" class="Symbol">=</a> <a id="4873" class="Number">0</a> <a id="4875" class="Symbol">;</a> <a id="4877" href="Ledger.Address.html#1156" class="Field">pay</a> <a id="4881" class="Symbol">=</a> <a id="4883" href="Ledger.Address.html#299" class="InductiveConstructor">KeyHashObj</a> <a id="4894" href="ScriptVerification.Lib.html#4784" class="Bound">wallet</a> <a id="4901" class="Symbol">;</a> <a id="4903" href="Ledger.Address.html#1184" class="Field">stake</a> <a id="4909" class="Symbol">=</a> <a id="4911" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4916" class="Symbol">(</a><a id="4917" href="Ledger.Address.html#299" class="InductiveConstructor">KeyHashObj</a> <a id="4928" href="ScriptVerification.Lib.html#4784" class="Bound">wallet</a><a id="4934" class="Symbol">)</a> <a id="4936" class="Symbol">})</a>
                                  <a id="4973" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4975" href="ScriptVerification.Lib.html#4791" class="Bound">value</a> <a id="4981" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4983" href="ScriptVerification.Lib.html#4797" class="Bound">d</a> <a id="4985" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4987" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="4994" class="Symbol">)</a>

<a id="createInitUtxoState"></a><a id="4997" href="ScriptVerification.Lib.html#4997" class="Function">createInitUtxoState</a> <a id="5017" class="Symbol">:</a> <a id="5019" class="Symbol">(</a><a id="5020" href="ScriptVerification.Lib.html#5020" class="Bound">wallets</a> <a id="5028" class="Symbol">:</a> <a id="5030" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="5031" class="Symbol">)</a>
                    <a id="5053" class="Symbol">→</a> <a id="5055" class="Symbol">(</a><a id="5056" href="ScriptVerification.Lib.html#5056" class="Bound">value</a> <a id="5062" class="Symbol">:</a> <a id="5064" href="Ledger.TokenAlgebra.html#492" class="Function">Value</a><a id="5069" class="Symbol">)</a>
                    <a id="5091" class="Symbol">→</a> <a id="5093" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5098" class="Symbol">(</a><a id="5099" href="Ledger.Transaction.html#2270" class="Function">TxIn</a> <a id="5104" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5106" href="Ledger.Transaction.html#2293" class="Function">TxOut</a><a id="5111" class="Symbol">)</a>
<a id="5113" href="ScriptVerification.Lib.html#4997" class="Function">createInitUtxoState</a> <a id="5133" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="5138" href="ScriptVerification.Lib.html#5138" class="Bound">value</a> <a id="5144" class="Symbol">=</a> <a id="5146" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="5149" href="ScriptVerification.Lib.html#4997" class="Function">createInitUtxoState</a> <a id="5169" class="Symbol">(</a><a id="5170" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5174" href="ScriptVerification.Lib.html#5174" class="Bound">wallet</a><a id="5180" class="Symbol">)</a> <a id="5182" href="ScriptVerification.Lib.html#5182" class="Bound">value</a> <a id="5188" class="Symbol">=</a> <a id="5190" href="ScriptVerification.Lib.html#4627" class="Function">createUTxO</a> <a id="5201" class="Symbol">(</a><a id="5202" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5206" href="ScriptVerification.Lib.html#5174" class="Bound">wallet</a><a id="5212" class="Symbol">)</a> <a id="5214" class="Symbol">(</a><a id="5215" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5219" href="ScriptVerification.Lib.html#5174" class="Bound">wallet</a><a id="5225" class="Symbol">)</a> <a id="5227" href="ScriptVerification.Lib.html#5182" class="Bound">value</a> <a id="5233" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                                         <a id="5282" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5284" href="ScriptVerification.Lib.html#4997" class="Function">createInitUtxoState</a> <a id="5304" href="ScriptVerification.Lib.html#5174" class="Bound">wallet</a> <a id="5311" href="ScriptVerification.Lib.html#5182" class="Bound">value</a>

<a id="fromList&#39;"></a><a id="5318" href="ScriptVerification.Lib.html#5318" class="Function">fromList&#39;</a> <a id="5328" class="Symbol">:</a> <a id="5330" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5335" class="Symbol">(</a><a id="5336" href="Ledger.Transaction.html#2270" class="Function">TxIn</a> <a id="5341" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5343" href="Ledger.Transaction.html#2293" class="Function">TxOut</a><a id="5348" class="Symbol">)</a> <a id="5350" class="Symbol">→</a> <a id="5352" href="Ledger.Transaction.html#2361" class="Function">UTxO</a>
<a id="5357" href="ScriptVerification.Lib.html#5318" class="Function">fromList&#39;</a> <a id="5367" class="Symbol">=</a> <a id="5369" href="Axiom.Set.Map.html#2713" class="Function">fromListᵐ</a>

<a id="fromListIx"></a><a id="5380" href="ScriptVerification.Lib.html#5380" class="Function">fromListIx</a> <a id="5391" class="Symbol">:</a> <a id="5393" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5398" class="Symbol">(</a><a id="5399" href="ScriptVerification.LedgerImplementation.html#1890" class="Function">Implementation.Ix</a> <a id="5417" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5419" href="Ledger.Transaction.html#2293" class="Function">TxOut</a><a id="5424" class="Symbol">)</a> <a id="5426" class="Symbol">→</a> <a id="5428" href="ScriptVerification.LedgerImplementation.html#1890" class="Function">Implementation.Ix</a> <a id="5446" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="5448" href="Ledger.Transaction.html#2293" class="Function">TxOut</a>
<a id="5454" href="ScriptVerification.Lib.html#5380" class="Function">fromListIx</a> <a id="5465" class="Symbol">=</a> <a id="5467" href="Axiom.Set.Map.html#2713" class="Function">fromListᵐ</a>

<a id="applyScript"></a><a id="5478" href="ScriptVerification.Lib.html#5478" class="Function">applyScript</a> <a id="5490" class="Symbol">:</a> <a id="5492" class="Symbol">(</a><a id="5493" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5499" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5501" class="Symbol">→</a> <a id="5503" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5509" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5511" class="Symbol">→</a> <a id="5513" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="5517" class="Symbol">)</a> <a id="5519" class="Symbol">→</a> <a id="5521" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5526" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5528" class="Symbol">→</a> <a id="5530" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5535" href="ScriptVerification.Lib.html#5478" class="Function">applyScript</a> <a id="5547" href="ScriptVerification.Lib.html#5547" class="Bound">f</a> <a id="5549" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5552" class="Symbol">=</a> <a id="5554" href="ScriptVerification.Lib.html#5547" class="Bound">f</a> <a id="5556" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5564" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="5572" href="ScriptVerification.Lib.html#5478" class="Function">applyScript</a> <a id="5584" href="ScriptVerification.Lib.html#5584" class="Bound">f</a> <a id="5586" class="Symbol">(_</a> <a id="5589" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5591" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5593" class="Symbol">)</a> <a id="5595" class="Symbol">=</a> <a id="5597" href="ScriptVerification.Lib.html#5584" class="Bound">f</a> <a id="5599" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5607" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="5615" href="ScriptVerification.Lib.html#5478" class="Function">applyScript</a> <a id="5627" href="ScriptVerification.Lib.html#5627" class="Bound">f</a> <a id="5629" class="Symbol">(</a><a id="5630" href="ScriptVerification.Lib.html#5630" class="Bound">redeemer</a> <a id="5639" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5641" href="ScriptVerification.Lib.html#5641" class="Bound">valcontext</a> <a id="5652" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5654" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5656" class="Symbol">)</a> <a id="5658" class="Symbol">=</a> <a id="5660" href="ScriptVerification.Lib.html#5627" class="Bound">f</a> <a id="5662" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5670" class="Symbol">(</a><a id="5671" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5676" href="ScriptVerification.Lib.html#5630" class="Bound">redeemer</a><a id="5684" class="Symbol">)</a>
<a id="5686" href="ScriptVerification.Lib.html#5478" class="Function">applyScript</a> <a id="5698" href="ScriptVerification.Lib.html#5698" class="Bound">f</a> <a id="5700" class="Symbol">(</a><a id="5701" href="ScriptVerification.Lib.html#5701" class="Bound">datum</a> <a id="5707" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5709" href="ScriptVerification.Lib.html#5709" class="Bound">redeemer</a> <a id="5718" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5720" href="ScriptVerification.Lib.html#5720" class="Bound">valcontext</a> <a id="5731" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5733" class="Symbol">_)</a> <a id="5736" class="Symbol">=</a> <a id="5738" href="ScriptVerification.Lib.html#5698" class="Bound">f</a> <a id="5740" class="Symbol">(</a><a id="5741" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5746" href="ScriptVerification.Lib.html#5701" class="Bound">datum</a><a id="5751" class="Symbol">)</a> <a id="5753" class="Symbol">(</a><a id="5754" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5759" href="ScriptVerification.Lib.html#5709" class="Bound">redeemer</a><a id="5767" class="Symbol">)</a>

<a id="notEmpty"></a><a id="5770" href="ScriptVerification.Lib.html#5770" class="Function">notEmpty</a> <a id="5779" class="Symbol">:</a> <a id="5781" class="Symbol">∀</a> <a id="5783" class="Symbol">{</a><a id="5784" href="ScriptVerification.Lib.html#5784" class="Bound">A</a> <a id="5786" class="Symbol">:</a> <a id="5788" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="5792" class="Symbol">}</a> <a id="5794" class="Symbol">→</a> <a id="5796" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5801" href="ScriptVerification.Lib.html#5784" class="Bound">A</a> <a id="5803" class="Symbol">→</a> <a id="5805" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="5810" href="ScriptVerification.Lib.html#5770" class="Function">notEmpty</a> <a id="5819" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5822" class="Symbol">=</a> <a id="5824" href="Data.Empty.html#914" class="Function">⊥</a>
<a id="5826" href="ScriptVerification.Lib.html#5770" class="Function">notEmpty</a> <a id="5835" class="Symbol">(</a><a id="5836" href="ScriptVerification.Lib.html#5836" class="Bound">x</a> <a id="5838" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5840" href="ScriptVerification.Lib.html#5840" class="Bound">xs</a><a id="5842" class="Symbol">)</a> <a id="5844" class="Symbol">=</a> <a id="5846" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>

<a id="isSuccess"></a><a id="5849" href="ScriptVerification.Lib.html#5849" class="Function">isSuccess</a> <a id="5859" class="Symbol">:</a> <a id="5861" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="5879" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="5886" href="Ledger.Utxo.html#2705" class="Record">UTxOState</a> <a id="5896" class="Symbol">→</a> <a id="5898" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5903" href="ScriptVerification.Lib.html#5849" class="Function">isSuccess</a> <a id="5913" class="Symbol">(</a><a id="5914" href="Interface.ComputationalRelation.html#308" class="InductiveConstructor">success</a> <a id="5922" href="ScriptVerification.Lib.html#5922" class="Bound">x</a><a id="5923" class="Symbol">)</a> <a id="5925" class="Symbol">=</a> <a id="5927" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="5932" href="ScriptVerification.Lib.html#5849" class="Function">isSuccess</a> <a id="5942" class="Symbol">(</a><a id="5943" href="Interface.ComputationalRelation.html#348" class="InductiveConstructor">failure</a> <a id="5951" href="ScriptVerification.Lib.html#5951" class="Bound">x</a><a id="5952" class="Symbol">)</a> <a id="5954" class="Symbol">=</a> <a id="5956" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="5963" class="Comment">-- [1] https://github.com/IntersectMBO/cardano-ledger/blob/master/docs/adr/2024-08-14_009-refscripts-fee-change.md</a>
</pre></body></html>