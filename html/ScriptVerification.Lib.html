<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ScriptVerification.Lib</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="28" class="Keyword">hiding</a> <a id="35" class="Symbol">(</a><a id="36" href="Axiom.Set.html#5718" class="Function">fromList</a><a id="44" class="Symbol">;</a> <a id="46" href="Class.Monoid.Core.html#195" class="Field">ε</a><a id="47" class="Symbol">;</a> <a id="49" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="52" class="Symbol">);</a> <a id="55" class="Keyword">open</a> <a id="60" href="Interface.ComputationalRelation.html#2799" class="Module">Computational</a>
<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="ScriptVerification.Prelude.html" class="Module">ScriptVerification.Prelude</a>

<a id="114" class="Keyword">module</a> <a id="121" href="ScriptVerification.Lib.html" class="Module">ScriptVerification.Lib</a> <a id="144" class="Symbol">(</a><a id="145" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="147" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="149" class="Symbol">:</a> <a id="151" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="155" class="Symbol">)</a>
  <a id="159" class="Symbol">(</a><a id="160" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a> <a id="170" class="Symbol">:</a> <a id="172" href="ScriptVerification.Prelude.html#118" class="Record">ScriptImplementation</a> <a id="193" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="195" href="ScriptVerification.Lib.html#147" class="Bound">D</a><a id="196" class="Symbol">)</a> <a id="198" class="Symbol">(</a><a id="199" class="Keyword">open</a> <a id="204" href="ScriptVerification.Prelude.html#118" class="Module">ScriptImplementation</a> <a id="225" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a><a id="234" class="Symbol">)</a>
  <a id="238" class="Keyword">where</a>

<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="ScriptVerification.LedgerImplementation.html" class="Module">ScriptVerification.LedgerImplementation</a> <a id="297" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="299" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="301" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Ledger.Conway.ScriptValidation.html" class="Module">Ledger.Conway.ScriptValidation</a> <a id="354" href="ScriptVerification.LedgerImplementation.html#4211" class="Function">SVTransactionStructure</a> <a id="377" href="ScriptVerification.LedgerImplementation.html#4794" class="Function">SVAbstractFunctions</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="463" href="ScriptVerification.LedgerImplementation.html#4211" class="Function">SVTransactionStructure</a> <a id="486" href="ScriptVerification.LedgerImplementation.html#4794" class="Function">SVAbstractFunctions</a>
<a id="506" class="Keyword">open</a> <a id="511" class="Keyword">import</a> <a id="518" href="Ledger.Conway.Transaction.html" class="Module">Ledger.Conway.Transaction</a>
<a id="544" class="Keyword">open</a> <a id="549" href="Ledger.Conway.Transaction.html#910" class="Module">TransactionStructure</a> <a id="570" href="ScriptVerification.LedgerImplementation.html#4211" class="Function">SVTransactionStructure</a>
<a id="593" class="Keyword">open</a> <a id="598" class="Keyword">import</a> <a id="605" href="Ledger.Conway.Types.Epoch.html" class="Module">Ledger.Conway.Types.Epoch</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Ledger.Conway.Types.Numeric.html" class="Module">Ledger.Conway.Types.Numeric</a> <a id="671" class="Keyword">using</a> <a id="677" class="Symbol">(</a><a id="678" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a><a id="692" class="Symbol">)</a>
<a id="694" class="Keyword">open</a> <a id="699" href="Ledger.Conway.Types.Epoch.html#524" class="Module">EpochStructure</a> <a id="714" href="ScriptVerification.LedgerImplementation.html#2187" class="Function">SVEpochStructure</a>
<a id="731" class="Keyword">open</a> <a id="736" class="Keyword">import</a> <a id="743" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="756" class="Keyword">using</a> <a id="762" class="Symbol">(</a><a id="763" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="764" class="Symbol">;</a> <a id="766" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a><a id="768" class="Symbol">)</a>
<a id="770" class="Keyword">open</a> <a id="775" class="Keyword">import</a> <a id="782" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="796" class="Keyword">using</a> <a id="802" class="Symbol">(</a><a id="803" href="Data.Rational.Base.html#4367" class="Function">½</a><a id="804" class="Symbol">;</a> <a id="806" href="Data.Rational.Base.html#4346" class="Function">1ℚ</a> <a id="809" class="Symbol">;</a> <a id="811" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="816" class="Symbol">;</a> <a id="818" href="Data.Rational.Base.html#3884" class="Function Operator">_/_</a><a id="821" class="Symbol">)</a>
<a id="823" class="Keyword">open</a> <a id="828" class="Keyword">import</a> <a id="835" href="Data.Nat.Coprimality.html" class="Module">Data.Nat.Coprimality</a> <a id="856" class="Keyword">using</a> <a id="862" class="Symbol">(</a><a id="863" href="Data.Nat.Coprimality.html#1190" class="Function">Coprime</a><a id="870" class="Symbol">;</a> <a id="872" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a><a id="885" class="Symbol">)</a>
<a id="887" class="Keyword">open</a> <a id="892" href="ScriptVerification.LedgerImplementation.html#1106" class="Module">Implementation</a>

<a id="createEnv"></a><a id="908" href="ScriptVerification.Lib.html#908" class="Function">createEnv</a> <a id="918" class="Symbol">:</a> <a id="920" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="922" class="Symbol">→</a> <a id="924" href="Ledger.Conway.Utxo.html#2395" class="Record">UTxOEnv</a>
<a id="932" href="ScriptVerification.Lib.html#908" class="Function">createEnv</a> <a id="942" href="ScriptVerification.Lib.html#942" class="Bound">s</a> <a id="944" class="Symbol">=</a> <a id="946" class="Keyword">record</a> <a id="953" class="Symbol">{</a> <a id="955" href="Ledger.Conway.Utxo.html#2428" class="Field">slot</a> <a id="960" class="Symbol">=</a> <a id="962" href="ScriptVerification.Lib.html#942" class="Bound">s</a> <a id="964" class="Symbol">;</a> <a id="966" href="Ledger.Conway.Utxo.html#2473" class="Field">treasury</a> <a id="975" class="Symbol">=</a> <a id="977" class="Number">0</a> <a id="979" class="Symbol">;</a>
                   <a id="1000" href="Ledger.Conway.Utxo.html#2449" class="Field">pparams</a> <a id="1008" class="Symbol">=</a> <a id="1010" class="Keyword">record</a>
                               <a id="1048" class="Symbol">{</a> <a id="1050" href="Ledger.Conway.PParams.html#1756" class="Field">maxBlockSize</a> <a id="1063" class="Symbol">=</a> <a id="1065" class="Number">90112</a>
                               <a id="1102" class="Symbol">;</a> <a id="1104" href="Ledger.Conway.PParams.html#1798" class="Field">maxTxSize</a> <a id="1114" class="Symbol">=</a> <a id="1116" class="Number">16384</a>
                               <a id="1153" class="Symbol">;</a> <a id="1155" href="Ledger.Conway.PParams.html#1840" class="Field">maxHeaderSize</a> <a id="1169" class="Symbol">=</a> <a id="1171" class="Number">1100</a>
                               <a id="1207" class="Symbol">;</a> <a id="1209" href="Ledger.Conway.PParams.html#1978" class="Field">maxValSize</a> <a id="1220" class="Symbol">=</a> <a id="1222" class="Number">5000</a>
                               <a id="1258" class="Symbol">;</a> <a id="1260" href="Ledger.Conway.PParams.html#2020" class="Field">maxCollateralInputs</a> <a id="1280" class="Symbol">=</a> <a id="1282" class="Number">3</a>
                               <a id="1315" class="Symbol">;</a> <a id="1317" href="Ledger.Conway.PParams.html#2064" class="Field">pv</a> <a id="1320" class="Symbol">=</a> <a id="1322" class="Number">8</a> <a id="1324" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1326" class="Number">0</a>
                               <a id="1359" class="Symbol">;</a> <a id="1361" href="Ledger.Conway.PParams.html#1882" class="Field">maxTxExUnits</a> <a id="1374" class="Symbol">=</a> <a id="1376" class="Number">10000000000</a> <a id="1388" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1390" class="Number">14000000</a>
                               <a id="1430" class="Symbol">;</a> <a id="1432" href="Ledger.Conway.PParams.html#1930" class="Field">maxBlockExUnits</a> <a id="1448" class="Symbol">=</a> <a id="1450" class="Number">40000000000</a> <a id="1462" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1464" class="Number">62000000</a>
                               <a id="1504" class="Symbol">;</a> <a id="1506" href="Ledger.Conway.PParams.html#2139" class="Field">a</a> <a id="1508" class="Symbol">=</a> <a id="1510" class="Number">44</a>
                               <a id="1544" class="Symbol">;</a> <a id="1546" href="Ledger.Conway.PParams.html#2181" class="Field">b</a> <a id="1548" class="Symbol">=</a> <a id="1550" class="Number">155381</a>
                               <a id="1588" class="Symbol">;</a> <a id="1590" href="Ledger.Conway.PParams.html#2757" class="Field">minUTxOValue</a> <a id="1603" class="Symbol">=</a> <a id="1605" class="Number">0</a>
                               <a id="1638" class="Symbol">;</a> <a id="1640" href="Ledger.Conway.PParams.html#2268" class="Field">poolDeposit</a> <a id="1652" class="Symbol">=</a> <a id="1654" class="Number">500000000</a> <a id="1664" class="Comment">-- lovelace</a>
                               <a id="1707" class="Symbol">;</a> <a id="1709" href="Ledger.Conway.PParams.html#2223" class="Field">keyDeposit</a> <a id="1720" class="Symbol">=</a> <a id="1722" class="Number">500000000</a> <a id="1732" class="Comment">-- lovelace</a>
                               <a id="1775" class="Symbol">;</a> <a id="1777" href="Ledger.Conway.PParams.html#2313" class="Field">monetaryExpansion</a> <a id="1795" class="Symbol">=</a> <a id="1797" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a> <a id="1812" class="Symbol">(</a><a id="1813" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">+</a> <a id="1815" class="Number">3</a> <a id="1817" href="Data.Rational.Base.html#3884" class="Function Operator">/</a> <a id="1819" class="Number">1000</a><a id="1823" class="Symbol">)</a>
                               <a id="1856" class="Symbol">;</a> <a id="1858" href="Ledger.Conway.PParams.html#2383" class="Field">treasuryCut</a> <a id="1870" class="Symbol">=</a> <a id="1872" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a> <a id="1887" class="Symbol">(</a><a id="1888" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">+</a> <a id="1890" class="Number">2</a> <a id="1892" href="Data.Rational.Base.html#3884" class="Function Operator">/</a> <a id="1894" class="Number">10</a><a id="1896" class="Symbol">)</a>
                               <a id="1929" class="Symbol">;</a> <a id="1931" href="Ledger.Conway.PParams.html#2453" class="Field">coinsPerUTxOByte</a> <a id="1948" class="Symbol">=</a> <a id="1950" class="Number">0</a>  <a id="1953" class="Comment">--lovelace</a>
                               <a id="1995" class="Comment">-- ^^^ was 4310, but that value resulted in failed tests once</a>
                               <a id="2088" class="Comment">-- we replaced `minUTxOValue` with `coinsPerUTxOByte`; see `HelloWorld.agda`</a>
                               <a id="2196" class="Comment">-- line 153: `isSuccess succeedExample ≡ true`</a>
                               <a id="2274" class="Symbol">;</a> <a id="2276" href="Ledger.Conway.PParams.html#2545" class="Field">minFeeRefScriptCoinsPerByte</a> <a id="2304" class="Symbol">=</a> <a id="2306" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="2311" class="Number">15</a> <a id="2314" class="Number">1</a> <a id="2316" class="Symbol">(</a><a id="2317" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a> <a id="2331" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2335" class="Symbol">)</a> <a id="2337" class="Comment">-- see [1]</a>
                               <a id="2379" class="Symbol">;</a> <a id="2381" href="Ledger.Conway.PParams.html#2498" class="Field">prices</a> <a id="2388" class="Symbol">=</a> <a id="2390" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2393" class="Comment">-- fix this</a>
                               <a id="2436" class="Symbol">;</a> <a id="2438" href="Ledger.Conway.PParams.html#2587" class="Field">maxRefScriptSizePerTx</a> <a id="2460" class="Symbol">=</a> <a id="2462" class="Number">200</a> <a id="2466" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="2468" class="Number">1024</a> <a id="2473" class="Comment">-- 200KiB</a>
                               <a id="2514" class="Symbol">;</a> <a id="2516" href="Ledger.Conway.PParams.html#2629" class="Field">maxRefScriptSizePerBlock</a> <a id="2541" class="Symbol">=</a> <a id="2543" class="Number">1024</a> <a id="2548" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="2550" class="Number">1024</a> <a id="2555" class="Comment">-- 1MiB</a>
                               <a id="2594" class="Symbol">;</a> <a id="2596" href="Ledger.Conway.PParams.html#2671" class="Field">refScriptCostStride</a>  <a id="2617" class="Symbol">=</a> <a id="2619" class="Number">25</a>
                               <a id="2653" class="Symbol">;</a> <a id="2655" href="Ledger.Conway.PParams.html#2713" class="Field">refScriptCostMultiplier</a> <a id="2679" class="Symbol">=</a> <a id="2681" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="2686" class="Number">6</a> <a id="2688" class="Number">5</a> <a id="2690" class="Symbol">(</a><a id="2691" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a> <a id="2705" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2709" class="Symbol">)</a> <a id="2711" class="Comment">-- see [1]</a>
                               <a id="2753" class="Symbol">;</a> <a id="2755" href="Ledger.Conway.PParams.html#2917" class="Field">a0</a> <a id="2758" class="Symbol">=</a> <a id="2760" href="Data.Rational.Base.html#4346" class="Function">1ℚ</a> <a id="2763" class="Comment">-- don&#39;t know</a>
                               <a id="2808" class="Symbol">;</a> <a id="2810" href="Ledger.Conway.PParams.html#2829" class="Field">Emax</a> <a id="2815" class="Symbol">=</a> <a id="2817" class="Number">18</a>
                               <a id="2851" class="Symbol">;</a> <a id="2853" href="Ledger.Conway.PParams.html#2875" class="Field">nopt</a> <a id="2858" class="Symbol">=</a> <a id="2860" class="Number">0</a> <a id="2862" class="Comment">-- don&#39;t know</a>
                               <a id="2907" class="Symbol">;</a> <a id="2909" href="Ledger.Conway.PParams.html#2959" class="Field">collateralPercentage</a> <a id="2930" class="Symbol">=</a> <a id="2932" class="Number">150</a>
                               <a id="2967" class="Symbol">;</a> <a id="2969" href="Ledger.Conway.PParams.html#3095" class="Field">costmdls</a> <a id="2978" class="Symbol">=</a> <a id="2980" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2983" class="Comment">-- fix this</a>
                               <a id="3026" class="Symbol">;</a> <a id="3028" href="Ledger.Conway.PParams.html#3202" class="Field">drepThresholds</a> <a id="3043" class="Symbol">=</a> <a id="3045" class="Keyword">record</a> <a id="3052" class="Comment">-- unknown so setting all to 50%</a>
                                                    <a id="3137" class="Symbol">{</a> <a id="3139" href="Ledger.Conway.PParams.html#1599" class="Field">P1</a> <a id="3142" class="Symbol">=</a> <a id="3144" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3198" class="Symbol">;</a> <a id="3200" href="Ledger.Conway.PParams.html#1602" class="Field">P2a</a> <a id="3204" class="Symbol">=</a> <a id="3206" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3260" class="Symbol">;</a> <a id="3262" href="Ledger.Conway.PParams.html#1606" class="Field">P2b</a> <a id="3266" class="Symbol">=</a> <a id="3268" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3322" class="Symbol">;</a> <a id="3324" href="Ledger.Conway.PParams.html#1610" class="Field">P3</a> <a id="3327" class="Symbol">=</a> <a id="3329" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3383" class="Symbol">;</a> <a id="3385" href="Ledger.Conway.PParams.html#1613" class="Field">P4</a> <a id="3388" class="Symbol">=</a> <a id="3390" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3444" class="Symbol">;</a> <a id="3446" href="Ledger.Conway.PParams.html#1616" class="Field">P5a</a> <a id="3450" class="Symbol">=</a> <a id="3452" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3506" class="Symbol">;</a> <a id="3508" href="Ledger.Conway.PParams.html#1620" class="Field">P5b</a> <a id="3512" class="Symbol">=</a> <a id="3514" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3568" class="Symbol">;</a> <a id="3570" href="Ledger.Conway.PParams.html#1624" class="Field">P5c</a> <a id="3574" class="Symbol">=</a> <a id="3576" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3630" class="Symbol">;</a> <a id="3632" href="Ledger.Conway.PParams.html#1628" class="Field">P5d</a> <a id="3636" class="Symbol">=</a> <a id="3638" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3692" class="Symbol">;</a> <a id="3694" href="Ledger.Conway.PParams.html#1632" class="Field">P6</a> <a id="3697" class="Symbol">=</a> <a id="3699" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3753" class="Symbol">}</a>
                               <a id="3786" class="Symbol">;</a> <a id="3788" href="Ledger.Conway.PParams.html#3147" class="Field">poolThresholds</a> <a id="3803" class="Symbol">=</a> <a id="3805" class="Keyword">record</a>
                                                    <a id="3864" class="Symbol">{</a> <a id="3866" href="Ledger.Conway.PParams.html#1687" class="Field">Q1</a> <a id="3869" class="Symbol">=</a> <a id="3871" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3925" class="Symbol">;</a> <a id="3927" href="Ledger.Conway.PParams.html#1690" class="Field">Q2a</a> <a id="3931" class="Symbol">=</a> <a id="3933" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3987" class="Symbol">;</a> <a id="3989" href="Ledger.Conway.PParams.html#1694" class="Field">Q2b</a> <a id="3993" class="Symbol">=</a> <a id="3995" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4049" class="Symbol">;</a> <a id="4051" href="Ledger.Conway.PParams.html#1698" class="Field">Q4</a> <a id="4054" class="Symbol">=</a> <a id="4056" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4110" class="Symbol">;</a> <a id="4112" href="Ledger.Conway.PParams.html#1701" class="Field">Q5</a> <a id="4115" class="Symbol">=</a> <a id="4117" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4171" class="Symbol">}</a>
                               <a id="4204" class="Symbol">;</a> <a id="4206" href="Ledger.Conway.PParams.html#3341" class="Field">govActionLifetime</a> <a id="4224" class="Symbol">=</a> <a id="4226" class="Number">10</a> <a id="4229" class="Comment">-- unknown</a>
                               <a id="4271" class="Symbol">;</a> <a id="4273" href="Ledger.Conway.PParams.html#3383" class="Field">govActionDeposit</a> <a id="4290" class="Symbol">=</a> <a id="4292" class="Number">1000000</a> <a id="4300" class="Comment">-- unknown (set to 1 ada)</a>
                               <a id="4357" class="Symbol">;</a> <a id="4359" href="Ledger.Conway.PParams.html#3428" class="Field">drepDeposit</a> <a id="4371" class="Symbol">=</a> <a id="4373" class="Number">1000000</a> <a id="4381" class="Comment">-- unknown (set to 1 ada)</a>
                               <a id="4438" class="Symbol">;</a> <a id="4440" href="Ledger.Conway.PParams.html#3473" class="Field">drepActivity</a> <a id="4453" class="Symbol">=</a> <a id="4455" class="Number">13</a> <a id="4458" class="Comment">-- unknown</a>
                               <a id="4500" class="Symbol">;</a> <a id="4502" href="Ledger.Conway.PParams.html#3257" class="Field">ccMinSize</a> <a id="4512" class="Symbol">=</a> <a id="4514" class="Number">10</a> <a id="4517" class="Comment">-- unknown</a>
                               <a id="4559" class="Symbol">;</a> <a id="4561" href="Ledger.Conway.PParams.html#3299" class="Field">ccMaxTermLength</a> <a id="4577" class="Symbol">=</a> <a id="4579" class="Number">73</a> <a id="4582" class="Comment">-- unknown set to 1 year (73 epochs)</a>
                               <a id="4650" class="Symbol">}</a> <a id="4652" class="Symbol">}</a>

<a id="createUTxO"></a><a id="4655" href="ScriptVerification.Lib.html#4655" class="Function">createUTxO</a> <a id="4666" class="Symbol">:</a> <a id="4668" class="Symbol">(</a><a id="4669" href="ScriptVerification.Lib.html#4669" class="Bound">index</a> <a id="4675" class="Symbol">:</a> <a id="4677" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4678" class="Symbol">)</a>
           <a id="4691" class="Symbol">→</a> <a id="4693" class="Symbol">(</a><a id="4694" href="ScriptVerification.Lib.html#4694" class="Bound">wallet</a> <a id="4701" class="Symbol">:</a> <a id="4703" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4704" class="Symbol">)</a>
           <a id="4717" class="Symbol">→</a> <a id="4719" class="Symbol">(</a><a id="4720" href="ScriptVerification.Lib.html#4720" class="Bound">value</a> <a id="4726" class="Symbol">:</a> <a id="4728" href="Ledger.Conway.TokenAlgebra.html#499" class="Function">Value</a><a id="4733" class="Symbol">)</a>
           <a id="4746" class="Symbol">→</a> <a id="4748" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4754" class="Symbol">(</a><a id="4755" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="4757" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4759" href="Ledger.Conway.Script.html#1747" class="Function">DataHash</a><a id="4767" class="Symbol">)</a>
           <a id="4780" class="Symbol">→</a> <a id="4782" href="Ledger.Conway.Transaction.html#2382" class="Function">TxIn</a> <a id="4787" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4789" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a>
<a id="4795" href="ScriptVerification.Lib.html#4655" class="Function">createUTxO</a> <a id="4806" href="ScriptVerification.Lib.html#4806" class="Bound">index</a> <a id="4812" href="ScriptVerification.Lib.html#4812" class="Bound">wallet</a> <a id="4819" href="ScriptVerification.Lib.html#4819" class="Bound">value</a> <a id="4825" href="ScriptVerification.Lib.html#4825" class="Bound">d</a> <a id="4827" class="Symbol">=</a> <a id="4829" class="Symbol">(</a><a id="4830" href="ScriptVerification.Lib.html#4806" class="Bound">index</a> <a id="4836" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4838" href="ScriptVerification.Lib.html#4806" class="Bound">index</a><a id="4843" class="Symbol">)</a>
                                <a id="4877" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4879" class="Symbol">(</a><a id="4880" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="4885" class="Symbol">(</a><a id="4886" class="Keyword">record</a> <a id="4893" class="Symbol">{</a> <a id="4895" href="Ledger.Conway.Address.html#1138" class="Field">net</a> <a id="4899" class="Symbol">=</a> <a id="4901" class="Number">0</a> <a id="4903" class="Symbol">;</a> <a id="4905" href="Ledger.Conway.Address.html#1163" class="Field">pay</a> <a id="4909" class="Symbol">=</a> <a id="4911" href="Ledger.Conway.Address.html#306" class="InductiveConstructor">KeyHashObj</a> <a id="4922" href="ScriptVerification.Lib.html#4812" class="Bound">wallet</a> <a id="4929" class="Symbol">;</a> <a id="4931" href="Ledger.Conway.Address.html#1191" class="Field">stake</a> <a id="4937" class="Symbol">=</a> <a id="4939" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4944" class="Symbol">(</a><a id="4945" href="Ledger.Conway.Address.html#306" class="InductiveConstructor">KeyHashObj</a> <a id="4956" href="ScriptVerification.Lib.html#4812" class="Bound">wallet</a><a id="4962" class="Symbol">)</a> <a id="4964" class="Symbol">})</a>
                                  <a id="5001" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5003" href="ScriptVerification.Lib.html#4819" class="Bound">value</a> <a id="5009" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5011" href="ScriptVerification.Lib.html#4825" class="Bound">d</a> <a id="5013" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5015" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="5022" class="Symbol">)</a>

<a id="createInitUtxoState"></a><a id="5025" href="ScriptVerification.Lib.html#5025" class="Function">createInitUtxoState</a> <a id="5045" class="Symbol">:</a> <a id="5047" class="Symbol">(</a><a id="5048" href="ScriptVerification.Lib.html#5048" class="Bound">wallets</a> <a id="5056" class="Symbol">:</a> <a id="5058" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="5059" class="Symbol">)</a>
                    <a id="5081" class="Symbol">→</a> <a id="5083" class="Symbol">(</a><a id="5084" href="ScriptVerification.Lib.html#5084" class="Bound">value</a> <a id="5090" class="Symbol">:</a> <a id="5092" href="Ledger.Conway.TokenAlgebra.html#499" class="Function">Value</a><a id="5097" class="Symbol">)</a>
                    <a id="5119" class="Symbol">→</a> <a id="5121" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5126" class="Symbol">(</a><a id="5127" href="Ledger.Conway.Transaction.html#2382" class="Function">TxIn</a> <a id="5132" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5134" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a><a id="5139" class="Symbol">)</a>
<a id="5141" href="ScriptVerification.Lib.html#5025" class="Function">createInitUtxoState</a> <a id="5161" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="5166" href="ScriptVerification.Lib.html#5166" class="Bound">value</a> <a id="5172" class="Symbol">=</a> <a id="5174" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="5177" href="ScriptVerification.Lib.html#5025" class="Function">createInitUtxoState</a> <a id="5197" class="Symbol">(</a><a id="5198" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5202" href="ScriptVerification.Lib.html#5202" class="Bound">wallet</a><a id="5208" class="Symbol">)</a> <a id="5210" href="ScriptVerification.Lib.html#5210" class="Bound">value</a> <a id="5216" class="Symbol">=</a> <a id="5218" href="ScriptVerification.Lib.html#4655" class="Function">createUTxO</a> <a id="5229" class="Symbol">(</a><a id="5230" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5234" href="ScriptVerification.Lib.html#5202" class="Bound">wallet</a><a id="5240" class="Symbol">)</a> <a id="5242" class="Symbol">(</a><a id="5243" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5247" href="ScriptVerification.Lib.html#5202" class="Bound">wallet</a><a id="5253" class="Symbol">)</a> <a id="5255" href="ScriptVerification.Lib.html#5210" class="Bound">value</a> <a id="5261" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                                         <a id="5310" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5312" href="ScriptVerification.Lib.html#5025" class="Function">createInitUtxoState</a> <a id="5332" href="ScriptVerification.Lib.html#5202" class="Bound">wallet</a> <a id="5339" href="ScriptVerification.Lib.html#5210" class="Bound">value</a>

<a id="fromList&#39;"></a><a id="5346" href="ScriptVerification.Lib.html#5346" class="Function">fromList&#39;</a> <a id="5356" class="Symbol">:</a> <a id="5358" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5363" class="Symbol">(</a><a id="5364" href="Ledger.Conway.Transaction.html#2382" class="Function">TxIn</a> <a id="5369" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5371" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a><a id="5376" class="Symbol">)</a> <a id="5378" class="Symbol">→</a> <a id="5380" href="Ledger.Conway.Transaction.html#2473" class="Function">UTxO</a>
<a id="5385" href="ScriptVerification.Lib.html#5346" class="Function">fromList&#39;</a> <a id="5395" class="Symbol">=</a> <a id="5397" href="Axiom.Set.Map.html#2713" class="Function">fromListᵐ</a>

<a id="fromListIx"></a><a id="5408" href="ScriptVerification.Lib.html#5408" class="Function">fromListIx</a> <a id="5419" class="Symbol">:</a> <a id="5421" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5426" class="Symbol">(</a><a id="5427" href="ScriptVerification.LedgerImplementation.html#1918" class="Function">Implementation.Ix</a> <a id="5445" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5447" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a><a id="5452" class="Symbol">)</a> <a id="5454" class="Symbol">→</a> <a id="5456" href="ScriptVerification.LedgerImplementation.html#1918" class="Function">Implementation.Ix</a> <a id="5474" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="5476" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a>
<a id="5482" href="ScriptVerification.Lib.html#5408" class="Function">fromListIx</a> <a id="5493" class="Symbol">=</a> <a id="5495" href="Axiom.Set.Map.html#2713" class="Function">fromListᵐ</a>

<a id="applyScript"></a><a id="5506" href="ScriptVerification.Lib.html#5506" class="Function">applyScript</a> <a id="5518" class="Symbol">:</a> <a id="5520" class="Symbol">(</a><a id="5521" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5527" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5529" class="Symbol">→</a> <a id="5531" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5537" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5539" class="Symbol">→</a> <a id="5541" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="5545" class="Symbol">)</a> <a id="5547" class="Symbol">→</a> <a id="5549" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5554" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5556" class="Symbol">→</a> <a id="5558" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5563" href="ScriptVerification.Lib.html#5506" class="Function">applyScript</a> <a id="5575" href="ScriptVerification.Lib.html#5575" class="Bound">f</a> <a id="5577" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5580" class="Symbol">=</a> <a id="5582" href="ScriptVerification.Lib.html#5575" class="Bound">f</a> <a id="5584" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5592" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="5600" href="ScriptVerification.Lib.html#5506" class="Function">applyScript</a> <a id="5612" href="ScriptVerification.Lib.html#5612" class="Bound">f</a> <a id="5614" class="Symbol">(_</a> <a id="5617" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5619" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5621" class="Symbol">)</a> <a id="5623" class="Symbol">=</a> <a id="5625" href="ScriptVerification.Lib.html#5612" class="Bound">f</a> <a id="5627" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5635" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="5643" href="ScriptVerification.Lib.html#5506" class="Function">applyScript</a> <a id="5655" href="ScriptVerification.Lib.html#5655" class="Bound">f</a> <a id="5657" class="Symbol">(</a><a id="5658" href="ScriptVerification.Lib.html#5658" class="Bound">redeemer</a> <a id="5667" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5669" href="ScriptVerification.Lib.html#5669" class="Bound">valcontext</a> <a id="5680" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5682" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5684" class="Symbol">)</a> <a id="5686" class="Symbol">=</a> <a id="5688" href="ScriptVerification.Lib.html#5655" class="Bound">f</a> <a id="5690" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5698" class="Symbol">(</a><a id="5699" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5704" href="ScriptVerification.Lib.html#5658" class="Bound">redeemer</a><a id="5712" class="Symbol">)</a>
<a id="5714" href="ScriptVerification.Lib.html#5506" class="Function">applyScript</a> <a id="5726" href="ScriptVerification.Lib.html#5726" class="Bound">f</a> <a id="5728" class="Symbol">(</a><a id="5729" href="ScriptVerification.Lib.html#5729" class="Bound">datum</a> <a id="5735" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5737" href="ScriptVerification.Lib.html#5737" class="Bound">redeemer</a> <a id="5746" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5748" href="ScriptVerification.Lib.html#5748" class="Bound">valcontext</a> <a id="5759" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5761" class="Symbol">_)</a> <a id="5764" class="Symbol">=</a> <a id="5766" href="ScriptVerification.Lib.html#5726" class="Bound">f</a> <a id="5768" class="Symbol">(</a><a id="5769" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5774" href="ScriptVerification.Lib.html#5729" class="Bound">datum</a><a id="5779" class="Symbol">)</a> <a id="5781" class="Symbol">(</a><a id="5782" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5787" href="ScriptVerification.Lib.html#5737" class="Bound">redeemer</a><a id="5795" class="Symbol">)</a>

<a id="notEmpty"></a><a id="5798" href="ScriptVerification.Lib.html#5798" class="Function">notEmpty</a> <a id="5807" class="Symbol">:</a> <a id="5809" class="Symbol">∀</a> <a id="5811" class="Symbol">{</a><a id="5812" href="ScriptVerification.Lib.html#5812" class="Bound">A</a> <a id="5814" class="Symbol">:</a> <a id="5816" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="5820" class="Symbol">}</a> <a id="5822" class="Symbol">→</a> <a id="5824" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5829" href="ScriptVerification.Lib.html#5812" class="Bound">A</a> <a id="5831" class="Symbol">→</a> <a id="5833" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="5838" href="ScriptVerification.Lib.html#5798" class="Function">notEmpty</a> <a id="5847" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5850" class="Symbol">=</a> <a id="5852" href="Data.Empty.html#914" class="Function">⊥</a>
<a id="5854" href="ScriptVerification.Lib.html#5798" class="Function">notEmpty</a> <a id="5863" class="Symbol">(</a><a id="5864" href="ScriptVerification.Lib.html#5864" class="Bound">x</a> <a id="5866" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5868" href="ScriptVerification.Lib.html#5868" class="Bound">xs</a><a id="5870" class="Symbol">)</a> <a id="5872" class="Symbol">=</a> <a id="5874" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>

<a id="isSuccess"></a><a id="5877" href="ScriptVerification.Lib.html#5877" class="Function">isSuccess</a> <a id="5887" class="Symbol">:</a> <a id="5889" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="5907" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="5914" href="Ledger.Conway.Utxo.html#2747" class="Record">UTxOState</a> <a id="5924" class="Symbol">→</a> <a id="5926" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5931" href="ScriptVerification.Lib.html#5877" class="Function">isSuccess</a> <a id="5941" class="Symbol">(</a><a id="5942" href="Interface.ComputationalRelation.html#308" class="InductiveConstructor">success</a> <a id="5950" href="ScriptVerification.Lib.html#5950" class="Bound">x</a><a id="5951" class="Symbol">)</a> <a id="5953" class="Symbol">=</a> <a id="5955" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="5960" href="ScriptVerification.Lib.html#5877" class="Function">isSuccess</a> <a id="5970" class="Symbol">(</a><a id="5971" href="Interface.ComputationalRelation.html#348" class="InductiveConstructor">failure</a> <a id="5979" href="ScriptVerification.Lib.html#5979" class="Bound">x</a><a id="5980" class="Symbol">)</a> <a id="5982" class="Symbol">=</a> <a id="5984" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="5991" class="Comment">-- [1] https://github.com/IntersectMBO/cardano-ledger/blob/master/docs/adr/2024-08-14_009-refscripts-fee-change.md</a>
</pre></body></html>