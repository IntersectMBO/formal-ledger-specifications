<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>ScriptVerification.Lib</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="28" class="Keyword">hiding</a> <a id="35" class="Symbol">(</a><a id="36" href="Axiom.Set.html#5718" class="Function">fromList</a><a id="44" class="Symbol">;</a> <a id="46" href="Class.Monoid.Core.html#195" class="Field">ε</a><a id="47" class="Symbol">;</a> <a id="49" href="Data.Nat.Base.html#7102" class="Function Operator">_/_</a><a id="52" class="Symbol">);</a> <a id="55" class="Keyword">open</a> <a id="60" href="Interface.ComputationalRelation.html#2799" class="Module">Computational</a>
<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="ScriptVerification.Prelude.html" class="Module">ScriptVerification.Prelude</a>

<a id="114" class="Keyword">module</a> <a id="121" href="ScriptVerification.Lib.html" class="Module">ScriptVerification.Lib</a> <a id="144" class="Symbol">(</a><a id="145" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="147" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="149" class="Symbol">:</a> <a id="151" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="155" class="Symbol">)</a>
  <a id="159" class="Symbol">(</a><a id="160" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a> <a id="170" class="Symbol">:</a> <a id="172" href="ScriptVerification.Prelude.html#118" class="Record">ScriptImplementation</a> <a id="193" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="195" href="ScriptVerification.Lib.html#147" class="Bound">D</a><a id="196" class="Symbol">)</a> <a id="198" class="Symbol">(</a><a id="199" class="Keyword">open</a> <a id="204" href="ScriptVerification.Prelude.html#118" class="Module">ScriptImplementation</a> <a id="225" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a><a id="234" class="Symbol">)</a>
  <a id="238" class="Keyword">where</a>

<a id="245" class="Keyword">open</a> <a id="250" class="Keyword">import</a> <a id="257" href="ScriptVerification.LedgerImplementation.html" class="Module">ScriptVerification.LedgerImplementation</a> <a id="297" href="ScriptVerification.Lib.html#145" class="Bound">A</a> <a id="299" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="301" href="ScriptVerification.Lib.html#160" class="Bound">scriptImp</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Ledger.Conway.ScriptValidation.html" class="Module">Ledger.Conway.ScriptValidation</a> <a id="354" href="ScriptVerification.LedgerImplementation.html#4211" class="Function">SVTransactionStructure</a> <a id="377" href="ScriptVerification.LedgerImplementation.html#4794" class="Function">SVAbstractFunctions</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="463" href="ScriptVerification.LedgerImplementation.html#4211" class="Function">SVTransactionStructure</a> <a id="486" href="ScriptVerification.LedgerImplementation.html#4794" class="Function">SVAbstractFunctions</a>
<a id="506" class="Keyword">open</a> <a id="511" class="Keyword">import</a> <a id="518" href="Ledger.Conway.Transaction.html" class="Module">Ledger.Conway.Transaction</a>
<a id="544" class="Keyword">open</a> <a id="549" href="Ledger.Conway.Transaction.html#910" class="Module">TransactionStructure</a> <a id="570" href="ScriptVerification.LedgerImplementation.html#4211" class="Function">SVTransactionStructure</a>
<a id="593" class="Keyword">open</a> <a id="598" class="Keyword">import</a> <a id="605" href="Ledger.Conway.Types.Epoch.html" class="Module">Ledger.Conway.Types.Epoch</a>
<a id="631" class="Keyword">open</a> <a id="636" class="Keyword">import</a> <a id="643" href="Ledger.Conway.Types.Numeric.html" class="Module">Ledger.Conway.Types.Numeric</a> <a id="671" class="Keyword">using</a> <a id="677" class="Symbol">(</a><a id="678" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a><a id="692" class="Symbol">;</a> <a id="694" href="Ledger.Conway.Types.Numeric.html#250" class="Function">mkℕ⁺</a><a id="698" class="Symbol">)</a>
<a id="700" class="Keyword">open</a> <a id="705" href="Ledger.Conway.Types.Epoch.html#524" class="Module">EpochStructure</a> <a id="720" href="ScriptVerification.LedgerImplementation.html#2187" class="Function">SVEpochStructure</a>
<a id="737" class="Keyword">open</a> <a id="742" class="Keyword">import</a> <a id="749" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="762" class="Keyword">using</a> <a id="768" class="Symbol">(</a><a id="769" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a><a id="770" class="Symbol">;</a> <a id="772" href="Agda.Builtin.Int.html#263" class="InductiveConstructor">+_</a><a id="774" class="Symbol">)</a>
<a id="776" class="Keyword">open</a> <a id="781" class="Keyword">import</a> <a id="788" href="Data.Rational.html" class="Module">Data.Rational</a> <a id="802" class="Keyword">using</a> <a id="808" class="Symbol">(</a><a id="809" href="Data.Rational.Base.html#4367" class="Function">½</a><a id="810" class="Symbol">;</a> <a id="812" href="Data.Rational.Base.html#4346" class="Function">1ℚ</a> <a id="815" class="Symbol">;</a> <a id="817" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="822" class="Symbol">;</a> <a id="824" href="Data.Rational.Base.html#3884" class="Function Operator">_/_</a><a id="827" class="Symbol">)</a>
<a id="829" class="Keyword">open</a> <a id="834" class="Keyword">import</a> <a id="841" href="Data.Nat.Coprimality.html" class="Module">Data.Nat.Coprimality</a> <a id="862" class="Keyword">using</a> <a id="868" class="Symbol">(</a><a id="869" href="Data.Nat.Coprimality.html#1190" class="Function">Coprime</a><a id="876" class="Symbol">;</a> <a id="878" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a><a id="891" class="Symbol">)</a>
<a id="893" class="Keyword">open</a> <a id="898" href="ScriptVerification.LedgerImplementation.html#1106" class="Module">Implementation</a>

<a id="createEnv"></a><a id="914" href="ScriptVerification.Lib.html#914" class="Function">createEnv</a> <a id="924" class="Symbol">:</a> <a id="926" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="928" class="Symbol">→</a> <a id="930" href="Ledger.Conway.Utxo.html#2395" class="Record">UTxOEnv</a>
<a id="938" href="ScriptVerification.Lib.html#914" class="Function">createEnv</a> <a id="948" href="ScriptVerification.Lib.html#948" class="Bound">s</a> <a id="950" class="Symbol">=</a> <a id="952" class="Keyword">record</a> <a id="959" class="Symbol">{</a> <a id="961" href="Ledger.Conway.Utxo.html#2428" class="Field">slot</a> <a id="966" class="Symbol">=</a> <a id="968" href="ScriptVerification.Lib.html#948" class="Bound">s</a> <a id="970" class="Symbol">;</a> <a id="972" href="Ledger.Conway.Utxo.html#2473" class="Field">treasury</a> <a id="981" class="Symbol">=</a> <a id="983" class="Number">0</a> <a id="985" class="Symbol">;</a>
                   <a id="1006" href="Ledger.Conway.Utxo.html#2449" class="Field">pparams</a> <a id="1014" class="Symbol">=</a> <a id="1016" class="Keyword">record</a>
                               <a id="1054" class="Symbol">{</a> <a id="1056" href="Ledger.Conway.PParams.html#1760" class="Field">maxBlockSize</a> <a id="1069" class="Symbol">=</a> <a id="1071" class="Number">90112</a>
                               <a id="1108" class="Symbol">;</a> <a id="1110" href="Ledger.Conway.PParams.html#1802" class="Field">maxTxSize</a> <a id="1120" class="Symbol">=</a> <a id="1122" class="Number">16384</a>
                               <a id="1159" class="Symbol">;</a> <a id="1161" href="Ledger.Conway.PParams.html#1844" class="Field">maxHeaderSize</a> <a id="1175" class="Symbol">=</a> <a id="1177" class="Number">1100</a>
                               <a id="1213" class="Symbol">;</a> <a id="1215" href="Ledger.Conway.PParams.html#1982" class="Field">maxValSize</a> <a id="1226" class="Symbol">=</a> <a id="1228" class="Number">5000</a>
                               <a id="1264" class="Symbol">;</a> <a id="1266" href="Ledger.Conway.PParams.html#2024" class="Field">maxCollateralInputs</a> <a id="1286" class="Symbol">=</a> <a id="1288" class="Number">3</a>
                               <a id="1321" class="Symbol">;</a> <a id="1323" href="Ledger.Conway.PParams.html#2068" class="Field">pv</a> <a id="1326" class="Symbol">=</a> <a id="1328" class="Number">8</a> <a id="1330" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1332" class="Number">0</a>
                               <a id="1365" class="Symbol">;</a> <a id="1367" href="Ledger.Conway.PParams.html#1886" class="Field">maxTxExUnits</a> <a id="1380" class="Symbol">=</a> <a id="1382" class="Number">10000000000</a> <a id="1394" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1396" class="Number">14000000</a>
                               <a id="1436" class="Symbol">;</a> <a id="1438" href="Ledger.Conway.PParams.html#1934" class="Field">maxBlockExUnits</a> <a id="1454" class="Symbol">=</a> <a id="1456" class="Number">40000000000</a> <a id="1468" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1470" class="Number">62000000</a>
                               <a id="1510" class="Symbol">;</a> <a id="1512" href="Ledger.Conway.PParams.html#2143" class="Field">a</a> <a id="1514" class="Symbol">=</a> <a id="1516" class="Number">44</a>
                               <a id="1550" class="Symbol">;</a> <a id="1552" href="Ledger.Conway.PParams.html#2185" class="Field">b</a> <a id="1554" class="Symbol">=</a> <a id="1556" class="Number">155381</a>
                               <a id="1594" class="Symbol">;</a> <a id="1596" href="Ledger.Conway.PParams.html#2762" class="Field">minUTxOValue</a> <a id="1609" class="Symbol">=</a> <a id="1611" class="Number">0</a>
                               <a id="1644" class="Symbol">;</a> <a id="1646" href="Ledger.Conway.PParams.html#2272" class="Field">poolDeposit</a> <a id="1658" class="Symbol">=</a> <a id="1660" class="Number">500000000</a> <a id="1670" class="Comment">-- lovelace</a>
                               <a id="1713" class="Symbol">;</a> <a id="1715" href="Ledger.Conway.PParams.html#2227" class="Field">keyDeposit</a> <a id="1726" class="Symbol">=</a> <a id="1728" class="Number">500000000</a> <a id="1738" class="Comment">-- lovelace</a>
                               <a id="1781" class="Symbol">;</a> <a id="1783" href="Ledger.Conway.PParams.html#2317" class="Field">monetaryExpansion</a> <a id="1801" class="Symbol">=</a> <a id="1803" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a> <a id="1818" class="Symbol">(</a><a id="1819" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">+</a> <a id="1821" class="Number">3</a> <a id="1823" href="Data.Rational.Base.html#3884" class="Function Operator">/</a> <a id="1825" class="Number">1000</a><a id="1829" class="Symbol">)</a>
                               <a id="1862" class="Symbol">;</a> <a id="1864" href="Ledger.Conway.PParams.html#2387" class="Field">treasuryCut</a> <a id="1876" class="Symbol">=</a> <a id="1878" href="Ledger.Conway.Types.Numeric.UnitInterval.html#2448" class="Function">mkUnitInterval</a> <a id="1893" class="Symbol">(</a><a id="1894" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">+</a> <a id="1896" class="Number">2</a> <a id="1898" href="Data.Rational.Base.html#3884" class="Function Operator">/</a> <a id="1900" class="Number">10</a><a id="1902" class="Symbol">)</a>
                               <a id="1935" class="Symbol">;</a> <a id="1937" href="Ledger.Conway.PParams.html#2457" class="Field">coinsPerUTxOByte</a> <a id="1954" class="Symbol">=</a> <a id="1956" class="Number">0</a>  <a id="1959" class="Comment">--lovelace</a>
                               <a id="2001" class="Comment">-- ^^^ was 4310, but that value resulted in failed tests once</a>
                               <a id="2094" class="Comment">-- we replaced `minUTxOValue` with `coinsPerUTxOByte`; see `HelloWorld.agda`</a>
                               <a id="2202" class="Comment">-- line 153: `isSuccess succeedExample ≡ true`</a>
                               <a id="2280" class="Symbol">;</a> <a id="2282" href="Ledger.Conway.PParams.html#2549" class="Field">minFeeRefScriptCoinsPerByte</a> <a id="2310" class="Symbol">=</a> <a id="2312" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="2317" class="Number">15</a> <a id="2320" class="Number">1</a> <a id="2322" class="Symbol">(</a><a id="2323" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a> <a id="2337" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2341" class="Symbol">)</a> <a id="2343" class="Comment">-- see [1]</a>
                               <a id="2385" class="Symbol">;</a> <a id="2387" href="Ledger.Conway.PParams.html#2502" class="Field">prices</a> <a id="2394" class="Symbol">=</a> <a id="2396" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2399" class="Comment">-- fix this</a>
                               <a id="2442" class="Symbol">;</a> <a id="2444" href="Ledger.Conway.PParams.html#2591" class="Field">maxRefScriptSizePerTx</a> <a id="2466" class="Symbol">=</a> <a id="2468" class="Number">200</a> <a id="2472" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="2474" class="Number">1024</a> <a id="2479" class="Comment">-- 200KiB</a>
                               <a id="2520" class="Symbol">;</a> <a id="2522" href="Ledger.Conway.PParams.html#2633" class="Field">maxRefScriptSizePerBlock</a> <a id="2547" class="Symbol">=</a> <a id="2549" class="Number">1024</a> <a id="2554" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="2556" class="Number">1024</a> <a id="2561" class="Comment">-- 1MiB</a>
                               <a id="2600" class="Symbol">;</a> <a id="2602" href="Ledger.Conway.PParams.html#2675" class="Field">refScriptCostStride</a>  <a id="2623" class="Symbol">=</a> <a id="2625" href="Ledger.Conway.Types.Numeric.html#250" class="Function">mkℕ⁺</a> <a id="2630" class="Number">25</a>
                               <a id="2664" class="Symbol">;</a> <a id="2666" href="Ledger.Conway.PParams.html#2718" class="Field">refScriptCostMultiplier</a> <a id="2690" class="Symbol">=</a> <a id="2692" href="Data.Rational.Base.html#1960" class="Function">mkℚ+</a> <a id="2697" class="Number">6</a> <a id="2699" class="Number">5</a> <a id="2701" class="Symbol">(</a><a id="2702" href="Data.Nat.Coprimality.html#1733" class="Function">gcd≡1⇒coprime</a> <a id="2716" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="2720" class="Symbol">)</a> <a id="2722" class="Comment">-- see [1]</a>
                               <a id="2764" class="Symbol">;</a> <a id="2766" href="Ledger.Conway.PParams.html#2922" class="Field">a0</a> <a id="2769" class="Symbol">=</a> <a id="2771" href="Data.Rational.Base.html#4346" class="Function">1ℚ</a> <a id="2774" class="Comment">-- don&#39;t know</a>
                               <a id="2819" class="Symbol">;</a> <a id="2821" href="Ledger.Conway.PParams.html#2834" class="Field">Emax</a> <a id="2826" class="Symbol">=</a> <a id="2828" class="Number">18</a>
                               <a id="2862" class="Symbol">;</a> <a id="2864" href="Ledger.Conway.PParams.html#2880" class="Field">nopt</a> <a id="2869" class="Symbol">=</a> <a id="2871" class="Number">0</a> <a id="2873" class="Comment">-- don&#39;t know</a>
                               <a id="2918" class="Symbol">;</a> <a id="2920" href="Ledger.Conway.PParams.html#2964" class="Field">collateralPercentage</a> <a id="2941" class="Symbol">=</a> <a id="2943" class="Number">150</a>
                               <a id="2978" class="Symbol">;</a> <a id="2980" href="Ledger.Conway.PParams.html#3100" class="Field">costmdls</a> <a id="2989" class="Symbol">=</a> <a id="2991" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2994" class="Comment">-- fix this</a>
                               <a id="3037" class="Symbol">;</a> <a id="3039" href="Ledger.Conway.PParams.html#3207" class="Field">drepThresholds</a> <a id="3054" class="Symbol">=</a> <a id="3056" class="Keyword">record</a> <a id="3063" class="Comment">-- unknown so setting all to 50%</a>
                                                    <a id="3148" class="Symbol">{</a> <a id="3150" href="Ledger.Conway.PParams.html#1603" class="Field">P1</a> <a id="3153" class="Symbol">=</a> <a id="3155" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3209" class="Symbol">;</a> <a id="3211" href="Ledger.Conway.PParams.html#1606" class="Field">P2a</a> <a id="3215" class="Symbol">=</a> <a id="3217" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3271" class="Symbol">;</a> <a id="3273" href="Ledger.Conway.PParams.html#1610" class="Field">P2b</a> <a id="3277" class="Symbol">=</a> <a id="3279" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3333" class="Symbol">;</a> <a id="3335" href="Ledger.Conway.PParams.html#1614" class="Field">P3</a> <a id="3338" class="Symbol">=</a> <a id="3340" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3394" class="Symbol">;</a> <a id="3396" href="Ledger.Conway.PParams.html#1617" class="Field">P4</a> <a id="3399" class="Symbol">=</a> <a id="3401" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3455" class="Symbol">;</a> <a id="3457" href="Ledger.Conway.PParams.html#1620" class="Field">P5a</a> <a id="3461" class="Symbol">=</a> <a id="3463" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3517" class="Symbol">;</a> <a id="3519" href="Ledger.Conway.PParams.html#1624" class="Field">P5b</a> <a id="3523" class="Symbol">=</a> <a id="3525" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3579" class="Symbol">;</a> <a id="3581" href="Ledger.Conway.PParams.html#1628" class="Field">P5c</a> <a id="3585" class="Symbol">=</a> <a id="3587" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3641" class="Symbol">;</a> <a id="3643" href="Ledger.Conway.PParams.html#1632" class="Field">P5d</a> <a id="3647" class="Symbol">=</a> <a id="3649" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3703" class="Symbol">;</a> <a id="3705" href="Ledger.Conway.PParams.html#1636" class="Field">P6</a> <a id="3708" class="Symbol">=</a> <a id="3710" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3764" class="Symbol">}</a>
                               <a id="3797" class="Symbol">;</a> <a id="3799" href="Ledger.Conway.PParams.html#3152" class="Field">poolThresholds</a> <a id="3814" class="Symbol">=</a> <a id="3816" class="Keyword">record</a>
                                                    <a id="3875" class="Symbol">{</a> <a id="3877" href="Ledger.Conway.PParams.html#1691" class="Field">Q1</a> <a id="3880" class="Symbol">=</a> <a id="3882" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3936" class="Symbol">;</a> <a id="3938" href="Ledger.Conway.PParams.html#1694" class="Field">Q2a</a> <a id="3942" class="Symbol">=</a> <a id="3944" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="3998" class="Symbol">;</a> <a id="4000" href="Ledger.Conway.PParams.html#1698" class="Field">Q2b</a> <a id="4004" class="Symbol">=</a> <a id="4006" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4060" class="Symbol">;</a> <a id="4062" href="Ledger.Conway.PParams.html#1702" class="Field">Q4</a> <a id="4065" class="Symbol">=</a> <a id="4067" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4121" class="Symbol">;</a> <a id="4123" href="Ledger.Conway.PParams.html#1705" class="Field">Q5</a> <a id="4126" class="Symbol">=</a> <a id="4128" href="Data.Rational.Base.html#4367" class="Function">½</a>
                                                    <a id="4182" class="Symbol">}</a>
                               <a id="4215" class="Symbol">;</a> <a id="4217" href="Ledger.Conway.PParams.html#3346" class="Field">govActionLifetime</a> <a id="4235" class="Symbol">=</a> <a id="4237" class="Number">10</a> <a id="4240" class="Comment">-- unknown</a>
                               <a id="4282" class="Symbol">;</a> <a id="4284" href="Ledger.Conway.PParams.html#3388" class="Field">govActionDeposit</a> <a id="4301" class="Symbol">=</a> <a id="4303" class="Number">1000000</a> <a id="4311" class="Comment">-- unknown (set to 1 ada)</a>
                               <a id="4368" class="Symbol">;</a> <a id="4370" href="Ledger.Conway.PParams.html#3433" class="Field">drepDeposit</a> <a id="4382" class="Symbol">=</a> <a id="4384" class="Number">1000000</a> <a id="4392" class="Comment">-- unknown (set to 1 ada)</a>
                               <a id="4449" class="Symbol">;</a> <a id="4451" href="Ledger.Conway.PParams.html#3478" class="Field">drepActivity</a> <a id="4464" class="Symbol">=</a> <a id="4466" class="Number">13</a> <a id="4469" class="Comment">-- unknown</a>
                               <a id="4511" class="Symbol">;</a> <a id="4513" href="Ledger.Conway.PParams.html#3262" class="Field">ccMinSize</a> <a id="4523" class="Symbol">=</a> <a id="4525" class="Number">10</a> <a id="4528" class="Comment">-- unknown</a>
                               <a id="4570" class="Symbol">;</a> <a id="4572" href="Ledger.Conway.PParams.html#3304" class="Field">ccMaxTermLength</a> <a id="4588" class="Symbol">=</a> <a id="4590" class="Number">73</a> <a id="4593" class="Comment">-- unknown set to 1 year (73 epochs)</a>
                               <a id="4661" class="Symbol">}</a> <a id="4663" class="Symbol">}</a>

<a id="createUTxO"></a><a id="4666" href="ScriptVerification.Lib.html#4666" class="Function">createUTxO</a> <a id="4677" class="Symbol">:</a> <a id="4679" class="Symbol">(</a><a id="4680" href="ScriptVerification.Lib.html#4680" class="Bound">index</a> <a id="4686" class="Symbol">:</a> <a id="4688" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4689" class="Symbol">)</a>
           <a id="4702" class="Symbol">→</a> <a id="4704" class="Symbol">(</a><a id="4705" href="ScriptVerification.Lib.html#4705" class="Bound">wallet</a> <a id="4712" class="Symbol">:</a> <a id="4714" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4715" class="Symbol">)</a>
           <a id="4728" class="Symbol">→</a> <a id="4730" class="Symbol">(</a><a id="4731" href="ScriptVerification.Lib.html#4731" class="Bound">value</a> <a id="4737" class="Symbol">:</a> <a id="4739" href="Ledger.Conway.TokenAlgebra.html#499" class="Function">Value</a><a id="4744" class="Symbol">)</a>
           <a id="4757" class="Symbol">→</a> <a id="4759" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4765" class="Symbol">(</a><a id="4766" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="4768" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4770" href="Ledger.Conway.Script.html#1747" class="Function">DataHash</a><a id="4778" class="Symbol">)</a>
           <a id="4791" class="Symbol">→</a> <a id="4793" href="Ledger.Conway.Transaction.html#2382" class="Function">TxIn</a> <a id="4798" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4800" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a>
<a id="4806" href="ScriptVerification.Lib.html#4666" class="Function">createUTxO</a> <a id="4817" href="ScriptVerification.Lib.html#4817" class="Bound">index</a> <a id="4823" href="ScriptVerification.Lib.html#4823" class="Bound">wallet</a> <a id="4830" href="ScriptVerification.Lib.html#4830" class="Bound">value</a> <a id="4836" href="ScriptVerification.Lib.html#4836" class="Bound">d</a> <a id="4838" class="Symbol">=</a> <a id="4840" class="Symbol">(</a><a id="4841" href="ScriptVerification.Lib.html#4817" class="Bound">index</a> <a id="4847" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4849" href="ScriptVerification.Lib.html#4817" class="Bound">index</a><a id="4854" class="Symbol">)</a>
                                <a id="4888" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4890" class="Symbol">(</a><a id="4891" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="4896" class="Symbol">(</a><a id="4897" class="Keyword">record</a> <a id="4904" class="Symbol">{</a> <a id="4906" href="Ledger.Conway.Address.html#1138" class="Field">net</a> <a id="4910" class="Symbol">=</a> <a id="4912" class="Number">0</a> <a id="4914" class="Symbol">;</a> <a id="4916" href="Ledger.Conway.Address.html#1163" class="Field">pay</a> <a id="4920" class="Symbol">=</a> <a id="4922" href="Ledger.Conway.Address.html#306" class="InductiveConstructor">KeyHashObj</a> <a id="4933" href="ScriptVerification.Lib.html#4823" class="Bound">wallet</a> <a id="4940" class="Symbol">;</a> <a id="4942" href="Ledger.Conway.Address.html#1191" class="Field">stake</a> <a id="4948" class="Symbol">=</a> <a id="4950" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="4955" class="Symbol">(</a><a id="4956" href="Ledger.Conway.Address.html#306" class="InductiveConstructor">KeyHashObj</a> <a id="4967" href="ScriptVerification.Lib.html#4823" class="Bound">wallet</a><a id="4973" class="Symbol">)</a> <a id="4975" class="Symbol">})</a>
                                  <a id="5012" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5014" href="ScriptVerification.Lib.html#4830" class="Bound">value</a> <a id="5020" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5022" href="ScriptVerification.Lib.html#4836" class="Bound">d</a> <a id="5024" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5026" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="5033" class="Symbol">)</a>

<a id="createInitUtxoState"></a><a id="5036" href="ScriptVerification.Lib.html#5036" class="Function">createInitUtxoState</a> <a id="5056" class="Symbol">:</a> <a id="5058" class="Symbol">(</a><a id="5059" href="ScriptVerification.Lib.html#5059" class="Bound">wallets</a> <a id="5067" class="Symbol">:</a> <a id="5069" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="5070" class="Symbol">)</a>
                    <a id="5092" class="Symbol">→</a> <a id="5094" class="Symbol">(</a><a id="5095" href="ScriptVerification.Lib.html#5095" class="Bound">value</a> <a id="5101" class="Symbol">:</a> <a id="5103" href="Ledger.Conway.TokenAlgebra.html#499" class="Function">Value</a><a id="5108" class="Symbol">)</a>
                    <a id="5130" class="Symbol">→</a> <a id="5132" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5137" class="Symbol">(</a><a id="5138" href="Ledger.Conway.Transaction.html#2382" class="Function">TxIn</a> <a id="5143" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5145" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a><a id="5150" class="Symbol">)</a>
<a id="5152" href="ScriptVerification.Lib.html#5036" class="Function">createInitUtxoState</a> <a id="5172" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="5177" href="ScriptVerification.Lib.html#5177" class="Bound">value</a> <a id="5183" class="Symbol">=</a> <a id="5185" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="5188" href="ScriptVerification.Lib.html#5036" class="Function">createInitUtxoState</a> <a id="5208" class="Symbol">(</a><a id="5209" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5213" href="ScriptVerification.Lib.html#5213" class="Bound">wallet</a><a id="5219" class="Symbol">)</a> <a id="5221" href="ScriptVerification.Lib.html#5221" class="Bound">value</a> <a id="5227" class="Symbol">=</a> <a id="5229" href="ScriptVerification.Lib.html#4666" class="Function">createUTxO</a> <a id="5240" class="Symbol">(</a><a id="5241" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5245" href="ScriptVerification.Lib.html#5213" class="Bound">wallet</a><a id="5251" class="Symbol">)</a> <a id="5253" class="Symbol">(</a><a id="5254" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="5258" href="ScriptVerification.Lib.html#5213" class="Bound">wallet</a><a id="5264" class="Symbol">)</a> <a id="5266" href="ScriptVerification.Lib.html#5221" class="Bound">value</a> <a id="5272" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                                         <a id="5321" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5323" href="ScriptVerification.Lib.html#5036" class="Function">createInitUtxoState</a> <a id="5343" href="ScriptVerification.Lib.html#5213" class="Bound">wallet</a> <a id="5350" href="ScriptVerification.Lib.html#5221" class="Bound">value</a>

<a id="fromList&#39;"></a><a id="5357" href="ScriptVerification.Lib.html#5357" class="Function">fromList&#39;</a> <a id="5367" class="Symbol">:</a> <a id="5369" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5374" class="Symbol">(</a><a id="5375" href="Ledger.Conway.Transaction.html#2382" class="Function">TxIn</a> <a id="5380" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5382" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a><a id="5387" class="Symbol">)</a> <a id="5389" class="Symbol">→</a> <a id="5391" href="Ledger.Conway.Transaction.html#2473" class="Function">UTxO</a>
<a id="5396" href="ScriptVerification.Lib.html#5357" class="Function">fromList&#39;</a> <a id="5406" class="Symbol">=</a> <a id="5408" href="Axiom.Set.Map.html#2713" class="Function">fromListᵐ</a>

<a id="fromListIx"></a><a id="5419" href="ScriptVerification.Lib.html#5419" class="Function">fromListIx</a> <a id="5430" class="Symbol">:</a> <a id="5432" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5437" class="Symbol">(</a><a id="5438" href="ScriptVerification.LedgerImplementation.html#1918" class="Function">Implementation.Ix</a> <a id="5456" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5458" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a><a id="5463" class="Symbol">)</a> <a id="5465" class="Symbol">→</a> <a id="5467" href="ScriptVerification.LedgerImplementation.html#1918" class="Function">Implementation.Ix</a> <a id="5485" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="5487" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a>
<a id="5493" href="ScriptVerification.Lib.html#5419" class="Function">fromListIx</a> <a id="5504" class="Symbol">=</a> <a id="5506" href="Axiom.Set.Map.html#2713" class="Function">fromListᵐ</a>

<a id="applyScript"></a><a id="5517" href="ScriptVerification.Lib.html#5517" class="Function">applyScript</a> <a id="5529" class="Symbol">:</a> <a id="5531" class="Symbol">(</a><a id="5532" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5538" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5540" class="Symbol">→</a> <a id="5542" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5548" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5550" class="Symbol">→</a> <a id="5552" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="5556" class="Symbol">)</a> <a id="5558" class="Symbol">→</a> <a id="5560" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5565" href="ScriptVerification.Lib.html#147" class="Bound">D</a> <a id="5567" class="Symbol">→</a> <a id="5569" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5574" href="ScriptVerification.Lib.html#5517" class="Function">applyScript</a> <a id="5586" href="ScriptVerification.Lib.html#5586" class="Bound">f</a> <a id="5588" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5591" class="Symbol">=</a> <a id="5593" href="ScriptVerification.Lib.html#5586" class="Bound">f</a> <a id="5595" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5603" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="5611" href="ScriptVerification.Lib.html#5517" class="Function">applyScript</a> <a id="5623" href="ScriptVerification.Lib.html#5623" class="Bound">f</a> <a id="5625" class="Symbol">(_</a> <a id="5628" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5630" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5632" class="Symbol">)</a> <a id="5634" class="Symbol">=</a> <a id="5636" href="ScriptVerification.Lib.html#5623" class="Bound">f</a> <a id="5638" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5646" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="5654" href="ScriptVerification.Lib.html#5517" class="Function">applyScript</a> <a id="5666" href="ScriptVerification.Lib.html#5666" class="Bound">f</a> <a id="5668" class="Symbol">(</a><a id="5669" href="ScriptVerification.Lib.html#5669" class="Bound">redeemer</a> <a id="5678" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5680" href="ScriptVerification.Lib.html#5680" class="Bound">valcontext</a> <a id="5691" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5693" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5695" class="Symbol">)</a> <a id="5697" class="Symbol">=</a> <a id="5699" href="ScriptVerification.Lib.html#5666" class="Bound">f</a> <a id="5701" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="5709" class="Symbol">(</a><a id="5710" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5715" href="ScriptVerification.Lib.html#5669" class="Bound">redeemer</a><a id="5723" class="Symbol">)</a>
<a id="5725" href="ScriptVerification.Lib.html#5517" class="Function">applyScript</a> <a id="5737" href="ScriptVerification.Lib.html#5737" class="Bound">f</a> <a id="5739" class="Symbol">(</a><a id="5740" href="ScriptVerification.Lib.html#5740" class="Bound">datum</a> <a id="5746" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5748" href="ScriptVerification.Lib.html#5748" class="Bound">redeemer</a> <a id="5757" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5759" href="ScriptVerification.Lib.html#5759" class="Bound">valcontext</a> <a id="5770" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5772" class="Symbol">_)</a> <a id="5775" class="Symbol">=</a> <a id="5777" href="ScriptVerification.Lib.html#5737" class="Bound">f</a> <a id="5779" class="Symbol">(</a><a id="5780" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5785" href="ScriptVerification.Lib.html#5740" class="Bound">datum</a><a id="5790" class="Symbol">)</a> <a id="5792" class="Symbol">(</a><a id="5793" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="5798" href="ScriptVerification.Lib.html#5748" class="Bound">redeemer</a><a id="5806" class="Symbol">)</a>

<a id="notEmpty"></a><a id="5809" href="ScriptVerification.Lib.html#5809" class="Function">notEmpty</a> <a id="5818" class="Symbol">:</a> <a id="5820" class="Symbol">∀</a> <a id="5822" class="Symbol">{</a><a id="5823" href="ScriptVerification.Lib.html#5823" class="Bound">A</a> <a id="5825" class="Symbol">:</a> <a id="5827" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="5831" class="Symbol">}</a> <a id="5833" class="Symbol">→</a> <a id="5835" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="5840" href="ScriptVerification.Lib.html#5823" class="Bound">A</a> <a id="5842" class="Symbol">→</a> <a id="5844" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="5849" href="ScriptVerification.Lib.html#5809" class="Function">notEmpty</a> <a id="5858" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5861" class="Symbol">=</a> <a id="5863" href="Data.Empty.html#914" class="Function">⊥</a>
<a id="5865" href="ScriptVerification.Lib.html#5809" class="Function">notEmpty</a> <a id="5874" class="Symbol">(</a><a id="5875" href="ScriptVerification.Lib.html#5875" class="Bound">x</a> <a id="5877" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5879" href="ScriptVerification.Lib.html#5879" class="Bound">xs</a><a id="5881" class="Symbol">)</a> <a id="5883" class="Symbol">=</a> <a id="5885" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>

<a id="isSuccess"></a><a id="5888" href="ScriptVerification.Lib.html#5888" class="Function">isSuccess</a> <a id="5898" class="Symbol">:</a> <a id="5900" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="5918" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="5925" href="Ledger.Conway.Utxo.html#2747" class="Record">UTxOState</a> <a id="5935" class="Symbol">→</a> <a id="5937" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="5942" href="ScriptVerification.Lib.html#5888" class="Function">isSuccess</a> <a id="5952" class="Symbol">(</a><a id="5953" href="Interface.ComputationalRelation.html#308" class="InductiveConstructor">success</a> <a id="5961" href="ScriptVerification.Lib.html#5961" class="Bound">x</a><a id="5962" class="Symbol">)</a> <a id="5964" class="Symbol">=</a> <a id="5966" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="5971" href="ScriptVerification.Lib.html#5888" class="Function">isSuccess</a> <a id="5981" class="Symbol">(</a><a id="5982" href="Interface.ComputationalRelation.html#348" class="InductiveConstructor">failure</a> <a id="5990" href="ScriptVerification.Lib.html#5990" class="Bound">x</a><a id="5991" class="Symbol">)</a> <a id="5993" class="Symbol">=</a> <a id="5995" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>

<a id="6002" class="Comment">-- [1] https://github.com/IntersectMBO/cardano-ledger/blob/master/docs/adr/2024-08-14_009-refscripts-fee-change.md</a>
</pre></body></html>