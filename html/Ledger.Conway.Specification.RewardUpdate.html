<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.RewardUpdate</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>
<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>
<a id="101" class="Keyword">open</a> <a id="106" class="Keyword">import</a> <a id="113" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
 
<a id="155" class="Keyword">module</a> <a id="162" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a>
  <a id="205" class="Symbol">(</a><a id="206" href="Ledger.Conway.Specification.RewardUpdate.html#206" class="Bound">txs</a> <a id="210" class="Symbol">:</a> <a id="212" class="Symbol">_)</a> <a id="215" class="Symbol">(</a><a id="216" class="Keyword">open</a> <a id="221" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="242" href="Ledger.Conway.Specification.RewardUpdate.html#206" class="Bound">txs</a><a id="245" class="Symbol">)</a>
  <a id="249" class="Symbol">(</a><a id="250" href="Ledger.Conway.Specification.RewardUpdate.html#250" class="Bound">abs</a> <a id="254" class="Symbol">:</a> <a id="256" href="Ledger.Conway.Specification.Abstract.html#654" class="Record">AbstractFunctions</a> <a id="274" href="Ledger.Conway.Specification.RewardUpdate.html#206" class="Bound">txs</a><a id="277" class="Symbol">)</a> <a id="279" class="Symbol">(</a><a id="280" class="Keyword">open</a> <a id="285" href="Ledger.Conway.Specification.Abstract.html#654" class="Module">AbstractFunctions</a> <a id="303" href="Ledger.Conway.Specification.RewardUpdate.html#250" class="Bound">abs</a><a id="306" class="Symbol">)</a>
  <a id="310" class="Keyword">where</a>

<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="363" href="Ledger.Conway.Specification.RewardUpdate.html#206" class="Bound">txs</a> <a id="367" href="Ledger.Conway.Specification.RewardUpdate.html#250" class="Bound">abs</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="419" href="Ledger.Conway.Specification.RewardUpdate.html#206" class="Bound">txs</a> <a id="423" href="Ledger.Conway.Specification.RewardUpdate.html#250" class="Bound">abs</a>


<a id="RUpdEnv"></a><a id="429" href="Ledger.Conway.Specification.RewardUpdate.html#429" class="Function">RUpdEnv</a> <a id="437" class="Symbol">:</a> <a id="439" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="444" href="Ledger.Conway.Specification.RewardUpdate.html#429" class="Function">RUpdEnv</a> <a id="452" class="Symbol">=</a> <a id="454" href="Ledger.Conway.Specification.Rewards.html#4867" class="Function">BlocksMade</a> <a id="465" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="467" href="Ledger.Conway.Specification.Epoch.html#1703" class="Record">EpochState</a>


<a id="480" class="Keyword">data</a> <a id="_⊢_⇀⦇_,RUPD⦈_"></a><a id="485" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">_⊢_⇀⦇_,RUPD⦈_</a>
  <a id="501" class="Symbol">:</a> <a id="503" href="Ledger.Conway.Specification.RewardUpdate.html#429" class="Function">RUpdEnv</a> <a id="511" class="Symbol">→</a> <a id="513" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="519" href="Ledger.Conway.Specification.Rewards.html#6210" class="Record">RewardUpdate</a> <a id="532" class="Symbol">→</a> <a id="534" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a> <a id="539" class="Symbol">→</a> <a id="541" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="547" href="Ledger.Conway.Specification.Rewards.html#6210" class="Record">RewardUpdate</a> <a id="560" class="Symbol">→</a> <a id="562" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="567" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Create-Reward-Update"></a><a id="576" href="Ledger.Conway.Specification.RewardUpdate.html#576" class="InductiveConstructor">RUPD-Create-Reward-Update</a> <a id="602" class="Symbol">:</a> <a id="604" class="Symbol">∀</a> <a id="606" class="Symbol">{</a><a id="607" href="Ledger.Conway.Specification.RewardUpdate.html#607" class="Bound">b</a> <a id="609" href="Ledger.Conway.Specification.RewardUpdate.html#609" class="Bound">es</a> <a id="612" href="Ledger.Conway.Specification.RewardUpdate.html#612" class="Bound">s</a><a id="613" class="Symbol">}</a> <a id="615" class="Symbol">{</a><a id="616" href="Ledger.Conway.Specification.RewardUpdate.html#616" class="Bound">ru&#39;</a> <a id="620" class="Symbol">:</a> <a id="622" href="Ledger.Conway.Specification.Rewards.html#6210" class="Record">RewardUpdate</a><a id="634" class="Symbol">}</a> <a id="636" class="Symbol">→</a>
    <a id="642" class="Keyword">let</a>
      <a id="652" href="Ledger.Conway.Specification.RewardUpdate.html#652" class="Bound">ru&#39;</a> <a id="656" class="Symbol">=</a> <a id="658" href="Ledger.Conway.Specification.Epoch.html#5242" class="Function">createRUpd</a> <a id="669" href="Ledger.Core.Specification.Epoch.html#2246" class="Function">SlotsPerEpochᶜ</a> <a id="684" href="Ledger.Conway.Specification.RewardUpdate.html#607" class="Bound">b</a> <a id="686" href="Ledger.Conway.Specification.RewardUpdate.html#609" class="Bound">es</a> <a id="689" href="Ledger.Core.Specification.Epoch.html#2492" class="Function">MaxLovelaceSupplyᶜ</a>
    <a id="712" class="Keyword">in</a>
    <a id="719" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="721" href="Ledger.Conway.Specification.RewardUpdate.html#612" class="Bound">s</a> <a id="723" href="Class.HasOrder.Core.html#848" class="Function Operator">&gt;</a> <a id="725" href="Ledger.Core.Specification.Epoch.html#863" class="Function">firstSlot</a> <a id="735" class="Symbol">(</a><a id="736" href="Ledger.Core.Specification.Epoch.html#810" class="Function">epoch</a> <a id="742" href="Ledger.Conway.Specification.RewardUpdate.html#612" class="Bound">s</a><a id="743" class="Symbol">)</a> <a id="745" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="747" href="Ledger.Core.Specification.Epoch.html#916" class="Function">RandomnessStabilisationWindow</a>
    <a id="781" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
    <a id="818" class="Symbol">(</a><a id="819" href="Ledger.Conway.Specification.RewardUpdate.html#607" class="Bound">b</a> <a id="821" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="823" href="Ledger.Conway.Specification.RewardUpdate.html#609" class="Bound">es</a><a id="825" class="Symbol">)</a> <a id="827" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">⊢</a> <a id="829" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="837" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">⇀⦇</a> <a id="840" href="Ledger.Conway.Specification.RewardUpdate.html#612" class="Bound">s</a> <a id="842" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">,RUPD⦈</a> <a id="849" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="854" href="Ledger.Conway.Specification.RewardUpdate.html#652" class="Bound">ru&#39;</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Reward-Update-Exists"></a><a id="861" href="Ledger.Conway.Specification.RewardUpdate.html#861" class="InductiveConstructor">RUPD-Reward-Update-Exists</a> <a id="887" class="Symbol">:</a> <a id="889" class="Symbol">∀</a> <a id="891" class="Symbol">{</a><a id="892" href="Ledger.Conway.Specification.RewardUpdate.html#892" class="Bound">b</a> <a id="894" href="Ledger.Conway.Specification.RewardUpdate.html#894" class="Bound">es</a> <a id="897" href="Ledger.Conway.Specification.RewardUpdate.html#897" class="Bound">s</a> <a id="899" href="Ledger.Conway.Specification.RewardUpdate.html#899" class="Bound">ru</a><a id="901" class="Symbol">}</a> <a id="903" class="Symbol">→</a>
    <a id="909" href="Prelude.InferenceRules.html#45235" class="Function Operator">────────────────────────────────</a>
    <a id="946" class="Symbol">(</a><a id="947" href="Ledger.Conway.Specification.RewardUpdate.html#892" class="Bound">b</a> <a id="949" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="951" href="Ledger.Conway.Specification.RewardUpdate.html#894" class="Bound">es</a><a id="953" class="Symbol">)</a> <a id="955" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">⊢</a> <a id="957" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="962" href="Ledger.Conway.Specification.RewardUpdate.html#899" class="Bound">ru</a> <a id="965" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">⇀⦇</a> <a id="968" href="Ledger.Conway.Specification.RewardUpdate.html#897" class="Bound">s</a> <a id="970" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">,RUPD⦈</a> <a id="977" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="982" href="Ledger.Conway.Specification.RewardUpdate.html#899" class="Bound">ru</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Reward-Too-Early"></a><a id="988" href="Ledger.Conway.Specification.RewardUpdate.html#988" class="InductiveConstructor">RUPD-Reward-Too-Early</a> <a id="1010" class="Symbol">:</a> <a id="1012" class="Symbol">∀</a> <a id="1014" class="Symbol">{</a><a id="1015" href="Ledger.Conway.Specification.RewardUpdate.html#1015" class="Bound">b</a> <a id="1017" href="Ledger.Conway.Specification.RewardUpdate.html#1017" class="Bound">es</a> <a id="1020" href="Ledger.Conway.Specification.RewardUpdate.html#1020" class="Bound">s</a><a id="1021" class="Symbol">}</a> <a id="1023" class="Symbol">→</a>
    <a id="1029" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="1031" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1033" href="Ledger.Conway.Specification.RewardUpdate.html#1020" class="Bound">s</a> <a id="1035" href="Class.HasOrder.Core.html#848" class="Function Operator">&gt;</a> <a id="1037" href="Ledger.Core.Specification.Epoch.html#863" class="Function">firstSlot</a> <a id="1047" class="Symbol">(</a><a id="1048" href="Ledger.Core.Specification.Epoch.html#810" class="Function">epoch</a> <a id="1054" href="Ledger.Conway.Specification.RewardUpdate.html#1020" class="Bound">s</a><a id="1055" class="Symbol">)</a> <a id="1057" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1059" href="Ledger.Core.Specification.Epoch.html#916" class="Function">RandomnessStabilisationWindow</a>
    <a id="1093" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
    <a id="1130" class="Symbol">(</a><a id="1131" href="Ledger.Conway.Specification.RewardUpdate.html#1015" class="Bound">b</a> <a id="1133" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1135" href="Ledger.Conway.Specification.RewardUpdate.html#1017" class="Bound">es</a><a id="1137" class="Symbol">)</a> <a id="1139" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">⊢</a> <a id="1141" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1149" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">⇀⦇</a> <a id="1152" href="Ledger.Conway.Specification.RewardUpdate.html#1020" class="Bound">s</a> <a id="1154" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">,RUPD⦈</a> <a id="1161" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="1171" class="Keyword">data</a> <a id="_⊢_⇀⦇_,TICK⦈_"></a><a id="1176" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">_⊢_⇀⦇_,TICK⦈_</a>
  <a id="1192" class="Symbol">:</a> <a id="1194" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="1196" class="Symbol">→</a> <a id="1198" href="Ledger.Conway.Specification.Epoch.html#3119" class="Record">NewEpochState</a> <a id="1212" class="Symbol">→</a> <a id="1214" href="Ledger.Core.Specification.Epoch.html#674" class="Function">Slot</a> <a id="1219" class="Symbol">→</a> <a id="1221" href="Ledger.Conway.Specification.Epoch.html#3119" class="Record">NewEpochState</a> <a id="1235" class="Symbol">→</a> <a id="1237" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1242" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,TICK⦈_.TICK"></a><a id="1251" href="Ledger.Conway.Specification.RewardUpdate.html#1251" class="InductiveConstructor">TICK</a> <a id="1256" class="Symbol">:</a> <a id="1258" class="Symbol">∀</a> <a id="1260" class="Symbol">{</a><a id="1261" href="Ledger.Conway.Specification.RewardUpdate.html#1261" class="Bound">slot</a> <a id="1266" href="Ledger.Conway.Specification.RewardUpdate.html#1266" class="Bound">nes</a> <a id="1270" href="Ledger.Conway.Specification.RewardUpdate.html#1270" class="Bound">nes&#39;</a> <a id="1275" href="Ledger.Conway.Specification.RewardUpdate.html#1275" class="Bound">ru&#39;&#39;</a><a id="1279" class="Symbol">}</a> <a id="1281" class="Symbol">→</a>
    <a id="1287" class="Keyword">let</a> <a id="1291" class="Keyword">open</a> <a id="1296" href="Ledger.Conway.Specification.Epoch.html#3119" class="Module">NewEpochState</a> <a id="1310" class="Keyword">in</a>
    <a id="1317" class="Comment">-- TODO: Is this really how it should be?</a>
    <a id="1363" class="Comment">-- We are skipping adoptGenesisDelegs here.</a>
    <a id="1411" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="1413" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="1416" href="Ledger.Conway.Specification.Epoch.html#16854" class="Datatype Operator">⊢</a> <a id="1418" href="Ledger.Conway.Specification.RewardUpdate.html#1266" class="Bound">nes</a> <a id="1422" href="Ledger.Conway.Specification.Epoch.html#16854" class="Datatype Operator">⇀⦇</a> <a id="1425" href="Ledger.Core.Specification.Epoch.html#810" class="Function">epoch</a> <a id="1431" href="Ledger.Conway.Specification.RewardUpdate.html#1261" class="Bound">slot</a> <a id="1436" href="Ledger.Conway.Specification.Epoch.html#16854" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="1447" href="Ledger.Conway.Specification.RewardUpdate.html#1270" class="Bound">nes&#39;</a>
    <a id="1456" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="1458" class="Symbol">(</a><a id="1459" href="Ledger.Conway.Specification.RewardUpdate.html#1266" class="Bound">nes</a> <a id="1463" class="Symbol">.</a><a id="1464" href="Ledger.Conway.Specification.Epoch.html#3182" class="Field">bprev</a> <a id="1470" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1472" href="Ledger.Conway.Specification.RewardUpdate.html#1266" class="Bound">nes</a> <a id="1476" class="Symbol">.</a><a id="1477" href="Ledger.Conway.Specification.Epoch.html#3240" class="Field">epochState</a><a id="1487" class="Symbol">)</a> <a id="1489" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">⊢</a> <a id="1491" class="Symbol">(</a><a id="1492" href="Ledger.Conway.Specification.RewardUpdate.html#1270" class="Bound">nes&#39;</a> <a id="1497" class="Symbol">.</a><a id="1498" href="Ledger.Conway.Specification.Epoch.html#3269" class="Field">ru</a><a id="1500" class="Symbol">)</a> <a id="1502" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">⇀⦇</a> <a id="1505" href="Ledger.Conway.Specification.RewardUpdate.html#1261" class="Bound">slot</a> <a id="1510" href="Ledger.Conway.Specification.RewardUpdate.html#485" class="Datatype Operator">,RUPD⦈</a> <a id="1517" href="Ledger.Conway.Specification.RewardUpdate.html#1275" class="Bound">ru&#39;&#39;</a>
      <a id="1528" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="1567" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="1570" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">⊢</a> <a id="1572" href="Ledger.Conway.Specification.RewardUpdate.html#1266" class="Bound">nes</a> <a id="1576" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">⇀⦇</a> <a id="1579" href="Ledger.Conway.Specification.RewardUpdate.html#1261" class="Bound">slot</a> <a id="1584" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">,TICK⦈</a> <a id="1591" class="Keyword">record</a> <a id="1598" href="Ledger.Conway.Specification.RewardUpdate.html#1270" class="Bound">nes&#39;</a> <a id="1603" class="Symbol">{</a> <a id="1605" href="Ledger.Conway.Specification.Epoch.html#3269" class="Field">ru</a> <a id="1608" class="Symbol">=</a> <a id="1610" href="Ledger.Conway.Specification.RewardUpdate.html#1275" class="Bound">ru&#39;&#39;</a> <a id="1615" class="Symbol">}</a>

</pre></body></html>