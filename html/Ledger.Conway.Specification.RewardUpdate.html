<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.RewardUpdate</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>

<a id="126" class="Keyword">module</a> <a id="133" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a>
  <a id="176" class="Symbol">(</a><a id="177" href="Ledger.Conway.Specification.RewardUpdate.html#177" class="Bound">txs</a> <a id="181" class="Symbol">:</a> <a id="183" href="Ledger.Conway.Specification.Transaction.html#991" class="Record">TransactionStructure</a><a id="203" class="Symbol">)</a> <a id="205" class="Symbol">(</a><a id="206" class="Keyword">open</a> <a id="211" href="Ledger.Conway.Specification.Transaction.html#991" class="Module">TransactionStructure</a> <a id="232" href="Ledger.Conway.Specification.RewardUpdate.html#177" class="Bound">txs</a><a id="235" class="Symbol">)</a>
  <a id="239" class="Symbol">(</a><a id="240" href="Ledger.Conway.Specification.RewardUpdate.html#240" class="Bound">abs</a> <a id="244" class="Symbol">:</a> <a id="246" href="Ledger.Core.Specification.Abstract.html#828" class="Record">AbstractFunctions</a> <a id="264" href="Ledger.Conway.Specification.RewardUpdate.html#177" class="Bound">txs</a><a id="267" class="Symbol">)</a> <a id="269" class="Symbol">(</a><a id="270" class="Keyword">open</a> <a id="275" href="Ledger.Core.Specification.Abstract.html#828" class="Module">AbstractFunctions</a> <a id="293" href="Ledger.Conway.Specification.RewardUpdate.html#240" class="Bound">abs</a><a id="296" class="Symbol">)</a>
  <a id="300" class="Keyword">where</a>

<a id="307" class="Keyword">open</a> <a id="312" class="Keyword">import</a> <a id="319" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="335" class="Keyword">open</a> <a id="340" class="Keyword">import</a> <a id="347" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="381" href="Ledger.Conway.Specification.RewardUpdate.html#177" class="Bound">txs</a> <a id="385" href="Ledger.Conway.Specification.RewardUpdate.html#240" class="Bound">abs</a>
<a id="389" class="Keyword">open</a> <a id="394" class="Keyword">import</a> <a id="401" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="437" href="Ledger.Conway.Specification.RewardUpdate.html#177" class="Bound">txs</a> <a id="441" href="Ledger.Conway.Specification.RewardUpdate.html#240" class="Bound">abs</a>


<a id="RUpdEnv"></a><a id="447" href="Ledger.Conway.Specification.RewardUpdate.html#447" class="Function">RUpdEnv</a> <a id="455" class="Symbol">:</a> <a id="457" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="462" href="Ledger.Conway.Specification.RewardUpdate.html#447" class="Function">RUpdEnv</a> <a id="470" class="Symbol">=</a> <a id="472" href="Ledger.Conway.Specification.Rewards.html#4923" class="Function">BlocksMade</a> <a id="483" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="485" href="Ledger.Conway.Specification.Epoch.html#1835" class="Record">EpochState</a>


<a id="498" class="Keyword">data</a> <a id="_⊢_⇀⦇_,RUPD⦈_"></a><a id="503" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">_⊢_⇀⦇_,RUPD⦈_</a>
  <a id="519" class="Symbol">:</a> <a id="521" href="Ledger.Conway.Specification.RewardUpdate.html#447" class="Function">RUpdEnv</a> <a id="529" class="Symbol">→</a> <a id="531" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="537" href="Ledger.Conway.Specification.Rewards.html#6266" class="Record">RewardUpdate</a> <a id="550" class="Symbol">→</a> <a id="552" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a> <a id="557" class="Symbol">→</a> <a id="559" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="565" href="Ledger.Conway.Specification.Rewards.html#6266" class="Record">RewardUpdate</a> <a id="578" class="Symbol">→</a> <a id="580" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="585" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Create-Reward-Update"></a><a id="594" href="Ledger.Conway.Specification.RewardUpdate.html#594" class="InductiveConstructor">RUPD-Create-Reward-Update</a> <a id="620" class="Symbol">:</a> <a id="622" class="Symbol">∀</a> <a id="624" class="Symbol">{</a><a id="625" href="Ledger.Conway.Specification.RewardUpdate.html#625" class="Bound">b</a> <a id="627" href="Ledger.Conway.Specification.RewardUpdate.html#627" class="Bound">es</a> <a id="630" href="Ledger.Conway.Specification.RewardUpdate.html#630" class="Bound">s</a><a id="631" class="Symbol">}</a> <a id="633" class="Symbol">{</a><a id="634" href="Ledger.Conway.Specification.RewardUpdate.html#634" class="Bound">ru&#39;</a> <a id="638" class="Symbol">:</a> <a id="640" href="Ledger.Conway.Specification.Rewards.html#6266" class="Record">RewardUpdate</a><a id="652" class="Symbol">}</a> <a id="654" class="Symbol">→</a>
    <a id="660" class="Keyword">let</a>
      <a id="670" href="Ledger.Conway.Specification.RewardUpdate.html#670" class="Bound">ru&#39;</a> <a id="674" class="Symbol">=</a> <a id="676" href="Ledger.Conway.Specification.Epoch.html#5727" class="Function">createRUpd</a> <a id="687" href="Ledger.Core.Specification.Epoch.html#2402" class="Function">SlotsPerEpochᶜ</a> <a id="702" href="Ledger.Conway.Specification.RewardUpdate.html#625" class="Bound">b</a> <a id="704" href="Ledger.Conway.Specification.RewardUpdate.html#627" class="Bound">es</a> <a id="707" href="Ledger.Core.Specification.Epoch.html#2648" class="Function">MaxLovelaceSupplyᶜ</a>
    <a id="730" class="Keyword">in</a>
    <a id="737" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="739" href="Ledger.Conway.Specification.RewardUpdate.html#630" class="Bound">s</a> <a id="741" href="Class.HasOrder.Core.html#848" class="Function Operator">&gt;</a> <a id="743" href="Ledger.Core.Specification.Epoch.html#911" class="Function">firstSlot</a> <a id="753" class="Symbol">(</a><a id="754" href="Ledger.Core.Specification.Epoch.html#858" class="Function">epoch</a> <a id="760" href="Ledger.Conway.Specification.RewardUpdate.html#630" class="Bound">s</a><a id="761" class="Symbol">)</a> <a id="763" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="765" href="Ledger.Core.Specification.Epoch.html#964" class="Function">RandomnessStabilisationWindow</a>
    <a id="799" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
    <a id="836" class="Symbol">(</a><a id="837" href="Ledger.Conway.Specification.RewardUpdate.html#625" class="Bound">b</a> <a id="839" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="841" href="Ledger.Conway.Specification.RewardUpdate.html#627" class="Bound">es</a><a id="843" class="Symbol">)</a> <a id="845" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">⊢</a> <a id="847" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="855" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">⇀⦇</a> <a id="858" href="Ledger.Conway.Specification.RewardUpdate.html#630" class="Bound">s</a> <a id="860" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">,RUPD⦈</a> <a id="867" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="872" href="Ledger.Conway.Specification.RewardUpdate.html#670" class="Bound">ru&#39;</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Reward-Update-Exists"></a><a id="879" href="Ledger.Conway.Specification.RewardUpdate.html#879" class="InductiveConstructor">RUPD-Reward-Update-Exists</a> <a id="905" class="Symbol">:</a> <a id="907" class="Symbol">∀</a> <a id="909" class="Symbol">{</a><a id="910" href="Ledger.Conway.Specification.RewardUpdate.html#910" class="Bound">b</a> <a id="912" href="Ledger.Conway.Specification.RewardUpdate.html#912" class="Bound">es</a> <a id="915" href="Ledger.Conway.Specification.RewardUpdate.html#915" class="Bound">s</a> <a id="917" href="Ledger.Conway.Specification.RewardUpdate.html#917" class="Bound">ru</a><a id="919" class="Symbol">}</a> <a id="921" class="Symbol">→</a>
    <a id="927" href="Prelude.InferenceRules.html#45235" class="Function Operator">────────────────────────────────</a>
    <a id="964" class="Symbol">(</a><a id="965" href="Ledger.Conway.Specification.RewardUpdate.html#910" class="Bound">b</a> <a id="967" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="969" href="Ledger.Conway.Specification.RewardUpdate.html#912" class="Bound">es</a><a id="971" class="Symbol">)</a> <a id="973" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">⊢</a> <a id="975" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="980" href="Ledger.Conway.Specification.RewardUpdate.html#917" class="Bound">ru</a> <a id="983" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">⇀⦇</a> <a id="986" href="Ledger.Conway.Specification.RewardUpdate.html#915" class="Bound">s</a> <a id="988" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">,RUPD⦈</a> <a id="995" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1000" href="Ledger.Conway.Specification.RewardUpdate.html#917" class="Bound">ru</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Reward-Too-Early"></a><a id="1006" href="Ledger.Conway.Specification.RewardUpdate.html#1006" class="InductiveConstructor">RUPD-Reward-Too-Early</a> <a id="1028" class="Symbol">:</a> <a id="1030" class="Symbol">∀</a> <a id="1032" class="Symbol">{</a><a id="1033" href="Ledger.Conway.Specification.RewardUpdate.html#1033" class="Bound">b</a> <a id="1035" href="Ledger.Conway.Specification.RewardUpdate.html#1035" class="Bound">es</a> <a id="1038" href="Ledger.Conway.Specification.RewardUpdate.html#1038" class="Bound">s</a><a id="1039" class="Symbol">}</a> <a id="1041" class="Symbol">→</a>
    <a id="1047" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="1049" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1051" href="Ledger.Conway.Specification.RewardUpdate.html#1038" class="Bound">s</a> <a id="1053" href="Class.HasOrder.Core.html#848" class="Function Operator">&gt;</a> <a id="1055" href="Ledger.Core.Specification.Epoch.html#911" class="Function">firstSlot</a> <a id="1065" class="Symbol">(</a><a id="1066" href="Ledger.Core.Specification.Epoch.html#858" class="Function">epoch</a> <a id="1072" href="Ledger.Conway.Specification.RewardUpdate.html#1038" class="Bound">s</a><a id="1073" class="Symbol">)</a> <a id="1075" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1077" href="Ledger.Core.Specification.Epoch.html#964" class="Function">RandomnessStabilisationWindow</a>
    <a id="1111" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
    <a id="1148" class="Symbol">(</a><a id="1149" href="Ledger.Conway.Specification.RewardUpdate.html#1033" class="Bound">b</a> <a id="1151" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1153" href="Ledger.Conway.Specification.RewardUpdate.html#1035" class="Bound">es</a><a id="1155" class="Symbol">)</a> <a id="1157" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">⊢</a> <a id="1159" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1167" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">⇀⦇</a> <a id="1170" href="Ledger.Conway.Specification.RewardUpdate.html#1038" class="Bound">s</a> <a id="1172" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">,RUPD⦈</a> <a id="1179" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="1189" class="Keyword">data</a> <a id="_⊢_⇀⦇_,TICK⦈_"></a><a id="1194" href="Ledger.Conway.Specification.RewardUpdate.html#1194" class="Datatype Operator">_⊢_⇀⦇_,TICK⦈_</a>
  <a id="1210" class="Symbol">:</a> <a id="1212" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="1214" class="Symbol">→</a> <a id="1216" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a> <a id="1230" class="Symbol">→</a> <a id="1232" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a> <a id="1237" class="Symbol">→</a> <a id="1239" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a> <a id="1253" class="Symbol">→</a> <a id="1255" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1260" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,TICK⦈_.TICK"></a><a id="1269" href="Ledger.Conway.Specification.RewardUpdate.html#1269" class="InductiveConstructor">TICK</a> <a id="1274" class="Symbol">:</a> <a id="1276" class="Symbol">∀</a> <a id="1278" class="Symbol">{</a><a id="1279" href="Ledger.Conway.Specification.RewardUpdate.html#1279" class="Bound">slot</a> <a id="1284" href="Ledger.Conway.Specification.RewardUpdate.html#1284" class="Bound">nes</a> <a id="1288" href="Ledger.Conway.Specification.RewardUpdate.html#1288" class="Bound">nes&#39;</a> <a id="1293" href="Ledger.Conway.Specification.RewardUpdate.html#1293" class="Bound">ru&#39;&#39;</a><a id="1297" class="Symbol">}</a> <a id="1299" class="Symbol">→</a>
    <a id="1305" class="Keyword">let</a> <a id="1309" class="Keyword">open</a> <a id="1314" href="Ledger.Conway.Specification.Epoch.html#3586" class="Module">NewEpochState</a> <a id="1328" class="Keyword">in</a>
    <a id="1335" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="1337" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="1340" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">⊢</a> <a id="1342" href="Ledger.Conway.Specification.RewardUpdate.html#1284" class="Bound">nes</a> <a id="1346" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">⇀⦇</a> <a id="1349" href="Ledger.Core.Specification.Epoch.html#858" class="Function">epoch</a> <a id="1355" href="Ledger.Conway.Specification.RewardUpdate.html#1279" class="Bound">slot</a> <a id="1360" href="Ledger.Conway.Specification.Epoch.html#18091" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="1371" href="Ledger.Conway.Specification.RewardUpdate.html#1288" class="Bound">nes&#39;</a>
    <a id="1380" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="1382" class="Symbol">(</a><a id="1383" href="Ledger.Conway.Specification.RewardUpdate.html#1284" class="Bound">nes</a> <a id="1387" class="Symbol">.</a><a id="1388" href="Ledger.Conway.Specification.Epoch.html#3649" class="Field">bprev</a> <a id="1394" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1396" href="Ledger.Conway.Specification.RewardUpdate.html#1284" class="Bound">nes</a> <a id="1400" class="Symbol">.</a><a id="1401" href="Ledger.Conway.Specification.Epoch.html#3707" class="Field">epochState</a><a id="1411" class="Symbol">)</a> <a id="1413" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">⊢</a> <a id="1415" class="Symbol">(</a><a id="1416" href="Ledger.Conway.Specification.RewardUpdate.html#1288" class="Bound">nes&#39;</a> <a id="1421" class="Symbol">.</a><a id="1422" href="Ledger.Conway.Specification.Epoch.html#3736" class="Field">ru</a><a id="1424" class="Symbol">)</a> <a id="1426" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">⇀⦇</a> <a id="1429" href="Ledger.Conway.Specification.RewardUpdate.html#1279" class="Bound">slot</a> <a id="1434" href="Ledger.Conway.Specification.RewardUpdate.html#503" class="Datatype Operator">,RUPD⦈</a> <a id="1441" href="Ledger.Conway.Specification.RewardUpdate.html#1293" class="Bound">ru&#39;&#39;</a>
      <a id="1452" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="1491" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="1494" href="Ledger.Conway.Specification.RewardUpdate.html#1194" class="Datatype Operator">⊢</a> <a id="1496" href="Ledger.Conway.Specification.RewardUpdate.html#1284" class="Bound">nes</a> <a id="1500" href="Ledger.Conway.Specification.RewardUpdate.html#1194" class="Datatype Operator">⇀⦇</a> <a id="1503" href="Ledger.Conway.Specification.RewardUpdate.html#1279" class="Bound">slot</a> <a id="1508" href="Ledger.Conway.Specification.RewardUpdate.html#1194" class="Datatype Operator">,TICK⦈</a> <a id="1515" class="Keyword">record</a> <a id="1522" href="Ledger.Conway.Specification.RewardUpdate.html#1288" class="Bound">nes&#39;</a> <a id="1527" class="Symbol">{</a> <a id="1529" href="Ledger.Conway.Specification.Epoch.html#3736" class="Field">ru</a> <a id="1532" class="Symbol">=</a> <a id="1534" href="Ledger.Conway.Specification.RewardUpdate.html#1293" class="Bound">ru&#39;&#39;</a> <a id="1539" class="Symbol">}</a>

</pre></body></html>