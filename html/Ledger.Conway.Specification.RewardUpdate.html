<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.RewardUpdate</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="124" class="Keyword">module</a> <a id="131" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a>
  <a id="174" class="Symbol">(</a><a id="175" href="Ledger.Conway.Specification.RewardUpdate.html#175" class="Bound">txs</a> <a id="179" class="Symbol">:</a> <a id="181" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="201" class="Symbol">)</a> <a id="203" class="Symbol">(</a><a id="204" class="Keyword">open</a> <a id="209" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="230" href="Ledger.Conway.Specification.RewardUpdate.html#175" class="Bound">txs</a><a id="233" class="Symbol">)</a>
  <a id="237" class="Symbol">(</a><a id="238" href="Ledger.Conway.Specification.RewardUpdate.html#238" class="Bound">abs</a> <a id="242" class="Symbol">:</a> <a id="244" href="Ledger.Core.Specification.Abstract.html#651" class="Record">AbstractFunctions</a> <a id="262" href="Ledger.Conway.Specification.RewardUpdate.html#175" class="Bound">txs</a><a id="265" class="Symbol">)</a> <a id="267" class="Symbol">(</a><a id="268" class="Keyword">open</a> <a id="273" href="Ledger.Core.Specification.Abstract.html#651" class="Module">AbstractFunctions</a> <a id="291" href="Ledger.Conway.Specification.RewardUpdate.html#238" class="Bound">abs</a><a id="294" class="Symbol">)</a>
  <a id="298" class="Keyword">where</a>

<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="333" class="Keyword">open</a> <a id="338" class="Keyword">import</a> <a id="345" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="379" href="Ledger.Conway.Specification.RewardUpdate.html#175" class="Bound">txs</a> <a id="383" href="Ledger.Conway.Specification.RewardUpdate.html#238" class="Bound">abs</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="435" href="Ledger.Conway.Specification.RewardUpdate.html#175" class="Bound">txs</a> <a id="439" href="Ledger.Conway.Specification.RewardUpdate.html#238" class="Bound">abs</a>


<a id="RUpdEnv"></a><a id="445" href="Ledger.Conway.Specification.RewardUpdate.html#445" class="Function">RUpdEnv</a> <a id="453" class="Symbol">:</a> <a id="455" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="460" href="Ledger.Conway.Specification.RewardUpdate.html#445" class="Function">RUpdEnv</a> <a id="468" class="Symbol">=</a> <a id="470" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a> <a id="481" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="483" href="Ledger.Conway.Specification.Epoch.html#1833" class="Record">EpochState</a>


<a id="496" class="Keyword">data</a> <a id="_⊢_⇀⦇_,RUPD⦈_"></a><a id="501" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">_⊢_⇀⦇_,RUPD⦈_</a>
  <a id="517" class="Symbol">:</a> <a id="519" href="Ledger.Conway.Specification.RewardUpdate.html#445" class="Function">RUpdEnv</a> <a id="527" class="Symbol">→</a> <a id="529" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="535" href="Ledger.Conway.Specification.Rewards.html#6264" class="Record">RewardUpdate</a> <a id="548" class="Symbol">→</a> <a id="550" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a> <a id="555" class="Symbol">→</a> <a id="557" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="563" href="Ledger.Conway.Specification.Rewards.html#6264" class="Record">RewardUpdate</a> <a id="576" class="Symbol">→</a> <a id="578" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="583" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Create-Reward-Update"></a><a id="592" href="Ledger.Conway.Specification.RewardUpdate.html#592" class="InductiveConstructor">RUPD-Create-Reward-Update</a> <a id="618" class="Symbol">:</a> <a id="620" class="Symbol">∀</a> <a id="622" class="Symbol">{</a><a id="623" href="Ledger.Conway.Specification.RewardUpdate.html#623" class="Bound">b</a> <a id="625" href="Ledger.Conway.Specification.RewardUpdate.html#625" class="Bound">es</a> <a id="628" href="Ledger.Conway.Specification.RewardUpdate.html#628" class="Bound">s</a><a id="629" class="Symbol">}</a> <a id="631" class="Symbol">{</a><a id="632" href="Ledger.Conway.Specification.RewardUpdate.html#632" class="Bound">ru&#39;</a> <a id="636" class="Symbol">:</a> <a id="638" href="Ledger.Conway.Specification.Rewards.html#6264" class="Record">RewardUpdate</a><a id="650" class="Symbol">}</a> <a id="652" class="Symbol">→</a>
    <a id="658" class="Keyword">let</a>
      <a id="668" href="Ledger.Conway.Specification.RewardUpdate.html#668" class="Bound">ru&#39;</a> <a id="672" class="Symbol">=</a> <a id="674" href="Ledger.Conway.Specification.Epoch.html#5483" class="Function">createRUpd</a> <a id="685" href="Ledger.Core.Specification.Epoch.html#2402" class="Function">SlotsPerEpochᶜ</a> <a id="700" href="Ledger.Conway.Specification.RewardUpdate.html#623" class="Bound">b</a> <a id="702" href="Ledger.Conway.Specification.RewardUpdate.html#625" class="Bound">es</a> <a id="705" href="Ledger.Core.Specification.Epoch.html#2648" class="Function">MaxLovelaceSupplyᶜ</a>
    <a id="728" class="Keyword">in</a>
    <a id="735" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="737" href="Ledger.Conway.Specification.RewardUpdate.html#628" class="Bound">s</a> <a id="739" href="Class.HasOrder.Core.html#848" class="Function Operator">&gt;</a> <a id="741" href="Ledger.Core.Specification.Epoch.html#911" class="Function">firstSlot</a> <a id="751" class="Symbol">(</a><a id="752" href="Ledger.Core.Specification.Epoch.html#858" class="Function">epoch</a> <a id="758" href="Ledger.Conway.Specification.RewardUpdate.html#628" class="Bound">s</a><a id="759" class="Symbol">)</a> <a id="761" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="763" href="Ledger.Core.Specification.Epoch.html#964" class="Function">RandomnessStabilisationWindow</a>
    <a id="797" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
    <a id="834" class="Symbol">(</a><a id="835" href="Ledger.Conway.Specification.RewardUpdate.html#623" class="Bound">b</a> <a id="837" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="839" href="Ledger.Conway.Specification.RewardUpdate.html#625" class="Bound">es</a><a id="841" class="Symbol">)</a> <a id="843" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">⊢</a> <a id="845" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="853" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">⇀⦇</a> <a id="856" href="Ledger.Conway.Specification.RewardUpdate.html#628" class="Bound">s</a> <a id="858" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">,RUPD⦈</a> <a id="865" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="870" href="Ledger.Conway.Specification.RewardUpdate.html#668" class="Bound">ru&#39;</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Reward-Update-Exists"></a><a id="877" href="Ledger.Conway.Specification.RewardUpdate.html#877" class="InductiveConstructor">RUPD-Reward-Update-Exists</a> <a id="903" class="Symbol">:</a> <a id="905" class="Symbol">∀</a> <a id="907" class="Symbol">{</a><a id="908" href="Ledger.Conway.Specification.RewardUpdate.html#908" class="Bound">b</a> <a id="910" href="Ledger.Conway.Specification.RewardUpdate.html#910" class="Bound">es</a> <a id="913" href="Ledger.Conway.Specification.RewardUpdate.html#913" class="Bound">s</a> <a id="915" href="Ledger.Conway.Specification.RewardUpdate.html#915" class="Bound">ru</a><a id="917" class="Symbol">}</a> <a id="919" class="Symbol">→</a>
    <a id="925" href="Prelude.InferenceRules.html#45235" class="Function Operator">────────────────────────────────</a>
    <a id="962" class="Symbol">(</a><a id="963" href="Ledger.Conway.Specification.RewardUpdate.html#908" class="Bound">b</a> <a id="965" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="967" href="Ledger.Conway.Specification.RewardUpdate.html#910" class="Bound">es</a><a id="969" class="Symbol">)</a> <a id="971" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">⊢</a> <a id="973" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="978" href="Ledger.Conway.Specification.RewardUpdate.html#915" class="Bound">ru</a> <a id="981" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">⇀⦇</a> <a id="984" href="Ledger.Conway.Specification.RewardUpdate.html#913" class="Bound">s</a> <a id="986" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">,RUPD⦈</a> <a id="993" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="998" href="Ledger.Conway.Specification.RewardUpdate.html#915" class="Bound">ru</a>

  <a id="_⊢_⇀⦇_,RUPD⦈_.RUPD-Reward-Too-Early"></a><a id="1004" href="Ledger.Conway.Specification.RewardUpdate.html#1004" class="InductiveConstructor">RUPD-Reward-Too-Early</a> <a id="1026" class="Symbol">:</a> <a id="1028" class="Symbol">∀</a> <a id="1030" class="Symbol">{</a><a id="1031" href="Ledger.Conway.Specification.RewardUpdate.html#1031" class="Bound">b</a> <a id="1033" href="Ledger.Conway.Specification.RewardUpdate.html#1033" class="Bound">es</a> <a id="1036" href="Ledger.Conway.Specification.RewardUpdate.html#1036" class="Bound">s</a><a id="1037" class="Symbol">}</a> <a id="1039" class="Symbol">→</a>
    <a id="1045" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="1047" href="Relation.Nullary.Negation.Core.html#677" class="Function Operator">¬</a> <a id="1049" href="Ledger.Conway.Specification.RewardUpdate.html#1036" class="Bound">s</a> <a id="1051" href="Class.HasOrder.Core.html#848" class="Function Operator">&gt;</a> <a id="1053" href="Ledger.Core.Specification.Epoch.html#911" class="Function">firstSlot</a> <a id="1063" class="Symbol">(</a><a id="1064" href="Ledger.Core.Specification.Epoch.html#858" class="Function">epoch</a> <a id="1070" href="Ledger.Conway.Specification.RewardUpdate.html#1036" class="Bound">s</a><a id="1071" class="Symbol">)</a> <a id="1073" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1075" href="Ledger.Core.Specification.Epoch.html#964" class="Function">RandomnessStabilisationWindow</a>
    <a id="1109" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
    <a id="1146" class="Symbol">(</a><a id="1147" href="Ledger.Conway.Specification.RewardUpdate.html#1031" class="Bound">b</a> <a id="1149" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1151" href="Ledger.Conway.Specification.RewardUpdate.html#1033" class="Bound">es</a><a id="1153" class="Symbol">)</a> <a id="1155" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">⊢</a> <a id="1157" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1165" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">⇀⦇</a> <a id="1168" href="Ledger.Conway.Specification.RewardUpdate.html#1036" class="Bound">s</a> <a id="1170" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">,RUPD⦈</a> <a id="1177" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>


<a id="1187" class="Keyword">data</a> <a id="_⊢_⇀⦇_,TICK⦈_"></a><a id="1192" href="Ledger.Conway.Specification.RewardUpdate.html#1192" class="Datatype Operator">_⊢_⇀⦇_,TICK⦈_</a>
  <a id="1208" class="Symbol">:</a> <a id="1210" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="1212" class="Symbol">→</a> <a id="1214" href="Ledger.Conway.Specification.Epoch.html#3360" class="Record">NewEpochState</a> <a id="1228" class="Symbol">→</a> <a id="1230" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a> <a id="1235" class="Symbol">→</a> <a id="1237" href="Ledger.Conway.Specification.Epoch.html#3360" class="Record">NewEpochState</a> <a id="1251" class="Symbol">→</a> <a id="1253" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1258" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,TICK⦈_.TICK"></a><a id="1267" href="Ledger.Conway.Specification.RewardUpdate.html#1267" class="InductiveConstructor">TICK</a> <a id="1272" class="Symbol">:</a> <a id="1274" class="Symbol">∀</a> <a id="1276" class="Symbol">{</a><a id="1277" href="Ledger.Conway.Specification.RewardUpdate.html#1277" class="Bound">slot</a> <a id="1282" href="Ledger.Conway.Specification.RewardUpdate.html#1282" class="Bound">nes</a> <a id="1286" href="Ledger.Conway.Specification.RewardUpdate.html#1286" class="Bound">nes&#39;</a> <a id="1291" href="Ledger.Conway.Specification.RewardUpdate.html#1291" class="Bound">ru&#39;&#39;</a><a id="1295" class="Symbol">}</a> <a id="1297" class="Symbol">→</a>
    <a id="1303" class="Keyword">let</a> <a id="1307" class="Keyword">open</a> <a id="1312" href="Ledger.Conway.Specification.Epoch.html#3360" class="Module">NewEpochState</a> <a id="1326" class="Keyword">in</a>
    <a id="1333" class="Comment">-- TODO: Is this really how it should be?</a>
    <a id="1379" class="Comment">-- We are skipping adoptGenesisDelegs here.</a>
    <a id="1427" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="1429" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="1432" href="Ledger.Conway.Specification.Epoch.html#17909" class="Datatype Operator">⊢</a> <a id="1434" href="Ledger.Conway.Specification.RewardUpdate.html#1282" class="Bound">nes</a> <a id="1438" href="Ledger.Conway.Specification.Epoch.html#17909" class="Datatype Operator">⇀⦇</a> <a id="1441" href="Ledger.Core.Specification.Epoch.html#858" class="Function">epoch</a> <a id="1447" href="Ledger.Conway.Specification.RewardUpdate.html#1277" class="Bound">slot</a> <a id="1452" href="Ledger.Conway.Specification.Epoch.html#17909" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="1463" href="Ledger.Conway.Specification.RewardUpdate.html#1286" class="Bound">nes&#39;</a>
    <a id="1472" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="1474" class="Symbol">(</a><a id="1475" href="Ledger.Conway.Specification.RewardUpdate.html#1282" class="Bound">nes</a> <a id="1479" class="Symbol">.</a><a id="1480" href="Ledger.Conway.Specification.Epoch.html#3423" class="Field">bprev</a> <a id="1486" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1488" href="Ledger.Conway.Specification.RewardUpdate.html#1282" class="Bound">nes</a> <a id="1492" class="Symbol">.</a><a id="1493" href="Ledger.Conway.Specification.Epoch.html#3481" class="Field">epochState</a><a id="1503" class="Symbol">)</a> <a id="1505" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">⊢</a> <a id="1507" class="Symbol">(</a><a id="1508" href="Ledger.Conway.Specification.RewardUpdate.html#1286" class="Bound">nes&#39;</a> <a id="1513" class="Symbol">.</a><a id="1514" href="Ledger.Conway.Specification.Epoch.html#3510" class="Field">ru</a><a id="1516" class="Symbol">)</a> <a id="1518" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">⇀⦇</a> <a id="1521" href="Ledger.Conway.Specification.RewardUpdate.html#1277" class="Bound">slot</a> <a id="1526" href="Ledger.Conway.Specification.RewardUpdate.html#501" class="Datatype Operator">,RUPD⦈</a> <a id="1533" href="Ledger.Conway.Specification.RewardUpdate.html#1291" class="Bound">ru&#39;&#39;</a>
      <a id="1544" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="1583" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="1586" href="Ledger.Conway.Specification.RewardUpdate.html#1192" class="Datatype Operator">⊢</a> <a id="1588" href="Ledger.Conway.Specification.RewardUpdate.html#1282" class="Bound">nes</a> <a id="1592" href="Ledger.Conway.Specification.RewardUpdate.html#1192" class="Datatype Operator">⇀⦇</a> <a id="1595" href="Ledger.Conway.Specification.RewardUpdate.html#1277" class="Bound">slot</a> <a id="1600" href="Ledger.Conway.Specification.RewardUpdate.html#1192" class="Datatype Operator">,TICK⦈</a> <a id="1607" class="Keyword">record</a> <a id="1614" href="Ledger.Conway.Specification.RewardUpdate.html#1286" class="Bound">nes&#39;</a> <a id="1619" class="Symbol">{</a> <a id="1621" href="Ledger.Conway.Specification.Epoch.html#3510" class="Field">ru</a> <a id="1624" class="Symbol">=</a> <a id="1626" href="Ledger.Conway.Specification.RewardUpdate.html#1291" class="Bound">ru&#39;&#39;</a> <a id="1631" class="Symbol">}</a>

</pre></body></html>