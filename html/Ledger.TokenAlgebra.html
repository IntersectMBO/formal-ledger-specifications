<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.TokenAlgebra</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>
<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Prelude.html" class="Module">Prelude</a> <a id="45" class="Keyword">using</a> <a id="51" class="Symbol">(</a><a id="52" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="56" class="Symbol">)</a>
<a id="58" class="Keyword">module</a> <a id="65" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="85" class="Symbol">(</a>


  <a id="91" href="Ledger.TokenAlgebra.html#91" class="Bound">PolicyId</a>



  <a id="105" class="Symbol">:</a> <a id="107" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="111" class="Symbol">)</a> <a id="113" class="Keyword">where</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="147" class="Keyword">open</a> <a id="152" class="Keyword">import</a> <a id="159" href="Algebra.html" class="Module">Algebra</a>              <a id="180" class="Keyword">using</a> <a id="186" class="Symbol">(</a><a id="187" href="Algebra.Bundles.html#7315" class="Record">Monoid</a><a id="193" class="Symbol">)</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Algebra.Morphism.html" class="Module">Algebra.Morphism</a>     <a id="228" class="Keyword">using</a> <a id="234" class="Symbol">(</a><a id="235" class="Keyword">module</a> <a id="242" href="Algebra.Morphism.Structures.html#4053" class="Module">MonoidMorphisms</a> <a id="258" class="Symbol">)</a>
<a id="260" class="Keyword">open</a> <a id="265" class="Keyword">import</a> <a id="272" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>  <a id="293" class="Keyword">using</a> <a id="299" class="Symbol">(</a><a id="300" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="310" class="Symbol">)</a>
<a id="312" class="Keyword">open</a> <a id="317" class="Keyword">import</a> <a id="324" href="Relation.Binary.html" class="Module">Relation.Binary</a>      <a id="345" class="Keyword">using</a> <a id="351" class="Symbol">(</a><a id="352" href="Relation.Binary.Core.html#896" class="Function">Rel</a><a id="355" class="Symbol">)</a>
<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Relation.Unary.html" class="Module">Relation.Unary</a>       <a id="390" class="Keyword">using</a> <a id="396" class="Symbol">(</a><a id="397" href="Relation.Unary.html#1178" class="Function">Pred</a><a id="401" class="Symbol">)</a>

<a id="MemoryEstimate"></a><a id="404" href="Ledger.TokenAlgebra.html#404" class="Function">MemoryEstimate</a> <a id="419" class="Symbol">:</a> <a id="421" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="425" href="Ledger.TokenAlgebra.html#404" class="Function">MemoryEstimate</a> <a id="440" class="Symbol">=</a> <a id="442" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>


<a id="446" class="Keyword">record</a> <a id="TokenAlgebra"></a><a id="453" href="Ledger.TokenAlgebra.html#453" class="Record">TokenAlgebra</a> <a id="466" class="Symbol">:</a> <a id="468" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="474" class="Keyword">where</a>
  <a id="482" class="Keyword">field</a>
    <a id="TokenAlgebra.Value"></a><a id="492" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="498" class="Symbol">:</a> <a id="500" href="Agda.Primitive.html#388" class="Primitive">Set</a>
    <a id="508" class="Symbol">⦃</a> <a id="TokenAlgebra.Value-CommutativeMonoid"></a><a id="510" href="Ledger.TokenAlgebra.html#510" class="Field">Value-CommutativeMonoid</a> <a id="534" class="Symbol">⦄</a> <a id="536" class="Symbol">:</a> <a id="538" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="556" href="Level.html#521" class="Function">0ℓ</a> <a id="559" href="Level.html#521" class="Function">0ℓ</a> <a id="562" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>



  <a id="573" class="Keyword">open</a> <a id="578" href="Algebra.Bundles.html#7886" class="Module">Algebra.CommutativeMonoid</a> <a id="604" class="Symbol">(</a><a id="605" href="Class.CommutativeMonoid.Core.html#507" class="Function">Conversion.toBundle</a> <a id="625" href="Ledger.TokenAlgebra.html#510" class="Field">Value-CommutativeMonoid</a><a id="648" class="Symbol">)</a> <a id="650" class="Keyword">public</a>
    <a id="661" class="Keyword">using</a> <a id="667" class="Symbol">(</a><a id="668" href="Algebra.Bundles.html#8008" class="Field Operator">_≈_</a> <a id="672" class="Symbol">;</a> <a id="674" href="Algebra.Bundles.html#8086" class="Field">ε</a> <a id="676" class="Symbol">;</a> <a id="678" href="Algebra.Bundles.html#8230" class="Function">monoid</a> <a id="685" class="Symbol">;</a> <a id="687" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a><a id="696" class="Symbol">)</a>
    <a id="702" class="Keyword">renaming</a> <a id="711" class="Symbol">(</a><a id="712" href="Algebra.Bundles.html#8048" class="Field Operator">_∙_</a> <a id="716" class="Symbol">to</a> <a id="719" class="Field Operator">_+ᵛ_</a><a id="723" class="Symbol">)</a>

  <a id="728" class="Keyword">open</a> <a id="733" href="Algebra.Morphism.Structures.html#4053" class="Module">MonoidMorphisms</a> <a id="749" class="Symbol">(</a><a id="750" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a><a id="759" class="Symbol">)</a> <a id="761" class="Symbol">(</a><a id="762" href="Algebra.Bundles.html#7708" class="Function">Monoid.rawMonoid</a> <a id="779" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="789" class="Symbol">)</a> <a id="791" class="Keyword">public</a>
  <a id="800" class="Keyword">field</a>


    <a id="TokenAlgebra.coin"></a><a id="812" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a>                      <a id="838" class="Symbol">:</a> <a id="840" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="846" class="Symbol">→</a> <a id="848" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="TokenAlgebra.inject"></a><a id="857" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a>                    <a id="883" class="Symbol">:</a> <a id="885" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="890" class="Symbol">→</a> <a id="892" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>
    <a id="TokenAlgebra.policies"></a><a id="902" href="Ledger.TokenAlgebra.html#902" class="Field">policies</a>                  <a id="928" class="Symbol">:</a> <a id="930" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="936" class="Symbol">→</a> <a id="938" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="940" href="Ledger.TokenAlgebra.html#91" class="Bound">PolicyId</a>
    <a id="TokenAlgebra.size"></a><a id="953" href="Ledger.TokenAlgebra.html#953" class="Field">size</a>                      <a id="979" class="Symbol">:</a> <a id="981" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="987" class="Symbol">→</a> <a id="989" href="Ledger.TokenAlgebra.html#404" class="Function">MemoryEstimate</a>
    <a id="TokenAlgebra._≤ᵗ_"></a><a id="1008" href="Ledger.TokenAlgebra.html#1008" class="Field Operator">_≤ᵗ_</a>                      <a id="1034" class="Symbol">:</a> <a id="1036" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="1042" class="Symbol">→</a> <a id="1044" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="1050" class="Symbol">→</a> <a id="1052" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="TokenAlgebra.coin∘inject≗id"></a><a id="1061" href="Ledger.TokenAlgebra.html#1061" class="Field">coin∘inject≗id</a>            <a id="1087" class="Symbol">:</a> <a id="1089" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1094" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1096" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1103" href="Relation.Binary.PropositionalEquality.Core.html#1012" class="Function Operator">≗</a> <a id="1105" href="Function.Base.html#704" class="Function">id</a>
    <a id="TokenAlgebra.coinIsMonoidHomomorphism"></a><a id="1112" href="Ledger.TokenAlgebra.html#1112" class="Field">coinIsMonoidHomomorphism</a>  <a id="1138" class="Symbol">:</a> <a id="1140" href="Algebra.Morphism.Structures.html#4393" class="Record">IsMonoidHomomorphism</a> <a id="1161" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a>



    <a id="1173" class="Symbol">⦃</a> <a id="TokenAlgebra.DecEq-Value"></a><a id="1175" href="Ledger.TokenAlgebra.html#1175" class="Field">DecEq-Value</a> <a id="1187" class="Symbol">⦄</a> <a id="1189" class="Symbol">:</a> <a id="1191" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1197" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>
    <a id="1207" class="Symbol">⦃</a> <a id="TokenAlgebra.Dec-≤ᵗ"></a><a id="1209" href="Ledger.TokenAlgebra.html#1209" class="Field">Dec-≤ᵗ</a> <a id="1216" class="Symbol">⦄</a>      <a id="1223" class="Symbol">:</a> <a id="1225" href="Ledger.TokenAlgebra.html#1008" class="Field Operator">_≤ᵗ_</a> <a id="1230" href="Class.Decidable.Core.html#773" class="Function Operator">⁇²</a>

  <a id="1236" class="Keyword">instance</a>
    <a id="TokenAlgebra.addValue"></a><a id="1249" href="Ledger.TokenAlgebra.html#1249" class="Function">addValue</a> <a id="1258" class="Symbol">:</a> <a id="1260" href="Class.HasAdd.Core.html#104" class="Record">HasAdd</a> <a id="1267" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>
    <a id="1277" href="Ledger.TokenAlgebra.html#1249" class="Function">addValue</a> <a id="1286" class="Symbol">=</a> <a id="1288" class="Keyword">record</a> <a id="1295" class="Symbol">{</a> <a id="1297" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="1301" class="Symbol">=</a> <a id="1303" href="Ledger.TokenAlgebra.html#719" class="Function Operator">_+ᵛ_</a> <a id="1308" class="Symbol">}</a>

  <a id="TokenAlgebra.coin-inject-lemma"></a><a id="1313" href="Ledger.TokenAlgebra.html#1313" class="Function">coin-inject-lemma</a> <a id="1331" class="Symbol">:</a> <a id="1333" class="Symbol">∀</a> <a id="1335" class="Symbol">{</a><a id="1336" href="Ledger.TokenAlgebra.html#1336" class="Bound">val</a><a id="1339" class="Symbol">}</a> <a id="1341" class="Symbol">{</a><a id="1342" href="Ledger.TokenAlgebra.html#1342" class="Bound">c</a><a id="1343" class="Symbol">}</a> <a id="1345" class="Symbol">→</a> <a id="1347" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1352" class="Symbol">(</a><a id="1353" href="Ledger.TokenAlgebra.html#1336" class="Bound">val</a> <a id="1357" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1359" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1366" href="Ledger.TokenAlgebra.html#1342" class="Bound">c</a><a id="1367" class="Symbol">)</a> <a id="1369" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1371" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1376" href="Ledger.TokenAlgebra.html#1336" class="Bound">val</a> <a id="1380" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1382" href="Ledger.TokenAlgebra.html#1342" class="Bound">c</a>
  <a id="1386" href="Ledger.TokenAlgebra.html#1313" class="Function">coin-inject-lemma</a> <a id="1404" class="Symbol">{</a><a id="1405" href="Ledger.TokenAlgebra.html#1405" class="Bound">val</a><a id="1408" class="Symbol">}</a> <a id="1410" class="Symbol">{</a><a id="1411" href="Ledger.TokenAlgebra.html#1411" class="Bound">c</a><a id="1412" class="Symbol">}</a> <a id="1414" class="Symbol">=</a> <a id="1416" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="1426" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1431" class="Symbol">(</a><a id="1432" href="Ledger.TokenAlgebra.html#1405" class="Bound">val</a> <a id="1436" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1438" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1445" href="Ledger.TokenAlgebra.html#1411" class="Bound">c</a><a id="1446" class="Symbol">)</a>         <a id="1456" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1459" href="Algebra.Morphism.Structures.html#2891" class="Function">homo</a> <a id="1464" href="Ledger.TokenAlgebra.html#1112" class="Field">coinIsMonoidHomomorphism</a> <a id="1489" href="Ledger.TokenAlgebra.html#1405" class="Bound">val</a> <a id="1493" class="Symbol">(</a><a id="1494" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1501" href="Ledger.TokenAlgebra.html#1411" class="Bound">c</a><a id="1502" class="Symbol">)</a> <a id="1504" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1510" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1515" href="Ledger.TokenAlgebra.html#1405" class="Bound">val</a> <a id="1519" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1521" class="Symbol">(</a><a id="1522" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1527" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1529" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a><a id="1535" class="Symbol">)</a> <a id="1537" href="Ledger.TokenAlgebra.html#1411" class="Bound">c</a>  <a id="1540" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1543" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="1548" class="Symbol">(</a><a id="1549" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1554" href="Ledger.TokenAlgebra.html#1405" class="Bound">val</a> <a id="1558" href="Class.HasAdd.Core.html#162" class="Field Operator">+_</a><a id="1560" class="Symbol">)</a> <a id="1562" class="Symbol">(</a><a id="1563" href="Ledger.TokenAlgebra.html#1061" class="Field">coin∘inject≗id</a> <a id="1578" href="Ledger.TokenAlgebra.html#1411" class="Bound">c</a><a id="1579" class="Symbol">)</a> <a id="1581" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1587" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1592" href="Ledger.TokenAlgebra.html#1405" class="Bound">val</a> <a id="1596" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1598" href="Ledger.TokenAlgebra.html#1411" class="Bound">c</a>                  <a id="1617" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
    <a id="1623" class="Keyword">where</a>
    <a id="1633" class="Keyword">open</a> <a id="1638" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>
    <a id="1654" class="Keyword">open</a> <a id="1659" href="Algebra.Morphism.Structures.html#4393" class="Module">MonoidMorphisms.IsMonoidHomomorphism</a>


  <a id="TokenAlgebra.sumᵛ"></a><a id="1700" href="Ledger.TokenAlgebra.html#1700" class="Function">sumᵛ</a> <a id="1705" class="Symbol">:</a> <a id="1707" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1712" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="1718" class="Symbol">→</a> <a id="1720" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>
  <a id="1728" href="Ledger.TokenAlgebra.html#1700" class="Function">sumᵛ</a> <a id="1733" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1736" class="Symbol">=</a> <a id="1738" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1745" class="Number">0</a>
  <a id="1749" href="Ledger.TokenAlgebra.html#1700" class="Function">sumᵛ</a> <a id="1754" class="Symbol">(</a><a id="1755" href="Ledger.TokenAlgebra.html#1755" class="Bound">x</a> <a id="1757" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1759" href="Ledger.TokenAlgebra.html#1759" class="Bound">l</a><a id="1760" class="Symbol">)</a> <a id="1762" class="Symbol">=</a> <a id="1764" href="Ledger.TokenAlgebra.html#1755" class="Bound">x</a> <a id="1766" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1768" href="Ledger.TokenAlgebra.html#1700" class="Function">sumᵛ</a> <a id="1773" href="Ledger.TokenAlgebra.html#1759" class="Bound">l</a>

</pre></body></html>