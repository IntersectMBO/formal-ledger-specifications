<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.TokenAlgebra</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>
<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Prelude.html" class="Module">Prelude</a> <a id="45" class="Keyword">using</a> <a id="51" class="Symbol">(</a><a id="52" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="56" class="Symbol">)</a>
<a id="58" class="Keyword">module</a> <a id="65" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="85" class="Symbol">(</a>


  <a id="91" href="Ledger.TokenAlgebra.html#91" class="Bound">PolicyId</a>



  <a id="105" class="Symbol">:</a> <a id="107" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="111" class="Symbol">)</a> <a id="113" class="Keyword">where</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="147" class="Keyword">open</a> <a id="152" class="Keyword">import</a> <a id="159" href="Algebra.html" class="Module">Algebra</a>              <a id="180" class="Keyword">using</a> <a id="186" class="Symbol">(</a><a id="187" href="Algebra.Bundles.html#7315" class="Record">Monoid</a><a id="193" class="Symbol">)</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Algebra.Morphism.html" class="Module">Algebra.Morphism</a>     <a id="228" class="Keyword">using</a> <a id="234" class="Symbol">(</a><a id="235" class="Keyword">module</a> <a id="242" href="Algebra.Morphism.Structures.html#4053" class="Module">MonoidMorphisms</a> <a id="258" class="Symbol">)</a>
<a id="260" class="Keyword">open</a> <a id="265" class="Keyword">import</a> <a id="272" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>  <a id="293" class="Keyword">using</a> <a id="299" class="Symbol">(</a><a id="300" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="310" class="Symbol">)</a>
<a id="312" class="Keyword">open</a> <a id="317" class="Keyword">import</a> <a id="324" href="Relation.Binary.html" class="Module">Relation.Binary</a>      <a id="345" class="Keyword">using</a> <a id="351" class="Symbol">(</a><a id="352" href="Relation.Binary.Core.html#896" class="Function">Rel</a><a id="355" class="Symbol">)</a>
<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Relation.Unary.html" class="Module">Relation.Unary</a>       <a id="390" class="Keyword">using</a> <a id="396" class="Symbol">(</a><a id="397" href="Relation.Unary.html#1178" class="Function">Pred</a><a id="401" class="Symbol">)</a>

<a id="MemoryEstimate"></a><a id="404" href="Ledger.TokenAlgebra.html#404" class="Function">MemoryEstimate</a> <a id="419" class="Symbol">:</a> <a id="421" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="425" href="Ledger.TokenAlgebra.html#404" class="Function">MemoryEstimate</a> <a id="440" class="Symbol">=</a> <a id="442" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>


<a id="446" class="Keyword">record</a> <a id="TokenAlgebra"></a><a id="453" href="Ledger.TokenAlgebra.html#453" class="Record">TokenAlgebra</a> <a id="466" class="Symbol">:</a> <a id="468" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="474" class="Keyword">where</a>
  <a id="482" class="Keyword">field</a>
    <a id="TokenAlgebra.Value"></a><a id="492" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="498" class="Symbol">:</a> <a id="500" href="Agda.Primitive.html#388" class="Primitive">Set</a>
    <a id="508" class="Symbol">⦃</a> <a id="TokenAlgebra.Value-CommutativeMonoid"></a><a id="510" href="Ledger.TokenAlgebra.html#510" class="Field">Value-CommutativeMonoid</a> <a id="534" class="Symbol">⦄</a> <a id="536" class="Symbol">:</a> <a id="538" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="556" href="Level.html#521" class="Function">0ℓ</a> <a id="559" href="Level.html#521" class="Function">0ℓ</a> <a id="562" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>



  <a id="573" class="Keyword">open</a> <a id="578" href="Algebra.Bundles.html#7886" class="Module">Algebra.CommutativeMonoid</a> <a id="604" class="Symbol">(</a><a id="605" href="Class.CommutativeMonoid.Core.html#507" class="Function">Conversion.toBundle</a> <a id="625" href="Ledger.TokenAlgebra.html#510" class="Field">Value-CommutativeMonoid</a><a id="648" class="Symbol">)</a> <a id="650" class="Keyword">public</a>
    <a id="661" class="Keyword">using</a> <a id="667" class="Symbol">(</a><a id="668" href="Algebra.Bundles.html#8008" class="Field Operator">_≈_</a> <a id="672" class="Symbol">;</a> <a id="674" href="Algebra.Bundles.html#8086" class="Field">ε</a> <a id="676" class="Symbol">;</a> <a id="678" href="Algebra.Bundles.html#8230" class="Function">monoid</a> <a id="685" class="Symbol">;</a> <a id="687" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a><a id="696" class="Symbol">)</a>
    <a id="702" class="Keyword">renaming</a> <a id="711" class="Symbol">(</a><a id="712" href="Algebra.Bundles.html#8048" class="Field Operator">_∙_</a> <a id="716" class="Symbol">to</a> <a id="719" class="Field Operator">_+ᵛ_</a><a id="723" class="Symbol">)</a>

  <a id="728" class="Keyword">open</a> <a id="733" href="Algebra.Morphism.Structures.html#4053" class="Module">MonoidMorphisms</a> <a id="749" class="Symbol">(</a><a id="750" href="Algebra.Bundles.html#7708" class="Function">rawMonoid</a><a id="759" class="Symbol">)</a> <a id="761" class="Symbol">(</a><a id="762" href="Algebra.Bundles.html#7708" class="Function">Monoid.rawMonoid</a> <a id="779" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="789" class="Symbol">)</a> <a id="791" class="Keyword">public</a>
  <a id="800" class="Keyword">field</a>


    <a id="TokenAlgebra.coin"></a><a id="812" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a>                      <a id="838" class="Symbol">:</a> <a id="840" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="846" class="Symbol">→</a> <a id="848" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="TokenAlgebra.inject"></a><a id="857" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a>                    <a id="883" class="Symbol">:</a> <a id="885" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a> <a id="890" class="Symbol">→</a> <a id="892" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>
    <a id="TokenAlgebra.policies"></a><a id="902" href="Ledger.TokenAlgebra.html#902" class="Field">policies</a>                  <a id="928" class="Symbol">:</a> <a id="930" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="936" class="Symbol">→</a> <a id="938" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="940" href="Ledger.TokenAlgebra.html#91" class="Bound">PolicyId</a>
    <a id="TokenAlgebra.size"></a><a id="953" href="Ledger.TokenAlgebra.html#953" class="Field">size</a>                      <a id="979" class="Symbol">:</a> <a id="981" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="987" class="Symbol">→</a> <a id="989" href="Ledger.TokenAlgebra.html#404" class="Function">MemoryEstimate</a>
    <a id="TokenAlgebra._≤ᵗ_"></a><a id="1008" href="Ledger.TokenAlgebra.html#1008" class="Field Operator">_≤ᵗ_</a>                      <a id="1034" class="Symbol">:</a> <a id="1036" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="1042" class="Symbol">→</a> <a id="1044" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="1050" class="Symbol">→</a> <a id="1052" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="TokenAlgebra.AssetName"></a><a id="1061" href="Ledger.TokenAlgebra.html#1061" class="Field">AssetName</a>                 <a id="1087" class="Symbol">:</a> <a id="1089" href="Agda.Primitive.html#388" class="Primitive">Set</a>
    <a id="TokenAlgebra.specialAsset"></a><a id="1097" href="Ledger.TokenAlgebra.html#1097" class="Field">specialAsset</a>              <a id="1123" class="Symbol">:</a> <a id="1125" href="Ledger.TokenAlgebra.html#1061" class="Field">AssetName</a>
    <a id="TokenAlgebra.property"></a><a id="1139" href="Ledger.TokenAlgebra.html#1139" class="Field">property</a>                  <a id="1165" class="Symbol">:</a> <a id="1167" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1172" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1174" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1181" href="Relation.Binary.PropositionalEquality.Core.html#1012" class="Function Operator">≗</a> <a id="1183" href="Function.Base.html#704" class="Function">id</a> <a id="1186" class="Comment">-- FIXME: rename!</a>
    <a id="TokenAlgebra.coinIsMonoidHomomorphism"></a><a id="1208" href="Ledger.TokenAlgebra.html#1208" class="Field">coinIsMonoidHomomorphism</a>  <a id="1234" class="Symbol">:</a> <a id="1236" href="Algebra.Morphism.Structures.html#4393" class="Record">IsMonoidHomomorphism</a> <a id="1257" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a>



    <a id="1269" class="Symbol">⦃</a> <a id="TokenAlgebra.DecEq-Value"></a><a id="1271" href="Ledger.TokenAlgebra.html#1271" class="Field">DecEq-Value</a> <a id="1283" class="Symbol">⦄</a> <a id="1285" class="Symbol">:</a> <a id="1287" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1293" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>
    <a id="1303" class="Symbol">⦃</a> <a id="TokenAlgebra.Dec-≤ᵗ"></a><a id="1305" href="Ledger.TokenAlgebra.html#1305" class="Field">Dec-≤ᵗ</a> <a id="1312" class="Symbol">⦄</a>      <a id="1319" class="Symbol">:</a> <a id="1321" href="Ledger.TokenAlgebra.html#1008" class="Field Operator">_≤ᵗ_</a> <a id="1326" href="Class.Decidable.Core.html#773" class="Function Operator">⁇²</a>

  <a id="1332" class="Keyword">instance</a>
    <a id="TokenAlgebra.addValue"></a><a id="1345" href="Ledger.TokenAlgebra.html#1345" class="Function">addValue</a> <a id="1354" class="Symbol">:</a> <a id="1356" href="Class.HasAdd.Core.html#104" class="Record">HasAdd</a> <a id="1363" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>
    <a id="1373" href="Ledger.TokenAlgebra.html#1345" class="Function">addValue</a> <a id="1382" class="Symbol">=</a> <a id="1384" class="Keyword">record</a> <a id="1391" class="Symbol">{</a> <a id="1393" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="1397" class="Symbol">=</a> <a id="1399" href="Ledger.TokenAlgebra.html#719" class="Function Operator">_+ᵛ_</a> <a id="1404" class="Symbol">}</a>

  <a id="TokenAlgebra.coin-inject-lemma"></a><a id="1409" href="Ledger.TokenAlgebra.html#1409" class="Function">coin-inject-lemma</a> <a id="1427" class="Symbol">:</a> <a id="1429" class="Symbol">∀</a> <a id="1431" class="Symbol">{</a><a id="1432" href="Ledger.TokenAlgebra.html#1432" class="Bound">val</a><a id="1435" class="Symbol">}</a> <a id="1437" class="Symbol">{</a><a id="1438" href="Ledger.TokenAlgebra.html#1438" class="Bound">c</a><a id="1439" class="Symbol">}</a> <a id="1441" class="Symbol">→</a> <a id="1443" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1448" class="Symbol">(</a><a id="1449" href="Ledger.TokenAlgebra.html#1432" class="Bound">val</a> <a id="1453" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1455" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1462" href="Ledger.TokenAlgebra.html#1438" class="Bound">c</a><a id="1463" class="Symbol">)</a> <a id="1465" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1467" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1472" href="Ledger.TokenAlgebra.html#1432" class="Bound">val</a> <a id="1476" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1478" href="Ledger.TokenAlgebra.html#1438" class="Bound">c</a>
  <a id="1482" href="Ledger.TokenAlgebra.html#1409" class="Function">coin-inject-lemma</a> <a id="1500" class="Symbol">{</a><a id="1501" href="Ledger.TokenAlgebra.html#1501" class="Bound">val</a><a id="1504" class="Symbol">}</a> <a id="1506" class="Symbol">{</a><a id="1507" href="Ledger.TokenAlgebra.html#1507" class="Bound">c</a><a id="1508" class="Symbol">}</a> <a id="1510" class="Symbol">=</a> <a id="1512" href="Relation.Binary.Reasoning.Syntax.html#1572" class="Function Operator">begin</a>
    <a id="1522" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1527" class="Symbol">(</a><a id="1528" href="Ledger.TokenAlgebra.html#1501" class="Bound">val</a> <a id="1532" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1534" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1541" href="Ledger.TokenAlgebra.html#1507" class="Bound">c</a><a id="1542" class="Symbol">)</a>         <a id="1552" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1555" href="Algebra.Morphism.Structures.html#2891" class="Function">homo</a> <a id="1560" href="Ledger.TokenAlgebra.html#1208" class="Field">coinIsMonoidHomomorphism</a> <a id="1585" href="Ledger.TokenAlgebra.html#1501" class="Bound">val</a> <a id="1589" class="Symbol">(</a><a id="1590" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1597" href="Ledger.TokenAlgebra.html#1507" class="Bound">c</a><a id="1598" class="Symbol">)</a> <a id="1600" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1606" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1611" href="Ledger.TokenAlgebra.html#1501" class="Bound">val</a> <a id="1615" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1617" class="Symbol">(</a><a id="1618" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1623" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1625" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a><a id="1631" class="Symbol">)</a> <a id="1633" href="Ledger.TokenAlgebra.html#1507" class="Bound">c</a>  <a id="1636" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">≡⟨</a> <a id="1639" href="Relation.Binary.PropositionalEquality.Core.html#1339" class="Function">cong</a> <a id="1644" class="Symbol">(</a><a id="1645" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1650" href="Ledger.TokenAlgebra.html#1501" class="Bound">val</a> <a id="1654" href="Class.HasAdd.Core.html#162" class="Field Operator">+_</a><a id="1656" class="Symbol">)</a> <a id="1658" class="Symbol">(</a><a id="1659" href="Ledger.TokenAlgebra.html#1139" class="Field">property</a> <a id="1668" href="Ledger.TokenAlgebra.html#1507" class="Bound">c</a><a id="1669" class="Symbol">)</a> <a id="1671" href="Relation.Binary.Reasoning.Syntax.html#11048" class="Function">⟩</a>
    <a id="1677" href="Ledger.TokenAlgebra.html#812" class="Field">coin</a> <a id="1682" href="Ledger.TokenAlgebra.html#1501" class="Bound">val</a> <a id="1686" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1688" href="Ledger.TokenAlgebra.html#1507" class="Bound">c</a>                  <a id="1707" href="Relation.Binary.Reasoning.Syntax.html#12345" class="Function Operator">∎</a>
    <a id="1713" class="Keyword">where</a>
    <a id="1723" class="Keyword">open</a> <a id="1728" href="Relation.Binary.PropositionalEquality.Properties.html#6731" class="Module">≡-Reasoning</a>
    <a id="1744" class="Keyword">open</a> <a id="1749" href="Algebra.Morphism.Structures.html#4393" class="Module">MonoidMorphisms.IsMonoidHomomorphism</a>


  <a id="TokenAlgebra.sumᵛ"></a><a id="1790" href="Ledger.TokenAlgebra.html#1790" class="Function">sumᵛ</a> <a id="1795" class="Symbol">:</a> <a id="1797" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1802" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a> <a id="1808" class="Symbol">→</a> <a id="1810" href="Ledger.TokenAlgebra.html#492" class="Field">Value</a>
  <a id="1818" href="Ledger.TokenAlgebra.html#1790" class="Function">sumᵛ</a> <a id="1823" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1826" class="Symbol">=</a> <a id="1828" href="Ledger.TokenAlgebra.html#857" class="Field">inject</a> <a id="1835" class="Number">0</a>
  <a id="1839" href="Ledger.TokenAlgebra.html#1790" class="Function">sumᵛ</a> <a id="1844" class="Symbol">(</a><a id="1845" href="Ledger.TokenAlgebra.html#1845" class="Bound">x</a> <a id="1847" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1849" href="Ledger.TokenAlgebra.html#1849" class="Bound">l</a><a id="1850" class="Symbol">)</a> <a id="1852" class="Symbol">=</a> <a id="1854" href="Ledger.TokenAlgebra.html#1845" class="Bound">x</a> <a id="1856" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1858" href="Ledger.TokenAlgebra.html#1790" class="Function">sumᵛ</a> <a id="1863" href="Ledger.TokenAlgebra.html#1849" class="Bound">l</a>

</pre></body></html>