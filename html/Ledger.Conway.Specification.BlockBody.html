<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.BlockBody</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="124" class="Keyword">module</a> <a id="131" href="Ledger.Conway.Specification.BlockBody.html" class="Module">Ledger.Conway.Specification.BlockBody</a>
  <a id="171" class="Symbol">(</a><a id="172" href="Ledger.Conway.Specification.BlockBody.html#172" class="Bound">txs</a> <a id="176" class="Symbol">:</a> <a id="178" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="198" class="Symbol">)</a> <a id="200" class="Symbol">(</a><a id="201" class="Keyword">open</a> <a id="206" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="227" href="Ledger.Conway.Specification.BlockBody.html#172" class="Bound">txs</a><a id="230" class="Symbol">)</a>
  <a id="234" class="Symbol">(</a><a id="235" href="Ledger.Conway.Specification.BlockBody.html#235" class="Bound">abs</a> <a id="239" class="Symbol">:</a> <a id="241" href="Ledger.Core.Specification.Abstract.html#651" class="Record">AbstractFunctions</a> <a id="259" href="Ledger.Conway.Specification.BlockBody.html#172" class="Bound">txs</a><a id="262" class="Symbol">)</a>
  <a id="266" class="Keyword">where</a>

<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="347" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="360" class="Keyword">open</a> <a id="365" class="Keyword">import</a> <a id="372" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="407" href="Ledger.Conway.Specification.BlockBody.html#172" class="Bound">txs</a> <a id="411" href="Ledger.Conway.Specification.BlockBody.html#235" class="Bound">abs</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Ledger.Conway.Specification.Rewards.html" class="Module">Ledger.Conway.Specification.Rewards</a> <a id="463" href="Ledger.Conway.Specification.BlockBody.html#172" class="Bound">txs</a> <a id="467" href="Ledger.Conway.Specification.BlockBody.html#235" class="Bound">abs</a>
<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="523" href="Ledger.Conway.Specification.BlockBody.html#172" class="Bound">txs</a> <a id="527" href="Ledger.Conway.Specification.BlockBody.html#235" class="Bound">abs</a>


<a id="533" class="Keyword">record</a> <a id="BHBody"></a><a id="540" href="Ledger.Conway.Specification.BlockBody.html#540" class="Record">BHBody</a> <a id="547" class="Symbol">:</a> <a id="549" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="554" class="Keyword">where</a>
  <a id="562" class="Keyword">field</a>
    <a id="BHBody.bvkcold"></a><a id="572" href="Ledger.Conway.Specification.BlockBody.html#572" class="Field">bvkcold</a> <a id="580" class="Symbol">:</a> <a id="582" href="Ledger.Core.Specification.Crypto.html#650" class="Function">VKey</a>
    <a id="BHBody.bsize"></a><a id="591" href="Ledger.Conway.Specification.BlockBody.html#591" class="Field">bsize</a>   <a id="599" class="Symbol">:</a> <a id="601" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="BHBody.slot"></a><a id="607" href="Ledger.Conway.Specification.BlockBody.html#607" class="Field">slot</a>    <a id="615" class="Symbol">:</a> <a id="617" href="Ledger.Core.Specification.Epoch.html#722" class="Function">Slot</a>
    <a id="BHBody.bhash"></a><a id="626" href="Ledger.Conway.Specification.BlockBody.html#626" class="Field">bhash</a>   <a id="634" class="Symbol">:</a> <a id="636" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
    <a id="BHBody.hBbsize"></a><a id="648" href="Ledger.Conway.Specification.BlockBody.html#648" class="Field">hBbsize</a> <a id="656" class="Symbol">:</a> <a id="658" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="661" class="Keyword">record</a> <a id="BHeader"></a><a id="668" href="Ledger.Conway.Specification.BlockBody.html#668" class="Record">BHeader</a> <a id="676" class="Symbol">:</a> <a id="678" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="683" class="Keyword">where</a>
  <a id="691" class="Keyword">field</a>
    <a id="BHeader.bhbody"></a><a id="701" href="Ledger.Conway.Specification.BlockBody.html#701" class="Field">bhbody</a> <a id="708" class="Symbol">:</a> <a id="710" href="Ledger.Conway.Specification.BlockBody.html#540" class="Record">BHBody</a>
    <a id="BHeader.bhsig"></a><a id="721" href="Ledger.Conway.Specification.BlockBody.html#721" class="Field">bhsig</a>  <a id="728" class="Symbol">:</a> <a id="730" href="Ledger.Core.Specification.Crypto.html#655" class="Function">Sig</a>

<a id="735" class="Keyword">record</a> <a id="Block"></a><a id="742" href="Ledger.Conway.Specification.BlockBody.html#742" class="Record">Block</a> <a id="748" class="Symbol">:</a> <a id="750" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="755" class="Keyword">where</a>
  <a id="763" class="Keyword">field</a>
    <a id="Block.bheader"></a><a id="773" href="Ledger.Conway.Specification.BlockBody.html#773" class="Field">bheader</a>     <a id="785" class="Symbol">:</a> <a id="787" href="Ledger.Conway.Specification.BlockBody.html#668" class="Record">BHeader</a>
    <a id="Block.ts"></a><a id="799" href="Ledger.Conway.Specification.BlockBody.html#799" class="Field">ts</a>          <a id="811" class="Symbol">:</a> <a id="813" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="818" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a>
    <a id="Block.bBodySize"></a><a id="825" href="Ledger.Conway.Specification.BlockBody.html#825" class="Field">bBodySize</a>   <a id="837" class="Symbol">:</a> <a id="839" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="Block.bBodyHash"></a><a id="845" href="Ledger.Conway.Specification.BlockBody.html#845" class="Field">bBodyHash</a>   <a id="857" class="Symbol">:</a> <a id="859" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a>
    <a id="Block.≡-bBodySize"></a><a id="871" href="Ledger.Conway.Specification.BlockBody.html#871" class="Field">≡-bBodySize</a> <a id="883" class="Symbol">:</a> <a id="885" href="Ledger.Conway.Specification.BlockBody.html#825" class="Field">bBodySize</a> <a id="895" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="897" href="Ledger.Conway.Specification.BlockBody.html#648" class="Field">BHBody.hBbsize</a> <a id="912" class="Symbol">(</a><a id="913" href="Ledger.Conway.Specification.BlockBody.html#701" class="Field">BHeader.bhbody</a> <a id="928" href="Ledger.Conway.Specification.BlockBody.html#773" class="Field">bheader</a><a id="935" class="Symbol">)</a>
    <a id="Block.≡-bBodyHash"></a><a id="941" href="Ledger.Conway.Specification.BlockBody.html#941" class="Field">≡-bBodyHash</a> <a id="953" class="Symbol">:</a> <a id="955" href="Ledger.Conway.Specification.BlockBody.html#845" class="Field">bBodyHash</a> <a id="965" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="967" href="Ledger.Conway.Specification.BlockBody.html#626" class="Field">BHBody.bhash</a> <a id="980" class="Symbol">(</a><a id="981" href="Ledger.Conway.Specification.BlockBody.html#701" class="Field">BHeader.bhbody</a> <a id="996" href="Ledger.Conway.Specification.BlockBody.html#773" class="Field">bheader</a><a id="1003" class="Symbol">)</a>


<a id="BBodyEnv"></a><a id="1007" href="Ledger.Conway.Specification.BlockBody.html#1007" class="Function">BBodyEnv</a> <a id="1016" class="Symbol">:</a> <a id="1018" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1023" href="Ledger.Conway.Specification.BlockBody.html#1007" class="Function">BBodyEnv</a> <a id="1032" class="Symbol">=</a> <a id="1034" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a> <a id="1045" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1047" href="Ledger.Conway.Specification.PParams.html#718" class="Record">Acnt</a>

<a id="BBodyState"></a><a id="1053" href="Ledger.Conway.Specification.BlockBody.html#1053" class="Function">BBodyState</a> <a id="1064" class="Symbol">:</a> <a id="1066" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1071" href="Ledger.Conway.Specification.BlockBody.html#1053" class="Function">BBodyState</a> <a id="1082" class="Symbol">=</a> <a id="1084" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a> <a id="1091" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1093" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a>

<a id="incrBlocks"></a><a id="1105" href="Ledger.Conway.Specification.BlockBody.html#1105" class="Function">incrBlocks</a> <a id="1116" class="Symbol">:</a> <a id="1118" href="Ledger.Core.Specification.Crypto.html#1386" class="Function">KeyHash</a> <a id="1126" class="Symbol">→</a> <a id="1128" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a> <a id="1139" class="Symbol">→</a> <a id="1141" href="Ledger.Conway.Specification.Rewards.html#4921" class="Function">BlocksMade</a>
<a id="1152" href="Ledger.Conway.Specification.BlockBody.html#1105" class="Function">incrBlocks</a> <a id="1163" href="Ledger.Conway.Specification.BlockBody.html#1163" class="Bound">hk</a> <a id="1166" href="Ledger.Conway.Specification.BlockBody.html#1166" class="Bound">b</a> <a id="1168" class="Symbol">=</a> <a id="1170" href="Ledger.Conway.Specification.BlockBody.html#1166" class="Bound">b</a> <a id="1172" href="Axiom.Set.Map.Dec.html#2052" class="Function Operator">∪⁺</a> <a id="1175" href="Axiom.Set.Map.html#5481" class="Function">singletonᵐ</a> <a id="1186" href="Ledger.Conway.Specification.BlockBody.html#1163" class="Bound">hk</a> <a id="1189" class="Number">1</a>

<a id="1192" class="Keyword">data</a> <a id="_⊢_⇀⦇_,BBODY⦈_"></a><a id="1197" href="Ledger.Conway.Specification.BlockBody.html#1197" class="Datatype Operator">_⊢_⇀⦇_,BBODY⦈_</a>
  <a id="1214" class="Symbol">:</a> <a id="1216" href="Ledger.Conway.Specification.BlockBody.html#1007" class="Function">BBodyEnv</a> <a id="1225" class="Symbol">→</a> <a id="1227" href="Ledger.Conway.Specification.BlockBody.html#1053" class="Function">BBodyState</a> <a id="1238" class="Symbol">→</a> <a id="1240" href="Ledger.Conway.Specification.BlockBody.html#742" class="Record">Block</a> <a id="1246" class="Symbol">→</a> <a id="1248" href="Ledger.Conway.Specification.BlockBody.html#1053" class="Function">BBodyState</a> <a id="1259" class="Symbol">→</a> <a id="1261" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1266" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,BBODY⦈_.BBODY-Block-Body"></a><a id="1275" href="Ledger.Conway.Specification.BlockBody.html#1275" class="InductiveConstructor">BBODY-Block-Body</a> <a id="1292" class="Symbol">:</a> <a id="1294" class="Symbol">∀</a> <a id="1296" class="Symbol">{</a><a id="1297" href="Ledger.Conway.Specification.BlockBody.html#1297" class="Bound">acnt</a> <a id="1302" href="Ledger.Conway.Specification.BlockBody.html#1302" class="Bound">ls</a> <a id="1305" href="Ledger.Conway.Specification.BlockBody.html#1305" class="Bound">ls&#39;</a> <a id="1309" href="Ledger.Conway.Specification.BlockBody.html#1309" class="Bound">b</a> <a id="1311" href="Ledger.Conway.Specification.BlockBody.html#1311" class="Bound">block</a> <a id="1317" href="Ledger.Conway.Specification.BlockBody.html#1317" class="Bound">es</a><a id="1319" class="Symbol">}</a> <a id="1321" class="Symbol">→</a>
    <a id="1327" class="Keyword">let</a>
      <a id="1337" class="Keyword">open</a> <a id="1342" href="Ledger.Conway.Specification.BlockBody.html#668" class="Module">BHeader</a>
      <a id="1356" class="Keyword">open</a> <a id="1361" href="Ledger.Conway.Specification.BlockBody.html#540" class="Module">BHBody</a>
      <a id="1374" class="Keyword">open</a> <a id="1379" href="Ledger.Conway.Specification.BlockBody.html#742" class="Module">Block</a>
      <a id="1391" class="Keyword">open</a> <a id="1396" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a>
      <a id="1413" href="Ledger.Conway.Specification.BlockBody.html#1413" class="Bound">txs</a> <a id="1417" class="Symbol">=</a> <a id="1419" href="Ledger.Conway.Specification.BlockBody.html#1311" class="Bound">block</a> <a id="1425" class="Symbol">.</a><a id="1426" href="Ledger.Conway.Specification.BlockBody.html#799" class="Field">ts</a>
      <a id="1435" href="Ledger.Conway.Specification.BlockBody.html#1435" class="Bound">bhb</a> <a id="1439" class="Symbol">=</a> <a id="1441" href="Ledger.Conway.Specification.BlockBody.html#1311" class="Bound">block</a> <a id="1447" class="Symbol">.</a><a id="1448" href="Ledger.Conway.Specification.BlockBody.html#773" class="Field">bheader</a> <a id="1456" class="Symbol">.</a><a id="1457" href="Ledger.Conway.Specification.BlockBody.html#701" class="Field">bhbody</a>
      <a id="1470" href="Ledger.Conway.Specification.BlockBody.html#1470" class="Bound">hk</a> <a id="1473" class="Symbol">=</a> <a id="1475" href="Interface.TypeClasses.Hashable.html#219" class="Field">hash</a> <a id="1480" class="Symbol">(</a><a id="1481" href="Ledger.Conway.Specification.BlockBody.html#1435" class="Bound">bhb</a> <a id="1485" class="Symbol">.</a><a id="1486" href="Ledger.Conway.Specification.BlockBody.html#572" class="Field">bvkcold</a><a id="1493" class="Symbol">)</a>
      <a id="1501" href="Ledger.Conway.Specification.BlockBody.html#1501" class="Bound">pp</a> <a id="1504" class="Symbol">=</a> <a id="1506" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="1516" href="Ledger.Conway.Specification.BlockBody.html#1317" class="Bound">es</a>
      <a id="1525" href="Ledger.Conway.Specification.BlockBody.html#1525" class="Bound">Γ</a>  <a id="1528" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Specification.BlockBody.html#1435}{\htmlId{1532}{\htmlClass{Bound}{\text{bhb}}}}\, \,\htmlId{1536}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.BlockBody.html#607}{\htmlId{1537}{\htmlClass{Field}{\text{slot}}}}\, \\ \,\href{Ledger.Prelude.html#2302}{\htmlId{1544}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Specification.BlockBody.html#1317}{\htmlId{1546}{\htmlClass{Bound}{\text{es}}}}\, \,\htmlId{1549}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Enact.html#549}{\htmlId{1550}{\htmlClass{Field}{\text{constitution}}}}\, \,\href{Ledger.Prelude.html#2302}{\htmlId{1563}{\htmlClass{Function Operator}{\text{∣}}}}\, \\ \,\href{Ledger.Conway.Specification.BlockBody.html#1501}{\htmlId{1567}{\htmlClass{Bound}{\text{pp}}}}\, \\ \,\href{Ledger.Conway.Specification.BlockBody.html#1317}{\htmlId{1572}{\htmlClass{Bound}{\text{es}}}}\, \\ \,\href{Ledger.Prelude.Base.html#889}{\htmlId{1577}{\htmlClass{Field}{\text{TreasuryOf}}}}\, \,\href{Ledger.Conway.Specification.BlockBody.html#1297}{\htmlId{1588}{\htmlClass{Bound}{\text{acnt}}}}\, \end{pmatrix}$</a>

     <a id="1601" class="Keyword">in</a>
    <a id="1608" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="1610" href="Ledger.Conway.Specification.BlockBody.html#1311" class="Bound">block</a> <a id="1616" class="Symbol">.</a><a id="1617" href="Ledger.Conway.Specification.BlockBody.html#825" class="Field">bBodySize</a> <a id="1627" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1629" href="Ledger.Conway.Specification.BlockBody.html#1435" class="Bound">bhb</a> <a id="1633" class="Symbol">.</a><a id="1634" href="Ledger.Conway.Specification.BlockBody.html#648" class="Field">hBbsize</a>
    <a id="1646" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="1648" href="Ledger.Conway.Specification.BlockBody.html#1311" class="Bound">block</a> <a id="1654" class="Symbol">.</a><a id="1655" href="Ledger.Conway.Specification.BlockBody.html#845" class="Field">bBodyHash</a> <a id="1665" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1667" href="Ledger.Conway.Specification.BlockBody.html#1435" class="Bound">bhb</a> <a id="1671" class="Symbol">.</a><a id="1672" href="Ledger.Conway.Specification.BlockBody.html#626" class="Field">bhash</a>
    <a id="1682" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="1684" href="Ledger.Conway.Specification.BlockBody.html#1525" class="Bound">Γ</a> <a id="1686" href="Ledger.Conway.Specification.Ledger.html#4914" class="Function Operator">⊢</a> <a id="1688" href="Ledger.Conway.Specification.BlockBody.html#1302" class="Bound">ls</a> <a id="1691" href="Ledger.Conway.Specification.Ledger.html#4914" class="Function Operator">⇀⦇</a> <a id="1694" href="Ledger.Conway.Specification.BlockBody.html#1413" class="Bound">txs</a> <a id="1698" href="Ledger.Conway.Specification.Ledger.html#4914" class="Function Operator">,LEDGERS⦈</a> <a id="1708" href="Ledger.Conway.Specification.BlockBody.html#1305" class="Bound">ls&#39;</a>
    <a id="1716" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
    <a id="1753" class="Symbol">(</a><a id="1754" href="Ledger.Conway.Specification.BlockBody.html#1317" class="Bound">es</a> <a id="1757" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1759" href="Ledger.Conway.Specification.BlockBody.html#1297" class="Bound">acnt</a><a id="1763" class="Symbol">)</a> <a id="1765" href="Ledger.Conway.Specification.BlockBody.html#1197" class="Datatype Operator">⊢</a> <a id="1767" href="Ledger.Conway.Specification.BlockBody.html#1302" class="Bound">ls</a> <a id="1770" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1772" href="Ledger.Conway.Specification.BlockBody.html#1309" class="Bound">b</a> <a id="1774" href="Ledger.Conway.Specification.BlockBody.html#1197" class="Datatype Operator">⇀⦇</a> <a id="1777" href="Ledger.Conway.Specification.BlockBody.html#1311" class="Bound">block</a> <a id="1783" href="Ledger.Conway.Specification.BlockBody.html#1197" class="Datatype Operator">,BBODY⦈</a> <a id="1791" class="Symbol">(</a><a id="1792" href="Ledger.Conway.Specification.BlockBody.html#1305" class="Bound">ls&#39;</a> <a id="1796" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1798" href="Ledger.Conway.Specification.BlockBody.html#1105" class="Function">incrBlocks</a> <a id="1809" href="Ledger.Conway.Specification.BlockBody.html#1470" class="Bound">hk</a> <a id="1812" href="Ledger.Conway.Specification.BlockBody.html#1309" class="Bound">b</a><a id="1813" class="Symbol">)</a>

</pre></body></html>