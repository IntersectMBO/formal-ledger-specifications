<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>stdlib-classes.Class.HasCast.Derive</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>
<a id="24" class="Keyword">module</a> <a id="31" href="stdlib-classes.Class.HasCast.Derive.html" class="Module">stdlib-classes.Class.HasCast.Derive</a> <a id="67" class="Keyword">where</a>

<a id="74" class="Keyword">open</a> <a id="79" class="Keyword">import</a> <a id="86" href="stdlib-classes.Class.HasCast.Base.html" class="Module">stdlib-classes.Class.HasCast.Base</a>

<a id="121" class="Keyword">open</a> <a id="126" class="Keyword">import</a> <a id="133" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="152" class="Symbol">as</a> <a id="155" class="Module">NE</a> <a id="158" class="Keyword">using</a> <a id="164" class="Symbol">(</a><a id="165" href="Data.List.NonEmpty.Base.html#1285" class="Record">List⁺</a><a id="170" class="Symbol">;</a> <a id="172" href="Data.List.NonEmpty.Base.html#1331" class="InductiveConstructor Operator">_∷_</a><a id="175" class="Symbol">)</a>
<a id="177" class="Keyword">open</a> <a id="182" class="Keyword">import</a> <a id="189" href="Data.List.html" class="Module">Data.List</a>
<a id="199" class="Keyword">open</a> <a id="204" class="Keyword">import</a> <a id="211" href="Meta.Init.html" class="Module">Meta.Init</a>
<a id="221" class="Keyword">open</a> <a id="226" class="Keyword">import</a> <a id="233" href="Meta.Prelude.html" class="Module">Meta.Prelude</a>
<a id="246" class="Keyword">open</a> <a id="251" class="Keyword">import</a> <a id="258" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Reflection.Utils.Debug.html" class="Module">Reflection.Utils.Debug</a>

<a id="312" class="Keyword">open</a> <a id="317" class="Keyword">import</a> <a id="324" href="Class.MonadTC.html" class="Module">Class.MonadTC</a>
<a id="338" class="Keyword">open</a> <a id="343" class="Keyword">import</a> <a id="350" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="388" class="Keyword">open</a> <a id="393" class="Keyword">import</a> <a id="400" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Data.Product.Nary.NonDependent.html" class="Module">Data.Product.Nary.NonDependent</a> <a id="462" class="Keyword">using</a> <a id="468" class="Symbol">(</a><a id="469" href="Data.Product.Nary.NonDependent.html#4372" class="Function">uncurryₙ</a><a id="477" class="Symbol">)</a>

<a id="480" class="Keyword">open</a> <a id="485" href="Reflection.TCI.html#2082" class="Module">MonadTCI</a>

<a id="getCodPi"></a><a id="495" href="stdlib-classes.Class.HasCast.Derive.html#495" class="Function">getCodPi</a> <a id="504" class="Symbol">:</a> <a id="506" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a> <a id="511" class="Symbol">→</a> <a id="513" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a>
<a id="518" href="stdlib-classes.Class.HasCast.Derive.html#495" class="Function">getCodPi</a> <a id="527" class="Symbol">(</a><a id="528" href="Agda.Builtin.Reflection.html#5426" class="InductiveConstructor">pi</a> <a id="531" href="stdlib-classes.Class.HasCast.Derive.html#531" class="Bound">a</a> <a id="533" href="stdlib-classes.Class.HasCast.Derive.html#533" class="Bound">b</a><a id="534" class="Symbol">)</a> <a id="536" class="Symbol">=</a> <a id="538" href="stdlib-classes.Class.HasCast.Derive.html#605" class="Function">adjustTerm</a> <a id="549" class="Number">1</a> <a id="551" class="Symbol">(</a><a id="552" href="Reflection.AST.Abstraction.html#1739" class="Function">unAbs</a> <a id="558" href="stdlib-classes.Class.HasCast.Derive.html#533" class="Bound">b</a><a id="559" class="Symbol">)</a>
  <a id="563" class="Keyword">where</a>
    <a id="573" class="Comment">-- adjust De Bruijn indexes</a>
    <a id="605" href="stdlib-classes.Class.HasCast.Derive.html#605" class="Function">adjustTerm</a> <a id="616" class="Symbol">:</a> <a id="618" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="620" class="Symbol">→</a> <a id="622" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="627" class="Symbol">→</a> <a id="629" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="638" href="stdlib-classes.Class.HasCast.Derive.html#638" class="Function">adjustArg</a> <a id="648" class="Symbol">:</a> <a id="650" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="652" class="Symbol">→</a> <a id="654" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="658" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="663" class="Symbol">→</a> <a id="665" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="669" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
    <a id="678" href="stdlib-classes.Class.HasCast.Derive.html#678" class="Function">adjustArgs</a> <a id="689" class="Symbol">:</a> <a id="691" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="693" class="Symbol">→</a> <a id="695" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="700" class="Symbol">(</a><a id="701" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="705" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="709" class="Symbol">)</a> <a id="711" class="Symbol">→</a> <a id="713" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="718" class="Symbol">(</a><a id="719" href="Agda.Builtin.Reflection.html#3696" class="Datatype">Arg</a> <a id="723" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="727" class="Symbol">)</a>

    <a id="734" href="stdlib-classes.Class.HasCast.Derive.html#605" class="Function">adjustTerm</a> <a id="745" href="stdlib-classes.Class.HasCast.Derive.html#745" class="Bound">n</a> <a id="747" class="Symbol">(</a><a id="748" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="752" href="stdlib-classes.Class.HasCast.Derive.html#752" class="Bound">n&#39;</a> <a id="755" href="stdlib-classes.Class.HasCast.Derive.html#755" class="Bound">args</a><a id="759" class="Symbol">)</a> <a id="761" class="Symbol">=</a> <a id="763" href="Agda.Builtin.Reflection.html#5138" class="InductiveConstructor">var</a> <a id="767" class="Symbol">(</a><a id="768" href="stdlib-classes.Class.HasCast.Derive.html#752" class="Bound">n&#39;</a> <a id="771" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="773" href="stdlib-classes.Class.HasCast.Derive.html#745" class="Bound">n</a><a id="774" class="Symbol">)</a> <a id="776" class="Symbol">(</a><a id="777" href="stdlib-classes.Class.HasCast.Derive.html#678" class="Function">adjustArgs</a> <a id="788" href="stdlib-classes.Class.HasCast.Derive.html#745" class="Bound">n</a> <a id="790" href="stdlib-classes.Class.HasCast.Derive.html#755" class="Bound">args</a><a id="794" class="Symbol">)</a>
    <a id="800" href="stdlib-classes.Class.HasCast.Derive.html#605" class="Function">adjustTerm</a> <a id="811" href="stdlib-classes.Class.HasCast.Derive.html#811" class="Bound">n</a> <a id="813" class="Symbol">(</a><a id="814" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="818" href="stdlib-classes.Class.HasCast.Derive.html#818" class="Bound">c</a> <a id="820" href="stdlib-classes.Class.HasCast.Derive.html#820" class="Bound">args</a><a id="824" class="Symbol">)</a> <a id="826" class="Symbol">=</a> <a id="828" href="Agda.Builtin.Reflection.html#5194" class="InductiveConstructor">con</a> <a id="832" href="stdlib-classes.Class.HasCast.Derive.html#818" class="Bound">c</a> <a id="834" class="Symbol">(</a><a id="835" href="stdlib-classes.Class.HasCast.Derive.html#678" class="Function">adjustArgs</a> <a id="846" href="stdlib-classes.Class.HasCast.Derive.html#811" class="Bound">n</a> <a id="848" href="stdlib-classes.Class.HasCast.Derive.html#820" class="Bound">args</a><a id="852" class="Symbol">)</a>
    <a id="858" href="stdlib-classes.Class.HasCast.Derive.html#605" class="Function">adjustTerm</a> <a id="869" href="stdlib-classes.Class.HasCast.Derive.html#869" class="Bound">n</a> <a id="871" class="Symbol">(</a><a id="872" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="876" href="stdlib-classes.Class.HasCast.Derive.html#876" class="Bound">f</a> <a id="878" href="stdlib-classes.Class.HasCast.Derive.html#878" class="Bound">args</a><a id="882" class="Symbol">)</a> <a id="884" class="Symbol">=</a> <a id="886" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="890" href="stdlib-classes.Class.HasCast.Derive.html#876" class="Bound">f</a> <a id="892" class="Symbol">(</a><a id="893" href="stdlib-classes.Class.HasCast.Derive.html#678" class="Function">adjustArgs</a> <a id="904" href="stdlib-classes.Class.HasCast.Derive.html#869" class="Bound">n</a> <a id="906" href="stdlib-classes.Class.HasCast.Derive.html#878" class="Bound">args</a><a id="910" class="Symbol">)</a>
    <a id="916" href="stdlib-classes.Class.HasCast.Derive.html#605" class="CatchallClause Function">adjustTerm</a><a id="926" class="CatchallClause"> </a><a id="927" href="stdlib-classes.Class.HasCast.Derive.html#927" class="CatchallClause Bound">n</a><a id="928" class="CatchallClause"> </a><a id="929" href="stdlib-classes.Class.HasCast.Derive.html#929" class="CatchallClause Bound">d</a> <a id="931" class="Symbol">=</a> <a id="933" href="stdlib-classes.Class.HasCast.Derive.html#929" class="Bound">d</a>

    <a id="940" href="stdlib-classes.Class.HasCast.Derive.html#638" class="Function">adjustArg</a> <a id="950" href="stdlib-classes.Class.HasCast.Derive.html#950" class="Bound">n</a> <a id="952" class="Symbol">(</a><a id="953" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="957" href="stdlib-classes.Class.HasCast.Derive.html#957" class="Bound">i</a> <a id="959" href="stdlib-classes.Class.HasCast.Derive.html#959" class="Bound">x</a><a id="960" class="Symbol">)</a> <a id="962" class="Symbol">=</a> <a id="964" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="968" href="stdlib-classes.Class.HasCast.Derive.html#957" class="Bound">i</a> <a id="970" class="Symbol">(</a><a id="971" href="stdlib-classes.Class.HasCast.Derive.html#605" class="Function">adjustTerm</a> <a id="982" href="stdlib-classes.Class.HasCast.Derive.html#950" class="Bound">n</a> <a id="984" href="stdlib-classes.Class.HasCast.Derive.html#959" class="Bound">x</a><a id="985" class="Symbol">)</a>

    <a id="992" href="stdlib-classes.Class.HasCast.Derive.html#678" class="Function">adjustArgs</a> <a id="1003" href="stdlib-classes.Class.HasCast.Derive.html#1003" class="Bound">n</a> <a id="1005" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1008" class="Symbol">=</a> <a id="1010" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
    <a id="1017" href="stdlib-classes.Class.HasCast.Derive.html#678" class="Function">adjustArgs</a> <a id="1028" href="stdlib-classes.Class.HasCast.Derive.html#1028" class="Bound">n</a> <a id="1030" class="Symbol">(</a><a id="1031" href="stdlib-classes.Class.HasCast.Derive.html#1031" class="Bound">x</a> <a id="1033" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1035" href="stdlib-classes.Class.HasCast.Derive.html#1035" class="Bound">xs</a><a id="1037" class="Symbol">)</a> <a id="1039" class="Symbol">=</a> <a id="1041" href="stdlib-classes.Class.HasCast.Derive.html#638" class="Function">adjustArg</a> <a id="1051" href="stdlib-classes.Class.HasCast.Derive.html#1028" class="Bound">n</a> <a id="1053" href="stdlib-classes.Class.HasCast.Derive.html#1031" class="Bound">x</a> <a id="1055" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1057" href="stdlib-classes.Class.HasCast.Derive.html#678" class="Function">adjustArgs</a> <a id="1068" href="stdlib-classes.Class.HasCast.Derive.html#1028" class="Bound">n</a> <a id="1070" href="stdlib-classes.Class.HasCast.Derive.html#1035" class="Bound">xs</a>
<a id="1073" href="stdlib-classes.Class.HasCast.Derive.html#495" class="CatchallClause Function">getCodPi</a><a id="1081" class="CatchallClause"> </a><a id="1082" href="stdlib-classes.Class.HasCast.Derive.html#1082" class="CatchallClause Bound">ty</a> <a id="1085" class="Symbol">=</a> <a id="1087" href="stdlib-classes.Class.HasCast.Derive.html#1082" class="Bound">ty</a>

<a id="1091" class="Comment">-- Map a nonempty record definition to</a>
<a id="1130" class="Comment">-- 1. its constructor</a>
<a id="1152" class="Comment">-- 2. the type of its fields</a>
<a id="1181" class="Comment">-- 3. the number of fields</a>
<a id="fromRecDef"></a><a id="1208" href="stdlib-classes.Class.HasCast.Derive.html#1208" class="Function">fromRecDef</a> <a id="1219" class="Symbol">:</a> <a id="1221" href="Agda.Builtin.Reflection.html#7485" class="Datatype">Definition</a> <a id="1232" class="Symbol">→</a> <a id="1234" href="Reflection.TCI.html#554" class="Function">TC</a> <a id="1237" class="Symbol">(</a><a id="1238" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1243" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1245" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1250" href="Agda.Builtin.Reflection.html#5064" class="Function">Type</a><a id="1254" class="Symbol">)</a>
<a id="1256" href="stdlib-classes.Class.HasCast.Derive.html#1208" class="Function">fromRecDef</a> <a id="1267" class="Symbol">(</a><a id="1268" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record′</a> <a id="1276" href="stdlib-classes.Class.HasCast.Derive.html#1276" class="Bound">c</a> <a id="1278" href="stdlib-classes.Class.HasCast.Derive.html#1278" class="Bound">fs</a><a id="1280" class="Symbol">)</a> <a id="1282" class="Symbol">=</a>
  <a id="1286" class="Keyword">do</a> <a id="1289" href="stdlib-classes.Class.HasCast.Derive.html#1289" class="Bound">tys</a> <a id="1293" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1295" href="Class.Traversable.Core.html#587" class="Function">traverse</a> <a id="1304" class="Symbol">(λ</a> <a id="1307" href="stdlib-classes.Class.HasCast.Derive.html#1307" class="Bound">f</a> <a id="1309" class="Symbol">→</a> <a id="1311" href="Class.Functor.Core.html#272" class="Function">fmap</a> <a id="1316" class="Symbol">⦃</a> <a id="1318" href="Class.Monad.Core.html#699" class="Function">Functor-M</a> <a id="1328" class="Symbol">⦄</a> <a id="1330" href="stdlib-classes.Class.HasCast.Derive.html#495" class="Function">getCodPi</a> <a id="1339" class="Symbol">(</a><a id="1340" href="Reflection.TCI.html#3424" class="Function">getType</a> <a id="1348" class="Symbol">(</a><a id="1349" href="Reflection.AST.Argument.html#2600" class="Function">unArg</a> <a id="1355" href="stdlib-classes.Class.HasCast.Derive.html#1307" class="Bound">f</a><a id="1356" class="Symbol">)))</a> <a id="1360" href="stdlib-classes.Class.HasCast.Derive.html#1278" class="Bound">fs</a>
     <a id="1368" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="1375" class="Symbol">(</a><a id="1376" href="stdlib-classes.Class.HasCast.Derive.html#1276" class="Bound">c</a> <a id="1378" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1380" href="stdlib-classes.Class.HasCast.Derive.html#1289" class="Bound">tys</a><a id="1383" class="Symbol">)</a>
<a id="1385" href="stdlib-classes.Class.HasCast.Derive.html#1208" class="CatchallClause Function">fromRecDef</a><a id="1395" class="CatchallClause"> </a><a id="1396" href="stdlib-classes.Class.HasCast.Derive.html#1396" class="CatchallClause Bound">d</a>  <a id="1399" class="Symbol">=</a> <a id="1401" href="Reflection.TCI.html#2201" class="Function">typeError</a> <a id="1411" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="1413" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">strErr</a> <a id="1420" class="String">&quot;Expected a record type&quot;</a> <a id="1445" href="Data.List.Base.html#4907" class="Function Operator">]</a>

<a id="1448" class="Comment">-- Map a record to its name.</a>
<a id="1477" class="Comment">-- This will be superseeded in 2.8.0 by `quote R.constructor`</a>
<a id="getRecConstrName"></a><a id="1539" href="stdlib-classes.Class.HasCast.Derive.html#1539" class="Function">getRecConstrName</a> <a id="1556" class="Symbol">:</a> <a id="1558" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1563" class="Symbol">→</a> <a id="1565" href="Reflection.TCI.html#554" class="Function">TC</a> <a id="1568" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a>
<a id="1573" href="stdlib-classes.Class.HasCast.Derive.html#1539" class="Function">getRecConstrName</a> <a id="1590" href="stdlib-classes.Class.HasCast.Derive.html#1590" class="Bound">rn</a> <a id="1593" class="Symbol">=</a>
  <a id="1597" class="Keyword">do</a> <a id="1600" href="stdlib-classes.Class.HasCast.Derive.html#1600" class="Bound">d</a> <a id="1602" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1604" href="Reflection.TCI.html#3524" class="Function">getDefinition</a> <a id="1618" href="stdlib-classes.Class.HasCast.Derive.html#1590" class="Bound">rn</a>
     <a id="1626" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1631" href="stdlib-classes.Class.HasCast.Derive.html#1600" class="Bound">d</a> <a id="1633" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1636" class="Symbol">λ</a> <a id="1638" class="Keyword">where</a>
       <a id="1651" class="Symbol">(</a><a id="1652" href="Agda.Builtin.Reflection.html#7617" class="InductiveConstructor">record′</a> <a id="1660" href="stdlib-classes.Class.HasCast.Derive.html#1660" class="Bound">c</a> <a id="1662" class="Symbol">_)</a> <a id="1665" class="Symbol">→</a> <a id="1667" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="1674" href="stdlib-classes.Class.HasCast.Derive.html#1660" class="Bound">c</a>
       <a id="1683" class="CatchallClause Symbol">_</a> <a id="1685" class="Symbol">→</a> <a id="1687" href="Reflection.TCI.html#2201" class="Function">typeError</a> <a id="1697" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="1699" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">strErr</a> <a id="1706" class="String">&quot;Expected a record got something else&quot;</a> <a id="1745" href="Data.List.Base.html#4907" class="Function Operator">]</a>

<a id="1748" class="Comment">-- Derive instance of HasCast</a>
<a id="derive-HasCast-single"></a><a id="1778" href="stdlib-classes.Class.HasCast.Derive.html#1778" class="Function">derive-HasCast-single</a> <a id="1800" class="Symbol">:</a> <a id="1802" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1807" class="Comment">-- name of the record type</a>
                      <a id="1856" class="Symbol">→</a> <a id="1858" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1863" class="Comment">-- name of the instance to be defined</a>
                      <a id="1923" class="Symbol">→</a> <a id="1925" href="Reflection.TCI.html#554" class="Function">TC</a> <a id="1928" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1930" href="stdlib-classes.Class.HasCast.Derive.html#1778" class="Function">derive-HasCast-single</a> <a id="1952" href="stdlib-classes.Class.HasCast.Derive.html#1952" class="Bound">recTyName</a> <a id="1962" href="stdlib-classes.Class.HasCast.Derive.html#1962" class="Bound">instName</a> <a id="1971" class="Symbol">=</a>
  <a id="1975" class="Keyword">do</a> <a id="1978" class="Symbol">(</a><a id="1979" href="stdlib-classes.Class.HasCast.Derive.html#1979" class="Bound">HasCast-ctrName</a> <a id="1995" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1997" class="Symbol">_)</a> <a id="2000" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="2002" href="Reflection.TCI.html#3524" class="Function">getDefinition</a> <a id="2016" class="Symbol">(</a><a id="2017" class="Keyword">quote</a> <a id="2023" href="stdlib-classes.Class.HasCast.Base.html#131" class="Record">HasCast</a><a id="2030" class="Symbol">)</a> <a id="2032" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="2036" href="stdlib-classes.Class.HasCast.Derive.html#1208" class="Function">fromRecDef</a> <a id="2047" class="Comment">-- this will be superseeded by &#39;quote HasCast.constructor&#39; in Agda 2.8.0</a>
     <a id="2125" class="Symbol">(</a><a id="2126" href="stdlib-classes.Class.HasCast.Derive.html#2126" class="Bound">ctrName</a> <a id="2134" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2136" href="stdlib-classes.Class.HasCast.Derive.html#2136" class="Bound">fTys</a><a id="2140" class="Symbol">@(</a><a id="2142" href="stdlib-classes.Class.HasCast.Derive.html#2142" class="Bound">fTy</a> <a id="2146" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2148" href="stdlib-classes.Class.HasCast.Derive.html#2148" class="Bound">fTys&#39;</a><a id="2153" class="Symbol">))</a> <a id="2156" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="2158" href="Reflection.TCI.html#3524" class="Function">getDefinition</a> <a id="2172" href="stdlib-classes.Class.HasCast.Derive.html#1952" class="Bound">recTyName</a>  <a id="2183" href="Class.Monad.Core.html#337" class="Field Operator">&gt;&gt;=</a> <a id="2187" href="stdlib-classes.Class.HasCast.Derive.html#1208" class="Function">fromRecDef</a>
       <a id="2205" class="Keyword">where</a> <a id="2211" class="Symbol">(_</a> <a id="2214" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2216" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2218" class="Symbol">)</a> <a id="2220" class="Symbol">→</a> <a id="2222" href="Reflection.TCI.html#2201" class="Function">typeError</a> <a id="2232" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="2234" href="Agda.Builtin.Reflection.html#8238" class="InductiveConstructor">strErr</a> <a id="2241" class="String">&quot;Expecting a nonempty record type&quot;</a> <a id="2276" href="Data.List.Base.html#4907" class="Function Operator">]</a>
     <a id="2283" href="stdlib-classes.Class.HasCast.Derive.html#2283" class="Bound">arity</a>            <a id="2300" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="2302" href="Reflection.TCI.html#2793" class="Function">quoteTC</a> <a id="2310" class="Symbol">(</a><a id="2311" href="Data.List.Base.html#4746" class="Function">length</a> <a id="2318" href="stdlib-classes.Class.HasCast.Derive.html#2136" class="Bound">fTys</a><a id="2322" class="Symbol">)</a>
     <a id="2329" href="stdlib-classes.Class.HasCast.Derive.html#2329" class="Bound">bot</a>              <a id="2346" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="2348" href="Reflection.TCI.html#2793" class="Function">quoteTC</a> <a id="2356" href="Data.Empty.html#914" class="Function">⊥</a>
     <a id="2363" class="Keyword">let</a> <a id="2367" href="stdlib-classes.Class.HasCast.Derive.html#2367" class="Bound">tyProd</a> <a id="2374" class="Symbol">=</a> <a id="2376" href="Data.List.NonEmpty.Base.html#3034" class="Function">NE.foldr₁</a> <a id="2386" class="Symbol">(λ</a> <a id="2389" href="stdlib-classes.Class.HasCast.Derive.html#2389" class="Bound">ty</a> <a id="2392" href="stdlib-classes.Class.HasCast.Derive.html#2392" class="Bound">tys</a> <a id="2396" class="Symbol">→</a> <a id="2398" class="Symbol">(</a><a id="2399" class="Keyword">quote</a> <a id="2405" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="2408" class="Symbol">)</a> <a id="2410" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∙⟦</a> <a id="2413" href="stdlib-classes.Class.HasCast.Derive.html#2389" class="Bound">ty</a> <a id="2416" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∣</a> <a id="2418" href="stdlib-classes.Class.HasCast.Derive.html#2392" class="Bound">tys</a> <a id="2422" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">⟧</a><a id="2423" class="Symbol">)</a> <a id="2425" class="Symbol">(</a><a id="2426" href="stdlib-classes.Class.HasCast.Derive.html#2142" class="Bound">fTy</a> <a id="2430" href="Data.List.NonEmpty.Base.html#1331" class="InductiveConstructor Operator">∷</a> <a id="2432" href="stdlib-classes.Class.HasCast.Derive.html#2148" class="Bound">fTys&#39;</a><a id="2437" class="Symbol">)</a>
     <a id="2444" class="Keyword">let</a> <a id="2448" href="stdlib-classes.Class.HasCast.Derive.html#2448" class="Bound">defTm</a>  <a id="2455" class="Symbol">=</a> <a id="2457" class="Symbol">(</a><a id="2458" class="Keyword">quote</a> <a id="2464" href="stdlib-classes.Class.HasCast.Base.html#131" class="Record">HasCast</a><a id="2471" class="Symbol">)</a> <a id="2473" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∙⟦</a> <a id="2476" href="stdlib-classes.Class.HasCast.Derive.html#2367" class="Bound">tyProd</a> <a id="2483" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∣</a> <a id="2485" href="stdlib-classes.Class.HasCast.Derive.html#1952" class="Bound">recTyName</a> <a id="2495" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a> <a id="2497" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">⟧</a>
     <a id="2504" class="Keyword">let</a> <a id="2508" href="stdlib-classes.Class.HasCast.Derive.html#2508" class="Bound">instTm</a> <a id="2515" class="Symbol">=</a> <a id="2517" href="stdlib-classes.Class.HasCast.Derive.html#1979" class="Bound">HasCast-ctrName</a> <a id="2533" href="Reflection.Syntax.html#3310" class="InductiveConstructor Operator">◆⟦</a> <a id="2536" class="Keyword">quote</a> <a id="2542" href="Data.Product.Nary.NonDependent.html#4372" class="Function">uncurryₙ</a> <a id="2551" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∙⟦</a> <a id="2554" href="stdlib-classes.Class.HasCast.Derive.html#2283" class="Bound">arity</a> <a id="2560" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">∣</a> <a id="2562" href="stdlib-classes.Class.HasCast.Derive.html#2126" class="Bound">ctrName</a> <a id="2570" href="Reflection.Syntax.html#3286" class="InductiveConstructor Operator">◆</a> <a id="2572" href="Reflection.Syntax.html#3087" class="InductiveConstructor Operator">⟧</a> <a id="2574" href="Reflection.Syntax.html#3310" class="InductiveConstructor Operator">⟧</a>
     <a id="2581" href="Reflection.TCI.html#3149" class="Function">declareDef</a> <a id="2592" class="Symbol">(</a><a id="2593" href="Reflection.AST.Argument.html#1395" class="InductiveConstructor">iArg</a> <a id="2598" href="stdlib-classes.Class.HasCast.Derive.html#1962" class="Bound">instName</a><a id="2606" class="Symbol">)</a> <a id="2608" href="stdlib-classes.Class.HasCast.Derive.html#2448" class="Bound">defTm</a>
     <a id="2619" href="Reflection.TCI.html#3333" class="Function">defineFun</a> <a id="2629" href="stdlib-classes.Class.HasCast.Derive.html#1962" class="Bound">instName</a> <a id="2638" href="Data.List.Base.html#4907" class="Function Operator">[</a> <a id="2640" href="Reflection.Syntax.html#1879" class="InductiveConstructor Operator">⟦⇒</a> <a id="2643" href="stdlib-classes.Class.HasCast.Derive.html#2508" class="Bound">instTm</a> <a id="2650" href="Reflection.Syntax.html#1879" class="InductiveConstructor Operator">⟧</a> <a id="2652" href="Data.List.Base.html#4907" class="Function Operator">]</a>

<a id="2655" class="Keyword">module</a> <a id="2662" href="stdlib-classes.Class.HasCast.Derive.html#2662" class="Module">_</a> <a id="2664" class="Symbol">⦃</a> <a id="2666" href="stdlib-classes.Class.HasCast.Derive.html#2666" class="Bound">_</a> <a id="2668" class="Symbol">:</a> <a id="2670" href="Class.MonadTC.html#620" class="Record">TCOptions</a> <a id="2680" class="Symbol">⦄</a> <a id="2682" class="Keyword">where</a>
  <a id="2690" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a> <a id="2705" class="Symbol">:</a> <a id="2707" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2712" class="Symbol">(</a><a id="2713" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2718" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2720" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="2724" class="Symbol">)</a> <a id="2726" class="Symbol">→</a> <a id="2728" href="Reflection.Tactic.html#476" class="Function">UnquoteDecl</a>
  <a id="2742" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a> <a id="2757" href="stdlib-classes.Class.HasCast.Derive.html#2757" class="Bound">rcs</a> <a id="2761" class="Symbol">=</a> <a id="2763" href="Reflection.Tactic.html#868" class="Function">initUnquoteWithGoal</a> <a id="2783" class="Symbol">(</a><a id="2784" class="Keyword">quote</a> <a id="2790" href="stdlib-classes.Class.HasCast.Base.html#131" class="Record">HasCast</a> <a id="2798" href="Reflection.Syntax.html#3023" class="InductiveConstructor Operator">∙</a><a id="2799" class="Symbol">)</a> <a id="2801" class="Symbol">(</a><a id="2802" href="Class.Traversable.Core.html#587" class="Function">traverse</a> <a id="2811" class="Symbol">(</a><a id="2812" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="2820" href="stdlib-classes.Class.HasCast.Derive.html#1778" class="Function">derive-HasCast-single</a><a id="2841" class="Symbol">)</a> <a id="2843" href="stdlib-classes.Class.HasCast.Derive.html#2757" class="Bound">rcs</a> <a id="2847" href="Class.Monad.Core.html#371" class="Function Operator">&gt;&gt;</a> <a id="2850" href="Class.Monad.Core.html#316" class="Field">return</a> <a id="2857" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="2859" class="Symbol">)</a>

<a id="2862" class="Comment">-- Example usage</a>
<a id="2879" class="Keyword">private</a>
  <a id="2889" class="Keyword">record</a> <a id="R"></a><a id="2896" href="stdlib-classes.Class.HasCast.Derive.html#2896" class="Record">R</a> <a id="2898" class="Symbol">:</a> <a id="2900" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2904" class="Keyword">where</a>
    <a id="2914" class="Keyword">field</a> <a id="R.r"></a><a id="2920" href="stdlib-classes.Class.HasCast.Derive.html#2920" class="Field">r</a> <a id="2922" class="Symbol">:</a> <a id="2924" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>

  <a id="2932" class="Keyword">record</a> <a id="R&#39;"></a><a id="2939" href="stdlib-classes.Class.HasCast.Derive.html#2939" class="Record">R&#39;</a> <a id="2942" class="Symbol">:</a> <a id="2944" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2948" class="Keyword">where</a>
    <a id="2958" class="Keyword">field</a> <a id="R&#39;.x"></a><a id="2964" href="stdlib-classes.Class.HasCast.Derive.html#2964" class="Field">x</a> <a id="2966" class="Symbol">:</a> <a id="2968" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
          <a id="R&#39;.y"></a><a id="2983" href="stdlib-classes.Class.HasCast.Derive.html#2983" class="Field">y</a> <a id="2985" class="Symbol">:</a> <a id="2987" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2989" class="Symbol">→</a> <a id="2991" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

  <a id="2996" class="Keyword">unquoteDecl</a> <a id="HasCast-R"></a><a id="3008" href="stdlib-classes.Class.HasCast.Derive.html#3008" class="Function">HasCast-R</a> <a id="HasCast-R&#39;"></a><a id="3018" href="stdlib-classes.Class.HasCast.Derive.html#3018" class="Function">HasCast-R&#39;</a> <a id="3029" class="Symbol">=</a> <a id="3031" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a> <a id="3046" class="Symbol">⦃</a> <a id="3048" href="Class.MonadTC.html#706" class="Function">defaultTCOptions</a> <a id="3065" class="Symbol">⦄</a> <a id="3067" class="Symbol">((</a><a id="3069" class="Keyword">quote</a> <a id="3075" href="stdlib-classes.Class.HasCast.Derive.html#2896" class="Record">R</a> <a id="3077" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3079" href="stdlib-classes.Class.HasCast.Derive.html#3008" class="Function">HasCast-R</a><a id="3088" class="Symbol">)</a> <a id="3090" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3092" class="Symbol">(</a><a id="3093" class="Keyword">quote</a> <a id="3099" href="stdlib-classes.Class.HasCast.Derive.html#2939" class="Record">R&#39;</a> <a id="3102" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3104" href="stdlib-classes.Class.HasCast.Derive.html#3018" class="Function">HasCast-R&#39;</a><a id="3114" class="Symbol">)</a> <a id="3116" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3118" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3120" class="Symbol">)</a>

  <a id="p"></a><a id="3125" href="stdlib-classes.Class.HasCast.Derive.html#3125" class="Function">p</a> <a id="3127" class="Symbol">:</a> <a id="3129" href="stdlib-classes.Class.HasCast.Derive.html#2896" class="Record">R</a>
  <a id="3133" href="stdlib-classes.Class.HasCast.Derive.html#3125" class="Function">p</a> <a id="3135" class="Symbol">=</a> <a id="3137" href="stdlib-classes.Class.HasCast.Base.html#201" class="Field">cast</a> <a id="3142" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>

  <a id="q"></a><a id="3150" href="stdlib-classes.Class.HasCast.Derive.html#3150" class="Function">q</a> <a id="3152" class="Symbol">:</a> <a id="3154" href="stdlib-classes.Class.HasCast.Derive.html#2939" class="Record">R&#39;</a>
  <a id="3159" href="stdlib-classes.Class.HasCast.Derive.html#3150" class="Function">q</a> <a id="3161" class="Symbol">=</a> <a id="3163" href="stdlib-classes.Class.HasCast.Base.html#201" class="Field">cast</a> <a id="3168" class="Symbol">(</a><a id="3169" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a> <a id="3174" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3176" class="Symbol">(λ</a> <a id="3179" href="stdlib-classes.Class.HasCast.Derive.html#3179" class="Bound">x</a> <a id="3181" class="Symbol">→</a> <a id="3183" href="stdlib-classes.Class.HasCast.Derive.html#3179" class="Bound">x</a><a id="3184" class="Symbol">))</a>

  <a id="3190" class="Keyword">module</a> <a id="3197" href="stdlib-classes.Class.HasCast.Derive.html#3197" class="Module">_</a> <a id="3199" class="Symbol">(</a><a id="3200" href="stdlib-classes.Class.HasCast.Derive.html#3200" class="Bound">x</a> <a id="3202" class="Symbol">:</a> <a id="3204" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="3207" class="Symbol">)</a> <a id="3209" class="Keyword">where</a>
    <a id="3219" class="Keyword">record</a> <a id="3226" href="stdlib-classes.Class.HasCast.Derive.html#3226" class="Record">R&#39;&#39;</a> <a id="3230" class="Symbol">:</a> <a id="3232" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3236" class="Keyword">where</a>
      <a id="3248" class="Keyword">field</a> <a id="3254" href="stdlib-classes.Class.HasCast.Derive.html#3254" class="Field">a</a> <a id="3256" class="Symbol">:</a> <a id="3258" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
            <a id="3272" href="stdlib-classes.Class.HasCast.Derive.html#3272" class="Field">b</a> <a id="3274" href="stdlib-classes.Class.HasCast.Derive.html#3274" class="Field">c</a> <a id="3276" class="Symbol">:</a> <a id="3278" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>

    <a id="3288" class="Keyword">instance</a>
      <a id="3303" class="Keyword">unquoteDecl</a> <a id="3315" href="stdlib-classes.Class.HasCast.Derive.html#3315" class="Function">HasCast-R&#39;&#39;</a> <a id="3327" class="Symbol">=</a> <a id="3329" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a> <a id="3344" class="Symbol">⦃</a> <a id="3346" href="Class.MonadTC.html#706" class="Function">defaultTCOptions</a> <a id="3363" class="Symbol">⦄</a> <a id="3365" class="Symbol">((</a><a id="3367" class="Keyword">quote</a> <a id="3373" href="stdlib-classes.Class.HasCast.Derive.html#3226" class="Record">R&#39;&#39;</a> <a id="3377" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3379" href="stdlib-classes.Class.HasCast.Derive.html#3315" class="Function">HasCast-R&#39;&#39;</a><a id="3390" class="Symbol">)</a> <a id="3392" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>  <a id="3395" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3397" class="Symbol">)</a>
</pre></body></html>