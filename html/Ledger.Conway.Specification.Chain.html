<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Chain</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>

<a id="126" class="Keyword">module</a> <a id="133" href="Ledger.Conway.Specification.Chain.html" class="Module">Ledger.Conway.Specification.Chain</a>
  <a id="169" class="Symbol">(</a><a id="170" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="174" class="Symbol">:</a> <a id="176" href="Ledger.Conway.Specification.Transaction.html#991" class="Record">TransactionStructure</a><a id="196" class="Symbol">)</a> <a id="198" class="Symbol">(</a><a id="199" class="Keyword">open</a> <a id="204" href="Ledger.Conway.Specification.Transaction.html#991" class="Module">TransactionStructure</a> <a id="225" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a><a id="228" class="Symbol">)</a>
  <a id="232" class="Symbol">(</a><a id="233" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a> <a id="237" class="Symbol">:</a> <a id="239" href="Ledger.Core.Specification.Abstract.html#828" class="Record">AbstractFunctions</a> <a id="257" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a><a id="260" class="Symbol">)</a>
  <a id="264" class="Keyword">where</a>

<a id="271" class="Keyword">open</a> <a id="276" class="Keyword">import</a> <a id="283" href="Algebra.html" class="Module">Algebra</a>
<a id="291" class="Keyword">open</a> <a id="296" class="Keyword">import</a> <a id="303" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="323" class="Keyword">using</a> <a id="329" class="Symbol">(</a><a id="330" href="Data.Nat.Properties.html#17566" class="Function">+-0-monoid</a><a id="340" class="Symbol">)</a>

<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Ledger.Conway.Specification.BlockBody.html" class="Module">Ledger.Conway.Specification.BlockBody</a> <a id="421" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="425" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a> <a id="429" class="Keyword">public</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="482" href="Ledger.Conway.Specification.Transaction.html#2065" class="Function">govStructure</a>
<a id="495" class="Keyword">open</a> <a id="500" class="Keyword">import</a> <a id="507" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="541" href="Ledger.Conway.Specification.Transaction.html#2065" class="Function">govStructure</a>
<a id="554" class="Keyword">open</a> <a id="559" class="Keyword">import</a> <a id="566" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="600" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="604" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>
<a id="608" class="Keyword">open</a> <a id="613" class="Keyword">import</a> <a id="620" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="652" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a>
<a id="656" class="Keyword">open</a> <a id="661" class="Keyword">import</a> <a id="668" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="703" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="707" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>
<a id="711" class="Keyword">open</a> <a id="716" class="Keyword">import</a> <a id="723" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="758" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a>
<a id="762" class="Keyword">open</a> <a id="767" class="Keyword">import</a> <a id="774" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a> <a id="815" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="819" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>
<a id="823" class="Keyword">open</a> <a id="828" class="Keyword">import</a> <a id="835" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="875" class="Keyword">open</a> <a id="880" class="Keyword">import</a> <a id="887" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="920" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="924" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>

<a id="929" class="Keyword">open</a> <a id="934" href="Function.Bundles.html#4750" class="Module">Equivalence</a>


<a id="948" class="Keyword">record</a> <a id="ChainState"></a><a id="955" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a> <a id="966" class="Symbol">:</a> <a id="968" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="973" class="Keyword">where</a>
  <a id="981" class="Keyword">field</a>
    <a id="ChainState.newEpochState"></a><a id="991" href="Ledger.Conway.Specification.Chain.html#991" class="Field">newEpochState</a>  <a id="1006" class="Symbol">:</a> <a id="1008" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a>


<a id="1024" class="Keyword">instance</a>
  <a id="HasNewEpochState-ChainState"></a><a id="1035" href="Ledger.Conway.Specification.Chain.html#1035" class="Function">HasNewEpochState-ChainState</a> <a id="1063" class="Symbol">:</a> <a id="1065" href="Ledger.Conway.Specification.Epoch.html#3815" class="Record">HasNewEpochState</a> <a id="1082" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="1095" href="Ledger.Conway.Specification.Chain.html#1035" class="Function">HasNewEpochState-ChainState</a> <a id="1123" class="Symbol">.</a><a id="1124" href="Ledger.Conway.Specification.Epoch.html#3872" class="Field">NewEpochStateOf</a> <a id="1140" class="Symbol">=</a> <a id="1142" href="Ledger.Conway.Specification.Chain.html#991" class="Field">ChainState.newEpochState</a>

  <a id="HasLastEpoch-ChainState"></a><a id="1170" href="Ledger.Conway.Specification.Chain.html#1170" class="Function">HasLastEpoch-ChainState</a> <a id="1194" class="Symbol">:</a> <a id="1196" href="Ledger.Conway.Specification.Epoch.html#3950" class="Record">HasLastEpoch</a> <a id="1209" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="1222" href="Ledger.Conway.Specification.Chain.html#1170" class="Function">HasLastEpoch-ChainState</a> <a id="1246" class="Symbol">.</a><a id="1247" href="Ledger.Conway.Specification.Epoch.html#4005" class="Field">LastEpochOf</a> <a id="1259" class="Symbol">=</a> <a id="1261" href="Ledger.Conway.Specification.Epoch.html#4005" class="Field">LastEpochOf</a> <a id="1273" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1275" href="Ledger.Conway.Specification.Epoch.html#3872" class="Field">NewEpochStateOf</a>

  <a id="HasEpochState-ChainState"></a><a id="1294" href="Ledger.Conway.Specification.Chain.html#1294" class="Function">HasEpochState-ChainState</a> <a id="1319" class="Symbol">:</a> <a id="1321" href="Ledger.Conway.Specification.Epoch.html#2038" class="Record">HasEpochState</a> <a id="1335" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="1348" href="Ledger.Conway.Specification.Chain.html#1294" class="Function">HasEpochState-ChainState</a> <a id="1373" class="Symbol">.</a><a id="1374" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a> <a id="1387" class="Symbol">=</a> <a id="1389" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a> <a id="1402" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1404" href="Ledger.Conway.Specification.Epoch.html#3872" class="Field">NewEpochStateOf</a>

  <a id="HasEnactState-ChainState"></a><a id="1423" href="Ledger.Conway.Specification.Chain.html#1423" class="Function">HasEnactState-ChainState</a> <a id="1448" class="Symbol">:</a> <a id="1450" href="Ledger.Conway.Specification.Enact.html#733" class="Record">HasEnactState</a> <a id="1464" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="1477" href="Ledger.Conway.Specification.Chain.html#1423" class="Function">HasEnactState-ChainState</a> <a id="1502" class="Symbol">.</a><a id="1503" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="1516" class="Symbol">=</a> <a id="1518" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="1531" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1533" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a>

  <a id="HasLState-ChainState"></a><a id="1549" href="Ledger.Conway.Specification.Chain.html#1549" class="Function">HasLState-ChainState</a> <a id="1570" class="Symbol">:</a> <a id="1572" href="Ledger.Conway.Specification.Ledger.html#1135" class="Record">HasLState</a> <a id="1582" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="1595" href="Ledger.Conway.Specification.Chain.html#1549" class="Function">HasLState-ChainState</a> <a id="1616" class="Symbol">.</a><a id="1617" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a> <a id="1626" class="Symbol">=</a> <a id="1628" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a> <a id="1637" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1639" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a>

  <a id="HasUTxOState-ChainState"></a><a id="1655" href="Ledger.Conway.Specification.Chain.html#1655" class="Function">HasUTxOState-ChainState</a> <a id="1679" class="Symbol">:</a> <a id="1681" href="Ledger.Conway.Specification.Utxo.html#1466" class="Record">HasUTxOState</a> <a id="1694" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="1707" href="Ledger.Conway.Specification.Chain.html#1655" class="Function">HasUTxOState-ChainState</a> <a id="1731" class="Symbol">.</a><a id="1732" href="Ledger.Conway.Specification.Utxo.html#1519" class="Field">UTxOStateOf</a> <a id="1744" class="Symbol">=</a> <a id="1746" href="Ledger.Conway.Specification.Utxo.html#1519" class="Field">UTxOStateOf</a> <a id="1758" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1760" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a>

  <a id="HasCertState-ChainState"></a><a id="1772" href="Ledger.Conway.Specification.Chain.html#1772" class="Function">HasCertState-ChainState</a> <a id="1796" class="Symbol">:</a> <a id="1798" href="Ledger.Core.Specification.Certs.html#4692" class="Record">HasCertState</a> <a id="1811" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="1824" href="Ledger.Conway.Specification.Chain.html#1772" class="Function">HasCertState-ChainState</a> <a id="1848" class="Symbol">.</a><a id="1849" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="1861" class="Symbol">=</a> <a id="1863" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a> <a id="1875" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1877" href="Ledger.Conway.Specification.Ledger.html#1185" class="Field">LStateOf</a>

  <a id="HasDeposits-ChainState"></a><a id="1889" href="Ledger.Conway.Specification.Chain.html#1889" class="Function">HasDeposits-ChainState</a> <a id="1912" class="Symbol">:</a> <a id="1914" href="Ledger.Core.Specification.Certs.html#833" class="Record">HasDeposits</a> <a id="1926" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="1939" href="Ledger.Conway.Specification.Chain.html#1889" class="Function">HasDeposits-ChainState</a> <a id="1962" class="Symbol">.</a><a id="1963" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="1974" class="Symbol">=</a> <a id="1976" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="1987" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1989" href="Ledger.Conway.Specification.Utxo.html#1519" class="Field">UTxOStateOf</a>

  <a id="HasRewards-ChainState"></a><a id="2004" href="Ledger.Conway.Specification.Chain.html#2004" class="Function">HasRewards-ChainState</a> <a id="2026" class="Symbol">:</a> <a id="2028" href="Ledger.Core.Specification.Certs.html#1645" class="Record">HasRewards</a> <a id="2039" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="2052" href="Ledger.Conway.Specification.Chain.html#2004" class="Function">HasRewards-ChainState</a> <a id="2074" class="Symbol">.</a><a id="2075" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="2085" class="Symbol">=</a> <a id="2087" href="Ledger.Core.Specification.Certs.html#1696" class="Field">RewardsOf</a> <a id="2097" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2099" href="Ledger.Core.Specification.Certs.html#4745" class="Field">CertStateOf</a>

  <a id="HasPParams-ChainState"></a><a id="2114" href="Ledger.Conway.Specification.Chain.html#2114" class="Function">HasPParams-ChainState</a> <a id="2136" class="Symbol">:</a> <a id="2138" href="Ledger.Conway.Specification.PParams.html#3491" class="Record">HasPParams</a> <a id="2149" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a>
  <a id="2162" href="Ledger.Conway.Specification.Chain.html#2114" class="Function">HasPParams-ChainState</a> <a id="2184" class="Symbol">.</a><a id="2185" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="2195" class="Symbol">=</a> <a id="2197" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="2207" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2209" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a>

<a id="2223" class="Comment">-- refScriptsSize : UTxO → Tx → ℕ</a>
<a id="2257" class="Comment">-- refScriptsSize utxo tx = sum (map scriptSize (setToList (refScripts tx utxo)))</a>

<a id="totalRefScriptsSize"></a><a id="2340" href="Ledger.Conway.Specification.Chain.html#2340" class="Function">totalRefScriptsSize</a> <a id="2360" class="Symbol">:</a> <a id="2362" href="Ledger.Conway.Specification.Ledger.html#991" class="Record">LState</a> <a id="2369" class="Symbol">→</a> <a id="2371" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2376" href="Ledger.Conway.Specification.Transaction.html#4668" class="Record">Tx</a> <a id="2379" class="Symbol">→</a> <a id="2381" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2383" href="Ledger.Conway.Specification.Chain.html#2340" class="Function">totalRefScriptsSize</a> <a id="2403" href="Ledger.Conway.Specification.Chain.html#2403" class="Bound">lst</a> <a id="2407" href="Ledger.Conway.Specification.Chain.html#2407" class="Bound">ts</a> <a id="2410" class="Symbol">=</a> <a id="2412" href="Data.Nat.ListAction.html#612" class="Function">sum</a> <a id="2416" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="2418" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2422" class="Symbol">(</a><a id="2423" href="Ledger.Conway.Specification.Utxo.html#2590" class="Function">refScriptsSize</a> <a id="2438" class="Symbol">(</a><a id="2439" href="Ledger.Conway.Specification.Transaction.html#2925" class="Field">UTxOOf</a> <a id="2446" href="Ledger.Conway.Specification.Chain.html#2403" class="Bound">lst</a><a id="2449" class="Symbol">))</a> <a id="2452" href="Ledger.Conway.Specification.Chain.html#2407" class="Bound">ts</a>

<a id="2456" class="Keyword">private</a> <a id="2464" class="Keyword">variable</a>
  <a id="2475" href="Ledger.Conway.Specification.Chain.html#2475" class="Generalizable">ls&#39;</a> <a id="2479" class="Symbol">:</a> <a id="2481" href="Ledger.Conway.Specification.Ledger.html#991" class="Record">LState</a>


<a id="2490" class="Keyword">data</a> <a id="_⊢_⇀⦇_,CHAIN⦈_"></a><a id="2495" href="Ledger.Conway.Specification.Chain.html#2495" class="Datatype Operator">_⊢_⇀⦇_,CHAIN⦈_</a> <a id="2510" class="Symbol">:</a> <a id="2512" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="2514" class="Symbol">→</a> <a id="2516" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a> <a id="2527" class="Symbol">→</a> <a id="2529" href="Ledger.Conway.Specification.BlockBody.html#736" class="Record">Block</a> <a id="2535" class="Symbol">→</a> <a id="2537" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a> <a id="2548" class="Symbol">→</a> <a id="2550" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2555" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,CHAIN⦈_.CHAIN"></a><a id="2564" href="Ledger.Conway.Specification.Chain.html#2564" class="InductiveConstructor">CHAIN</a> <a id="2570" class="Symbol">:</a> <a id="2572" class="Symbol">∀</a> <a id="2574" class="Symbol">{</a><a id="2575" href="Ledger.Conway.Specification.Chain.html#2575" class="Bound">bcur&#39;</a><a id="2580" class="Symbol">}</a> <a id="2582" class="Symbol">{</a><a id="2583" href="Ledger.Conway.Specification.Chain.html#2583" class="Bound">b</a> <a id="2585" class="Symbol">:</a> <a id="2587" href="Ledger.Conway.Specification.BlockBody.html#736" class="Record">Block</a><a id="2592" class="Symbol">}</a> <a id="2594" class="Symbol">{</a><a id="2595" href="Ledger.Conway.Specification.Chain.html#2595" class="Bound">nes</a> <a id="2599" class="Symbol">:</a> <a id="2601" href="Ledger.Conway.Specification.Epoch.html#3586" class="Record">NewEpochState</a><a id="2614" class="Symbol">}</a> <a id="2616" class="Symbol">{</a><a id="2617" href="Ledger.Conway.Specification.Chain.html#2617" class="Bound">cs</a> <a id="2620" class="Symbol">:</a> <a id="2622" href="Ledger.Conway.Specification.Chain.html#955" class="Record">ChainState</a><a id="2632" class="Symbol">}</a>


    <a id="2640" class="Symbol">→</a> <a id="2642" class="Keyword">let</a> <a id="2646" class="Keyword">open</a> <a id="2651" href="Ledger.Conway.Specification.Chain.html#955" class="Module">ChainState</a> <a id="2662" href="Ledger.Conway.Specification.Chain.html#2617" class="Bound">cs</a><a id="2664" class="Symbol">;</a> <a id="2666" class="Keyword">open</a> <a id="2671" href="Ledger.Conway.Specification.BlockBody.html#736" class="Module">Block</a> <a id="2677" href="Ledger.Conway.Specification.Chain.html#2583" class="Bound">b</a><a id="2678" class="Symbol">;</a> <a id="2680" class="Keyword">open</a> <a id="2685" href="Ledger.Conway.Specification.BlockBody.html#662" class="Module">BHeader</a> <a id="2693" href="Ledger.Conway.Specification.BlockBody.html#767" class="Function">bheader</a>
          <a id="2711" class="Keyword">open</a> <a id="2716" href="Ledger.Conway.Specification.BlockBody.html#534" class="Module">BHBody</a> <a id="2723" href="Ledger.Conway.Specification.BlockBody.html#695" class="Function">bhbody</a><a id="2729" class="Symbol">;</a> <a id="2731" class="Keyword">open</a> <a id="2736" href="Ledger.Conway.Specification.Epoch.html#3586" class="Module">NewEpochState</a> <a id="2750" href="Ledger.Conway.Specification.Chain.html#2595" class="Bound">nes</a>
          <a id="2764" class="Keyword">open</a> <a id="2769" href="Ledger.Conway.Specification.Epoch.html#1835" class="Module">EpochState</a> <a id="2780" href="Ledger.Conway.Specification.Epoch.html#3707" class="Function">epochState</a><a id="2790" class="Symbol">;</a> <a id="2792" class="Keyword">open</a> <a id="2797" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a> <a id="2808" href="Ledger.Conway.Specification.Epoch.html#1976" class="Function">es</a> <a id="2811" class="Keyword">renaming</a> <a id="2820" class="Symbol">(</a><a id="2821" href="Ledger.Conway.Specification.Enact.html#654" class="Field">pparams</a> <a id="2829" class="Symbol">to</a> <a id="2832" class="Field">pp</a><a id="2834" class="Symbol">)</a>
          <a id="2846" class="Keyword">open</a> <a id="2851" href="Ledger.Conway.Specification.PParams.html#1687" class="Module">PParams</a> <a id="2859" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2861" href="Ledger.Conway.Specification.Chain.html#2832" class="Function">pp</a> <a id="2864" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2866" class="Keyword">using</a> <a id="2872" class="Symbol">(</a><a id="2873" href="Ledger.Conway.Specification.PParams.html#2599" class="Field">maxRefScriptSizePerBlock</a><a id="2897" class="Symbol">)</a> <a id="2899" class="Keyword">in</a>


    <a id="2908" class="Keyword">let</a>  <a id="2913" href="Ledger.Conway.Specification.Chain.html#2913" class="Bound">cs&#39;</a>  <a id="2918" class="Symbol">=</a> <a id="2920" class="Keyword">record</a> <a id="2927" href="Ledger.Conway.Specification.Chain.html#2617" class="Bound">cs</a> <a id="2930" class="Symbol">{</a>  <a id="2933" href="Ledger.Conway.Specification.Chain.html#991" class="Field">newEpochState</a>
                             <a id="2976" class="Symbol">=</a> <a id="2978" class="Keyword">record</a> <a id="2985" href="Ledger.Conway.Specification.Chain.html#2595" class="Bound">nes</a> <a id="2989" class="Symbol">{</a>  <a id="2992" href="Ledger.Conway.Specification.Epoch.html#3678" class="Field">bcur</a> <a id="2997" class="Symbol">=</a> <a id="2999" href="Ledger.Conway.Specification.Chain.html#2575" class="Bound">bcur&#39;</a><a id="3004" class="Symbol">;</a>
                                             <a id="3051" href="Ledger.Conway.Specification.Epoch.html#3707" class="Field">epochState</a>
                                             <a id="3107" class="Symbol">=</a> <a id="3109" class="Keyword">record</a> <a id="3116" href="Ledger.Conway.Specification.Epoch.html#3707" class="Function">epochState</a> <a id="3127" class="Symbol">{</a><a id="3128" href="Ledger.Conway.Specification.Epoch.html#1952" class="Field">ls</a> <a id="3131" class="Symbol">=</a> <a id="3133" href="Ledger.Conway.Specification.Chain.html#2475" class="Generalizable">ls&#39;</a><a id="3136" class="Symbol">}</a> <a id="3138" class="Symbol">}</a> <a id="3140" class="Symbol">}</a>
    <a id="3146" class="Keyword">in</a>
    <a id="3153" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="3155" href="Ledger.Conway.Specification.Chain.html#2340" class="Function">totalRefScriptsSize</a> <a id="3175" href="Ledger.Conway.Specification.Epoch.html#1952" class="Function">ls</a> <a id="3178" href="Ledger.Conway.Specification.BlockBody.html#793" class="Function">ts</a> <a id="3181" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="3183" href="Ledger.Conway.Specification.PParams.html#2599" class="Function">maxRefScriptSizePerBlock</a>
    <a id="3212" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="3214" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3217" href="Ledger.Conway.Specification.RewardUpdate.html#1194" class="Datatype Operator">⊢</a> <a id="3219" href="Ledger.Conway.Specification.Chain.html#991" class="Field">newEpochState</a> <a id="3233" href="Ledger.Conway.Specification.RewardUpdate.html#1194" class="Datatype Operator">⇀⦇</a> <a id="3236" href="Ledger.Conway.Specification.BlockBody.html#601" class="Function">slot</a> <a id="3241" href="Ledger.Conway.Specification.RewardUpdate.html#1194" class="Datatype Operator">,TICK⦈</a> <a id="3248" href="Ledger.Conway.Specification.Chain.html#2595" class="Bound">nes</a>
    <a id="3256" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="3258" class="Symbol">(</a><a id="3259" href="Ledger.Conway.Specification.Epoch.html#1976" class="Function">es</a> <a id="3262" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3264" href="Ledger.Conway.Specification.Epoch.html#1903" class="Function">acnt</a><a id="3268" class="Symbol">)</a> <a id="3270" href="Ledger.Conway.Specification.BlockBody.html#1191" class="Datatype Operator">⊢</a> <a id="3272" class="Symbol">(</a><a id="3273" href="Ledger.Conway.Specification.Epoch.html#1952" class="Function">ls</a> <a id="3276" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3278" href="Ledger.Conway.Specification.Epoch.html#3678" class="Function">bcur</a><a id="3282" class="Symbol">)</a> <a id="3284" href="Ledger.Conway.Specification.BlockBody.html#1191" class="Datatype Operator">⇀⦇</a> <a id="3287" href="Ledger.Conway.Specification.Chain.html#2583" class="Bound">b</a> <a id="3289" href="Ledger.Conway.Specification.BlockBody.html#1191" class="Datatype Operator">,BBODY⦈</a> <a id="3297" class="Symbol">(</a><a id="3298" href="Ledger.Conway.Specification.Chain.html#2475" class="Generalizable">ls&#39;</a> <a id="3302" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3304" href="Ledger.Conway.Specification.Chain.html#2575" class="Bound">bcur&#39;</a><a id="3309" class="Symbol">)</a>
      <a id="3317" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="3356" class="Symbol">_</a> <a id="3358" href="Ledger.Conway.Specification.Chain.html#2495" class="Datatype Operator">⊢</a> <a id="3360" href="Ledger.Conway.Specification.Chain.html#2617" class="Bound">cs</a> <a id="3363" href="Ledger.Conway.Specification.Chain.html#2495" class="Datatype Operator">⇀⦇</a> <a id="3366" href="Ledger.Conway.Specification.Chain.html#2583" class="Bound">b</a> <a id="3368" href="Ledger.Conway.Specification.Chain.html#2495" class="Datatype Operator">,CHAIN⦈</a> <a id="3376" href="Ledger.Conway.Specification.Chain.html#2913" class="Bound">cs&#39;</a>

</pre></body></html>