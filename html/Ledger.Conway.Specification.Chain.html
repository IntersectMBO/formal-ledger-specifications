<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Chain</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Core.Specification.Abstract.html" class="Module">Ledger.Core.Specification.Abstract</a>
<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="124" class="Keyword">module</a> <a id="131" href="Ledger.Conway.Specification.Chain.html" class="Module">Ledger.Conway.Specification.Chain</a>
  <a id="167" class="Symbol">(</a><a id="168" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a> <a id="172" class="Symbol">:</a> <a id="174" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="194" class="Symbol">)</a> <a id="196" class="Symbol">(</a><a id="197" class="Keyword">open</a> <a id="202" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="223" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a><a id="226" class="Symbol">)</a>
  <a id="230" class="Symbol">(</a><a id="231" href="Ledger.Conway.Specification.Chain.html#231" class="Bound">abs</a> <a id="235" class="Symbol">:</a> <a id="237" href="Ledger.Core.Specification.Abstract.html#651" class="Record">AbstractFunctions</a> <a id="255" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a><a id="258" class="Symbol">)</a>
  <a id="262" class="Keyword">where</a>

<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Algebra.html" class="Module">Algebra</a>
<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="321" class="Keyword">using</a> <a id="327" class="Symbol">(</a><a id="328" href="Data.Nat.Properties.html#17566" class="Function">+-0-monoid</a><a id="338" class="Symbol">)</a>

<a id="341" class="Keyword">open</a> <a id="346" class="Keyword">import</a> <a id="353" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="369" class="Keyword">open</a> <a id="374" class="Keyword">import</a> <a id="381" href="Ledger.Conway.Specification.BlockBody.html" class="Module">Ledger.Conway.Specification.BlockBody</a> <a id="419" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a> <a id="423" href="Ledger.Conway.Specification.Chain.html#231" class="Bound">abs</a> <a id="427" class="Keyword">public</a>
<a id="434" class="Keyword">open</a> <a id="439" class="Keyword">import</a> <a id="446" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="480" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="539" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="552" class="Keyword">open</a> <a id="557" class="Keyword">import</a> <a id="564" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="598" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a> <a id="602" href="Ledger.Conway.Specification.Chain.html#231" class="Bound">abs</a>
<a id="606" class="Keyword">open</a> <a id="611" class="Keyword">import</a> <a id="618" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="650" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a>
<a id="654" class="Keyword">open</a> <a id="659" class="Keyword">import</a> <a id="666" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="701" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a> <a id="705" href="Ledger.Conway.Specification.Chain.html#231" class="Bound">abs</a>
<a id="709" class="Keyword">open</a> <a id="714" class="Keyword">import</a> <a id="721" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="756" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a>
<a id="760" class="Keyword">open</a> <a id="765" class="Keyword">import</a> <a id="772" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a> <a id="813" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a> <a id="817" href="Ledger.Conway.Specification.Chain.html#231" class="Bound">abs</a>
<a id="821" class="Keyword">open</a> <a id="826" class="Keyword">import</a> <a id="833" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="873" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a> <a id="877" href="Ledger.Conway.Specification.Chain.html#231" class="Bound">abs</a>
<a id="881" class="Keyword">open</a> <a id="886" class="Keyword">import</a> <a id="893" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="926" href="Ledger.Conway.Specification.Chain.html#168" class="Bound">txs</a> <a id="930" href="Ledger.Conway.Specification.Chain.html#231" class="Bound">abs</a>

<a id="935" class="Keyword">open</a> <a id="940" href="Function.Bundles.html#4750" class="Module">Equivalence</a>


<a id="954" class="Keyword">record</a> <a id="ChainState"></a><a id="961" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a> <a id="972" class="Symbol">:</a> <a id="974" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="979" class="Keyword">where</a>
  <a id="987" class="Keyword">field</a>
    <a id="ChainState.newEpochState"></a><a id="997" href="Ledger.Conway.Specification.Chain.html#997" class="Field">newEpochState</a>  <a id="1012" class="Symbol">:</a> <a id="1014" href="Ledger.Conway.Specification.Epoch.html#3360" class="Record">NewEpochState</a>


<a id="1030" class="Keyword">instance</a>
  <a id="HasNewEpochState-ChainState"></a><a id="1041" href="Ledger.Conway.Specification.Chain.html#1041" class="Function">HasNewEpochState-ChainState</a> <a id="1069" class="Symbol">:</a> <a id="1071" href="Ledger.Conway.Specification.Epoch.html#3589" class="Record">HasNewEpochState</a> <a id="1088" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="1101" href="Ledger.Conway.Specification.Chain.html#1041" class="Function">HasNewEpochState-ChainState</a> <a id="1129" class="Symbol">.</a><a id="1130" href="Ledger.Conway.Specification.Epoch.html#3646" class="Field">NewEpochStateOf</a> <a id="1146" class="Symbol">=</a> <a id="1148" href="Ledger.Conway.Specification.Chain.html#997" class="Field">ChainState.newEpochState</a>

  <a id="HasLastEpoch-ChainState"></a><a id="1176" href="Ledger.Conway.Specification.Chain.html#1176" class="Function">HasLastEpoch-ChainState</a> <a id="1200" class="Symbol">:</a> <a id="1202" href="Ledger.Conway.Specification.Epoch.html#3724" class="Record">HasLastEpoch</a> <a id="1215" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="1228" href="Ledger.Conway.Specification.Chain.html#1176" class="Function">HasLastEpoch-ChainState</a> <a id="1252" class="Symbol">.</a><a id="1253" href="Ledger.Conway.Specification.Epoch.html#3779" class="Field">LastEpochOf</a> <a id="1265" class="Symbol">=</a> <a id="1267" href="Ledger.Conway.Specification.Epoch.html#3779" class="Field">LastEpochOf</a> <a id="1279" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1281" href="Ledger.Conway.Specification.Epoch.html#3646" class="Field">NewEpochStateOf</a>

  <a id="HasEpochState-ChainState"></a><a id="1300" href="Ledger.Conway.Specification.Chain.html#1300" class="Function">HasEpochState-ChainState</a> <a id="1325" class="Symbol">:</a> <a id="1327" href="Ledger.Conway.Specification.Epoch.html#2036" class="Record">HasEpochState</a> <a id="1341" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="1354" href="Ledger.Conway.Specification.Chain.html#1300" class="Function">HasEpochState-ChainState</a> <a id="1379" class="Symbol">.</a><a id="1380" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a> <a id="1393" class="Symbol">=</a> <a id="1395" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a> <a id="1408" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1410" href="Ledger.Conway.Specification.Epoch.html#3646" class="Field">NewEpochStateOf</a>

  <a id="HasEnactState-ChainState"></a><a id="1429" href="Ledger.Conway.Specification.Chain.html#1429" class="Function">HasEnactState-ChainState</a> <a id="1454" class="Symbol">:</a> <a id="1456" href="Ledger.Conway.Specification.Enact.html#733" class="Record">HasEnactState</a> <a id="1470" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="1483" href="Ledger.Conway.Specification.Chain.html#1429" class="Function">HasEnactState-ChainState</a> <a id="1508" class="Symbol">.</a><a id="1509" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="1522" class="Symbol">=</a> <a id="1524" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="1537" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1539" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a>

  <a id="HasLState-ChainState"></a><a id="1555" href="Ledger.Conway.Specification.Chain.html#1555" class="Function">HasLState-ChainState</a> <a id="1576" class="Symbol">:</a> <a id="1578" href="Ledger.Conway.Specification.Ledger.html#1141" class="Record">HasLState</a> <a id="1588" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="1601" href="Ledger.Conway.Specification.Chain.html#1555" class="Function">HasLState-ChainState</a> <a id="1622" class="Symbol">.</a><a id="1623" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a> <a id="1632" class="Symbol">=</a> <a id="1634" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a> <a id="1643" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1645" href="Ledger.Conway.Specification.Epoch.html#2090" class="Field">EpochStateOf</a>

  <a id="HasUTxOState-ChainState"></a><a id="1661" href="Ledger.Conway.Specification.Chain.html#1661" class="Function">HasUTxOState-ChainState</a> <a id="1685" class="Symbol">:</a> <a id="1687" href="Ledger.Conway.Specification.Utxo.html#1472" class="Record">HasUTxOState</a> <a id="1700" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="1713" href="Ledger.Conway.Specification.Chain.html#1661" class="Function">HasUTxOState-ChainState</a> <a id="1737" class="Symbol">.</a><a id="1738" href="Ledger.Conway.Specification.Utxo.html#1525" class="Field">UTxOStateOf</a> <a id="1750" class="Symbol">=</a> <a id="1752" href="Ledger.Conway.Specification.Utxo.html#1525" class="Field">UTxOStateOf</a> <a id="1764" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1766" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a>

  <a id="HasCertState-ChainState"></a><a id="1778" href="Ledger.Conway.Specification.Chain.html#1778" class="Function">HasCertState-ChainState</a> <a id="1802" class="Symbol">:</a> <a id="1804" href="Ledger.Core.Specification.Certs.html#4837" class="Record">HasCertState</a> <a id="1817" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="1830" href="Ledger.Conway.Specification.Chain.html#1778" class="Function">HasCertState-ChainState</a> <a id="1854" class="Symbol">.</a><a id="1855" href="Ledger.Core.Specification.Certs.html#4890" class="Field">CertStateOf</a> <a id="1867" class="Symbol">=</a> <a id="1869" href="Ledger.Core.Specification.Certs.html#4890" class="Field">CertStateOf</a> <a id="1881" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1883" href="Ledger.Conway.Specification.Ledger.html#1191" class="Field">LStateOf</a>

  <a id="HasDeposits-ChainState"></a><a id="1895" href="Ledger.Conway.Specification.Chain.html#1895" class="Function">HasDeposits-ChainState</a> <a id="1918" class="Symbol">:</a> <a id="1920" href="Ledger.Core.Specification.Certs.html#833" class="Record">HasDeposits</a> <a id="1932" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="1945" href="Ledger.Conway.Specification.Chain.html#1895" class="Function">HasDeposits-ChainState</a> <a id="1968" class="Symbol">.</a><a id="1969" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="1980" class="Symbol">=</a> <a id="1982" href="Ledger.Core.Specification.Certs.html#885" class="Field">DepositsOf</a> <a id="1993" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1995" href="Ledger.Conway.Specification.Utxo.html#1525" class="Field">UTxOStateOf</a>

  <a id="HasRewards-ChainState"></a><a id="2010" href="Ledger.Conway.Specification.Chain.html#2010" class="Function">HasRewards-ChainState</a> <a id="2032" class="Symbol">:</a> <a id="2034" href="Ledger.Core.Specification.Certs.html#1763" class="Record">HasRewards</a> <a id="2045" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="2058" href="Ledger.Conway.Specification.Chain.html#2010" class="Function">HasRewards-ChainState</a> <a id="2080" class="Symbol">.</a><a id="2081" href="Ledger.Core.Specification.Certs.html#1814" class="Field">RewardsOf</a> <a id="2091" class="Symbol">=</a> <a id="2093" href="Ledger.Core.Specification.Certs.html#1814" class="Field">RewardsOf</a> <a id="2103" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2105" href="Ledger.Core.Specification.Certs.html#4890" class="Field">CertStateOf</a>

  <a id="HasPParams-ChainState"></a><a id="2120" href="Ledger.Conway.Specification.Chain.html#2120" class="Function">HasPParams-ChainState</a> <a id="2142" class="Symbol">:</a> <a id="2144" href="Ledger.Conway.Specification.PParams.html#3491" class="Record">HasPParams</a> <a id="2155" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a>
  <a id="2168" href="Ledger.Conway.Specification.Chain.html#2120" class="Function">HasPParams-ChainState</a> <a id="2190" class="Symbol">.</a><a id="2191" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="2201" class="Symbol">=</a> <a id="2203" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="2213" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2215" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a>

<a id="2229" class="Comment">-- refScriptsSize : UTxO → Tx → ℕ</a>
<a id="2263" class="Comment">-- refScriptsSize utxo tx = sum (map scriptSize (setToList (refScripts tx utxo)))</a>

<a id="totalRefScriptsSize"></a><a id="2346" href="Ledger.Conway.Specification.Chain.html#2346" class="Function">totalRefScriptsSize</a> <a id="2366" class="Symbol">:</a> <a id="2368" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a> <a id="2375" class="Symbol">→</a> <a id="2377" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2382" href="Ledger.Conway.Specification.Transaction.html#1719" class="Record">Tx</a> <a id="2385" class="Symbol">→</a> <a id="2387" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2389" href="Ledger.Conway.Specification.Chain.html#2346" class="Function">totalRefScriptsSize</a> <a id="2409" href="Ledger.Conway.Specification.Chain.html#2409" class="Bound">lst</a> <a id="2413" href="Ledger.Conway.Specification.Chain.html#2413" class="Bound">ts</a> <a id="2416" class="Symbol">=</a> <a id="2418" href="Data.Nat.ListAction.html#612" class="Function">sum</a> <a id="2422" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="2424" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2428" class="Symbol">(</a><a id="2429" href="Ledger.Conway.Specification.Utxo.html#2596" class="Function">refScriptsSize</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Ledger.Core.Specification.Transaction.html#2830" class="Field">UTxOOf</a> <a id="2452" href="Ledger.Conway.Specification.Chain.html#2409" class="Bound">lst</a><a id="2455" class="Symbol">))</a> <a id="2458" href="Ledger.Conway.Specification.Chain.html#2413" class="Bound">ts</a>

<a id="2462" class="Keyword">private</a> <a id="2470" class="Keyword">variable</a>
  <a id="2481" href="Ledger.Conway.Specification.Chain.html#2481" class="Generalizable">ls&#39;</a> <a id="2485" class="Symbol">:</a> <a id="2487" href="Ledger.Conway.Specification.Ledger.html#997" class="Record">LState</a>


<a id="2496" class="Keyword">data</a> <a id="_⊢_⇀⦇_,CHAIN⦈_"></a><a id="2501" href="Ledger.Conway.Specification.Chain.html#2501" class="Datatype Operator">_⊢_⇀⦇_,CHAIN⦈_</a> <a id="2516" class="Symbol">:</a> <a id="2518" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="2520" class="Symbol">→</a> <a id="2522" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a> <a id="2533" class="Symbol">→</a> <a id="2535" href="Ledger.Conway.Specification.BlockBody.html#742" class="Record">Block</a> <a id="2541" class="Symbol">→</a> <a id="2543" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a> <a id="2554" class="Symbol">→</a> <a id="2556" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2561" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,CHAIN⦈_.CHAIN"></a><a id="2570" href="Ledger.Conway.Specification.Chain.html#2570" class="InductiveConstructor">CHAIN</a> <a id="2576" class="Symbol">:</a> <a id="2578" class="Symbol">∀</a> <a id="2580" class="Symbol">{</a><a id="2581" href="Ledger.Conway.Specification.Chain.html#2581" class="Bound">bcur&#39;</a><a id="2586" class="Symbol">}</a> <a id="2588" class="Symbol">{</a><a id="2589" href="Ledger.Conway.Specification.Chain.html#2589" class="Bound">b</a> <a id="2591" class="Symbol">:</a> <a id="2593" href="Ledger.Conway.Specification.BlockBody.html#742" class="Record">Block</a><a id="2598" class="Symbol">}</a> <a id="2600" class="Symbol">{</a><a id="2601" href="Ledger.Conway.Specification.Chain.html#2601" class="Bound">nes</a> <a id="2605" class="Symbol">:</a> <a id="2607" href="Ledger.Conway.Specification.Epoch.html#3360" class="Record">NewEpochState</a><a id="2620" class="Symbol">}</a> <a id="2622" class="Symbol">{</a><a id="2623" href="Ledger.Conway.Specification.Chain.html#2623" class="Bound">cs</a> <a id="2626" class="Symbol">:</a> <a id="2628" href="Ledger.Conway.Specification.Chain.html#961" class="Record">ChainState</a><a id="2638" class="Symbol">}</a>


    <a id="2646" class="Symbol">→</a> <a id="2648" class="Keyword">let</a> <a id="2652" class="Keyword">open</a> <a id="2657" href="Ledger.Conway.Specification.Chain.html#961" class="Module">ChainState</a> <a id="2668" href="Ledger.Conway.Specification.Chain.html#2623" class="Bound">cs</a><a id="2670" class="Symbol">;</a> <a id="2672" class="Keyword">open</a> <a id="2677" href="Ledger.Conway.Specification.BlockBody.html#742" class="Module">Block</a> <a id="2683" href="Ledger.Conway.Specification.Chain.html#2589" class="Bound">b</a><a id="2684" class="Symbol">;</a> <a id="2686" class="Keyword">open</a> <a id="2691" href="Ledger.Conway.Specification.BlockBody.html#668" class="Module">BHeader</a> <a id="2699" href="Ledger.Conway.Specification.BlockBody.html#773" class="Function">bheader</a>
          <a id="2717" class="Keyword">open</a> <a id="2722" href="Ledger.Conway.Specification.BlockBody.html#540" class="Module">BHBody</a> <a id="2729" href="Ledger.Conway.Specification.BlockBody.html#701" class="Function">bhbody</a><a id="2735" class="Symbol">;</a> <a id="2737" class="Keyword">open</a> <a id="2742" href="Ledger.Conway.Specification.Epoch.html#3360" class="Module">NewEpochState</a> <a id="2756" href="Ledger.Conway.Specification.Chain.html#2601" class="Bound">nes</a>
          <a id="2770" class="Keyword">open</a> <a id="2775" href="Ledger.Conway.Specification.Epoch.html#1833" class="Module">EpochState</a> <a id="2786" href="Ledger.Conway.Specification.Epoch.html#3481" class="Function">epochState</a><a id="2796" class="Symbol">;</a> <a id="2798" class="Keyword">open</a> <a id="2803" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a> <a id="2814" href="Ledger.Conway.Specification.Epoch.html#1974" class="Function">es</a> <a id="2817" class="Keyword">renaming</a> <a id="2826" class="Symbol">(</a><a id="2827" href="Ledger.Conway.Specification.Enact.html#654" class="Field">pparams</a> <a id="2835" class="Symbol">to</a> <a id="2838" class="Field">pp</a><a id="2840" class="Symbol">)</a>
          <a id="2852" class="Keyword">open</a> <a id="2857" href="Ledger.Conway.Specification.PParams.html#1687" class="Module">PParams</a> <a id="2865" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2867" href="Ledger.Conway.Specification.Chain.html#2838" class="Function">pp</a> <a id="2870" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2872" class="Keyword">using</a> <a id="2878" class="Symbol">(</a><a id="2879" href="Ledger.Conway.Specification.PParams.html#2599" class="Field">maxRefScriptSizePerBlock</a><a id="2903" class="Symbol">)</a> <a id="2905" class="Keyword">in</a>


    <a id="2914" class="Keyword">let</a>  <a id="2919" href="Ledger.Conway.Specification.Chain.html#2919" class="Bound">cs&#39;</a>  <a id="2924" class="Symbol">=</a> <a id="2926" class="Keyword">record</a> <a id="2933" href="Ledger.Conway.Specification.Chain.html#2623" class="Bound">cs</a> <a id="2936" class="Symbol">{</a>  <a id="2939" href="Ledger.Conway.Specification.Chain.html#997" class="Field">newEpochState</a>
                             <a id="2982" class="Symbol">=</a> <a id="2984" class="Keyword">record</a> <a id="2991" href="Ledger.Conway.Specification.Chain.html#2601" class="Bound">nes</a> <a id="2995" class="Symbol">{</a>  <a id="2998" href="Ledger.Conway.Specification.Epoch.html#3452" class="Field">bcur</a> <a id="3003" class="Symbol">=</a> <a id="3005" href="Ledger.Conway.Specification.Chain.html#2581" class="Bound">bcur&#39;</a><a id="3010" class="Symbol">;</a>
                                             <a id="3057" href="Ledger.Conway.Specification.Epoch.html#3481" class="Field">epochState</a>
                                             <a id="3113" class="Symbol">=</a> <a id="3115" class="Keyword">record</a> <a id="3122" href="Ledger.Conway.Specification.Epoch.html#3481" class="Function">epochState</a> <a id="3133" class="Symbol">{</a><a id="3134" href="Ledger.Conway.Specification.Epoch.html#1950" class="Field">ls</a> <a id="3137" class="Symbol">=</a> <a id="3139" href="Ledger.Conway.Specification.Chain.html#2481" class="Generalizable">ls&#39;</a><a id="3142" class="Symbol">}</a> <a id="3144" class="Symbol">}</a> <a id="3146" class="Symbol">}</a>
    <a id="3152" class="Keyword">in</a>
    <a id="3159" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="3161" href="Ledger.Conway.Specification.Chain.html#2346" class="Function">totalRefScriptsSize</a> <a id="3181" href="Ledger.Conway.Specification.Epoch.html#1950" class="Function">ls</a> <a id="3184" href="Ledger.Conway.Specification.BlockBody.html#799" class="Function">ts</a> <a id="3187" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="3189" href="Ledger.Conway.Specification.PParams.html#2599" class="Function">maxRefScriptSizePerBlock</a>
    <a id="3218" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="3220" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3223" href="Ledger.Conway.Specification.RewardUpdate.html#1192" class="Datatype Operator">⊢</a> <a id="3225" href="Ledger.Conway.Specification.Chain.html#997" class="Field">newEpochState</a> <a id="3239" href="Ledger.Conway.Specification.RewardUpdate.html#1192" class="Datatype Operator">⇀⦇</a> <a id="3242" href="Ledger.Conway.Specification.BlockBody.html#607" class="Function">slot</a> <a id="3247" href="Ledger.Conway.Specification.RewardUpdate.html#1192" class="Datatype Operator">,TICK⦈</a> <a id="3254" href="Ledger.Conway.Specification.Chain.html#2601" class="Bound">nes</a>
    <a id="3262" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="3264" class="Symbol">(</a><a id="3265" href="Ledger.Conway.Specification.Epoch.html#1974" class="Function">es</a> <a id="3268" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3270" href="Ledger.Conway.Specification.Epoch.html#1901" class="Function">acnt</a><a id="3274" class="Symbol">)</a> <a id="3276" href="Ledger.Conway.Specification.BlockBody.html#1197" class="Datatype Operator">⊢</a> <a id="3278" class="Symbol">(</a><a id="3279" href="Ledger.Conway.Specification.Epoch.html#1950" class="Function">ls</a> <a id="3282" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3284" href="Ledger.Conway.Specification.Epoch.html#3452" class="Function">bcur</a><a id="3288" class="Symbol">)</a> <a id="3290" href="Ledger.Conway.Specification.BlockBody.html#1197" class="Datatype Operator">⇀⦇</a> <a id="3293" href="Ledger.Conway.Specification.Chain.html#2589" class="Bound">b</a> <a id="3295" href="Ledger.Conway.Specification.BlockBody.html#1197" class="Datatype Operator">,BBODY⦈</a> <a id="3303" class="Symbol">(</a><a id="3304" href="Ledger.Conway.Specification.Chain.html#2481" class="Generalizable">ls&#39;</a> <a id="3308" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3310" href="Ledger.Conway.Specification.Chain.html#2581" class="Bound">bcur&#39;</a><a id="3315" class="Symbol">)</a>
      <a id="3323" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="3362" class="Symbol">_</a> <a id="3364" href="Ledger.Conway.Specification.Chain.html#2501" class="Datatype Operator">⊢</a> <a id="3366" href="Ledger.Conway.Specification.Chain.html#2623" class="Bound">cs</a> <a id="3369" href="Ledger.Conway.Specification.Chain.html#2501" class="Datatype Operator">⇀⦇</a> <a id="3372" href="Ledger.Conway.Specification.Chain.html#2589" class="Bound">b</a> <a id="3374" href="Ledger.Conway.Specification.Chain.html#2501" class="Datatype Operator">,CHAIN⦈</a> <a id="3382" href="Ledger.Conway.Specification.Chain.html#2919" class="Bound">cs&#39;</a>

</pre></body></html>