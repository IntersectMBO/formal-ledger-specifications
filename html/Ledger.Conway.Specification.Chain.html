<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Chain</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>
<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a>

<a id="126" class="Keyword">module</a> <a id="133" href="Ledger.Conway.Specification.Chain.html" class="Module">Ledger.Conway.Specification.Chain</a>
  <a id="169" class="Symbol">(</a><a id="170" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="174" class="Symbol">:</a> <a id="176" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="196" class="Symbol">)</a> <a id="198" class="Symbol">(</a><a id="199" class="Keyword">open</a> <a id="204" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="225" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a><a id="228" class="Symbol">)</a>
  <a id="232" class="Symbol">(</a><a id="233" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a> <a id="237" class="Symbol">:</a> <a id="239" href="Ledger.Conway.Specification.Abstract.html#653" class="Record">AbstractFunctions</a> <a id="257" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a><a id="260" class="Symbol">)</a>
  <a id="264" class="Keyword">where</a>

<a id="271" class="Keyword">open</a> <a id="276" class="Keyword">import</a> <a id="283" href="Algebra.html" class="Module">Algebra</a>
<a id="291" class="Keyword">open</a> <a id="296" class="Keyword">import</a> <a id="303" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="323" class="Keyword">using</a> <a id="329" class="Symbol">(</a><a id="330" href="Data.Nat.Properties.html#17566" class="Function">+-0-monoid</a><a id="340" class="Symbol">)</a>

<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Ledger.Conway.Specification.BlockBody.html" class="Module">Ledger.Conway.Specification.BlockBody</a> <a id="421" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="425" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a> <a id="429" class="Keyword">public</a>
<a id="436" class="Keyword">open</a> <a id="441" class="Keyword">import</a> <a id="448" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="482" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="495" class="Keyword">open</a> <a id="500" class="Keyword">import</a> <a id="507" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="541" href="Ledger.Core.Specification.Transaction.html#1970" class="Function">govStructure</a>
<a id="554" class="Keyword">open</a> <a id="559" class="Keyword">import</a> <a id="566" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="600" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="604" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>
<a id="608" class="Keyword">open</a> <a id="613" class="Keyword">import</a> <a id="620" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="652" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a>
<a id="656" class="Keyword">open</a> <a id="661" class="Keyword">import</a> <a id="668" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="703" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="707" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>
<a id="711" class="Keyword">open</a> <a id="716" class="Keyword">import</a> <a id="723" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="758" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a>
<a id="762" class="Keyword">open</a> <a id="767" class="Keyword">import</a> <a id="774" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a> <a id="815" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="819" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>
<a id="823" class="Keyword">open</a> <a id="828" class="Keyword">import</a> <a id="835" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="875" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="879" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>
<a id="883" class="Keyword">open</a> <a id="888" class="Keyword">import</a> <a id="895" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="928" href="Ledger.Conway.Specification.Chain.html#170" class="Bound">txs</a> <a id="932" href="Ledger.Conway.Specification.Chain.html#233" class="Bound">abs</a>

<a id="937" class="Keyword">open</a> <a id="942" href="Function.Bundles.html#4750" class="Module">Equivalence</a>


<a id="956" class="Keyword">record</a> <a id="ChainState"></a><a id="963" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a> <a id="974" class="Symbol">:</a> <a id="976" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="981" class="Keyword">where</a>
  <a id="989" class="Keyword">field</a>
    <a id="ChainState.newEpochState"></a><a id="999" href="Ledger.Conway.Specification.Chain.html#999" class="Field">newEpochState</a>  <a id="1014" class="Symbol">:</a> <a id="1016" href="Ledger.Conway.Specification.Epoch.html#3362" class="Record">NewEpochState</a>


<a id="1032" class="Keyword">instance</a>
  <a id="HasNewEpochState-ChainState"></a><a id="1043" href="Ledger.Conway.Specification.Chain.html#1043" class="Function">HasNewEpochState-ChainState</a> <a id="1071" class="Symbol">:</a> <a id="1073" href="Ledger.Conway.Specification.Epoch.html#3591" class="Record">HasNewEpochState</a> <a id="1090" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="1103" href="Ledger.Conway.Specification.Chain.html#1043" class="Function">HasNewEpochState-ChainState</a> <a id="1131" class="Symbol">.</a><a id="1132" href="Ledger.Conway.Specification.Epoch.html#3648" class="Field">NewEpochStateOf</a> <a id="1148" class="Symbol">=</a> <a id="1150" href="Ledger.Conway.Specification.Chain.html#999" class="Field">ChainState.newEpochState</a>

  <a id="HasLastEpoch-ChainState"></a><a id="1178" href="Ledger.Conway.Specification.Chain.html#1178" class="Function">HasLastEpoch-ChainState</a> <a id="1202" class="Symbol">:</a> <a id="1204" href="Ledger.Conway.Specification.Epoch.html#3726" class="Record">HasLastEpoch</a> <a id="1217" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="1230" href="Ledger.Conway.Specification.Chain.html#1178" class="Function">HasLastEpoch-ChainState</a> <a id="1254" class="Symbol">.</a><a id="1255" href="Ledger.Conway.Specification.Epoch.html#3781" class="Field">LastEpochOf</a> <a id="1267" class="Symbol">=</a> <a id="1269" href="Ledger.Conway.Specification.Epoch.html#3781" class="Field">LastEpochOf</a> <a id="1281" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1283" href="Ledger.Conway.Specification.Epoch.html#3648" class="Field">NewEpochStateOf</a>

  <a id="HasEpochState-ChainState"></a><a id="1302" href="Ledger.Conway.Specification.Chain.html#1302" class="Function">HasEpochState-ChainState</a> <a id="1327" class="Symbol">:</a> <a id="1329" href="Ledger.Conway.Specification.Epoch.html#2038" class="Record">HasEpochState</a> <a id="1343" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="1356" href="Ledger.Conway.Specification.Chain.html#1302" class="Function">HasEpochState-ChainState</a> <a id="1381" class="Symbol">.</a><a id="1382" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a> <a id="1395" class="Symbol">=</a> <a id="1397" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a> <a id="1410" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1412" href="Ledger.Conway.Specification.Epoch.html#3648" class="Field">NewEpochStateOf</a>

  <a id="HasEnactState-ChainState"></a><a id="1431" href="Ledger.Conway.Specification.Chain.html#1431" class="Function">HasEnactState-ChainState</a> <a id="1456" class="Symbol">:</a> <a id="1458" href="Ledger.Conway.Specification.Enact.html#733" class="Record">HasEnactState</a> <a id="1472" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="1485" href="Ledger.Conway.Specification.Chain.html#1431" class="Function">HasEnactState-ChainState</a> <a id="1510" class="Symbol">.</a><a id="1511" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="1524" class="Symbol">=</a> <a id="1526" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a> <a id="1539" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1541" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a>

  <a id="HasLState-ChainState"></a><a id="1557" href="Ledger.Conway.Specification.Chain.html#1557" class="Function">HasLState-ChainState</a> <a id="1578" class="Symbol">:</a> <a id="1580" href="Ledger.Conway.Specification.Ledger.html#1143" class="Record">HasLState</a> <a id="1590" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="1603" href="Ledger.Conway.Specification.Chain.html#1557" class="Function">HasLState-ChainState</a> <a id="1624" class="Symbol">.</a><a id="1625" href="Ledger.Conway.Specification.Ledger.html#1193" class="Field">LStateOf</a> <a id="1634" class="Symbol">=</a> <a id="1636" href="Ledger.Conway.Specification.Ledger.html#1193" class="Field">LStateOf</a> <a id="1645" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1647" href="Ledger.Conway.Specification.Epoch.html#2092" class="Field">EpochStateOf</a>

  <a id="HasUTxOState-ChainState"></a><a id="1663" href="Ledger.Conway.Specification.Chain.html#1663" class="Function">HasUTxOState-ChainState</a> <a id="1687" class="Symbol">:</a> <a id="1689" href="Ledger.Conway.Specification.Utxo.html#1474" class="Record">HasUTxOState</a> <a id="1702" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="1715" href="Ledger.Conway.Specification.Chain.html#1663" class="Function">HasUTxOState-ChainState</a> <a id="1739" class="Symbol">.</a><a id="1740" href="Ledger.Conway.Specification.Utxo.html#1527" class="Field">UTxOStateOf</a> <a id="1752" class="Symbol">=</a> <a id="1754" href="Ledger.Conway.Specification.Utxo.html#1527" class="Field">UTxOStateOf</a> <a id="1766" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1768" href="Ledger.Conway.Specification.Ledger.html#1193" class="Field">LStateOf</a>

  <a id="HasCertState-ChainState"></a><a id="1780" href="Ledger.Conway.Specification.Chain.html#1780" class="Function">HasCertState-ChainState</a> <a id="1804" class="Symbol">:</a> <a id="1806" href="Ledger.Conway.Specification.Certs.html#4864" class="Record">HasCertState</a> <a id="1819" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="1832" href="Ledger.Conway.Specification.Chain.html#1780" class="Function">HasCertState-ChainState</a> <a id="1856" class="Symbol">.</a><a id="1857" href="Ledger.Conway.Specification.Certs.html#4917" class="Field">CertStateOf</a> <a id="1869" class="Symbol">=</a> <a id="1871" href="Ledger.Conway.Specification.Certs.html#4917" class="Field">CertStateOf</a> <a id="1883" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1885" href="Ledger.Conway.Specification.Ledger.html#1193" class="Field">LStateOf</a>

  <a id="HasDeposits-ChainState"></a><a id="1897" href="Ledger.Conway.Specification.Chain.html#1897" class="Function">HasDeposits-ChainState</a> <a id="1920" class="Symbol">:</a> <a id="1922" href="Ledger.Conway.Specification.Certs.html#860" class="Record">HasDeposits</a> <a id="1934" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="1947" href="Ledger.Conway.Specification.Chain.html#1897" class="Function">HasDeposits-ChainState</a> <a id="1970" class="Symbol">.</a><a id="1971" href="Ledger.Conway.Specification.Certs.html#912" class="Field">DepositsOf</a> <a id="1982" class="Symbol">=</a> <a id="1984" href="Ledger.Conway.Specification.Certs.html#912" class="Field">DepositsOf</a> <a id="1995" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1997" href="Ledger.Conway.Specification.Utxo.html#1527" class="Field">UTxOStateOf</a>

  <a id="HasRewards-ChainState"></a><a id="2012" href="Ledger.Conway.Specification.Chain.html#2012" class="Function">HasRewards-ChainState</a> <a id="2034" class="Symbol">:</a> <a id="2036" href="Ledger.Conway.Specification.Certs.html#1790" class="Record">HasRewards</a> <a id="2047" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="2060" href="Ledger.Conway.Specification.Chain.html#2012" class="Function">HasRewards-ChainState</a> <a id="2082" class="Symbol">.</a><a id="2083" href="Ledger.Conway.Specification.Certs.html#1841" class="Field">RewardsOf</a> <a id="2093" class="Symbol">=</a> <a id="2095" href="Ledger.Conway.Specification.Certs.html#1841" class="Field">RewardsOf</a> <a id="2105" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2107" href="Ledger.Conway.Specification.Certs.html#4917" class="Field">CertStateOf</a>

  <a id="HasPParams-ChainState"></a><a id="2122" href="Ledger.Conway.Specification.Chain.html#2122" class="Function">HasPParams-ChainState</a> <a id="2144" class="Symbol">:</a> <a id="2146" href="Ledger.Conway.Specification.PParams.html#3491" class="Record">HasPParams</a> <a id="2157" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a>
  <a id="2170" href="Ledger.Conway.Specification.Chain.html#2122" class="Function">HasPParams-ChainState</a> <a id="2192" class="Symbol">.</a><a id="2193" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="2203" class="Symbol">=</a> <a id="2205" href="Ledger.Conway.Specification.PParams.html#3542" class="Field">PParamsOf</a> <a id="2215" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2217" href="Ledger.Conway.Specification.Enact.html#787" class="Field">EnactStateOf</a>

<a id="2231" class="Comment">-- refScriptsSize : UTxO → Tx → ℕ</a>
<a id="2265" class="Comment">-- refScriptsSize utxo tx = sum (map scriptSize (setToList (refScripts tx utxo)))</a>

<a id="totalRefScriptsSize"></a><a id="2348" href="Ledger.Conway.Specification.Chain.html#2348" class="Function">totalRefScriptsSize</a> <a id="2368" class="Symbol">:</a> <a id="2370" href="Ledger.Conway.Specification.Ledger.html#999" class="Record">LState</a> <a id="2377" class="Symbol">→</a> <a id="2379" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2384" href="Ledger.Conway.Specification.Transaction.html#1721" class="Record">Tx</a> <a id="2387" class="Symbol">→</a> <a id="2389" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2391" href="Ledger.Conway.Specification.Chain.html#2348" class="Function">totalRefScriptsSize</a> <a id="2411" href="Ledger.Conway.Specification.Chain.html#2411" class="Bound">lst</a> <a id="2415" href="Ledger.Conway.Specification.Chain.html#2415" class="Bound">ts</a> <a id="2418" class="Symbol">=</a> <a id="2420" href="Data.Nat.ListAction.html#612" class="Function">sum</a> <a id="2424" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="2426" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2430" class="Symbol">(</a><a id="2431" href="Ledger.Conway.Specification.Utxo.html#2598" class="Function">refScriptsSize</a> <a id="2446" class="Symbol">(</a><a id="2447" href="Ledger.Core.Specification.Transaction.html#2830" class="Field">UTxOOf</a> <a id="2454" href="Ledger.Conway.Specification.Chain.html#2411" class="Bound">lst</a><a id="2457" class="Symbol">))</a> <a id="2460" href="Ledger.Conway.Specification.Chain.html#2415" class="Bound">ts</a>

<a id="2464" class="Keyword">private</a> <a id="2472" class="Keyword">variable</a>
  <a id="2483" href="Ledger.Conway.Specification.Chain.html#2483" class="Generalizable">ls&#39;</a> <a id="2487" class="Symbol">:</a> <a id="2489" href="Ledger.Conway.Specification.Ledger.html#999" class="Record">LState</a>


<a id="2498" class="Keyword">data</a> <a id="_⊢_⇀⦇_,CHAIN⦈_"></a><a id="2503" href="Ledger.Conway.Specification.Chain.html#2503" class="Datatype Operator">_⊢_⇀⦇_,CHAIN⦈_</a> <a id="2518" class="Symbol">:</a> <a id="2520" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="2522" class="Symbol">→</a> <a id="2524" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a> <a id="2535" class="Symbol">→</a> <a id="2537" href="Ledger.Conway.Specification.BlockBody.html#744" class="Record">Block</a> <a id="2543" class="Symbol">→</a> <a id="2545" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a> <a id="2556" class="Symbol">→</a> <a id="2558" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2563" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,CHAIN⦈_.CHAIN"></a><a id="2572" href="Ledger.Conway.Specification.Chain.html#2572" class="InductiveConstructor">CHAIN</a> <a id="2578" class="Symbol">:</a> <a id="2580" class="Symbol">∀</a> <a id="2582" class="Symbol">{</a><a id="2583" href="Ledger.Conway.Specification.Chain.html#2583" class="Bound">bcur&#39;</a><a id="2588" class="Symbol">}</a> <a id="2590" class="Symbol">{</a><a id="2591" href="Ledger.Conway.Specification.Chain.html#2591" class="Bound">b</a> <a id="2593" class="Symbol">:</a> <a id="2595" href="Ledger.Conway.Specification.BlockBody.html#744" class="Record">Block</a><a id="2600" class="Symbol">}</a> <a id="2602" class="Symbol">{</a><a id="2603" href="Ledger.Conway.Specification.Chain.html#2603" class="Bound">nes</a> <a id="2607" class="Symbol">:</a> <a id="2609" href="Ledger.Conway.Specification.Epoch.html#3362" class="Record">NewEpochState</a><a id="2622" class="Symbol">}</a> <a id="2624" class="Symbol">{</a><a id="2625" href="Ledger.Conway.Specification.Chain.html#2625" class="Bound">cs</a> <a id="2628" class="Symbol">:</a> <a id="2630" href="Ledger.Conway.Specification.Chain.html#963" class="Record">ChainState</a><a id="2640" class="Symbol">}</a>


    <a id="2648" class="Symbol">→</a> <a id="2650" class="Keyword">let</a> <a id="2654" class="Keyword">open</a> <a id="2659" href="Ledger.Conway.Specification.Chain.html#963" class="Module">ChainState</a> <a id="2670" href="Ledger.Conway.Specification.Chain.html#2625" class="Bound">cs</a><a id="2672" class="Symbol">;</a> <a id="2674" class="Keyword">open</a> <a id="2679" href="Ledger.Conway.Specification.BlockBody.html#744" class="Module">Block</a> <a id="2685" href="Ledger.Conway.Specification.Chain.html#2591" class="Bound">b</a><a id="2686" class="Symbol">;</a> <a id="2688" class="Keyword">open</a> <a id="2693" href="Ledger.Conway.Specification.BlockBody.html#670" class="Module">BHeader</a> <a id="2701" href="Ledger.Conway.Specification.BlockBody.html#775" class="Function">bheader</a>
          <a id="2719" class="Keyword">open</a> <a id="2724" href="Ledger.Conway.Specification.BlockBody.html#542" class="Module">BHBody</a> <a id="2731" href="Ledger.Conway.Specification.BlockBody.html#703" class="Function">bhbody</a><a id="2737" class="Symbol">;</a> <a id="2739" class="Keyword">open</a> <a id="2744" href="Ledger.Conway.Specification.Epoch.html#3362" class="Module">NewEpochState</a> <a id="2758" href="Ledger.Conway.Specification.Chain.html#2603" class="Bound">nes</a>
          <a id="2772" class="Keyword">open</a> <a id="2777" href="Ledger.Conway.Specification.Epoch.html#1835" class="Module">EpochState</a> <a id="2788" href="Ledger.Conway.Specification.Epoch.html#3483" class="Function">epochState</a><a id="2798" class="Symbol">;</a> <a id="2800" class="Keyword">open</a> <a id="2805" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a> <a id="2816" href="Ledger.Conway.Specification.Epoch.html#1976" class="Function">es</a> <a id="2819" class="Keyword">renaming</a> <a id="2828" class="Symbol">(</a><a id="2829" href="Ledger.Conway.Specification.Enact.html#654" class="Field">pparams</a> <a id="2837" class="Symbol">to</a> <a id="2840" class="Field">pp</a><a id="2842" class="Symbol">)</a>
          <a id="2854" class="Keyword">open</a> <a id="2859" href="Ledger.Conway.Specification.PParams.html#1687" class="Module">PParams</a> <a id="2867" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2869" href="Ledger.Conway.Specification.Chain.html#2840" class="Function">pp</a> <a id="2872" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2874" class="Keyword">using</a> <a id="2880" class="Symbol">(</a><a id="2881" href="Ledger.Conway.Specification.PParams.html#2599" class="Field">maxRefScriptSizePerBlock</a><a id="2905" class="Symbol">)</a> <a id="2907" class="Keyword">in</a>


    <a id="2916" class="Keyword">let</a>  <a id="2921" href="Ledger.Conway.Specification.Chain.html#2921" class="Bound">cs&#39;</a>  <a id="2926" class="Symbol">=</a> <a id="2928" class="Keyword">record</a> <a id="2935" href="Ledger.Conway.Specification.Chain.html#2625" class="Bound">cs</a> <a id="2938" class="Symbol">{</a>  <a id="2941" href="Ledger.Conway.Specification.Chain.html#999" class="Field">newEpochState</a>
                             <a id="2984" class="Symbol">=</a> <a id="2986" class="Keyword">record</a> <a id="2993" href="Ledger.Conway.Specification.Chain.html#2603" class="Bound">nes</a> <a id="2997" class="Symbol">{</a>  <a id="3000" href="Ledger.Conway.Specification.Epoch.html#3454" class="Field">bcur</a> <a id="3005" class="Symbol">=</a> <a id="3007" href="Ledger.Conway.Specification.Chain.html#2583" class="Bound">bcur&#39;</a><a id="3012" class="Symbol">;</a>
                                             <a id="3059" href="Ledger.Conway.Specification.Epoch.html#3483" class="Field">epochState</a>
                                             <a id="3115" class="Symbol">=</a> <a id="3117" class="Keyword">record</a> <a id="3124" href="Ledger.Conway.Specification.Epoch.html#3483" class="Function">epochState</a> <a id="3135" class="Symbol">{</a><a id="3136" href="Ledger.Conway.Specification.Epoch.html#1952" class="Field">ls</a> <a id="3139" class="Symbol">=</a> <a id="3141" href="Ledger.Conway.Specification.Chain.html#2483" class="Generalizable">ls&#39;</a><a id="3144" class="Symbol">}</a> <a id="3146" class="Symbol">}</a> <a id="3148" class="Symbol">}</a>
    <a id="3154" class="Keyword">in</a>
    <a id="3161" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="3163" href="Ledger.Conway.Specification.Chain.html#2348" class="Function">totalRefScriptsSize</a> <a id="3183" href="Ledger.Conway.Specification.Epoch.html#1952" class="Function">ls</a> <a id="3186" href="Ledger.Conway.Specification.BlockBody.html#801" class="Function">ts</a> <a id="3189" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="3191" href="Ledger.Conway.Specification.PParams.html#2599" class="Function">maxRefScriptSizePerBlock</a>
    <a id="3220" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="3222" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3225" href="Ledger.Conway.Specification.RewardUpdate.html#1202" class="Datatype Operator">⊢</a> <a id="3227" href="Ledger.Conway.Specification.Chain.html#999" class="Field">newEpochState</a> <a id="3241" href="Ledger.Conway.Specification.RewardUpdate.html#1202" class="Datatype Operator">⇀⦇</a> <a id="3244" href="Ledger.Conway.Specification.BlockBody.html#609" class="Function">slot</a> <a id="3249" href="Ledger.Conway.Specification.RewardUpdate.html#1202" class="Datatype Operator">,TICK⦈</a> <a id="3256" href="Ledger.Conway.Specification.Chain.html#2603" class="Bound">nes</a>
    <a id="3264" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="3266" class="Symbol">(</a><a id="3267" href="Ledger.Conway.Specification.Epoch.html#1976" class="Function">es</a> <a id="3270" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3272" href="Ledger.Conway.Specification.Epoch.html#1903" class="Function">acnt</a><a id="3276" class="Symbol">)</a> <a id="3278" href="Ledger.Conway.Specification.BlockBody.html#1199" class="Datatype Operator">⊢</a> <a id="3280" class="Symbol">(</a><a id="3281" href="Ledger.Conway.Specification.Epoch.html#1952" class="Function">ls</a> <a id="3284" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3286" href="Ledger.Conway.Specification.Epoch.html#3454" class="Function">bcur</a><a id="3290" class="Symbol">)</a> <a id="3292" href="Ledger.Conway.Specification.BlockBody.html#1199" class="Datatype Operator">⇀⦇</a> <a id="3295" href="Ledger.Conway.Specification.Chain.html#2591" class="Bound">b</a> <a id="3297" href="Ledger.Conway.Specification.BlockBody.html#1199" class="Datatype Operator">,BBODY⦈</a> <a id="3305" class="Symbol">(</a><a id="3306" href="Ledger.Conway.Specification.Chain.html#2483" class="Generalizable">ls&#39;</a> <a id="3310" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3312" href="Ledger.Conway.Specification.Chain.html#2583" class="Bound">bcur&#39;</a><a id="3317" class="Symbol">)</a>
      <a id="3325" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="3364" class="Symbol">_</a> <a id="3366" href="Ledger.Conway.Specification.Chain.html#2503" class="Datatype Operator">⊢</a> <a id="3368" href="Ledger.Conway.Specification.Chain.html#2625" class="Bound">cs</a> <a id="3371" href="Ledger.Conway.Specification.Chain.html#2503" class="Datatype Operator">⇀⦇</a> <a id="3374" href="Ledger.Conway.Specification.Chain.html#2591" class="Bound">b</a> <a id="3376" href="Ledger.Conway.Specification.Chain.html#2503" class="Datatype Operator">,CHAIN⦈</a> <a id="3384" href="Ledger.Conway.Specification.Chain.html#2921" class="Bound">cs&#39;</a>

</pre></body></html>