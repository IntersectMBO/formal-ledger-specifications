<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Chain</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>

<a id="128" class="Keyword">module</a> <a id="135" href="Ledger.Conway.Specification.Chain.html" class="Module">Ledger.Conway.Specification.Chain</a>
  <a id="171" class="Symbol">(</a><a id="172" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a> <a id="176" class="Symbol">:</a> <a id="178" class="Symbol">_)</a> <a id="181" class="Symbol">(</a><a id="182" class="Keyword">open</a> <a id="187" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="208" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a><a id="211" class="Symbol">)</a>
  <a id="215" class="Symbol">(</a><a id="216" href="Ledger.Conway.Specification.Chain.html#216" class="Bound">abs</a> <a id="220" class="Symbol">:</a> <a id="222" href="Ledger.Conway.Specification.Abstract.html#830" class="Record">AbstractFunctions</a> <a id="240" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a><a id="243" class="Symbol">)</a> <a id="245" class="Symbol">(</a><a id="246" class="Keyword">open</a> <a id="251" href="Ledger.Conway.Specification.Abstract.html#830" class="Module">AbstractFunctions</a> <a id="269" href="Ledger.Conway.Specification.Chain.html#216" class="Bound">abs</a><a id="272" class="Symbol">)</a>
  <a id="276" class="Keyword">where</a>

<a id="283" class="Keyword">open</a> <a id="288" class="Keyword">import</a> <a id="295" href="Ledger.Conway.Specification.BlockBody.html" class="Module">Ledger.Conway.Specification.BlockBody</a> <a id="333" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a> <a id="337" href="Ledger.Conway.Specification.Chain.html#216" class="Bound">abs</a> <a id="341" class="Keyword">public</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Ledger.Conway.Specification.Certs.html" class="Module">Ledger.Conway.Specification.Certs</a> <a id="394" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="453" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="512" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a> <a id="516" href="Ledger.Conway.Specification.Chain.html#216" class="Bound">abs</a>
<a id="520" class="Keyword">open</a> <a id="525" class="Keyword">import</a> <a id="532" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="564" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a>
<a id="568" class="Keyword">open</a> <a id="573" class="Keyword">import</a> <a id="580" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="615" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a> <a id="619" href="Ledger.Conway.Specification.Chain.html#216" class="Bound">abs</a>
<a id="623" class="Keyword">open</a> <a id="628" class="Keyword">import</a> <a id="635" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a><a id="649" class="Symbol">;</a> <a id="651" class="Keyword">open</a> <a id="656" href="Function.Bundles.html#4750" class="Module">Equivalence</a>
<a id="668" class="Keyword">open</a> <a id="673" class="Keyword">import</a> <a id="680" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="715" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="728" class="Keyword">open</a> <a id="733" class="Keyword">import</a> <a id="740" href="Ledger.Conway.Specification.RewardUpdate.html" class="Module">Ledger.Conway.Specification.RewardUpdate</a> <a id="781" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a> <a id="785" href="Ledger.Conway.Specification.Chain.html#216" class="Bound">abs</a>
<a id="789" class="Keyword">open</a> <a id="794" class="Keyword">import</a> <a id="801" href="Ledger.Conway.Specification.Utxo.html" class="Module">Ledger.Conway.Specification.Utxo</a> <a id="834" href="Ledger.Conway.Specification.Chain.html#172" class="Bound">txs</a> <a id="838" href="Ledger.Conway.Specification.Chain.html#216" class="Bound">abs</a>

<a id="843" class="Keyword">open</a> <a id="848" class="Keyword">import</a> <a id="855" href="Algebra.html" class="Module">Algebra</a>
<a id="863" class="Keyword">open</a> <a id="868" class="Keyword">import</a> <a id="875" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="895" class="Keyword">using</a> <a id="901" class="Symbol">(</a><a id="902" href="Data.Nat.Properties.html#17566" class="Function">+-0-monoid</a><a id="912" class="Symbol">)</a>


<a id="916" class="Keyword">record</a> <a id="ChainState"></a><a id="923" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a> <a id="934" class="Symbol">:</a> <a id="936" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="941" class="Keyword">where</a>
  <a id="949" class="Keyword">field</a>
    <a id="ChainState.newEpochState"></a><a id="959" href="Ledger.Conway.Specification.Chain.html#959" class="Field">newEpochState</a>  <a id="974" class="Symbol">:</a> <a id="976" href="Ledger.Conway.Specification.Epoch.html#3597" class="Record">NewEpochState</a>


<a id="992" class="Keyword">instance</a>
  <a id="HasNewEpochState-ChainState"></a><a id="1003" href="Ledger.Conway.Specification.Chain.html#1003" class="Function">HasNewEpochState-ChainState</a> <a id="1031" class="Symbol">:</a> <a id="1033" href="Ledger.Conway.Specification.Epoch.html#3826" class="Record">HasNewEpochState</a> <a id="1050" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="1063" href="Ledger.Conway.Specification.Chain.html#1003" class="Function">HasNewEpochState-ChainState</a> <a id="1091" class="Symbol">.</a><a id="1092" href="Ledger.Conway.Specification.Epoch.html#3883" class="Field">NewEpochStateOf</a> <a id="1108" class="Symbol">=</a> <a id="1110" href="Ledger.Conway.Specification.Chain.html#959" class="Field">ChainState.newEpochState</a>

  <a id="HasLastEpoch-ChainState"></a><a id="1138" href="Ledger.Conway.Specification.Chain.html#1138" class="Function">HasLastEpoch-ChainState</a> <a id="1162" class="Symbol">:</a> <a id="1164" href="Ledger.Conway.Specification.Epoch.html#3961" class="Record">HasLastEpoch</a> <a id="1177" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="1190" href="Ledger.Conway.Specification.Chain.html#1138" class="Function">HasLastEpoch-ChainState</a> <a id="1214" class="Symbol">.</a><a id="1215" href="Ledger.Conway.Specification.Epoch.html#4016" class="Field">LastEpochOf</a> <a id="1227" class="Symbol">=</a> <a id="1229" href="Ledger.Conway.Specification.Epoch.html#4016" class="Field">LastEpochOf</a> <a id="1241" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1243" href="Ledger.Conway.Specification.Epoch.html#3883" class="Field">NewEpochStateOf</a>

  <a id="HasEpochState-ChainState"></a><a id="1262" href="Ledger.Conway.Specification.Chain.html#1262" class="Function">HasEpochState-ChainState</a> <a id="1287" class="Symbol">:</a> <a id="1289" href="Ledger.Conway.Specification.Epoch.html#2049" class="Record">HasEpochState</a> <a id="1303" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="1316" href="Ledger.Conway.Specification.Chain.html#1262" class="Function">HasEpochState-ChainState</a> <a id="1341" class="Symbol">.</a><a id="1342" href="Ledger.Conway.Specification.Epoch.html#2103" class="Field">EpochStateOf</a> <a id="1355" class="Symbol">=</a> <a id="1357" href="Ledger.Conway.Specification.Epoch.html#2103" class="Field">EpochStateOf</a> <a id="1370" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1372" href="Ledger.Conway.Specification.Epoch.html#3883" class="Field">NewEpochStateOf</a>

  <a id="HasEnactState-ChainState"></a><a id="1391" href="Ledger.Conway.Specification.Chain.html#1391" class="Function">HasEnactState-ChainState</a> <a id="1416" class="Symbol">:</a> <a id="1418" href="Ledger.Conway.Specification.Enact.html#737" class="Record">HasEnactState</a> <a id="1432" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="1445" href="Ledger.Conway.Specification.Chain.html#1391" class="Function">HasEnactState-ChainState</a> <a id="1470" class="Symbol">.</a><a id="1471" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="1484" class="Symbol">=</a> <a id="1486" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a> <a id="1499" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1501" href="Ledger.Conway.Specification.Epoch.html#2103" class="Field">EpochStateOf</a>

  <a id="HasLState-ChainState"></a><a id="1517" href="Ledger.Conway.Specification.Chain.html#1517" class="Function">HasLState-ChainState</a> <a id="1538" class="Symbol">:</a> <a id="1540" href="Ledger.Conway.Specification.Ledger.html#1123" class="Record">HasLState</a> <a id="1550" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="1563" href="Ledger.Conway.Specification.Chain.html#1517" class="Function">HasLState-ChainState</a> <a id="1584" class="Symbol">.</a><a id="1585" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a> <a id="1594" class="Symbol">=</a> <a id="1596" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a> <a id="1605" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1607" href="Ledger.Conway.Specification.Epoch.html#2103" class="Field">EpochStateOf</a>

  <a id="HasUTxOState-ChainState"></a><a id="1623" href="Ledger.Conway.Specification.Chain.html#1623" class="Function">HasUTxOState-ChainState</a> <a id="1647" class="Symbol">:</a> <a id="1649" href="Ledger.Conway.Specification.Utxo.html#1396" class="Record">HasUTxOState</a> <a id="1662" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="1675" href="Ledger.Conway.Specification.Chain.html#1623" class="Function">HasUTxOState-ChainState</a> <a id="1699" class="Symbol">.</a><a id="1700" href="Ledger.Conway.Specification.Utxo.html#1449" class="Field">UTxOStateOf</a> <a id="1712" class="Symbol">=</a> <a id="1714" href="Ledger.Conway.Specification.Utxo.html#1449" class="Field">UTxOStateOf</a> <a id="1726" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1728" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a>

  <a id="HasCertState-ChainState"></a><a id="1740" href="Ledger.Conway.Specification.Chain.html#1740" class="Function">HasCertState-ChainState</a> <a id="1764" class="Symbol">:</a> <a id="1766" href="Ledger.Conway.Specification.Certs.html#4729" class="Record">HasCertState</a> <a id="1779" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="1792" href="Ledger.Conway.Specification.Chain.html#1740" class="Function">HasCertState-ChainState</a> <a id="1816" class="Symbol">.</a><a id="1817" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a> <a id="1829" class="Symbol">=</a> <a id="1831" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a> <a id="1843" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1845" href="Ledger.Conway.Specification.Ledger.html#1173" class="Field">LStateOf</a>

  <a id="HasDeposits-ChainState"></a><a id="1857" href="Ledger.Conway.Specification.Chain.html#1857" class="Function">HasDeposits-ChainState</a> <a id="1880" class="Symbol">:</a> <a id="1882" href="Ledger.Conway.Specification.Certs.html#870" class="Record">HasDeposits</a> <a id="1894" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="1907" href="Ledger.Conway.Specification.Chain.html#1857" class="Function">HasDeposits-ChainState</a> <a id="1930" class="Symbol">.</a><a id="1931" href="Ledger.Conway.Specification.Certs.html#922" class="Field">DepositsOf</a> <a id="1942" class="Symbol">=</a> <a id="1944" href="Ledger.Conway.Specification.Certs.html#922" class="Field">DepositsOf</a> <a id="1955" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="1957" href="Ledger.Conway.Specification.Utxo.html#1449" class="Field">UTxOStateOf</a>

  <a id="HasRewards-ChainState"></a><a id="1972" href="Ledger.Conway.Specification.Chain.html#1972" class="Function">HasRewards-ChainState</a> <a id="1994" class="Symbol">:</a> <a id="1996" href="Ledger.Conway.Specification.Certs.html#1682" class="Record">HasRewards</a> <a id="2007" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="2020" href="Ledger.Conway.Specification.Chain.html#1972" class="Function">HasRewards-ChainState</a> <a id="2042" class="Symbol">.</a><a id="2043" href="Ledger.Conway.Specification.Certs.html#1733" class="Field">RewardsOf</a> <a id="2053" class="Symbol">=</a> <a id="2055" href="Ledger.Conway.Specification.Certs.html#1733" class="Field">RewardsOf</a> <a id="2065" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2067" href="Ledger.Conway.Specification.Certs.html#4782" class="Field">CertStateOf</a>

  <a id="HasPParams-ChainState"></a><a id="2082" href="Ledger.Conway.Specification.Chain.html#2082" class="Function">HasPParams-ChainState</a> <a id="2104" class="Symbol">:</a> <a id="2106" href="Ledger.Conway.Specification.PParams.html#3493" class="Record">HasPParams</a> <a id="2117" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a>
  <a id="2130" href="Ledger.Conway.Specification.Chain.html#2082" class="Function">HasPParams-ChainState</a> <a id="2152" class="Symbol">.</a><a id="2153" href="Ledger.Conway.Specification.PParams.html#3544" class="Field">PParamsOf</a> <a id="2163" class="Symbol">=</a> <a id="2165" href="Ledger.Conway.Specification.PParams.html#3544" class="Field">PParamsOf</a> <a id="2175" href="Function.Base.html#1134" class="Function Operator">∘</a> <a id="2177" href="Ledger.Conway.Specification.Enact.html#791" class="Field">EnactStateOf</a>

<a id="totalRefScriptsSize"></a><a id="2191" href="Ledger.Conway.Specification.Chain.html#2191" class="Function">totalRefScriptsSize</a> <a id="2211" class="Symbol">:</a> <a id="2213" href="Ledger.Conway.Specification.Ledger.html#979" class="Record">LState</a> <a id="2220" class="Symbol">→</a> <a id="2222" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2227" href="Ledger.Conway.Specification.Transaction.html#4682" class="Record">Tx</a> <a id="2230" class="Symbol">→</a> <a id="2232" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2234" href="Ledger.Conway.Specification.Chain.html#2191" class="Function">totalRefScriptsSize</a> <a id="2254" href="Ledger.Conway.Specification.Chain.html#2254" class="Bound">lst</a> <a id="2258" href="Ledger.Conway.Specification.Chain.html#2258" class="Bound">txs</a> <a id="2262" class="Symbol">=</a> <a id="2264" href="Data.Nat.ListAction.html#612" class="Function">sum</a> <a id="2268" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="2270" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="2274" class="Symbol">(</a><a id="2275" href="Ledger.Conway.Specification.Utxo.html#2520" class="Function">refScriptsSize</a> <a id="2290" href="Ledger.Conway.Specification.Utxo.html#1294" class="Function">utxo</a><a id="2294" class="Symbol">)</a> <a id="2296" href="Ledger.Conway.Specification.Chain.html#2258" class="Bound">txs</a>
  <a id="2302" class="Keyword">where</a> <a id="2308" class="Keyword">open</a> <a id="2313" href="Ledger.Conway.Specification.Utxo.html#1230" class="Module">UTxOState</a> <a id="2323" class="Symbol">(</a><a id="2324" href="Ledger.Conway.Specification.Ledger.html#1038" class="Field">LState.utxoSt</a> <a id="2338" href="Ledger.Conway.Specification.Chain.html#2254" class="Bound">lst</a><a id="2341" class="Symbol">)</a>

<a id="2344" class="Keyword">private</a> <a id="2352" class="Keyword">variable</a>
  <a id="2363" href="Ledger.Conway.Specification.Chain.html#2363" class="Generalizable">ls&#39;</a> <a id="2367" class="Symbol">:</a> <a id="2369" href="Ledger.Conway.Specification.Ledger.html#979" class="Record">LState</a>


<a id="2378" class="Keyword">data</a> <a id="_⊢_⇀⦇_,CHAIN⦈_"></a><a id="2383" href="Ledger.Conway.Specification.Chain.html#2383" class="Datatype Operator">_⊢_⇀⦇_,CHAIN⦈_</a> <a id="2398" class="Symbol">:</a> <a id="2400" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="2402" class="Symbol">→</a> <a id="2404" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a> <a id="2415" class="Symbol">→</a> <a id="2417" href="Ledger.Conway.Specification.BlockBody.html#695" class="Record">Block</a> <a id="2423" class="Symbol">→</a> <a id="2425" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a> <a id="2436" class="Symbol">→</a> <a id="2438" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2443" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,CHAIN⦈_.CHAIN"></a><a id="2452" href="Ledger.Conway.Specification.Chain.html#2452" class="InductiveConstructor">CHAIN</a> <a id="2458" class="Symbol">:</a> <a id="2460" class="Symbol">∀</a> <a id="2462" class="Symbol">{</a><a id="2463" href="Ledger.Conway.Specification.Chain.html#2463" class="Bound">bcur&#39;</a><a id="2468" class="Symbol">}</a> <a id="2470" class="Symbol">{</a><a id="2471" href="Ledger.Conway.Specification.Chain.html#2471" class="Bound">b</a> <a id="2473" class="Symbol">:</a> <a id="2475" href="Ledger.Conway.Specification.BlockBody.html#695" class="Record">Block</a><a id="2480" class="Symbol">}</a> <a id="2482" class="Symbol">{</a><a id="2483" href="Ledger.Conway.Specification.Chain.html#2483" class="Bound">nes</a> <a id="2487" class="Symbol">:</a> <a id="2489" href="Ledger.Conway.Specification.Epoch.html#3597" class="Record">NewEpochState</a><a id="2502" class="Symbol">}</a> <a id="2504" class="Symbol">{</a><a id="2505" href="Ledger.Conway.Specification.Chain.html#2505" class="Bound">cs</a> <a id="2508" class="Symbol">:</a> <a id="2510" href="Ledger.Conway.Specification.Chain.html#923" class="Record">ChainState</a><a id="2520" class="Symbol">}</a>


    <a id="2528" class="Symbol">→</a> <a id="2530" class="Keyword">let</a> <a id="2534" class="Keyword">open</a> <a id="2539" href="Ledger.Conway.Specification.Chain.html#923" class="Module">ChainState</a> <a id="2550" href="Ledger.Conway.Specification.Chain.html#2505" class="Bound">cs</a><a id="2552" class="Symbol">;</a> <a id="2554" class="Keyword">open</a> <a id="2559" href="Ledger.Conway.Specification.BlockBody.html#695" class="Module">Block</a> <a id="2565" href="Ledger.Conway.Specification.Chain.html#2471" class="Bound">b</a><a id="2566" class="Symbol">;</a> <a id="2568" class="Keyword">open</a> <a id="2573" href="Ledger.Conway.Specification.BlockBody.html#621" class="Module">BHeader</a> <a id="2581" href="Ledger.Conway.Specification.BlockBody.html#726" class="Function">bheader</a>
          <a id="2599" class="Keyword">open</a> <a id="2604" href="Ledger.Conway.Specification.BlockBody.html#493" class="Module">BHBody</a> <a id="2611" href="Ledger.Conway.Specification.BlockBody.html#654" class="Function">bhbody</a><a id="2617" class="Symbol">;</a> <a id="2619" class="Keyword">open</a> <a id="2624" href="Ledger.Conway.Specification.Epoch.html#3597" class="Module">NewEpochState</a> <a id="2638" href="Ledger.Conway.Specification.Chain.html#2483" class="Bound">nes</a>
          <a id="2652" class="Keyword">open</a> <a id="2657" href="Ledger.Conway.Specification.Epoch.html#1846" class="Module">EpochState</a> <a id="2668" href="Ledger.Conway.Specification.Epoch.html#3718" class="Function">epochState</a><a id="2678" class="Symbol">;</a> <a id="2680" class="Keyword">open</a> <a id="2685" href="Ledger.Conway.Specification.Enact.html#448" class="Module">EnactState</a> <a id="2696" href="Ledger.Conway.Specification.Epoch.html#1987" class="Function">es</a> <a id="2699" class="Keyword">renaming</a> <a id="2708" class="Symbol">(</a><a id="2709" href="Ledger.Conway.Specification.Enact.html#658" class="Field">pparams</a> <a id="2717" class="Symbol">to</a> <a id="2720" class="Field">pp</a><a id="2722" class="Symbol">)</a>
          <a id="2734" class="Keyword">open</a> <a id="2739" href="Ledger.Conway.Specification.PParams.html#1689" class="Module">PParams</a> <a id="2747" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2749" href="Ledger.Conway.Specification.Chain.html#2720" class="Function">pp</a> <a id="2752" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="2754" class="Keyword">using</a> <a id="2760" class="Symbol">(</a><a id="2761" href="Ledger.Conway.Specification.PParams.html#2601" class="Field">maxRefScriptSizePerBlock</a><a id="2785" class="Symbol">)</a> <a id="2787" class="Keyword">in</a>


    <a id="2796" class="Keyword">let</a>  <a id="2801" href="Ledger.Conway.Specification.Chain.html#2801" class="Bound">cs&#39;</a>  <a id="2806" class="Symbol">=</a> <a id="2808" class="Keyword">record</a> <a id="2815" href="Ledger.Conway.Specification.Chain.html#2505" class="Bound">cs</a> <a id="2818" class="Symbol">{</a>  <a id="2821" href="Ledger.Conway.Specification.Chain.html#959" class="Field">newEpochState</a>
                             <a id="2864" class="Symbol">=</a> <a id="2866" class="Keyword">record</a> <a id="2873" href="Ledger.Conway.Specification.Chain.html#2483" class="Bound">nes</a> <a id="2877" class="Symbol">{</a>  <a id="2880" href="Ledger.Conway.Specification.Epoch.html#3689" class="Field">bcur</a> <a id="2885" class="Symbol">=</a> <a id="2887" href="Ledger.Conway.Specification.Chain.html#2463" class="Bound">bcur&#39;</a><a id="2892" class="Symbol">;</a>
                                             <a id="2939" href="Ledger.Conway.Specification.Epoch.html#3718" class="Field">epochState</a>
                                             <a id="2995" class="Symbol">=</a> <a id="2997" class="Keyword">record</a> <a id="3004" href="Ledger.Conway.Specification.Epoch.html#3718" class="Function">epochState</a> <a id="3015" class="Symbol">{</a><a id="3016" href="Ledger.Conway.Specification.Epoch.html#1963" class="Field">ls</a> <a id="3019" class="Symbol">=</a> <a id="3021" href="Ledger.Conway.Specification.Chain.html#2363" class="Generalizable">ls&#39;</a><a id="3024" class="Symbol">}</a> <a id="3026" class="Symbol">}</a> <a id="3028" class="Symbol">}</a>
    <a id="3034" class="Keyword">in</a>
    <a id="3041" href="Prelude.InferenceRules.html#56075" class="Function Operator">∙</a> <a id="3043" href="Ledger.Conway.Specification.Chain.html#2191" class="Function">totalRefScriptsSize</a> <a id="3063" href="Ledger.Conway.Specification.Epoch.html#1963" class="Function">ls</a> <a id="3066" href="Ledger.Conway.Specification.BlockBody.html#752" class="Function">ts</a> <a id="3069" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="3071" href="Ledger.Conway.Specification.PParams.html#2601" class="Function">maxRefScriptSizePerBlock</a>
    <a id="3100" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="3102" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3105" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">⊢</a> <a id="3107" href="Ledger.Conway.Specification.Chain.html#959" class="Field">newEpochState</a> <a id="3121" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">⇀⦇</a> <a id="3124" href="Ledger.Conway.Specification.BlockBody.html#560" class="Function">slot</a> <a id="3129" href="Ledger.Conway.Specification.RewardUpdate.html#1176" class="Datatype Operator">,TICK⦈</a> <a id="3136" href="Ledger.Conway.Specification.Chain.html#2483" class="Bound">nes</a>
    <a id="3144" href="Prelude.InferenceRules.html#56006" class="Function Operator">∙</a> <a id="3146" class="Symbol">(</a><a id="3147" href="Ledger.Conway.Specification.Epoch.html#1987" class="Function">es</a> <a id="3150" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3152" href="Ledger.Conway.Specification.Epoch.html#1914" class="Function">acnt</a><a id="3156" class="Symbol">)</a> <a id="3158" href="Ledger.Conway.Specification.BlockBody.html#1150" class="Datatype Operator">⊢</a> <a id="3160" class="Symbol">(</a><a id="3161" href="Ledger.Conway.Specification.Epoch.html#1963" class="Function">ls</a> <a id="3164" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3166" href="Ledger.Conway.Specification.Epoch.html#3689" class="Function">bcur</a><a id="3170" class="Symbol">)</a> <a id="3172" href="Ledger.Conway.Specification.BlockBody.html#1150" class="Datatype Operator">⇀⦇</a> <a id="3175" href="Ledger.Conway.Specification.Chain.html#2471" class="Bound">b</a> <a id="3177" href="Ledger.Conway.Specification.BlockBody.html#1150" class="Datatype Operator">,BBODY⦈</a> <a id="3185" class="Symbol">(</a><a id="3186" href="Ledger.Conway.Specification.Chain.html#2363" class="Generalizable">ls&#39;</a> <a id="3190" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3192" href="Ledger.Conway.Specification.Chain.html#2463" class="Bound">bcur&#39;</a><a id="3197" class="Symbol">)</a>
      <a id="3205" href="Prelude.InferenceRules.html#13694" class="Function Operator">────────────────────────────────</a>
      <a id="3244" class="Symbol">_</a> <a id="3246" href="Ledger.Conway.Specification.Chain.html#2383" class="Datatype Operator">⊢</a> <a id="3248" href="Ledger.Conway.Specification.Chain.html#2505" class="Bound">cs</a> <a id="3251" href="Ledger.Conway.Specification.Chain.html#2383" class="Datatype Operator">⇀⦇</a> <a id="3254" href="Ledger.Conway.Specification.Chain.html#2471" class="Bound">b</a> <a id="3256" href="Ledger.Conway.Specification.Chain.html#2383" class="Datatype Operator">,CHAIN⦈</a> <a id="3264" href="Ledger.Conway.Specification.Chain.html#2801" class="Bound">cs&#39;</a>

</pre></body></html>