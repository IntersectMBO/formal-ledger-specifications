<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.NewEpoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html" class="Module">Ledger.Conway.Foreign.HSLedger.NewEpoch</a> <a id="48" class="Keyword">where</a>

<a id="55" class="Keyword">open</a> <a id="60" class="Keyword">import</a> <a id="67" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="108" class="Keyword">open</a> <a id="113" class="Keyword">import</a> <a id="120" href="Ledger.Conway.Foreign.HSLedger.Epoch.html" class="Module">Ledger.Conway.Foreign.HSLedger.Epoch</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Ledger.Conway.Foreign.HSLedger.Rewards.html" class="Module">Ledger.Conway.Foreign.HSLedger.Rewards</a>

<a id="209" class="Keyword">open</a> <a id="214" class="Keyword">import</a> <a id="221" href="Ledger.Conway.Conformance.Equivalence.Convert.html" class="Module">Ledger.Conway.Conformance.Equivalence.Convert</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Ledger.Conway.Conformance.Epoch.html" class="Module">Ledger.Conway.Conformance.Epoch</a> <a id="311" href="Function.Base.html#4755" class="Function">it</a> <a id="314" href="Function.Base.html#4755" class="Function">it</a>
<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Ledger.Conway.Conformance.Epoch.Properties.html" class="Module">Ledger.Conway.Conformance.Epoch.Properties</a> <a id="372" href="Function.Base.html#4755" class="Function">it</a> <a id="375" href="Function.Base.html#4755" class="Function">it</a>

<a id="379" class="Keyword">import</a> <a id="386" href="Data.String.html" class="Module">Data.String</a> <a id="398" class="Symbol">as</a> <a id="401" class="Module">S</a>

<a id="404" class="Keyword">instance</a>
  <a id="Show-NEWEPOCH"></a><a id="415" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#415" class="Function">Show-NEWEPOCH</a> <a id="429" class="Symbol">:</a> <a id="431" class="Symbol">∀</a> <a id="433" class="Symbol">{</a><a id="434" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#434" class="Bound">eps</a> <a id="438" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#438" class="Bound">e</a> <a id="440" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#440" class="Bound">eps&#39;</a><a id="444" class="Symbol">}</a> <a id="446" class="Symbol">→</a> <a id="448" href="Class.Show.Core.html#125" class="Record">Show</a> <a id="453" class="Symbol">(_</a> <a id="456" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">EpochSpec.⊢</a> <a id="468" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#434" class="Bound">eps</a> <a id="472" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">⇀⦇</a> <a id="475" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#438" class="Bound">e</a> <a id="477" href="Ledger.Conway.Specification.Epoch.html#18089" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="488" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#440" class="Bound">eps&#39;</a><a id="492" class="Symbol">)</a>
  <a id="496" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#415" class="Function">Show-NEWEPOCH</a> <a id="510" class="Symbol">.</a><a id="511" href="Class.Show.Core.html#187" class="Field">show</a> <a id="516" class="Symbol">(</a><a id="517" href="Ledger.Conway.Specification.Epoch.html#18167" class="InductiveConstructor">EpochSpec.NEWEPOCH-New</a> <a id="540" class="Symbol">(_</a> <a id="543" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="545" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#545" class="Bound">e</a><a id="546" class="Symbol">))</a>        <a id="556" class="Symbol">=</a> <a id="558" class="String">&quot;NEWEPOCH-New &quot;</a> <a id="574" href="Data.String.Base.html#2425" class="Function Operator">S.++</a> <a id="579" href="Class.Show.Core.html#187" class="Field">show</a> <a id="584" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#545" class="Bound">e</a>
  <a id="588" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#415" class="Function">Show-NEWEPOCH</a> <a id="602" class="Symbol">.</a><a id="603" href="Class.Show.Core.html#187" class="Field">show</a> <a id="608" class="Symbol">(</a><a id="609" href="Ledger.Conway.Specification.Epoch.html#18587" class="InductiveConstructor">EpochSpec.NEWEPOCH-Not-New</a> <a id="636" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#636" class="Bound">x</a><a id="637" class="Symbol">)</a>          <a id="648" class="Symbol">=</a> <a id="650" class="String">&quot;NEWEPOCH-Not-New&quot;</a>
  <a id="671" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#415" class="Function">Show-NEWEPOCH</a> <a id="685" class="Symbol">.</a><a id="686" href="Class.Show.Core.html#187" class="Field">show</a> <a id="691" class="Symbol">(</a><a id="692" href="Ledger.Conway.Specification.Epoch.html#18834" class="InductiveConstructor">EpochSpec.NEWEPOCH-No-Reward-Update</a> <a id="728" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#728" class="Bound">x</a><a id="729" class="Symbol">)</a> <a id="731" class="Symbol">=</a> <a id="733" class="String">&quot;NEWEPOCH-No-Reward-Update&quot;</a>

<a id="762" class="Keyword">instance</a>
  <a id="HsTy-NewEpochState"></a><a id="773" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#773" class="Function">HsTy-NewEpochState</a> <a id="792" class="Symbol">=</a> <a id="794" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType</a> <a id="805" href="Ledger.Conway.Conformance.Epoch.html#1388" class="Record">NewEpochState</a> <a id="819" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">⊣</a> <a id="821" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="837" class="String">&quot;MkNewEpochState&quot;</a>
  <a id="Conv-NewEpochState"></a><a id="857" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#857" class="Function">Conv-NewEpochState</a> <a id="876" class="Symbol">=</a> <a id="878" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="890" href="Ledger.Conway.Conformance.Epoch.html#1388" class="Record">NewEpochState</a>

<a id="905" class="Comment">-- An implementation of NEWEPOCH that connects the conformance state</a>
<a id="974" class="Comment">-- with the specification rule.</a>

<a id="newepoch-step"></a><a id="1007" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1007" class="Function">newepoch-step</a>
  <a id="1023" class="Symbol">:</a> <a id="1025" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="1032" class="Symbol">(</a><a id="1033" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="1035" class="Symbol">→</a> <a id="1037" href="Ledger.Conway.Conformance.Epoch.html#1388" class="Record">NewEpochState</a> <a id="1051" class="Symbol">→</a> <a id="1053" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a> <a id="1059" class="Symbol">→</a> <a id="1061" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="1079" href="Data.Empty.html#914" class="Function">⊥</a> <a id="1081" class="Symbol">(</a><a id="1082" href="Ledger.Conway.Conformance.Epoch.html#1388" class="Record">NewEpochState</a> <a id="1096" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1098" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1104" class="Symbol">))</a>
<a id="1107" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1007" class="Function">newepoch-step</a> <a id="1121" class="Symbol">_</a> <a id="1123" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1123" class="Bound">neSt</a> <a id="1128" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1128" class="Bound">e</a> <a id="1130" class="Symbol">=</a>
  <a id="1134" class="Keyword">let</a> <a id="1138" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1138" class="Bound">r</a> <a id="1140" class="Symbol">=</a> <a id="1142" href="Ledger.Conway.Specification.Epoch.Properties.Computational.html#6169" class="Function">EpochSpec.Computational-NEWEPOCH</a> <a id="1175" class="Symbol">.</a><a id="1176" href="Interface.ComputationalRelation.html#2884" class="Field">computeProof</a> <a id="1189" class="Symbol">_</a> <a id="1191" class="Symbol">(</a><a id="1192" href="Ledger.Conway.Conformance.Equivalence.Convert.html#452" class="Function">conv</a> <a id="1197" class="Symbol">(</a><a id="1198" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="1203" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1123" class="Bound">neSt</a><a id="1207" class="Symbol">))</a> <a id="1210" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1128" class="Bound">e</a>
  <a id="1214" class="Keyword">in</a> <a id="1217" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1222" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1138" class="Bound">r</a> <a id="1224" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1227" class="Symbol">λ</a> <a id="1229" class="Keyword">where</a>
    <a id="1239" class="Symbol">(</a><a id="1240" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1248" class="Symbol">(</a><a id="1249" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1249" class="Bound">s</a> <a id="1251" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1253" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1253" class="Bound">p</a><a id="1254" class="Symbol">))</a> <a id="1257" class="Symbol">→</a> <a id="1259" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="1262" class="Symbol">(</a><a id="1263" href="Interface.ComputationalRelation.html#310" class="InductiveConstructor">success</a> <a id="1271" class="Symbol">(</a><a id="1272" href="Ledger.Conway.Conformance.Equivalence.Convert.html#452" class="Function">conv</a> <a id="1277" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1249" class="Bound">s</a> <a id="1279" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1281" href="Class.Show.Core.html#187" class="Field">show</a> <a id="1286" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1253" class="Bound">p</a><a id="1287" class="Symbol">))</a>

<a id="1291" class="Symbol">{-#</a> <a id="1295" class="Keyword">COMPILE</a> <a id="1303" class="Keyword">GHC</a> <a id="1307" href="Ledger.Conway.Foreign.HSLedger.NewEpoch.html#1007" class="Function">newepoch-step</a> <a id="1321" class="Pragma">as</a> <a id="1324" class="Pragma">newEpochStep</a> <a id="1337" class="Symbol">#-}</a>
</pre></body></html>