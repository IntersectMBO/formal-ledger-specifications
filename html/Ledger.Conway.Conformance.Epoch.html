<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Conformance.Epoch</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="58" class="Keyword">using</a> <a id="64" class="Symbol">(</a><a id="65" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="75" class="Symbol">;</a> <a id="77" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a><a id="98" class="Symbol">)</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Data.List.html" class="Module">Data.List</a> <a id="122" class="Keyword">using</a> <a id="128" class="Symbol">(</a><a id="129" href="Data.List.Base.html#10687" class="Function">filter</a><a id="135" class="Symbol">)</a>
<a id="137" class="Keyword">import</a> <a id="144" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="157" class="Symbol">as</a> <a id="160" class="Module">ℤ</a>

<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="Ledger.Conway.Abstract.html" class="Module">Ledger.Conway.Abstract</a>
<a id="259" class="Keyword">open</a> <a id="264" class="Keyword">import</a> <a id="271" href="Ledger.Conway.Transaction.html" class="Module">Ledger.Conway.Transaction</a>

<a id="298" class="Keyword">module</a> <a id="305" href="Ledger.Conway.Conformance.Epoch.html" class="Module">Ledger.Conway.Conformance.Epoch</a>
  <a id="339" class="Symbol">(</a><a id="340" href="Ledger.Conway.Conformance.Epoch.html#340" class="Bound">txs</a> <a id="344" class="Symbol">:</a> <a id="346" class="Symbol">_)</a> <a id="349" class="Symbol">(</a><a id="350" class="Keyword">open</a> <a id="355" href="Ledger.Conway.Transaction.html#910" class="Module">TransactionStructure</a> <a id="376" href="Ledger.Conway.Conformance.Epoch.html#340" class="Bound">txs</a><a id="379" class="Symbol">)</a>
  <a id="383" class="Symbol">(</a><a id="384" href="Ledger.Conway.Conformance.Epoch.html#384" class="Bound">abs</a> <a id="388" class="Symbol">:</a> <a id="390" href="Ledger.Conway.Abstract.html#599" class="Record">AbstractFunctions</a> <a id="408" href="Ledger.Conway.Conformance.Epoch.html#340" class="Bound">txs</a><a id="411" class="Symbol">)</a> <a id="413" class="Symbol">(</a><a id="414" class="Keyword">open</a> <a id="419" href="Ledger.Conway.Abstract.html#599" class="Module">AbstractFunctions</a> <a id="437" href="Ledger.Conway.Conformance.Epoch.html#384" class="Bound">abs</a><a id="440" class="Symbol">)</a>
  <a id="444" class="Keyword">where</a>

<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Ledger.Conway.Gov.html" class="Module">Ledger.Conway.Gov</a> <a id="481" href="Ledger.Conway.Conformance.Epoch.html#340" class="Bound">txs</a>
<a id="485" class="Keyword">open</a> <a id="490" class="Keyword">import</a> <a id="497" href="Ledger.Conway.Enact.html" class="Module">Ledger.Conway.Enact</a> <a id="517" href="Ledger.Conway.Transaction.html#1880" class="Function">govStructure</a>
<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="Ledger.Conway.Conformance.Ledger.html" class="Module">Ledger.Conway.Conformance.Ledger</a> <a id="575" href="Ledger.Conway.Conformance.Epoch.html#340" class="Bound">txs</a> <a id="579" href="Ledger.Conway.Conformance.Epoch.html#384" class="Bound">abs</a>
<a id="583" class="Keyword">open</a> <a id="588" class="Keyword">import</a> <a id="595" href="Ledger.Conway.Ratify.html" class="Module">Ledger.Conway.Ratify</a> <a id="616" href="Ledger.Conway.Conformance.Epoch.html#340" class="Bound">txs</a>
<a id="620" class="Keyword">open</a> <a id="625" class="Keyword">import</a> <a id="632" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="663" href="Ledger.Conway.Conformance.Epoch.html#340" class="Bound">txs</a> <a id="667" href="Ledger.Conway.Conformance.Epoch.html#384" class="Bound">abs</a>
<a id="671" class="Keyword">open</a> <a id="676" class="Keyword">import</a> <a id="683" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="715" href="Ledger.Conway.Transaction.html#1880" class="Function">govStructure</a>

<a id="729" class="Keyword">record</a> <a id="RewardUpdate"></a><a id="736" href="Ledger.Conway.Conformance.Epoch.html#736" class="Record">RewardUpdate</a> <a id="749" class="Symbol">:</a> <a id="751" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="755" class="Keyword">where</a>
  <a id="763" class="Keyword">constructor</a> <a id="⟦_,_,_,_⟧ʳᵘ"></a><a id="775" href="Ledger.Conway.Conformance.Epoch.html#775" class="InductiveConstructor Operator">⟦_,_,_,_⟧ʳᵘ</a>
  <a id="789" class="Keyword">field</a>
    <a id="RewardUpdate.Δt"></a><a id="799" href="Ledger.Conway.Conformance.Epoch.html#799" class="Field">Δt</a> <a id="RewardUpdate.Δr"></a><a id="802" href="Ledger.Conway.Conformance.Epoch.html#802" class="Field">Δr</a> <a id="RewardUpdate.Δf"></a><a id="805" href="Ledger.Conway.Conformance.Epoch.html#805" class="Field">Δf</a> <a id="808" class="Symbol">:</a> <a id="810" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
    <a id="RewardUpdate.rs"></a><a id="816" href="Ledger.Conway.Conformance.Epoch.html#816" class="Field">rs</a> <a id="819" class="Symbol">:</a> <a id="821" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="832" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="834" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

<a id="840" class="Keyword">record</a> <a id="Snapshot"></a><a id="847" href="Ledger.Conway.Conformance.Epoch.html#847" class="Record">Snapshot</a> <a id="856" class="Symbol">:</a> <a id="858" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="862" class="Keyword">where</a>
  <a id="870" class="Keyword">field</a>
    <a id="Snapshot.stake"></a><a id="880" href="Ledger.Conway.Conformance.Epoch.html#880" class="Field">stake</a>        <a id="893" class="Symbol">:</a> <a id="895" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="906" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="908" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="Snapshot.delegations"></a><a id="917" href="Ledger.Conway.Conformance.Epoch.html#917" class="Field">delegations</a>  <a id="930" class="Symbol">:</a> <a id="932" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="943" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="945" href="Ledger.Conway.Crypto.html#1317" class="Function">KeyHash</a>
    <a id="957" class="Comment">-- poolParameters : KeyHash ⇀ PoolParam</a>

<a id="998" class="Keyword">record</a> <a id="Snapshots"></a><a id="1005" href="Ledger.Conway.Conformance.Epoch.html#1005" class="Record">Snapshots</a> <a id="1015" class="Symbol">:</a> <a id="1017" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1021" class="Keyword">where</a>
  <a id="1029" class="Keyword">field</a>
    <a id="Snapshots.mark"></a><a id="1039" href="Ledger.Conway.Conformance.Epoch.html#1039" class="Field">mark</a> <a id="Snapshots.set"></a><a id="1044" href="Ledger.Conway.Conformance.Epoch.html#1044" class="Field">set</a> <a id="Snapshots.go"></a><a id="1048" href="Ledger.Conway.Conformance.Epoch.html#1048" class="Field">go</a>  <a id="1052" class="Symbol">:</a> <a id="1054" href="Ledger.Conway.Conformance.Epoch.html#847" class="Record">Snapshot</a>
    <a id="Snapshots.feeSS"></a><a id="1067" href="Ledger.Conway.Conformance.Epoch.html#1067" class="Field">feeSS</a>        <a id="1080" class="Symbol">:</a> <a id="1082" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

<a id="1088" class="Keyword">record</a> <a id="EpochState"></a><a id="1095" href="Ledger.Conway.Conformance.Epoch.html#1095" class="Record">EpochState</a> <a id="1106" class="Symbol">:</a> <a id="1108" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1113" class="Keyword">where</a>
  <a id="1121" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1133" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>
  <a id="1149" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1159" href="Ledger.Conway.Conformance.Epoch.html#1159" class="Field">acnt</a>       <a id="1170" class="Symbol">:</a> <a id="1172" href="Ledger.Conway.PParams.html#709" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1181" href="Ledger.Conway.Conformance.Epoch.html#1181" class="Field">ss</a>         <a id="1192" class="Symbol">:</a> <a id="1194" href="Ledger.Conway.Conformance.Epoch.html#1005" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1208" href="Ledger.Conway.Conformance.Epoch.html#1208" class="Field">ls</a>         <a id="1219" class="Symbol">:</a> <a id="1221" href="Ledger.Conway.Conformance.Ledger.html#723" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1232" href="Ledger.Conway.Conformance.Epoch.html#1232" class="Field">es</a>         <a id="1243" class="Symbol">:</a> <a id="1245" href="Ledger.Conway.Enact.html#418" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="1260" href="Ledger.Conway.Conformance.Epoch.html#1260" class="Field">fut</a>        <a id="1271" class="Symbol">:</a> <a id="1273" href="Ledger.Conway.Ratify.html#3314" class="Record">RatifyState</a>

<a id="1286" class="Keyword">record</a> <a id="NewEpochState"></a><a id="1293" href="Ledger.Conway.Conformance.Epoch.html#1293" class="Record">NewEpochState</a> <a id="1307" class="Symbol">:</a> <a id="1309" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1314" class="Keyword">where</a>
  <a id="1322" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="1332" href="Ledger.Conway.Conformance.Epoch.html#1332" class="Field">lastEpoch</a>   <a id="1344" class="Symbol">:</a> <a id="1346" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a>
    <a id="NewEpochState.epochState"></a><a id="1356" href="Ledger.Conway.Conformance.Epoch.html#1356" class="Field">epochState</a>  <a id="1368" class="Symbol">:</a> <a id="1370" href="Ledger.Conway.Conformance.Epoch.html#1095" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="1385" href="Ledger.Conway.Conformance.Epoch.html#1385" class="Field">ru</a>          <a id="1397" class="Symbol">:</a> <a id="1399" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1405" href="Ledger.Conway.Conformance.Epoch.html#736" class="Record">RewardUpdate</a>

<a id="1419" class="Keyword">instance</a>
  <a id="1430" class="Keyword">unquoteDecl</a> <a id="HasCast-RewardUpdate"></a><a id="1442" href="Ledger.Conway.Conformance.Epoch.html#1442" class="Function">HasCast-RewardUpdate</a> <a id="HasCast-Snapshot"></a><a id="1463" href="Ledger.Conway.Conformance.Epoch.html#1463" class="Function">HasCast-Snapshot</a> <a id="HasCast-Snapshots"></a><a id="1480" href="Ledger.Conway.Conformance.Epoch.html#1480" class="Function">HasCast-Snapshots</a> <a id="HasCast-EpochState"></a><a id="1498" href="Ledger.Conway.Conformance.Epoch.html#1498" class="Function">HasCast-EpochState</a> <a id="HasCast-NewEpochState"></a><a id="1517" href="Ledger.Conway.Conformance.Epoch.html#1517" class="Function">HasCast-NewEpochState</a> <a id="1539" class="Symbol">=</a> <a id="1541" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="1560" class="Symbol">(</a>   <a id="1564" class="Symbol">(</a><a id="1565" class="Keyword">quote</a> <a id="1571" href="Ledger.Conway.Conformance.Epoch.html#736" class="Record">RewardUpdate</a>   <a id="1586" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1588" href="Ledger.Conway.Conformance.Epoch.html#1442" class="Function">HasCast-RewardUpdate</a><a id="1608" class="Symbol">)</a>
    <a id="1614" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1618" class="Symbol">(</a><a id="1619" class="Keyword">quote</a> <a id="1625" href="Ledger.Conway.Conformance.Epoch.html#847" class="Record">Snapshot</a>       <a id="1640" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1642" href="Ledger.Conway.Conformance.Epoch.html#1463" class="Function">HasCast-Snapshot</a><a id="1658" class="Symbol">)</a>
    <a id="1664" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1668" class="Symbol">(</a><a id="1669" class="Keyword">quote</a> <a id="1675" href="Ledger.Conway.Conformance.Epoch.html#1005" class="Record">Snapshots</a>      <a id="1690" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1692" href="Ledger.Conway.Conformance.Epoch.html#1480" class="Function">HasCast-Snapshots</a><a id="1709" class="Symbol">)</a>
    <a id="1715" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1719" class="Symbol">(</a><a id="1720" class="Keyword">quote</a> <a id="1726" href="Ledger.Conway.Conformance.Epoch.html#1095" class="Record">EpochState</a>     <a id="1741" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1743" href="Ledger.Conway.Conformance.Epoch.html#1498" class="Function">HasCast-EpochState</a><a id="1761" class="Symbol">)</a>
    <a id="1767" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1769" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="1771" class="Symbol">(</a><a id="1772" class="Keyword">quote</a> <a id="1778" href="Ledger.Conway.Conformance.Epoch.html#1293" class="Record">NewEpochState</a>  <a id="1793" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1795" href="Ledger.Conway.Conformance.Epoch.html#1517" class="Function">HasCast-NewEpochState</a><a id="1816" class="Symbol">)</a><a id="1817" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="1818" class="Symbol">)</a>

<a id="1821" class="Keyword">instance</a> <a id="1830" href="Ledger.Conway.Conformance.Epoch.html#1830" class="Function">_</a> <a id="1832" class="Symbol">=</a> <a id="1834" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="1844" class="Symbol">;</a> <a id="1846" href="Ledger.Conway.Conformance.Epoch.html#1846" class="Function">_</a> <a id="1848" class="Symbol">=</a> <a id="1850" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>

<a id="toRwdAddr"></a><a id="1873" href="Ledger.Conway.Conformance.Epoch.html#1873" class="Function">toRwdAddr</a> <a id="1883" class="Symbol">:</a> <a id="1885" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="1896" class="Symbol">→</a> <a id="1898" href="Ledger.Conway.Address.html#1344" class="Record">RwdAddr</a>
<a id="1906" href="Ledger.Conway.Conformance.Epoch.html#1873" class="Function">toRwdAddr</a> <a id="1916" href="Ledger.Conway.Conformance.Epoch.html#1916" class="Bound">x</a> <a id="1918" class="Symbol">=</a> <a id="1920" class="Keyword">record</a> <a id="1927" class="Symbol">{</a> <a id="1929" href="Ledger.Conway.Address.html#1373" class="Field">net</a> <a id="1933" class="Symbol">=</a> <a id="1935" href="Ledger.Conway.Types.Epoch.html#2317" class="Function">NetworkId</a> <a id="1945" class="Symbol">;</a> <a id="1947" href="Ledger.Conway.Address.html#1398" class="Field">stake</a> <a id="1953" class="Symbol">=</a> <a id="1955" href="Ledger.Conway.Conformance.Epoch.html#1916" class="Bound">x</a> <a id="1957" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="1960" href="Ledger.Conway.Conformance.Epoch.html#1960" class="Function">getStakeCred</a> <a id="1973" class="Symbol">:</a> <a id="1975" href="Ledger.Conway.Transaction.html#2405" class="Function">TxOut</a> <a id="1981" class="Symbol">→</a> <a id="1983" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1989" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a>
<a id="2000" href="Ledger.Conway.Conformance.Epoch.html#1960" class="Function">getStakeCred</a> <a id="2013" class="Symbol">(</a><a id="2014" href="Ledger.Conway.Conformance.Epoch.html#2014" class="Bound">a</a> <a id="2016" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2018" class="Symbol">_</a> <a id="2020" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2022" class="Symbol">_</a> <a id="2024" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2026" class="Symbol">_)</a> <a id="2029" class="Symbol">=</a> <a id="2031" href="Ledger.Conway.Address.html#2516" class="Function">stakeCred</a> <a id="2041" href="Ledger.Conway.Conformance.Epoch.html#2014" class="Bound">a</a>

<a id="2044" class="Keyword">open</a> <a id="2049" href="Ledger.Conway.Address.html#1344" class="Module">RwdAddr</a> <a id="2057" class="Keyword">using</a> <a id="2063" class="Symbol">(</a><a id="2064" href="Ledger.Conway.Address.html#1398" class="Field">stake</a><a id="2069" class="Symbol">)</a>
<a id="2071" class="Keyword">open</a> <a id="2076" href="Ledger.Conway.GovernanceActions.html#2760" class="Module">GovActionState</a> <a id="2091" class="Keyword">using</a> <a id="2097" class="Symbol">(</a><a id="2098" href="Ledger.Conway.GovernanceActions.html#2831" class="Field">returnAddr</a><a id="2108" class="Symbol">)</a>

<a id="applyRUpd"></a><a id="2111" href="Ledger.Conway.Conformance.Epoch.html#2111" class="Function">applyRUpd</a> <a id="2121" class="Symbol">:</a> <a id="2123" href="Ledger.Conway.Conformance.Epoch.html#736" class="Record">RewardUpdate</a> <a id="2136" class="Symbol">→</a> <a id="2138" href="Ledger.Conway.Conformance.Epoch.html#1095" class="Record">EpochState</a> <a id="2149" class="Symbol">→</a> <a id="2151" href="Ledger.Conway.Conformance.Epoch.html#1095" class="Record">EpochState</a>
<a id="2162" href="Ledger.Conway.Conformance.Epoch.html#2111" class="Function">applyRUpd</a> <a id="2172" href="Ledger.Conway.Conformance.Epoch.html#775" class="InductiveConstructor Operator">⟦</a> <a id="2174" href="Ledger.Conway.Conformance.Epoch.html#2174" class="Bound">Δt</a> <a id="2177" href="Ledger.Conway.Conformance.Epoch.html#775" class="InductiveConstructor Operator">,</a> <a id="2179" href="Ledger.Conway.Conformance.Epoch.html#2179" class="Bound">Δr</a> <a id="2182" href="Ledger.Conway.Conformance.Epoch.html#775" class="InductiveConstructor Operator">,</a> <a id="2184" href="Ledger.Conway.Conformance.Epoch.html#2184" class="Bound">Δf</a> <a id="2187" href="Ledger.Conway.Conformance.Epoch.html#775" class="InductiveConstructor Operator">,</a> <a id="2189" href="Ledger.Conway.Conformance.Epoch.html#2189" class="Bound">rs</a> <a id="2192" href="Ledger.Conway.Conformance.Epoch.html#775" class="InductiveConstructor Operator">⟧ʳᵘ</a>
  <a id="2198" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">⟦</a> <a id="2200" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">⟦</a> <a id="2202" href="Ledger.Conway.Conformance.Epoch.html#2202" class="Bound">treasury</a> <a id="2211" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">,</a> <a id="2213" href="Ledger.Conway.Conformance.Epoch.html#2213" class="Bound">reserves</a> <a id="2222" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">⟧ᵃ</a>
  <a id="2227" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">,</a> <a id="2229" href="Ledger.Conway.Conformance.Epoch.html#2229" class="Bound">ss</a>
  <a id="2234" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">,</a> <a id="2236" href="Ledger.Conway.Conformance.Ledger.html#757" class="InductiveConstructor Operator">⟦</a> <a id="2238" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">⟦</a> <a id="2240" href="Ledger.Conway.Conformance.Epoch.html#2240" class="Bound">utxo</a> <a id="2245" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="2247" href="Ledger.Conway.Conformance.Epoch.html#2247" class="Bound">fees</a> <a id="2252" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="2254" href="Ledger.Conway.Conformance.Epoch.html#2254" class="Bound">deposits</a> <a id="2263" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="2265" href="Ledger.Conway.Conformance.Epoch.html#2265" class="Bound">donations</a> <a id="2275" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">⟧ᵘ</a>
    <a id="2282" href="Ledger.Conway.Conformance.Ledger.html#757" class="InductiveConstructor Operator">,</a> <a id="2284" href="Ledger.Conway.Conformance.Epoch.html#2284" class="Bound">govSt</a>
    <a id="2294" href="Ledger.Conway.Conformance.Ledger.html#757" class="InductiveConstructor Operator">,</a> <a id="2296" href="Ledger.Conway.Conformance.Certs.html#999" class="InductiveConstructor Operator">⟦</a> <a id="2298" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">⟦</a> <a id="2300" href="Ledger.Conway.Conformance.Epoch.html#2300" class="Bound">voteDelegs</a> <a id="2311" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2313" href="Ledger.Conway.Conformance.Epoch.html#2313" class="Bound">stakeDelegs</a> <a id="2325" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2327" href="Ledger.Conway.Conformance.Epoch.html#2327" class="Bound">rewards</a> <a id="2335" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2337" href="Ledger.Conway.Conformance.Epoch.html#2337" class="Bound">dDeposits</a> <a id="2347" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">⟧ᵈ</a> <a id="2350" href="Ledger.Conway.Conformance.Certs.html#999" class="InductiveConstructor Operator">,</a> <a id="2352" href="Ledger.Conway.Conformance.Epoch.html#2352" class="Bound">pState</a> <a id="2359" href="Ledger.Conway.Conformance.Certs.html#999" class="InductiveConstructor Operator">,</a> <a id="2361" href="Ledger.Conway.Conformance.Epoch.html#2361" class="Bound">gState</a> <a id="2368" href="Ledger.Conway.Conformance.Certs.html#999" class="InductiveConstructor Operator">⟧ᶜˢ</a> <a id="2372" href="Ledger.Conway.Conformance.Ledger.html#757" class="InductiveConstructor Operator">⟧ˡ</a>
  <a id="2377" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">,</a> <a id="2379" href="Ledger.Conway.Conformance.Epoch.html#2379" class="Bound">es</a>
  <a id="2384" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">,</a> <a id="2386" href="Ledger.Conway.Conformance.Epoch.html#2386" class="Bound">fut</a>
  <a id="2392" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">⟧ᵉ&#39;</a> <a id="2396" class="Symbol">=</a>
  <a id="2400" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">⟦</a> <a id="2402" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">⟦</a> <a id="2404" href="Prelude.html#3167" class="Function">posPart</a> <a id="2412" class="Symbol">(</a><a id="2413" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">ℤ.+</a> <a id="2417" href="Ledger.Conway.Conformance.Epoch.html#2202" class="Bound">treasury</a> <a id="2426" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="2430" href="Ledger.Conway.Conformance.Epoch.html#2174" class="Bound">Δt</a> <a id="2433" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="2437" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">ℤ.+</a> <a id="2441" href="Ledger.Conway.Conformance.Epoch.html#2769" class="Function">unregRU&#39;</a><a id="2449" class="Symbol">)</a>
    <a id="2455" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">,</a> <a id="2457" href="Prelude.html#3167" class="Function">posPart</a> <a id="2465" class="Symbol">(</a><a id="2466" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">ℤ.+</a> <a id="2470" href="Ledger.Conway.Conformance.Epoch.html#2213" class="Bound">reserves</a> <a id="2479" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="2483" href="Ledger.Conway.Conformance.Epoch.html#2179" class="Bound">Δr</a><a id="2485" class="Symbol">)</a> <a id="2487" href="Ledger.Conway.PParams.html#743" class="InductiveConstructor Operator">⟧ᵃ</a>
  <a id="2492" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">,</a> <a id="2494" href="Ledger.Conway.Conformance.Epoch.html#2229" class="Bound">ss</a>
  <a id="2499" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">,</a> <a id="2501" href="Ledger.Conway.Conformance.Ledger.html#757" class="InductiveConstructor Operator">⟦</a> <a id="2503" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">⟦</a> <a id="2505" href="Ledger.Conway.Conformance.Epoch.html#2240" class="Bound">utxo</a> <a id="2510" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="2512" href="Prelude.html#3167" class="Function">posPart</a> <a id="2520" class="Symbol">(</a><a id="2521" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">ℤ.+</a> <a id="2525" href="Ledger.Conway.Conformance.Epoch.html#2247" class="Bound">fees</a> <a id="2530" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="2534" href="Ledger.Conway.Conformance.Epoch.html#2184" class="Bound">Δf</a><a id="2536" class="Symbol">)</a> <a id="2538" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="2540" href="Ledger.Conway.Conformance.Epoch.html#2254" class="Bound">deposits</a> <a id="2549" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">,</a> <a id="2551" href="Ledger.Conway.Conformance.Epoch.html#2265" class="Bound">donations</a> <a id="2561" href="Ledger.Conway.Utxo.html#2786" class="InductiveConstructor Operator">⟧ᵘ</a>
    <a id="2568" href="Ledger.Conway.Conformance.Ledger.html#757" class="InductiveConstructor Operator">,</a> <a id="2570" href="Ledger.Conway.Conformance.Epoch.html#2284" class="Bound">govSt</a>
    <a id="2580" href="Ledger.Conway.Conformance.Ledger.html#757" class="InductiveConstructor Operator">,</a> <a id="2582" href="Ledger.Conway.Conformance.Certs.html#999" class="InductiveConstructor Operator">⟦</a> <a id="2584" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">⟦</a> <a id="2586" href="Ledger.Conway.Conformance.Epoch.html#2300" class="Bound">voteDelegs</a> <a id="2597" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2599" href="Ledger.Conway.Conformance.Epoch.html#2313" class="Bound">stakeDelegs</a> <a id="2611" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2613" href="Ledger.Conway.Conformance.Epoch.html#2327" class="Bound">rewards</a> <a id="2621" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="2624" href="Ledger.Conway.Conformance.Epoch.html#2701" class="Function">regRU</a> <a id="2630" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2632" href="Ledger.Conway.Conformance.Epoch.html#2337" class="Bound">dDeposits</a> <a id="2642" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">⟧ᵈ</a> <a id="2645" href="Ledger.Conway.Conformance.Certs.html#999" class="InductiveConstructor Operator">,</a> <a id="2647" href="Ledger.Conway.Conformance.Epoch.html#2352" class="Bound">pState</a> <a id="2654" href="Ledger.Conway.Conformance.Certs.html#999" class="InductiveConstructor Operator">,</a> <a id="2656" href="Ledger.Conway.Conformance.Epoch.html#2361" class="Bound">gState</a> <a id="2663" href="Ledger.Conway.Conformance.Certs.html#999" class="InductiveConstructor Operator">⟧ᶜˢ</a> <a id="2667" href="Ledger.Conway.Conformance.Ledger.html#757" class="InductiveConstructor Operator">⟧ˡ</a>
  <a id="2672" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">,</a> <a id="2674" href="Ledger.Conway.Conformance.Epoch.html#2379" class="Bound">es</a>
  <a id="2679" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">,</a> <a id="2681" href="Ledger.Conway.Conformance.Epoch.html#2386" class="Bound">fut</a> <a id="2685" href="Ledger.Conway.Conformance.Epoch.html#1133" class="InductiveConstructor Operator">⟧ᵉ&#39;</a>
  <a id="2691" class="Keyword">where</a>
    <a id="2701" href="Ledger.Conway.Conformance.Epoch.html#2701" class="Function">regRU</a>     <a id="2711" class="Symbol">=</a> <a id="2713" href="Ledger.Conway.Conformance.Epoch.html#2189" class="Bound">rs</a> <a id="2716" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2718" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2722" href="Ledger.Conway.Conformance.Epoch.html#2327" class="Bound">rewards</a>
    <a id="2734" href="Ledger.Conway.Conformance.Epoch.html#2734" class="Function">unregRU</a>   <a id="2744" class="Symbol">=</a> <a id="2746" href="Ledger.Conway.Conformance.Epoch.html#2189" class="Bound">rs</a> <a id="2749" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="2751" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2755" href="Ledger.Conway.Conformance.Epoch.html#2327" class="Bound">rewards</a> <a id="2763" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a>
    <a id="2769" href="Ledger.Conway.Conformance.Epoch.html#2769" class="Function">unregRU&#39;</a>  <a id="2779" class="Symbol">=</a> <a id="2781" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="2784" href="Ledger.Conway.Conformance.Epoch.html#2784" class="Bound">x</a> <a id="2786" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="2788" href="Ledger.Conway.Conformance.Epoch.html#2734" class="Function">unregRU</a> <a id="2796" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="2798" href="Ledger.Conway.Conformance.Epoch.html#2784" class="Bound">x</a>

<a id="stakeDistr"></a><a id="2801" href="Ledger.Conway.Conformance.Epoch.html#2801" class="Function">stakeDistr</a> <a id="2812" class="Symbol">:</a> <a id="2814" href="Ledger.Conway.Transaction.html#2473" class="Function">UTxO</a> <a id="2819" class="Symbol">→</a> <a id="2821" href="Ledger.Conway.Conformance.Certs.html#589" class="Record">DState</a> <a id="2828" class="Symbol">→</a> <a id="2830" href="Ledger.Conway.Certs.html#3809" class="Record">PState</a> <a id="2837" class="Symbol">→</a> <a id="2839" href="Ledger.Conway.Conformance.Epoch.html#847" class="Record">Snapshot</a>
<a id="2848" href="Ledger.Conway.Conformance.Epoch.html#2801" class="Function">stakeDistr</a> <a id="2859" href="Ledger.Conway.Conformance.Epoch.html#2859" class="Bound">utxo</a> <a id="2864" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">⟦</a> <a id="2866" class="Symbol">_</a> <a id="2868" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2870" href="Ledger.Conway.Conformance.Epoch.html#2870" class="Bound">stakeDelegs</a> <a id="2882" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2884" href="Ledger.Conway.Conformance.Epoch.html#2884" class="Bound">rewards</a> <a id="2892" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">,</a> <a id="2894" class="Symbol">_</a> <a id="2896" href="Ledger.Conway.Conformance.Certs.html#623" class="InductiveConstructor Operator">⟧ᵈ</a> <a id="2899" href="Ledger.Conway.Conformance.Epoch.html#2899" class="Bound">pState</a> <a id="2906" class="Symbol">=</a> <a id="2908" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="2910" href="Axiom.Set.Map.Dec.html#1932" class="Function">aggregate₊</a> <a id="2921" class="Symbol">(</a><a id="2922" href="Ledger.Conway.Conformance.Epoch.html#3059" class="Function">stakeRelation</a> <a id="2936" href="abstract-set-theory.FiniteSetTheory.html#2767" class="Function Operator">ᶠˢ</a><a id="2938" class="Symbol">)</a> <a id="2940" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2942" href="Ledger.Conway.Conformance.Epoch.html#2870" class="Bound">stakeDelegs</a> <a id="2954" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>
  <a id="2958" class="Keyword">where</a>
    <a id="2968" href="Ledger.Conway.Conformance.Epoch.html#2968" class="Function">m</a> <a id="2970" class="Symbol">=</a> <a id="2972" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2977" class="Symbol">(λ</a> <a id="2980" href="Ledger.Conway.Conformance.Epoch.html#2980" class="Bound">a</a> <a id="2982" class="Symbol">→</a> <a id="2984" class="Symbol">(</a><a id="2985" href="Ledger.Conway.Conformance.Epoch.html#2980" class="Bound">a</a> <a id="2987" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2989" href="Ledger.Conway.Utxo.html#3685" class="Function">cbalance</a> <a id="2998" class="Symbol">(</a><a id="2999" href="Ledger.Conway.Conformance.Epoch.html#2859" class="Bound">utxo</a> <a id="3004" href="abstract-set-theory.FiniteSetTheory.html#3088" class="Function Operator">∣^&#39;</a> <a id="3008" class="Symbol">λ</a> <a id="3010" href="Ledger.Conway.Conformance.Epoch.html#3010" class="Bound">i</a> <a id="3012" class="Symbol">→</a> <a id="3014" href="Ledger.Conway.Conformance.Epoch.html#1960" class="Function">getStakeCred</a> <a id="3027" href="Ledger.Conway.Conformance.Epoch.html#3010" class="Bound">i</a> <a id="3029" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3031" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3036" href="Ledger.Conway.Conformance.Epoch.html#2980" class="Bound">a</a><a id="3037" class="Symbol">)))</a> <a id="3041" class="Symbol">(</a><a id="3042" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3046" href="Ledger.Conway.Conformance.Epoch.html#2884" class="Bound">rewards</a><a id="3053" class="Symbol">)</a>
    <a id="3059" href="Ledger.Conway.Conformance.Epoch.html#3059" class="Function">stakeRelation</a> <a id="3073" class="Symbol">=</a> <a id="3075" href="Ledger.Conway.Conformance.Epoch.html#2968" class="Function">m</a> <a id="3077" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="3079" href="Ledger.Prelude.html#2543" class="Function Operator">∣</a> <a id="3081" href="Ledger.Conway.Conformance.Epoch.html#2884" class="Bound">rewards</a> <a id="3089" href="Ledger.Prelude.html#2543" class="Function Operator">∣</a>

<a id="gaDepositStake"></a><a id="3092" href="Ledger.Conway.Conformance.Epoch.html#3092" class="Function">gaDepositStake</a> <a id="3107" class="Symbol">:</a> <a id="3109" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a> <a id="3118" class="Symbol">→</a> <a id="3120" href="Ledger.Conway.Certs.html#601" class="Function">Deposits</a> <a id="3129" class="Symbol">→</a> <a id="3131" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="3142" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3144" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="3149" href="Ledger.Conway.Conformance.Epoch.html#3092" class="Function">gaDepositStake</a> <a id="3164" href="Ledger.Conway.Conformance.Epoch.html#3164" class="Bound">govSt</a> <a id="3170" href="Ledger.Conway.Conformance.Epoch.html#3170" class="Bound">ds</a> <a id="3173" class="Symbol">=</a> <a id="3175" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a>
  <a id="3189" class="Symbol">(</a><a id="3190" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3195" class="Symbol">(λ</a> <a id="3198" class="Symbol">(</a><a id="3199" href="Ledger.Conway.Conformance.Epoch.html#3199" class="Bound">gaid</a> <a id="3204" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3206" href="Ledger.Conway.Conformance.Epoch.html#3206" class="Bound">addr</a><a id="3210" class="Symbol">)</a> <a id="3212" class="Symbol">→</a> <a id="3214" class="Symbol">(</a><a id="3215" href="Ledger.Conway.Conformance.Epoch.html#3199" class="Bound">gaid</a> <a id="3220" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3222" href="Ledger.Conway.Conformance.Epoch.html#3206" class="Bound">addr</a><a id="3226" class="Symbol">)</a> <a id="3228" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3230" href="Ledger.Conway.Address.html#1398" class="Field">stake</a> <a id="3236" href="Ledger.Conway.Conformance.Epoch.html#3206" class="Bound">addr</a><a id="3240" class="Symbol">)</a> <a id="3242" href="Ledger.Conway.Conformance.Epoch.html#3340" class="Function">govSt&#39;</a><a id="3248" class="Symbol">)</a>
  <a id="3252" class="Symbol">(</a><a id="3253" href="Axiom.Set.Map.html#10460" class="Function">mapFromPartialFun</a> <a id="3271" class="Symbol">(λ</a> <a id="3274" class="Symbol">(</a><a id="3275" href="Ledger.Conway.Conformance.Epoch.html#3275" class="Bound">gaid</a> <a id="3280" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3282" class="Symbol">_)</a> <a id="3285" class="Symbol">→</a> <a id="3287" href="Axiom.Set.Map.html#13670" class="Function">lookupᵐ?</a> <a id="3296" href="Ledger.Conway.Conformance.Epoch.html#3170" class="Bound">ds</a> <a id="3299" class="Symbol">(</a><a id="3300" href="Ledger.Conway.Certs.html#549" class="InductiveConstructor">GovActionDeposit</a> <a id="3317" href="Ledger.Conway.Conformance.Epoch.html#3275" class="Bound">gaid</a><a id="3321" class="Symbol">))</a> <a id="3324" href="Ledger.Conway.Conformance.Epoch.html#3340" class="Function">govSt&#39;</a><a id="3330" class="Symbol">)</a>
  <a id="3334" class="Keyword">where</a> <a id="3340" href="Ledger.Conway.Conformance.Epoch.html#3340" class="Function">govSt&#39;</a> <a id="3347" class="Symbol">=</a> <a id="3349" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3354" class="Symbol">(</a><a id="3355" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="3360" href="Ledger.Conway.GovernanceActions.html#2831" class="Field">returnAddr</a><a id="3370" class="Symbol">)</a> <a id="3372" class="Symbol">(</a><a id="3373" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="3382" href="Ledger.Conway.Conformance.Epoch.html#3164" class="Bound">govSt</a><a id="3387" class="Symbol">)</a>


<a id="3391" class="Keyword">opaque</a>

  <a id="mkStakeDistrs"></a><a id="3401" href="Ledger.Conway.Conformance.Epoch.html#3401" class="Function">mkStakeDistrs</a> <a id="3415" class="Symbol">:</a> <a id="3417" href="Ledger.Conway.Conformance.Epoch.html#847" class="Record">Snapshot</a> <a id="3426" class="Symbol">→</a> <a id="3428" href="Ledger.Conway.Gov.html#1397" class="Function">GovState</a> <a id="3437" class="Symbol">→</a> <a id="3439" href="Ledger.Conway.Certs.html#601" class="Function">Deposits</a> <a id="3448" class="Symbol">→</a> <a id="3450" class="Symbol">(</a><a id="3451" href="Ledger.Conway.Address.html#280" class="Datatype">Credential</a> <a id="3462" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3464" href="Ledger.Conway.GovernanceActions.html#472" class="Datatype">VDeleg</a><a id="3470" class="Symbol">)</a> <a id="3472" class="Symbol">→</a> <a id="3474" href="Ledger.Conway.Ratify.html#2949" class="Record">StakeDistrs</a>
  <a id="3488" href="Ledger.Conway.Conformance.Epoch.html#3401" class="Function">mkStakeDistrs</a> <a id="3502" href="Ledger.Conway.Conformance.Epoch.html#3502" class="Bound">ss</a> <a id="3505" href="Ledger.Conway.Conformance.Epoch.html#3505" class="Bound">govSt</a> <a id="3511" href="Ledger.Conway.Conformance.Epoch.html#3511" class="Bound">ds</a> <a id="3514" href="Ledger.Conway.Conformance.Epoch.html#3514" class="Bound">delegations</a> <a id="3526" class="Symbol">.</a><a id="3527" href="Ledger.Conway.Ratify.html#2986" class="Field">StakeDistrs.stakeDistr</a> <a id="3550" class="Symbol">=</a>
    <a id="3556" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a> <a id="3568" href="Ledger.Prelude.html#2543" class="Function Operator">∣</a> <a id="3570" href="Ledger.Conway.Conformance.Epoch.html#3514" class="Bound">delegations</a> <a id="3582" href="Ledger.Prelude.html#2543" class="Function Operator">∣</a> <a id="3584" class="Symbol">(</a><a id="3585" href="Ledger.Conway.Conformance.Epoch.html#880" class="Field">Snapshot.stake</a> <a id="3600" href="Ledger.Conway.Conformance.Epoch.html#3502" class="Bound">ss</a> <a id="3603" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="3606" href="Ledger.Conway.Conformance.Epoch.html#3092" class="Function">gaDepositStake</a> <a id="3621" href="Ledger.Conway.Conformance.Epoch.html#3505" class="Bound">govSt</a> <a id="3627" href="Ledger.Conway.Conformance.Epoch.html#3511" class="Bound">ds</a><a id="3629" class="Symbol">)</a>

<a id="3632" class="Keyword">private</a> <a id="3640" class="Keyword">variable</a>
  <a id="3651" href="Ledger.Conway.Conformance.Epoch.html#3651" class="Generalizable">nes</a> <a id="3655" href="Ledger.Conway.Conformance.Epoch.html#3655" class="Generalizable">nes&#39;</a> <a id="3660" class="Symbol">:</a> <a id="3662" href="Ledger.Conway.Conformance.Epoch.html#1293" class="Record">NewEpochState</a>
  <a id="3678" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="3680" href="Ledger.Conway.Conformance.Epoch.html#3680" class="Generalizable">lastEpoch</a> <a id="3690" class="Symbol">:</a> <a id="3692" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a>
  <a id="3700" href="Ledger.Conway.Conformance.Epoch.html#3700" class="Generalizable">fut</a> <a id="3704" href="Ledger.Conway.Conformance.Epoch.html#3704" class="Generalizable">fut&#39;</a> <a id="3709" class="Symbol">:</a> <a id="3711" href="Ledger.Conway.Ratify.html#3314" class="Record">RatifyState</a>
  <a id="3725" href="Ledger.Conway.Conformance.Epoch.html#3725" class="Generalizable">eps</a> <a id="3729" href="Ledger.Conway.Conformance.Epoch.html#3729" class="Generalizable">eps&#39;</a> <a id="3734" href="Ledger.Conway.Conformance.Epoch.html#3734" class="Generalizable">eps&#39;&#39;</a> <a id="3740" class="Symbol">:</a> <a id="3742" href="Ledger.Conway.Conformance.Epoch.html#1095" class="Record">EpochState</a>
  <a id="3755" href="Ledger.Conway.Conformance.Epoch.html#3755" class="Generalizable">ls</a> <a id="3758" class="Symbol">:</a> <a id="3760" href="Ledger.Conway.Conformance.Ledger.html#723" class="Record">LState</a>
  <a id="3769" href="Ledger.Conway.Conformance.Epoch.html#3769" class="Generalizable">acnt</a> <a id="3774" class="Symbol">:</a> <a id="3776" href="Ledger.Conway.PParams.html#709" class="Record">Acnt</a>
  <a id="3783" href="Ledger.Conway.Conformance.Epoch.html#3783" class="Generalizable">es₀</a> <a id="3787" class="Symbol">:</a> <a id="3789" href="Ledger.Conway.Enact.html#418" class="Record">EnactState</a>
  <a id="3802" href="Ledger.Conway.Conformance.Epoch.html#3802" class="Generalizable">mark</a> <a id="3807" href="Ledger.Conway.Conformance.Epoch.html#3807" class="Generalizable">set</a> <a id="3811" href="Ledger.Conway.Conformance.Epoch.html#3811" class="Generalizable">go</a> <a id="3814" class="Symbol">:</a> <a id="3816" href="Ledger.Conway.Conformance.Epoch.html#847" class="Record">Snapshot</a>
  <a id="3827" href="Ledger.Conway.Conformance.Epoch.html#3827" class="Generalizable">feeSS</a> <a id="3833" class="Symbol">:</a> <a id="3835" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="3842" href="Ledger.Conway.Conformance.Epoch.html#3842" class="Generalizable">lstate</a> <a id="3849" class="Symbol">:</a> <a id="3851" href="Ledger.Conway.Conformance.Ledger.html#723" class="Record">LState</a>
  <a id="3860" href="Ledger.Conway.Conformance.Epoch.html#3860" class="Generalizable">ss</a> <a id="3863" href="Ledger.Conway.Conformance.Epoch.html#3863" class="Generalizable">ss&#39;</a> <a id="3867" class="Symbol">:</a> <a id="3869" href="Ledger.Conway.Conformance.Epoch.html#1005" class="Record">Snapshots</a>
  <a id="3881" href="Ledger.Conway.Conformance.Epoch.html#3881" class="Generalizable">ru</a> <a id="3884" class="Symbol">:</a> <a id="3886" href="Ledger.Conway.Conformance.Epoch.html#736" class="Record">RewardUpdate</a>
  <a id="3901" href="Ledger.Conway.Conformance.Epoch.html#3901" class="Generalizable">mru</a> <a id="3905" class="Symbol">:</a> <a id="3907" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3913" href="Ledger.Conway.Conformance.Epoch.html#736" class="Record">RewardUpdate</a>
  <a id="3928" href="Ledger.Conway.Conformance.Epoch.html#3928" class="Generalizable">certState&#39;</a> <a id="3939" class="Symbol">:</a> <a id="3941" href="Ledger.Conway.Conformance.Certs.html#962" class="Record">CertState</a>

<a id="3952" class="Keyword">data</a> <a id="_⊢_⇀⦇_,SNAP⦈_"></a><a id="3957" href="Ledger.Conway.Conformance.Epoch.html#3957" class="Datatype Operator">_⊢_⇀⦇_,SNAP⦈_</a> <a id="3971" class="Symbol">:</a> <a id="3973" href="Ledger.Conway.Conformance.Ledger.html#723" class="Record">LState</a> <a id="3980" class="Symbol">→</a> <a id="3982" href="Ledger.Conway.Conformance.Epoch.html#1005" class="Record">Snapshots</a> <a id="3992" class="Symbol">→</a> <a id="3994" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="3996" class="Symbol">→</a> <a id="3998" href="Ledger.Conway.Conformance.Epoch.html#1005" class="Record">Snapshots</a> <a id="4008" class="Symbol">→</a> <a id="4010" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4015" class="Keyword">where</a>
  <a id="_⊢_⇀⦇_,SNAP⦈_.SNAP"></a><a id="4023" href="Ledger.Conway.Conformance.Epoch.html#4023" class="InductiveConstructor">SNAP</a> <a id="4028" class="Symbol">:</a> <a id="4030" class="Keyword">let</a> <a id="4034" class="Keyword">open</a> <a id="4039" href="Ledger.Conway.Conformance.Ledger.html#723" class="Module">LState</a> <a id="4046" href="Ledger.Conway.Conformance.Epoch.html#3842" class="Generalizable">lstate</a><a id="4052" class="Symbol">;</a> <a id="4054" class="Keyword">open</a> <a id="4059" href="Ledger.Conway.Utxo.html#2747" class="Module">UTxOState</a> <a id="4069" href="Ledger.Conway.Conformance.Ledger.html#778" class="Function">utxoSt</a><a id="4075" class="Symbol">;</a> <a id="4077" class="Keyword">open</a> <a id="4082" href="Ledger.Conway.Conformance.Certs.html#962" class="Module">CertState</a> <a id="4092" href="Ledger.Conway.Conformance.Ledger.html#831" class="Function">certState</a>
             <a id="4115" href="Ledger.Conway.Conformance.Epoch.html#4115" class="Bound">stake</a> <a id="4121" class="Symbol">=</a> <a id="4123" href="Ledger.Conway.Conformance.Epoch.html#2801" class="Function">stakeDistr</a> <a id="4134" href="Ledger.Conway.Utxo.html#2811" class="Function">utxo</a> <a id="4139" href="Ledger.Conway.Conformance.Certs.html#1021" class="Function">dState</a> <a id="4146" href="Ledger.Conway.Conformance.Certs.html#1041" class="Function">pState</a>
    <a id="4157" class="Keyword">in</a>
    <a id="4164" href="Ledger.Conway.Conformance.Epoch.html#3842" class="Generalizable">lstate</a> <a id="4171" href="Ledger.Conway.Conformance.Epoch.html#3957" class="Datatype Operator">⊢</a> <a id="4173" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="4175" href="Ledger.Conway.Conformance.Epoch.html#3802" class="Generalizable">mark</a> <a id="4180" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4182" href="Ledger.Conway.Conformance.Epoch.html#3807" class="Generalizable">set</a> <a id="4186" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4188" href="Ledger.Conway.Conformance.Epoch.html#3811" class="Generalizable">go</a> <a id="4191" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4193" href="Ledger.Conway.Conformance.Epoch.html#3827" class="Generalizable">feeSS</a> <a id="4199" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="4201" href="Ledger.Conway.Conformance.Epoch.html#3957" class="Datatype Operator">⇀⦇</a> <a id="4204" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="4207" href="Ledger.Conway.Conformance.Epoch.html#3957" class="Datatype Operator">,SNAP⦈</a> <a id="4214" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="4216" href="Ledger.Conway.Conformance.Epoch.html#4115" class="Bound">stake</a> <a id="4222" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4224" href="Ledger.Conway.Conformance.Epoch.html#3802" class="Generalizable">mark</a> <a id="4229" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4231" href="Ledger.Conway.Conformance.Epoch.html#3807" class="Generalizable">set</a> <a id="4235" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4237" href="Ledger.Conway.Utxo.html#2833" class="Function">fees</a> <a id="4242" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

<a id="4245" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="4250" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="4265" class="Symbol">:</a> <a id="4267" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="4269" class="Symbol">→</a> <a id="4271" href="Ledger.Conway.Conformance.Epoch.html#1095" class="Record">EpochState</a> <a id="4282" class="Symbol">→</a> <a id="4284" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a> <a id="4290" class="Symbol">→</a> <a id="4292" href="Ledger.Conway.Conformance.Epoch.html#1095" class="Record">EpochState</a> <a id="4303" class="Symbol">→</a> <a id="4305" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4310" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="4319" href="Ledger.Conway.Conformance.Epoch.html#4319" class="InductiveConstructor">EPOCH</a> <a id="4325" class="Symbol">:</a> <a id="4327" class="Keyword">let</a>
      <a id="4337" class="Keyword">open</a> <a id="4342" href="Ledger.Conway.Conformance.Ledger.html#723" class="Module">LState</a> <a id="4349" href="Ledger.Conway.Conformance.Epoch.html#3755" class="Generalizable">ls</a>
      <a id="4358" class="Keyword">open</a> <a id="4363" href="Ledger.Conway.Conformance.Certs.html#962" class="Module">CertState</a> <a id="4373" href="Ledger.Conway.Conformance.Ledger.html#831" class="Function">certState</a>
      <a id="4389" class="Keyword">open</a> <a id="4394" href="Ledger.Conway.Ratify.html#3314" class="Module">RatifyState</a> <a id="4406" href="Ledger.Conway.Conformance.Epoch.html#3700" class="Generalizable">fut</a>
      <a id="4416" class="Keyword">open</a> <a id="4421" href="Ledger.Conway.Utxo.html#2747" class="Module">UTxOState</a>
      <a id="4437" class="Keyword">open</a> <a id="4442" href="Ledger.Conway.Certs.html#3809" class="Module">PState</a><a id="4448" class="Symbol">;</a> <a id="4450" class="Keyword">open</a> <a id="4455" href="Ledger.Conway.Conformance.Certs.html#589" class="Module">DState</a><a id="4461" class="Symbol">;</a> <a id="4463" class="Keyword">open</a> <a id="4468" href="Ledger.Conway.Conformance.Certs.html#794" class="Module">GState</a>
      <a id="4481" class="Keyword">open</a> <a id="4486" href="Ledger.Conway.PParams.html#709" class="Module">Acnt</a><a id="4490" class="Symbol">;</a> <a id="4492" class="Keyword">open</a> <a id="4497" href="Ledger.Conway.Enact.html#418" class="Module">EnactState</a><a id="4507" class="Symbol">;</a> <a id="4509" class="Keyword">open</a> <a id="4514" href="Ledger.Conway.GovernanceActions.html#2760" class="Module">GovActionState</a>


      <a id="4537" href="Ledger.Conway.Conformance.Epoch.html#4537" class="Bound">removedGovActions</a> <a id="4555" class="Symbol">=</a> <a id="4557" href="Function.Base.html#1638" class="Function">flip</a> <a id="4562" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a> <a id="4573" href="Ledger.Conway.Ratify.html#3384" class="Function">removed</a> <a id="4581" class="Symbol">λ</a> <a id="4583" class="Symbol">(</a><a id="4584" href="Ledger.Conway.Conformance.Epoch.html#4584" class="Bound">gaid</a> <a id="4589" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4591" href="Ledger.Conway.Conformance.Epoch.html#4591" class="Bound">gaSt</a><a id="4595" class="Symbol">)</a> <a id="4597" class="Symbol">→</a>
        <a id="4607" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4612" class="Symbol">(</a><a id="4613" href="Ledger.Conway.GovernanceActions.html#2831" class="Field">returnAddr</a> <a id="4624" href="Ledger.Conway.Conformance.Epoch.html#4591" class="Bound">gaSt</a> <a id="4629" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="4631" class="Symbol">)</a> <a id="4633" class="Symbol">((</a><a id="4635" href="Ledger.Conway.Conformance.Ledger.html#778" class="Function">utxoSt</a> <a id="4642" class="Symbol">.</a><a id="4643" href="Ledger.Conway.Utxo.html#2855" class="Field">deposits</a> <a id="4652" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="4654" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="4656" href="Ledger.Conway.Certs.html#549" class="InductiveConstructor">GovActionDeposit</a> <a id="4673" href="Ledger.Conway.Conformance.Epoch.html#4584" class="Bound">gaid</a> <a id="4678" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="4679" class="Symbol">)</a> <a id="4681" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="4682" class="Symbol">)</a>
      <a id="4690" href="Ledger.Conway.Conformance.Epoch.html#4690" class="Bound">govActionReturns</a> <a id="4707" class="Symbol">=</a> <a id="4709" href="Axiom.Set.Map.Dec.html#1932" class="Function">aggregate₊</a> <a id="4720" class="Symbol">(</a><a id="4721" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4726" class="Symbol">(λ</a> <a id="4729" class="Symbol">(</a><a id="4730" href="Ledger.Conway.Conformance.Epoch.html#4730" class="Bound">a</a> <a id="4732" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4734" class="Symbol">_</a> <a id="4736" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4738" href="Ledger.Conway.Conformance.Epoch.html#4738" class="Bound">d</a><a id="4739" class="Symbol">)</a> <a id="4741" class="Symbol">→</a> <a id="4743" href="Ledger.Conway.Conformance.Epoch.html#4730" class="Bound">a</a> <a id="4745" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4747" href="Ledger.Conway.Conformance.Epoch.html#4738" class="Bound">d</a><a id="4748" class="Symbol">)</a> <a id="4750" href="Ledger.Conway.Conformance.Epoch.html#4537" class="Bound">removedGovActions</a> <a id="4768" href="abstract-set-theory.FiniteSetTheory.html#2767" class="Function Operator">ᶠˢ</a><a id="4770" class="Symbol">)</a>

      <a id="4779" href="Ledger.Conway.Conformance.Epoch.html#4779" class="Bound">trWithdrawals</a>   <a id="4795" class="Symbol">=</a> <a id="4797" href="Ledger.Conway.Ratify.html#3351" class="Function">es</a> <a id="4800" class="Symbol">.</a><a id="4801" href="Ledger.Conway.Enact.html#670" class="Field">withdrawals</a>
      <a id="4819" href="Ledger.Conway.Conformance.Epoch.html#4819" class="Bound">totWithdrawals</a>  <a id="4835" class="Symbol">=</a> <a id="4837" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="4840" href="Ledger.Conway.Conformance.Epoch.html#4840" class="Bound">x</a> <a id="4842" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="4844" href="Ledger.Conway.Conformance.Epoch.html#4779" class="Bound">trWithdrawals</a> <a id="4858" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="4860" href="Ledger.Conway.Conformance.Epoch.html#4840" class="Bound">x</a>

      <a id="4869" href="Ledger.Conway.Conformance.Epoch.html#4869" class="Bound">es</a>         <a id="4880" class="Symbol">=</a> <a id="4882" class="Keyword">record</a> <a id="4889" href="Ledger.Conway.Ratify.html#3351" class="Function">es</a> <a id="4892" class="Symbol">{</a> <a id="4894" href="Ledger.Conway.Enact.html#670" class="Field">withdrawals</a> <a id="4906" class="Symbol">=</a> <a id="4908" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="4910" class="Symbol">}</a>
      <a id="4918" href="Ledger.Conway.Conformance.Epoch.html#4918" class="Bound">retired</a>    <a id="4929" class="Symbol">=</a> <a id="4931" class="Symbol">(</a><a id="4932" href="Ledger.Conway.Conformance.Certs.html#1041" class="Function">pState</a> <a id="4939" class="Symbol">.</a><a id="4940" href="Ledger.Conway.Certs.html#3878" class="Field">retiring</a><a id="4948" class="Symbol">)</a> <a id="4950" href="Axiom.Set.Map.html#14230" class="Function Operator">⁻¹</a> <a id="4953" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a>
      <a id="4961" href="Ledger.Conway.Conformance.Epoch.html#4961" class="Bound">payout</a>     <a id="4972" class="Symbol">=</a> <a id="4974" href="Ledger.Conway.Conformance.Epoch.html#4690" class="Bound">govActionReturns</a> <a id="4991" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="4994" href="Ledger.Conway.Conformance.Epoch.html#4779" class="Bound">trWithdrawals</a>
      <a id="5014" href="Ledger.Conway.Conformance.Epoch.html#5014" class="Bound">refunds</a>    <a id="5025" class="Symbol">=</a> <a id="5027" href="Axiom.Set.Map.html#13791" class="Function">pullbackMap</a> <a id="5039" href="Ledger.Conway.Conformance.Epoch.html#4961" class="Bound">payout</a> <a id="5046" href="Ledger.Conway.Conformance.Epoch.html#1873" class="Function">toRwdAddr</a> <a id="5056" class="Symbol">(</a><a id="5057" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5061" class="Symbol">(</a><a id="5062" href="Ledger.Conway.Conformance.Certs.html#1021" class="Function">dState</a> <a id="5069" class="Symbol">.</a><a id="5070" href="Ledger.Conway.Conformance.Certs.html#725" class="Field">rewards</a><a id="5077" class="Symbol">))</a>
      <a id="5086" href="Ledger.Conway.Conformance.Epoch.html#5086" class="Bound">unclaimed</a>  <a id="5097" class="Symbol">=</a> <a id="5099" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="5107" href="Ledger.Conway.Conformance.Epoch.html#4961" class="Bound">payout</a> <a id="5114" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="5116" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="5124" href="Ledger.Conway.Conformance.Epoch.html#5014" class="Bound">refunds</a>
      <a id="5138" href="Ledger.Conway.Conformance.Epoch.html#5138" class="Bound">vDeposits</a>  <a id="5149" class="Symbol">=</a> <a id="5151" href="Ledger.Conway.Conformance.Certs.html#1061" class="Function">gState</a> <a id="5158" class="Symbol">.</a><a id="5159" href="Ledger.Conway.Conformance.Certs.html#932" class="Field">deposits</a>

      <a id="5175" href="Ledger.Conway.Conformance.Epoch.html#5175" class="Bound">govSt&#39;</a> <a id="5182" class="Symbol">=</a> <a id="5184" href="Data.List.Base.html#10687" class="Function">filter</a> <a id="5191" class="Symbol">(λ</a> <a id="5194" href="Ledger.Conway.Conformance.Epoch.html#5194" class="Bound">x</a> <a id="5196" class="Symbol">→</a> <a id="5198" href="Class.Decidable.Core.html#461" class="Function Operator">¿</a> <a id="5200" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5206" href="Ledger.Conway.Conformance.Epoch.html#5194" class="Bound">x</a> <a id="5208" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="5210" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5215" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5221" href="Ledger.Conway.Ratify.html#3384" class="Function">removed</a> <a id="5229" href="Class.Decidable.Core.html#461" class="Function Operator">¿</a><a id="5230" class="Symbol">)</a> <a id="5232" href="Ledger.Conway.Conformance.Ledger.html#805" class="Function">govSt</a>

      <a id="5245" href="Ledger.Conway.Conformance.Epoch.html#5245" class="Bound">dState&#39;</a> <a id="5253" class="Symbol">:</a> <a id="5255" href="Ledger.Conway.Conformance.Certs.html#589" class="Record">DState</a>
      <a id="5268" href="Ledger.Conway.Conformance.Epoch.html#5245" class="Bound">dState&#39;</a> <a id="5276" class="Symbol">=</a> <a id="5278" class="Keyword">record</a> <a id="5285" href="Ledger.Conway.Conformance.Certs.html#1021" class="Function">dState</a> <a id="5292" class="Symbol">{</a> <a id="5294" href="Ledger.Conway.Conformance.Certs.html#725" class="Field">rewards</a> <a id="5302" class="Symbol">=</a> <a id="5304" href="Ledger.Conway.Conformance.Certs.html#1021" class="Function">dState</a> <a id="5311" class="Symbol">.</a><a id="5312" href="Ledger.Conway.Conformance.Certs.html#725" class="Field">rewards</a> <a id="5320" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="5323" href="Ledger.Conway.Conformance.Epoch.html#5014" class="Bound">refunds</a> <a id="5331" class="Symbol">}</a>

      <a id="5340" href="Ledger.Conway.Conformance.Epoch.html#5340" class="Bound">pState&#39;</a> <a id="5348" class="Symbol">:</a> <a id="5350" href="Ledger.Conway.Certs.html#3809" class="Record">PState</a>
      <a id="5363" href="Ledger.Conway.Conformance.Epoch.html#5340" class="Bound">pState&#39;</a> <a id="5371" class="Symbol">=</a> <a id="5373" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5375" class="Symbol">(</a><a id="5376" href="Ledger.Conway.Conformance.Certs.html#1041" class="Function">pState</a> <a id="5383" class="Symbol">.</a><a id="5384" href="Ledger.Conway.Certs.html#3841" class="Field">pools</a><a id="5389" class="Symbol">)</a> <a id="5391" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="5393" href="Ledger.Conway.Conformance.Epoch.html#4918" class="Bound">retired</a> <a id="5401" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="5403" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5405" class="Symbol">(</a><a id="5406" href="Ledger.Conway.Conformance.Certs.html#1041" class="Function">pState</a> <a id="5413" class="Symbol">.</a><a id="5414" href="Ledger.Conway.Certs.html#3878" class="Field">retiring</a><a id="5422" class="Symbol">)</a> <a id="5424" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="5426" href="Ledger.Conway.Conformance.Epoch.html#4918" class="Bound">retired</a> <a id="5434" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="5436" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

      <a id="5445" href="Ledger.Conway.Conformance.Epoch.html#5445" class="Bound">gState&#39;</a> <a id="5453" class="Symbol">:</a> <a id="5455" href="Ledger.Conway.Conformance.Certs.html#794" class="Record">GState</a>
      <a id="5468" href="Ledger.Conway.Conformance.Epoch.html#5445" class="Bound">gState&#39;</a> <a id="5476" class="Symbol">=</a> <a id="5478" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5480" class="Symbol">(</a><a id="5481" href="Class.ToBool.html#389" class="Function Operator">if</a> <a id="5484" href="Data.List.Base.html#4703" class="Function">null</a> <a id="5489" href="Ledger.Conway.Conformance.Epoch.html#5175" class="Bound">govSt&#39;</a> <a id="5496" href="Class.ToBool.html#389" class="Function Operator">then</a> <a id="5501" href="Axiom.Set.Map.html#6068" class="Function">mapValues</a> <a id="5511" class="Symbol">(</a><a id="5512" class="Number">1</a> <a id="5514" href="Class.HasAdd.Core.html#162" class="Field Operator">+_</a><a id="5516" class="Symbol">)</a> <a id="5518" class="Symbol">(</a><a id="5519" href="Ledger.Conway.Conformance.Certs.html#1061" class="Function">gState</a> <a id="5526" class="Symbol">.</a><a id="5527" href="Ledger.Conway.Conformance.Certs.html#849" class="Field">dreps</a><a id="5532" class="Symbol">)</a> <a id="5534" href="Class.ToBool.html#389" class="Function Operator">else</a> <a id="5539" class="Symbol">(</a><a id="5540" href="Ledger.Conway.Conformance.Certs.html#1061" class="Function">gState</a> <a id="5547" class="Symbol">.</a><a id="5548" href="Ledger.Conway.Conformance.Certs.html#849" class="Field">dreps</a><a id="5553" class="Symbol">))</a>
                <a id="5572" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5574" class="Symbol">(</a><a id="5575" href="Ledger.Conway.Conformance.Certs.html#1061" class="Function">gState</a> <a id="5582" class="Symbol">.</a><a id="5583" href="Ledger.Conway.Conformance.Certs.html#885" class="Field">ccHotKeys</a><a id="5592" class="Symbol">)</a> <a id="5594" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="5596" href="Ledger.Conway.Enact.html#1215" class="Function">ccCreds</a> <a id="5604" class="Symbol">(</a><a id="5605" href="Ledger.Conway.Conformance.Epoch.html#4869" class="Bound">es</a> <a id="5608" class="Symbol">.</a><a id="5609" href="Ledger.Conway.Enact.html#454" class="Field">cc</a><a id="5611" class="Symbol">)</a>
                <a id="5629" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5631" href="Ledger.Conway.Conformance.Epoch.html#5138" class="Bound">vDeposits</a>
                <a id="5657" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

      <a id="5666" href="Ledger.Conway.Conformance.Epoch.html#5666" class="Bound">certState&#39;</a> <a id="5677" class="Symbol">:</a> <a id="5679" href="Ledger.Conway.Conformance.Certs.html#962" class="Record">CertState</a>
      <a id="5695" href="Ledger.Conway.Conformance.Epoch.html#5666" class="Bound">certState&#39;</a> <a id="5706" class="Symbol">=</a> <a id="5708" class="Keyword">record</a> <a id="5715" class="Symbol">{</a> <a id="5717" href="Ledger.Conway.Conformance.Certs.html#1021" class="Field">dState</a> <a id="5724" class="Symbol">=</a> <a id="5726" href="Ledger.Conway.Conformance.Epoch.html#5245" class="Bound">dState&#39;</a> <a id="5734" class="Symbol">;</a> <a id="5736" href="Ledger.Conway.Conformance.Certs.html#1041" class="Field">pState</a> <a id="5743" class="Symbol">=</a> <a id="5745" href="Ledger.Conway.Conformance.Epoch.html#5340" class="Bound">pState&#39;</a> <a id="5753" class="Symbol">;</a> <a id="5755" href="Ledger.Conway.Conformance.Certs.html#1061" class="Field">gState</a> <a id="5762" class="Symbol">=</a> <a id="5764" href="Ledger.Conway.Conformance.Epoch.html#5445" class="Bound">gState&#39;</a> <a id="5772" class="Symbol">}</a>

      <a id="5781" href="Ledger.Conway.Conformance.Epoch.html#5781" class="Bound">utxoSt&#39;</a> <a id="5789" class="Symbol">=</a> <a id="5791" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="5793" href="Ledger.Conway.Conformance.Ledger.html#778" class="Function">utxoSt</a> <a id="5800" class="Symbol">.</a><a id="5801" href="Ledger.Conway.Utxo.html#2811" class="Field">utxo</a> <a id="5806" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5808" href="Ledger.Conway.Conformance.Ledger.html#778" class="Function">utxoSt</a> <a id="5815" class="Symbol">.</a><a id="5816" href="Ledger.Conway.Utxo.html#2833" class="Field">fees</a> <a id="5821" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5823" href="Ledger.Conway.Conformance.Ledger.html#778" class="Function">utxoSt</a> <a id="5830" class="Symbol">.</a><a id="5831" href="Ledger.Conway.Utxo.html#2855" class="Field">deposits</a> <a id="5840" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="5842" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5847" class="Symbol">(</a><a id="5848" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5854" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5856" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="5861" class="Symbol">)</a> <a id="5863" href="Ledger.Conway.Conformance.Epoch.html#4537" class="Bound">removedGovActions</a> <a id="5881" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="5883" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5885" class="Number">0</a> <a id="5887" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

      <a id="5896" href="Ledger.Conway.Conformance.Epoch.html#5896" class="Bound">acnt&#39;</a> <a id="5902" class="Symbol">=</a> <a id="5904" class="Keyword">record</a> <a id="5911" href="Ledger.Conway.Conformance.Epoch.html#3769" class="Generalizable">acnt</a>
        <a id="5924" class="Symbol">{</a> <a id="5926" href="Ledger.Conway.PParams.html#764" class="Field">treasury</a>  <a id="5936" class="Symbol">=</a> <a id="5938" href="Ledger.Conway.Conformance.Epoch.html#3769" class="Generalizable">acnt</a> <a id="5943" class="Symbol">.</a><a id="5944" href="Ledger.Conway.PParams.html#764" class="Field">treasury</a> <a id="5953" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="5955" href="Ledger.Conway.Conformance.Epoch.html#4819" class="Bound">totWithdrawals</a> <a id="5970" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5972" href="Ledger.Conway.Conformance.Ledger.html#778" class="Function">utxoSt</a> <a id="5979" class="Symbol">.</a><a id="5980" href="Ledger.Conway.Utxo.html#2881" class="Field">donations</a> <a id="5990" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="5992" href="Ledger.Conway.Conformance.Epoch.html#5086" class="Bound">unclaimed</a> <a id="6002" class="Symbol">}</a>
    <a id="6008" class="Keyword">in</a>
    <a id="6015" class="Keyword">record</a> <a id="6022" class="Symbol">{</a> <a id="6024" href="Ledger.Conway.Ratify.html#3089" class="Field">currentEpoch</a> <a id="6037" class="Symbol">=</a> <a id="6039" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a>
           <a id="6052" class="Symbol">;</a> <a id="6054" href="Ledger.Conway.Ratify.html#3057" class="Field">stakeDistrs</a> <a id="6066" class="Symbol">=</a> <a id="6068" href="Ledger.Conway.Conformance.Epoch.html#3401" class="Function">mkStakeDistrs</a>  <a id="6083" class="Symbol">(</a><a id="6084" href="Ledger.Conway.Conformance.Epoch.html#1039" class="Field">Snapshots.mark</a> <a id="6099" href="Ledger.Conway.Conformance.Epoch.html#3863" class="Generalizable">ss&#39;</a><a id="6102" class="Symbol">)</a> <a id="6104" href="Ledger.Conway.Conformance.Epoch.html#5175" class="Bound">govSt&#39;</a>
                                          <a id="6153" class="Symbol">(</a><a id="6154" href="Ledger.Conway.Conformance.Epoch.html#5781" class="Bound">utxoSt&#39;</a> <a id="6162" class="Symbol">.</a><a id="6163" href="Ledger.Conway.Utxo.html#2855" class="Field">deposits</a><a id="6171" class="Symbol">)</a> <a id="6173" class="Symbol">(</a><a id="6174" href="Ledger.Conway.Conformance.Certs.html#646" class="Field">voteDelegs</a> <a id="6185" href="Ledger.Conway.Conformance.Certs.html#1021" class="Function">dState</a><a id="6191" class="Symbol">)</a>
           <a id="6204" class="Symbol">;</a> <a id="6206" href="Ledger.Conway.Ratify.html#3204" class="Field">treasury</a> <a id="6215" class="Symbol">=</a> <a id="6217" href="Ledger.Conway.Conformance.Epoch.html#3769" class="Generalizable">acnt</a> <a id="6222" class="Symbol">.</a><a id="6223" href="Ledger.Conway.PParams.html#764" class="Field">treasury</a> <a id="6232" class="Symbol">;</a> <a id="6234" href="Ledger.Conway.Conformance.Epoch.html#6234" class="Module">GState</a> <a id="6241" href="Ledger.Conway.Conformance.Certs.html#1061" class="Function">gState</a>
           <a id="6259" class="Symbol">;</a> <a id="6261" href="Ledger.Conway.Ratify.html#3229" class="Field">pools</a> <a id="6267" class="Symbol">=</a> <a id="6269" href="Ledger.Conway.Conformance.Certs.html#1041" class="Function">pState</a> <a id="6276" class="Symbol">.</a><a id="6277" href="Ledger.Conway.Certs.html#3841" class="Field">pools</a> <a id="6283" class="Symbol">;</a> <a id="6285" href="Ledger.Conway.Ratify.html#3270" class="Field">delegatees</a> <a id="6296" class="Symbol">=</a> <a id="6298" href="Ledger.Conway.Conformance.Certs.html#1021" class="Function">dState</a> <a id="6305" class="Symbol">.</a><a id="6306" href="Ledger.Conway.Conformance.Certs.html#646" class="Field">voteDelegs</a> <a id="6317" class="Symbol">}</a>
        <a id="6327" href="Ledger.Conway.Ratify.html#11107" class="Function Operator">⊢</a> <a id="6329" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="6331" href="Ledger.Conway.Conformance.Epoch.html#4869" class="Bound">es</a> <a id="6334" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6336" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="6338" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6340" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="6346" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="6348" href="Ledger.Conway.Ratify.html#11107" class="Function Operator">⇀⦇</a> <a id="6351" href="Ledger.Conway.Conformance.Epoch.html#5175" class="Bound">govSt&#39;</a> <a id="6358" href="Ledger.Conway.Ratify.html#11107" class="Function Operator">,RATIFIES⦈</a> <a id="6369" href="Ledger.Conway.Conformance.Epoch.html#3704" class="Generalizable">fut&#39;</a>
      <a id="6380" class="Symbol">→</a> <a id="6382" href="Ledger.Conway.Conformance.Epoch.html#3755" class="Generalizable">ls</a> <a id="6385" href="Ledger.Conway.Conformance.Epoch.html#3957" class="Datatype Operator">⊢</a> <a id="6387" href="Ledger.Conway.Conformance.Epoch.html#3860" class="Generalizable">ss</a> <a id="6390" href="Ledger.Conway.Conformance.Epoch.html#3957" class="Datatype Operator">⇀⦇</a> <a id="6393" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="6396" href="Ledger.Conway.Conformance.Epoch.html#3957" class="Datatype Operator">,SNAP⦈</a> <a id="6403" href="Ledger.Conway.Conformance.Epoch.html#3863" class="Generalizable">ss&#39;</a>
    <a id="6411" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
    <a id="6448" class="Symbol">_</a> <a id="6450" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">⊢</a> <a id="6452" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="6454" href="Ledger.Conway.Conformance.Epoch.html#3769" class="Generalizable">acnt</a> <a id="6459" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6461" href="Ledger.Conway.Conformance.Epoch.html#3860" class="Generalizable">ss</a> <a id="6464" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6466" href="Ledger.Conway.Conformance.Epoch.html#3755" class="Generalizable">ls</a> <a id="6469" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6471" href="Ledger.Conway.Conformance.Epoch.html#3783" class="Generalizable">es₀</a> <a id="6475" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6477" href="Ledger.Conway.Conformance.Epoch.html#3700" class="Generalizable">fut</a> <a id="6481" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="6483" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">⇀⦇</a> <a id="6486" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="6488" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">,EPOCH⦈</a>
        <a id="6504" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="6506" href="Ledger.Conway.Conformance.Epoch.html#5896" class="Bound">acnt&#39;</a> <a id="6512" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6514" href="Ledger.Conway.Conformance.Epoch.html#3863" class="Generalizable">ss&#39;</a> <a id="6518" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6520" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="6522" href="Ledger.Conway.Conformance.Epoch.html#5781" class="Bound">utxoSt&#39;</a> <a id="6530" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6532" href="Ledger.Conway.Conformance.Epoch.html#5175" class="Bound">govSt&#39;</a> <a id="6539" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6541" href="Ledger.Conway.Conformance.Epoch.html#5666" class="Bound">certState&#39;</a> <a id="6552" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="6554" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6556" href="Ledger.Conway.Conformance.Epoch.html#4869" class="Bound">es</a> <a id="6559" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6561" href="Ledger.Conway.Conformance.Epoch.html#3704" class="Generalizable">fut&#39;</a> <a id="6566" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

<a id="6569" class="Keyword">data</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="6577" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="6595" class="Symbol">:</a> <a id="6597" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="6599" class="Symbol">→</a> <a id="6601" href="Ledger.Conway.Conformance.Epoch.html#1293" class="Record">NewEpochState</a> <a id="6615" class="Symbol">→</a> <a id="6617" href="Ledger.Conway.Types.Epoch.html#550" class="Function">Epoch</a> <a id="6623" class="Symbol">→</a> <a id="6625" href="Ledger.Conway.Conformance.Epoch.html#1293" class="Record">NewEpochState</a> <a id="6639" class="Symbol">→</a> <a id="6641" href="Agda.Primitive.html#388" class="Primitive">Type</a>

  <a id="6649" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="6658" href="Ledger.Conway.Conformance.Epoch.html#6658" class="InductiveConstructor">NEWEPOCH-New</a> <a id="6671" class="Symbol">:</a> <a id="6673" class="Keyword">let</a>
      <a id="6683" href="Ledger.Conway.Conformance.Epoch.html#6683" class="Bound">eps&#39;</a> <a id="6688" class="Symbol">=</a> <a id="6690" href="Ledger.Conway.Conformance.Epoch.html#2111" class="Function">applyRUpd</a> <a id="6700" href="Ledger.Conway.Conformance.Epoch.html#3881" class="Generalizable">ru</a> <a id="6703" href="Ledger.Conway.Conformance.Epoch.html#3725" class="Generalizable">eps</a>
    <a id="6711" class="Keyword">in</a>
    <a id="6718" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="6720" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="6722" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6724" href="Ledger.Conway.Conformance.Epoch.html#3680" class="Generalizable">lastEpoch</a> <a id="6734" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6736" class="Number">1</a>
    <a id="6742" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">∙</a> <a id="6744" class="Symbol">_</a> <a id="6746" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">⊢</a> <a id="6748" href="Ledger.Conway.Conformance.Epoch.html#6683" class="Bound">eps&#39;</a> <a id="6753" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">⇀⦇</a> <a id="6756" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="6758" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">,EPOCH⦈</a> <a id="6766" href="Ledger.Conway.Conformance.Epoch.html#3734" class="Generalizable">eps&#39;&#39;</a>
      <a id="6778" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="6817" class="Symbol">_</a> <a id="6819" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">⊢</a> <a id="6821" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="6823" href="Ledger.Conway.Conformance.Epoch.html#3680" class="Generalizable">lastEpoch</a> <a id="6833" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6835" href="Ledger.Conway.Conformance.Epoch.html#3725" class="Generalizable">eps</a> <a id="6839" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6841" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6846" href="Ledger.Conway.Conformance.Epoch.html#3881" class="Generalizable">ru</a> <a id="6849" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="6851" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">⇀⦇</a> <a id="6854" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="6856" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="6867" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="6869" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="6871" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6873" href="Ledger.Conway.Conformance.Epoch.html#3734" class="Generalizable">eps&#39;&#39;</a> <a id="6879" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6881" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6889" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="6894" href="Ledger.Conway.Conformance.Epoch.html#6894" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="6911" class="Symbol">:</a>
    <a id="6917" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="6919" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="6921" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="6923" href="Ledger.Conway.Conformance.Epoch.html#3680" class="Generalizable">lastEpoch</a> <a id="6933" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6935" class="Number">1</a>
      <a id="6943" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="6982" class="Symbol">_</a> <a id="6984" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">⊢</a> <a id="6986" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="6988" href="Ledger.Conway.Conformance.Epoch.html#3680" class="Generalizable">lastEpoch</a> <a id="6998" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7000" href="Ledger.Conway.Conformance.Epoch.html#3725" class="Generalizable">eps</a> <a id="7004" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7006" href="Ledger.Conway.Conformance.Epoch.html#3901" class="Generalizable">mru</a> <a id="7010" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="7012" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">⇀⦇</a> <a id="7015" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="7017" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="7028" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="7030" href="Ledger.Conway.Conformance.Epoch.html#3680" class="Generalizable">lastEpoch</a> <a id="7040" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7042" href="Ledger.Conway.Conformance.Epoch.html#3725" class="Generalizable">eps</a> <a id="7046" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7048" href="Ledger.Conway.Conformance.Epoch.html#3901" class="Generalizable">mru</a> <a id="7052" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="7057" href="Ledger.Conway.Conformance.Epoch.html#7057" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="7083" class="Symbol">:</a>
    <a id="7089" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="7091" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="7093" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7095" href="Ledger.Conway.Conformance.Epoch.html#3680" class="Generalizable">lastEpoch</a> <a id="7105" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="7107" class="Number">1</a>
    <a id="7113" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">∙</a> <a id="7115" class="Symbol">_</a> <a id="7117" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">⊢</a> <a id="7119" href="Ledger.Conway.Conformance.Epoch.html#3725" class="Generalizable">eps</a> <a id="7123" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">⇀⦇</a> <a id="7126" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="7128" href="Ledger.Conway.Conformance.Epoch.html#4250" class="Datatype Operator">,EPOCH⦈</a> <a id="7136" href="Ledger.Conway.Conformance.Epoch.html#3729" class="Generalizable">eps&#39;</a>
      <a id="7147" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="7186" class="Symbol">_</a> <a id="7188" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">⊢</a> <a id="7190" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="7192" href="Ledger.Conway.Conformance.Epoch.html#3680" class="Generalizable">lastEpoch</a> <a id="7202" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7204" href="Ledger.Conway.Conformance.Epoch.html#3725" class="Generalizable">eps</a> <a id="7208" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7210" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="7218" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a> <a id="7220" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">⇀⦇</a> <a id="7223" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="7225" href="Ledger.Conway.Conformance.Epoch.html#6577" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="7236" href="Ledger.Prelude.html#2441" class="Function Operator">⟦</a> <a id="7238" href="Ledger.Conway.Conformance.Epoch.html#3678" class="Generalizable">e</a> <a id="7240" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7242" href="Ledger.Conway.Conformance.Epoch.html#3729" class="Generalizable">eps&#39;</a> <a id="7247" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7249" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="7257" href="Ledger.Prelude.html#2441" class="Function Operator">⟧</a>
</pre></body></html>