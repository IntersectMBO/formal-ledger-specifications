<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Conformance.Epoch</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="58" class="Keyword">using</a> <a id="64" class="Symbol">(</a><a id="65" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="75" class="Symbol">;</a> <a id="77" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a><a id="98" class="Symbol">)</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Data.List.html" class="Module">Data.List</a> <a id="122" class="Keyword">using</a> <a id="128" class="Symbol">(</a><a id="129" href="Data.List.Base.html#10687" class="Function">filter</a><a id="135" class="Symbol">)</a>
<a id="137" class="Keyword">import</a> <a id="144" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="157" class="Symbol">as</a> <a id="160" class="Module">ℤ</a>

<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="197" class="Keyword">open</a> <a id="202" class="Keyword">import</a> <a id="209" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>

<a id="326" class="Keyword">module</a> <a id="333" href="Ledger.Conway.Conformance.Epoch.html" class="Module">Ledger.Conway.Conformance.Epoch</a>
  <a id="367" class="Symbol">(</a><a id="368" href="Ledger.Conway.Conformance.Epoch.html#368" class="Bound">txs</a> <a id="372" class="Symbol">:</a> <a id="374" class="Symbol">_)</a> <a id="377" class="Symbol">(</a><a id="378" class="Keyword">open</a> <a id="383" href="Ledger.Conway.Specification.Transaction.html#1000" class="Module">TransactionStructure</a> <a id="404" href="Ledger.Conway.Conformance.Epoch.html#368" class="Bound">txs</a><a id="407" class="Symbol">)</a>
  <a id="411" class="Symbol">(</a><a id="412" href="Ledger.Conway.Conformance.Epoch.html#412" class="Bound">abs</a> <a id="416" class="Symbol">:</a> <a id="418" href="Ledger.Conway.Specification.Abstract.html#641" class="Record">AbstractFunctions</a> <a id="436" href="Ledger.Conway.Conformance.Epoch.html#368" class="Bound">txs</a><a id="439" class="Symbol">)</a> <a id="441" class="Symbol">(</a><a id="442" class="Keyword">open</a> <a id="447" href="Ledger.Conway.Specification.Abstract.html#641" class="Module">AbstractFunctions</a> <a id="465" href="Ledger.Conway.Conformance.Epoch.html#412" class="Bound">abs</a><a id="468" class="Symbol">)</a>
  <a id="472" class="Keyword">where</a>

<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="523" href="Ledger.Conway.Conformance.Epoch.html#368" class="Bound">txs</a>
<a id="527" class="Keyword">open</a> <a id="532" class="Keyword">import</a> <a id="539" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="573" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="586" class="Keyword">open</a> <a id="591" class="Keyword">import</a> <a id="598" href="Ledger.Conway.Conformance.Ledger.html" class="Module">Ledger.Conway.Conformance.Ledger</a> <a id="631" href="Ledger.Conway.Conformance.Epoch.html#368" class="Bound">txs</a> <a id="635" href="Ledger.Conway.Conformance.Epoch.html#412" class="Bound">abs</a>
<a id="639" class="Keyword">open</a> <a id="644" class="Keyword">import</a> <a id="651" href="Ledger.Conway.Specification.Ratify.html" class="Module">Ledger.Conway.Specification.Ratify</a> <a id="686" href="Ledger.Conway.Conformance.Epoch.html#368" class="Bound">txs</a>
<a id="690" class="Keyword">open</a> <a id="695" class="Keyword">import</a> <a id="702" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="733" href="Ledger.Conway.Conformance.Epoch.html#368" class="Bound">txs</a> <a id="737" href="Ledger.Conway.Conformance.Epoch.html#412" class="Bound">abs</a>
<a id="741" class="Keyword">open</a> <a id="746" class="Keyword">import</a> <a id="753" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="785" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>

<a id="799" class="Keyword">record</a> <a id="RewardUpdate"></a><a id="806" href="Ledger.Conway.Conformance.Epoch.html#806" class="Record">RewardUpdate</a> <a id="819" class="Symbol">:</a> <a id="821" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="825" class="Keyword">where</a>
  <a id="833" class="Keyword">constructor</a> <a id="⟦_,_,_,_⟧ʳᵘ"></a><a id="845" href="Ledger.Conway.Conformance.Epoch.html#845" class="InductiveConstructor Operator">⟦_,_,_,_⟧ʳᵘ</a>
  <a id="859" class="Keyword">field</a>
    <a id="RewardUpdate.Δt"></a><a id="869" href="Ledger.Conway.Conformance.Epoch.html#869" class="Field">Δt</a> <a id="RewardUpdate.Δr"></a><a id="872" href="Ledger.Conway.Conformance.Epoch.html#872" class="Field">Δr</a> <a id="RewardUpdate.Δf"></a><a id="875" href="Ledger.Conway.Conformance.Epoch.html#875" class="Field">Δf</a> <a id="878" class="Symbol">:</a> <a id="880" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
    <a id="RewardUpdate.rs"></a><a id="886" href="Ledger.Conway.Conformance.Epoch.html#886" class="Field">rs</a> <a id="889" class="Symbol">:</a> <a id="891" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="902" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="904" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

<a id="910" class="Keyword">record</a> <a id="Snapshot"></a><a id="917" href="Ledger.Conway.Conformance.Epoch.html#917" class="Record">Snapshot</a> <a id="926" class="Symbol">:</a> <a id="928" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="932" class="Keyword">where</a>
  <a id="940" class="Keyword">field</a>
    <a id="Snapshot.stake"></a><a id="950" href="Ledger.Conway.Conformance.Epoch.html#950" class="Field">stake</a>        <a id="963" class="Symbol">:</a> <a id="965" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="976" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="978" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="Snapshot.delegations"></a><a id="987" href="Ledger.Conway.Conformance.Epoch.html#987" class="Field">delegations</a>  <a id="1000" class="Symbol">:</a> <a id="1002" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="1013" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1015" href="Ledger.Core.Specification.Crypto.html#1338" class="Function">KeyHash</a>
    <a id="1027" class="Comment">-- poolParameters : KeyHash ⇀ PoolParam</a>

<a id="1068" class="Keyword">record</a> <a id="Snapshots"></a><a id="1075" href="Ledger.Conway.Conformance.Epoch.html#1075" class="Record">Snapshots</a> <a id="1085" class="Symbol">:</a> <a id="1087" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1091" class="Keyword">where</a>
  <a id="1099" class="Keyword">field</a>
    <a id="Snapshots.mark"></a><a id="1109" href="Ledger.Conway.Conformance.Epoch.html#1109" class="Field">mark</a> <a id="Snapshots.set"></a><a id="1114" href="Ledger.Conway.Conformance.Epoch.html#1114" class="Field">set</a> <a id="Snapshots.go"></a><a id="1118" href="Ledger.Conway.Conformance.Epoch.html#1118" class="Field">go</a>  <a id="1122" class="Symbol">:</a> <a id="1124" href="Ledger.Conway.Conformance.Epoch.html#917" class="Record">Snapshot</a>
    <a id="Snapshots.feeSS"></a><a id="1137" href="Ledger.Conway.Conformance.Epoch.html#1137" class="Field">feeSS</a>        <a id="1150" class="Symbol">:</a> <a id="1152" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

<a id="1158" class="Keyword">record</a> <a id="EpochState"></a><a id="1165" href="Ledger.Conway.Conformance.Epoch.html#1165" class="Record">EpochState</a> <a id="1176" class="Symbol">:</a> <a id="1178" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1183" class="Keyword">where</a>
  <a id="1191" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1203" href="Ledger.Conway.Conformance.Epoch.html#1203" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>
  <a id="1219" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1229" href="Ledger.Conway.Conformance.Epoch.html#1229" class="Field">acnt</a>       <a id="1240" class="Symbol">:</a> <a id="1242" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1251" href="Ledger.Conway.Conformance.Epoch.html#1251" class="Field">ss</a>         <a id="1262" class="Symbol">:</a> <a id="1264" href="Ledger.Conway.Conformance.Epoch.html#1075" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1278" href="Ledger.Conway.Conformance.Epoch.html#1278" class="Field">ls</a>         <a id="1289" class="Symbol">:</a> <a id="1291" href="Ledger.Conway.Conformance.Ledger.html#779" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1302" href="Ledger.Conway.Conformance.Epoch.html#1302" class="Field">es</a>         <a id="1313" class="Symbol">:</a> <a id="1315" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="1330" href="Ledger.Conway.Conformance.Epoch.html#1330" class="Field">fut</a>        <a id="1341" class="Symbol">:</a> <a id="1343" href="Ledger.Conway.Specification.Ratify.html#3383" class="Record">RatifyState</a>

<a id="1356" class="Keyword">record</a> <a id="NewEpochState"></a><a id="1363" href="Ledger.Conway.Conformance.Epoch.html#1363" class="Record">NewEpochState</a> <a id="1377" class="Symbol">:</a> <a id="1379" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1384" class="Keyword">where</a>
  <a id="1392" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="1402" href="Ledger.Conway.Conformance.Epoch.html#1402" class="Field">lastEpoch</a>   <a id="1414" class="Symbol">:</a> <a id="1416" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
    <a id="NewEpochState.epochState"></a><a id="1426" href="Ledger.Conway.Conformance.Epoch.html#1426" class="Field">epochState</a>  <a id="1438" class="Symbol">:</a> <a id="1440" href="Ledger.Conway.Conformance.Epoch.html#1165" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="1455" href="Ledger.Conway.Conformance.Epoch.html#1455" class="Field">ru</a>          <a id="1467" class="Symbol">:</a> <a id="1469" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1475" href="Ledger.Conway.Conformance.Epoch.html#806" class="Record">RewardUpdate</a>

<a id="1489" class="Keyword">instance</a>
  <a id="1500" class="Keyword">unquoteDecl</a> <a id="HasCast-RewardUpdate"></a><a id="1512" href="Ledger.Conway.Conformance.Epoch.html#1512" class="Function">HasCast-RewardUpdate</a> <a id="HasCast-Snapshot"></a><a id="1533" href="Ledger.Conway.Conformance.Epoch.html#1533" class="Function">HasCast-Snapshot</a> <a id="HasCast-Snapshots"></a><a id="1550" href="Ledger.Conway.Conformance.Epoch.html#1550" class="Function">HasCast-Snapshots</a> <a id="HasCast-EpochState"></a><a id="1568" href="Ledger.Conway.Conformance.Epoch.html#1568" class="Function">HasCast-EpochState</a> <a id="HasCast-NewEpochState"></a><a id="1587" href="Ledger.Conway.Conformance.Epoch.html#1587" class="Function">HasCast-NewEpochState</a> <a id="1609" class="Symbol">=</a> <a id="1611" href="stdlib-classes.Class.HasCast.Derive.html#2690" class="Function">derive-HasCast</a>
    <a id="1630" class="Symbol">(</a>   <a id="1634" class="Symbol">(</a><a id="1635" class="Keyword">quote</a> <a id="1641" href="Ledger.Conway.Conformance.Epoch.html#806" class="Record">RewardUpdate</a>   <a id="1656" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1658" href="Ledger.Conway.Conformance.Epoch.html#1512" class="Function">HasCast-RewardUpdate</a><a id="1678" class="Symbol">)</a>
    <a id="1684" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1688" class="Symbol">(</a><a id="1689" class="Keyword">quote</a> <a id="1695" href="Ledger.Conway.Conformance.Epoch.html#917" class="Record">Snapshot</a>       <a id="1710" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1712" href="Ledger.Conway.Conformance.Epoch.html#1533" class="Function">HasCast-Snapshot</a><a id="1728" class="Symbol">)</a>
    <a id="1734" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1738" class="Symbol">(</a><a id="1739" class="Keyword">quote</a> <a id="1745" href="Ledger.Conway.Conformance.Epoch.html#1075" class="Record">Snapshots</a>      <a id="1760" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1762" href="Ledger.Conway.Conformance.Epoch.html#1550" class="Function">HasCast-Snapshots</a><a id="1779" class="Symbol">)</a>
    <a id="1785" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1789" class="Symbol">(</a><a id="1790" class="Keyword">quote</a> <a id="1796" href="Ledger.Conway.Conformance.Epoch.html#1165" class="Record">EpochState</a>     <a id="1811" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1813" href="Ledger.Conway.Conformance.Epoch.html#1568" class="Function">HasCast-EpochState</a><a id="1831" class="Symbol">)</a>
    <a id="1837" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1839" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="1841" class="Symbol">(</a><a id="1842" class="Keyword">quote</a> <a id="1848" href="Ledger.Conway.Conformance.Epoch.html#1363" class="Record">NewEpochState</a>  <a id="1863" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1865" href="Ledger.Conway.Conformance.Epoch.html#1587" class="Function">HasCast-NewEpochState</a><a id="1886" class="Symbol">)</a><a id="1887" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="1888" class="Symbol">)</a>

<a id="1891" class="Keyword">instance</a> <a id="1900" href="Ledger.Conway.Conformance.Epoch.html#1900" class="Function">_</a> <a id="1902" class="Symbol">=</a> <a id="1904" href="Data.Nat.Properties.html#17252" class="Function">+-0-monoid</a><a id="1914" class="Symbol">;</a> <a id="1916" href="Ledger.Conway.Conformance.Epoch.html#1916" class="Function">_</a> <a id="1918" class="Symbol">=</a> <a id="1920" href="Data.Nat.Properties.html#17331" class="Function">+-0-commutativeMonoid</a>

<a id="toRwdAddr"></a><a id="1943" href="Ledger.Conway.Conformance.Epoch.html#1943" class="Function">toRwdAddr</a> <a id="1953" class="Symbol">:</a> <a id="1955" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="1966" class="Symbol">→</a> <a id="1968" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
<a id="1976" href="Ledger.Conway.Conformance.Epoch.html#1943" class="Function">toRwdAddr</a> <a id="1986" href="Ledger.Conway.Conformance.Epoch.html#1986" class="Bound">x</a> <a id="1988" class="Symbol">=</a> <a id="1990" class="Keyword">record</a> <a id="1997" class="Symbol">{</a> <a id="1999" href="Ledger.Core.Specification.Address.html#1353" class="Field">net</a> <a id="2003" class="Symbol">=</a> <a id="2005" href="Ledger.Core.Specification.Epoch.html#2367" class="Function">NetworkId</a> <a id="2015" class="Symbol">;</a> <a id="2017" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="2023" class="Symbol">=</a> <a id="2025" href="Ledger.Conway.Conformance.Epoch.html#1986" class="Bound">x</a> <a id="2027" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="2030" href="Ledger.Conway.Conformance.Epoch.html#2030" class="Function">getStakeCred</a> <a id="2043" class="Symbol">:</a> <a id="2045" href="Ledger.Conway.Specification.Transaction.html#2630" class="Function">TxOut</a> <a id="2051" class="Symbol">→</a> <a id="2053" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2059" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a>
<a id="2070" href="Ledger.Conway.Conformance.Epoch.html#2030" class="Function">getStakeCred</a> <a id="2083" class="Symbol">(</a><a id="2084" href="Ledger.Conway.Conformance.Epoch.html#2084" class="Bound">a</a> <a id="2086" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2088" class="Symbol">_</a> <a id="2090" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2092" class="Symbol">_</a> <a id="2094" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2096" class="Symbol">_)</a> <a id="2099" class="Symbol">=</a> <a id="2101" href="Ledger.Core.Specification.Address.html#2496" class="Function">stakeCred</a> <a id="2111" href="Ledger.Conway.Conformance.Epoch.html#2084" class="Bound">a</a>

<a id="2114" class="Keyword">open</a> <a id="2119" href="Ledger.Core.Specification.Address.html#1324" class="Module">RwdAddr</a> <a id="2127" class="Keyword">using</a> <a id="2133" class="Symbol">(</a><a id="2134" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a><a id="2139" class="Symbol">)</a>
<a id="2141" class="Keyword">open</a> <a id="2146" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Module">GovActionState</a> <a id="2161" class="Keyword">using</a> <a id="2167" class="Symbol">(</a><a id="2168" href="Ledger.Conway.Specification.Gov.Actions.html#2811" class="Field">returnAddr</a><a id="2178" class="Symbol">)</a>

<a id="applyRUpd"></a><a id="2181" href="Ledger.Conway.Conformance.Epoch.html#2181" class="Function">applyRUpd</a> <a id="2191" class="Symbol">:</a> <a id="2193" href="Ledger.Conway.Conformance.Epoch.html#806" class="Record">RewardUpdate</a> <a id="2206" class="Symbol">→</a> <a id="2208" href="Ledger.Conway.Conformance.Epoch.html#1165" class="Record">EpochState</a> <a id="2219" class="Symbol">→</a> <a id="2221" href="Ledger.Conway.Conformance.Epoch.html#1165" class="Record">EpochState</a>
<a id="2232" href="Ledger.Conway.Conformance.Epoch.html#2181" class="Function">applyRUpd</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#2244}{\htmlId{2244}{\htmlClass{Bound}{\text{Δt}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2249}{\htmlId{2249}{\htmlClass{Bound}{\text{Δr}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2254}{\htmlId{2254}{\htmlClass{Bound}{\text{Δf}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2259}{\htmlId{2259}{\htmlClass{Bound}{\text{rs}}}}\, \end{pmatrix}$</a>
  <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#2272}{\htmlId{2272}{\htmlClass{Bound}{\text{treasury}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2283}{\htmlId{2283}{\htmlClass{Bound}{\text{reserves}}}}\, \end{pmatrix}
  \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2299}{\htmlId{2299}{\htmlClass{Bound}{\text{ss}}}}\,
  \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#2310}{\htmlId{2310}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2317}{\htmlId{2317}{\htmlClass{Bound}{\text{fees}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2324}{\htmlId{2324}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2335}{\htmlId{2335}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
    \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2354}{\htmlId{2354}{\htmlClass{Bound}{\text{govSt}}}}\,
    \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#2370}{\htmlId{2370}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2383}{\htmlId{2383}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2397}{\htmlId{2397}{\htmlClass{Bound}{\text{rewards}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2407}{\htmlId{2407}{\htmlClass{Bound}{\text{dDeposits}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2422}{\htmlId{2422}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2431}{\htmlId{2431}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
  \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2449}{\htmlId{2449}{\htmlClass{Bound}{\text{es}}}}\,
  \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2456}{\htmlId{2456}{\htmlClass{Bound}{\text{fut}}}}\,
  \end{pmatrix}$</a> <a id="2466" class="Symbol">=</a>
  <a class="AgdaKaTeX">$\begin{pmatrix} \begin{pmatrix} \,\href{Prelude.html#3167}{\htmlId{2474}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{2482}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Agda.Builtin.Int.html#263}{\htmlId{2483}{\htmlClass{InductiveConstructor Operator}{\text{ℤ.+}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#2272}{\htmlId{2487}{\htmlClass{Bound}{\text{treasury}}}}\, \,\href{Data.Integer.Base.html#5064}{\htmlId{2496}{\htmlClass{Function Operator}{\text{ℤ.+}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#2244}{\htmlId{2500}{\htmlClass{Bound}{\text{Δt}}}}\, \,\href{Data.Integer.Base.html#5064}{\htmlId{2503}{\htmlClass{Function Operator}{\text{ℤ.+}}}}\, \,\href{Agda.Builtin.Int.html#263}{\htmlId{2507}{\htmlClass{InductiveConstructor Operator}{\text{ℤ.+}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#2839}{\htmlId{2511}{\htmlClass{Function}{\text{unregRU&#39;}}}}\,\,\htmlId{2519}{\htmlClass{Symbol}{\text{)}}}\,
    \\ \,\href{Prelude.html#3167}{\htmlId{2527}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{2535}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Agda.Builtin.Int.html#263}{\htmlId{2536}{\htmlClass{InductiveConstructor Operator}{\text{ℤ.+}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#2283}{\htmlId{2540}{\htmlClass{Bound}{\text{reserves}}}}\, \,\href{Data.Integer.Base.html#5064}{\htmlId{2549}{\htmlClass{Function Operator}{\text{ℤ.+}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#2249}{\htmlId{2553}{\htmlClass{Bound}{\text{Δr}}}}\,\,\htmlId{2555}{\htmlClass{Symbol}{\text{)}}}\, \end{pmatrix}
  \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2299}{\htmlId{2564}{\htmlClass{Bound}{\text{ss}}}}\,
  \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#2310}{\htmlId{2575}{\htmlClass{Bound}{\text{utxo}}}}\, \\ \,\href{Prelude.html#3167}{\htmlId{2582}{\htmlClass{Function}{\text{posPart}}}}\, \,\htmlId{2590}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Agda.Builtin.Int.html#263}{\htmlId{2591}{\htmlClass{InductiveConstructor Operator}{\text{ℤ.+}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#2317}{\htmlId{2595}{\htmlClass{Bound}{\text{fees}}}}\, \,\href{Data.Integer.Base.html#5064}{\htmlId{2600}{\htmlClass{Function Operator}{\text{ℤ.+}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#2254}{\htmlId{2604}{\htmlClass{Bound}{\text{Δf}}}}\,\,\htmlId{2606}{\htmlClass{Symbol}{\text{)}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2324}{\htmlId{2610}{\htmlClass{Bound}{\text{deposits}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2335}{\htmlId{2621}{\htmlClass{Bound}{\text{donations}}}}\, \end{pmatrix}
    \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2354}{\htmlId{2640}{\htmlClass{Bound}{\text{govSt}}}}\,
    \\ \begin{pmatrix} \begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#2370}{\htmlId{2656}{\htmlClass{Bound}{\text{voteDelegs}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2383}{\htmlId{2669}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2397}{\htmlId{2683}{\htmlClass{Bound}{\text{rewards}}}}\, \,\href{Axiom.Set.Map.Dec.html#1854}{\htmlId{2691}{\htmlClass{Function Operator}{\text{∪⁺}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#2771}{\htmlId{2694}{\htmlClass{Function}{\text{regRU}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2407}{\htmlId{2702}{\htmlClass{Bound}{\text{dDeposits}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2422}{\htmlId{2717}{\htmlClass{Bound}{\text{pState}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2431}{\htmlId{2726}{\htmlClass{Bound}{\text{gState}}}}\, \end{pmatrix} \end{pmatrix}
  \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2449}{\htmlId{2744}{\htmlClass{Bound}{\text{es}}}}\,
  \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2456}{\htmlId{2751}{\htmlClass{Bound}{\text{fut}}}}\, \end{pmatrix}$</a>
  <a id="2761" class="Keyword">where</a>
    <a id="2771" href="Ledger.Conway.Conformance.Epoch.html#2771" class="Function">regRU</a>     <a id="2781" class="Symbol">=</a> <a id="2783" href="Ledger.Conway.Conformance.Epoch.html#2259" class="Bound">rs</a> <a id="2786" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2788" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2792" href="Ledger.Conway.Conformance.Epoch.html#2397" class="Bound">rewards</a>
    <a id="2804" href="Ledger.Conway.Conformance.Epoch.html#2804" class="Function">unregRU</a>   <a id="2814" class="Symbol">=</a> <a id="2816" href="Ledger.Conway.Conformance.Epoch.html#2259" class="Bound">rs</a> <a id="2819" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="2821" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2825" href="Ledger.Conway.Conformance.Epoch.html#2397" class="Bound">rewards</a> <a id="2833" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a>
    <a id="2839" href="Ledger.Conway.Conformance.Epoch.html#2839" class="Function">unregRU&#39;</a>  <a id="2849" class="Symbol">=</a> <a id="2851" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="2854" href="Ledger.Conway.Conformance.Epoch.html#2854" class="Bound">x</a> <a id="2856" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="2858" href="Ledger.Conway.Conformance.Epoch.html#2804" class="Function">unregRU</a> <a id="2866" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="2868" href="Ledger.Conway.Conformance.Epoch.html#2854" class="Bound">x</a>

<a id="stakeDistr"></a><a id="2871" href="Ledger.Conway.Conformance.Epoch.html#2871" class="Function">stakeDistr</a> <a id="2882" class="Symbol">:</a> <a id="2884" href="Ledger.Conway.Specification.Transaction.html#2698" class="Function">UTxO</a> <a id="2889" class="Symbol">→</a> <a id="2891" href="Ledger.Conway.Conformance.Certs.html#597" class="Record">DState</a> <a id="2898" class="Symbol">→</a> <a id="2900" href="Ledger.Conway.Specification.Certs.html#3808" class="Record">PState</a> <a id="2907" class="Symbol">→</a> <a id="2909" href="Ledger.Conway.Conformance.Epoch.html#917" class="Record">Snapshot</a>
<a id="2918" href="Ledger.Conway.Conformance.Epoch.html#2871" class="Function">stakeDistr</a> <a id="2929" href="Ledger.Conway.Conformance.Epoch.html#2929" class="Bound">utxo</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{2936}{\htmlClass{Symbol}{\text{\_}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2940}{\htmlId{2940}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2954}{\htmlId{2954}{\htmlClass{Bound}{\text{rewards}}}}\, \\ \,\htmlId{2964}{\htmlClass{Symbol}{\text{\_}}}\, \end{pmatrix}$</a> <a id="2969" href="Ledger.Conway.Conformance.Epoch.html#2969" class="Bound">pState</a> <a id="2976" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Axiom.Set.Map.Dec.html#1932}{\htmlId{2980}{\htmlClass{Function}{\text{aggregate₊}}}}\, \,\htmlId{2991}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Conformance.Epoch.html#3129}{\htmlId{2992}{\htmlClass{Function}{\text{stakeRelation}}}}\, \,\href{abstract-set-theory.FiniteSetTheory.html#2767}{\htmlId{3006}{\htmlClass{Function Operator}{\text{ᶠˢ}}}}\,\,\htmlId{3008}{\htmlClass{Symbol}{\text{)}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#2940}{\htmlId{3012}{\htmlClass{Bound}{\text{stakeDelegs}}}}\, \end{pmatrix}$</a>
  <a id="3028" class="Keyword">where</a>
    <a id="3038" href="Ledger.Conway.Conformance.Epoch.html#3038" class="Function">m</a> <a id="3040" class="Symbol">=</a> <a id="3042" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3047" class="Symbol">(λ</a> <a id="3050" href="Ledger.Conway.Conformance.Epoch.html#3050" class="Bound">a</a> <a id="3052" class="Symbol">→</a> <a id="3054" class="Symbol">(</a><a id="3055" href="Ledger.Conway.Conformance.Epoch.html#3050" class="Bound">a</a> <a id="3057" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3059" href="Ledger.Conway.Specification.Utxo.html#2412" class="Function">cbalance</a> <a id="3068" class="Symbol">(</a><a id="3069" href="Ledger.Conway.Conformance.Epoch.html#2929" class="Bound">utxo</a> <a id="3074" href="abstract-set-theory.FiniteSetTheory.html#3088" class="Function Operator">∣^&#39;</a> <a id="3078" class="Symbol">λ</a> <a id="3080" href="Ledger.Conway.Conformance.Epoch.html#3080" class="Bound">i</a> <a id="3082" class="Symbol">→</a> <a id="3084" href="Ledger.Conway.Conformance.Epoch.html#2030" class="Function">getStakeCred</a> <a id="3097" href="Ledger.Conway.Conformance.Epoch.html#3080" class="Bound">i</a> <a id="3099" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3101" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3106" href="Ledger.Conway.Conformance.Epoch.html#3050" class="Bound">a</a><a id="3107" class="Symbol">)))</a> <a id="3111" class="Symbol">(</a><a id="3112" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3116" href="Ledger.Conway.Conformance.Epoch.html#2954" class="Bound">rewards</a><a id="3123" class="Symbol">)</a>
    <a id="3129" href="Ledger.Conway.Conformance.Epoch.html#3129" class="Function">stakeRelation</a> <a id="3143" class="Symbol">=</a> <a id="3145" href="Ledger.Conway.Conformance.Epoch.html#3038" class="Function">m</a> <a id="3147" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="3149" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="3151" href="Ledger.Conway.Conformance.Epoch.html#2954" class="Bound">rewards</a> <a id="3159" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a>

<a id="gaDepositStake"></a><a id="3162" href="Ledger.Conway.Conformance.Epoch.html#3162" class="Function">gaDepositStake</a> <a id="3177" class="Symbol">:</a> <a id="3179" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="3188" class="Symbol">→</a> <a id="3190" href="Ledger.Conway.Specification.Certs.html#590" class="Function">Deposits</a> <a id="3199" class="Symbol">→</a> <a id="3201" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="3212" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3214" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="3219" href="Ledger.Conway.Conformance.Epoch.html#3162" class="Function">gaDepositStake</a> <a id="3234" href="Ledger.Conway.Conformance.Epoch.html#3234" class="Bound">govSt</a> <a id="3240" href="Ledger.Conway.Conformance.Epoch.html#3240" class="Bound">ds</a> <a id="3243" class="Symbol">=</a> <a id="3245" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a>
  <a id="3259" class="Symbol">(</a><a id="3260" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3265" class="Symbol">(λ</a> <a id="3268" class="Symbol">(</a><a id="3269" href="Ledger.Conway.Conformance.Epoch.html#3269" class="Bound">gaid</a> <a id="3274" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3276" href="Ledger.Conway.Conformance.Epoch.html#3276" class="Bound">addr</a><a id="3280" class="Symbol">)</a> <a id="3282" class="Symbol">→</a> <a id="3284" class="Symbol">(</a><a id="3285" href="Ledger.Conway.Conformance.Epoch.html#3269" class="Bound">gaid</a> <a id="3290" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3292" href="Ledger.Conway.Conformance.Epoch.html#3276" class="Bound">addr</a><a id="3296" class="Symbol">)</a> <a id="3298" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3300" href="Ledger.Core.Specification.Address.html#1378" class="Field">stake</a> <a id="3306" href="Ledger.Conway.Conformance.Epoch.html#3276" class="Bound">addr</a><a id="3310" class="Symbol">)</a> <a id="3312" href="Ledger.Conway.Conformance.Epoch.html#3410" class="Function">govSt&#39;</a><a id="3318" class="Symbol">)</a>
  <a id="3322" class="Symbol">(</a><a id="3323" href="Axiom.Set.Map.html#10460" class="Function">mapFromPartialFun</a> <a id="3341" class="Symbol">(λ</a> <a id="3344" class="Symbol">(</a><a id="3345" href="Ledger.Conway.Conformance.Epoch.html#3345" class="Bound">gaid</a> <a id="3350" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3352" class="Symbol">_)</a> <a id="3355" class="Symbol">→</a> <a id="3357" href="Axiom.Set.Map.html#13670" class="Function">lookupᵐ?</a> <a id="3366" href="Ledger.Conway.Conformance.Epoch.html#3240" class="Bound">ds</a> <a id="3369" class="Symbol">(</a><a id="3370" href="Ledger.Conway.Specification.Certs.html#538" class="InductiveConstructor">GovActionDeposit</a> <a id="3387" href="Ledger.Conway.Conformance.Epoch.html#3345" class="Bound">gaid</a><a id="3391" class="Symbol">))</a> <a id="3394" href="Ledger.Conway.Conformance.Epoch.html#3410" class="Function">govSt&#39;</a><a id="3400" class="Symbol">)</a>
  <a id="3404" class="Keyword">where</a> <a id="3410" href="Ledger.Conway.Conformance.Epoch.html#3410" class="Function">govSt&#39;</a> <a id="3417" class="Symbol">=</a> <a id="3419" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="3430" href="Ledger.Conway.Specification.Gov.Actions.html#2811" class="Field">returnAddr</a><a id="3440" class="Symbol">)</a> <a id="3442" class="Symbol">(</a><a id="3443" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="3452" href="Ledger.Conway.Conformance.Epoch.html#3234" class="Bound">govSt</a><a id="3457" class="Symbol">)</a>


<a id="3461" class="Keyword">opaque</a>

  <a id="mkStakeDistrs"></a><a id="3471" href="Ledger.Conway.Conformance.Epoch.html#3471" class="Function">mkStakeDistrs</a> <a id="3485" class="Symbol">:</a> <a id="3487" href="Ledger.Conway.Conformance.Epoch.html#917" class="Record">Snapshot</a> <a id="3496" class="Symbol">→</a> <a id="3498" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="3507" class="Symbol">→</a> <a id="3509" href="Ledger.Conway.Specification.Certs.html#590" class="Function">Deposits</a> <a id="3518" class="Symbol">→</a> <a id="3520" class="Symbol">(</a><a id="3521" href="Ledger.Core.Specification.Address.html#260" class="Datatype">Credential</a> <a id="3532" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3534" href="Ledger.Conway.Specification.Gov.Actions.html#452" class="Datatype">VDeleg</a><a id="3540" class="Symbol">)</a> <a id="3542" class="Symbol">→</a> <a id="3544" href="Ledger.Conway.Specification.Ratify.html#3013" class="Record">StakeDistrs</a>
  <a id="3558" href="Ledger.Conway.Conformance.Epoch.html#3471" class="Function">mkStakeDistrs</a> <a id="3572" href="Ledger.Conway.Conformance.Epoch.html#3572" class="Bound">ss</a> <a id="3575" href="Ledger.Conway.Conformance.Epoch.html#3575" class="Bound">govSt</a> <a id="3581" href="Ledger.Conway.Conformance.Epoch.html#3581" class="Bound">ds</a> <a id="3584" href="Ledger.Conway.Conformance.Epoch.html#3584" class="Bound">delegations</a> <a id="3596" class="Symbol">.</a><a id="3597" href="Ledger.Conway.Specification.Ratify.html#3050" class="Field">StakeDistrs.stakeDistr</a> <a id="3620" class="Symbol">=</a>
    <a id="3626" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a> <a id="3638" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="3640" href="Ledger.Conway.Conformance.Epoch.html#3584" class="Bound">delegations</a> <a id="3652" href="Ledger.Prelude.html#2302" class="Function Operator">∣</a> <a id="3654" class="Symbol">(</a><a id="3655" href="Ledger.Conway.Conformance.Epoch.html#950" class="Field">Snapshot.stake</a> <a id="3670" href="Ledger.Conway.Conformance.Epoch.html#3572" class="Bound">ss</a> <a id="3673" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="3676" href="Ledger.Conway.Conformance.Epoch.html#3162" class="Function">gaDepositStake</a> <a id="3691" href="Ledger.Conway.Conformance.Epoch.html#3575" class="Bound">govSt</a> <a id="3697" href="Ledger.Conway.Conformance.Epoch.html#3581" class="Bound">ds</a><a id="3699" class="Symbol">)</a>

<a id="3702" class="Keyword">private</a> <a id="3710" class="Keyword">variable</a>
  <a id="3721" href="Ledger.Conway.Conformance.Epoch.html#3721" class="Generalizable">nes</a> <a id="3725" href="Ledger.Conway.Conformance.Epoch.html#3725" class="Generalizable">nes&#39;</a> <a id="3730" class="Symbol">:</a> <a id="3732" href="Ledger.Conway.Conformance.Epoch.html#1363" class="Record">NewEpochState</a>
  <a id="3748" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="3750" href="Ledger.Conway.Conformance.Epoch.html#3750" class="Generalizable">lastEpoch</a> <a id="3760" class="Symbol">:</a> <a id="3762" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
  <a id="3770" href="Ledger.Conway.Conformance.Epoch.html#3770" class="Generalizable">fut</a> <a id="3774" href="Ledger.Conway.Conformance.Epoch.html#3774" class="Generalizable">fut&#39;</a> <a id="3779" class="Symbol">:</a> <a id="3781" href="Ledger.Conway.Specification.Ratify.html#3383" class="Record">RatifyState</a>
  <a id="3795" href="Ledger.Conway.Conformance.Epoch.html#3795" class="Generalizable">eps</a> <a id="3799" href="Ledger.Conway.Conformance.Epoch.html#3799" class="Generalizable">eps&#39;</a> <a id="3804" href="Ledger.Conway.Conformance.Epoch.html#3804" class="Generalizable">eps&#39;&#39;</a> <a id="3810" class="Symbol">:</a> <a id="3812" href="Ledger.Conway.Conformance.Epoch.html#1165" class="Record">EpochState</a>
  <a id="3825" href="Ledger.Conway.Conformance.Epoch.html#3825" class="Generalizable">ls</a> <a id="3828" class="Symbol">:</a> <a id="3830" href="Ledger.Conway.Conformance.Ledger.html#779" class="Record">LState</a>
  <a id="3839" href="Ledger.Conway.Conformance.Epoch.html#3839" class="Generalizable">acnt</a> <a id="3844" class="Symbol">:</a> <a id="3846" href="Ledger.Conway.Specification.PParams.html#720" class="Record">Acnt</a>
  <a id="3853" href="Ledger.Conway.Conformance.Epoch.html#3853" class="Generalizable">es₀</a> <a id="3857" class="Symbol">:</a> <a id="3859" href="Ledger.Conway.Specification.Enact.html#444" class="Record">EnactState</a>
  <a id="3872" href="Ledger.Conway.Conformance.Epoch.html#3872" class="Generalizable">mark</a> <a id="3877" href="Ledger.Conway.Conformance.Epoch.html#3877" class="Generalizable">set</a> <a id="3881" href="Ledger.Conway.Conformance.Epoch.html#3881" class="Generalizable">go</a> <a id="3884" class="Symbol">:</a> <a id="3886" href="Ledger.Conway.Conformance.Epoch.html#917" class="Record">Snapshot</a>
  <a id="3897" href="Ledger.Conway.Conformance.Epoch.html#3897" class="Generalizable">feeSS</a> <a id="3903" class="Symbol">:</a> <a id="3905" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="3912" href="Ledger.Conway.Conformance.Epoch.html#3912" class="Generalizable">lstate</a> <a id="3919" class="Symbol">:</a> <a id="3921" href="Ledger.Conway.Conformance.Ledger.html#779" class="Record">LState</a>
  <a id="3930" href="Ledger.Conway.Conformance.Epoch.html#3930" class="Generalizable">ss</a> <a id="3933" href="Ledger.Conway.Conformance.Epoch.html#3933" class="Generalizable">ss&#39;</a> <a id="3937" class="Symbol">:</a> <a id="3939" href="Ledger.Conway.Conformance.Epoch.html#1075" class="Record">Snapshots</a>
  <a id="3951" href="Ledger.Conway.Conformance.Epoch.html#3951" class="Generalizable">ru</a> <a id="3954" class="Symbol">:</a> <a id="3956" href="Ledger.Conway.Conformance.Epoch.html#806" class="Record">RewardUpdate</a>
  <a id="3971" href="Ledger.Conway.Conformance.Epoch.html#3971" class="Generalizable">mru</a> <a id="3975" class="Symbol">:</a> <a id="3977" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3983" href="Ledger.Conway.Conformance.Epoch.html#806" class="Record">RewardUpdate</a>
  <a id="3998" href="Ledger.Conway.Conformance.Epoch.html#3998" class="Generalizable">certState&#39;</a> <a id="4009" class="Symbol">:</a> <a id="4011" href="Ledger.Conway.Conformance.Certs.html#970" class="Record">CertState</a>

<a id="4022" class="Keyword">data</a> <a id="_⊢_⇀⦇_,SNAP⦈_"></a><a id="4027" href="Ledger.Conway.Conformance.Epoch.html#4027" class="Datatype Operator">_⊢_⇀⦇_,SNAP⦈_</a> <a id="4041" class="Symbol">:</a> <a id="4043" href="Ledger.Conway.Conformance.Ledger.html#779" class="Record">LState</a> <a id="4050" class="Symbol">→</a> <a id="4052" href="Ledger.Conway.Conformance.Epoch.html#1075" class="Record">Snapshots</a> <a id="4062" class="Symbol">→</a> <a id="4064" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="4066" class="Symbol">→</a> <a id="4068" href="Ledger.Conway.Conformance.Epoch.html#1075" class="Record">Snapshots</a> <a id="4078" class="Symbol">→</a> <a id="4080" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4085" class="Keyword">where</a>
  <a id="_⊢_⇀⦇_,SNAP⦈_.SNAP"></a><a id="4093" href="Ledger.Conway.Conformance.Epoch.html#4093" class="InductiveConstructor">SNAP</a> <a id="4098" class="Symbol">:</a> <a id="4100" class="Keyword">let</a> <a id="4104" class="Keyword">open</a> <a id="4109" href="Ledger.Conway.Conformance.Ledger.html#779" class="Module">LState</a> <a id="4116" href="Ledger.Conway.Conformance.Epoch.html#3912" class="Generalizable">lstate</a><a id="4122" class="Symbol">;</a> <a id="4124" class="Keyword">open</a> <a id="4129" href="Ledger.Conway.Specification.Utxo.html#1474" class="Module">UTxOState</a> <a id="4139" href="Ledger.Conway.Conformance.Ledger.html#834" class="Function">utxoSt</a><a id="4145" class="Symbol">;</a> <a id="4147" class="Keyword">open</a> <a id="4152" href="Ledger.Conway.Conformance.Certs.html#970" class="Module">CertState</a> <a id="4162" href="Ledger.Conway.Conformance.Ledger.html#887" class="Function">certState</a>
             <a id="4185" href="Ledger.Conway.Conformance.Epoch.html#4185" class="Bound">stake</a> <a id="4191" class="Symbol">=</a> <a id="4193" href="Ledger.Conway.Conformance.Epoch.html#2871" class="Function">stakeDistr</a> <a id="4204" href="Ledger.Conway.Specification.Utxo.html#1538" class="Function">utxo</a> <a id="4209" href="Ledger.Conway.Conformance.Certs.html#1029" class="Function">dState</a> <a id="4216" href="Ledger.Conway.Conformance.Certs.html#1049" class="Function">pState</a>
    <a id="4227" class="Keyword">in</a>
    <a id="4234" href="Ledger.Conway.Conformance.Epoch.html#3912" class="Generalizable">lstate</a> <a id="4241" href="Ledger.Conway.Conformance.Epoch.html#4027" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#3872}{\htmlId{4245}{\htmlClass{Generalizable}{\text{mark}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3877}{\htmlId{4252}{\htmlClass{Generalizable}{\text{set}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3881}{\htmlId{4258}{\htmlClass{Generalizable}{\text{go}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3897}{\htmlId{4263}{\htmlClass{Generalizable}{\text{feeSS}}}}\, \end{pmatrix}$</a> <a id="4271" href="Ledger.Conway.Conformance.Epoch.html#4027" class="Datatype Operator">⇀⦇</a> <a id="4274" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="4277" href="Ledger.Conway.Conformance.Epoch.html#4027" class="Datatype Operator">,SNAP⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#4185}{\htmlId{4286}{\htmlClass{Bound}{\text{stake}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3872}{\htmlId{4294}{\htmlClass{Generalizable}{\text{mark}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3877}{\htmlId{4301}{\htmlClass{Generalizable}{\text{set}}}}\, \\ \,\href{Ledger.Conway.Specification.Utxo.html#1560}{\htmlId{4307}{\htmlClass{Function}{\text{fees}}}}\, \end{pmatrix}$</a>

<a id="4315" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="4320" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="4335" class="Symbol">:</a> <a id="4337" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="4339" class="Symbol">→</a> <a id="4341" href="Ledger.Conway.Conformance.Epoch.html#1165" class="Record">EpochState</a> <a id="4352" class="Symbol">→</a> <a id="4354" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a> <a id="4360" class="Symbol">→</a> <a id="4362" href="Ledger.Conway.Conformance.Epoch.html#1165" class="Record">EpochState</a> <a id="4373" class="Symbol">→</a> <a id="4375" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4380" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="4389" href="Ledger.Conway.Conformance.Epoch.html#4389" class="InductiveConstructor">EPOCH</a> <a id="4395" class="Symbol">:</a> <a id="4397" class="Keyword">let</a>
      <a id="4407" class="Keyword">open</a> <a id="4412" href="Ledger.Conway.Conformance.Ledger.html#779" class="Module">LState</a> <a id="4419" href="Ledger.Conway.Conformance.Epoch.html#3825" class="Generalizable">ls</a>
      <a id="4428" class="Keyword">open</a> <a id="4433" href="Ledger.Conway.Conformance.Certs.html#970" class="Module">CertState</a> <a id="4443" href="Ledger.Conway.Conformance.Ledger.html#887" class="Function">certState</a>
      <a id="4459" class="Keyword">open</a> <a id="4464" href="Ledger.Conway.Specification.Ratify.html#3383" class="Module">RatifyState</a> <a id="4476" href="Ledger.Conway.Conformance.Epoch.html#3770" class="Generalizable">fut</a>
      <a id="4486" class="Keyword">open</a> <a id="4491" href="Ledger.Conway.Specification.Utxo.html#1474" class="Module">UTxOState</a>
      <a id="4507" class="Keyword">open</a> <a id="4512" href="Ledger.Conway.Specification.Certs.html#3808" class="Module">PState</a><a id="4518" class="Symbol">;</a> <a id="4520" class="Keyword">open</a> <a id="4525" href="Ledger.Conway.Conformance.Certs.html#597" class="Module">DState</a><a id="4531" class="Symbol">;</a> <a id="4533" class="Keyword">open</a> <a id="4538" href="Ledger.Conway.Conformance.Certs.html#802" class="Module">GState</a>
      <a id="4551" class="Keyword">open</a> <a id="4556" href="Ledger.Conway.Specification.PParams.html#720" class="Module">Acnt</a><a id="4560" class="Symbol">;</a> <a id="4562" class="Keyword">open</a> <a id="4567" href="Ledger.Conway.Specification.Enact.html#444" class="Module">EnactState</a><a id="4577" class="Symbol">;</a> <a id="4579" class="Keyword">open</a> <a id="4584" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Module">GovActionState</a>


      <a id="4607" href="Ledger.Conway.Conformance.Epoch.html#4607" class="Bound">removedGovActions</a> <a id="4625" class="Symbol">=</a> <a id="4627" href="Function.Base.html#1638" class="Function">flip</a> <a id="4632" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a> <a id="4643" href="Ledger.Conway.Specification.Ratify.html#3453" class="Function">removed</a> <a id="4651" class="Symbol">λ</a> <a id="4653" class="Symbol">(</a><a id="4654" href="Ledger.Conway.Conformance.Epoch.html#4654" class="Bound">gaid</a> <a id="4659" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4661" href="Ledger.Conway.Conformance.Epoch.html#4661" class="Bound">gaSt</a><a id="4665" class="Symbol">)</a> <a id="4667" class="Symbol">→</a>
        <a id="4677" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4682" class="Symbol">(</a><a id="4683" href="Ledger.Conway.Specification.Gov.Actions.html#2811" class="Field">returnAddr</a> <a id="4694" href="Ledger.Conway.Conformance.Epoch.html#4661" class="Bound">gaSt</a> <a id="4699" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="4701" class="Symbol">)</a> <a id="4703" class="Symbol">((</a><a id="4705" href="Ledger.Conway.Conformance.Ledger.html#834" class="Function">utxoSt</a> <a id="4712" class="Symbol">.</a><a id="4713" href="Ledger.Conway.Specification.Utxo.html#1582" class="Field">deposits</a> <a id="4722" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="4724" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="4726" href="Ledger.Conway.Specification.Certs.html#538" class="InductiveConstructor">GovActionDeposit</a> <a id="4743" href="Ledger.Conway.Conformance.Epoch.html#4654" class="Bound">gaid</a> <a id="4748" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="4749" class="Symbol">)</a> <a id="4751" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="4752" class="Symbol">)</a>
      <a id="4760" href="Ledger.Conway.Conformance.Epoch.html#4760" class="Bound">govActionReturns</a> <a id="4777" class="Symbol">=</a> <a id="4779" href="Axiom.Set.Map.Dec.html#1932" class="Function">aggregate₊</a> <a id="4790" class="Symbol">(</a><a id="4791" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4796" class="Symbol">(λ</a> <a id="4799" class="Symbol">(</a><a id="4800" href="Ledger.Conway.Conformance.Epoch.html#4800" class="Bound">a</a> <a id="4802" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4804" class="Symbol">_</a> <a id="4806" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4808" href="Ledger.Conway.Conformance.Epoch.html#4808" class="Bound">d</a><a id="4809" class="Symbol">)</a> <a id="4811" class="Symbol">→</a> <a id="4813" href="Ledger.Conway.Conformance.Epoch.html#4800" class="Bound">a</a> <a id="4815" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4817" href="Ledger.Conway.Conformance.Epoch.html#4808" class="Bound">d</a><a id="4818" class="Symbol">)</a> <a id="4820" href="Ledger.Conway.Conformance.Epoch.html#4607" class="Bound">removedGovActions</a> <a id="4838" href="abstract-set-theory.FiniteSetTheory.html#2767" class="Function Operator">ᶠˢ</a><a id="4840" class="Symbol">)</a>

      <a id="4849" href="Ledger.Conway.Conformance.Epoch.html#4849" class="Bound">trWithdrawals</a>   <a id="4865" class="Symbol">=</a> <a id="4867" href="Ledger.Conway.Specification.Ratify.html#3420" class="Function">es</a> <a id="4870" class="Symbol">.</a><a id="4871" href="Ledger.Conway.Specification.Enact.html#696" class="Field">withdrawals</a>
      <a id="4889" href="Ledger.Conway.Conformance.Epoch.html#4889" class="Bound">totWithdrawals</a>  <a id="4905" class="Symbol">=</a> <a id="4907" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="4910" href="Ledger.Conway.Conformance.Epoch.html#4910" class="Bound">x</a> <a id="4912" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="4914" href="Ledger.Conway.Conformance.Epoch.html#4849" class="Bound">trWithdrawals</a> <a id="4928" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="4930" href="Ledger.Conway.Conformance.Epoch.html#4910" class="Bound">x</a>

      <a id="4939" href="Ledger.Conway.Conformance.Epoch.html#4939" class="Bound">es</a>         <a id="4950" class="Symbol">=</a> <a id="4952" class="Keyword">record</a> <a id="4959" href="Ledger.Conway.Specification.Ratify.html#3420" class="Function">es</a> <a id="4962" class="Symbol">{</a> <a id="4964" href="Ledger.Conway.Specification.Enact.html#696" class="Field">withdrawals</a> <a id="4976" class="Symbol">=</a> <a id="4978" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="4980" class="Symbol">}</a>
      <a id="4988" href="Ledger.Conway.Conformance.Epoch.html#4988" class="Bound">retired</a>    <a id="4999" class="Symbol">=</a> <a id="5001" class="Symbol">(</a><a id="5002" href="Ledger.Conway.Conformance.Certs.html#1049" class="Function">pState</a> <a id="5009" class="Symbol">.</a><a id="5010" href="Ledger.Conway.Specification.Certs.html#3882" class="Field">retiring</a><a id="5018" class="Symbol">)</a> <a id="5020" href="Axiom.Set.Map.html#14230" class="Function Operator">⁻¹</a> <a id="5023" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a>
      <a id="5031" href="Ledger.Conway.Conformance.Epoch.html#5031" class="Bound">payout</a>     <a id="5042" class="Symbol">=</a> <a id="5044" href="Ledger.Conway.Conformance.Epoch.html#4760" class="Bound">govActionReturns</a> <a id="5061" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="5064" href="Ledger.Conway.Conformance.Epoch.html#4849" class="Bound">trWithdrawals</a>
      <a id="5084" href="Ledger.Conway.Conformance.Epoch.html#5084" class="Bound">refunds</a>    <a id="5095" class="Symbol">=</a> <a id="5097" href="Axiom.Set.Map.html#13791" class="Function">pullbackMap</a> <a id="5109" href="Ledger.Conway.Conformance.Epoch.html#5031" class="Bound">payout</a> <a id="5116" href="Ledger.Conway.Conformance.Epoch.html#1943" class="Function">toRwdAddr</a> <a id="5126" class="Symbol">(</a><a id="5127" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5131" class="Symbol">(</a><a id="5132" href="Ledger.Conway.Conformance.Certs.html#1029" class="Function">dState</a> <a id="5139" class="Symbol">.</a><a id="5140" href="Ledger.Conway.Conformance.Certs.html#733" class="Field">rewards</a><a id="5147" class="Symbol">))</a>
      <a id="5156" href="Ledger.Conway.Conformance.Epoch.html#5156" class="Bound">unclaimed</a>  <a id="5167" class="Symbol">=</a> <a id="5169" href="Ledger.Prelude.HasCoin.html#170" class="Field">getCoin</a> <a id="5177" href="Ledger.Conway.Conformance.Epoch.html#5031" class="Bound">payout</a> <a id="5184" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="5186" href="Ledger.Prelude.HasCoin.html#170" class="Field">getCoin</a> <a id="5194" href="Ledger.Conway.Conformance.Epoch.html#5084" class="Bound">refunds</a>
      <a id="5208" href="Ledger.Conway.Conformance.Epoch.html#5208" class="Bound">vDeposits</a>  <a id="5219" class="Symbol">=</a> <a id="5221" href="Ledger.Conway.Conformance.Certs.html#1069" class="Function">gState</a> <a id="5228" class="Symbol">.</a><a id="5229" href="Ledger.Conway.Conformance.Certs.html#940" class="Field">deposits</a>

      <a id="5245" href="Ledger.Conway.Conformance.Epoch.html#5245" class="Bound">govSt&#39;</a> <a id="5252" class="Symbol">=</a> <a id="5254" href="Data.List.Base.html#10687" class="Function">filter</a> <a id="5261" class="Symbol">(λ</a> <a id="5264" href="Ledger.Conway.Conformance.Epoch.html#5264" class="Bound">x</a> <a id="5266" class="Symbol">→</a> <a id="5268" href="Class.Decidable.Core.html#461" class="Function Operator">¿</a> <a id="5270" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5276" href="Ledger.Conway.Conformance.Epoch.html#5264" class="Bound">x</a> <a id="5278" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="5280" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5285" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5291" href="Ledger.Conway.Specification.Ratify.html#3453" class="Function">removed</a> <a id="5299" href="Class.Decidable.Core.html#461" class="Function Operator">¿</a><a id="5300" class="Symbol">)</a> <a id="5302" href="Ledger.Conway.Conformance.Ledger.html#861" class="Function">govSt</a>

      <a id="5315" href="Ledger.Conway.Conformance.Epoch.html#5315" class="Bound">dState&#39;</a> <a id="5323" class="Symbol">:</a> <a id="5325" href="Ledger.Conway.Conformance.Certs.html#597" class="Record">DState</a>
      <a id="5338" href="Ledger.Conway.Conformance.Epoch.html#5315" class="Bound">dState&#39;</a> <a id="5346" class="Symbol">=</a> <a id="5348" class="Keyword">record</a> <a id="5355" href="Ledger.Conway.Conformance.Certs.html#1029" class="Function">dState</a> <a id="5362" class="Symbol">{</a> <a id="5364" href="Ledger.Conway.Conformance.Certs.html#733" class="Field">rewards</a> <a id="5372" class="Symbol">=</a> <a id="5374" href="Ledger.Conway.Conformance.Certs.html#1029" class="Function">dState</a> <a id="5381" class="Symbol">.</a><a id="5382" href="Ledger.Conway.Conformance.Certs.html#733" class="Field">rewards</a> <a id="5390" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="5393" href="Ledger.Conway.Conformance.Epoch.html#5084" class="Bound">refunds</a> <a id="5401" class="Symbol">}</a>

      <a id="5410" href="Ledger.Conway.Conformance.Epoch.html#5410" class="Bound">pState&#39;</a> <a id="5418" class="Symbol">:</a> <a id="5420" href="Ledger.Conway.Specification.Certs.html#3808" class="Record">PState</a>
      <a id="5433" href="Ledger.Conway.Conformance.Epoch.html#5410" class="Bound">pState&#39;</a> <a id="5441" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{5445}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Conformance.Certs.html#1049}{\htmlId{5446}{\htmlClass{Function}{\text{pState}}}}\, \,\htmlId{5453}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Certs.html#3840}{\htmlId{5454}{\htmlClass{Field}{\text{pools}}}}\,\,\htmlId{5459}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Axiom.Set.Map.html#10748}{\htmlId{5461}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#4988}{\htmlId{5463}{\htmlClass{Bound}{\text{retired}}}}\, \,\href{Axiom.Set.Map.html#10748}{\htmlId{5471}{\htmlClass{Function Operator}{\text{ᶜ}}}}\, \\ \,\htmlId{5475}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Conformance.Certs.html#1049}{\htmlId{5476}{\htmlClass{Function}{\text{pState}}}}\, \,\htmlId{5483}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Certs.html#3882}{\htmlId{5484}{\htmlClass{Field}{\text{retiring}}}}\,\,\htmlId{5492}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Axiom.Set.Map.html#10748}{\htmlId{5494}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#4988}{\htmlId{5496}{\htmlClass{Bound}{\text{retired}}}}\, \,\href{Axiom.Set.Map.html#10748}{\htmlId{5504}{\htmlClass{Function Operator}{\text{ᶜ}}}}\, \end{pmatrix}$</a>

      <a id="5515" href="Ledger.Conway.Conformance.Epoch.html#5515" class="Bound">gState&#39;</a> <a id="5523" class="Symbol">:</a> <a id="5525" href="Ledger.Conway.Conformance.Certs.html#802" class="Record">GState</a>
      <a id="5538" href="Ledger.Conway.Conformance.Epoch.html#5515" class="Bound">gState&#39;</a> <a id="5546" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\htmlId{5550}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Class.ToBool.html#389}{\htmlId{5551}{\htmlClass{Function Operator}{\text{if}}}}\, \,\href{Data.List.Base.html#4703}{\htmlId{5554}{\htmlClass{Function}{\text{null}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#5245}{\htmlId{5559}{\htmlClass{Bound}{\text{govSt&#39;}}}}\, \,\href{Class.ToBool.html#389}{\htmlId{5566}{\htmlClass{Function Operator}{\text{then}}}}\, \,\href{Axiom.Set.Map.html#6068}{\htmlId{5571}{\htmlClass{Function}{\text{mapValues}}}}\, \,\htmlId{5581}{\htmlClass{Symbol}{\text{(}}}\,\,\htmlId{5582}{\htmlClass{Number}{\text{1}}}\, \,\href{Class.HasAdd.Core.html#162}{\htmlId{5584}{\htmlClass{Field Operator}{\text{+\_}}}}\,\,\htmlId{5586}{\htmlClass{Symbol}{\text{)}}}\, \,\htmlId{5588}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Conformance.Certs.html#1069}{\htmlId{5589}{\htmlClass{Function}{\text{gState}}}}\, \,\htmlId{5596}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Conformance.Certs.html#857}{\htmlId{5597}{\htmlClass{Field}{\text{dreps}}}}\,\,\htmlId{5602}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Class.ToBool.html#389}{\htmlId{5604}{\htmlClass{Function Operator}{\text{else}}}}\, \,\htmlId{5609}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Conformance.Certs.html#1069}{\htmlId{5610}{\htmlClass{Function}{\text{gState}}}}\, \,\htmlId{5617}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Conformance.Certs.html#857}{\htmlId{5618}{\htmlClass{Field}{\text{dreps}}}}\,\,\htmlId{5623}{\htmlClass{Symbol}{\text{))}}}\,
                , \,\htmlId{5644}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Conformance.Certs.html#1069}{\htmlId{5645}{\htmlClass{Function}{\text{gState}}}}\, \,\htmlId{5652}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Conformance.Certs.html#893}{\htmlId{5653}{\htmlClass{Field}{\text{ccHotKeys}}}}\,\,\htmlId{5662}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Axiom.Set.Map.html#10678}{\htmlId{5664}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{Ledger.Conway.Specification.Enact.html#1241}{\htmlId{5666}{\htmlClass{Function}{\text{ccCreds}}}}\, \,\htmlId{5674}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Ledger.Conway.Conformance.Epoch.html#4939}{\htmlId{5675}{\htmlClass{Bound}{\text{es}}}}\, \,\htmlId{5678}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Enact.html#480}{\htmlId{5679}{\htmlClass{Field}{\text{cc}}}}\,\,\htmlId{5681}{\htmlClass{Symbol}{\text{)}}}\,
                , \,\href{Ledger.Conway.Conformance.Epoch.html#5208}{\htmlId{5701}{\htmlClass{Bound}{\text{vDeposits}}}}\,
                \end{pmatrix}$</a>

      <a id="5736" href="Ledger.Conway.Conformance.Epoch.html#5736" class="Bound">certState&#39;</a> <a id="5747" class="Symbol">:</a> <a id="5749" href="Ledger.Conway.Conformance.Certs.html#970" class="Record">CertState</a>
      <a id="5765" href="Ledger.Conway.Conformance.Epoch.html#5736" class="Bound">certState&#39;</a> <a id="5776" class="Symbol">=</a> <a id="5778" class="Keyword">record</a> <a id="5785" class="Symbol">{</a> <a id="5787" href="Ledger.Conway.Conformance.Certs.html#1029" class="Field">dState</a> <a id="5794" class="Symbol">=</a> <a id="5796" href="Ledger.Conway.Conformance.Epoch.html#5315" class="Bound">dState&#39;</a> <a id="5804" class="Symbol">;</a> <a id="5806" href="Ledger.Conway.Conformance.Certs.html#1049" class="Field">pState</a> <a id="5813" class="Symbol">=</a> <a id="5815" href="Ledger.Conway.Conformance.Epoch.html#5410" class="Bound">pState&#39;</a> <a id="5823" class="Symbol">;</a> <a id="5825" href="Ledger.Conway.Conformance.Certs.html#1069" class="Field">gState</a> <a id="5832" class="Symbol">=</a> <a id="5834" href="Ledger.Conway.Conformance.Epoch.html#5515" class="Bound">gState&#39;</a> <a id="5842" class="Symbol">}</a>

      <a id="5851" href="Ledger.Conway.Conformance.Epoch.html#5851" class="Bound">utxoSt&#39;</a> <a id="5859" class="Symbol">=</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Ledger.html#834}{\htmlId{5863}{\htmlClass{Function}{\text{utxoSt}}}}\, \,\htmlId{5870}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Utxo.html#1538}{\htmlId{5871}{\htmlClass{Field}{\text{utxo}}}}\, \\ \,\href{Ledger.Conway.Conformance.Ledger.html#834}{\htmlId{5878}{\htmlClass{Function}{\text{utxoSt}}}}\, \,\htmlId{5885}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Utxo.html#1560}{\htmlId{5886}{\htmlClass{Field}{\text{fees}}}}\, \\ \,\href{Ledger.Conway.Conformance.Ledger.html#834}{\htmlId{5893}{\htmlClass{Function}{\text{utxoSt}}}}\, \,\htmlId{5900}{\htmlClass{Symbol}{\text{.}}}\,\,\href{Ledger.Conway.Specification.Utxo.html#1582}{\htmlId{5901}{\htmlClass{Field}{\text{deposits}}}}\, \,\href{Axiom.Set.Map.html#10748}{\htmlId{5910}{\htmlClass{Function Operator}{\text{∣}}}}\, \,\href{abstract-set-theory.FiniteSetTheory.html#519}{\htmlId{5912}{\htmlClass{Function}{\text{mapˢ}}}}\, \,\htmlId{5917}{\htmlClass{Symbol}{\text{(}}}\,\,\href{Data.Product.Base.html#636}{\htmlId{5918}{\htmlClass{Field}{\text{proj₁}}}}\, \,\href{Function.Base.html#1115}{\htmlId{5924}{\htmlClass{Function Operator}{\text{∘}}}}\, \,\href{Data.Product.Base.html#650}{\htmlId{5926}{\htmlClass{Field}{\text{proj₂}}}}\,\,\htmlId{5931}{\htmlClass{Symbol}{\text{)}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#4607}{\htmlId{5933}{\htmlClass{Bound}{\text{removedGovActions}}}}\, \,\href{Axiom.Set.Map.html#10748}{\htmlId{5951}{\htmlClass{Function Operator}{\text{ᶜ}}}}\, \\ \,\htmlId{5955}{\htmlClass{Number}{\text{0}}}\, \end{pmatrix}$</a>

      <a id="5966" href="Ledger.Conway.Conformance.Epoch.html#5966" class="Bound">acnt&#39;</a> <a id="5972" class="Symbol">=</a> <a id="5974" class="Keyword">record</a> <a id="5981" href="Ledger.Conway.Conformance.Epoch.html#3839" class="Generalizable">acnt</a>
        <a id="5994" class="Symbol">{</a> <a id="5996" href="Ledger.Conway.Specification.PParams.html#775" class="Field">treasury</a>  <a id="6006" class="Symbol">=</a> <a id="6008" href="Ledger.Conway.Conformance.Epoch.html#3839" class="Generalizable">acnt</a> <a id="6013" class="Symbol">.</a><a id="6014" href="Ledger.Conway.Specification.PParams.html#775" class="Field">treasury</a> <a id="6023" href="Data.Nat.Base.html#4462" class="Primitive Operator">∸</a> <a id="6025" href="Ledger.Conway.Conformance.Epoch.html#4889" class="Bound">totWithdrawals</a> <a id="6040" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6042" href="Ledger.Conway.Conformance.Ledger.html#834" class="Function">utxoSt</a> <a id="6049" class="Symbol">.</a><a id="6050" href="Ledger.Conway.Specification.Utxo.html#1608" class="Field">donations</a> <a id="6060" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6062" href="Ledger.Conway.Conformance.Epoch.html#5156" class="Bound">unclaimed</a> <a id="6072" class="Symbol">}</a>
    <a id="6078" class="Keyword">in</a>
    <a id="6085" class="Keyword">record</a> <a id="6092" class="Symbol">{</a> <a id="6094" href="Ledger.Conway.Specification.Ratify.html#3153" class="Field">currentEpoch</a> <a id="6107" class="Symbol">=</a> <a id="6109" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a>
           <a id="6122" class="Symbol">;</a> <a id="6124" href="Ledger.Conway.Specification.Ratify.html#3121" class="Field">stakeDistrs</a> <a id="6136" class="Symbol">=</a> <a id="6138" href="Ledger.Conway.Conformance.Epoch.html#3471" class="Function">mkStakeDistrs</a>  <a id="6153" class="Symbol">(</a><a id="6154" href="Ledger.Conway.Conformance.Epoch.html#1109" class="Field">Snapshots.mark</a> <a id="6169" href="Ledger.Conway.Conformance.Epoch.html#3933" class="Generalizable">ss&#39;</a><a id="6172" class="Symbol">)</a> <a id="6174" href="Ledger.Conway.Conformance.Epoch.html#5245" class="Bound">govSt&#39;</a>
                                          <a id="6223" class="Symbol">(</a><a id="6224" href="Ledger.Conway.Conformance.Epoch.html#5851" class="Bound">utxoSt&#39;</a> <a id="6232" class="Symbol">.</a><a id="6233" href="Ledger.Conway.Specification.Utxo.html#1582" class="Field">deposits</a><a id="6241" class="Symbol">)</a> <a id="6243" class="Symbol">(</a><a id="6244" href="Ledger.Conway.Conformance.Certs.html#654" class="Field">voteDelegs</a> <a id="6255" href="Ledger.Conway.Conformance.Certs.html#1029" class="Function">dState</a><a id="6261" class="Symbol">)</a>
           <a id="6274" class="Symbol">;</a> <a id="6276" href="Ledger.Conway.Specification.Ratify.html#3268" class="Field">treasury</a> <a id="6285" class="Symbol">=</a> <a id="6287" href="Ledger.Conway.Conformance.Epoch.html#3839" class="Generalizable">acnt</a> <a id="6292" class="Symbol">.</a><a id="6293" href="Ledger.Conway.Specification.PParams.html#775" class="Field">treasury</a> <a id="6302" class="Symbol">;</a> <a id="6304" href="Ledger.Conway.Conformance.Epoch.html#6304" class="Module">GState</a> <a id="6311" href="Ledger.Conway.Conformance.Certs.html#1069" class="Function">gState</a>
           <a id="6329" class="Symbol">;</a> <a id="6331" href="Ledger.Conway.Specification.Ratify.html#3293" class="Field">pools</a> <a id="6337" class="Symbol">=</a> <a id="6339" href="Ledger.Conway.Conformance.Certs.html#1049" class="Function">pState</a> <a id="6346" class="Symbol">.</a><a id="6347" href="Ledger.Conway.Specification.Certs.html#3840" class="Field">pools</a> <a id="6353" class="Symbol">;</a> <a id="6355" href="Ledger.Conway.Specification.Ratify.html#3339" class="Field">delegatees</a> <a id="6366" class="Symbol">=</a> <a id="6368" href="Ledger.Conway.Conformance.Certs.html#1029" class="Function">dState</a> <a id="6375" class="Symbol">.</a><a id="6376" href="Ledger.Conway.Conformance.Certs.html#654" class="Field">voteDelegs</a> <a id="6387" class="Symbol">}</a>
        <a id="6397" href="Ledger.Conway.Specification.Ratify.html#11181" class="Function Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#4939}{\htmlId{6401}{\htmlClass{Bound}{\text{es}}}}\, \\ \,\href{Class.HasEmptySet.html#287}{\htmlId{6406}{\htmlClass{Field}{\text{∅}}}}\, \\ \,\href{Agda.Builtin.Bool.html#192}{\htmlId{6410}{\htmlClass{InductiveConstructor}{\text{false}}}}\, \end{pmatrix}$</a> <a id="6418" href="Ledger.Conway.Specification.Ratify.html#11181" class="Function Operator">⇀⦇</a> <a id="6421" href="Ledger.Conway.Conformance.Epoch.html#5245" class="Bound">govSt&#39;</a> <a id="6428" href="Ledger.Conway.Specification.Ratify.html#11181" class="Function Operator">,RATIFIES⦈</a> <a id="6439" href="Ledger.Conway.Conformance.Epoch.html#3774" class="Generalizable">fut&#39;</a>
      <a id="6450" class="Symbol">→</a> <a id="6452" href="Ledger.Conway.Conformance.Epoch.html#3825" class="Generalizable">ls</a> <a id="6455" href="Ledger.Conway.Conformance.Epoch.html#4027" class="Datatype Operator">⊢</a> <a id="6457" href="Ledger.Conway.Conformance.Epoch.html#3930" class="Generalizable">ss</a> <a id="6460" href="Ledger.Conway.Conformance.Epoch.html#4027" class="Datatype Operator">⇀⦇</a> <a id="6463" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="6466" href="Ledger.Conway.Conformance.Epoch.html#4027" class="Datatype Operator">,SNAP⦈</a> <a id="6473" href="Ledger.Conway.Conformance.Epoch.html#3933" class="Generalizable">ss&#39;</a>
    <a id="6481" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
    <a id="6518" class="Symbol">_</a> <a id="6520" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#3839}{\htmlId{6524}{\htmlClass{Generalizable}{\text{acnt}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3930}{\htmlId{6531}{\htmlClass{Generalizable}{\text{ss}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3825}{\htmlId{6536}{\htmlClass{Generalizable}{\text{ls}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3853}{\htmlId{6541}{\htmlClass{Generalizable}{\text{es₀}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3770}{\htmlId{6547}{\htmlClass{Generalizable}{\text{fut}}}}\, \end{pmatrix}$</a> <a id="6553" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">⇀⦇</a> <a id="6556" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="6558" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">,EPOCH⦈</a>
        <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#5966}{\htmlId{6576}{\htmlClass{Bound}{\text{acnt&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3933}{\htmlId{6584}{\htmlClass{Generalizable}{\text{ss&#39;}}}}\, \\ \begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#5851}{\htmlId{6592}{\htmlClass{Bound}{\text{utxoSt&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#5245}{\htmlId{6602}{\htmlClass{Bound}{\text{govSt&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#5736}{\htmlId{6611}{\htmlClass{Bound}{\text{certState&#39;}}}}\, \end{pmatrix} \\ \,\href{Ledger.Conway.Conformance.Epoch.html#4939}{\htmlId{6626}{\htmlClass{Bound}{\text{es}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3774}{\htmlId{6631}{\htmlClass{Generalizable}{\text{fut&#39;}}}}\, \end{pmatrix}$</a>

<a id="6639" class="Keyword">data</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="6647" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="6665" class="Symbol">:</a> <a id="6667" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="6669" class="Symbol">→</a> <a id="6671" href="Ledger.Conway.Conformance.Epoch.html#1363" class="Record">NewEpochState</a> <a id="6685" class="Symbol">→</a> <a id="6687" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a> <a id="6693" class="Symbol">→</a> <a id="6695" href="Ledger.Conway.Conformance.Epoch.html#1363" class="Record">NewEpochState</a> <a id="6709" class="Symbol">→</a> <a id="6711" href="Agda.Primitive.html#388" class="Primitive">Type</a>

  <a id="6719" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="6728" href="Ledger.Conway.Conformance.Epoch.html#6728" class="InductiveConstructor">NEWEPOCH-New</a> <a id="6741" class="Symbol">:</a> <a id="6743" class="Keyword">let</a>
      <a id="6753" href="Ledger.Conway.Conformance.Epoch.html#6753" class="Bound">eps&#39;</a> <a id="6758" class="Symbol">=</a> <a id="6760" href="Ledger.Conway.Conformance.Epoch.html#2181" class="Function">applyRUpd</a> <a id="6770" href="Ledger.Conway.Conformance.Epoch.html#3951" class="Generalizable">ru</a> <a id="6773" href="Ledger.Conway.Conformance.Epoch.html#3795" class="Generalizable">eps</a>
    <a id="6781" class="Keyword">in</a>
    <a id="6788" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="6790" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="6792" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6794" href="Ledger.Conway.Conformance.Epoch.html#3750" class="Generalizable">lastEpoch</a> <a id="6804" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="6806" class="Number">1</a>
    <a id="6812" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">∙</a> <a id="6814" class="Symbol">_</a> <a id="6816" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">⊢</a> <a id="6818" href="Ledger.Conway.Conformance.Epoch.html#6753" class="Bound">eps&#39;</a> <a id="6823" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">⇀⦇</a> <a id="6826" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="6828" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">,EPOCH⦈</a> <a id="6836" href="Ledger.Conway.Conformance.Epoch.html#3804" class="Generalizable">eps&#39;&#39;</a>
      <a id="6848" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="6887" class="Symbol">_</a> <a id="6889" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#3750}{\htmlId{6893}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3795}{\htmlId{6905}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#173}{\htmlId{6911}{\htmlClass{InductiveConstructor}{\text{just}}}}\, \,\href{Ledger.Conway.Conformance.Epoch.html#3951}{\htmlId{6916}{\htmlClass{Generalizable}{\text{ru}}}}\, \end{pmatrix}$</a> <a id="6921" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">⇀⦇</a> <a id="6924" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="6926" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#3748}{\htmlId{6939}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3804}{\htmlId{6943}{\htmlClass{Generalizable}{\text{eps&#39;&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{6951}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="6964" href="Ledger.Conway.Conformance.Epoch.html#6964" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="6981" class="Symbol">:</a>
    <a id="6987" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="6989" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="6991" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="6993" href="Ledger.Conway.Conformance.Epoch.html#3750" class="Generalizable">lastEpoch</a> <a id="7003" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="7005" class="Number">1</a>
      <a id="7013" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="7052" class="Symbol">_</a> <a id="7054" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#3750}{\htmlId{7058}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3795}{\htmlId{7070}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3971}{\htmlId{7076}{\htmlClass{Generalizable}{\text{mru}}}}\, \end{pmatrix}$</a> <a id="7082" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">⇀⦇</a> <a id="7085" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="7087" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#3750}{\htmlId{7100}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3795}{\htmlId{7112}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3971}{\htmlId{7118}{\htmlClass{Generalizable}{\text{mru}}}}\, \end{pmatrix}$</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="7127" href="Ledger.Conway.Conformance.Epoch.html#7127" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="7153" class="Symbol">:</a>
    <a id="7159" href="Prelude.InferenceRules.html#56074" class="Function Operator">∙</a> <a id="7161" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="7163" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7165" href="Ledger.Conway.Conformance.Epoch.html#3750" class="Generalizable">lastEpoch</a> <a id="7175" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="7177" class="Number">1</a>
    <a id="7183" href="iog-prelude.Prelude.InferenceRules.html#583" class="Function Operator">∙</a> <a id="7185" class="Symbol">_</a> <a id="7187" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">⊢</a> <a id="7189" href="Ledger.Conway.Conformance.Epoch.html#3795" class="Generalizable">eps</a> <a id="7193" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">⇀⦇</a> <a id="7196" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="7198" href="Ledger.Conway.Conformance.Epoch.html#4320" class="Datatype Operator">,EPOCH⦈</a> <a id="7206" href="Ledger.Conway.Conformance.Epoch.html#3799" class="Generalizable">eps&#39;</a>
      <a id="7217" href="iog-prelude.Prelude.InferenceRules.html#217" class="Function Operator">────────────────────────────────</a>
      <a id="7256" class="Symbol">_</a> <a id="7258" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">⊢</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#3750}{\htmlId{7262}{\htmlClass{Generalizable}{\text{lastEpoch}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3795}{\htmlId{7274}{\htmlClass{Generalizable}{\text{eps}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{7280}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \end{pmatrix}$</a> <a id="7290" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">⇀⦇</a> <a id="7293" href="Ledger.Conway.Conformance.Epoch.html#3748" class="Generalizable">e</a> <a id="7295" href="Ledger.Conway.Conformance.Epoch.html#6647" class="Datatype Operator">,NEWEPOCH⦈</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Epoch.html#3748}{\htmlId{7308}{\htmlClass{Generalizable}{\text{e}}}}\, \\ \,\href{Ledger.Conway.Conformance.Epoch.html#3799}{\htmlId{7312}{\htmlClass{Generalizable}{\text{eps&#39;}}}}\, \\ \,\href{Agda.Builtin.Maybe.html#194}{\htmlId{7319}{\htmlClass{InductiveConstructor}{\text{nothing}}}}\, \end{pmatrix}$</a>
</pre></body></html>