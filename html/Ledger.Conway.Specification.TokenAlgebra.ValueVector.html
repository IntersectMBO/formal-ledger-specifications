<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.TokenAlgebra.ValueVector</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>
<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="52" class="Keyword">hiding</a> <a id="59" class="Symbol">(</a><a id="60" href="Prelude.InferenceRules.html#56006" class="Function Operator">_∙_</a><a id="63" class="Symbol">;</a> <a id="65" href="Class.Monoid.Core.html#225" class="Field">ε</a><a id="66" class="Symbol">)</a>

<a id="69" class="Keyword">module</a> <a id="76" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html" class="Module">Ledger.Conway.Specification.TokenAlgebra.ValueVector</a> <a id="129" class="Symbol">(</a><a id="130" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#130" class="Bound">PolicyId</a> <a id="139" class="Symbol">:</a> <a id="141" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="145" class="Symbol">)</a> <a id="147" class="Symbol">(</a><a id="148" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#148" class="Bound">n</a> <a id="150" class="Symbol">:</a> <a id="152" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="153" class="Symbol">)</a> <a id="155" class="Keyword">where</a>

<a id="162" class="Keyword">import</a> <a id="169" href="Algebra.html" class="Module">Algebra</a> <a id="177" class="Symbol">as</a> <a id="180" class="Module">Alg</a>
<a id="184" class="Keyword">open</a> <a id="189" class="Keyword">import</a> <a id="196" href="Algebra.Construct.DirectProduct.html" class="Module">Algebra.Construct.DirectProduct</a>
<a id="228" class="Keyword">open</a> <a id="233" class="Keyword">import</a> <a id="240" href="stdlib.Algebra.Morphism.Construct.DirectProduct.html" class="Module">stdlib.Algebra.Morphism.Construct.DirectProduct</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="320" class="Keyword">using</a> <a id="326" class="Symbol">(</a><a id="327" href="Data.Nat.Properties.html#17645" class="Function">+-0-commutativeMonoid</a><a id="348" class="Symbol">)</a>
<a id="350" class="Keyword">import</a> <a id="357" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html" class="Module">Data.Product.Relation.Binary.Pointwise.NonDependent</a> <a id="409" class="Symbol">as</a> <a id="412" class="Module">Product</a>
<a id="420" class="Keyword">open</a> <a id="425" class="Keyword">import</a> <a id="432" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="441" class="Symbol">as</a> <a id="444" class="Module">Vec</a>
  <a id="450" class="Keyword">hiding</a> <a id="457" class="Symbol">(</a><a id="458" href="Data.Vec.Base.html#8496" class="Function">fromList</a><a id="466" class="Symbol">)</a>
<a id="468" class="Keyword">import</a> <a id="475" href="stdlib.Data.Vec.Instances.html" class="Module">stdlib.Data.Vec.Instances</a> <a id="501" class="Symbol">as</a> <a id="504" class="Module">Vec</a>
<a id="508" class="Keyword">import</a> <a id="515" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Binary.Pointwise.Inductive</a> <a id="560" class="Symbol">as</a> <a id="563" class="Module">Vec</a>

<a id="568" class="Keyword">open</a> <a id="573" class="Keyword">import</a> <a id="580" href="Ledger.Conway.Specification.TokenAlgebra.Base.html" class="Module">Ledger.Conway.Specification.TokenAlgebra.Base</a> <a id="626" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#130" class="Bound">PolicyId</a>

<a id="Quantity"></a><a id="636" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#636" class="Function">Quantity</a> <a id="645" class="Symbol">=</a> <a id="647" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>

<a id="Vec-commutativeMonoid"></a><a id="650" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#650" class="Function">Vec-commutativeMonoid</a> <a id="672" class="Symbol">=</a> <a id="674" href="stdlib.Data.Vec.Instances.html#2075" class="Function">Vec.commutativeMonoid</a> <a id="696" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#148" class="Bound">n</a> <a id="698" href="Data.Nat.Properties.html#17645" class="Function">+-0-commutativeMonoid</a>

<a id="721" class="Keyword">module</a> <a id="+-0-commutativeMonoid"></a><a id="728" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#728" class="Module">+-0-commutativeMonoid</a> <a id="750" class="Symbol">=</a> <a id="752" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="774" href="Data.Nat.Properties.html#17645" class="Function">+-0-commutativeMonoid</a>
<a id="796" class="Keyword">module</a> <a id="Vec-commutativeMonoid"></a><a id="803" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#803" class="Module">Vec-commutativeMonoid</a> <a id="825" class="Symbol">=</a> <a id="827" href="Algebra.Bundles.html#7886" class="Module">Alg.CommutativeMonoid</a> <a id="849" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#650" class="Function">Vec-commutativeMonoid</a>

<a id="872" class="Keyword">module</a> <a id="879" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#879" class="Module">_</a> <a id="881" class="Symbol">(</a><a id="882" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#882" class="Bound">Policies</a> <a id="891" class="Symbol">:</a> <a id="893" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="897" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#130" class="Bound">PolicyId</a> <a id="906" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#148" class="Bound">n</a><a id="907" class="Symbol">)</a> <a id="909" class="Keyword">where</a>
  <a id="917" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#917" class="Function">Value-TokenAlgebra</a> <a id="936" class="Symbol">:</a> <a id="938" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#478" class="Record">TokenAlgebra</a>
  <a id="953" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#917" class="Function">Value-TokenAlgebra</a> <a id="972" class="Symbol">=</a> <a id="974" class="Keyword">record</a> <a id="981" class="Symbol">{</a><a id="982" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1009" class="Module">go</a><a id="984" class="Symbol">}</a>
    <a id="990" class="Keyword">where</a>
      <a id="1002" class="Keyword">module</a> <a id="1009" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1009" class="Module">go</a> <a id="1012" class="Keyword">where</a>
        <a id="1026" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1026" class="Function">Value</a> <a id="1032" class="Symbol">:</a> <a id="1034" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="1047" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1026" class="Function">Value</a> <a id="1053" class="Symbol">=</a> <a id="1055" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a> <a id="1060" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1062" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="1066" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#636" class="Function">Quantity</a> <a id="1075" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#148" class="Bound">n</a>

        <a id="1086" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1086" class="Function">Value-CommutativeMonoid</a> <a id="1110" class="Symbol">:</a> <a id="1112" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="1130" href="Level.html#521" class="Function">0ℓ</a> <a id="1133" href="Level.html#521" class="Function">0ℓ</a> <a id="1136" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1026" class="Function">Value</a>
        <a id="1150" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1086" class="Function">Value-CommutativeMonoid</a> <a id="1174" class="Symbol">=</a> <a id="1176" href="Class.CommutativeMonoid.Core.html#639" class="Function">Conversion.fromBundle</a> <a id="1198" class="Symbol">(</a><a id="1199" href="Algebra.Construct.DirectProduct.html#7719" class="Function">commutativeMonoid</a> <a id="1217" href="Data.Nat.Properties.html#17645" class="Function">+-0-commutativeMonoid</a> <a id="1239" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#650" class="Function">Vec-commutativeMonoid</a><a id="1260" class="Symbol">)</a>

        <a id="1271" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1271" class="Function">coin</a> <a id="1276" class="Symbol">:</a> <a id="1278" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1026" class="Function">Value</a> <a id="1284" class="Symbol">→</a> <a id="1286" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
        <a id="1299" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1271" class="Function">coin</a> <a id="1304" class="Symbol">=</a> <a id="1306" href="Data.Product.Base.html#636" class="Field">proj₁</a>

        <a id="1321" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1321" class="Function">inject</a> <a id="1328" class="Symbol">:</a> <a id="1330" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a> <a id="1335" class="Symbol">→</a> <a id="1337" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1026" class="Function">Value</a>
        <a id="1351" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1321" class="Function">inject</a> <a id="1358" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1358" class="Bound">c</a> <a id="1360" class="Symbol">=</a> <a id="1362" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1358" class="Bound">c</a> <a id="1364" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1366" href="Data.Vec.Base.html#6493" class="Function">Vec.replicate</a> <a id="1380" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#148" class="Bound">n</a> <a id="1382" class="Number">0</a>

        <a id="1393" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1393" class="Function">policies</a>                   <a id="1420" class="Symbol">=</a> <a id="1422" class="Symbol">λ</a> <a id="1424" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1424" class="Bound">_</a> <a id="1426" class="Symbol">→</a> <a id="1428" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1437" class="Symbol">(</a><a id="1438" href="Data.Vec.Base.html#8402" class="Function">toList</a> <a id="1445" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#882" class="Bound">Policies</a><a id="1453" class="Symbol">)</a>
        <a id="1463" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1463" class="Function">size</a>                       <a id="1490" class="Symbol">=</a> <a id="1492" class="Symbol">λ</a> <a id="1494" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1494" class="Bound">_</a> <a id="1496" class="Symbol">→</a> <a id="1498" class="Number">1</a> <a id="1500" href="Class.HasAdd.Core.html#162" class="Field Operator">+</a> <a id="1502" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#148" class="Bound">n</a>
        <a id="1512" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1512" class="Function Operator">_≤ᵗ_</a>                       <a id="1539" class="Symbol">=</a> <a id="1541" href="Data.Product.Relation.Binary.Pointwise.NonDependent.html#1147" class="Function">Product.Pointwise</a> <a id="1559" href="Class.HasOrder.Core.html#613" class="Field Operator">_≤_</a> <a id="1563" class="Symbol">(</a><a id="1564" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#1552" class="Datatype">Vec.Pointwise</a> <a id="1578" href="Class.HasOrder.Core.html#613" class="Field Operator">_≤_</a><a id="1581" class="Symbol">)</a>

        <a id="1592" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1592" class="Function">coin∘inject≗id</a>             <a id="1619" class="Symbol">=</a> <a id="1621" class="Symbol">λ</a> <a id="1623" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1623" class="Bound">_</a> <a id="1625" class="Symbol">→</a> <a id="1627" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
        <a id="1640" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1640" class="Function">coinIsMonoidHomomorphism</a>   <a id="1667" class="Symbol">=</a> <a id="1669" href="stdlib.Algebra.Morphism.Construct.DirectProduct.html#577" class="Function">Monoid-Export.proj₁</a> <a id="1689" class="Symbol">{</a><a id="1690" class="Argument">refl</a> <a id="1695" class="Symbol">=</a> <a id="1697" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1701" class="Symbol">}</a>

        <a id="1712" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1712" class="Function">Dec-≤ᵗ</a> <a id="1719" class="Symbol">:</a> <a id="1721" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1512" class="Function Operator">_≤ᵗ_</a> <a id="1726" href="Class.Decidable.Core.html#590" class="Function Operator">⁇²</a>
        <a id="1737" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1712" class="Function">Dec-≤ᵗ</a> <a id="1744" class="Symbol">{(</a><a id="1746" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1746" class="Bound">c₁</a> <a id="1749" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1751" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1751" class="Bound">v₁</a><a id="1753" class="Symbol">)}</a> <a id="1756" class="Symbol">{(</a><a id="1758" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1758" class="Bound">c₂</a> <a id="1761" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1763" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1763" class="Bound">v₂</a><a id="1765" class="Symbol">)}</a> <a id="1768" class="Symbol">=</a> <a id="1770" href="Class.Decidable.Instances.html#512" class="Function">Dec-×</a> <a id="1776" class="Symbol">⦃</a> <a id="1778" href="Class.Decidable.Instances.html#1571" class="Function">ℕ-Dec-≤</a> <a id="1786" class="Symbol">⦄</a> <a id="1788" class="Symbol">⦃</a> <a id="1790" href="Class.Decidable.Core.html#262" class="InductiveConstructor Operator">⁇</a> <a id="1792" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#3854" class="Function">Vec.decidable</a> <a id="1806" href="Class.Decidable.Core.html#919" class="Function">dec²</a> <a id="1811" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1751" class="Bound">v₁</a> <a id="1814" href="Ledger.Conway.Specification.TokenAlgebra.ValueVector.html#1763" class="Bound">v₂</a> <a id="1817" class="Symbol">⦄</a>

</pre></body></html>