<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Test.Examples.DEx.OffChain.Lib</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">module</a> <a id="32" href="Test.Examples.DEx.OffChain.Lib.html" class="Module">Test.Examples.DEx.OffChain.Lib</a> <a id="63" class="Keyword">where</a>

<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="Data.List.html" class="Module">Data.List</a> <a id="92" class="Keyword">using</a> <a id="98" class="Symbol">(</a><a id="99" href="Data.List.Base.html#10389" class="Function">filter</a><a id="105" class="Symbol">)</a>

<a id="108" class="Keyword">open</a> <a id="113" class="Keyword">import</a> <a id="120" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="187" class="Keyword">using</a> <a id="193" class="Symbol">(</a><a id="194" href="Ledger.Conway.Specification.Transaction.html#999" class="Record">TransactionStructure</a><a id="214" class="Symbol">)</a>

<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Test.Examples.DEx.Datum.html" class="Module">Test.Examples.DEx.Datum</a>
<a id="253" class="Keyword">open</a> <a id="258" class="Keyword">import</a> <a id="265" href="Test.Examples.DEx.Validator.html" class="Module">Test.Examples.DEx.Validator</a>
<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Test.Prelude.html" class="Module">Test.Prelude</a> <a id="318" href="Test.Examples.DEx.Datum.html#695" class="Function">DExData</a>
<a id="326" class="Keyword">open</a> <a id="331" class="Keyword">import</a> <a id="338" href="Test.SymbolicData.html" class="Module">Test.SymbolicData</a> <a id="356" href="Test.Examples.DEx.Datum.html#695" class="Function">DExData</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Test.LedgerImplementation.html" class="Module">Test.LedgerImplementation</a> <a id="402" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="408" href="Test.SymbolicData.html#240" class="Function">SData</a>

<a id="415" class="Keyword">open</a> <a id="420" href="Ledger.Conway.Specification.Transaction.html#999" class="Module">TransactionStructure</a> <a id="441" href="Test.LedgerImplementation.html#4278" class="Function">SVTransactionStructure</a>

<a id="defaultTxBody"></a><a id="465" href="Test.Examples.DEx.OffChain.Lib.html#465" class="Function">defaultTxBody</a> <a id="479" class="Symbol">:</a> <a id="481" href="Ledger.Conway.Specification.Transaction.html#2996" class="Record">TxBody</a>
<a id="488" href="Test.Examples.DEx.OffChain.Lib.html#465" class="Function">defaultTxBody</a> <a id="502" class="Symbol">=</a> <a id="504" class="Keyword">record</a>
                  <a id="529" class="Symbol">{</a> <a id="531" href="Ledger.Conway.Specification.Transaction.html#3032" class="Field">txIns</a> <a id="537" class="Symbol">=</a> <a id="539" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="559" class="Symbol">;</a> <a id="561" href="Ledger.Conway.Specification.Transaction.html#3068" class="Field">refInputs</a> <a id="571" class="Symbol">=</a> <a id="573" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="593" class="Symbol">;</a> <a id="595" href="Ledger.Conway.Specification.Transaction.html#3104" class="Field">collateralInputs</a> <a id="612" class="Symbol">=</a> <a id="614" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="634" class="Symbol">;</a> <a id="636" href="Ledger.Conway.Specification.Transaction.html#3140" class="Field">txOuts</a> <a id="643" class="Symbol">=</a>  <a id="646" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="666" class="Symbol">;</a> <a id="668" href="Ledger.Conway.Specification.Transaction.html#3254" class="Field">txFee</a> <a id="674" class="Symbol">=</a> <a id="676" class="Number">10000000000</a>
                  <a id="706" class="Symbol">;</a> <a id="708" href="Ledger.Conway.Specification.Transaction.html#3638" class="Field">mint</a> <a id="713" class="Symbol">=</a> <a id="715" class="Number">0</a>
                  <a id="735" class="Symbol">;</a> <a id="737" href="Ledger.Conway.Specification.Transaction.html#3329" class="Field">txVldt</a> <a id="744" class="Symbol">=</a> <a id="746" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="754" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="756" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="782" class="Symbol">;</a> <a id="784" href="Ledger.Conway.Specification.Transaction.html#3214" class="Field">txCerts</a> <a id="792" class="Symbol">=</a> <a id="794" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="815" class="Symbol">;</a> <a id="817" href="Ledger.Conway.Specification.Transaction.html#3288" class="Field">txWithdrawals</a> <a id="831" class="Symbol">=</a> <a id="833" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="853" class="Symbol">;</a> <a id="855" href="Ledger.Conway.Specification.Transaction.html#3463" class="Field">txGovVotes</a> <a id="866" class="Symbol">=</a> <a id="868" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="889" class="Symbol">;</a> <a id="891" href="Ledger.Conway.Specification.Transaction.html#3505" class="Field">txGovProposals</a> <a id="906" class="Symbol">=</a> <a id="908" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="929" class="Symbol">;</a> <a id="931" href="Ledger.Conway.Specification.Transaction.html#3424" class="Field">txDonation</a> <a id="942" class="Symbol">=</a> <a id="944" class="Number">0</a>
                  <a id="964" class="Symbol">;</a> <a id="966" href="Ledger.Conway.Specification.Transaction.html#3382" class="Field">txADhash</a> <a id="975" class="Symbol">=</a> <a id="977" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1003" class="Symbol">;</a> <a id="1005" href="Ledger.Conway.Specification.Transaction.html#3551" class="Field">txNetworkId</a> <a id="1017" class="Symbol">=</a> <a id="1019" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1024" class="Number">0</a>
                  <a id="1044" class="Symbol">;</a> <a id="1046" href="Ledger.Conway.Specification.Transaction.html#3594" class="Field">currentTreasury</a> <a id="1062" class="Symbol">=</a> <a id="1064" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1090" class="Symbol">;</a> <a id="1092" href="Ledger.Conway.Specification.Transaction.html#3180" class="Field">txId</a> <a id="1097" class="Symbol">=</a> <a id="1099" class="Number">0</a>
                  <a id="1119" class="Symbol">;</a> <a id="1121" href="Ledger.Conway.Specification.Transaction.html#3673" class="Field">reqSignerHashes</a> <a id="1137" class="Symbol">=</a> <a id="1139" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="1159" class="Symbol">;</a> <a id="1161" href="Ledger.Conway.Specification.Transaction.html#3712" class="Field">scriptIntegrityHash</a> <a id="1181" class="Symbol">=</a> <a id="1183" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1209" class="Symbol">}</a>

<a id="matchScriptAddress"></a><a id="1212" href="Test.Examples.DEx.OffChain.Lib.html#1212" class="Function">matchScriptAddress</a> <a id="1231" class="Symbol">:</a> <a id="1233" class="Symbol">(</a><a id="1234" href="Test.Examples.DEx.OffChain.Lib.html#1234" class="Bound">scriptHash</a> <a id="1245" class="Symbol">:</a> <a id="1247" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1248" class="Symbol">)</a> <a id="1250" class="Symbol">→</a> <a id="1252" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="1263" class="Symbol">→</a> <a id="1265" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1269" href="Test.Examples.DEx.OffChain.Lib.html#1212" class="Function">matchScriptAddress</a> <a id="1288" href="Test.Examples.DEx.OffChain.Lib.html#1288" class="Bound">sh</a> <a id="1291" class="Symbol">(</a><a id="1292" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1303" href="Test.Examples.DEx.OffChain.Lib.html#1303" class="Bound">x</a><a id="1304" class="Symbol">)</a> <a id="1306" class="Symbol">=</a> <a id="1308" href="Data.Empty.html#914" class="Function">⊥</a>
<a id="1310" href="Test.Examples.DEx.OffChain.Lib.html#1212" class="Function">matchScriptAddress</a> <a id="1329" href="Test.Examples.DEx.OffChain.Lib.html#1329" class="Bound">sh</a> <a id="1332" class="Symbol">(</a><a id="1333" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="1343" href="Test.Examples.DEx.OffChain.Lib.html#1343" class="Bound">y</a><a id="1344" class="Symbol">)</a> <a id="1346" class="Symbol">=</a> <a id="1348" href="Relation.Nullary.Decidable.Core.html#4876" class="Function">True</a> <a id="1353" class="Symbol">(</a><a id="1354" href="Test.Examples.DEx.OffChain.Lib.html#1329" class="Bound">sh</a> <a id="1357" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1359" href="Test.Examples.DEx.OffChain.Lib.html#1343" class="Bound">y</a><a id="1360" class="Symbol">)</a>

<a id="matchScriptAddress?"></a><a id="1363" href="Test.Examples.DEx.OffChain.Lib.html#1363" class="Function">matchScriptAddress?</a> <a id="1383" class="Symbol">:</a> <a id="1385" class="Symbol">(</a><a id="1386" href="Test.Examples.DEx.OffChain.Lib.html#1386" class="Bound">sh</a> <a id="1389" class="Symbol">:</a> <a id="1391" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1392" class="Symbol">)</a> <a id="1394" class="Symbol">→</a> <a id="1396" class="Symbol">(</a><a id="1397" href="Test.Examples.DEx.OffChain.Lib.html#1397" class="Bound">c</a> <a id="1399" class="Symbol">:</a> <a id="1401" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="1411" class="Symbol">)</a> <a id="1413" class="Symbol">→</a> <a id="1415" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1419" class="Symbol">(</a><a id="1420" href="Test.Examples.DEx.OffChain.Lib.html#1212" class="Function">matchScriptAddress</a> <a id="1439" href="Test.Examples.DEx.OffChain.Lib.html#1386" class="Bound">sh</a> <a id="1442" href="Test.Examples.DEx.OffChain.Lib.html#1397" class="Bound">c</a><a id="1443" class="Symbol">)</a>
<a id="1445" href="Test.Examples.DEx.OffChain.Lib.html#1363" class="Function">matchScriptAddress?</a> <a id="1465" href="Test.Examples.DEx.OffChain.Lib.html#1465" class="Bound">sh</a> <a id="1468" class="Symbol">(</a><a id="1469" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1480" href="Test.Examples.DEx.OffChain.Lib.html#1480" class="Bound">x</a><a id="1481" class="Symbol">)</a> <a id="1483" class="Symbol">=</a> <a id="1485" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1488" class="Symbol">(λ</a> <a id="1491" href="Test.Examples.DEx.OffChain.Lib.html#1491" class="Bound">x₁</a> <a id="1494" class="Symbol">→</a> <a id="1496" href="Test.Examples.DEx.OffChain.Lib.html#1491" class="Bound">x₁</a><a id="1498" class="Symbol">)</a>
<a id="1500" href="Test.Examples.DEx.OffChain.Lib.html#1363" class="Function">matchScriptAddress?</a> <a id="1520" href="Test.Examples.DEx.OffChain.Lib.html#1520" class="Bound">sh</a> <a id="1523" class="Symbol">(</a><a id="1524" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="1534" href="Test.Examples.DEx.OffChain.Lib.html#1534" class="Bound">y</a><a id="1535" class="Symbol">)</a> <a id="1537" class="Symbol">=</a> <a id="1539" href="Relation.Nullary.Decidable.Core.html#3225" class="Function">T?</a> <a id="1542" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="1544" class="Symbol">(</a><a id="1545" href="Test.Examples.DEx.OffChain.Lib.html#1520" class="Bound">sh</a> <a id="1548" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1550" href="Test.Examples.DEx.OffChain.Lib.html#1534" class="Bound">y</a><a id="1551" class="Symbol">)</a> <a id="1553" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="getScriptUTxO"></a><a id="1556" href="Test.Examples.DEx.OffChain.Lib.html#1556" class="Function">getScriptUTxO</a> <a id="1570" class="Symbol">:</a> <a id="1572" class="Symbol">(</a><a id="1573" href="Test.Examples.DEx.OffChain.Lib.html#1573" class="Bound">scriptHash</a> <a id="1584" class="Symbol">:</a> <a id="1586" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1587" class="Symbol">)</a> <a id="1589" class="Symbol">→</a> <a id="1591" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="1596" class="Symbol">→</a> <a id="1598" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1604" class="Symbol">(</a><a id="1605" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a> <a id="1610" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1612" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="1617" class="Symbol">)</a>
<a id="1619" href="Test.Examples.DEx.OffChain.Lib.html#1556" class="Function">getScriptUTxO</a> <a id="1633" href="Test.Examples.DEx.OffChain.Lib.html#1633" class="Bound">sh</a> <a id="1636" class="Symbol">(</a><a id="1637" href="Test.Examples.DEx.OffChain.Lib.html#1637" class="Bound">utxo</a> <a id="1642" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1644" href="Test.Examples.DEx.OffChain.Lib.html#1644" class="Bound">prf</a><a id="1647" class="Symbol">)</a> <a id="1649" class="Symbol">=</a> <a id="1651" href="Data.List.Base.html#8143" class="Function">head</a> <a id="1656" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1658" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="1665" class="Symbol">(λ</a> <a id="1668" class="Symbol">{</a> <a id="1670" class="Symbol">(_</a> <a id="1673" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1675" href="Test.Examples.DEx.OffChain.Lib.html#1675" class="Bound">addr</a> <a id="1680" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1682" class="Symbol">_)</a> <a id="1685" class="Symbol">→</a> <a id="1687" href="Test.Examples.DEx.OffChain.Lib.html#1363" class="Function">matchScriptAddress?</a> <a id="1707" href="Test.Examples.DEx.OffChain.Lib.html#1633" class="Bound">sh</a> <a id="1710" class="Symbol">(</a><a id="1711" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="1719" href="Test.Examples.DEx.OffChain.Lib.html#1675" class="Bound">addr</a><a id="1723" class="Symbol">)})</a> <a id="1727" class="Symbol">(</a><a id="1728" href="abstract-set-theory.FiniteSetTheory.html#2556" class="Function">setToList</a> <a id="1738" href="Test.Examples.DEx.OffChain.Lib.html#1637" class="Bound">utxo</a><a id="1742" class="Symbol">)</a>

<a id="matchWalletHash"></a><a id="1745" href="Test.Examples.DEx.OffChain.Lib.html#1745" class="Function">matchWalletHash</a> <a id="1761" class="Symbol">:</a> <a id="1763" class="Symbol">(</a><a id="1764" href="Test.Examples.DEx.OffChain.Lib.html#1764" class="Bound">keyHash</a> <a id="1772" class="Symbol">:</a> <a id="1774" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1775" class="Symbol">)</a> <a id="1777" class="Symbol">→</a> <a id="1779" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="1790" class="Symbol">→</a> <a id="1792" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1796" href="Test.Examples.DEx.OffChain.Lib.html#1745" class="Function">matchWalletHash</a> <a id="1812" href="Test.Examples.DEx.OffChain.Lib.html#1812" class="Bound">kh</a> <a id="1815" class="Symbol">(</a><a id="1816" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1827" href="Test.Examples.DEx.OffChain.Lib.html#1827" class="Bound">x</a><a id="1828" class="Symbol">)</a> <a id="1830" class="Symbol">=</a> <a id="1832" href="Relation.Nullary.Decidable.Core.html#4876" class="Function">True</a> <a id="1837" class="Symbol">(</a><a id="1838" href="Test.Examples.DEx.OffChain.Lib.html#1812" class="Bound">kh</a> <a id="1841" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1843" href="Test.Examples.DEx.OffChain.Lib.html#1827" class="Bound">x</a><a id="1844" class="Symbol">)</a>
<a id="1846" href="Test.Examples.DEx.OffChain.Lib.html#1745" class="Function">matchWalletHash</a> <a id="1862" href="Test.Examples.DEx.OffChain.Lib.html#1862" class="Bound">kh</a> <a id="1865" class="Symbol">(</a><a id="1866" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="1876" href="Test.Examples.DEx.OffChain.Lib.html#1876" class="Bound">y</a><a id="1877" class="Symbol">)</a> <a id="1879" class="Symbol">=</a> <a id="1881" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="matchWalletHash?"></a><a id="1884" href="Test.Examples.DEx.OffChain.Lib.html#1884" class="Function">matchWalletHash?</a> <a id="1901" class="Symbol">:</a> <a id="1903" class="Symbol">(</a><a id="1904" href="Test.Examples.DEx.OffChain.Lib.html#1904" class="Bound">sh</a> <a id="1907" class="Symbol">:</a> <a id="1909" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1910" class="Symbol">)</a> <a id="1912" class="Symbol">→</a> <a id="1914" class="Symbol">(</a><a id="1915" href="Test.Examples.DEx.OffChain.Lib.html#1915" class="Bound">c</a> <a id="1917" class="Symbol">:</a> <a id="1919" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="1929" class="Symbol">)</a> <a id="1931" class="Symbol">→</a> <a id="1933" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1937" class="Symbol">(</a><a id="1938" href="Test.Examples.DEx.OffChain.Lib.html#1745" class="Function">matchWalletHash</a> <a id="1954" href="Test.Examples.DEx.OffChain.Lib.html#1904" class="Bound">sh</a> <a id="1957" href="Test.Examples.DEx.OffChain.Lib.html#1915" class="Bound">c</a><a id="1958" class="Symbol">)</a>
<a id="1960" href="Test.Examples.DEx.OffChain.Lib.html#1884" class="Function">matchWalletHash?</a> <a id="1977" href="Test.Examples.DEx.OffChain.Lib.html#1977" class="Bound">kh</a> <a id="1980" class="Symbol">(</a><a id="1981" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1992" href="Test.Examples.DEx.OffChain.Lib.html#1992" class="Bound">x</a><a id="1993" class="Symbol">)</a> <a id="1995" class="Symbol">=</a> <a id="1997" href="Relation.Nullary.Decidable.Core.html#3225" class="Function">T?</a> <a id="2000" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="2002" class="Symbol">(</a><a id="2003" href="Test.Examples.DEx.OffChain.Lib.html#1977" class="Bound">kh</a> <a id="2006" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="2008" href="Test.Examples.DEx.OffChain.Lib.html#1992" class="Bound">x</a><a id="2009" class="Symbol">)</a> <a id="2011" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>
<a id="2013" href="Test.Examples.DEx.OffChain.Lib.html#1884" class="Function">matchWalletHash?</a> <a id="2030" href="Test.Examples.DEx.OffChain.Lib.html#2030" class="Bound">kh</a> <a id="2033" class="Symbol">(</a><a id="2034" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2044" href="Test.Examples.DEx.OffChain.Lib.html#2044" class="Bound">y</a><a id="2045" class="Symbol">)</a> <a id="2047" class="Symbol">=</a> <a id="2049" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2052" class="Symbol">(λ</a> <a id="2055" href="Test.Examples.DEx.OffChain.Lib.html#2055" class="Bound">x₁</a> <a id="2058" class="Symbol">→</a> <a id="2060" href="Test.Examples.DEx.OffChain.Lib.html#2055" class="Bound">x₁</a><a id="2062" class="Symbol">)</a>

<a id="getWalletUTxO"></a><a id="2065" href="Test.Examples.DEx.OffChain.Lib.html#2065" class="Function">getWalletUTxO</a> <a id="2079" class="Symbol">:</a> <a id="2081" class="Symbol">(</a><a id="2082" href="Test.Examples.DEx.OffChain.Lib.html#2082" class="Bound">scriptHash</a> <a id="2093" class="Symbol">:</a> <a id="2095" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2096" class="Symbol">)</a> <a id="2098" class="Symbol">→</a> <a id="2100" href="Ledger.Conway.Specification.Transaction.html#2716" class="Function">UTxO</a> <a id="2105" class="Symbol">→</a> <a id="2107" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2112" class="Symbol">(</a><a id="2113" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a> <a id="2118" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2120" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="2125" class="Symbol">)</a>
<a id="2127" href="Test.Examples.DEx.OffChain.Lib.html#2065" class="Function">getWalletUTxO</a> <a id="2141" href="Test.Examples.DEx.OffChain.Lib.html#2141" class="Bound">sh</a> <a id="2144" class="Symbol">(</a><a id="2145" href="Test.Examples.DEx.OffChain.Lib.html#2145" class="Bound">utxo</a> <a id="2150" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2152" href="Test.Examples.DEx.OffChain.Lib.html#2152" class="Bound">prf</a><a id="2155" class="Symbol">)</a> <a id="2157" class="Symbol">=</a> <a id="2159" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="2166" class="Symbol">(λ</a> <a id="2169" class="Symbol">{</a> <a id="2171" class="Symbol">(_</a> <a id="2174" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2176" href="Test.Examples.DEx.OffChain.Lib.html#2176" class="Bound">addr</a> <a id="2181" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2183" class="Symbol">_)</a> <a id="2186" class="Symbol">→</a> <a id="2188" href="Test.Examples.DEx.OffChain.Lib.html#1884" class="Function">matchWalletHash?</a> <a id="2205" href="Test.Examples.DEx.OffChain.Lib.html#2141" class="Bound">sh</a> <a id="2208" class="Symbol">(</a><a id="2209" href="Ledger.Core.Specification.Address.html#2625" class="Function">payCred</a> <a id="2217" href="Test.Examples.DEx.OffChain.Lib.html#2176" class="Bound">addr</a><a id="2221" class="Symbol">)})</a> <a id="2225" class="Symbol">(</a><a id="2226" href="abstract-set-theory.FiniteSetTheory.html#2556" class="Function">setToList</a> <a id="2236" href="Test.Examples.DEx.OffChain.Lib.html#2145" class="Bound">utxo</a><a id="2240" class="Symbol">)</a>

<a id="2243" class="Comment">{-
succeedTxOut&#39; : TxOut
succeedTxOut&#39; = inj₁ (record { net = 0 ;
                           pay = ScriptObj 777 ;
                           stake = just (ScriptObj 777) })
                           , {!!} , just (inj₁ (inj₁ (inj₁ (Always [])))) , nothing
-- 700000000000 -}</a>

<a id="getLabel"></a><a id="2521" href="Test.Examples.DEx.OffChain.Lib.html#2521" class="Function">getLabel</a> <a id="2530" class="Symbol">:</a> <a id="2532" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a> <a id="2538" class="Symbol">→</a> <a id="2540" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2546" href="Test.Examples.DEx.Datum.html#349" class="Datatype">Label</a>
<a id="2552" href="Test.Examples.DEx.OffChain.Lib.html#2521" class="Function">getLabel</a> <a id="2561" class="Symbol">(</a><a id="2562" href="Test.Examples.DEx.OffChain.Lib.html#2562" class="Bound">fst</a> <a id="2566" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2568" href="Test.Examples.DEx.OffChain.Lib.html#2568" class="Bound">fst₁</a> <a id="2573" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2575" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2580" class="Symbol">(</a><a id="2581" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2586" class="Symbol">(</a><a id="2587" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2592" class="Symbol">(</a><a id="2593" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2598" href="Test.Examples.DEx.OffChain.Lib.html#2598" class="Bound">x</a><a id="2599" class="Symbol">)))</a> <a id="2603" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2605" href="Test.Examples.DEx.OffChain.Lib.html#2605" class="Bound">snd</a><a id="2608" class="Symbol">)</a> <a id="2610" class="Symbol">=</a> <a id="2612" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2617" href="Test.Examples.DEx.OffChain.Lib.html#2598" class="Bound">x</a>
<a id="2619" href="Test.Examples.DEx.OffChain.Lib.html#2521" class="Function">getLabel</a> <a id="2628" class="Symbol">(</a><a id="2629" href="Test.Examples.DEx.OffChain.Lib.html#2629" class="Bound">fst</a> <a id="2633" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2635" href="Test.Examples.DEx.OffChain.Lib.html#2635" class="Bound">fst₁</a> <a id="2640" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2642" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2647" class="Symbol">(</a><a id="2648" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2653" class="Symbol">(</a><a id="2654" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2659" class="Symbol">(</a><a id="2660" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2665" href="Test.Examples.DEx.OffChain.Lib.html#2665" class="Bound">y</a><a id="2666" class="Symbol">)))</a> <a id="2670" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2672" href="Test.Examples.DEx.OffChain.Lib.html#2672" class="Bound">snd</a><a id="2675" class="Symbol">)</a> <a id="2677" class="Symbol">=</a> <a id="2679" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2687" href="Test.Examples.DEx.OffChain.Lib.html#2521" class="Function">getLabel</a> <a id="2696" class="Symbol">(</a><a id="2697" href="Test.Examples.DEx.OffChain.Lib.html#2697" class="Bound">fst</a> <a id="2701" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2703" href="Test.Examples.DEx.OffChain.Lib.html#2703" class="Bound">fst₁</a> <a id="2708" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2710" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2715" class="Symbol">(</a><a id="2716" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2721" class="Symbol">(</a><a id="2722" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2727" href="Test.Examples.DEx.OffChain.Lib.html#2727" class="Bound">y</a><a id="2728" class="Symbol">))</a> <a id="2731" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2733" href="Test.Examples.DEx.OffChain.Lib.html#2733" class="Bound">snd</a><a id="2736" class="Symbol">)</a> <a id="2738" class="Symbol">=</a> <a id="2740" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2748" href="Test.Examples.DEx.OffChain.Lib.html#2521" class="Function">getLabel</a> <a id="2757" class="Symbol">(</a><a id="2758" href="Test.Examples.DEx.OffChain.Lib.html#2758" class="Bound">fst</a> <a id="2762" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2764" href="Test.Examples.DEx.OffChain.Lib.html#2764" class="Bound">fst₁</a> <a id="2769" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2771" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2776" class="Symbol">(</a><a id="2777" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2782" href="Test.Examples.DEx.OffChain.Lib.html#2782" class="Bound">y</a><a id="2783" class="Symbol">)</a> <a id="2785" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2787" href="Test.Examples.DEx.OffChain.Lib.html#2787" class="Bound">snd</a><a id="2790" class="Symbol">)</a> <a id="2792" class="Symbol">=</a> <a id="2794" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2802" href="Test.Examples.DEx.OffChain.Lib.html#2521" class="Function">getLabel</a> <a id="2811" class="Symbol">(</a><a id="2812" href="Test.Examples.DEx.OffChain.Lib.html#2812" class="Bound">fst</a> <a id="2816" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2818" href="Test.Examples.DEx.OffChain.Lib.html#2818" class="Bound">fst₁</a> <a id="2823" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2825" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2833" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2835" href="Test.Examples.DEx.OffChain.Lib.html#2835" class="Bound">snd</a><a id="2838" class="Symbol">)</a> <a id="2840" class="Symbol">=</a> <a id="2842" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>



<a id="2853" class="Comment">-- Assumes a list of filtered waller txins and subtracts a default fee from the head of the list</a>
<a id="makeFeeTxOut"></a><a id="2950" href="Test.Examples.DEx.OffChain.Lib.html#2950" class="Function">makeFeeTxOut</a> <a id="2963" class="Symbol">:</a> <a id="2965" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2970" class="Symbol">(</a><a id="2971" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a> <a id="2976" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2978" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="2983" class="Symbol">)</a> <a id="2985" class="Symbol">→</a> <a id="2987" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2992" class="Symbol">(</a><a id="2993" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2995" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2997" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="3002" class="Symbol">)</a>
<a id="3004" href="Test.Examples.DEx.OffChain.Lib.html#2950" class="Function">makeFeeTxOut</a> <a id="3017" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3020" class="Symbol">=</a> <a id="3022" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3025" href="Test.Examples.DEx.OffChain.Lib.html#2950" class="Function">makeFeeTxOut</a> <a id="3038" class="Symbol">((</a><a id="3040" href="Test.Examples.DEx.OffChain.Lib.html#3040" class="Bound">txin</a> <a id="3045" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3047" class="Symbol">(</a><a id="3048" href="Test.Examples.DEx.OffChain.Lib.html#3048" class="Bound">fst</a> <a id="3052" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3054" href="Test.Examples.DEx.OffChain.Lib.html#3054" class="Bound">txValue</a> <a id="3062" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3064" href="Test.Examples.DEx.OffChain.Lib.html#3064" class="Bound">snd</a><a id="3067" class="Symbol">))</a> <a id="3070" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3072" href="Test.Examples.DEx.OffChain.Lib.html#3072" class="Bound">utxos</a><a id="3077" class="Symbol">)</a> <a id="3079" class="Symbol">=</a> <a id="3081" class="Symbol">(</a><a id="3082" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3088" href="Test.Examples.DEx.OffChain.Lib.html#3040" class="Bound">txin</a> <a id="3093" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3095" href="Test.Examples.DEx.OffChain.Lib.html#3048" class="Bound">fst</a> <a id="3099" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3101" href="Test.Examples.DEx.OffChain.Lib.html#3054" class="Bound">txValue</a> <a id="3109" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3111" href="Test.Examples.DEx.Validator.html#885" class="Function">feeValue</a> <a id="3120" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3122" href="Test.Examples.DEx.OffChain.Lib.html#3064" class="Bound">snd</a><a id="3125" class="Symbol">)</a> <a id="3127" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3129" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3132" class="Comment">--10000000000</a>

<a id="makeFeeUnPaymentTxOut"></a><a id="3147" href="Test.Examples.DEx.OffChain.Lib.html#3147" class="Function">makeFeeUnPaymentTxOut</a> <a id="3169" class="Symbol">:</a> <a id="3171" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3176" class="Symbol">(</a><a id="3177" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a> <a id="3182" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3184" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="3189" class="Symbol">)</a> <a id="3191" class="Symbol">→</a> <a id="3193" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="3199" class="Symbol">→</a> <a id="3201" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3206" class="Symbol">(</a><a id="3207" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3209" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3211" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="3216" class="Symbol">)</a>
<a id="3218" href="Test.Examples.DEx.OffChain.Lib.html#3147" class="Function">makeFeeUnPaymentTxOut</a> <a id="3240" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3243" href="Test.Examples.DEx.OffChain.Lib.html#3243" class="Bound">v</a> <a id="3245" class="Symbol">=</a> <a id="3247" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3250" href="Test.Examples.DEx.OffChain.Lib.html#3147" class="Function">makeFeeUnPaymentTxOut</a> <a id="3272" class="Symbol">((</a><a id="3274" href="Test.Examples.DEx.OffChain.Lib.html#3274" class="Bound">txin</a> <a id="3279" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3281" class="Symbol">(</a><a id="3282" href="Test.Examples.DEx.OffChain.Lib.html#3282" class="Bound">fst</a> <a id="3286" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3288" href="Test.Examples.DEx.OffChain.Lib.html#3288" class="Bound">txValue</a> <a id="3296" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3298" href="Test.Examples.DEx.OffChain.Lib.html#3298" class="Bound">snd</a><a id="3301" class="Symbol">))</a> <a id="3304" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3306" href="Test.Examples.DEx.OffChain.Lib.html#3306" class="Bound">utxos</a><a id="3311" class="Symbol">)</a> <a id="3313" href="Test.Examples.DEx.OffChain.Lib.html#3313" class="Bound">v</a> <a id="3315" class="Symbol">=</a> <a id="3317" class="Symbol">(</a><a id="3318" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3324" href="Test.Examples.DEx.OffChain.Lib.html#3274" class="Bound">txin</a> <a id="3329" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3331" href="Test.Examples.DEx.OffChain.Lib.html#3282" class="Bound">fst</a> <a id="3335" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3337" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3341" class="Symbol">{{</a><a id="3343" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#1274" class="Function">addValue</a><a id="3351" class="Symbol">}}</a> <a id="3354" class="Symbol">(</a><a id="3355" href="Test.Examples.DEx.OffChain.Lib.html#3288" class="Bound">txValue</a> <a id="3363" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3365" href="Test.Examples.DEx.Validator.html#885" class="Function">feeValue</a><a id="3373" class="Symbol">)</a> <a id="3375" href="Test.Examples.DEx.OffChain.Lib.html#3313" class="Bound">v</a> <a id="3377" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3379" href="Test.Examples.DEx.OffChain.Lib.html#3298" class="Bound">snd</a><a id="3382" class="Symbol">)</a> <a id="3384" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3386" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3389" class="Comment">-- 10000000000</a>

<a id="makeFeePaymentTxOut"></a><a id="3405" href="Test.Examples.DEx.OffChain.Lib.html#3405" class="Function">makeFeePaymentTxOut</a> <a id="3425" class="Symbol">:</a> <a id="3427" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3432" class="Symbol">(</a><a id="3433" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a> <a id="3438" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3440" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="3445" class="Symbol">)</a> <a id="3447" class="Symbol">→</a> <a id="3449" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="3455" class="Symbol">→</a> <a id="3457" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3462" class="Symbol">(</a><a id="3463" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3465" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3467" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="3472" class="Symbol">)</a>
<a id="3474" href="Test.Examples.DEx.OffChain.Lib.html#3405" class="Function">makeFeePaymentTxOut</a> <a id="3494" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3497" href="Test.Examples.DEx.OffChain.Lib.html#3497" class="Bound">v</a> <a id="3499" class="Symbol">=</a> <a id="3501" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3504" href="Test.Examples.DEx.OffChain.Lib.html#3405" class="Function">makeFeePaymentTxOut</a> <a id="3524" class="Symbol">((</a><a id="3526" href="Test.Examples.DEx.OffChain.Lib.html#3526" class="Bound">txin</a> <a id="3531" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3533" class="Symbol">(</a><a id="3534" href="Test.Examples.DEx.OffChain.Lib.html#3534" class="Bound">fst</a> <a id="3538" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3540" href="Test.Examples.DEx.OffChain.Lib.html#3540" class="Bound">txValue</a> <a id="3548" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3550" href="Test.Examples.DEx.OffChain.Lib.html#3550" class="Bound">snd</a><a id="3553" class="Symbol">))</a> <a id="3556" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3558" href="Test.Examples.DEx.OffChain.Lib.html#3558" class="Bound">utxos</a><a id="3563" class="Symbol">)</a> <a id="3565" href="Test.Examples.DEx.OffChain.Lib.html#3565" class="Bound">v</a> <a id="3567" class="Symbol">=</a> <a id="3569" class="Symbol">(</a><a id="3570" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3576" href="Test.Examples.DEx.OffChain.Lib.html#3526" class="Bound">txin</a> <a id="3581" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3583" href="Test.Examples.DEx.OffChain.Lib.html#3534" class="Bound">fst</a> <a id="3587" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3589" class="Symbol">(</a><a id="3590" href="Test.Examples.DEx.OffChain.Lib.html#3540" class="Bound">txValue</a> <a id="3598" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3600" href="Test.Examples.DEx.Validator.html#885" class="Function">feeValue</a> <a id="3609" class="Symbol">)</a> <a id="3611" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3613" href="Test.Examples.DEx.OffChain.Lib.html#3565" class="Bound">v</a> <a id="3615" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3617" href="Test.Examples.DEx.OffChain.Lib.html#3550" class="Bound">snd</a><a id="3620" class="Symbol">)</a> <a id="3622" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3624" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3627" class="Comment">--10000000000</a>

<a id="makeFeeSwapTxOut"></a><a id="3642" href="Test.Examples.DEx.OffChain.Lib.html#3642" class="Function">makeFeeSwapTxOut</a> <a id="3659" class="Symbol">:</a> <a id="3661" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3666" class="Symbol">(</a><a id="3667" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a> <a id="3672" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3674" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="3679" class="Symbol">)</a> <a id="3681" class="Symbol">→</a> <a id="3683" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="3689" class="Symbol">→</a> <a id="3691" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#517" class="Function">Value</a> <a id="3697" class="Symbol">→</a> <a id="3699" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3704" class="Symbol">(</a><a id="3705" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3707" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3709" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="3714" class="Symbol">)</a>
<a id="3716" href="Test.Examples.DEx.OffChain.Lib.html#3642" class="Function">makeFeeSwapTxOut</a> <a id="3733" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3736" href="Test.Examples.DEx.OffChain.Lib.html#3736" class="Bound">v1</a> <a id="3739" href="Test.Examples.DEx.OffChain.Lib.html#3739" class="Bound">v2</a> <a id="3742" class="Symbol">=</a> <a id="3744" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3747" href="Test.Examples.DEx.OffChain.Lib.html#3642" class="Function">makeFeeSwapTxOut</a> <a id="3764" class="Symbol">((</a><a id="3766" href="Test.Examples.DEx.OffChain.Lib.html#3766" class="Bound">txin</a> <a id="3771" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3773" class="Symbol">(</a><a id="3774" href="Test.Examples.DEx.OffChain.Lib.html#3774" class="Bound">fst</a> <a id="3778" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3780" href="Test.Examples.DEx.OffChain.Lib.html#3780" class="Bound">txValue</a> <a id="3788" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3790" href="Test.Examples.DEx.OffChain.Lib.html#3790" class="Bound">snd</a><a id="3793" class="Symbol">))</a> <a id="3796" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3798" href="Test.Examples.DEx.OffChain.Lib.html#3798" class="Bound">utxos</a><a id="3803" class="Symbol">)</a> <a id="3805" href="Test.Examples.DEx.OffChain.Lib.html#3805" class="Bound">refund</a> <a id="3812" href="Test.Examples.DEx.OffChain.Lib.html#3812" class="Bound">new</a> <a id="3816" class="Symbol">=</a> <a id="3818" class="Symbol">(</a><a id="3819" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3825" href="Test.Examples.DEx.OffChain.Lib.html#3766" class="Bound">txin</a> <a id="3830" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3832" href="Test.Examples.DEx.OffChain.Lib.html#3774" class="Bound">fst</a> <a id="3836" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3838" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3842" class="Symbol">{{</a><a id="3844" href="Ledger.Conway.Specification.TokenAlgebra.Base.html#1274" class="Function">addValue</a><a id="3852" class="Symbol">}}</a> <a id="3855" class="Symbol">((</a><a id="3857" href="Test.Examples.DEx.OffChain.Lib.html#3780" class="Bound">txValue</a> <a id="3865" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3867" href="Test.Examples.DEx.Validator.html#885" class="Function">feeValue</a> <a id="3876" class="Symbol">)</a> <a id="3878" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3880" href="Test.Examples.DEx.OffChain.Lib.html#3812" class="Bound">new</a><a id="3883" class="Symbol">)</a> <a id="3885" href="Test.Examples.DEx.OffChain.Lib.html#3805" class="Bound">refund</a> <a id="3892" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3894" href="Test.Examples.DEx.OffChain.Lib.html#3790" class="Bound">snd</a><a id="3897" class="Symbol">)</a> <a id="3899" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3901" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="3905" class="Comment">-- return id of 0 if no txins</a>
<a id="getTxId"></a><a id="3935" href="Test.Examples.DEx.OffChain.Lib.html#3935" class="Function">getTxId</a> <a id="3943" class="Symbol">:</a> <a id="3945" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3950" class="Symbol">(</a><a id="3951" href="Ledger.Conway.Specification.Transaction.html#2605" class="Function">TxIn</a> <a id="3956" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3958" href="Ledger.Conway.Specification.Transaction.html#2638" class="Function">TxOut</a><a id="3963" class="Symbol">)</a> <a id="3965" class="Symbol">→</a> <a id="3967" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="3969" href="Test.Examples.DEx.OffChain.Lib.html#3935" class="Function">getTxId</a> <a id="3977" href="Test.Examples.DEx.OffChain.Lib.html#3977" class="Bound">xs</a> <a id="3980" class="Symbol">=</a> <a id="3982" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="3988" class="Symbol">(λ</a> <a id="3991" href="Test.Examples.DEx.OffChain.Lib.html#3991" class="Bound">x</a> <a id="3993" class="Symbol">→</a> <a id="3995" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4001" class="Symbol">(</a><a id="4002" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4008" href="Test.Examples.DEx.OffChain.Lib.html#3991" class="Bound">x</a><a id="4009" class="Symbol">))</a> <a id="4012" class="Number">0</a> <a id="4014" class="Symbol">(</a><a id="4015" href="Data.List.Base.html#8143" class="Function">head</a> <a id="4020" href="Test.Examples.DEx.OffChain.Lib.html#3977" class="Bound">xs</a><a id="4022" class="Symbol">)</a>

<a id="4025" class="Comment">{-
getVal : Label -&gt; ℕ -&gt; Value
getVal (Always l) w with lookup&#39; w l
...| nothing = emptyValue
...| just v = v
-}</a>



</pre></body></html>