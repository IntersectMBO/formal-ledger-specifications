<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Test.Examples.DEx.OffChain.Lib</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">module</a> <a id="32" href="Test.Examples.DEx.OffChain.Lib.html" class="Module">Test.Examples.DEx.OffChain.Lib</a> <a id="63" class="Keyword">where</a>

<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="Data.List.html" class="Module">Data.List</a> <a id="92" class="Keyword">using</a> <a id="98" class="Symbol">(</a><a id="99" href="Data.List.Base.html#10389" class="Function">filter</a><a id="105" class="Symbol">)</a>

<a id="108" class="Keyword">open</a> <a id="113" class="Keyword">import</a> <a id="120" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Ledger.Core.Specification.Transaction.html" class="Module">Ledger.Core.Specification.Transaction</a> <a id="185" class="Keyword">using</a> <a id="191" class="Symbol">(</a><a id="192" href="Ledger.Core.Specification.Transaction.html#896" class="Record">TransactionStructure</a><a id="212" class="Symbol">)</a>

<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Test.Examples.DEx.Datum.html" class="Module">Test.Examples.DEx.Datum</a>
<a id="251" class="Keyword">open</a> <a id="256" class="Keyword">import</a> <a id="263" href="Test.Examples.DEx.Validator.html" class="Module">Test.Examples.DEx.Validator</a>
<a id="291" class="Keyword">open</a> <a id="296" class="Keyword">import</a> <a id="303" href="Test.Prelude.html" class="Module">Test.Prelude</a> <a id="316" href="Test.Examples.DEx.Datum.html#695" class="Function">DExData</a>
<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Test.SymbolicData.html" class="Module">Test.SymbolicData</a> <a id="354" href="Test.Examples.DEx.Datum.html#695" class="Function">DExData</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Test.LedgerImplementation.html" class="Module">Test.LedgerImplementation</a> <a id="400" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="406" href="Test.SymbolicData.html#240" class="Function">SData</a>

<a id="413" class="Keyword">open</a> <a id="418" href="Ledger.Core.Specification.Transaction.html#896" class="Module">TransactionStructure</a> <a id="439" href="Test.LedgerImplementation.html#4275" class="Function">SVTransactionStructure</a>

<a id="463" class="Keyword">open</a> <a id="468" class="Keyword">import</a> <a id="475" href="Test.AbstractImplementation.html" class="Module">Test.AbstractImplementation</a> <a id="503" href="Test.SymbolicData.html#2902" class="Function">valContext</a>

<a id="515" class="Keyword">open</a> <a id="520" class="Keyword">import</a> <a id="527" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="567" href="Test.LedgerImplementation.html#4275" class="Function">SVTransactionStructure</a> <a id="590" href="Test.AbstractImplementation.html#673" class="Function">SVAbstractFunctions</a>

<a id="defaultTxBody"></a><a id="611" href="Test.Examples.DEx.OffChain.Lib.html#611" class="Function">defaultTxBody</a> <a id="625" class="Symbol">:</a> <a id="627" href="Ledger.Conway.Specification.Transaction.html#350" class="Record">TxBody</a>
<a id="634" href="Test.Examples.DEx.OffChain.Lib.html#611" class="Function">defaultTxBody</a> <a id="648" class="Symbol">=</a> <a id="650" class="Keyword">record</a>
                  <a id="675" class="Symbol">{</a> <a id="677" href="Ledger.Conway.Specification.Transaction.html#382" class="Field">txIns</a> <a id="683" class="Symbol">=</a> <a id="685" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="705" class="Symbol">;</a> <a id="707" href="Ledger.Conway.Specification.Transaction.html#416" class="Field">refInputs</a> <a id="717" class="Symbol">=</a> <a id="719" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="739" class="Symbol">;</a> <a id="741" href="Ledger.Conway.Specification.Transaction.html#450" class="Field">collateralInputs</a> <a id="758" class="Symbol">=</a> <a id="760" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="780" class="Symbol">;</a> <a id="782" href="Ledger.Conway.Specification.Transaction.html#484" class="Field">txOuts</a> <a id="789" class="Symbol">=</a>  <a id="792" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="812" class="Symbol">;</a> <a id="814" href="Ledger.Conway.Specification.Transaction.html#592" class="Field">txFee</a> <a id="820" class="Symbol">=</a> <a id="822" class="Number">10000000000</a>
                  <a id="852" class="Symbol">;</a> <a id="854" href="Ledger.Conway.Specification.Transaction.html#958" class="Field">mint</a> <a id="859" class="Symbol">=</a> <a id="861" class="Number">0</a>
                  <a id="881" class="Symbol">;</a> <a id="883" href="Ledger.Conway.Specification.Transaction.html#663" class="Field">txVldt</a> <a id="890" class="Symbol">=</a> <a id="892" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="900" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="902" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="928" class="Symbol">;</a> <a id="930" href="Ledger.Conway.Specification.Transaction.html#554" class="Field">txCerts</a> <a id="938" class="Symbol">=</a> <a id="940" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="961" class="Symbol">;</a> <a id="963" href="Ledger.Conway.Specification.Transaction.html#624" class="Field">txWithdrawals</a> <a id="977" class="Symbol">=</a> <a id="979" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="999" class="Symbol">;</a> <a id="1001" href="Ledger.Conway.Specification.Transaction.html#791" class="Field">txGovVotes</a> <a id="1012" class="Symbol">=</a> <a id="1014" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="1035" class="Symbol">;</a> <a id="1037" href="Ledger.Conway.Specification.Transaction.html#831" class="Field">txGovProposals</a> <a id="1052" class="Symbol">=</a> <a id="1054" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="1075" class="Symbol">;</a> <a id="1077" href="Ledger.Conway.Specification.Transaction.html#754" class="Field">txDonation</a> <a id="1088" class="Symbol">=</a> <a id="1090" class="Number">0</a>
                  <a id="1110" class="Symbol">;</a> <a id="1112" href="Ledger.Conway.Specification.Transaction.html#714" class="Field">txADhash</a> <a id="1121" class="Symbol">=</a> <a id="1123" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1149" class="Symbol">;</a> <a id="1151" href="Ledger.Conway.Specification.Transaction.html#875" class="Field">txNetworkId</a> <a id="1163" class="Symbol">=</a> <a id="1165" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1170" class="Number">0</a>
                  <a id="1190" class="Symbol">;</a> <a id="1192" href="Ledger.Conway.Specification.Transaction.html#916" class="Field">currentTreasury</a> <a id="1208" class="Symbol">=</a> <a id="1210" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1236" class="Symbol">;</a> <a id="1238" href="Ledger.Conway.Specification.Transaction.html#522" class="Field">txId</a> <a id="1243" class="Symbol">=</a> <a id="1245" class="Number">0</a>
                  <a id="1265" class="Symbol">;</a> <a id="1267" href="Ledger.Conway.Specification.Transaction.html#991" class="Field">reqSignerHashes</a> <a id="1283" class="Symbol">=</a> <a id="1285" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="1305" class="Symbol">;</a> <a id="1307" href="Ledger.Conway.Specification.Transaction.html#1028" class="Field">scriptIntegrityHash</a> <a id="1327" class="Symbol">=</a> <a id="1329" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1355" class="Symbol">}</a>

<a id="matchScriptAddress"></a><a id="1358" href="Test.Examples.DEx.OffChain.Lib.html#1358" class="Function">matchScriptAddress</a> <a id="1377" class="Symbol">:</a> <a id="1379" class="Symbol">(</a><a id="1380" href="Test.Examples.DEx.OffChain.Lib.html#1380" class="Bound">scriptHash</a> <a id="1391" class="Symbol">:</a> <a id="1393" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1394" class="Symbol">)</a> <a id="1396" class="Symbol">→</a> <a id="1398" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1415" href="Test.Examples.DEx.OffChain.Lib.html#1358" class="Function">matchScriptAddress</a> <a id="1434" href="Test.Examples.DEx.OffChain.Lib.html#1434" class="Bound">sh</a> <a id="1437" class="Symbol">(</a><a id="1438" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1449" href="Test.Examples.DEx.OffChain.Lib.html#1449" class="Bound">x</a><a id="1450" class="Symbol">)</a> <a id="1452" class="Symbol">=</a> <a id="1454" href="Data.Empty.html#914" class="Function">⊥</a>
<a id="1456" href="Test.Examples.DEx.OffChain.Lib.html#1358" class="Function">matchScriptAddress</a> <a id="1475" href="Test.Examples.DEx.OffChain.Lib.html#1475" class="Bound">sh</a> <a id="1478" class="Symbol">(</a><a id="1479" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="1489" href="Test.Examples.DEx.OffChain.Lib.html#1489" class="Bound">y</a><a id="1490" class="Symbol">)</a> <a id="1492" class="Symbol">=</a> <a id="1494" href="Relation.Nullary.Decidable.Core.html#4876" class="Function">True</a> <a id="1499" class="Symbol">(</a><a id="1500" href="Test.Examples.DEx.OffChain.Lib.html#1475" class="Bound">sh</a> <a id="1503" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1505" href="Test.Examples.DEx.OffChain.Lib.html#1489" class="Bound">y</a><a id="1506" class="Symbol">)</a>

<a id="matchScriptAddress?"></a><a id="1509" href="Test.Examples.DEx.OffChain.Lib.html#1509" class="Function">matchScriptAddress?</a> <a id="1529" class="Symbol">:</a> <a id="1531" class="Symbol">(</a><a id="1532" href="Test.Examples.DEx.OffChain.Lib.html#1532" class="Bound">sh</a> <a id="1535" class="Symbol">:</a> <a id="1537" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1538" class="Symbol">)</a> <a id="1540" class="Symbol">→</a> <a id="1542" class="Symbol">(</a><a id="1543" href="Test.Examples.DEx.OffChain.Lib.html#1543" class="Bound">c</a> <a id="1545" class="Symbol">:</a> <a id="1547" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="1557" class="Symbol">)</a> <a id="1559" class="Symbol">→</a> <a id="1561" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1565" class="Symbol">(</a><a id="1566" href="Test.Examples.DEx.OffChain.Lib.html#1358" class="Function">matchScriptAddress</a> <a id="1585" href="Test.Examples.DEx.OffChain.Lib.html#1532" class="Bound">sh</a> <a id="1588" href="Test.Examples.DEx.OffChain.Lib.html#1543" class="Bound">c</a><a id="1589" class="Symbol">)</a>
<a id="1591" href="Test.Examples.DEx.OffChain.Lib.html#1509" class="Function">matchScriptAddress?</a> <a id="1611" href="Test.Examples.DEx.OffChain.Lib.html#1611" class="Bound">sh</a> <a id="1614" class="Symbol">(</a><a id="1615" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1626" href="Test.Examples.DEx.OffChain.Lib.html#1626" class="Bound">x</a><a id="1627" class="Symbol">)</a> <a id="1629" class="Symbol">=</a> <a id="1631" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1634" class="Symbol">(λ</a> <a id="1637" href="Test.Examples.DEx.OffChain.Lib.html#1637" class="Bound">x₁</a> <a id="1640" class="Symbol">→</a> <a id="1642" href="Test.Examples.DEx.OffChain.Lib.html#1637" class="Bound">x₁</a><a id="1644" class="Symbol">)</a>
<a id="1646" href="Test.Examples.DEx.OffChain.Lib.html#1509" class="Function">matchScriptAddress?</a> <a id="1666" href="Test.Examples.DEx.OffChain.Lib.html#1666" class="Bound">sh</a> <a id="1669" class="Symbol">(</a><a id="1670" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="1680" href="Test.Examples.DEx.OffChain.Lib.html#1680" class="Bound">y</a><a id="1681" class="Symbol">)</a> <a id="1683" class="Symbol">=</a> <a id="1685" href="Relation.Nullary.Decidable.Core.html#3225" class="Function">T?</a> <a id="1688" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="1690" class="Symbol">(</a><a id="1691" href="Test.Examples.DEx.OffChain.Lib.html#1666" class="Bound">sh</a> <a id="1694" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1696" href="Test.Examples.DEx.OffChain.Lib.html#1680" class="Bound">y</a><a id="1697" class="Symbol">)</a> <a id="1699" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="getScriptUTxO"></a><a id="1702" href="Test.Examples.DEx.OffChain.Lib.html#1702" class="Function">getScriptUTxO</a> <a id="1716" class="Symbol">:</a> <a id="1718" class="Symbol">(</a><a id="1719" href="Test.Examples.DEx.OffChain.Lib.html#1719" class="Bound">scriptHash</a> <a id="1730" class="Symbol">:</a> <a id="1732" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1733" class="Symbol">)</a> <a id="1735" class="Symbol">→</a> <a id="1737" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="1742" class="Symbol">→</a> <a id="1744" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1750" class="Symbol">(</a><a id="1751" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a> <a id="1756" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1758" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="1763" class="Symbol">)</a>
<a id="1765" href="Test.Examples.DEx.OffChain.Lib.html#1702" class="Function">getScriptUTxO</a> <a id="1779" href="Test.Examples.DEx.OffChain.Lib.html#1779" class="Bound">sh</a> <a id="1782" class="Symbol">(</a><a id="1783" href="Test.Examples.DEx.OffChain.Lib.html#1783" class="Bound">utxo</a> <a id="1788" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1790" href="Test.Examples.DEx.OffChain.Lib.html#1790" class="Bound">prf</a><a id="1793" class="Symbol">)</a> <a id="1795" class="Symbol">=</a> <a id="1797" href="Data.List.Base.html#8143" class="Function">head</a> <a id="1802" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1804" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="1811" class="Symbol">(λ</a> <a id="1814" class="Symbol">{</a> <a id="1816" class="Symbol">(_</a> <a id="1819" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1821" href="Test.Examples.DEx.OffChain.Lib.html#1821" class="Bound">addr</a> <a id="1826" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1828" class="Symbol">_)</a> <a id="1831" class="Symbol">→</a> <a id="1833" href="Test.Examples.DEx.OffChain.Lib.html#1509" class="Function">matchScriptAddress?</a> <a id="1853" href="Test.Examples.DEx.OffChain.Lib.html#1779" class="Bound">sh</a> <a id="1856" class="Symbol">(</a><a id="1857" href="Ledger.Core.Specification.Address.html#2685" class="Function">payCred</a> <a id="1865" href="Test.Examples.DEx.OffChain.Lib.html#1821" class="Bound">addr</a><a id="1869" class="Symbol">)})</a> <a id="1873" class="Symbol">(</a><a id="1874" href="abstract-set-theory.FiniteSetTheory.html#2617" class="Function">setToList</a> <a id="1884" href="Test.Examples.DEx.OffChain.Lib.html#1783" class="Bound">utxo</a><a id="1888" class="Symbol">)</a>

<a id="matchWalletHash"></a><a id="1891" href="Test.Examples.DEx.OffChain.Lib.html#1891" class="Function">matchWalletHash</a> <a id="1907" class="Symbol">:</a> <a id="1909" class="Symbol">(</a><a id="1910" href="Test.Examples.DEx.OffChain.Lib.html#1910" class="Bound">keyHash</a> <a id="1918" class="Symbol">:</a> <a id="1920" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1921" class="Symbol">)</a> <a id="1923" class="Symbol">→</a> <a id="1925" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="1936" class="Symbol">→</a> <a id="1938" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1942" href="Test.Examples.DEx.OffChain.Lib.html#1891" class="Function">matchWalletHash</a> <a id="1958" href="Test.Examples.DEx.OffChain.Lib.html#1958" class="Bound">kh</a> <a id="1961" class="Symbol">(</a><a id="1962" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1973" href="Test.Examples.DEx.OffChain.Lib.html#1973" class="Bound">x</a><a id="1974" class="Symbol">)</a> <a id="1976" class="Symbol">=</a> <a id="1978" href="Relation.Nullary.Decidable.Core.html#4876" class="Function">True</a> <a id="1983" class="Symbol">(</a><a id="1984" href="Test.Examples.DEx.OffChain.Lib.html#1958" class="Bound">kh</a> <a id="1987" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1989" href="Test.Examples.DEx.OffChain.Lib.html#1973" class="Bound">x</a><a id="1990" class="Symbol">)</a>
<a id="1992" href="Test.Examples.DEx.OffChain.Lib.html#1891" class="Function">matchWalletHash</a> <a id="2008" href="Test.Examples.DEx.OffChain.Lib.html#2008" class="Bound">kh</a> <a id="2011" class="Symbol">(</a><a id="2012" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2022" href="Test.Examples.DEx.OffChain.Lib.html#2022" class="Bound">y</a><a id="2023" class="Symbol">)</a> <a id="2025" class="Symbol">=</a> <a id="2027" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="matchWalletHash?"></a><a id="2030" href="Test.Examples.DEx.OffChain.Lib.html#2030" class="Function">matchWalletHash?</a> <a id="2047" class="Symbol">:</a> <a id="2049" class="Symbol">(</a><a id="2050" href="Test.Examples.DEx.OffChain.Lib.html#2050" class="Bound">sh</a> <a id="2053" class="Symbol">:</a> <a id="2055" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2056" class="Symbol">)</a> <a id="2058" class="Symbol">→</a> <a id="2060" class="Symbol">(</a><a id="2061" href="Test.Examples.DEx.OffChain.Lib.html#2061" class="Bound">c</a> <a id="2063" class="Symbol">:</a> <a id="2065" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="2075" class="Symbol">)</a> <a id="2077" class="Symbol">→</a> <a id="2079" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="2083" class="Symbol">(</a><a id="2084" href="Test.Examples.DEx.OffChain.Lib.html#1891" class="Function">matchWalletHash</a> <a id="2100" href="Test.Examples.DEx.OffChain.Lib.html#2050" class="Bound">sh</a> <a id="2103" href="Test.Examples.DEx.OffChain.Lib.html#2061" class="Bound">c</a><a id="2104" class="Symbol">)</a>
<a id="2106" href="Test.Examples.DEx.OffChain.Lib.html#2030" class="Function">matchWalletHash?</a> <a id="2123" href="Test.Examples.DEx.OffChain.Lib.html#2123" class="Bound">kh</a> <a id="2126" class="Symbol">(</a><a id="2127" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="2138" href="Test.Examples.DEx.OffChain.Lib.html#2138" class="Bound">x</a><a id="2139" class="Symbol">)</a> <a id="2141" class="Symbol">=</a> <a id="2143" href="Relation.Nullary.Decidable.Core.html#3225" class="Function">T?</a> <a id="2146" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="2148" class="Symbol">(</a><a id="2149" href="Test.Examples.DEx.OffChain.Lib.html#2123" class="Bound">kh</a> <a id="2152" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="2154" href="Test.Examples.DEx.OffChain.Lib.html#2138" class="Bound">x</a><a id="2155" class="Symbol">)</a> <a id="2157" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>
<a id="2159" href="Test.Examples.DEx.OffChain.Lib.html#2030" class="Function">matchWalletHash?</a> <a id="2176" href="Test.Examples.DEx.OffChain.Lib.html#2176" class="Bound">kh</a> <a id="2179" class="Symbol">(</a><a id="2180" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2190" href="Test.Examples.DEx.OffChain.Lib.html#2190" class="Bound">y</a><a id="2191" class="Symbol">)</a> <a id="2193" class="Symbol">=</a> <a id="2195" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2198" class="Symbol">(λ</a> <a id="2201" href="Test.Examples.DEx.OffChain.Lib.html#2201" class="Bound">x₁</a> <a id="2204" class="Symbol">→</a> <a id="2206" href="Test.Examples.DEx.OffChain.Lib.html#2201" class="Bound">x₁</a><a id="2208" class="Symbol">)</a>

<a id="getWalletUTxO"></a><a id="2211" href="Test.Examples.DEx.OffChain.Lib.html#2211" class="Function">getWalletUTxO</a> <a id="2225" class="Symbol">:</a> <a id="2227" class="Symbol">(</a><a id="2228" href="Test.Examples.DEx.OffChain.Lib.html#2228" class="Bound">scriptHash</a> <a id="2239" class="Symbol">:</a> <a id="2241" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2242" class="Symbol">)</a> <a id="2244" class="Symbol">→</a> <a id="2246" href="Ledger.Core.Specification.Transaction.html#2607" class="Function">UTxO</a> <a id="2251" class="Symbol">→</a> <a id="2253" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2258" class="Symbol">(</a><a id="2259" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a> <a id="2264" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2266" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="2271" class="Symbol">)</a>
<a id="2273" href="Test.Examples.DEx.OffChain.Lib.html#2211" class="Function">getWalletUTxO</a> <a id="2287" href="Test.Examples.DEx.OffChain.Lib.html#2287" class="Bound">sh</a> <a id="2290" class="Symbol">(</a><a id="2291" href="Test.Examples.DEx.OffChain.Lib.html#2291" class="Bound">utxo</a> <a id="2296" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2298" href="Test.Examples.DEx.OffChain.Lib.html#2298" class="Bound">prf</a><a id="2301" class="Symbol">)</a> <a id="2303" class="Symbol">=</a> <a id="2305" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="2312" class="Symbol">(λ</a> <a id="2315" class="Symbol">{</a> <a id="2317" class="Symbol">(_</a> <a id="2320" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2322" href="Test.Examples.DEx.OffChain.Lib.html#2322" class="Bound">addr</a> <a id="2327" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2329" class="Symbol">_)</a> <a id="2332" class="Symbol">→</a> <a id="2334" href="Test.Examples.DEx.OffChain.Lib.html#2030" class="Function">matchWalletHash?</a> <a id="2351" href="Test.Examples.DEx.OffChain.Lib.html#2287" class="Bound">sh</a> <a id="2354" class="Symbol">(</a><a id="2355" href="Ledger.Core.Specification.Address.html#2685" class="Function">payCred</a> <a id="2363" href="Test.Examples.DEx.OffChain.Lib.html#2322" class="Bound">addr</a><a id="2367" class="Symbol">)})</a> <a id="2371" class="Symbol">(</a><a id="2372" href="abstract-set-theory.FiniteSetTheory.html#2617" class="Function">setToList</a> <a id="2382" href="Test.Examples.DEx.OffChain.Lib.html#2291" class="Bound">utxo</a><a id="2386" class="Symbol">)</a>

<a id="2389" class="Comment">{-
succeedTxOut&#39; : TxOut
succeedTxOut&#39; = inj₁ (record { net = 0 ;
                           pay = ScriptObj 777 ;
                           stake = just (ScriptObj 777) })
                           , {!!} , just (inj₁ (inj₁ (inj₁ (Always [])))) , nothing
-- 700000000000 -}</a>

<a id="getLabel"></a><a id="2667" href="Test.Examples.DEx.OffChain.Lib.html#2667" class="Function">getLabel</a> <a id="2676" class="Symbol">:</a> <a id="2678" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a> <a id="2684" class="Symbol">→</a> <a id="2686" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2692" href="Test.Examples.DEx.Datum.html#349" class="Datatype">Label</a>
<a id="2698" href="Test.Examples.DEx.OffChain.Lib.html#2667" class="Function">getLabel</a> <a id="2707" class="Symbol">(</a><a id="2708" href="Test.Examples.DEx.OffChain.Lib.html#2708" class="Bound">fst</a> <a id="2712" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2714" href="Test.Examples.DEx.OffChain.Lib.html#2714" class="Bound">fst₁</a> <a id="2719" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2721" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2726" class="Symbol">(</a><a id="2727" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2732" class="Symbol">(</a><a id="2733" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2738" class="Symbol">(</a><a id="2739" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2744" href="Test.Examples.DEx.OffChain.Lib.html#2744" class="Bound">x</a><a id="2745" class="Symbol">)))</a> <a id="2749" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2751" href="Test.Examples.DEx.OffChain.Lib.html#2751" class="Bound">snd</a><a id="2754" class="Symbol">)</a> <a id="2756" class="Symbol">=</a> <a id="2758" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2763" href="Test.Examples.DEx.OffChain.Lib.html#2744" class="Bound">x</a>
<a id="2765" href="Test.Examples.DEx.OffChain.Lib.html#2667" class="Function">getLabel</a> <a id="2774" class="Symbol">(</a><a id="2775" href="Test.Examples.DEx.OffChain.Lib.html#2775" class="Bound">fst</a> <a id="2779" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2781" href="Test.Examples.DEx.OffChain.Lib.html#2781" class="Bound">fst₁</a> <a id="2786" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2788" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2793" class="Symbol">(</a><a id="2794" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2799" class="Symbol">(</a><a id="2800" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2805" class="Symbol">(</a><a id="2806" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2811" href="Test.Examples.DEx.OffChain.Lib.html#2811" class="Bound">y</a><a id="2812" class="Symbol">)))</a> <a id="2816" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2818" href="Test.Examples.DEx.OffChain.Lib.html#2818" class="Bound">snd</a><a id="2821" class="Symbol">)</a> <a id="2823" class="Symbol">=</a> <a id="2825" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2833" href="Test.Examples.DEx.OffChain.Lib.html#2667" class="Function">getLabel</a> <a id="2842" class="Symbol">(</a><a id="2843" href="Test.Examples.DEx.OffChain.Lib.html#2843" class="Bound">fst</a> <a id="2847" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2849" href="Test.Examples.DEx.OffChain.Lib.html#2849" class="Bound">fst₁</a> <a id="2854" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2856" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2861" class="Symbol">(</a><a id="2862" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2867" class="Symbol">(</a><a id="2868" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2873" href="Test.Examples.DEx.OffChain.Lib.html#2873" class="Bound">y</a><a id="2874" class="Symbol">))</a> <a id="2877" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2879" href="Test.Examples.DEx.OffChain.Lib.html#2879" class="Bound">snd</a><a id="2882" class="Symbol">)</a> <a id="2884" class="Symbol">=</a> <a id="2886" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2894" href="Test.Examples.DEx.OffChain.Lib.html#2667" class="Function">getLabel</a> <a id="2903" class="Symbol">(</a><a id="2904" href="Test.Examples.DEx.OffChain.Lib.html#2904" class="Bound">fst</a> <a id="2908" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2910" href="Test.Examples.DEx.OffChain.Lib.html#2910" class="Bound">fst₁</a> <a id="2915" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2917" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2922" class="Symbol">(</a><a id="2923" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2928" href="Test.Examples.DEx.OffChain.Lib.html#2928" class="Bound">y</a><a id="2929" class="Symbol">)</a> <a id="2931" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2933" href="Test.Examples.DEx.OffChain.Lib.html#2933" class="Bound">snd</a><a id="2936" class="Symbol">)</a> <a id="2938" class="Symbol">=</a> <a id="2940" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2948" href="Test.Examples.DEx.OffChain.Lib.html#2667" class="Function">getLabel</a> <a id="2957" class="Symbol">(</a><a id="2958" href="Test.Examples.DEx.OffChain.Lib.html#2958" class="Bound">fst</a> <a id="2962" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2964" href="Test.Examples.DEx.OffChain.Lib.html#2964" class="Bound">fst₁</a> <a id="2969" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2971" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2979" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2981" href="Test.Examples.DEx.OffChain.Lib.html#2981" class="Bound">snd</a><a id="2984" class="Symbol">)</a> <a id="2986" class="Symbol">=</a> <a id="2988" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>



<a id="2999" class="Comment">-- Assumes a list of filtered waller txins and subtracts a default fee from the head of the list</a>
<a id="makeFeeTxOut"></a><a id="3096" href="Test.Examples.DEx.OffChain.Lib.html#3096" class="Function">makeFeeTxOut</a> <a id="3109" class="Symbol">:</a> <a id="3111" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3116" class="Symbol">(</a><a id="3117" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a> <a id="3122" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3124" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="3129" class="Symbol">)</a> <a id="3131" class="Symbol">→</a> <a id="3133" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3138" class="Symbol">(</a><a id="3139" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3141" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3143" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="3148" class="Symbol">)</a>
<a id="3150" href="Test.Examples.DEx.OffChain.Lib.html#3096" class="Function">makeFeeTxOut</a> <a id="3163" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3166" class="Symbol">=</a> <a id="3168" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3171" href="Test.Examples.DEx.OffChain.Lib.html#3096" class="Function">makeFeeTxOut</a> <a id="3184" class="Symbol">((</a><a id="3186" href="Test.Examples.DEx.OffChain.Lib.html#3186" class="Bound">txin</a> <a id="3191" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3193" class="Symbol">(</a><a id="3194" href="Test.Examples.DEx.OffChain.Lib.html#3194" class="Bound">fst</a> <a id="3198" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3200" href="Test.Examples.DEx.OffChain.Lib.html#3200" class="Bound">txValue</a> <a id="3208" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3210" href="Test.Examples.DEx.OffChain.Lib.html#3210" class="Bound">snd</a><a id="3213" class="Symbol">))</a> <a id="3216" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3218" href="Test.Examples.DEx.OffChain.Lib.html#3218" class="Bound">utxos</a><a id="3223" class="Symbol">)</a> <a id="3225" class="Symbol">=</a> <a id="3227" class="Symbol">(</a><a id="3228" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3234" href="Test.Examples.DEx.OffChain.Lib.html#3186" class="Bound">txin</a> <a id="3239" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3241" href="Test.Examples.DEx.OffChain.Lib.html#3194" class="Bound">fst</a> <a id="3245" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3247" href="Test.Examples.DEx.OffChain.Lib.html#3200" class="Bound">txValue</a> <a id="3255" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3257" href="Test.Examples.DEx.Validator.html#883" class="Function">feeValue</a> <a id="3266" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3268" href="Test.Examples.DEx.OffChain.Lib.html#3210" class="Bound">snd</a><a id="3271" class="Symbol">)</a> <a id="3273" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3275" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3278" class="Comment">--10000000000</a>

<a id="makeFeeUnPaymentTxOut"></a><a id="3293" href="Test.Examples.DEx.OffChain.Lib.html#3293" class="Function">makeFeeUnPaymentTxOut</a> <a id="3315" class="Symbol">:</a> <a id="3317" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3322" class="Symbol">(</a><a id="3323" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a> <a id="3328" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3330" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="3335" class="Symbol">)</a> <a id="3337" class="Symbol">→</a> <a id="3339" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="3345" class="Symbol">→</a> <a id="3347" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3352" class="Symbol">(</a><a id="3353" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3355" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3357" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="3362" class="Symbol">)</a>
<a id="3364" href="Test.Examples.DEx.OffChain.Lib.html#3293" class="Function">makeFeeUnPaymentTxOut</a> <a id="3386" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3389" href="Test.Examples.DEx.OffChain.Lib.html#3389" class="Bound">v</a> <a id="3391" class="Symbol">=</a> <a id="3393" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3396" href="Test.Examples.DEx.OffChain.Lib.html#3293" class="Function">makeFeeUnPaymentTxOut</a> <a id="3418" class="Symbol">((</a><a id="3420" href="Test.Examples.DEx.OffChain.Lib.html#3420" class="Bound">txin</a> <a id="3425" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3427" class="Symbol">(</a><a id="3428" href="Test.Examples.DEx.OffChain.Lib.html#3428" class="Bound">fst</a> <a id="3432" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3434" href="Test.Examples.DEx.OffChain.Lib.html#3434" class="Bound">txValue</a> <a id="3442" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3444" href="Test.Examples.DEx.OffChain.Lib.html#3444" class="Bound">snd</a><a id="3447" class="Symbol">))</a> <a id="3450" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3452" href="Test.Examples.DEx.OffChain.Lib.html#3452" class="Bound">utxos</a><a id="3457" class="Symbol">)</a> <a id="3459" href="Test.Examples.DEx.OffChain.Lib.html#3459" class="Bound">v</a> <a id="3461" class="Symbol">=</a> <a id="3463" class="Symbol">(</a><a id="3464" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3470" href="Test.Examples.DEx.OffChain.Lib.html#3420" class="Bound">txin</a> <a id="3475" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3477" href="Test.Examples.DEx.OffChain.Lib.html#3428" class="Bound">fst</a> <a id="3481" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3483" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3487" class="Symbol">{{</a><a id="3489" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="3497" class="Symbol">}}</a> <a id="3500" class="Symbol">(</a><a id="3501" href="Test.Examples.DEx.OffChain.Lib.html#3434" class="Bound">txValue</a> <a id="3509" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3511" href="Test.Examples.DEx.Validator.html#883" class="Function">feeValue</a><a id="3519" class="Symbol">)</a> <a id="3521" href="Test.Examples.DEx.OffChain.Lib.html#3459" class="Bound">v</a> <a id="3523" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3525" href="Test.Examples.DEx.OffChain.Lib.html#3444" class="Bound">snd</a><a id="3528" class="Symbol">)</a> <a id="3530" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3532" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3535" class="Comment">-- 10000000000</a>

<a id="makeFeePaymentTxOut"></a><a id="3551" href="Test.Examples.DEx.OffChain.Lib.html#3551" class="Function">makeFeePaymentTxOut</a> <a id="3571" class="Symbol">:</a> <a id="3573" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3578" class="Symbol">(</a><a id="3579" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a> <a id="3584" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3586" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="3591" class="Symbol">)</a> <a id="3593" class="Symbol">→</a> <a id="3595" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="3601" class="Symbol">→</a> <a id="3603" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3608" class="Symbol">(</a><a id="3609" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3611" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3613" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="3618" class="Symbol">)</a>
<a id="3620" href="Test.Examples.DEx.OffChain.Lib.html#3551" class="Function">makeFeePaymentTxOut</a> <a id="3640" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3643" href="Test.Examples.DEx.OffChain.Lib.html#3643" class="Bound">v</a> <a id="3645" class="Symbol">=</a> <a id="3647" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3650" href="Test.Examples.DEx.OffChain.Lib.html#3551" class="Function">makeFeePaymentTxOut</a> <a id="3670" class="Symbol">((</a><a id="3672" href="Test.Examples.DEx.OffChain.Lib.html#3672" class="Bound">txin</a> <a id="3677" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3679" class="Symbol">(</a><a id="3680" href="Test.Examples.DEx.OffChain.Lib.html#3680" class="Bound">fst</a> <a id="3684" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3686" href="Test.Examples.DEx.OffChain.Lib.html#3686" class="Bound">txValue</a> <a id="3694" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3696" href="Test.Examples.DEx.OffChain.Lib.html#3696" class="Bound">snd</a><a id="3699" class="Symbol">))</a> <a id="3702" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3704" href="Test.Examples.DEx.OffChain.Lib.html#3704" class="Bound">utxos</a><a id="3709" class="Symbol">)</a> <a id="3711" href="Test.Examples.DEx.OffChain.Lib.html#3711" class="Bound">v</a> <a id="3713" class="Symbol">=</a> <a id="3715" class="Symbol">(</a><a id="3716" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3722" href="Test.Examples.DEx.OffChain.Lib.html#3672" class="Bound">txin</a> <a id="3727" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3729" href="Test.Examples.DEx.OffChain.Lib.html#3680" class="Bound">fst</a> <a id="3733" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3735" class="Symbol">(</a><a id="3736" href="Test.Examples.DEx.OffChain.Lib.html#3686" class="Bound">txValue</a> <a id="3744" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3746" href="Test.Examples.DEx.Validator.html#883" class="Function">feeValue</a> <a id="3755" class="Symbol">)</a> <a id="3757" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3759" href="Test.Examples.DEx.OffChain.Lib.html#3711" class="Bound">v</a> <a id="3761" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3763" href="Test.Examples.DEx.OffChain.Lib.html#3696" class="Bound">snd</a><a id="3766" class="Symbol">)</a> <a id="3768" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3770" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3773" class="Comment">--10000000000</a>

<a id="makeFeeSwapTxOut"></a><a id="3788" href="Test.Examples.DEx.OffChain.Lib.html#3788" class="Function">makeFeeSwapTxOut</a> <a id="3805" class="Symbol">:</a> <a id="3807" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3812" class="Symbol">(</a><a id="3813" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a> <a id="3818" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3820" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="3825" class="Symbol">)</a> <a id="3827" class="Symbol">→</a> <a id="3829" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="3835" class="Symbol">→</a> <a id="3837" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="3843" class="Symbol">→</a> <a id="3845" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3850" class="Symbol">(</a><a id="3851" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3853" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3855" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="3860" class="Symbol">)</a>
<a id="3862" href="Test.Examples.DEx.OffChain.Lib.html#3788" class="Function">makeFeeSwapTxOut</a> <a id="3879" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3882" href="Test.Examples.DEx.OffChain.Lib.html#3882" class="Bound">v1</a> <a id="3885" href="Test.Examples.DEx.OffChain.Lib.html#3885" class="Bound">v2</a> <a id="3888" class="Symbol">=</a> <a id="3890" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3893" href="Test.Examples.DEx.OffChain.Lib.html#3788" class="Function">makeFeeSwapTxOut</a> <a id="3910" class="Symbol">((</a><a id="3912" href="Test.Examples.DEx.OffChain.Lib.html#3912" class="Bound">txin</a> <a id="3917" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3919" class="Symbol">(</a><a id="3920" href="Test.Examples.DEx.OffChain.Lib.html#3920" class="Bound">fst</a> <a id="3924" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3926" href="Test.Examples.DEx.OffChain.Lib.html#3926" class="Bound">txValue</a> <a id="3934" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3936" href="Test.Examples.DEx.OffChain.Lib.html#3936" class="Bound">snd</a><a id="3939" class="Symbol">))</a> <a id="3942" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3944" href="Test.Examples.DEx.OffChain.Lib.html#3944" class="Bound">utxos</a><a id="3949" class="Symbol">)</a> <a id="3951" href="Test.Examples.DEx.OffChain.Lib.html#3951" class="Bound">refund</a> <a id="3958" href="Test.Examples.DEx.OffChain.Lib.html#3958" class="Bound">new</a> <a id="3962" class="Symbol">=</a> <a id="3964" class="Symbol">(</a><a id="3965" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3971" href="Test.Examples.DEx.OffChain.Lib.html#3912" class="Bound">txin</a> <a id="3976" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3978" href="Test.Examples.DEx.OffChain.Lib.html#3920" class="Bound">fst</a> <a id="3982" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3984" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3988" class="Symbol">{{</a><a id="3990" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="3998" class="Symbol">}}</a> <a id="4001" class="Symbol">((</a><a id="4003" href="Test.Examples.DEx.OffChain.Lib.html#3926" class="Bound">txValue</a> <a id="4011" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="4013" href="Test.Examples.DEx.Validator.html#883" class="Function">feeValue</a> <a id="4022" class="Symbol">)</a> <a id="4024" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="4026" href="Test.Examples.DEx.OffChain.Lib.html#3958" class="Bound">new</a><a id="4029" class="Symbol">)</a> <a id="4031" href="Test.Examples.DEx.OffChain.Lib.html#3951" class="Bound">refund</a> <a id="4038" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4040" href="Test.Examples.DEx.OffChain.Lib.html#3936" class="Bound">snd</a><a id="4043" class="Symbol">)</a> <a id="4045" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4047" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="4051" class="Comment">-- return id of 0 if no txins</a>
<a id="getTxId"></a><a id="4081" href="Test.Examples.DEx.OffChain.Lib.html#4081" class="Function">getTxId</a> <a id="4089" class="Symbol">:</a> <a id="4091" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4096" class="Symbol">(</a><a id="4097" href="Ledger.Core.Specification.Transaction.html#2496" class="Function">TxIn</a> <a id="4102" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4104" href="Ledger.Core.Specification.Transaction.html#2529" class="Function">TxOut</a><a id="4109" class="Symbol">)</a> <a id="4111" class="Symbol">→</a> <a id="4113" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="4115" href="Test.Examples.DEx.OffChain.Lib.html#4081" class="Function">getTxId</a> <a id="4123" href="Test.Examples.DEx.OffChain.Lib.html#4123" class="Bound">xs</a> <a id="4126" class="Symbol">=</a> <a id="4128" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="4134" class="Symbol">(λ</a> <a id="4137" href="Test.Examples.DEx.OffChain.Lib.html#4137" class="Bound">x</a> <a id="4139" class="Symbol">→</a> <a id="4141" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4147" class="Symbol">(</a><a id="4148" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4154" href="Test.Examples.DEx.OffChain.Lib.html#4137" class="Bound">x</a><a id="4155" class="Symbol">))</a> <a id="4158" class="Number">0</a> <a id="4160" class="Symbol">(</a><a id="4161" href="Data.List.Base.html#8143" class="Function">head</a> <a id="4166" href="Test.Examples.DEx.OffChain.Lib.html#4123" class="Bound">xs</a><a id="4168" class="Symbol">)</a>

<a id="4171" class="Comment">{-
getVal : Label -&gt; ℕ -&gt; Value
getVal (Always l) w with lookup&#39; w l
...| nothing = emptyValue
...| just v = v
-}</a>



</pre></body></html>