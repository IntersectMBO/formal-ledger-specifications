<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Test.Examples.DEx.OffChain.Lib</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">module</a> <a id="32" href="Test.Examples.DEx.OffChain.Lib.html" class="Module">Test.Examples.DEx.OffChain.Lib</a> <a id="63" class="Keyword">where</a>

<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="Data.List.html" class="Module">Data.List</a> <a id="92" class="Keyword">using</a> <a id="98" class="Symbol">(</a><a id="99" href="Data.List.Base.html#10389" class="Function">filter</a><a id="105" class="Symbol">)</a>

<a id="108" class="Keyword">open</a> <a id="113" class="Keyword">import</a> <a id="120" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="187" class="Keyword">using</a> <a id="193" class="Symbol">(</a><a id="194" href="Ledger.Conway.Specification.Transaction.html#991" class="Record">TransactionStructure</a><a id="214" class="Symbol">)</a>

<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Test.Examples.DEx.Datum.html" class="Module">Test.Examples.DEx.Datum</a>
<a id="253" class="Keyword">open</a> <a id="258" class="Keyword">import</a> <a id="265" href="Test.Examples.DEx.Validator.html" class="Module">Test.Examples.DEx.Validator</a>
<a id="293" class="Keyword">open</a> <a id="298" class="Keyword">import</a> <a id="305" href="Test.Prelude.html" class="Module">Test.Prelude</a> <a id="318" href="Test.Examples.DEx.Datum.html#695" class="Function">DExData</a>
<a id="326" class="Keyword">open</a> <a id="331" class="Keyword">import</a> <a id="338" href="Test.SymbolicData.html" class="Module">Test.SymbolicData</a> <a id="356" href="Test.Examples.DEx.Datum.html#695" class="Function">DExData</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Test.LedgerImplementation.html" class="Module">Test.LedgerImplementation</a> <a id="402" href="Test.SymbolicData.html#240" class="Function">SData</a> <a id="408" href="Test.SymbolicData.html#240" class="Function">SData</a>

<a id="415" class="Keyword">open</a> <a id="420" href="Ledger.Conway.Specification.Transaction.html#991" class="Module">TransactionStructure</a> <a id="441" href="Test.LedgerImplementation.html#4277" class="Function">SVTransactionStructure</a>

<a id="465" class="Keyword">open</a> <a id="470" class="Keyword">import</a> <a id="477" href="Test.AbstractImplementation.html" class="Module">Test.AbstractImplementation</a> <a id="505" href="Test.SymbolicData.html#2904" class="Function">valContext</a>

<a id="517" class="Keyword">open</a> <a id="522" class="Keyword">import</a> <a id="529" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a>

<a id="defaultTxBody"></a><a id="570" href="Test.Examples.DEx.OffChain.Lib.html#570" class="Function">defaultTxBody</a> <a id="584" class="Symbol">:</a> <a id="586" href="Ledger.Conway.Specification.Transaction.html#2982" class="Record">TxBody</a>
<a id="593" href="Test.Examples.DEx.OffChain.Lib.html#570" class="Function">defaultTxBody</a> <a id="607" class="Symbol">=</a> <a id="609" class="Keyword">record</a>
                  <a id="634" class="Symbol">{</a> <a id="636" href="Ledger.Conway.Specification.Transaction.html#3018" class="Field">txIns</a> <a id="642" class="Symbol">=</a> <a id="644" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="664" class="Symbol">;</a> <a id="666" href="Ledger.Conway.Specification.Transaction.html#3054" class="Field">refInputs</a> <a id="676" class="Symbol">=</a> <a id="678" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="698" class="Symbol">;</a> <a id="700" href="Ledger.Conway.Specification.Transaction.html#3090" class="Field">collateralInputs</a> <a id="717" class="Symbol">=</a> <a id="719" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="739" class="Symbol">;</a> <a id="741" href="Ledger.Conway.Specification.Transaction.html#3126" class="Field">txOuts</a> <a id="748" class="Symbol">=</a>  <a id="751" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="771" class="Symbol">;</a> <a id="773" href="Ledger.Conway.Specification.Transaction.html#3240" class="Field">txFee</a> <a id="779" class="Symbol">=</a> <a id="781" class="Number">10000000000</a>
                  <a id="811" class="Symbol">;</a> <a id="813" href="Ledger.Conway.Specification.Transaction.html#3624" class="Field">mint</a> <a id="818" class="Symbol">=</a> <a id="820" class="Number">0</a>
                  <a id="840" class="Symbol">;</a> <a id="842" href="Ledger.Conway.Specification.Transaction.html#3315" class="Field">txVldt</a> <a id="849" class="Symbol">=</a> <a id="851" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="859" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="861" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="887" class="Symbol">;</a> <a id="889" href="Ledger.Conway.Specification.Transaction.html#3200" class="Field">txCerts</a> <a id="897" class="Symbol">=</a> <a id="899" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="920" class="Symbol">;</a> <a id="922" href="Ledger.Conway.Specification.Transaction.html#3274" class="Field">txWithdrawals</a> <a id="936" class="Symbol">=</a> <a id="938" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="958" class="Symbol">;</a> <a id="960" href="Ledger.Conway.Specification.Transaction.html#3449" class="Field">txGovVotes</a> <a id="971" class="Symbol">=</a> <a id="973" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="994" class="Symbol">;</a> <a id="996" href="Ledger.Conway.Specification.Transaction.html#3491" class="Field">txGovProposals</a> <a id="1011" class="Symbol">=</a> <a id="1013" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
                  <a id="1034" class="Symbol">;</a> <a id="1036" href="Ledger.Conway.Specification.Transaction.html#3410" class="Field">txDonation</a> <a id="1047" class="Symbol">=</a> <a id="1049" class="Number">0</a>
                  <a id="1069" class="Symbol">;</a> <a id="1071" href="Ledger.Conway.Specification.Transaction.html#3368" class="Field">txADhash</a> <a id="1080" class="Symbol">=</a> <a id="1082" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1108" class="Symbol">;</a> <a id="1110" href="Ledger.Conway.Specification.Transaction.html#3537" class="Field">txNetworkId</a> <a id="1122" class="Symbol">=</a> <a id="1124" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1129" class="Number">0</a>
                  <a id="1149" class="Symbol">;</a> <a id="1151" href="Ledger.Conway.Specification.Transaction.html#3580" class="Field">currentTreasury</a> <a id="1167" class="Symbol">=</a> <a id="1169" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1195" class="Symbol">;</a> <a id="1197" href="Ledger.Conway.Specification.Transaction.html#3166" class="Field">txId</a> <a id="1202" class="Symbol">=</a> <a id="1204" class="Number">0</a>
                  <a id="1224" class="Symbol">;</a> <a id="1226" href="Ledger.Conway.Specification.Transaction.html#3659" class="Field">reqSignerHashes</a> <a id="1242" class="Symbol">=</a> <a id="1244" href="Class.HasEmptySet.html#287" class="Field">∅</a>
                  <a id="1264" class="Symbol">;</a> <a id="1266" href="Ledger.Conway.Specification.Transaction.html#3698" class="Field">scriptIntegrityHash</a> <a id="1286" class="Symbol">=</a> <a id="1288" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
                  <a id="1314" class="Symbol">}</a>

<a id="matchScriptAddress"></a><a id="1317" href="Test.Examples.DEx.OffChain.Lib.html#1317" class="Function">matchScriptAddress</a> <a id="1336" class="Symbol">:</a> <a id="1338" class="Symbol">(</a><a id="1339" href="Test.Examples.DEx.OffChain.Lib.html#1339" class="Bound">scriptHash</a> <a id="1350" class="Symbol">:</a> <a id="1352" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1353" class="Symbol">)</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="1368" class="Symbol">→</a> <a id="1370" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1374" href="Test.Examples.DEx.OffChain.Lib.html#1317" class="Function">matchScriptAddress</a> <a id="1393" href="Test.Examples.DEx.OffChain.Lib.html#1393" class="Bound">sh</a> <a id="1396" class="Symbol">(</a><a id="1397" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1408" href="Test.Examples.DEx.OffChain.Lib.html#1408" class="Bound">x</a><a id="1409" class="Symbol">)</a> <a id="1411" class="Symbol">=</a> <a id="1413" href="Data.Empty.html#914" class="Function">⊥</a>
<a id="1415" href="Test.Examples.DEx.OffChain.Lib.html#1317" class="Function">matchScriptAddress</a> <a id="1434" href="Test.Examples.DEx.OffChain.Lib.html#1434" class="Bound">sh</a> <a id="1437" class="Symbol">(</a><a id="1438" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="1448" href="Test.Examples.DEx.OffChain.Lib.html#1448" class="Bound">y</a><a id="1449" class="Symbol">)</a> <a id="1451" class="Symbol">=</a> <a id="1453" href="Relation.Nullary.Decidable.Core.html#4876" class="Function">True</a> <a id="1458" class="Symbol">(</a><a id="1459" href="Test.Examples.DEx.OffChain.Lib.html#1434" class="Bound">sh</a> <a id="1462" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1464" href="Test.Examples.DEx.OffChain.Lib.html#1448" class="Bound">y</a><a id="1465" class="Symbol">)</a>

<a id="matchScriptAddress?"></a><a id="1468" href="Test.Examples.DEx.OffChain.Lib.html#1468" class="Function">matchScriptAddress?</a> <a id="1488" class="Symbol">:</a> <a id="1490" class="Symbol">(</a><a id="1491" href="Test.Examples.DEx.OffChain.Lib.html#1491" class="Bound">sh</a> <a id="1494" class="Symbol">:</a> <a id="1496" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1497" class="Symbol">)</a> <a id="1499" class="Symbol">→</a> <a id="1501" class="Symbol">(</a><a id="1502" href="Test.Examples.DEx.OffChain.Lib.html#1502" class="Bound">c</a> <a id="1504" class="Symbol">:</a> <a id="1506" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="1516" class="Symbol">)</a> <a id="1518" class="Symbol">→</a> <a id="1520" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1524" class="Symbol">(</a><a id="1525" href="Test.Examples.DEx.OffChain.Lib.html#1317" class="Function">matchScriptAddress</a> <a id="1544" href="Test.Examples.DEx.OffChain.Lib.html#1491" class="Bound">sh</a> <a id="1547" href="Test.Examples.DEx.OffChain.Lib.html#1502" class="Bound">c</a><a id="1548" class="Symbol">)</a>
<a id="1550" href="Test.Examples.DEx.OffChain.Lib.html#1468" class="Function">matchScriptAddress?</a> <a id="1570" href="Test.Examples.DEx.OffChain.Lib.html#1570" class="Bound">sh</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1585" href="Test.Examples.DEx.OffChain.Lib.html#1585" class="Bound">x</a><a id="1586" class="Symbol">)</a> <a id="1588" class="Symbol">=</a> <a id="1590" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1593" class="Symbol">(λ</a> <a id="1596" href="Test.Examples.DEx.OffChain.Lib.html#1596" class="Bound">x₁</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Test.Examples.DEx.OffChain.Lib.html#1596" class="Bound">x₁</a><a id="1603" class="Symbol">)</a>
<a id="1605" href="Test.Examples.DEx.OffChain.Lib.html#1468" class="Function">matchScriptAddress?</a> <a id="1625" href="Test.Examples.DEx.OffChain.Lib.html#1625" class="Bound">sh</a> <a id="1628" class="Symbol">(</a><a id="1629" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="1639" href="Test.Examples.DEx.OffChain.Lib.html#1639" class="Bound">y</a><a id="1640" class="Symbol">)</a> <a id="1642" class="Symbol">=</a> <a id="1644" href="Relation.Nullary.Decidable.Core.html#3225" class="Function">T?</a> <a id="1647" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="1649" class="Symbol">(</a><a id="1650" href="Test.Examples.DEx.OffChain.Lib.html#1625" class="Bound">sh</a> <a id="1653" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1655" href="Test.Examples.DEx.OffChain.Lib.html#1639" class="Bound">y</a><a id="1656" class="Symbol">)</a> <a id="1658" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>

<a id="getScriptUTxO"></a><a id="1661" href="Test.Examples.DEx.OffChain.Lib.html#1661" class="Function">getScriptUTxO</a> <a id="1675" class="Symbol">:</a> <a id="1677" class="Symbol">(</a><a id="1678" href="Test.Examples.DEx.OffChain.Lib.html#1678" class="Bound">scriptHash</a> <a id="1689" class="Symbol">:</a> <a id="1691" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1692" class="Symbol">)</a> <a id="1694" class="Symbol">→</a> <a id="1696" href="Ledger.Conway.Specification.Transaction.html#2702" class="Function">UTxO</a> <a id="1701" class="Symbol">→</a> <a id="1703" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1709" class="Symbol">(</a><a id="1710" href="Ledger.Conway.Specification.Transaction.html#2591" class="Function">TxIn</a> <a id="1715" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1717" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="1722" class="Symbol">)</a>
<a id="1724" href="Test.Examples.DEx.OffChain.Lib.html#1661" class="Function">getScriptUTxO</a> <a id="1738" href="Test.Examples.DEx.OffChain.Lib.html#1738" class="Bound">sh</a> <a id="1741" class="Symbol">(</a><a id="1742" href="Test.Examples.DEx.OffChain.Lib.html#1742" class="Bound">utxo</a> <a id="1747" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1749" href="Test.Examples.DEx.OffChain.Lib.html#1749" class="Bound">prf</a><a id="1752" class="Symbol">)</a> <a id="1754" class="Symbol">=</a> <a id="1756" href="Data.List.Base.html#8143" class="Function">head</a> <a id="1761" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1763" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="1770" class="Symbol">(λ</a> <a id="1773" class="Symbol">{</a> <a id="1775" class="Symbol">(_</a> <a id="1778" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1780" href="Test.Examples.DEx.OffChain.Lib.html#1780" class="Bound">addr</a> <a id="1785" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1787" class="Symbol">_)</a> <a id="1790" class="Symbol">→</a> <a id="1792" href="Test.Examples.DEx.OffChain.Lib.html#1468" class="Function">matchScriptAddress?</a> <a id="1812" href="Test.Examples.DEx.OffChain.Lib.html#1738" class="Bound">sh</a> <a id="1815" class="Symbol">(</a><a id="1816" href="Ledger.Core.Specification.Address.html#2685" class="Function">payCred</a> <a id="1824" href="Test.Examples.DEx.OffChain.Lib.html#1780" class="Bound">addr</a><a id="1828" class="Symbol">)})</a> <a id="1832" class="Symbol">(</a><a id="1833" href="abstract-set-theory.FiniteSetTheory.html#2617" class="Function">setToList</a> <a id="1843" href="Test.Examples.DEx.OffChain.Lib.html#1742" class="Bound">utxo</a><a id="1847" class="Symbol">)</a>

<a id="matchWalletHash"></a><a id="1850" href="Test.Examples.DEx.OffChain.Lib.html#1850" class="Function">matchWalletHash</a> <a id="1866" class="Symbol">:</a> <a id="1868" class="Symbol">(</a><a id="1869" href="Test.Examples.DEx.OffChain.Lib.html#1869" class="Bound">keyHash</a> <a id="1877" class="Symbol">:</a> <a id="1879" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1880" class="Symbol">)</a> <a id="1882" class="Symbol">→</a> <a id="1884" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a> <a id="1895" class="Symbol">→</a> <a id="1897" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1901" href="Test.Examples.DEx.OffChain.Lib.html#1850" class="Function">matchWalletHash</a> <a id="1917" href="Test.Examples.DEx.OffChain.Lib.html#1917" class="Bound">kh</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="1932" href="Test.Examples.DEx.OffChain.Lib.html#1932" class="Bound">x</a><a id="1933" class="Symbol">)</a> <a id="1935" class="Symbol">=</a> <a id="1937" href="Relation.Nullary.Decidable.Core.html#4876" class="Function">True</a> <a id="1942" class="Symbol">(</a><a id="1943" href="Test.Examples.DEx.OffChain.Lib.html#1917" class="Bound">kh</a> <a id="1946" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="1948" href="Test.Examples.DEx.OffChain.Lib.html#1932" class="Bound">x</a><a id="1949" class="Symbol">)</a>
<a id="1951" href="Test.Examples.DEx.OffChain.Lib.html#1850" class="Function">matchWalletHash</a> <a id="1967" href="Test.Examples.DEx.OffChain.Lib.html#1967" class="Bound">kh</a> <a id="1970" class="Symbol">(</a><a id="1971" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="1981" href="Test.Examples.DEx.OffChain.Lib.html#1981" class="Bound">y</a><a id="1982" class="Symbol">)</a> <a id="1984" class="Symbol">=</a> <a id="1986" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="matchWalletHash?"></a><a id="1989" href="Test.Examples.DEx.OffChain.Lib.html#1989" class="Function">matchWalletHash?</a> <a id="2006" class="Symbol">:</a> <a id="2008" class="Symbol">(</a><a id="2009" href="Test.Examples.DEx.OffChain.Lib.html#2009" class="Bound">sh</a> <a id="2012" class="Symbol">:</a> <a id="2014" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2015" class="Symbol">)</a> <a id="2017" class="Symbol">→</a> <a id="2019" class="Symbol">(</a><a id="2020" href="Test.Examples.DEx.OffChain.Lib.html#2020" class="Bound">c</a> <a id="2022" class="Symbol">:</a> <a id="2024" href="Ledger.Core.Specification.Address.html#259" class="Datatype">Credential</a><a id="2034" class="Symbol">)</a> <a id="2036" class="Symbol">→</a> <a id="2038" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="2042" class="Symbol">(</a><a id="2043" href="Test.Examples.DEx.OffChain.Lib.html#1850" class="Function">matchWalletHash</a> <a id="2059" href="Test.Examples.DEx.OffChain.Lib.html#2009" class="Bound">sh</a> <a id="2062" href="Test.Examples.DEx.OffChain.Lib.html#2020" class="Bound">c</a><a id="2063" class="Symbol">)</a>
<a id="2065" href="Test.Examples.DEx.OffChain.Lib.html#1989" class="Function">matchWalletHash?</a> <a id="2082" href="Test.Examples.DEx.OffChain.Lib.html#2082" class="Bound">kh</a> <a id="2085" class="Symbol">(</a><a id="2086" href="Ledger.Core.Specification.Address.html#285" class="InductiveConstructor">KeyHashObj</a> <a id="2097" href="Test.Examples.DEx.OffChain.Lib.html#2097" class="Bound">x</a><a id="2098" class="Symbol">)</a> <a id="2100" class="Symbol">=</a> <a id="2102" href="Relation.Nullary.Decidable.Core.html#3225" class="Function">T?</a> <a id="2105" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌊</a> <a id="2107" class="Symbol">(</a><a id="2108" href="Test.Examples.DEx.OffChain.Lib.html#2082" class="Bound">kh</a> <a id="2111" href="Class.DecEq.Core.html#168" class="Field Operator">≟</a> <a id="2113" href="Test.Examples.DEx.OffChain.Lib.html#2097" class="Bound">x</a><a id="2114" class="Symbol">)</a> <a id="2116" href="Relation.Nullary.Decidable.Core.html#5031" class="Function Operator">⌋</a>
<a id="2118" href="Test.Examples.DEx.OffChain.Lib.html#1989" class="Function">matchWalletHash?</a> <a id="2135" href="Test.Examples.DEx.OffChain.Lib.html#2135" class="Bound">kh</a> <a id="2138" class="Symbol">(</a><a id="2139" href="Ledger.Core.Specification.Address.html#321" class="InductiveConstructor">ScriptObj</a> <a id="2149" href="Test.Examples.DEx.OffChain.Lib.html#2149" class="Bound">y</a><a id="2150" class="Symbol">)</a> <a id="2152" class="Symbol">=</a> <a id="2154" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="2157" class="Symbol">(λ</a> <a id="2160" href="Test.Examples.DEx.OffChain.Lib.html#2160" class="Bound">x₁</a> <a id="2163" class="Symbol">→</a> <a id="2165" href="Test.Examples.DEx.OffChain.Lib.html#2160" class="Bound">x₁</a><a id="2167" class="Symbol">)</a>

<a id="getWalletUTxO"></a><a id="2170" href="Test.Examples.DEx.OffChain.Lib.html#2170" class="Function">getWalletUTxO</a> <a id="2184" class="Symbol">:</a> <a id="2186" class="Symbol">(</a><a id="2187" href="Test.Examples.DEx.OffChain.Lib.html#2187" class="Bound">scriptHash</a> <a id="2198" class="Symbol">:</a> <a id="2200" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2201" class="Symbol">)</a> <a id="2203" class="Symbol">→</a> <a id="2205" href="Ledger.Conway.Specification.Transaction.html#2702" class="Function">UTxO</a> <a id="2210" class="Symbol">→</a> <a id="2212" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2217" class="Symbol">(</a><a id="2218" href="Ledger.Conway.Specification.Transaction.html#2591" class="Function">TxIn</a> <a id="2223" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2225" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="2230" class="Symbol">)</a>
<a id="2232" href="Test.Examples.DEx.OffChain.Lib.html#2170" class="Function">getWalletUTxO</a> <a id="2246" href="Test.Examples.DEx.OffChain.Lib.html#2246" class="Bound">sh</a> <a id="2249" class="Symbol">(</a><a id="2250" href="Test.Examples.DEx.OffChain.Lib.html#2250" class="Bound">utxo</a> <a id="2255" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2257" href="Test.Examples.DEx.OffChain.Lib.html#2257" class="Bound">prf</a><a id="2260" class="Symbol">)</a> <a id="2262" class="Symbol">=</a> <a id="2264" href="Data.List.Base.html#10389" class="Function">filter</a> <a id="2271" class="Symbol">(λ</a> <a id="2274" class="Symbol">{</a> <a id="2276" class="Symbol">(_</a> <a id="2279" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2281" href="Test.Examples.DEx.OffChain.Lib.html#2281" class="Bound">addr</a> <a id="2286" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2288" class="Symbol">_)</a> <a id="2291" class="Symbol">→</a> <a id="2293" href="Test.Examples.DEx.OffChain.Lib.html#1989" class="Function">matchWalletHash?</a> <a id="2310" href="Test.Examples.DEx.OffChain.Lib.html#2246" class="Bound">sh</a> <a id="2313" class="Symbol">(</a><a id="2314" href="Ledger.Core.Specification.Address.html#2685" class="Function">payCred</a> <a id="2322" href="Test.Examples.DEx.OffChain.Lib.html#2281" class="Bound">addr</a><a id="2326" class="Symbol">)})</a> <a id="2330" class="Symbol">(</a><a id="2331" href="abstract-set-theory.FiniteSetTheory.html#2617" class="Function">setToList</a> <a id="2341" href="Test.Examples.DEx.OffChain.Lib.html#2250" class="Bound">utxo</a><a id="2345" class="Symbol">)</a>

<a id="2348" class="Comment">{-
succeedTxOut&#39; : TxOut
succeedTxOut&#39; = inj₁ (record { net = 0 ;
                           pay = ScriptObj 777 ;
                           stake = just (ScriptObj 777) })
                           , {!!} , just (inj₁ (inj₁ (inj₁ (Always [])))) , nothing
-- 700000000000 -}</a>

<a id="getLabel"></a><a id="2626" href="Test.Examples.DEx.OffChain.Lib.html#2626" class="Function">getLabel</a> <a id="2635" class="Symbol">:</a> <a id="2637" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a> <a id="2643" class="Symbol">→</a> <a id="2645" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2651" href="Test.Examples.DEx.Datum.html#349" class="Datatype">Label</a>
<a id="2657" href="Test.Examples.DEx.OffChain.Lib.html#2626" class="Function">getLabel</a> <a id="2666" class="Symbol">(</a><a id="2667" href="Test.Examples.DEx.OffChain.Lib.html#2667" class="Bound">fst</a> <a id="2671" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2673" href="Test.Examples.DEx.OffChain.Lib.html#2673" class="Bound">fst₁</a> <a id="2678" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2680" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2685" class="Symbol">(</a><a id="2686" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2691" class="Symbol">(</a><a id="2692" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2697" class="Symbol">(</a><a id="2698" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2703" href="Test.Examples.DEx.OffChain.Lib.html#2703" class="Bound">x</a><a id="2704" class="Symbol">)))</a> <a id="2708" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2710" href="Test.Examples.DEx.OffChain.Lib.html#2710" class="Bound">snd</a><a id="2713" class="Symbol">)</a> <a id="2715" class="Symbol">=</a> <a id="2717" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2722" href="Test.Examples.DEx.OffChain.Lib.html#2703" class="Bound">x</a>
<a id="2724" href="Test.Examples.DEx.OffChain.Lib.html#2626" class="Function">getLabel</a> <a id="2733" class="Symbol">(</a><a id="2734" href="Test.Examples.DEx.OffChain.Lib.html#2734" class="Bound">fst</a> <a id="2738" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2740" href="Test.Examples.DEx.OffChain.Lib.html#2740" class="Bound">fst₁</a> <a id="2745" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2747" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2752" class="Symbol">(</a><a id="2753" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2758" class="Symbol">(</a><a id="2759" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2764" class="Symbol">(</a><a id="2765" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2770" href="Test.Examples.DEx.OffChain.Lib.html#2770" class="Bound">y</a><a id="2771" class="Symbol">)))</a> <a id="2775" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2777" href="Test.Examples.DEx.OffChain.Lib.html#2777" class="Bound">snd</a><a id="2780" class="Symbol">)</a> <a id="2782" class="Symbol">=</a> <a id="2784" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2792" href="Test.Examples.DEx.OffChain.Lib.html#2626" class="Function">getLabel</a> <a id="2801" class="Symbol">(</a><a id="2802" href="Test.Examples.DEx.OffChain.Lib.html#2802" class="Bound">fst</a> <a id="2806" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2808" href="Test.Examples.DEx.OffChain.Lib.html#2808" class="Bound">fst₁</a> <a id="2813" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2815" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2820" class="Symbol">(</a><a id="2821" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="2826" class="Symbol">(</a><a id="2827" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2832" href="Test.Examples.DEx.OffChain.Lib.html#2832" class="Bound">y</a><a id="2833" class="Symbol">))</a> <a id="2836" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2838" href="Test.Examples.DEx.OffChain.Lib.html#2838" class="Bound">snd</a><a id="2841" class="Symbol">)</a> <a id="2843" class="Symbol">=</a> <a id="2845" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2853" href="Test.Examples.DEx.OffChain.Lib.html#2626" class="Function">getLabel</a> <a id="2862" class="Symbol">(</a><a id="2863" href="Test.Examples.DEx.OffChain.Lib.html#2863" class="Bound">fst</a> <a id="2867" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2869" href="Test.Examples.DEx.OffChain.Lib.html#2869" class="Bound">fst₁</a> <a id="2874" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2876" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2881" class="Symbol">(</a><a id="2882" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="2887" href="Test.Examples.DEx.OffChain.Lib.html#2887" class="Bound">y</a><a id="2888" class="Symbol">)</a> <a id="2890" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2892" href="Test.Examples.DEx.OffChain.Lib.html#2892" class="Bound">snd</a><a id="2895" class="Symbol">)</a> <a id="2897" class="Symbol">=</a> <a id="2899" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2907" href="Test.Examples.DEx.OffChain.Lib.html#2626" class="Function">getLabel</a> <a id="2916" class="Symbol">(</a><a id="2917" href="Test.Examples.DEx.OffChain.Lib.html#2917" class="Bound">fst</a> <a id="2921" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2923" href="Test.Examples.DEx.OffChain.Lib.html#2923" class="Bound">fst₁</a> <a id="2928" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2930" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="2938" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2940" href="Test.Examples.DEx.OffChain.Lib.html#2940" class="Bound">snd</a><a id="2943" class="Symbol">)</a> <a id="2945" class="Symbol">=</a> <a id="2947" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>



<a id="2958" class="Comment">-- Assumes a list of filtered waller txins and subtracts a default fee from the head of the list</a>
<a id="makeFeeTxOut"></a><a id="3055" href="Test.Examples.DEx.OffChain.Lib.html#3055" class="Function">makeFeeTxOut</a> <a id="3068" class="Symbol">:</a> <a id="3070" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3075" class="Symbol">(</a><a id="3076" href="Ledger.Conway.Specification.Transaction.html#2591" class="Function">TxIn</a> <a id="3081" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3083" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="3088" class="Symbol">)</a> <a id="3090" class="Symbol">→</a> <a id="3092" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3097" class="Symbol">(</a><a id="3098" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3100" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3102" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="3107" class="Symbol">)</a>
<a id="3109" href="Test.Examples.DEx.OffChain.Lib.html#3055" class="Function">makeFeeTxOut</a> <a id="3122" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3125" class="Symbol">=</a> <a id="3127" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3130" href="Test.Examples.DEx.OffChain.Lib.html#3055" class="Function">makeFeeTxOut</a> <a id="3143" class="Symbol">((</a><a id="3145" href="Test.Examples.DEx.OffChain.Lib.html#3145" class="Bound">txin</a> <a id="3150" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3152" class="Symbol">(</a><a id="3153" href="Test.Examples.DEx.OffChain.Lib.html#3153" class="Bound">fst</a> <a id="3157" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3159" href="Test.Examples.DEx.OffChain.Lib.html#3159" class="Bound">txValue</a> <a id="3167" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3169" href="Test.Examples.DEx.OffChain.Lib.html#3169" class="Bound">snd</a><a id="3172" class="Symbol">))</a> <a id="3175" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3177" href="Test.Examples.DEx.OffChain.Lib.html#3177" class="Bound">utxos</a><a id="3182" class="Symbol">)</a> <a id="3184" class="Symbol">=</a> <a id="3186" class="Symbol">(</a><a id="3187" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3193" href="Test.Examples.DEx.OffChain.Lib.html#3145" class="Bound">txin</a> <a id="3198" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3200" href="Test.Examples.DEx.OffChain.Lib.html#3153" class="Bound">fst</a> <a id="3204" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3206" href="Test.Examples.DEx.OffChain.Lib.html#3159" class="Bound">txValue</a> <a id="3214" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3216" href="Test.Examples.DEx.Validator.html#885" class="Function">feeValue</a> <a id="3225" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3227" href="Test.Examples.DEx.OffChain.Lib.html#3169" class="Bound">snd</a><a id="3230" class="Symbol">)</a> <a id="3232" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3234" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3237" class="Comment">--10000000000</a>

<a id="makeFeeUnPaymentTxOut"></a><a id="3252" href="Test.Examples.DEx.OffChain.Lib.html#3252" class="Function">makeFeeUnPaymentTxOut</a> <a id="3274" class="Symbol">:</a> <a id="3276" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3281" class="Symbol">(</a><a id="3282" href="Ledger.Conway.Specification.Transaction.html#2591" class="Function">TxIn</a> <a id="3287" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3289" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="3294" class="Symbol">)</a> <a id="3296" class="Symbol">→</a> <a id="3298" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="3304" class="Symbol">→</a> <a id="3306" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3311" class="Symbol">(</a><a id="3312" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3314" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3316" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="3321" class="Symbol">)</a>
<a id="3323" href="Test.Examples.DEx.OffChain.Lib.html#3252" class="Function">makeFeeUnPaymentTxOut</a> <a id="3345" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3348" href="Test.Examples.DEx.OffChain.Lib.html#3348" class="Bound">v</a> <a id="3350" class="Symbol">=</a> <a id="3352" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3355" href="Test.Examples.DEx.OffChain.Lib.html#3252" class="Function">makeFeeUnPaymentTxOut</a> <a id="3377" class="Symbol">((</a><a id="3379" href="Test.Examples.DEx.OffChain.Lib.html#3379" class="Bound">txin</a> <a id="3384" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3386" class="Symbol">(</a><a id="3387" href="Test.Examples.DEx.OffChain.Lib.html#3387" class="Bound">fst</a> <a id="3391" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3393" href="Test.Examples.DEx.OffChain.Lib.html#3393" class="Bound">txValue</a> <a id="3401" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3403" href="Test.Examples.DEx.OffChain.Lib.html#3403" class="Bound">snd</a><a id="3406" class="Symbol">))</a> <a id="3409" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3411" href="Test.Examples.DEx.OffChain.Lib.html#3411" class="Bound">utxos</a><a id="3416" class="Symbol">)</a> <a id="3418" href="Test.Examples.DEx.OffChain.Lib.html#3418" class="Bound">v</a> <a id="3420" class="Symbol">=</a> <a id="3422" class="Symbol">(</a><a id="3423" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3429" href="Test.Examples.DEx.OffChain.Lib.html#3379" class="Bound">txin</a> <a id="3434" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3436" href="Test.Examples.DEx.OffChain.Lib.html#3387" class="Bound">fst</a> <a id="3440" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3442" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3446" class="Symbol">{{</a><a id="3448" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="3456" class="Symbol">}}</a> <a id="3459" class="Symbol">(</a><a id="3460" href="Test.Examples.DEx.OffChain.Lib.html#3393" class="Bound">txValue</a> <a id="3468" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3470" href="Test.Examples.DEx.Validator.html#885" class="Function">feeValue</a><a id="3478" class="Symbol">)</a> <a id="3480" href="Test.Examples.DEx.OffChain.Lib.html#3418" class="Bound">v</a> <a id="3482" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3484" href="Test.Examples.DEx.OffChain.Lib.html#3403" class="Bound">snd</a><a id="3487" class="Symbol">)</a> <a id="3489" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3491" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3494" class="Comment">-- 10000000000</a>

<a id="makeFeePaymentTxOut"></a><a id="3510" href="Test.Examples.DEx.OffChain.Lib.html#3510" class="Function">makeFeePaymentTxOut</a> <a id="3530" class="Symbol">:</a> <a id="3532" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3537" class="Symbol">(</a><a id="3538" href="Ledger.Conway.Specification.Transaction.html#2591" class="Function">TxIn</a> <a id="3543" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3545" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="3550" class="Symbol">)</a> <a id="3552" class="Symbol">→</a> <a id="3554" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="3560" class="Symbol">→</a> <a id="3562" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3567" class="Symbol">(</a><a id="3568" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3570" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3572" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="3577" class="Symbol">)</a>
<a id="3579" href="Test.Examples.DEx.OffChain.Lib.html#3510" class="Function">makeFeePaymentTxOut</a> <a id="3599" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3602" href="Test.Examples.DEx.OffChain.Lib.html#3602" class="Bound">v</a> <a id="3604" class="Symbol">=</a> <a id="3606" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3609" href="Test.Examples.DEx.OffChain.Lib.html#3510" class="Function">makeFeePaymentTxOut</a> <a id="3629" class="Symbol">((</a><a id="3631" href="Test.Examples.DEx.OffChain.Lib.html#3631" class="Bound">txin</a> <a id="3636" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3638" class="Symbol">(</a><a id="3639" href="Test.Examples.DEx.OffChain.Lib.html#3639" class="Bound">fst</a> <a id="3643" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3645" href="Test.Examples.DEx.OffChain.Lib.html#3645" class="Bound">txValue</a> <a id="3653" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3655" href="Test.Examples.DEx.OffChain.Lib.html#3655" class="Bound">snd</a><a id="3658" class="Symbol">))</a> <a id="3661" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3663" href="Test.Examples.DEx.OffChain.Lib.html#3663" class="Bound">utxos</a><a id="3668" class="Symbol">)</a> <a id="3670" href="Test.Examples.DEx.OffChain.Lib.html#3670" class="Bound">v</a> <a id="3672" class="Symbol">=</a> <a id="3674" class="Symbol">(</a><a id="3675" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3681" href="Test.Examples.DEx.OffChain.Lib.html#3631" class="Bound">txin</a> <a id="3686" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3688" href="Test.Examples.DEx.OffChain.Lib.html#3639" class="Bound">fst</a> <a id="3692" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3694" class="Symbol">(</a><a id="3695" href="Test.Examples.DEx.OffChain.Lib.html#3645" class="Bound">txValue</a> <a id="3703" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3705" href="Test.Examples.DEx.Validator.html#885" class="Function">feeValue</a> <a id="3714" class="Symbol">)</a> <a id="3716" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3718" href="Test.Examples.DEx.OffChain.Lib.html#3670" class="Bound">v</a> <a id="3720" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3722" href="Test.Examples.DEx.OffChain.Lib.html#3655" class="Bound">snd</a><a id="3725" class="Symbol">)</a> <a id="3727" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3729" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3732" class="Comment">--10000000000</a>

<a id="makeFeeSwapTxOut"></a><a id="3747" href="Test.Examples.DEx.OffChain.Lib.html#3747" class="Function">makeFeeSwapTxOut</a> <a id="3764" class="Symbol">:</a> <a id="3766" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3771" class="Symbol">(</a><a id="3772" href="Ledger.Conway.Specification.Transaction.html#2591" class="Function">TxIn</a> <a id="3777" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3779" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="3784" class="Symbol">)</a> <a id="3786" class="Symbol">→</a> <a id="3788" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="3794" class="Symbol">→</a> <a id="3796" href="Ledger.Core.Specification.TokenAlgebra.Base.html#515" class="Function">Value</a> <a id="3802" class="Symbol">→</a> <a id="3804" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3809" class="Symbol">(</a><a id="3810" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3812" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3814" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="3819" class="Symbol">)</a>
<a id="3821" href="Test.Examples.DEx.OffChain.Lib.html#3747" class="Function">makeFeeSwapTxOut</a> <a id="3838" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="3841" href="Test.Examples.DEx.OffChain.Lib.html#3841" class="Bound">v1</a> <a id="3844" href="Test.Examples.DEx.OffChain.Lib.html#3844" class="Bound">v2</a> <a id="3847" class="Symbol">=</a> <a id="3849" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="3852" href="Test.Examples.DEx.OffChain.Lib.html#3747" class="Function">makeFeeSwapTxOut</a> <a id="3869" class="Symbol">((</a><a id="3871" href="Test.Examples.DEx.OffChain.Lib.html#3871" class="Bound">txin</a> <a id="3876" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3878" class="Symbol">(</a><a id="3879" href="Test.Examples.DEx.OffChain.Lib.html#3879" class="Bound">fst</a> <a id="3883" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3885" href="Test.Examples.DEx.OffChain.Lib.html#3885" class="Bound">txValue</a> <a id="3893" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3895" href="Test.Examples.DEx.OffChain.Lib.html#3895" class="Bound">snd</a><a id="3898" class="Symbol">))</a> <a id="3901" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3903" href="Test.Examples.DEx.OffChain.Lib.html#3903" class="Bound">utxos</a><a id="3908" class="Symbol">)</a> <a id="3910" href="Test.Examples.DEx.OffChain.Lib.html#3910" class="Bound">refund</a> <a id="3917" href="Test.Examples.DEx.OffChain.Lib.html#3917" class="Bound">new</a> <a id="3921" class="Symbol">=</a> <a id="3923" class="Symbol">(</a><a id="3924" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3930" href="Test.Examples.DEx.OffChain.Lib.html#3871" class="Bound">txin</a> <a id="3935" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3937" href="Test.Examples.DEx.OffChain.Lib.html#3879" class="Bound">fst</a> <a id="3941" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3943" href="Class.HasAdd.Core.html#162" class="Field Operator">_+_</a> <a id="3947" class="Symbol">{{</a><a id="3949" href="Ledger.Core.Specification.TokenAlgebra.Base.html#1272" class="Function">addValue</a><a id="3957" class="Symbol">}}</a> <a id="3960" class="Symbol">((</a><a id="3962" href="Test.Examples.DEx.OffChain.Lib.html#3885" class="Bound">txValue</a> <a id="3970" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3972" href="Test.Examples.DEx.Validator.html#885" class="Function">feeValue</a> <a id="3981" class="Symbol">)</a> <a id="3983" href="Interface.TypeClasses.HasSubtract.html#223" class="Field Operator">-</a> <a id="3985" href="Test.Examples.DEx.OffChain.Lib.html#3917" class="Bound">new</a><a id="3988" class="Symbol">)</a> <a id="3990" href="Test.Examples.DEx.OffChain.Lib.html#3910" class="Bound">refund</a> <a id="3997" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3999" href="Test.Examples.DEx.OffChain.Lib.html#3895" class="Bound">snd</a><a id="4002" class="Symbol">)</a> <a id="4004" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4006" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

<a id="4010" class="Comment">-- return id of 0 if no txins</a>
<a id="getTxId"></a><a id="4040" href="Test.Examples.DEx.OffChain.Lib.html#4040" class="Function">getTxId</a> <a id="4048" class="Symbol">:</a> <a id="4050" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4055" class="Symbol">(</a><a id="4056" href="Ledger.Conway.Specification.Transaction.html#2591" class="Function">TxIn</a> <a id="4061" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4063" href="Ledger.Conway.Specification.Transaction.html#2624" class="Function">TxOut</a><a id="4068" class="Symbol">)</a> <a id="4070" class="Symbol">→</a> <a id="4072" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="4074" href="Test.Examples.DEx.OffChain.Lib.html#4040" class="Function">getTxId</a> <a id="4082" href="Test.Examples.DEx.OffChain.Lib.html#4082" class="Bound">xs</a> <a id="4085" class="Symbol">=</a> <a id="4087" href="Data.Maybe.Base.html#1276" class="Function">maybe</a> <a id="4093" class="Symbol">(λ</a> <a id="4096" href="Test.Examples.DEx.OffChain.Lib.html#4096" class="Bound">x</a> <a id="4098" class="Symbol">→</a> <a id="4100" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4106" class="Symbol">(</a><a id="4107" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4113" href="Test.Examples.DEx.OffChain.Lib.html#4096" class="Bound">x</a><a id="4114" class="Symbol">))</a> <a id="4117" class="Number">0</a> <a id="4119" class="Symbol">(</a><a id="4120" href="Data.List.Base.html#8143" class="Function">head</a> <a id="4125" href="Test.Examples.DEx.OffChain.Lib.html#4082" class="Bound">xs</a><a id="4127" class="Symbol">)</a>

<a id="4130" class="Comment">{-
getVal : Label -&gt; ℕ -&gt; Value
getVal (Always l) w with lookup&#39; w l
...| nothing = emptyValue
...| just v = v
-}</a>



</pre></body></html>