<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Ledger</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">import</a> <a id="33" href="Data.List.html" class="Module">Data.List</a> <a id="43" class="Symbol">as</a> <a id="46" class="Module">L</a>

<a id="49" class="Keyword">open</a> <a id="54" class="Keyword">import</a> <a id="61" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="76" class="Keyword">open</a> <a id="81" class="Keyword">import</a> <a id="88" href="Ledger.Abstract.html" class="Module">Ledger.Abstract</a>
<a id="104" class="Keyword">open</a> <a id="109" class="Keyword">import</a> <a id="116" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a> <a id="135" class="Keyword">using</a> <a id="141" class="Symbol">(</a><a id="142" href="Ledger.Transaction.html#867" class="Record">TransactionStructure</a><a id="162" class="Symbol">)</a>

<a id="165" class="Keyword">module</a> <a id="172" href="Ledger.Ledger.html" class="Module">Ledger.Ledger</a>
  <a id="188" class="Symbol">(</a><a id="189" href="Ledger.Ledger.html#189" class="Bound">txs</a> <a id="193" class="Symbol">:</a> <a id="195" class="Symbol">_)</a> <a id="198" class="Symbol">(</a><a id="199" class="Keyword">open</a> <a id="204" href="Ledger.Transaction.html#867" class="Module">TransactionStructure</a> <a id="225" href="Ledger.Ledger.html#189" class="Bound">txs</a><a id="228" class="Symbol">)</a>
  <a id="232" class="Symbol">(</a><a id="233" href="Ledger.Ledger.html#233" class="Bound">abs</a> <a id="237" class="Symbol">:</a> <a id="239" href="Ledger.Abstract.html#578" class="Record">AbstractFunctions</a> <a id="257" href="Ledger.Ledger.html#189" class="Bound">txs</a><a id="260" class="Symbol">)</a> <a id="262" class="Symbol">(</a><a id="263" class="Keyword">open</a> <a id="268" href="Ledger.Abstract.html#578" class="Module">AbstractFunctions</a> <a id="286" href="Ledger.Ledger.html#233" class="Bound">abs</a><a id="289" class="Symbol">)</a>
  <a id="293" class="Keyword">where</a>

<a id="300" class="Keyword">open</a> <a id="305" class="Keyword">import</a> <a id="312" href="Ledger.Enact.html" class="Module">Ledger.Enact</a> <a id="325" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="338" class="Keyword">open</a> <a id="343" class="Keyword">import</a> <a id="350" href="Ledger.Gov.html" class="Module">Ledger.Gov</a> <a id="361" href="Ledger.Ledger.html#189" class="Bound">txs</a>
<a id="365" class="Keyword">open</a> <a id="370" class="Keyword">import</a> <a id="377" href="Ledger.Utxo.html" class="Module">Ledger.Utxo</a> <a id="389" href="Ledger.Ledger.html#189" class="Bound">txs</a> <a id="393" href="Ledger.Ledger.html#233" class="Bound">abs</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Ledger.Utxow.html" class="Module">Ledger.Utxow</a> <a id="422" href="Ledger.Ledger.html#189" class="Bound">txs</a> <a id="426" href="Ledger.Ledger.html#233" class="Bound">abs</a>
<a id="430" class="Keyword">open</a> <a id="435" class="Keyword">import</a> <a id="442" href="Ledger.Certs.html" class="Module">Ledger.Certs</a> <a id="455" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>

<a id="469" class="Keyword">open</a> <a id="474" href="Ledger.Transaction.html#4221" class="Module">Tx</a>
<a id="477" class="Keyword">open</a> <a id="482" href="Ledger.Certs.html#3997" class="Module">GState</a>
<a id="489" class="Keyword">open</a> <a id="494" href="Ledger.GovernanceActions.html#2594" class="Module">GovActionState</a>
<a id="509" class="Keyword">open</a> <a id="514" href="Ledger.Enact.html#397" class="Module">EnactState</a> <a id="525" class="Keyword">using</a> <a id="531" class="Symbol">(</a><a id="532" href="Ledger.Enact.html#433" class="Field">cc</a><a id="534" class="Symbol">)</a>


<a id="538" class="Keyword">record</a> <a id="LEnv"></a><a id="545" href="Ledger.Ledger.html#545" class="Record">LEnv</a> <a id="550" class="Symbol">:</a> <a id="552" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="557" class="Keyword">where</a>
  <a id="565" class="Keyword">field</a>
    <a id="LEnv.slot"></a><a id="575" href="Ledger.Ledger.html#575" class="Field">slot</a>        <a id="587" class="Symbol">:</a> <a id="589" href="Ledger.Types.Epoch.html#552" class="Function">Slot</a>
    <a id="LEnv.ppolicy"></a><a id="598" href="Ledger.Ledger.html#598" class="Field">ppolicy</a>     <a id="610" class="Symbol">:</a> <a id="612" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="618" href="Ledger.Crypto.html#1166" class="Function">ScriptHash</a>
    <a id="LEnv.pparams"></a><a id="633" href="Ledger.Ledger.html#633" class="Field">pparams</a>     <a id="645" class="Symbol">:</a> <a id="647" href="Ledger.PParams.html#1570" class="Record">PParams</a>
    <a id="LEnv.enactState"></a><a id="659" href="Ledger.Ledger.html#659" class="Field">enactState</a>  <a id="671" class="Symbol">:</a> <a id="673" href="Ledger.Enact.html#397" class="Record">EnactState</a>
    <a id="LEnv.treasury"></a><a id="688" href="Ledger.Ledger.html#688" class="Field">treasury</a>    <a id="700" class="Symbol">:</a> <a id="702" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>


<a id="709" class="Keyword">instance</a>
  <a id="HasPParams-LEnv"></a><a id="720" href="Ledger.Ledger.html#720" class="Function">HasPParams-LEnv</a> <a id="736" class="Symbol">:</a> <a id="738" href="Ledger.PParams.html#3373" class="Record">HasPParams</a> <a id="749" href="Ledger.Ledger.html#545" class="Record">LEnv</a>
  <a id="756" href="Ledger.Ledger.html#720" class="Function">HasPParams-LEnv</a> <a id="772" class="Symbol">.</a><a id="773" href="Ledger.PParams.html#3424" class="Field">PParamsOf</a> <a id="783" class="Symbol">=</a> <a id="785" href="Ledger.Ledger.html#633" class="Field">LEnv.pparams</a>




<a id="802" class="Keyword">record</a> <a id="LState"></a><a id="809" href="Ledger.Ledger.html#809" class="Record">LState</a> <a id="816" class="Symbol">:</a> <a id="818" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="823" class="Keyword">where</a>


  <a id="833" class="Keyword">constructor</a> <a id="⟦_,_,_⟧ˡ"></a><a id="845" href="Ledger.Ledger.html#845" class="InductiveConstructor Operator">⟦_,_,_⟧ˡ</a>


  <a id="858" class="Keyword">field</a>
    <a id="LState.utxoSt"></a><a id="868" href="Ledger.Ledger.html#868" class="Field">utxoSt</a>     <a id="879" class="Symbol">:</a> <a id="881" href="Ledger.Utxo.html#2705" class="Record">UTxOState</a>
    <a id="LState.govSt"></a><a id="895" href="Ledger.Ledger.html#895" class="Field">govSt</a>      <a id="906" class="Symbol">:</a> <a id="908" href="Ledger.Gov.html#1334" class="Function">GovState</a>
    <a id="LState.certState"></a><a id="921" href="Ledger.Ledger.html#921" class="Field">certState</a>  <a id="932" class="Symbol">:</a> <a id="934" href="Ledger.Certs.html#4327" class="Record">CertState</a>



<a id="947" class="Keyword">record</a> <a id="HasLState"></a><a id="954" href="Ledger.Ledger.html#954" class="Record">HasLState</a> <a id="964" class="Symbol">{</a><a id="965" href="Ledger.Ledger.html#965" class="Bound">a</a><a id="966" class="Symbol">}</a> <a id="968" class="Symbol">(</a><a id="969" href="Ledger.Ledger.html#969" class="Bound">A</a> <a id="971" class="Symbol">:</a> <a id="973" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="978" href="Ledger.Ledger.html#965" class="Bound">a</a><a id="979" class="Symbol">)</a> <a id="981" class="Symbol">:</a> <a id="983" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="988" href="Ledger.Ledger.html#965" class="Bound">a</a> <a id="990" class="Keyword">where</a>
  <a id="998" class="Keyword">field</a> <a id="HasLState.LStateOf"></a><a id="1004" href="Ledger.Ledger.html#1004" class="Field">LStateOf</a> <a id="1013" class="Symbol">:</a> <a id="1015" href="Ledger.Ledger.html#969" class="Bound">A</a> <a id="1017" class="Symbol">→</a> <a id="1019" href="Ledger.Ledger.html#809" class="Record">LState</a>
<a id="1026" class="Keyword">open</a> <a id="1031" href="Ledger.Ledger.html#954" class="Module">HasLState</a> <a id="1041" class="Symbol">⦃...⦄</a> <a id="1047" class="Keyword">public</a>

<a id="1055" class="Keyword">instance</a>
  <a id="HasUTxOState-LState"></a><a id="1066" href="Ledger.Ledger.html#1066" class="Function">HasUTxOState-LState</a> <a id="1086" class="Symbol">:</a> <a id="1088" href="Ledger.Utxo.html#2867" class="Record">HasUTxOState</a> <a id="1101" href="Ledger.Ledger.html#809" class="Record">LState</a>
  <a id="1110" href="Ledger.Ledger.html#1066" class="Function">HasUTxOState-LState</a> <a id="1130" class="Symbol">.</a><a id="1131" href="Ledger.Utxo.html#2920" class="Field">UTxOStateOf</a> <a id="1143" class="Symbol">=</a> <a id="1145" href="Ledger.Ledger.html#868" class="Field">LState.utxoSt</a>

  <a id="HasUTxO-LState"></a><a id="1162" href="Ledger.Ledger.html#1162" class="Function">HasUTxO-LState</a> <a id="1177" class="Symbol">:</a> <a id="1179" href="Ledger.Transaction.html#2570" class="Record">HasUTxO</a> <a id="1187" href="Ledger.Ledger.html#809" class="Record">LState</a>
  <a id="1196" href="Ledger.Ledger.html#1162" class="Function">HasUTxO-LState</a> <a id="1211" class="Symbol">.</a><a id="1212" href="Ledger.Transaction.html#2620" class="Field">UTxOOf</a> <a id="1219" class="Symbol">=</a> <a id="1221" href="Ledger.Transaction.html#2620" class="Field">UTxOOf</a> <a id="1228" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1230" href="Ledger.Utxo.html#2920" class="Field">UTxOStateOf</a>

  <a id="HasGovState-LState"></a><a id="1245" href="Ledger.Ledger.html#1245" class="Function">HasGovState-LState</a> <a id="1264" class="Symbol">:</a> <a id="1266" href="Ledger.Gov.html#1408" class="Record">HasGovState</a> <a id="1278" href="Ledger.Ledger.html#809" class="Record">LState</a>
  <a id="1287" href="Ledger.Ledger.html#1245" class="Function">HasGovState-LState</a> <a id="1306" class="Symbol">.</a><a id="1307" href="Ledger.Gov.html#1460" class="Field">GovStateOf</a> <a id="1318" class="Symbol">=</a> <a id="1320" href="Ledger.Ledger.html#895" class="Field">LState.govSt</a>

  <a id="HasCertState-LState"></a><a id="1336" href="Ledger.Ledger.html#1336" class="Function">HasCertState-LState</a> <a id="1356" class="Symbol">:</a> <a id="1358" href="Ledger.Certs.html#4455" class="Record">HasCertState</a> <a id="1371" href="Ledger.Ledger.html#809" class="Record">LState</a>
  <a id="1380" href="Ledger.Ledger.html#1336" class="Function">HasCertState-LState</a> <a id="1400" class="Symbol">.</a><a id="1401" href="Ledger.Certs.html#4508" class="Field">CertStateOf</a> <a id="1413" class="Symbol">=</a> <a id="1415" href="Ledger.Ledger.html#921" class="Field">LState.certState</a>

  <a id="HasDeposits-LState"></a><a id="1435" href="Ledger.Ledger.html#1435" class="Function">HasDeposits-LState</a> <a id="1454" class="Symbol">:</a> <a id="1456" href="Ledger.Certs.html#677" class="Record">HasDeposits</a> <a id="1468" href="Ledger.Ledger.html#809" class="Record">LState</a>
  <a id="1477" href="Ledger.Ledger.html#1435" class="Function">HasDeposits-LState</a> <a id="1496" class="Symbol">.</a><a id="1497" href="Ledger.Certs.html#729" class="Field">DepositsOf</a> <a id="1508" class="Symbol">=</a> <a id="1510" href="Ledger.Certs.html#729" class="Field">DepositsOf</a> <a id="1521" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1523" href="Ledger.Utxo.html#2920" class="Field">UTxOStateOf</a>

<a id="1536" class="Keyword">open</a> <a id="1541" href="Ledger.Certs.html#4327" class="Module">CertState</a>
<a id="1551" class="Keyword">open</a> <a id="1556" href="Ledger.Certs.html#3171" class="Module">DState</a>

<a id="1564" class="Keyword">instance</a>
  <a id="1575" class="Keyword">unquoteDecl</a> <a id="HasCast-LEnv"></a><a id="1587" href="Ledger.Ledger.html#1587" class="Function">HasCast-LEnv</a> <a id="HasCast-LState"></a><a id="1600" href="Ledger.Ledger.html#1600" class="Function">HasCast-LState</a> <a id="1615" class="Symbol">=</a> <a id="1617" href="Class.HasCast.Derive.html#2660" class="Function">derive-HasCast</a>
    <a id="1636" class="Symbol">((</a><a id="1638" class="Keyword">quote</a> <a id="1644" href="Ledger.Ledger.html#545" class="Record">LEnv</a> <a id="1649" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1651" href="Ledger.Ledger.html#1587" class="Function">HasCast-LEnv</a><a id="1663" class="Symbol">)</a> <a id="1665" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1667" class="Symbol">(</a><a id="1668" class="Keyword">quote</a> <a id="1674" href="Ledger.Ledger.html#809" class="Record">LState</a> <a id="1681" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1683" href="Ledger.Ledger.html#1600" class="Function">HasCast-LState</a><a id="1697" class="Symbol">)</a> <a id="1699" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1701" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1703" class="Symbol">)</a>


<a id="txgov"></a><a id="1707" href="Ledger.Ledger.html#1707" class="Function">txgov</a> <a id="1713" class="Symbol">:</a> <a id="1715" href="Ledger.Transaction.html#2677" class="Record">TxBody</a> <a id="1722" class="Symbol">→</a> <a id="1724" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1729" class="Symbol">(</a><a id="1730" href="Ledger.GovernanceActions.html#2227" class="Record">GovVote</a> <a id="1738" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="1740" href="Ledger.GovernanceActions.html#2372" class="Record">GovProposal</a><a id="1751" class="Symbol">)</a>
<a id="1753" href="Ledger.Ledger.html#1707" class="Function">txgov</a> <a id="1759" href="Ledger.Ledger.html#1759" class="Bound">txb</a> <a id="1763" class="Symbol">=</a> <a id="1765" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1769" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="1774" href="Ledger.Transaction.html#3009" class="Field">txprop</a> <a id="1781" href="Data.List.Base.html#1734" class="Function Operator">++</a> <a id="1784" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="1788" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="1793" href="Ledger.Transaction.html#2973" class="Field">txvote</a>
  <a id="1802" class="Keyword">where</a> <a id="1808" class="Keyword">open</a> <a id="1813" href="Ledger.Transaction.html#2677" class="Module">TxBody</a> <a id="1820" href="Ledger.Ledger.html#1759" class="Bound">txb</a>

<a id="rmOrphanDRepVotes"></a><a id="1825" href="Ledger.Ledger.html#1825" class="Function">rmOrphanDRepVotes</a> <a id="1843" class="Symbol">:</a> <a id="1845" href="Ledger.Certs.html#4327" class="Record">CertState</a> <a id="1855" class="Symbol">→</a> <a id="1857" href="Ledger.Gov.html#1334" class="Function">GovState</a> <a id="1866" class="Symbol">→</a> <a id="1868" href="Ledger.Gov.html#1334" class="Function">GovState</a>
<a id="1877" href="Ledger.Ledger.html#1825" class="Function">rmOrphanDRepVotes</a> <a id="1895" href="Ledger.Ledger.html#1895" class="Bound">cs</a> <a id="1898" href="Ledger.Ledger.html#1898" class="Bound">govSt</a> <a id="1904" class="Symbol">=</a> <a id="1906" href="Data.List.Base.html#1634" class="Function">L.map</a> <a id="1912" class="Symbol">(</a><a id="1913" href="Class.Bifunctor.html#1152" class="Function">map₂</a> <a id="1918" href="Ledger.Ledger.html#2044" class="Function">go</a><a id="1920" class="Symbol">)</a> <a id="1922" href="Ledger.Ledger.html#1898" class="Bound">govSt</a>
  <a id="1930" class="Keyword">where</a>
   <a id="1939" href="Ledger.Ledger.html#1939" class="Function">ifDRepRegistered</a> <a id="1956" class="Symbol">:</a> <a id="1958" href="Ledger.GovernanceActions.html#392" class="Function">Voter</a> <a id="1964" class="Symbol">→</a> <a id="1966" href="Agda.Primitive.html#388" class="Primitive">Type</a>
   <a id="1974" href="Ledger.Ledger.html#1939" class="Function">ifDRepRegistered</a> <a id="1991" class="Symbol">(</a><a id="1992" href="Ledger.Ledger.html#1992" class="Bound">r</a> <a id="1994" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1996" href="Ledger.Ledger.html#1996" class="Bound">c</a><a id="1997" class="Symbol">)</a> <a id="1999" class="Symbol">=</a> <a id="2001" href="Ledger.Ledger.html#1992" class="Bound">r</a> <a id="2003" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2005" href="Ledger.GovernanceActions.html#372" class="InductiveConstructor">DRep</a> <a id="2010" class="Symbol">→</a> <a id="2012" href="Ledger.Ledger.html#1996" class="Bound">c</a> <a id="2014" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="2016" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2020" class="Symbol">(</a><a id="2021" href="Ledger.Ledger.html#1895" class="Bound">cs</a> <a id="2024" class="Symbol">.</a><a id="2025" href="Ledger.Certs.html#4430" class="Field">gState</a> <a id="2032" class="Symbol">.</a><a id="2033" href="Ledger.Certs.html#4054" class="Field">dreps</a><a id="2038" class="Symbol">)</a>

   <a id="2044" href="Ledger.Ledger.html#2044" class="Function">go</a> <a id="2047" class="Symbol">:</a> <a id="2049" href="Ledger.GovernanceActions.html#2594" class="Record">GovActionState</a> <a id="2064" class="Symbol">→</a> <a id="2066" href="Ledger.GovernanceActions.html#2594" class="Record">GovActionState</a>
   <a id="2084" href="Ledger.Ledger.html#2044" class="Function">go</a> <a id="2087" href="Ledger.Ledger.html#2087" class="Bound">gas</a> <a id="2091" class="Symbol">=</a> <a id="2093" class="Keyword">record</a> <a id="2100" href="Ledger.Ledger.html#2087" class="Bound">gas</a> <a id="2104" class="Symbol">{</a> <a id="2106" href="Ledger.GovernanceActions.html#2634" class="Field">votes</a> <a id="2112" class="Symbol">=</a> <a id="2114" href="abstract-set-theory.FiniteSetTheory.html#2989" class="Function">filterKeys</a> <a id="2125" href="Ledger.Ledger.html#1939" class="Function">ifDRepRegistered</a> <a id="2142" class="Symbol">(</a><a id="2143" href="Ledger.Ledger.html#2087" class="Bound">gas</a> <a id="2147" class="Symbol">.</a><a id="2148" href="Ledger.GovernanceActions.html#2634" class="Field">votes</a><a id="2153" class="Symbol">)</a> <a id="2155" class="Symbol">}</a>

<a id="allColdCreds"></a><a id="2158" href="Ledger.Ledger.html#2158" class="Function">allColdCreds</a> <a id="2171" class="Symbol">:</a> <a id="2173" href="Ledger.Gov.html#1334" class="Function">GovState</a> <a id="2182" class="Symbol">→</a> <a id="2184" href="Ledger.Enact.html#397" class="Record">EnactState</a> <a id="2195" class="Symbol">→</a> <a id="2197" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="2199" href="Ledger.Address.html#273" class="Datatype">Credential</a>
<a id="2210" href="Ledger.Ledger.html#2158" class="Function">allColdCreds</a> <a id="2223" href="Ledger.Ledger.html#2223" class="Bound">govSt</a> <a id="2229" href="Ledger.Ledger.html#2229" class="Bound">es</a> <a id="2232" class="Symbol">=</a>
  <a id="2236" href="Ledger.Enact.html#1194" class="Function">ccCreds</a> <a id="2244" class="Symbol">(</a><a id="2245" href="Ledger.Ledger.html#2229" class="Bound">es</a> <a id="2248" class="Symbol">.</a><a id="2249" href="Ledger.Enact.html#433" class="Field">cc</a><a id="2251" class="Symbol">)</a> <a id="2253" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="2255" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a> <a id="2266" class="Symbol">(λ</a> <a id="2269" class="Symbol">(_</a> <a id="2272" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2274" href="Ledger.Ledger.html#2274" class="Bound">st</a><a id="2276" class="Symbol">)</a> <a id="2278" class="Symbol">→</a> <a id="2280" href="Ledger.GovernanceActions.html#3420" class="Function">proposedCC</a> <a id="2291" class="Symbol">(</a><a id="2292" href="Ledger.Ledger.html#2274" class="Bound">st</a> <a id="2295" class="Symbol">.</a><a id="2296" href="Ledger.GovernanceActions.html#2715" class="Field">action</a><a id="2302" class="Symbol">))</a> <a id="2305" class="Symbol">(</a><a id="2306" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="2315" href="Ledger.Ledger.html#2223" class="Bound">govSt</a><a id="2320" class="Symbol">)</a>


<a id="2324" class="Keyword">private</a> <a id="2332" class="Keyword">variable</a>
  <a id="2343" href="Ledger.Ledger.html#2343" class="Generalizable">Γ</a> <a id="2345" class="Symbol">:</a> <a id="2347" href="Ledger.Ledger.html#545" class="Record">LEnv</a>
  <a id="2354" href="Ledger.Ledger.html#2354" class="Generalizable">s</a> <a id="2356" href="Ledger.Ledger.html#2356" class="Generalizable">s&#39;</a> <a id="2359" href="Ledger.Ledger.html#2359" class="Generalizable">s&#39;&#39;</a> <a id="2363" class="Symbol">:</a> <a id="2365" href="Ledger.Ledger.html#809" class="Record">LState</a>
  <a id="2374" href="Ledger.Ledger.html#2374" class="Generalizable">utxoSt</a> <a id="2381" href="Ledger.Ledger.html#2381" class="Generalizable">utxoSt&#39;</a> <a id="2389" class="Symbol">:</a> <a id="2391" href="Ledger.Utxo.html#2705" class="Record">UTxOState</a>
  <a id="2403" href="Ledger.Ledger.html#2403" class="Generalizable">govSt</a> <a id="2409" href="Ledger.Ledger.html#2409" class="Generalizable">govSt&#39;</a> <a id="2416" class="Symbol">:</a> <a id="2418" href="Ledger.Gov.html#1334" class="Function">GovState</a>
  <a id="2429" href="Ledger.Ledger.html#2429" class="Generalizable">certState</a> <a id="2439" href="Ledger.Ledger.html#2439" class="Generalizable">certState&#39;</a> <a id="2450" class="Symbol">:</a> <a id="2452" href="Ledger.Certs.html#4327" class="Record">CertState</a>
  <a id="2464" href="Ledger.Ledger.html#2464" class="Generalizable">tx</a> <a id="2467" class="Symbol">:</a> <a id="2469" href="Ledger.Transaction.html#4221" class="Record">Tx</a>
  <a id="2474" href="Ledger.Ledger.html#2474" class="Generalizable">slot</a> <a id="2479" class="Symbol">:</a> <a id="2481" href="Ledger.Types.Epoch.html#552" class="Function">Slot</a>
  <a id="2488" href="Ledger.Ledger.html#2488" class="Generalizable">ppolicy</a> <a id="2496" class="Symbol">:</a> <a id="2498" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2504" href="Ledger.Crypto.html#1166" class="Function">ScriptHash</a>
  <a id="2517" href="Ledger.Ledger.html#2517" class="Generalizable">pp</a> <a id="2520" class="Symbol">:</a> <a id="2522" href="Ledger.PParams.html#1570" class="Record">PParams</a>
  <a id="2532" href="Ledger.Ledger.html#2532" class="Generalizable">enactState</a> <a id="2543" class="Symbol">:</a> <a id="2545" href="Ledger.Enact.html#397" class="Record">EnactState</a>
  <a id="2558" href="Ledger.Ledger.html#2558" class="Generalizable">treasury</a> <a id="2567" class="Symbol">:</a> <a id="2569" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>


<a id="2576" class="Keyword">data</a> <a id="_⊢_⇀⦇_,LEDGER⦈_"></a><a id="2581" href="Ledger.Ledger.html#2581" class="Datatype Operator">_⊢_⇀⦇_,LEDGER⦈_</a> <a id="2597" class="Symbol">:</a> <a id="2599" href="Ledger.Ledger.html#545" class="Record">LEnv</a> <a id="2604" class="Symbol">→</a> <a id="2606" href="Ledger.Ledger.html#809" class="Record">LState</a> <a id="2613" class="Symbol">→</a> <a id="2615" href="Ledger.Transaction.html#4221" class="Record">Tx</a> <a id="2618" class="Symbol">→</a> <a id="2620" href="Ledger.Ledger.html#809" class="Record">LState</a> <a id="2627" class="Symbol">→</a> <a id="2629" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2634" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,LEDGER⦈_.LEDGER-V"></a><a id="2643" href="Ledger.Ledger.html#2643" class="InductiveConstructor">LEDGER-V</a> <a id="2652" class="Symbol">:</a>
    <a id="2658" class="Keyword">let</a>  <a id="2663" href="Ledger.Ledger.html#2663" class="Bound">txb</a>         <a id="2675" class="Symbol">=</a> <a id="2677" href="Ledger.Ledger.html#2464" class="Generalizable">tx</a> <a id="2680" class="Symbol">.</a><a id="2681" href="Ledger.Transaction.html#4253" class="Field">body</a>


         <a id="2697" class="Keyword">open</a> <a id="2702" href="Ledger.Transaction.html#2677" class="Module">TxBody</a> <a id="2709" href="Ledger.Ledger.html#2663" class="Bound">txb</a>


         <a id="2724" href="Ledger.Ledger.html#2724" class="Bound">rewards</a>     <a id="2736" class="Symbol">=</a> <a id="2738" href="Ledger.Ledger.html#2429" class="Generalizable">certState</a> <a id="2748" class="Symbol">.</a><a id="2749" href="Ledger.Certs.html#4390" class="Field">dState</a> <a id="2756" class="Symbol">.</a><a id="2757" href="Ledger.Certs.html#3309" class="Field">rewards</a>
    <a id="2769" class="Keyword">in</a>
    <a id="2776" href="Interface.STS.html#105" class="Function Operator">∙</a> <a id="2778" href="Ledger.Transaction.html#4306" class="Field">isValid</a> <a id="2786" href="Ledger.Ledger.html#2464" class="Generalizable">tx</a> <a id="2789" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2791" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
    <a id="2800" href="Interface.STS.html#131" class="Function Operator">∙</a> <a id="2802" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="2804" href="Ledger.Ledger.html#2474" class="Generalizable">slot</a> <a id="2809" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2811" href="Ledger.Ledger.html#2517" class="Generalizable">pp</a> <a id="2814" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2816" href="Ledger.Ledger.html#2558" class="Generalizable">treasury</a> <a id="2825" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a>  <a id="2828" href="Ledger.Utxow.html#3731" class="Datatype Operator">⊢</a> <a id="2830" href="Ledger.Ledger.html#2374" class="Generalizable">utxoSt</a> <a id="2837" href="Ledger.Utxow.html#3731" class="Datatype Operator">⇀⦇</a> <a id="2840" href="Ledger.Ledger.html#2464" class="Generalizable">tx</a> <a id="2843" href="Ledger.Utxow.html#3731" class="Datatype Operator">,UTXOW⦈</a> <a id="2851" href="Ledger.Ledger.html#2381" class="Generalizable">utxoSt&#39;</a>
    <a id="2863" href="Interface.STS.html#131" class="Function Operator">∙</a> <a id="2865" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="2867" href="Ledger.Types.Epoch.html#688" class="Function">epoch</a> <a id="2873" href="Ledger.Ledger.html#2474" class="Generalizable">slot</a> <a id="2878" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2880" href="Ledger.Ledger.html#2517" class="Generalizable">pp</a> <a id="2883" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2885" href="Ledger.Transaction.html#2973" class="Function">txvote</a> <a id="2892" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2894" href="Ledger.Transaction.html#2945" class="Function">txwdrls</a> <a id="2902" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2904" href="Ledger.Ledger.html#2158" class="Function">allColdCreds</a> <a id="2917" href="Ledger.Ledger.html#2403" class="Generalizable">govSt</a> <a id="2923" href="Ledger.Ledger.html#2532" class="Generalizable">enactState</a> <a id="2934" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a> <a id="2936" href="Ledger.Certs.html#7242" class="Function Operator">⊢</a> <a id="2938" href="Ledger.Ledger.html#2429" class="Generalizable">certState</a> <a id="2948" href="Ledger.Certs.html#7242" class="Function Operator">⇀⦇</a> <a id="2951" href="Ledger.Transaction.html#2911" class="Function">txcerts</a> <a id="2959" href="Ledger.Certs.html#7242" class="Function Operator">,CERTS⦈</a> <a id="2967" href="Ledger.Ledger.html#2439" class="Generalizable">certState&#39;</a>
    <a id="2982" href="Interface.STS.html#131" class="Function Operator">∙</a> <a id="2984" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="2986" href="Ledger.Transaction.html#3245" class="Function">txid</a> <a id="2991" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2993" href="Ledger.Types.Epoch.html#688" class="Function">epoch</a> <a id="2999" href="Ledger.Ledger.html#2474" class="Generalizable">slot</a> <a id="3004" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3006" href="Ledger.Ledger.html#2517" class="Generalizable">pp</a> <a id="3009" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3011" href="Ledger.Ledger.html#2488" class="Generalizable">ppolicy</a> <a id="3019" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3021" href="Ledger.Ledger.html#2532" class="Generalizable">enactState</a> <a id="3032" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3034" href="Ledger.Ledger.html#2439" class="Generalizable">certState&#39;</a> <a id="3045" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3047" href="Class.IsSet.html#916" class="Function">dom</a> <a id="3051" href="Ledger.Ledger.html#2724" class="Bound">rewards</a> <a id="3059" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a> <a id="3061" href="Ledger.Gov.html#6856" class="Function Operator">⊢</a> <a id="3063" href="Ledger.Ledger.html#1825" class="Function">rmOrphanDRepVotes</a> <a id="3081" href="Ledger.Ledger.html#2439" class="Generalizable">certState&#39;</a> <a id="3092" href="Ledger.Ledger.html#2403" class="Generalizable">govSt</a> <a id="3098" href="Ledger.Gov.html#6856" class="Function Operator">⇀⦇</a> <a id="3101" href="Ledger.Ledger.html#1707" class="Function">txgov</a> <a id="3107" href="Ledger.Ledger.html#2663" class="Bound">txb</a> <a id="3111" href="Ledger.Gov.html#6856" class="Function Operator">,GOVS⦈</a> <a id="3118" href="Ledger.Ledger.html#2409" class="Generalizable">govSt&#39;</a>
      <a id="3131" href="Interface.STS.html#350" class="Function Operator">────────────────────────────────</a>
      <a id="3170" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="3172" href="Ledger.Ledger.html#2474" class="Generalizable">slot</a> <a id="3177" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3179" href="Ledger.Ledger.html#2488" class="Generalizable">ppolicy</a> <a id="3187" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3189" href="Ledger.Ledger.html#2517" class="Generalizable">pp</a> <a id="3192" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3194" href="Ledger.Ledger.html#2532" class="Generalizable">enactState</a> <a id="3205" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3207" href="Ledger.Ledger.html#2558" class="Generalizable">treasury</a> <a id="3216" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a> <a id="3218" href="Ledger.Ledger.html#2581" class="Datatype Operator">⊢</a> <a id="3220" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="3222" href="Ledger.Ledger.html#2374" class="Generalizable">utxoSt</a> <a id="3229" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3231" href="Ledger.Ledger.html#2403" class="Generalizable">govSt</a> <a id="3237" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3239" href="Ledger.Ledger.html#2429" class="Generalizable">certState</a> <a id="3249" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a> <a id="3251" href="Ledger.Ledger.html#2581" class="Datatype Operator">⇀⦇</a> <a id="3254" href="Ledger.Ledger.html#2464" class="Generalizable">tx</a> <a id="3257" href="Ledger.Ledger.html#2581" class="Datatype Operator">,LEDGER⦈</a> <a id="3266" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="3268" href="Ledger.Ledger.html#2381" class="Generalizable">utxoSt&#39;</a> <a id="3276" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3278" href="Ledger.Ledger.html#2409" class="Generalizable">govSt&#39;</a> <a id="3285" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3287" href="Ledger.Ledger.html#2439" class="Generalizable">certState&#39;</a> <a id="3298" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a>

  <a id="_⊢_⇀⦇_,LEDGER⦈_.LEDGER-I"></a><a id="3303" href="Ledger.Ledger.html#3303" class="InductiveConstructor">LEDGER-I</a> <a id="3312" class="Symbol">:</a>
    <a id="3318" href="Interface.STS.html#105" class="Function Operator">∙</a> <a id="3320" href="Ledger.Transaction.html#4306" class="Field">isValid</a> <a id="3328" href="Ledger.Ledger.html#2464" class="Generalizable">tx</a> <a id="3331" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3333" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
    <a id="3343" href="Interface.STS.html#131" class="Function Operator">∙</a> <a id="3345" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="3347" href="Ledger.Ledger.html#2474" class="Generalizable">slot</a> <a id="3352" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3354" href="Ledger.Ledger.html#2517" class="Generalizable">pp</a> <a id="3357" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3359" href="Ledger.Ledger.html#2558" class="Generalizable">treasury</a> <a id="3368" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a> <a id="3370" href="Ledger.Utxow.html#3731" class="Datatype Operator">⊢</a> <a id="3372" href="Ledger.Ledger.html#2374" class="Generalizable">utxoSt</a> <a id="3379" href="Ledger.Utxow.html#3731" class="Datatype Operator">⇀⦇</a> <a id="3382" href="Ledger.Ledger.html#2464" class="Generalizable">tx</a> <a id="3385" href="Ledger.Utxow.html#3731" class="Datatype Operator">,UTXOW⦈</a> <a id="3393" href="Ledger.Ledger.html#2381" class="Generalizable">utxoSt&#39;</a>
      <a id="3407" href="Interface.STS.html#350" class="Function Operator">────────────────────────────────</a>
      <a id="3446" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="3448" href="Ledger.Ledger.html#2474" class="Generalizable">slot</a> <a id="3453" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3455" href="Ledger.Ledger.html#2488" class="Generalizable">ppolicy</a> <a id="3463" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3465" href="Ledger.Ledger.html#2517" class="Generalizable">pp</a> <a id="3468" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3470" href="Ledger.Ledger.html#2532" class="Generalizable">enactState</a> <a id="3481" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3483" href="Ledger.Ledger.html#2558" class="Generalizable">treasury</a> <a id="3492" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a> <a id="3494" href="Ledger.Ledger.html#2581" class="Datatype Operator">⊢</a> <a id="3496" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="3498" href="Ledger.Ledger.html#2374" class="Generalizable">utxoSt</a> <a id="3505" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3507" href="Ledger.Ledger.html#2403" class="Generalizable">govSt</a> <a id="3513" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3515" href="Ledger.Ledger.html#2429" class="Generalizable">certState</a> <a id="3525" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a> <a id="3527" href="Ledger.Ledger.html#2581" class="Datatype Operator">⇀⦇</a> <a id="3530" href="Ledger.Ledger.html#2464" class="Generalizable">tx</a> <a id="3533" href="Ledger.Ledger.html#2581" class="Datatype Operator">,LEDGER⦈</a> <a id="3542" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="3544" href="Ledger.Ledger.html#2381" class="Generalizable">utxoSt&#39;</a> <a id="3552" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3554" href="Ledger.Ledger.html#2403" class="Generalizable">govSt</a> <a id="3560" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3562" href="Ledger.Ledger.html#2429" class="Generalizable">certState</a> <a id="3572" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a>


<a id="3576" class="Keyword">pattern</a> <a id="LEDGER-V⋯"></a><a id="3584" href="Ledger.Ledger.html#3584" class="InductiveConstructor">LEDGER-V⋯</a> <a id="3594" href="Ledger.Ledger.html#3614" class="Bound">w</a> <a id="3596" href="Ledger.Ledger.html#3618" class="Bound">x</a> <a id="3598" href="Ledger.Ledger.html#3622" class="Bound">y</a> <a id="3600" href="Ledger.Ledger.html#3626" class="Bound">z</a> <a id="3602" class="Symbol">=</a> <a id="3604" href="Ledger.Ledger.html#2643" class="InductiveConstructor">LEDGER-V</a> <a id="3613" class="Symbol">(</a><a id="3614" href="Ledger.Ledger.html#3614" class="Bound">w</a> <a id="3616" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3618" href="Ledger.Ledger.html#3618" class="Bound">x</a> <a id="3620" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3622" href="Ledger.Ledger.html#3622" class="Bound">y</a> <a id="3624" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3626" href="Ledger.Ledger.html#3626" class="Bound">z</a><a id="3627" class="Symbol">)</a>
<a id="3629" class="Keyword">pattern</a> <a id="LEDGER-I⋯"></a><a id="3637" href="Ledger.Ledger.html#3637" class="InductiveConstructor">LEDGER-I⋯</a> <a id="3647" href="Ledger.Ledger.html#3667" class="Bound">y</a> <a id="3649" href="Ledger.Ledger.html#3671" class="Bound">z</a>     <a id="3655" class="Symbol">=</a> <a id="3657" href="Ledger.Ledger.html#3303" class="InductiveConstructor">LEDGER-I</a> <a id="3666" class="Symbol">(</a><a id="3667" href="Ledger.Ledger.html#3667" class="Bound">y</a> <a id="3669" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3671" href="Ledger.Ledger.html#3671" class="Bound">z</a><a id="3672" class="Symbol">)</a>


<a id="_⊢_⇀⦇_,LEDGERS⦈_"></a><a id="3676" href="Ledger.Ledger.html#3676" class="Function Operator">_⊢_⇀⦇_,LEDGERS⦈_</a> <a id="3693" class="Symbol">:</a> <a id="3695" href="Ledger.Ledger.html#545" class="Record">LEnv</a> <a id="3700" class="Symbol">→</a> <a id="3702" href="Ledger.Ledger.html#809" class="Record">LState</a> <a id="3709" class="Symbol">→</a> <a id="3711" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3716" href="Ledger.Transaction.html#4221" class="Record">Tx</a> <a id="3719" class="Symbol">→</a> <a id="3721" href="Ledger.Ledger.html#809" class="Record">LState</a> <a id="3728" class="Symbol">→</a> <a id="3730" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3735" href="Ledger.Ledger.html#3676" class="Function Operator">_⊢_⇀⦇_,LEDGERS⦈_</a> <a id="3752" class="Symbol">=</a> <a id="3754" href="Interface.STS.html#2329" class="Function">ReflexiveTransitiveClosure</a> <a id="3781" class="Symbol">{</a><a id="3782" class="Argument">sts</a> <a id="3786" class="Symbol">=</a> <a id="3788" href="Ledger.Ledger.html#2581" class="Datatype Operator">_⊢_⇀⦇_,LEDGER⦈_</a><a id="3803" class="Symbol">}</a>

</pre></body></html>