<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Specification.Chain.Properties</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Conway.Specification.Transaction.html" class="Module">Ledger.Conway.Specification.Transaction</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Ledger.Conway.Specification.Transaction.html#1000" class="Record">TransactionStructure</a><a id="104" class="Symbol">)</a>
<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Ledger.Conway.Specification.Abstract.html" class="Module">Ledger.Conway.Specification.Abstract</a> <a id="155" class="Keyword">using</a> <a id="161" class="Symbol">(</a><a id="162" href="Ledger.Conway.Specification.Abstract.html#648" class="Record">AbstractFunctions</a><a id="179" class="Symbol">)</a>

<a id="182" class="Keyword">module</a> <a id="189" href="Ledger.Conway.Specification.Chain.Properties.html" class="Module">Ledger.Conway.Specification.Chain.Properties</a>
  <a id="236" class="Symbol">(</a><a id="237" href="Ledger.Conway.Specification.Chain.Properties.html#237" class="Bound">txs</a> <a id="241" class="Symbol">:</a> <a id="243" class="Symbol">_)</a> <a id="246" class="Symbol">(</a><a id="247" class="Keyword">open</a> <a id="252" href="Ledger.Conway.Specification.Transaction.html#1000" class="Module">TransactionStructure</a> <a id="273" href="Ledger.Conway.Specification.Chain.Properties.html#237" class="Bound">txs</a><a id="276" class="Symbol">)</a>
  <a id="280" class="Symbol">(</a><a id="281" href="Ledger.Conway.Specification.Chain.Properties.html#281" class="Bound">abs</a> <a id="285" class="Symbol">:</a> <a id="287" href="Ledger.Conway.Specification.Abstract.html#648" class="Record">AbstractFunctions</a> <a id="305" href="Ledger.Conway.Specification.Chain.Properties.html#237" class="Bound">txs</a><a id="308" class="Symbol">)</a> <a id="310" class="Symbol">(</a><a id="311" class="Keyword">open</a> <a id="316" href="Ledger.Conway.Specification.Abstract.html#648" class="Module">AbstractFunctions</a> <a id="334" href="Ledger.Conway.Specification.Chain.Properties.html#281" class="Bound">abs</a><a id="337" class="Symbol">)</a>
  <a id="341" class="Keyword">where</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Specification.Chain.html" class="Module">Ledger.Conway.Specification.Chain</a> <a id="393" href="Ledger.Conway.Specification.Chain.Properties.html#237" class="Bound">txs</a> <a id="397" href="Ledger.Conway.Specification.Chain.Properties.html#281" class="Bound">abs</a>
<a id="401" class="Keyword">open</a> <a id="406" class="Keyword">import</a> <a id="413" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="447" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a> <a id="460" class="Keyword">using</a> <a id="466" class="Symbol">(</a><a id="467" href="Ledger.Conway.Specification.Enact.html#448" class="Record">EnactState</a><a id="477" class="Symbol">)</a>
<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Ledger.Conway.Specification.Epoch.html" class="Module">Ledger.Conway.Specification.Epoch</a> <a id="525" href="Ledger.Conway.Specification.Chain.Properties.html#237" class="Bound">txs</a> <a id="529" href="Ledger.Conway.Specification.Chain.Properties.html#281" class="Bound">abs</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Ledger.Conway.Specification.Epoch.Properties.html" class="Module">Ledger.Conway.Specification.Epoch.Properties</a> <a id="590" href="Ledger.Conway.Specification.Chain.Properties.html#237" class="Bound">txs</a> <a id="594" href="Ledger.Conway.Specification.Chain.Properties.html#281" class="Bound">abs</a>
<a id="598" class="Keyword">open</a> <a id="603" class="Keyword">import</a> <a id="610" href="Ledger.Conway.Specification.Ledger.html" class="Module">Ledger.Conway.Specification.Ledger</a> <a id="645" href="Ledger.Conway.Specification.Chain.Properties.html#237" class="Bound">txs</a> <a id="649" href="Ledger.Conway.Specification.Chain.Properties.html#281" class="Bound">abs</a>
<a id="653" class="Keyword">open</a> <a id="658" class="Keyword">import</a> <a id="665" href="Ledger.Conway.Specification.Ledger.Properties.html" class="Module">Ledger.Conway.Specification.Ledger.Properties</a> <a id="711" href="Ledger.Conway.Specification.Chain.Properties.html#237" class="Bound">txs</a> <a id="715" href="Ledger.Conway.Specification.Chain.Properties.html#281" class="Bound">abs</a>
<a id="719" class="Keyword">open</a> <a id="724" class="Keyword">import</a> <a id="731" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>

<a id="747" class="Keyword">open</a> <a id="752" href="Interface.ComputationalRelation.html#2799" class="Module">Computational</a> <a id="766" class="Symbol">⦃...⦄</a>

<a id="773" class="Keyword">module</a> <a id="780" href="Ledger.Conway.Specification.Chain.Properties.html#780" class="Module">_</a>
  <a id="784" class="Symbol">(</a><a id="785" href="Ledger.Conway.Specification.Chain.Properties.html#785" class="Bound">nes</a> <a id="789" class="Symbol">:</a> <a id="791" href="Ledger.Conway.Specification.Epoch.html#3014" class="Record">NewEpochState</a><a id="804" class="Symbol">)</a>
  <a id="808" class="Symbol">(</a><a id="809" class="Keyword">open</a> <a id="814" href="Ledger.Conway.Specification.Epoch.html#1705" class="Module">EpochState</a> <a id="825" class="Symbol">(</a><a id="826" href="Ledger.Conway.Specification.Epoch.html#3077" class="Field">NewEpochState.epochState</a> <a id="851" href="Ledger.Conway.Specification.Chain.Properties.html#785" class="Bound">nes</a><a id="854" class="Symbol">)</a> <a id="856" class="Keyword">using</a> <a id="862" class="Symbol">(</a><a id="863" href="Ledger.Conway.Specification.Epoch.html#1822" class="Field">ls</a><a id="865" class="Symbol">)</a> <a id="867" class="Keyword">renaming</a> <a id="876" class="Symbol">(</a><a id="877" href="Ledger.Conway.Specification.Epoch.html#1846" class="Field">es</a> <a id="880" class="Symbol">to</a> <a id="883" class="Field">es&#39;</a><a id="886" class="Symbol">))</a>
  <a id="891" class="Symbol">(</a><a id="892" class="Keyword">open</a> <a id="897" href="Ledger.Conway.Specification.Enact.html#448" class="Module">EnactState</a> <a id="908" href="Ledger.Conway.Specification.Chain.Properties.html#883" class="Function">es&#39;</a> <a id="912" class="Keyword">using</a> <a id="918" class="Symbol">(</a><a id="919" href="Ledger.Conway.Specification.Enact.html#658" class="Field">pparams</a><a id="926" class="Symbol">))</a>
  <a id="931" class="Symbol">(</a><a id="932" class="Keyword">open</a> <a id="937" href="Ledger.Conway.Specification.PParams.html#1685" class="Module">PParams</a> <a id="945" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="947" href="Ledger.Conway.Specification.Enact.html#658" class="Function">pparams</a> <a id="955" href="Ledger.Prelude.html#2253" class="Function Operator">∣</a> <a id="957" class="Keyword">using</a> <a id="963" class="Symbol">(</a><a id="964" href="Ledger.Conway.Specification.PParams.html#2597" class="Field">maxRefScriptSizePerBlock</a><a id="988" class="Symbol">))</a>
  <a id="993" class="Symbol">(</a><a id="994" href="Ledger.Conway.Specification.Chain.Properties.html#994" class="Bound">ts</a> <a id="997" class="Symbol">:</a> <a id="999" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1004" href="Ledger.Conway.Specification.Transaction.html#4684" class="Record">Tx</a><a id="1006" class="Symbol">)</a>
  <a id="1010" class="Keyword">where</a>
  <a id="1018" href="Ledger.Conway.Specification.Chain.Properties.html#1018" class="Function">refScriptSize≤?Bound</a> <a id="1039" class="Symbol">:</a> <a id="1041" href="Relation.Nullary.Decidable.Core.html#1966" class="Record">Dec</a> <a id="1045" class="Symbol">(</a><a id="1046" href="Ledger.Conway.Specification.Chain.html#3826" class="Function">totalRefScriptsSize</a> <a id="1066" href="Ledger.Conway.Specification.Epoch.html#1822" class="Function">ls</a> <a id="1069" href="Ledger.Conway.Specification.Chain.Properties.html#994" class="Bound">ts</a> <a id="1072" href="Class.HasOrder.Core.html#613" class="Field Operator">≤</a> <a id="1074" href="Ledger.Conway.Specification.PParams.html#2597" class="Function">maxRefScriptSizePerBlock</a><a id="1098" class="Symbol">)</a>
  <a id="1102" href="Ledger.Conway.Specification.Chain.Properties.html#1018" class="Function">refScriptSize≤?Bound</a> <a id="1123" class="Symbol">=</a> <a id="1125" href="Ledger.Conway.Specification.Chain.html#3826" class="Function">totalRefScriptsSize</a> <a id="1145" href="Ledger.Conway.Specification.Epoch.html#1822" class="Function">ls</a> <a id="1148" href="Ledger.Conway.Specification.Chain.Properties.html#994" class="Bound">ts</a> <a id="1151" href="Class.HasOrder.Core.html#1016" class="Function Operator">≤?</a> <a id="1154" href="Ledger.Conway.Specification.PParams.html#2597" class="Function">maxRefScriptSizePerBlock</a>

<a id="1180" class="Keyword">instance</a>
  <a id="Computational-CHAIN"></a><a id="1191" href="Ledger.Conway.Specification.Chain.Properties.html#1191" class="Function">Computational-CHAIN</a> <a id="1211" class="Symbol">:</a> <a id="1213" href="Interface.ComputationalRelation.html#2799" class="Record">Computational</a> <a id="1227" href="Ledger.Conway.Specification.Chain.html#4021" class="Datatype Operator">_⊢_⇀⦇_,CHAIN⦈_</a> <a id="1242" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1251" href="Ledger.Conway.Specification.Chain.Properties.html#1191" class="Function">Computational-CHAIN</a> <a id="1271" class="Symbol">.</a><a id="1272" href="Interface.ComputationalRelation.html#2879" class="Field">computeProof</a> <a id="1285" href="Ledger.Conway.Specification.Chain.Properties.html#1285" class="Bound">Γ</a> <a id="1287" href="Ledger.Conway.Specification.Chain.Properties.html#1287" class="Bound">s</a> <a id="1289" class="Keyword">record</a> <a id="1296" class="Symbol">{</a> <a id="1298" href="Ledger.Conway.Specification.Chain.html#894" class="Field">ts</a> <a id="1301" class="Symbol">=</a> <a id="1303" href="Ledger.Conway.Specification.Chain.Properties.html#1303" class="Bound">ts</a> <a id="1306" class="Symbol">}</a> <a id="1308" class="Symbol">=</a> <a id="1310" class="Keyword">do</a>
    <a id="1317" href="Ledger.Conway.Specification.Chain.Properties.html#1317" class="Bound">nes</a> <a id="1321" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1323" href="Ledger.Conway.Specification.Chain.Properties.html#1323" class="Bound">neStep</a> <a id="1330" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1332" href="Class.Bifunctor.html#1045" class="Function">map₁</a> <a id="1337" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="1344" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="1346" href="Interface.ComputationalRelation.html#2879" class="Field">computeProof</a> <a id="1359" class="Symbol">{</a><a id="1360" class="Argument">STS</a> <a id="1364" class="Symbol">=</a> <a id="1366" href="Ledger.Conway.Specification.Epoch.html#14763" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a><a id="1383" class="Symbol">}</a> <a id="1385" class="Symbol">_</a> <a id="1387" class="Symbol">_</a> <a id="1389" class="Symbol">_</a>
    <a id="1395" class="Symbol">_</a> <a id="1397" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1399" href="Ledger.Conway.Specification.Chain.Properties.html#1399" class="Bound">lsStep</a> <a id="1406" href="Class.Monad.Core.html#337" class="Field Operator">←</a> <a id="1408" href="Interface.ComputationalRelation.html#2879" class="Field">computeProof</a> <a id="1421" class="Symbol">_</a> <a id="1423" class="Symbol">(</a><a id="1424" href="Ledger.Conway.Specification.Ledger.html#1176" class="Field">LStateOf</a> <a id="1433" href="Ledger.Conway.Specification.Chain.Properties.html#1317" class="Bound">nes</a><a id="1436" class="Symbol">)</a> <a id="1438" href="Ledger.Conway.Specification.Chain.Properties.html#1303" class="Bound">ts</a>
    <a id="1445" href="Function.Base.html#4061" class="Function Operator">case</a> <a id="1450" href="Ledger.Conway.Specification.Chain.Properties.html#1018" class="Function">refScriptSize≤?Bound</a> <a id="1471" href="Ledger.Conway.Specification.Chain.Properties.html#1317" class="Bound">nes</a> <a id="1475" href="Ledger.Conway.Specification.Chain.Properties.html#1303" class="Bound">ts</a> <a id="1478" href="Function.Base.html#4061" class="Function Operator">of</a> <a id="1481" class="Symbol">λ</a> <a id="1483" class="Keyword">where</a>
      <a id="1495" class="Symbol">(</a><a id="1496" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1499" href="Ledger.Conway.Specification.Chain.Properties.html#1499" class="Bound">¬p</a><a id="1501" class="Symbol">)</a> <a id="1503" class="Symbol">→</a> <a id="1505" href="Interface.ComputationalRelation.html#348" class="InductiveConstructor">failure</a> <a id="1513" class="String">&quot;totalRefScriptsSize &gt; maxRefScriptSizePerBlock&quot;</a>
      <a id="1568" class="Symbol">(</a><a id="1569" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1573" href="Ledger.Conway.Specification.Chain.Properties.html#1573" class="Bound">p</a><a id="1574" class="Symbol">)</a> <a id="1576" class="Symbol">→</a> <a id="1578" href="Interface.ComputationalRelation.html#308" class="InductiveConstructor">success</a> <a id="1586" class="Symbol">(_</a> <a id="1589" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1591" href="Ledger.Conway.Specification.Chain.html#4095" class="InductiveConstructor">CHAIN</a> <a id="1597" class="Symbol">(</a><a id="1598" href="Ledger.Conway.Specification.Chain.Properties.html#1573" class="Bound">p</a> <a id="1600" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1602" href="Ledger.Conway.Specification.Chain.Properties.html#1323" class="Bound">neStep</a> <a id="1609" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1611" href="Ledger.Conway.Specification.Chain.Properties.html#1399" class="Bound">lsStep</a><a id="1617" class="Symbol">))</a>

  <a id="1623" href="Ledger.Conway.Specification.Chain.Properties.html#1191" class="Function">Computational-CHAIN</a> <a id="1643" class="Symbol">.</a><a id="1644" href="Interface.ComputationalRelation.html#3096" class="Field">completeness</a> <a id="1657" class="Symbol">_</a> <a id="1659" href="Ledger.Conway.Specification.Chain.Properties.html#1659" class="Bound">s</a> <a id="1661" href="Ledger.Conway.Specification.Chain.Properties.html#1661" class="Bound">b</a> <a id="1663" class="Symbol">_</a> <a id="1665" class="Symbol">(</a><a id="1666" href="Ledger.Conway.Specification.Chain.html#4095" class="InductiveConstructor">CHAIN</a> <a id="1672" class="Symbol">{</a><a id="1673" class="Argument">nes</a> <a id="1677" class="Symbol">=</a> <a id="1679" href="Ledger.Conway.Specification.Chain.Properties.html#1679" class="Bound">nes</a><a id="1682" class="Symbol">}</a> <a id="1684" class="Symbol">(</a><a id="1685" href="Ledger.Conway.Specification.Chain.Properties.html#1685" class="Bound">p</a> <a id="1687" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1689" href="Ledger.Conway.Specification.Chain.Properties.html#1689" class="Bound">neStep</a> <a id="1696" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1698" href="Ledger.Conway.Specification.Chain.Properties.html#1698" class="Bound">lsStep</a><a id="1704" class="Symbol">))</a>
    <a id="1711" class="Keyword">with</a> <a id="1716" href="Interface.ComputationalRelation.html#4350" class="Function">recomputeProof</a> <a id="1731" href="Ledger.Conway.Specification.Chain.Properties.html#1689" class="Bound">neStep</a> <a id="1738" class="Symbol">|</a> <a id="1740" href="Interface.ComputationalRelation.html#3096" class="Field">completeness</a> <a id="1753" class="Symbol">_</a> <a id="1755" class="Symbol">_</a> <a id="1757" class="Symbol">_</a> <a id="1759" class="Symbol">_</a> <a id="1761" href="Ledger.Conway.Specification.Chain.Properties.html#1689" class="Bound">neStep</a>
  <a id="1770" class="Symbol">...</a> <a id="1774" class="Symbol">|</a> <a id="1776" class="Symbol">_</a>         <a id="1786" class="Symbol">|</a> <a id="1788" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1797" class="Keyword">with</a> <a id="1802" href="Interface.ComputationalRelation.html#4350" class="Function">recomputeProof</a> <a id="1817" class="Bound">lsStep</a> <a id="1824" class="Symbol">|</a> <a id="1826" href="Interface.ComputationalRelation.html#3096" class="Field">completeness</a> <a id="1839" class="Symbol">_</a> <a id="1841" class="Symbol">_</a> <a id="1843" class="Symbol">_</a> <a id="1845" class="Symbol">_</a> <a id="1847" class="Bound">lsStep</a>
  <a id="1856" class="Symbol">...</a> <a id="1860" class="Symbol">|</a> <a id="1862" href="Interface.ComputationalRelation.html#308" class="InductiveConstructor">success</a> <a id="1870" class="Symbol">_</a> <a id="1872" class="Symbol">|</a> <a id="1874" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="1883" class="Keyword">with</a> <a id="1888" href="Ledger.Conway.Specification.Chain.Properties.html#1018" class="Function">refScriptSize≤?Bound</a> <a id="1909" class="Bound">nes</a> <a id="1913" class="Symbol">(</a><a id="1914" href="Ledger.Conway.Specification.Chain.html#894" class="Field">Block.ts</a> <a id="1923" class="Bound">b</a><a id="1924" class="Symbol">)</a>
  <a id="1928" class="Symbol">...</a> <a id="1932" class="Symbol">|</a> <a id="1934" href="Relation.Nullary.Decidable.Core.html#2099" class="InductiveConstructor">yes</a> <a id="1938" href="Ledger.Conway.Specification.Chain.Properties.html#1938" class="Bound">p</a> <a id="1940" class="Symbol">=</a> <a id="1942" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="1949" class="Symbol">...</a> <a id="1953" class="Symbol">|</a> <a id="1955" href="Relation.Nullary.Decidable.Core.html#2136" class="InductiveConstructor">no</a> <a id="1958" href="Ledger.Conway.Specification.Chain.Properties.html#1958" class="Bound">¬p</a> <a id="1961" class="Symbol">=</a> <a id="1963" href="Data.Empty.html#1069" class="Function">⊥-elim</a> <a id="1970" class="Symbol">(</a><a id="1971" href="Ledger.Conway.Specification.Chain.Properties.html#1958" class="Bound">¬p</a> <a id="1974" class="Bound">p</a><a id="1975" class="Symbol">)</a>
</pre></body></html>