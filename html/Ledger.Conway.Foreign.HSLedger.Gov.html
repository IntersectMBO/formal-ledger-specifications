<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Gov</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Gov.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="88" class="Symbol">)</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Ledger.Conway.Foreign.HSLedger.Gov.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Core</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Actions</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Ledger.Conway.Foreign.HSLedger.Cert.html" class="Module">Ledger.Conway.Foreign.HSLedger.Cert</a>

<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="495" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="554" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Ledger.Conway.Conformance.Gov.html" class="Module">Ledger.Conway.Conformance.Gov</a> <a id="609" href="Function.Base.html#4755" class="Function">it</a> <a id="612" href="Function.Base.html#4755" class="Function">it</a>
<a id="615" class="Keyword">import</a> <a id="622" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="654" href="Function.Base.html#4755" class="Function">it</a> <a id="657" class="Symbol">as</a> <a id="L"></a><a id="660" href="Ledger.Conway.Foreign.HSLedger.Gov.html#660" class="Module">L</a>
<a id="662" class="Keyword">open</a> <a id="667" class="Keyword">import</a> <a id="674" href="Ledger.Conway.Specification.Gov.Properties.Computational.html" class="Module">Ledger.Conway.Specification.Gov.Properties.Computational</a> <a id="731" href="Function.Base.html#4755" class="Function">it</a>

<a id="735" class="Keyword">instance</a>

  <a id="HsTy-GovEnv"></a><a id="747" href="Ledger.Conway.Foreign.HSLedger.Gov.html#747" class="Function">HsTy-GovEnv</a> <a id="759" class="Symbol">=</a> <a id="761" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType</a> <a id="772" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="779" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">⊣</a> <a id="781" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="797" class="String">&quot;MkGovEnv&quot;</a>
                                  <a id="842" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="844" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="856" class="String">&quot;ge&quot;</a>
  <a id="Conv-GovEnv"></a><a id="863" href="Ledger.Conway.Foreign.HSLedger.Gov.html#863" class="Function">Conv-GovEnv</a> <a id="875" class="Symbol">=</a> <a id="877" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="889" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a>

<a id="897" class="Comment">-- NeedsHash depends on a GovAction, so a little bit of manual work is</a>
<a id="968" class="Comment">-- required to get the types using it into Haskell.</a>

<a id="1021" class="Comment">-- First we define to/fromNeedsHash that replaces the ⊤ cases by a</a>
<a id="1088" class="Comment">-- dummy GovActionID.</a>

<a id="toNeedsHash"></a><a id="1111" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1123" class="Symbol">:</a> <a id="1125" class="Symbol">∀</a> <a id="1127" class="Symbol">{</a><a id="1128" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1128" class="Bound">action</a><a id="1134" class="Symbol">}</a> <a id="1136" class="Symbol">→</a> <a id="1138" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a> <a id="1150" class="Symbol">→</a> <a id="1152" href="Ledger.Conway.Specification.Gov.Actions.html#2874" class="Function">NeedsHash</a> <a id="1162" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1128" class="Bound">action</a>
<a id="1169" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1181" class="Symbol">{</a><a id="1182" href="Ledger.Conway.Specification.Gov.Actions.html#656" class="InductiveConstructor">NoConfidence</a><a id="1194" class="Symbol">}</a>        <a id="1203" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1203" class="Bound">x</a> <a id="1205" class="Symbol">=</a> <a id="1207" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1203" class="Bound">x</a>
<a id="1209" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1221" class="Symbol">{</a><a id="1222" href="Ledger.Conway.Specification.Gov.Actions.html#694" class="InductiveConstructor">UpdateCommittee</a><a id="1237" class="Symbol">}</a>     <a id="1243" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1243" class="Bound">x</a> <a id="1245" class="Symbol">=</a> <a id="1247" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1243" class="Bound">x</a>
<a id="1249" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1261" class="Symbol">{</a><a id="1262" href="Ledger.Conway.Specification.Gov.Actions.html#732" class="InductiveConstructor">NewConstitution</a><a id="1277" class="Symbol">}</a>     <a id="1283" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1283" class="Bound">x</a> <a id="1285" class="Symbol">=</a> <a id="1287" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1283" class="Bound">x</a>
<a id="1289" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1301" class="Symbol">{</a><a id="1302" href="Ledger.Conway.Specification.Gov.Actions.html#770" class="InductiveConstructor">TriggerHardFork</a><a id="1317" class="Symbol">}</a>     <a id="1323" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1323" class="Bound">x</a> <a id="1325" class="Symbol">=</a> <a id="1327" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1323" class="Bound">x</a>
<a id="1329" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1341" class="Symbol">{</a><a id="1342" href="Ledger.Conway.Specification.Gov.Actions.html#808" class="InductiveConstructor">ChangePParams</a><a id="1355" class="Symbol">}</a>       <a id="1363" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1363" class="Bound">x</a> <a id="1365" class="Symbol">=</a> <a id="1367" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1363" class="Bound">x</a>
<a id="1369" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1381" class="Symbol">{</a><a id="1382" href="Ledger.Conway.Specification.Gov.Actions.html#846" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1400" class="Symbol">}</a>  <a id="1403" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1403" class="Bound">x</a> <a id="1405" class="Symbol">=</a> <a id="1407" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="1410" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1422" class="Symbol">{</a><a id="1423" href="Ledger.Conway.Specification.Gov.Actions.html#884" class="InductiveConstructor">Info</a><a id="1427" class="Symbol">}</a>                <a id="1444" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1444" class="Bound">x</a> <a id="1446" class="Symbol">=</a> <a id="1448" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

<a id="fromNeedsHash"></a><a id="1452" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1466" class="Symbol">:</a> <a id="1468" class="Symbol">∀</a> <a id="1470" class="Symbol">{</a><a id="1471" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1471" class="Bound">action</a><a id="1477" class="Symbol">}</a> <a id="1479" class="Symbol">→</a> <a id="1481" href="Ledger.Conway.Specification.Gov.Actions.html#2874" class="Function">NeedsHash</a> <a id="1491" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1471" class="Bound">action</a> <a id="1498" class="Symbol">→</a> <a id="1500" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a>
<a id="1512" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1526" class="Symbol">{</a><a id="1527" href="Ledger.Conway.Specification.Gov.Actions.html#656" class="InductiveConstructor">NoConfidence</a><a id="1539" class="Symbol">}</a>        <a id="1548" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1548" class="Bound">x</a> <a id="1550" class="Symbol">=</a> <a id="1552" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1548" class="Bound">x</a>
<a id="1554" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1568" class="Symbol">{</a><a id="1569" href="Ledger.Conway.Specification.Gov.Actions.html#694" class="InductiveConstructor">UpdateCommittee</a><a id="1584" class="Symbol">}</a>     <a id="1590" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1590" class="Bound">x</a> <a id="1592" class="Symbol">=</a> <a id="1594" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1590" class="Bound">x</a>
<a id="1596" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1610" class="Symbol">{</a><a id="1611" href="Ledger.Conway.Specification.Gov.Actions.html#732" class="InductiveConstructor">NewConstitution</a><a id="1626" class="Symbol">}</a>     <a id="1632" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1632" class="Bound">x</a> <a id="1634" class="Symbol">=</a> <a id="1636" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1632" class="Bound">x</a>
<a id="1638" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1652" class="Symbol">{</a><a id="1653" href="Ledger.Conway.Specification.Gov.Actions.html#770" class="InductiveConstructor">TriggerHardFork</a><a id="1668" class="Symbol">}</a>     <a id="1674" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1674" class="Bound">x</a> <a id="1676" class="Symbol">=</a> <a id="1678" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1674" class="Bound">x</a>
<a id="1680" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1694" class="Symbol">{</a><a id="1695" href="Ledger.Conway.Specification.Gov.Actions.html#808" class="InductiveConstructor">ChangePParams</a><a id="1708" class="Symbol">}</a>       <a id="1716" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1716" class="Bound">x</a> <a id="1718" class="Symbol">=</a> <a id="1720" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1716" class="Bound">x</a>
<a id="1722" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1736" class="Symbol">{</a><a id="1737" href="Ledger.Conway.Specification.Gov.Actions.html#846" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1755" class="Symbol">}</a>  <a id="1758" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1758" class="Bound">x</a> <a id="1760" class="Symbol">=</a> <a id="1762" class="Number">0</a> <a id="1764" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1766" class="Number">0</a>
<a id="1768" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1782" class="Symbol">{</a><a id="1783" href="Ledger.Conway.Specification.Gov.Actions.html#884" class="InductiveConstructor">Info</a><a id="1787" class="Symbol">}</a>                <a id="1804" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1804" class="Bound">x</a> <a id="1806" class="Symbol">=</a> <a id="1808" class="Number">0</a> <a id="1810" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1812" class="Number">0</a>

<a id="1815" class="Comment">-- Then we define non-dependent versions of the types that use</a>
<a id="1878" class="Comment">-- NeedsHash.</a>

<a id="1893" class="Keyword">record</a> <a id="GovProposal&#39;"></a><a id="1900" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a> <a id="1913" class="Symbol">:</a> <a id="1915" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1920" class="Keyword">where</a>
  <a id="1928" class="Keyword">field</a>
    <a id="GovProposal&#39;.action"></a><a id="1938" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1938" class="Field">action</a>      <a id="1950" class="Symbol">:</a> <a id="1952" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovProposal&#39;.prevAction"></a><a id="1967" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1967" class="Field">prevAction</a>  <a id="1979" class="Symbol">:</a> <a id="1981" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a>       <a id="1999" class="Comment">-- NeedsHash action</a>
    <a id="GovProposal&#39;.policy"></a><a id="2023" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2023" class="Field">policy</a>      <a id="2035" class="Symbol">:</a> <a id="2037" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2043" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
    <a id="GovProposal&#39;.deposit"></a><a id="2058" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2058" class="Field">deposit</a>     <a id="2070" class="Symbol">:</a> <a id="2072" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="GovProposal&#39;.returnAddr"></a><a id="2081" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2081" class="Field">returnAddr</a>  <a id="2093" class="Symbol">:</a> <a id="2095" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a>
    <a id="GovProposal&#39;.anchor"></a><a id="2113" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2113" class="Field">anchor</a>      <a id="2125" class="Symbol">:</a> <a id="2127" href="Ledger.Conway.Specification.Gov.Actions.html#2218" class="Record">Anchor</a>

<a id="2135" class="Keyword">record</a> <a id="GovActionState&#39;"></a><a id="2142" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2142" class="Record">GovActionState&#39;</a> <a id="2158" class="Symbol">:</a> <a id="2160" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2165" class="Keyword">where</a>
  <a id="2173" class="Keyword">field</a>
    <a id="GovActionState&#39;.votes"></a><a id="2183" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2183" class="Field">votes</a>       <a id="2195" class="Symbol">:</a> <a id="2197" href="Ledger.Conway.Specification.Gov.Actions.html#2443" class="Record">GovVotes</a>
    <a id="GovActionState&#39;.returnAddr"></a><a id="2210" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2210" class="Field">returnAddr</a>  <a id="2222" class="Symbol">:</a> <a id="2224" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a>
    <a id="GovActionState&#39;.expiresIn"></a><a id="2242" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2242" class="Field">expiresIn</a>   <a id="2254" class="Symbol">:</a> <a id="2256" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
    <a id="GovActionState&#39;.action"></a><a id="2266" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2266" class="Field">action</a>      <a id="2278" class="Symbol">:</a> <a id="2280" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovActionState&#39;.prevAction"></a><a id="2295" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2295" class="Field">prevAction</a>  <a id="2307" class="Symbol">:</a> <a id="2309" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a>       <a id="2327" class="Comment">-- NeedsHash action</a>

<a id="2348" class="Comment">-- We can convert between the dependent and non-dependent versions</a>
<a id="2415" class="Comment">-- using to/fromNeedsHash.</a>

<a id="2443" class="Keyword">private</a>
  <a id="mkGovProposal&#39;"></a><a id="2453" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2453" class="Function">mkGovProposal&#39;</a> <a id="2468" class="Symbol">:</a> <a id="2470" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2482" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Record">GovProposal</a> <a id="2494" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a>
  <a id="2509" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2453" class="Function">mkGovProposal&#39;</a> <a id="2524" class="Symbol">=</a> <a id="2526" class="Symbol">λ</a> <a id="2528" class="Keyword">where</a>
    <a id="2538" class="Symbol">.</a><a id="2539" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2544" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2544" class="Bound">p</a> <a id="2546" class="Symbol">→</a> <a id="2548" class="Keyword">let</a> <a id="2552" class="Keyword">module</a> <a id="p"></a><a id="2559" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2559" class="Module">p</a> <a id="2561" class="Symbol">=</a> <a id="2563" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Module">GovProposal</a>  <a id="2576" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2544" class="Bound">p</a> <a id="2578" class="Keyword">in</a> <a id="2581" class="Keyword">record</a> <a id="2588" class="Symbol">{</a> <a id="2590" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2559" class="Module">p</a><a id="2591" class="Symbol">;</a> <a id="2593" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1938" class="Field">action</a> <a id="2600" class="Symbol">=</a> <a id="2602" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2605" href="Ledger.Conway.Specification.Gov.Actions.html#3640" class="Field">p.action</a>  <a id="2615" class="Symbol">;</a> <a id="2617" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1967" class="Field">prevAction</a> <a id="2628" class="Symbol">=</a> <a id="2630" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="2644" href="Ledger.Conway.Specification.Gov.Actions.html#3668" class="Field">p.prevAction</a> <a id="2657" class="Symbol">}</a>
    <a id="2663" class="Symbol">.</a><a id="2664" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2669" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2669" class="Bound">p</a> <a id="2671" class="Symbol">→</a> <a id="2673" class="Keyword">let</a> <a id="2677" class="Keyword">module</a> <a id="p"></a><a id="2684" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2684" class="Module">p</a> <a id="2686" class="Symbol">=</a> <a id="2688" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Module">GovProposal&#39;</a> <a id="2701" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2669" class="Bound">p</a> <a id="2703" class="Keyword">in</a> <a id="2706" class="Keyword">record</a> <a id="2713" class="Symbol">{</a> <a id="2715" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2684" class="Module">p</a><a id="2716" class="Symbol">;</a> <a id="2718" href="Ledger.Conway.Specification.Gov.Actions.html#3640" class="Field">action</a> <a id="2725" class="Symbol">=</a> <a id="2727" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2732" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1938" class="Field">p.action</a><a id="2740" class="Symbol">;</a> <a id="2742" href="Ledger.Conway.Specification.Gov.Actions.html#3668" class="Field">prevAction</a> <a id="2753" class="Symbol">=</a> <a id="2755" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a>   <a id="2769" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1967" class="Field">p.prevAction</a> <a id="2782" class="Symbol">}</a>

  <a id="mkGovActionState&#39;"></a><a id="2787" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2787" class="Function">mkGovActionState&#39;</a> <a id="2805" class="Symbol">:</a> <a id="2807" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2819" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Record">GovActionState</a> <a id="2834" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2142" class="Record">GovActionState&#39;</a>
  <a id="2852" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2787" class="Function">mkGovActionState&#39;</a> <a id="2870" class="Symbol">=</a> <a id="2872" class="Symbol">λ</a> <a id="2874" class="Keyword">where</a>
    <a id="2884" class="Symbol">.</a><a id="2885" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2890" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2890" class="Bound">s</a> <a id="2892" class="Symbol">→</a> <a id="2894" class="Keyword">let</a> <a id="2898" class="Keyword">module</a> <a id="s"></a><a id="2905" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2905" class="Module">s</a> <a id="2907" class="Symbol">=</a> <a id="2909" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Module">GovActionState</a>  <a id="2925" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2890" class="Bound">s</a> <a id="2927" class="Keyword">in</a> <a id="2930" class="Keyword">record</a><a id="2936" class="Symbol">{</a> <a id="2938" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2905" class="Module">s</a><a id="2939" class="Symbol">;</a> <a id="2941" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2266" class="Field">action</a> <a id="2948" class="Symbol">=</a> <a id="2950" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2953" href="Ledger.Conway.Specification.Gov.Actions.html#3945" class="Field">s.action</a>  <a id="2963" class="Symbol">;</a> <a id="2965" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2295" class="Field">prevAction</a> <a id="2976" class="Symbol">=</a> <a id="2978" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="2992" href="Ledger.Conway.Specification.Gov.Actions.html#3973" class="Field">s.prevAction</a> <a id="3005" class="Symbol">}</a>
    <a id="3011" class="Symbol">.</a><a id="3012" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3017" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3017" class="Bound">s</a> <a id="3019" class="Symbol">→</a> <a id="3021" class="Keyword">let</a> <a id="3025" class="Keyword">module</a> <a id="s"></a><a id="3032" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3032" class="Module">s</a> <a id="3034" class="Symbol">=</a> <a id="3036" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2142" class="Module">GovActionState&#39;</a> <a id="3052" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3017" class="Bound">s</a> <a id="3054" class="Keyword">in</a> <a id="3057" class="Keyword">record</a><a id="3063" class="Symbol">{</a> <a id="3065" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3032" class="Module">s</a><a id="3066" class="Symbol">;</a> <a id="3068" href="Ledger.Conway.Specification.Gov.Actions.html#3945" class="Field">action</a> <a id="3075" class="Symbol">=</a> <a id="3077" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3082" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2266" class="Field">s.action</a><a id="3090" class="Symbol">;</a> <a id="3092" href="Ledger.Conway.Specification.Gov.Actions.html#3973" class="Field">prevAction</a> <a id="3103" class="Symbol">=</a> <a id="3105" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a>   <a id="3119" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2295" class="Field">s.prevAction</a> <a id="3132" class="Symbol">}</a>

<a id="3135" class="Comment">-- Auto-generated conversions for the non-dependent types</a>

<a id="3194" class="Keyword">instance</a>
  <a id="HsTy-GovProposal&#39;"></a><a id="3205" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3205" class="Function">HsTy-GovProposal&#39;</a> <a id="3223" class="Symbol">=</a> <a id="3225" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType</a> <a id="3236" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a> <a id="3249" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">⊣</a> <a id="3251" href="Foreign.HaskellTypes.Deriving.html#3333" class="Function">withName</a> <a id="3260" class="String">&quot;GovProposal&quot;</a>
                                              <a id="3320" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3322" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="3338" class="String">&quot;MkGovProposal&quot;</a>
                                              <a id="3400" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3402" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="3414" class="String">&quot;gp&quot;</a>
  <a id="Conv-GovProposal&#39;"></a><a id="3421" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3421" class="Function">Conv-GovProposal&#39;</a> <a id="3439" class="Symbol">=</a> <a id="3441" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3453" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a>

  <a id="HsTy-GovActionState&#39;"></a><a id="3469" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3469" class="Function">HsTy-GovActionState&#39;</a> <a id="3490" class="Symbol">=</a> <a id="3492" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType</a> <a id="3503" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2142" class="Record">GovActionState&#39;</a> <a id="3519" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">⊣</a> <a id="3521" href="Foreign.HaskellTypes.Deriving.html#3333" class="Function">withName</a> <a id="3530" class="String">&quot;GovActionState&quot;</a>
                                                    <a id="3599" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3601" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="3617" class="String">&quot;MkGovActionState&quot;</a>
                                                    <a id="3688" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3690" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="3702" class="String">&quot;gas&quot;</a>
  <a id="Conv-GovActionState&#39;"></a><a id="3710" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3710" class="Function">Conv-GovActionState&#39;</a> <a id="3731" class="Symbol">=</a> <a id="3733" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3745" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2142" class="Record">GovActionState&#39;</a>

<a id="3762" class="Comment">-- And finally we compose everything into conversions for the dependent types</a>

<a id="3841" class="Keyword">instance</a>
  <a id="HsTy-GovProposal"></a><a id="3852" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3852" class="Function">HsTy-GovProposal</a> <a id="3869" class="Symbol">=</a> <a id="3871" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3880" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Record">GovProposal</a> <a id="3892" class="Symbol">(</a><a id="3893" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3900" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a><a id="3912" class="Symbol">)</a>
  <a id="Conv-GovProposal"></a><a id="3916" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3916" class="Function">Conv-GovProposal</a> <a id="3933" class="Symbol">=</a> <a id="3935" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2453" class="Function">mkGovProposal&#39;</a> <a id="3950" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="3952" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3421" class="Function">Conv-GovProposal&#39;</a>

  <a id="HsTy-GovActionState"></a><a id="3973" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3973" class="Function">HsTy-GovActionState</a> <a id="3993" class="Symbol">=</a> <a id="3995" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="4004" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Record">GovActionState</a> <a id="4019" class="Symbol">(</a><a id="4020" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4027" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2142" class="Record">GovActionState&#39;</a><a id="4042" class="Symbol">)</a>
  <a id="Conv-GovActionState"></a><a id="4046" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4046" class="Function">Conv-GovActionState</a> <a id="4066" class="Symbol">=</a> <a id="4068" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2787" class="Function">mkGovActionState&#39;</a> <a id="4086" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="4088" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3710" class="Function">Conv-GovActionState&#39;</a>

<a id="4110" class="Keyword">unquoteDecl</a> <a id="4122" class="Symbol">=</a> <a id="4124" class="Keyword">do</a>
  hsTypeAlias GovActionID
  hsTypeAlias GovState
  hsTypeAlias GovVoter&#39;

<a id="4201" class="Comment">-- Computational function</a>

<a id="gov-step"></a><a id="4228" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4228" class="Function">gov-step</a> <a id="4237" class="Symbol">:</a> <a id="4239" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4246" class="Symbol">(</a><a id="4247" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="4254" class="Symbol">→</a> <a id="4256" href="Ledger.Conway.Specification.Gov.html#1465" class="Function">GovState</a> <a id="4265" class="Symbol">→</a> <a id="4267" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4272" class="Symbol">(</a><a id="4273" href="Ledger.Conway.Specification.Gov.Actions.html#2294" class="Record">GovVote</a> <a id="4281" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4283" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Record">GovProposal</a><a id="4294" class="Symbol">)</a> <a id="4296" class="Symbol">→</a> <a id="4298" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="4316" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4323" href="Ledger.Conway.Specification.Gov.html#1465" class="Function">GovState</a><a id="4331" class="Symbol">)</a>
<a id="4333" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4228" class="Function">gov-step</a> <a id="4342" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4342" class="Bound">Γ</a> <a id="4344" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4344" class="Bound">govSt</a> <a id="4350" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4350" class="Bound">gvps</a> <a id="4355" class="Symbol">=</a> <a id="4357" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="4360" class="Symbol">(</a><a id="4361" href="Interface.ComputationalRelation.html#2981" class="Function">compute</a> <a id="4369" href="Ledger.Conway.Specification.Gov.Properties.Computational.html#7721" class="Function">Computational-GOVS</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Gov.html#861}{\htmlId{4390}{\htmlClass{Function}{\text{txid}}}}\, \\ \,\href{Ledger.Conway.Foreign.HSLedger.Gov.html#4538}{\htmlId{4397}{\htmlClass{Function}{\text{e&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#908}{\htmlId{4402}{\htmlClass{Function}{\text{pparams}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#934}{\htmlId{4412}{\htmlClass{Function}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#969}{\htmlId{4422}{\htmlClass{Function}{\text{enactState}}}}\, \\ \,\href{Foreign.Convertible.html#149}{\htmlId{4435}{\htmlClass{Field}{\text{to}}}}\, \,\href{Ledger.Conway.Conformance.Gov.html#998}{\htmlId{4438}{\htmlClass{Function}{\text{certState}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#1026}{\htmlId{4450}{\htmlClass{Function}{\text{rewardCreds}}}}\, \end{pmatrix}$</a> <a id="4464" class="Symbol">(</a><a id="4465" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4470" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4344" class="Bound">govSt</a><a id="4475" class="Symbol">)</a> <a id="4477" class="Symbol">(</a><a id="4478" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4483" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4350" class="Bound">gvps</a><a id="4487" class="Symbol">))</a>
  <a id="4492" class="Keyword">where</a> <a id="4498" class="Keyword">open</a> <a id="4503" href="Ledger.Conway.Conformance.Gov.html#829" class="Module">GovEnv</a> <a id="4510" class="Symbol">(</a><a id="4511" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4516" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4342" class="Bound">Γ</a><a id="4517" class="Symbol">)</a> <a id="4519" class="Keyword">renaming</a> <a id="4528" class="Symbol">(</a><a id="4529" href="Ledger.Conway.Conformance.Gov.html#884" class="Field">epoch</a> <a id="4535" class="Symbol">to</a> <a id="4538" class="Field">e&#39;</a><a id="4540" class="Symbol">)</a>

<a id="4543" class="Symbol">{-#</a> <a id="4547" class="Keyword">COMPILE</a> <a id="4555" class="Keyword">GHC</a> <a id="4559" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4228" class="Function">gov-step</a> <a id="4568" class="Pragma">as</a> <a id="4571" class="Pragma">govStep</a> <a id="4579" class="Symbol">#-}</a>
</pre></body></html>