<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Gov</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Gov.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="88" class="Symbol">)</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Ledger.Conway.Foreign.HSLedger.Gov.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Core</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Actions</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Ledger.Conway.Foreign.HSLedger.Cert.html" class="Module">Ledger.Conway.Foreign.HSLedger.Cert</a>

<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="495" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="554" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Ledger.Conway.Conformance.Gov.html" class="Module">Ledger.Conway.Conformance.Gov</a> <a id="609" href="Function.Base.html#4755" class="Function">it</a> <a id="612" href="Function.Base.html#4755" class="Function">it</a>
<a id="615" class="Keyword">import</a> <a id="622" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="654" href="Function.Base.html#4755" class="Function">it</a> <a id="657" class="Symbol">as</a> <a id="L"></a><a id="660" href="Ledger.Conway.Foreign.HSLedger.Gov.html#660" class="Module">L</a>
<a id="662" class="Keyword">open</a> <a id="667" class="Keyword">import</a> <a id="674" href="Ledger.Conway.Specification.Gov.Properties.html" class="Module">Ledger.Conway.Specification.Gov.Properties</a> <a id="717" href="Function.Base.html#4755" class="Function">it</a>

<a id="721" class="Keyword">instance</a>

  <a id="HsTy-GovEnv"></a><a id="733" href="Ledger.Conway.Foreign.HSLedger.Gov.html#733" class="Function">HsTy-GovEnv</a> <a id="745" class="Symbol">=</a> <a id="747" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="758" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="765" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="767" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="783" class="String">&quot;MkGovEnv&quot;</a>
                                  <a id="828" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="830" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="842" class="String">&quot;ge&quot;</a>
  <a id="Conv-GovEnv"></a><a id="849" href="Ledger.Conway.Foreign.HSLedger.Gov.html#849" class="Function">Conv-GovEnv</a> <a id="861" class="Symbol">=</a> <a id="863" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="875" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a>

<a id="883" class="Comment">-- NeedsHash depends on a GovAction, so a little bit of manual work is</a>
<a id="954" class="Comment">-- required to get the types using it into Haskell.</a>

<a id="1007" class="Comment">-- First we define to/fromNeedsHash that replaces the ⊤ cases by a</a>
<a id="1074" class="Comment">-- dummy GovActionID.</a>

<a id="toNeedsHash"></a><a id="1097" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1109" class="Symbol">:</a> <a id="1111" class="Symbol">∀</a> <a id="1113" class="Symbol">{</a><a id="1114" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1114" class="Bound">action</a><a id="1120" class="Symbol">}</a> <a id="1122" class="Symbol">→</a> <a id="1124" href="Ledger.Conway.Specification.Gov.Actions.html#422" class="Function">GovActionID</a> <a id="1136" class="Symbol">→</a> <a id="1138" href="Ledger.Conway.Specification.Gov.Actions.html#1657" class="Function">NeedsHash</a> <a id="1148" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1114" class="Bound">action</a>
<a id="1155" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1167" class="Symbol">{</a><a id="1168" href="Ledger.Conway.Specification.Gov.Actions.html#738" class="InductiveConstructor">NoConfidence</a><a id="1180" class="Symbol">}</a>     <a id="1186" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1186" class="Bound">x</a> <a id="1188" class="Symbol">=</a> <a id="1190" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1186" class="Bound">x</a>
<a id="1192" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1204" class="Symbol">{</a><a id="1205" href="Ledger.Conway.Specification.Gov.Actions.html#773" class="InductiveConstructor">UpdateCommittee</a><a id="1220" class="Symbol">}</a>  <a id="1223" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1223" class="Bound">x</a> <a id="1225" class="Symbol">=</a> <a id="1227" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1223" class="Bound">x</a>
<a id="1229" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1241" class="Symbol">{</a><a id="1242" href="Ledger.Conway.Specification.Gov.Actions.html#808" class="InductiveConstructor">NewConstitution</a><a id="1257" class="Symbol">}</a>  <a id="1260" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1260" class="Bound">x</a> <a id="1262" class="Symbol">=</a> <a id="1264" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1260" class="Bound">x</a>
<a id="1266" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1278" class="Symbol">{</a><a id="1279" href="Ledger.Conway.Specification.Gov.Actions.html#843" class="InductiveConstructor">TriggerHF</a><a id="1288" class="Symbol">}</a>        <a id="1297" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1297" class="Bound">x</a> <a id="1299" class="Symbol">=</a> <a id="1301" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1297" class="Bound">x</a>
<a id="1303" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1315" class="Symbol">{</a><a id="1316" href="Ledger.Conway.Specification.Gov.Actions.html#878" class="InductiveConstructor">ChangePParams</a><a id="1329" class="Symbol">}</a>    <a id="1334" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1334" class="Bound">x</a> <a id="1336" class="Symbol">=</a> <a id="1338" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1334" class="Bound">x</a>
<a id="1340" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1352" class="Symbol">{</a><a id="1353" href="Ledger.Conway.Specification.Gov.Actions.html#913" class="InductiveConstructor">TreasuryWdrl</a><a id="1365" class="Symbol">}</a>     <a id="1371" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1371" class="Bound">x</a> <a id="1373" class="Symbol">=</a> <a id="1375" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="1378" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1390" class="Symbol">{</a><a id="1391" href="Ledger.Conway.Specification.Gov.Actions.html#948" class="InductiveConstructor">Info</a><a id="1395" class="Symbol">}</a>             <a id="1409" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1409" class="Bound">x</a> <a id="1411" class="Symbol">=</a> <a id="1413" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

<a id="fromNeedsHash"></a><a id="1417" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="1431" class="Symbol">:</a> <a id="1433" class="Symbol">∀</a> <a id="1435" class="Symbol">{</a><a id="1436" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1436" class="Bound">action</a><a id="1442" class="Symbol">}</a> <a id="1444" class="Symbol">→</a> <a id="1446" href="Ledger.Conway.Specification.Gov.Actions.html#1657" class="Function">NeedsHash</a> <a id="1456" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1436" class="Bound">action</a> <a id="1463" class="Symbol">→</a> <a id="1465" href="Ledger.Conway.Specification.Gov.Actions.html#422" class="Function">GovActionID</a>
<a id="1477" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="1491" class="Symbol">{</a><a id="1492" href="Ledger.Conway.Specification.Gov.Actions.html#738" class="InductiveConstructor">NoConfidence</a><a id="1504" class="Symbol">}</a>     <a id="1510" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1510" class="Bound">x</a> <a id="1512" class="Symbol">=</a> <a id="1514" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1510" class="Bound">x</a>
<a id="1516" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="1530" class="Symbol">{</a><a id="1531" href="Ledger.Conway.Specification.Gov.Actions.html#773" class="InductiveConstructor">UpdateCommittee</a><a id="1546" class="Symbol">}</a>  <a id="1549" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1549" class="Bound">x</a> <a id="1551" class="Symbol">=</a> <a id="1553" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1549" class="Bound">x</a>
<a id="1555" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="1569" class="Symbol">{</a><a id="1570" href="Ledger.Conway.Specification.Gov.Actions.html#808" class="InductiveConstructor">NewConstitution</a><a id="1585" class="Symbol">}</a>  <a id="1588" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1588" class="Bound">x</a> <a id="1590" class="Symbol">=</a> <a id="1592" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1588" class="Bound">x</a>
<a id="1594" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="1608" class="Symbol">{</a><a id="1609" href="Ledger.Conway.Specification.Gov.Actions.html#843" class="InductiveConstructor">TriggerHF</a><a id="1618" class="Symbol">}</a>        <a id="1627" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1627" class="Bound">x</a> <a id="1629" class="Symbol">=</a> <a id="1631" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1627" class="Bound">x</a>
<a id="1633" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="1647" class="Symbol">{</a><a id="1648" href="Ledger.Conway.Specification.Gov.Actions.html#878" class="InductiveConstructor">ChangePParams</a><a id="1661" class="Symbol">}</a>    <a id="1666" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1666" class="Bound">x</a> <a id="1668" class="Symbol">=</a> <a id="1670" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1666" class="Bound">x</a>
<a id="1672" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="1686" class="Symbol">{</a><a id="1687" href="Ledger.Conway.Specification.Gov.Actions.html#913" class="InductiveConstructor">TreasuryWdrl</a><a id="1699" class="Symbol">}</a>     <a id="1705" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1705" class="Bound">x</a> <a id="1707" class="Symbol">=</a> <a id="1709" class="Number">0</a> <a id="1711" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1713" class="Number">0</a>
<a id="1715" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="1729" class="Symbol">{</a><a id="1730" href="Ledger.Conway.Specification.Gov.Actions.html#948" class="InductiveConstructor">Info</a><a id="1734" class="Symbol">}</a>             <a id="1748" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1748" class="Bound">x</a> <a id="1750" class="Symbol">=</a> <a id="1752" class="Number">0</a> <a id="1754" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1756" class="Number">0</a>

<a id="1759" class="Comment">-- Then we define non-dependent versions of the types that use</a>
<a id="1822" class="Comment">-- NeedsHash.</a>

<a id="1837" class="Keyword">record</a> <a id="GovProposal&#39;"></a><a id="1844" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1844" class="Record">GovProposal&#39;</a> <a id="1857" class="Symbol">:</a> <a id="1859" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1864" class="Keyword">where</a>
  <a id="1872" class="Keyword">field</a>
    <a id="GovProposal&#39;.action"></a><a id="1882" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1882" class="Field">action</a>      <a id="1894" class="Symbol">:</a> <a id="1896" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovProposal&#39;.prevAction"></a><a id="1911" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1911" class="Field">prevAction</a>  <a id="1923" class="Symbol">:</a> <a id="1925" href="Ledger.Conway.Specification.Gov.Actions.html#422" class="Function">GovActionID</a>       <a id="1943" class="Comment">-- NeedsHash action</a>
    <a id="GovProposal&#39;.policy"></a><a id="1967" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1967" class="Field">policy</a>      <a id="1979" class="Symbol">:</a> <a id="1981" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1987" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
    <a id="GovProposal&#39;.deposit"></a><a id="2002" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2002" class="Field">deposit</a>     <a id="2014" class="Symbol">:</a> <a id="2016" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="GovProposal&#39;.returnAddr"></a><a id="2025" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2025" class="Field">returnAddr</a>  <a id="2037" class="Symbol">:</a> <a id="2039" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
    <a id="GovProposal&#39;.anchor"></a><a id="2051" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2051" class="Field">anchor</a>      <a id="2063" class="Symbol">:</a> <a id="2065" href="Ledger.Conway.Specification.Gov.Actions.html#636" class="Record">Anchor</a>

<a id="2073" class="Keyword">record</a> <a id="GovActionState&#39;"></a><a id="2080" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2080" class="Record">GovActionState&#39;</a> <a id="2096" class="Symbol">:</a> <a id="2098" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2103" class="Keyword">where</a>
  <a id="2111" class="Keyword">field</a>
    <a id="GovActionState&#39;.votes"></a><a id="2121" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2121" class="Field">votes</a>       <a id="2133" class="Symbol">:</a> <a id="2135" href="Ledger.Conway.Specification.Gov.Actions.html#386" class="Function">Voter</a> <a id="2141" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2143" href="Ledger.Conway.Specification.Gov.Actions.html#2322" class="Datatype">Vote</a>
    <a id="GovActionState&#39;.returnAddr"></a><a id="2152" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2152" class="Field">returnAddr</a>  <a id="2164" class="Symbol">:</a> <a id="2166" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
    <a id="GovActionState&#39;.expiresIn"></a><a id="2178" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2178" class="Field">expiresIn</a>   <a id="2190" class="Symbol">:</a> <a id="2192" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
    <a id="GovActionState&#39;.action"></a><a id="2202" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2202" class="Field">action</a>      <a id="2214" class="Symbol">:</a> <a id="2216" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovActionState&#39;.prevAction"></a><a id="2231" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2231" class="Field">prevAction</a>  <a id="2243" class="Symbol">:</a> <a id="2245" href="Ledger.Conway.Specification.Gov.Actions.html#422" class="Function">GovActionID</a>       <a id="2263" class="Comment">-- NeedsHash action</a>

<a id="2284" class="Comment">-- We can convert between the dependent and non-dependent versions</a>
<a id="2351" class="Comment">-- using to/fromNeedsHash.</a>

<a id="2379" class="Keyword">private</a>
  <a id="mkGovProposal&#39;"></a><a id="2389" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2389" class="Function">mkGovProposal&#39;</a> <a id="2404" class="Symbol">:</a> <a id="2406" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2418" href="Ledger.Conway.Specification.Gov.Actions.html#2518" class="Record">GovProposal</a> <a id="2430" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1844" class="Record">GovProposal&#39;</a>
  <a id="2445" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2389" class="Function">mkGovProposal&#39;</a> <a id="2460" class="Symbol">=</a> <a id="2462" class="Symbol">λ</a> <a id="2464" class="Keyword">where</a>
    <a id="2474" class="Symbol">.</a><a id="2475" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2480" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2480" class="Bound">p</a> <a id="2482" class="Symbol">→</a> <a id="2484" class="Keyword">let</a> <a id="2488" class="Keyword">module</a> <a id="p"></a><a id="2495" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2495" class="Module">p</a> <a id="2497" class="Symbol">=</a> <a id="2499" href="Ledger.Conway.Specification.Gov.Actions.html#2518" class="Module">GovProposal</a>  <a id="2512" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2480" class="Bound">p</a> <a id="2514" class="Keyword">in</a> <a id="2517" class="Keyword">record</a> <a id="2524" class="Symbol">{</a> <a id="2526" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2495" class="Module">p</a><a id="2527" class="Symbol">;</a> <a id="2529" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1882" class="Field">action</a> <a id="2536" class="Symbol">=</a> <a id="2538" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2541" href="Ledger.Conway.Specification.Gov.Actions.html#2555" class="Field">p.action</a>  <a id="2551" class="Symbol">;</a> <a id="2553" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1911" class="Field">prevAction</a> <a id="2564" class="Symbol">=</a> <a id="2566" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="2580" href="Ledger.Conway.Specification.Gov.Actions.html#2583" class="Field">p.prevAction</a> <a id="2593" class="Symbol">}</a>
    <a id="2599" class="Symbol">.</a><a id="2600" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2605" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2605" class="Bound">p</a> <a id="2607" class="Symbol">→</a> <a id="2609" class="Keyword">let</a> <a id="2613" class="Keyword">module</a> <a id="p"></a><a id="2620" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2620" class="Module">p</a> <a id="2622" class="Symbol">=</a> <a id="2624" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1844" class="Module">GovProposal&#39;</a> <a id="2637" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2605" class="Bound">p</a> <a id="2639" class="Keyword">in</a> <a id="2642" class="Keyword">record</a> <a id="2649" class="Symbol">{</a> <a id="2651" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2620" class="Module">p</a><a id="2652" class="Symbol">;</a> <a id="2654" href="Ledger.Conway.Specification.Gov.Actions.html#2555" class="Field">action</a> <a id="2661" class="Symbol">=</a> <a id="2663" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2668" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1882" class="Field">p.action</a><a id="2676" class="Symbol">;</a> <a id="2678" href="Ledger.Conway.Specification.Gov.Actions.html#2583" class="Field">prevAction</a> <a id="2689" class="Symbol">=</a> <a id="2691" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a>   <a id="2705" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1911" class="Field">p.prevAction</a> <a id="2718" class="Symbol">}</a>

  <a id="mkGovActionState&#39;"></a><a id="2723" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2723" class="Function">mkGovActionState&#39;</a> <a id="2741" class="Symbol">:</a> <a id="2743" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2755" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Record">GovActionState</a> <a id="2770" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2080" class="Record">GovActionState&#39;</a>
  <a id="2788" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2723" class="Function">mkGovActionState&#39;</a> <a id="2806" class="Symbol">=</a> <a id="2808" class="Symbol">λ</a> <a id="2810" class="Keyword">where</a>
    <a id="2820" class="Symbol">.</a><a id="2821" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2826" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2826" class="Bound">s</a> <a id="2828" class="Symbol">→</a> <a id="2830" class="Keyword">let</a> <a id="2834" class="Keyword">module</a> <a id="s"></a><a id="2841" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2841" class="Module">s</a> <a id="2843" class="Symbol">=</a> <a id="2845" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Module">GovActionState</a>  <a id="2861" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2826" class="Bound">s</a> <a id="2863" class="Keyword">in</a> <a id="2866" class="Keyword">record</a><a id="2872" class="Symbol">{</a> <a id="2874" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2841" class="Module">s</a><a id="2875" class="Symbol">;</a> <a id="2877" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2202" class="Field">action</a> <a id="2884" class="Symbol">=</a> <a id="2886" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2889" href="Ledger.Conway.Specification.Gov.Actions.html#2861" class="Field">s.action</a>  <a id="2899" class="Symbol">;</a> <a id="2901" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2231" class="Field">prevAction</a> <a id="2912" class="Symbol">=</a> <a id="2914" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1417" class="Function">fromNeedsHash</a> <a id="2928" href="Ledger.Conway.Specification.Gov.Actions.html#2889" class="Field">s.prevAction</a> <a id="2941" class="Symbol">}</a>
    <a id="2947" class="Symbol">.</a><a id="2948" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2953" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2953" class="Bound">s</a> <a id="2955" class="Symbol">→</a> <a id="2957" class="Keyword">let</a> <a id="2961" class="Keyword">module</a> <a id="s"></a><a id="2968" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2968" class="Module">s</a> <a id="2970" class="Symbol">=</a> <a id="2972" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2080" class="Module">GovActionState&#39;</a> <a id="2988" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2953" class="Bound">s</a> <a id="2990" class="Keyword">in</a> <a id="2993" class="Keyword">record</a><a id="2999" class="Symbol">{</a> <a id="3001" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2968" class="Module">s</a><a id="3002" class="Symbol">;</a> <a id="3004" href="Ledger.Conway.Specification.Gov.Actions.html#2861" class="Field">action</a> <a id="3011" class="Symbol">=</a> <a id="3013" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3018" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2202" class="Field">s.action</a><a id="3026" class="Symbol">;</a> <a id="3028" href="Ledger.Conway.Specification.Gov.Actions.html#2889" class="Field">prevAction</a> <a id="3039" class="Symbol">=</a> <a id="3041" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a>   <a id="3055" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2231" class="Field">s.prevAction</a> <a id="3068" class="Symbol">}</a>

<a id="3071" class="Comment">-- Auto-generated conversions for the non-dependent types</a>

<a id="3130" class="Keyword">instance</a>
  <a id="HsTy-GovProposal&#39;"></a><a id="3141" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3141" class="Function">HsTy-GovProposal&#39;</a> <a id="3159" class="Symbol">=</a> <a id="3161" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3172" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1844" class="Record">GovProposal&#39;</a> <a id="3185" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3187" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3196" class="String">&quot;GovProposal&quot;</a>
                                              <a id="3256" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3258" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3274" class="String">&quot;MkGovProposal&quot;</a>
                                              <a id="3336" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3338" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3350" class="String">&quot;gp&quot;</a>
  <a id="Conv-GovProposal&#39;"></a><a id="3357" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3357" class="Function">Conv-GovProposal&#39;</a> <a id="3375" class="Symbol">=</a> <a id="3377" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3389" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1844" class="Record">GovProposal&#39;</a>

  <a id="HsTy-GovActionState&#39;"></a><a id="3405" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3405" class="Function">HsTy-GovActionState&#39;</a> <a id="3426" class="Symbol">=</a> <a id="3428" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3439" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2080" class="Record">GovActionState&#39;</a> <a id="3455" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3457" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3466" class="String">&quot;GovActionState&quot;</a>
                                                    <a id="3535" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3537" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3553" class="String">&quot;MkGovActionState&quot;</a>
                                                    <a id="3624" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3626" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3638" class="String">&quot;gas&quot;</a>
  <a id="Conv-GovActionState&#39;"></a><a id="3646" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3646" class="Function">Conv-GovActionState&#39;</a> <a id="3667" class="Symbol">=</a> <a id="3669" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3681" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2080" class="Record">GovActionState&#39;</a>

<a id="3698" class="Comment">-- And finally we compose everything into conversions for the dependent types</a>

<a id="3777" class="Keyword">instance</a>
  <a id="HsTy-GovProposal"></a><a id="3788" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3788" class="Function">HsTy-GovProposal</a> <a id="3805" class="Symbol">=</a> <a id="3807" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3816" href="Ledger.Conway.Specification.Gov.Actions.html#2518" class="Record">GovProposal</a> <a id="3828" class="Symbol">(</a><a id="3829" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3836" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1844" class="Record">GovProposal&#39;</a><a id="3848" class="Symbol">)</a>
  <a id="Conv-GovProposal"></a><a id="3852" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3852" class="Function">Conv-GovProposal</a> <a id="3869" class="Symbol">=</a> <a id="3871" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2389" class="Function">mkGovProposal&#39;</a> <a id="3886" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="3888" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3357" class="Function">Conv-GovProposal&#39;</a>

  <a id="HsTy-GovActionState"></a><a id="3909" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3909" class="Function">HsTy-GovActionState</a> <a id="3929" class="Symbol">=</a> <a id="3931" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3940" href="Ledger.Conway.Specification.Gov.Actions.html#2740" class="Record">GovActionState</a> <a id="3955" class="Symbol">(</a><a id="3956" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3963" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2080" class="Record">GovActionState&#39;</a><a id="3978" class="Symbol">)</a>
  <a id="Conv-GovActionState"></a><a id="3982" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3982" class="Function">Conv-GovActionState</a> <a id="4002" class="Symbol">=</a> <a id="4004" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2723" class="Function">mkGovActionState&#39;</a> <a id="4022" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="4024" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3646" class="Function">Conv-GovActionState&#39;</a>

<a id="4046" class="Keyword">unquoteDecl</a> <a id="4058" class="Symbol">=</a> <a id="4060" class="Keyword">do</a>
  hsTypeAlias GovActionID
  hsTypeAlias GovState
  hsTypeAlias Voter

<a id="4133" class="Comment">-- Computational function</a>

<a id="gov-step"></a><a id="4160" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4160" class="Function">gov-step</a> <a id="4169" class="Symbol">:</a> <a id="4171" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4178" class="Symbol">(</a><a id="4179" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="4186" class="Symbol">→</a> <a id="4188" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="4197" class="Symbol">→</a> <a id="4199" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4204" class="Symbol">(</a><a id="4205" href="Ledger.Conway.Specification.Gov.Actions.html#2373" class="Record">GovVote</a> <a id="4213" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4215" href="Ledger.Conway.Specification.Gov.Actions.html#2518" class="Record">GovProposal</a><a id="4226" class="Symbol">)</a> <a id="4228" class="Symbol">→</a> <a id="4230" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="4248" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4255" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a><a id="4263" class="Symbol">)</a>
<a id="4265" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4160" class="Function">gov-step</a> <a id="4274" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4274" class="Bound">Γ</a> <a id="4276" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4276" class="Bound">govSt</a> <a id="4282" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4282" class="Bound">gvps</a> <a id="4287" class="Symbol">=</a> <a id="4289" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="4292" class="Symbol">(</a><a id="4293" href="Interface.ComputationalRelation.html#2976" class="Function">compute</a> <a id="4301" href="Ledger.Conway.Specification.Gov.Properties.html#7574" class="Function">Computational-GOVS</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Gov.html#861}{\htmlId{4322}{\htmlClass{Function}{\text{txid}}}}\, \\ \,\href{Ledger.Conway.Foreign.HSLedger.Gov.html#4470}{\htmlId{4329}{\htmlClass{Function}{\text{e&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#908}{\htmlId{4334}{\htmlClass{Function}{\text{pparams}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#934}{\htmlId{4344}{\htmlClass{Function}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#969}{\htmlId{4354}{\htmlClass{Function}{\text{enactState}}}}\, \\ \,\href{Foreign.Convertible.html#149}{\htmlId{4367}{\htmlClass{Field}{\text{to}}}}\, \,\href{Ledger.Conway.Conformance.Gov.html#998}{\htmlId{4370}{\htmlClass{Function}{\text{certState}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#1026}{\htmlId{4382}{\htmlClass{Function}{\text{rewardCreds}}}}\, \end{pmatrix}$</a> <a id="4396" class="Symbol">(</a><a id="4397" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4402" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4276" class="Bound">govSt</a><a id="4407" class="Symbol">)</a> <a id="4409" class="Symbol">(</a><a id="4410" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4415" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4282" class="Bound">gvps</a><a id="4419" class="Symbol">))</a>
  <a id="4424" class="Keyword">where</a> <a id="4430" class="Keyword">open</a> <a id="4435" href="Ledger.Conway.Conformance.Gov.html#829" class="Module">GovEnv</a> <a id="4442" class="Symbol">(</a><a id="4443" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4448" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4274" class="Bound">Γ</a><a id="4449" class="Symbol">)</a> <a id="4451" class="Keyword">renaming</a> <a id="4460" class="Symbol">(</a><a id="4461" href="Ledger.Conway.Conformance.Gov.html#884" class="Field">epoch</a> <a id="4467" class="Symbol">to</a> <a id="4470" class="Field">e&#39;</a><a id="4472" class="Symbol">)</a>

<a id="4475" class="Symbol">{-#</a> <a id="4479" class="Keyword">COMPILE</a> <a id="4487" class="Keyword">GHC</a> <a id="4491" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4160" class="Function">gov-step</a> <a id="4500" class="Pragma">as</a> <a id="4503" class="Pragma">govStep</a> <a id="4511" class="Symbol">#-}</a>
</pre></body></html>