<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Gov</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Gov.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="88" class="Symbol">)</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Ledger.Conway.Foreign.HSLedger.Gov.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Core</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Actions</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Ledger.Conway.Foreign.HSLedger.Cert.html" class="Module">Ledger.Conway.Foreign.HSLedger.Cert</a>

<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="495" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="554" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Ledger.Conway.Conformance.Gov.html" class="Module">Ledger.Conway.Conformance.Gov</a> <a id="609" href="Function.Base.html#4755" class="Function">it</a> <a id="612" href="Function.Base.html#4755" class="Function">it</a>
<a id="615" class="Keyword">import</a> <a id="622" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="654" href="Function.Base.html#4755" class="Function">it</a> <a id="657" class="Symbol">as</a> <a id="L"></a><a id="660" href="Ledger.Conway.Foreign.HSLedger.Gov.html#660" class="Module">L</a>
<a id="662" class="Keyword">open</a> <a id="667" class="Keyword">import</a> <a id="674" href="Ledger.Conway.Specification.Gov.Properties.html" class="Module">Ledger.Conway.Specification.Gov.Properties</a> <a id="717" href="Function.Base.html#4755" class="Function">it</a>

<a id="721" class="Keyword">instance</a>

  <a id="HsTy-GovEnv"></a><a id="733" href="Ledger.Conway.Foreign.HSLedger.Gov.html#733" class="Function">HsTy-GovEnv</a> <a id="745" class="Symbol">=</a> <a id="747" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="758" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="765" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="767" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="783" class="String">&quot;MkGovEnv&quot;</a>
                                  <a id="828" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="830" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="842" class="String">&quot;ge&quot;</a>
  <a id="Conv-GovEnv"></a><a id="849" href="Ledger.Conway.Foreign.HSLedger.Gov.html#849" class="Function">Conv-GovEnv</a> <a id="861" class="Symbol">=</a> <a id="863" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="875" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a>

<a id="883" class="Comment">-- NeedsHash depends on a GovAction, so a little bit of manual work is</a>
<a id="954" class="Comment">-- required to get the types using it into Haskell.</a>

<a id="1007" class="Comment">-- First we define to/fromNeedsHash that replaces the ⊤ cases by a</a>
<a id="1074" class="Comment">-- dummy GovActionID.</a>

<a id="toNeedsHash"></a><a id="1097" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1109" class="Symbol">:</a> <a id="1111" class="Symbol">∀</a> <a id="1113" class="Symbol">{</a><a id="1114" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1114" class="Bound">action</a><a id="1120" class="Symbol">}</a> <a id="1122" class="Symbol">→</a> <a id="1124" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a> <a id="1136" class="Symbol">→</a> <a id="1138" href="Ledger.Conway.Specification.Gov.Actions.html#2533" class="Function">NeedsHash</a> <a id="1148" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1114" class="Bound">action</a>
<a id="1155" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1167" class="Symbol">{</a><a id="1168" href="Ledger.Conway.Specification.Gov.Actions.html#997" class="InductiveConstructor">NoConfidence</a><a id="1180" class="Symbol">}</a>        <a id="1189" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1189" class="Bound">x</a> <a id="1191" class="Symbol">=</a> <a id="1193" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1189" class="Bound">x</a>
<a id="1195" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1207" class="Symbol">{</a><a id="1208" href="Ledger.Conway.Specification.Gov.Actions.html#1035" class="InductiveConstructor">UpdateCommittee</a><a id="1223" class="Symbol">}</a>     <a id="1229" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1229" class="Bound">x</a> <a id="1231" class="Symbol">=</a> <a id="1233" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1229" class="Bound">x</a>
<a id="1235" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1247" class="Symbol">{</a><a id="1248" href="Ledger.Conway.Specification.Gov.Actions.html#1073" class="InductiveConstructor">NewConstitution</a><a id="1263" class="Symbol">}</a>     <a id="1269" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1269" class="Bound">x</a> <a id="1271" class="Symbol">=</a> <a id="1273" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1269" class="Bound">x</a>
<a id="1275" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1287" class="Symbol">{</a><a id="1288" href="Ledger.Conway.Specification.Gov.Actions.html#1111" class="InductiveConstructor">TriggerHardFork</a><a id="1303" class="Symbol">}</a>     <a id="1309" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1309" class="Bound">x</a> <a id="1311" class="Symbol">=</a> <a id="1313" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1309" class="Bound">x</a>
<a id="1315" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1327" class="Symbol">{</a><a id="1328" href="Ledger.Conway.Specification.Gov.Actions.html#1149" class="InductiveConstructor">ChangePParams</a><a id="1341" class="Symbol">}</a>       <a id="1349" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1349" class="Bound">x</a> <a id="1351" class="Symbol">=</a> <a id="1353" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1349" class="Bound">x</a>
<a id="1355" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1367" class="Symbol">{</a><a id="1368" href="Ledger.Conway.Specification.Gov.Actions.html#1187" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1386" class="Symbol">}</a>  <a id="1389" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1389" class="Bound">x</a> <a id="1391" class="Symbol">=</a> <a id="1393" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="1396" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1408" class="Symbol">{</a><a id="1409" href="Ledger.Conway.Specification.Gov.Actions.html#1225" class="InductiveConstructor">Info</a><a id="1413" class="Symbol">}</a>                <a id="1430" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1430" class="Bound">x</a> <a id="1432" class="Symbol">=</a> <a id="1434" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

<a id="fromNeedsHash"></a><a id="1438" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1452" class="Symbol">:</a> <a id="1454" class="Symbol">∀</a> <a id="1456" class="Symbol">{</a><a id="1457" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1457" class="Bound">action</a><a id="1463" class="Symbol">}</a> <a id="1465" class="Symbol">→</a> <a id="1467" href="Ledger.Conway.Specification.Gov.Actions.html#2533" class="Function">NeedsHash</a> <a id="1477" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1457" class="Bound">action</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a>
<a id="1498" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1512" class="Symbol">{</a><a id="1513" href="Ledger.Conway.Specification.Gov.Actions.html#997" class="InductiveConstructor">NoConfidence</a><a id="1525" class="Symbol">}</a>        <a id="1534" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1534" class="Bound">x</a> <a id="1536" class="Symbol">=</a> <a id="1538" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1534" class="Bound">x</a>
<a id="1540" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1554" class="Symbol">{</a><a id="1555" href="Ledger.Conway.Specification.Gov.Actions.html#1035" class="InductiveConstructor">UpdateCommittee</a><a id="1570" class="Symbol">}</a>     <a id="1576" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1576" class="Bound">x</a> <a id="1578" class="Symbol">=</a> <a id="1580" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1576" class="Bound">x</a>
<a id="1582" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1596" class="Symbol">{</a><a id="1597" href="Ledger.Conway.Specification.Gov.Actions.html#1073" class="InductiveConstructor">NewConstitution</a><a id="1612" class="Symbol">}</a>     <a id="1618" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1618" class="Bound">x</a> <a id="1620" class="Symbol">=</a> <a id="1622" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1618" class="Bound">x</a>
<a id="1624" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1638" class="Symbol">{</a><a id="1639" href="Ledger.Conway.Specification.Gov.Actions.html#1111" class="InductiveConstructor">TriggerHardFork</a><a id="1654" class="Symbol">}</a>     <a id="1660" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1660" class="Bound">x</a> <a id="1662" class="Symbol">=</a> <a id="1664" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1660" class="Bound">x</a>
<a id="1666" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1680" class="Symbol">{</a><a id="1681" href="Ledger.Conway.Specification.Gov.Actions.html#1149" class="InductiveConstructor">ChangePParams</a><a id="1694" class="Symbol">}</a>       <a id="1702" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1702" class="Bound">x</a> <a id="1704" class="Symbol">=</a> <a id="1706" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1702" class="Bound">x</a>
<a id="1708" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1722" class="Symbol">{</a><a id="1723" href="Ledger.Conway.Specification.Gov.Actions.html#1187" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1741" class="Symbol">}</a>  <a id="1744" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1744" class="Bound">x</a> <a id="1746" class="Symbol">=</a> <a id="1748" class="Number">0</a> <a id="1750" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1752" class="Number">0</a>
<a id="1754" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1768" class="Symbol">{</a><a id="1769" href="Ledger.Conway.Specification.Gov.Actions.html#1225" class="InductiveConstructor">Info</a><a id="1773" class="Symbol">}</a>                <a id="1790" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1790" class="Bound">x</a> <a id="1792" class="Symbol">=</a> <a id="1794" class="Number">0</a> <a id="1796" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1798" class="Number">0</a>

<a id="1801" class="Comment">-- Then we define non-dependent versions of the types that use</a>
<a id="1864" class="Comment">-- NeedsHash.</a>

<a id="1879" class="Keyword">record</a> <a id="GovProposal&#39;"></a><a id="1886" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a> <a id="1899" class="Symbol">:</a> <a id="1901" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1906" class="Keyword">where</a>
  <a id="1914" class="Keyword">field</a>
    <a id="GovProposal&#39;.action"></a><a id="1924" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1924" class="Field">action</a>      <a id="1936" class="Symbol">:</a> <a id="1938" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovProposal&#39;.prevAction"></a><a id="1953" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1953" class="Field">prevAction</a>  <a id="1965" class="Symbol">:</a> <a id="1967" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a>       <a id="1985" class="Comment">-- NeedsHash action</a>
    <a id="GovProposal&#39;.policy"></a><a id="2009" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2009" class="Field">policy</a>      <a id="2021" class="Symbol">:</a> <a id="2023" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2029" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
    <a id="GovProposal&#39;.deposit"></a><a id="2044" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2044" class="Field">deposit</a>     <a id="2056" class="Symbol">:</a> <a id="2058" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="GovProposal&#39;.returnAddr"></a><a id="2067" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2067" class="Field">returnAddr</a>  <a id="2079" class="Symbol">:</a> <a id="2081" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
    <a id="GovProposal&#39;.anchor"></a><a id="2093" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2093" class="Field">anchor</a>      <a id="2105" class="Symbol">:</a> <a id="2107" href="Ledger.Conway.Specification.Gov.Actions.html#895" class="Record">Anchor</a>

<a id="2115" class="Keyword">record</a> <a id="GovActionState&#39;"></a><a id="2122" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a> <a id="2138" class="Symbol">:</a> <a id="2140" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2145" class="Keyword">where</a>
  <a id="2153" class="Keyword">field</a>
    <a id="GovActionState&#39;.votes"></a><a id="2163" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2163" class="Field">votes</a>       <a id="2175" class="Symbol">:</a> <a id="2177" href="Ledger.Conway.Specification.Gov.Actions.html#3640" class="Record">GovVotes</a>
    <a id="GovActionState&#39;.returnAddr"></a><a id="2190" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2190" class="Field">returnAddr</a>  <a id="2202" class="Symbol">:</a> <a id="2204" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
    <a id="GovActionState&#39;.expiresIn"></a><a id="2216" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2216" class="Field">expiresIn</a>   <a id="2228" class="Symbol">:</a> <a id="2230" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
    <a id="GovActionState&#39;.action"></a><a id="2240" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2240" class="Field">action</a>      <a id="2252" class="Symbol">:</a> <a id="2254" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovActionState&#39;.prevAction"></a><a id="2269" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2269" class="Field">prevAction</a>  <a id="2281" class="Symbol">:</a> <a id="2283" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a>       <a id="2301" class="Comment">-- NeedsHash action</a>

<a id="2322" class="Comment">-- We can convert between the dependent and non-dependent versions</a>
<a id="2389" class="Comment">-- using to/fromNeedsHash.</a>

<a id="2417" class="Keyword">private</a>
  <a id="mkGovProposal&#39;"></a><a id="2427" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2427" class="Function">mkGovProposal&#39;</a> <a id="2442" class="Symbol">:</a> <a id="2444" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2456" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Record">GovProposal</a> <a id="2468" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a>
  <a id="2483" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2427" class="Function">mkGovProposal&#39;</a> <a id="2498" class="Symbol">=</a> <a id="2500" class="Symbol">λ</a> <a id="2502" class="Keyword">where</a>
    <a id="2512" class="Symbol">.</a><a id="2513" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2518" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2518" class="Bound">p</a> <a id="2520" class="Symbol">→</a> <a id="2522" class="Keyword">let</a> <a id="2526" class="Keyword">module</a> <a id="p"></a><a id="2533" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2533" class="Module">p</a> <a id="2535" class="Symbol">=</a> <a id="2537" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Module">GovProposal</a>  <a id="2550" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2518" class="Bound">p</a> <a id="2552" class="Keyword">in</a> <a id="2555" class="Keyword">record</a> <a id="2562" class="Symbol">{</a> <a id="2564" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2533" class="Module">p</a><a id="2565" class="Symbol">;</a> <a id="2567" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1924" class="Field">action</a> <a id="2574" class="Symbol">=</a> <a id="2576" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2579" href="Ledger.Conway.Specification.Gov.Actions.html#3455" class="Field">p.action</a>  <a id="2589" class="Symbol">;</a> <a id="2591" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1953" class="Field">prevAction</a> <a id="2602" class="Symbol">=</a> <a id="2604" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="2618" href="Ledger.Conway.Specification.Gov.Actions.html#3483" class="Field">p.prevAction</a> <a id="2631" class="Symbol">}</a>
    <a id="2637" class="Symbol">.</a><a id="2638" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2643" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2643" class="Bound">p</a> <a id="2645" class="Symbol">→</a> <a id="2647" class="Keyword">let</a> <a id="2651" class="Keyword">module</a> <a id="p"></a><a id="2658" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2658" class="Module">p</a> <a id="2660" class="Symbol">=</a> <a id="2662" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Module">GovProposal&#39;</a> <a id="2675" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2643" class="Bound">p</a> <a id="2677" class="Keyword">in</a> <a id="2680" class="Keyword">record</a> <a id="2687" class="Symbol">{</a> <a id="2689" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2658" class="Module">p</a><a id="2690" class="Symbol">;</a> <a id="2692" href="Ledger.Conway.Specification.Gov.Actions.html#3455" class="Field">action</a> <a id="2699" class="Symbol">=</a> <a id="2701" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2706" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1924" class="Field">p.action</a><a id="2714" class="Symbol">;</a> <a id="2716" href="Ledger.Conway.Specification.Gov.Actions.html#3483" class="Field">prevAction</a> <a id="2727" class="Symbol">=</a> <a id="2729" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a>   <a id="2743" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1953" class="Field">p.prevAction</a> <a id="2756" class="Symbol">}</a>

  <a id="mkGovActionState&#39;"></a><a id="2761" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2761" class="Function">mkGovActionState&#39;</a> <a id="2779" class="Symbol">:</a> <a id="2781" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2793" href="Ledger.Conway.Specification.Gov.Actions.html#3768" class="Record">GovActionState</a> <a id="2808" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a>
  <a id="2826" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2761" class="Function">mkGovActionState&#39;</a> <a id="2844" class="Symbol">=</a> <a id="2846" class="Symbol">λ</a> <a id="2848" class="Keyword">where</a>
    <a id="2858" class="Symbol">.</a><a id="2859" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2864" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2864" class="Bound">s</a> <a id="2866" class="Symbol">→</a> <a id="2868" class="Keyword">let</a> <a id="2872" class="Keyword">module</a> <a id="s"></a><a id="2879" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2879" class="Module">s</a> <a id="2881" class="Symbol">=</a> <a id="2883" href="Ledger.Conway.Specification.Gov.Actions.html#3768" class="Module">GovActionState</a>  <a id="2899" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2864" class="Bound">s</a> <a id="2901" class="Keyword">in</a> <a id="2904" class="Keyword">record</a><a id="2910" class="Symbol">{</a> <a id="2912" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2879" class="Module">s</a><a id="2913" class="Symbol">;</a> <a id="2915" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2240" class="Field">action</a> <a id="2922" class="Symbol">=</a> <a id="2924" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2927" href="Ledger.Conway.Specification.Gov.Actions.html#3885" class="Field">s.action</a>  <a id="2937" class="Symbol">;</a> <a id="2939" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2269" class="Field">prevAction</a> <a id="2950" class="Symbol">=</a> <a id="2952" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="2966" href="Ledger.Conway.Specification.Gov.Actions.html#3913" class="Field">s.prevAction</a> <a id="2979" class="Symbol">}</a>
    <a id="2985" class="Symbol">.</a><a id="2986" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2991" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2991" class="Bound">s</a> <a id="2993" class="Symbol">→</a> <a id="2995" class="Keyword">let</a> <a id="2999" class="Keyword">module</a> <a id="s"></a><a id="3006" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3006" class="Module">s</a> <a id="3008" class="Symbol">=</a> <a id="3010" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Module">GovActionState&#39;</a> <a id="3026" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2991" class="Bound">s</a> <a id="3028" class="Keyword">in</a> <a id="3031" class="Keyword">record</a><a id="3037" class="Symbol">{</a> <a id="3039" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3006" class="Module">s</a><a id="3040" class="Symbol">;</a> <a id="3042" href="Ledger.Conway.Specification.Gov.Actions.html#3885" class="Field">action</a> <a id="3049" class="Symbol">=</a> <a id="3051" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3056" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2240" class="Field">s.action</a><a id="3064" class="Symbol">;</a> <a id="3066" href="Ledger.Conway.Specification.Gov.Actions.html#3913" class="Field">prevAction</a> <a id="3077" class="Symbol">=</a> <a id="3079" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a>   <a id="3093" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2269" class="Field">s.prevAction</a> <a id="3106" class="Symbol">}</a>

<a id="3109" class="Comment">-- Auto-generated conversions for the non-dependent types</a>

<a id="3168" class="Keyword">instance</a>
  <a id="HsTy-GovProposal&#39;"></a><a id="3179" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3179" class="Function">HsTy-GovProposal&#39;</a> <a id="3197" class="Symbol">=</a> <a id="3199" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3210" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a> <a id="3223" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3225" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3234" class="String">&quot;GovProposal&quot;</a>
                                              <a id="3294" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3296" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3312" class="String">&quot;MkGovProposal&quot;</a>
                                              <a id="3374" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3376" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3388" class="String">&quot;gp&quot;</a>
  <a id="Conv-GovProposal&#39;"></a><a id="3395" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3395" class="Function">Conv-GovProposal&#39;</a> <a id="3413" class="Symbol">=</a> <a id="3415" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3427" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a>

  <a id="HsTy-GovActionState&#39;"></a><a id="3443" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3443" class="Function">HsTy-GovActionState&#39;</a> <a id="3464" class="Symbol">=</a> <a id="3466" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3477" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a> <a id="3493" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3495" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3504" class="String">&quot;GovActionState&quot;</a>
                                                    <a id="3573" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3575" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3591" class="String">&quot;MkGovActionState&quot;</a>
                                                    <a id="3662" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3664" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3676" class="String">&quot;gas&quot;</a>
  <a id="Conv-GovActionState&#39;"></a><a id="3684" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3684" class="Function">Conv-GovActionState&#39;</a> <a id="3705" class="Symbol">=</a> <a id="3707" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3719" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a>

<a id="3736" class="Comment">-- And finally we compose everything into conversions for the dependent types</a>

<a id="3815" class="Keyword">instance</a>
  <a id="HsTy-GovProposal"></a><a id="3826" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3826" class="Function">HsTy-GovProposal</a> <a id="3843" class="Symbol">=</a> <a id="3845" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3854" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Record">GovProposal</a> <a id="3866" class="Symbol">(</a><a id="3867" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3874" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a><a id="3886" class="Symbol">)</a>
  <a id="Conv-GovProposal"></a><a id="3890" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3890" class="Function">Conv-GovProposal</a> <a id="3907" class="Symbol">=</a> <a id="3909" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2427" class="Function">mkGovProposal&#39;</a> <a id="3924" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="3926" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3395" class="Function">Conv-GovProposal&#39;</a>

  <a id="HsTy-GovActionState"></a><a id="3947" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3947" class="Function">HsTy-GovActionState</a> <a id="3967" class="Symbol">=</a> <a id="3969" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3978" href="Ledger.Conway.Specification.Gov.Actions.html#3768" class="Record">GovActionState</a> <a id="3993" class="Symbol">(</a><a id="3994" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4001" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a><a id="4016" class="Symbol">)</a>
  <a id="Conv-GovActionState"></a><a id="4020" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4020" class="Function">Conv-GovActionState</a> <a id="4040" class="Symbol">=</a> <a id="4042" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2761" class="Function">mkGovActionState&#39;</a> <a id="4060" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="4062" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3684" class="Function">Conv-GovActionState&#39;</a>

<a id="4084" class="Keyword">unquoteDecl</a> <a id="4096" class="Symbol">=</a> <a id="4098" class="Keyword">do</a>
  hsTypeAlias GovActionID
  hsTypeAlias GovState
  hsTypeAlias GovVoter&#39;

<a id="4175" class="Comment">-- Computational function</a>

<a id="gov-step"></a><a id="4202" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4202" class="Function">gov-step</a>
  <a id="4213" class="Symbol">:</a> <a id="4215" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4222" class="Symbol">(</a><a id="4223" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="4230" class="Symbol">→</a> <a id="4232" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="4241" class="Symbol">→</a> <a id="4243" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4248" class="Symbol">(</a><a id="4249" href="Ledger.Conway.Specification.Gov.Actions.html#3270" class="Record">GovVote</a> <a id="4257" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4259" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Record">GovProposal</a><a id="4270" class="Symbol">)</a>
  <a id="4274" class="Symbol">→</a> <a id="4276" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="4294" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4301" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a><a id="4309" class="Symbol">)</a>
<a id="4311" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4202" class="Function">gov-step</a> <a id="4320" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4320" class="Bound">Γ</a> <a id="4322" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4322" class="Bound">govSt</a> <a id="4328" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4328" class="Bound">gvps</a> <a id="4333" class="Symbol">=</a>
    <a id="4339" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="4342" href="Function.Base.html#1993" class="Function Operator">$</a> <a id="4344" href="Interface.ComputationalRelation.html#2976" class="Function">compute</a> <a id="4352" href="Ledger.Conway.Specification.Gov.Properties.html#7708" class="Function">Computational-GOVS</a>
      <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Gov.html#861}{\htmlId{4379}{\htmlClass{Function}{\text{txid}}}}\, \\ \,\href{Ledger.Conway.Foreign.HSLedger.Gov.html#4538}{\htmlId{4386}{\htmlClass{Function}{\text{e&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#908}{\htmlId{4391}{\htmlClass{Function}{\text{pparams}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#934}{\htmlId{4401}{\htmlClass{Function}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#969}{\htmlId{4411}{\htmlClass{Function}{\text{enactState}}}}\, \\ \,\href{Foreign.Convertible.html#149}{\htmlId{4424}{\htmlClass{Field}{\text{to}}}}\, \,\href{Ledger.Conway.Conformance.Gov.html#998}{\htmlId{4427}{\htmlClass{Function}{\text{certState}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#1026}{\htmlId{4439}{\htmlClass{Function}{\text{rewardCreds}}}}\, \end{pmatrix}$</a>
      <a id="4459" class="Symbol">(</a><a id="4460" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4465" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4322" class="Bound">govSt</a><a id="4470" class="Symbol">)</a>
      <a id="4478" class="Symbol">(</a><a id="4479" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4484" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4328" class="Bound">gvps</a><a id="4488" class="Symbol">)</a>
  <a id="4492" class="Keyword">where</a> <a id="4498" class="Keyword">open</a> <a id="4503" href="Ledger.Conway.Conformance.Gov.html#829" class="Module">GovEnv</a> <a id="4510" class="Symbol">(</a><a id="4511" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4516" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4320" class="Bound">Γ</a><a id="4517" class="Symbol">)</a> <a id="4519" class="Keyword">renaming</a> <a id="4528" class="Symbol">(</a><a id="4529" href="Ledger.Conway.Conformance.Gov.html#884" class="Field">epoch</a> <a id="4535" class="Symbol">to</a> <a id="4538" class="Field">e&#39;</a><a id="4540" class="Symbol">)</a>

<a id="4543" class="Symbol">{-#</a> <a id="4547" class="Keyword">COMPILE</a> <a id="4555" class="Keyword">GHC</a> <a id="4559" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4202" class="Function">gov-step</a> <a id="4568" class="Pragma">as</a> <a id="4571" class="Pragma">govStep</a> <a id="4579" class="Symbol">#-}</a>
</pre></body></html>