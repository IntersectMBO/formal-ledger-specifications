<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Gov</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Gov.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="88" class="Symbol">)</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Ledger.Conway.Foreign.HSLedger.Gov.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Core</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Actions</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Ledger.Conway.Foreign.HSLedger.Cert.html" class="Module">Ledger.Conway.Foreign.HSLedger.Cert</a>

<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="495" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="554" href="Ledger.Conway.Specification.Transaction.html#2079" class="Function">govStructure</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Ledger.Conway.Conformance.Gov.html" class="Module">Ledger.Conway.Conformance.Gov</a> <a id="609" href="Function.Base.html#4755" class="Function">it</a> <a id="612" href="Function.Base.html#4755" class="Function">it</a>
<a id="615" class="Keyword">import</a> <a id="622" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="654" href="Function.Base.html#4755" class="Function">it</a> <a id="657" class="Symbol">as</a> <a id="L"></a><a id="660" href="Ledger.Conway.Foreign.HSLedger.Gov.html#660" class="Module">L</a>
<a id="662" class="Keyword">open</a> <a id="667" class="Keyword">import</a> <a id="674" href="Ledger.Conway.Specification.Gov.Properties.html" class="Module">Ledger.Conway.Specification.Gov.Properties</a> <a id="717" href="Function.Base.html#4755" class="Function">it</a>

<a id="721" class="Keyword">instance</a>

  <a id="HsTy-GovEnv"></a><a id="733" href="Ledger.Conway.Foreign.HSLedger.Gov.html#733" class="Function">HsTy-GovEnv</a> <a id="745" class="Symbol">=</a> <a id="747" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="758" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="765" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="767" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="783" class="String">&quot;MkGovEnv&quot;</a>
                                  <a id="828" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="830" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="842" class="String">&quot;ge&quot;</a>
  <a id="Conv-GovEnv"></a><a id="849" href="Ledger.Conway.Foreign.HSLedger.Gov.html#849" class="Function">Conv-GovEnv</a> <a id="861" class="Symbol">=</a> <a id="863" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="875" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a>

<a id="883" class="Comment">-- NeedsHash depends on a GovAction, so a little bit of manual work is</a>
<a id="954" class="Comment">-- required to get the types using it into Haskell.</a>

<a id="1007" class="Comment">-- First we define to/fromNeedsHash that replaces the ⊤ cases by a</a>
<a id="1074" class="Comment">-- dummy GovActionID.</a>

<a id="toNeedsHash"></a><a id="1097" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1109" class="Symbol">:</a> <a id="1111" class="Symbol">∀</a> <a id="1113" class="Symbol">{</a><a id="1114" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1114" class="Bound">action</a><a id="1120" class="Symbol">}</a> <a id="1122" class="Symbol">→</a> <a id="1124" href="Ledger.Conway.Specification.Gov.Actions.html#568" class="Function">GovActionID</a> <a id="1136" class="Symbol">→</a> <a id="1138" href="Ledger.Conway.Specification.Gov.Actions.html#2268" class="Function">NeedsHash</a> <a id="1148" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1114" class="Bound">action</a>
<a id="1155" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1167" class="Symbol">{</a><a id="1168" href="Ledger.Conway.Specification.Gov.Actions.html#809" class="InductiveConstructor">NoConfidence</a><a id="1180" class="Symbol">}</a>        <a id="1189" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1189" class="Bound">x</a> <a id="1191" class="Symbol">=</a> <a id="1193" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1189" class="Bound">x</a>
<a id="1195" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1207" class="Symbol">{</a><a id="1208" href="Ledger.Conway.Specification.Gov.Actions.html#847" class="InductiveConstructor">UpdateCommittee</a><a id="1223" class="Symbol">}</a>     <a id="1229" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1229" class="Bound">x</a> <a id="1231" class="Symbol">=</a> <a id="1233" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1229" class="Bound">x</a>
<a id="1235" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1247" class="Symbol">{</a><a id="1248" href="Ledger.Conway.Specification.Gov.Actions.html#885" class="InductiveConstructor">NewConstitution</a><a id="1263" class="Symbol">}</a>     <a id="1269" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1269" class="Bound">x</a> <a id="1271" class="Symbol">=</a> <a id="1273" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1269" class="Bound">x</a>
<a id="1275" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1287" class="Symbol">{</a><a id="1288" href="Ledger.Conway.Specification.Gov.Actions.html#923" class="InductiveConstructor">TriggerHardFork</a><a id="1303" class="Symbol">}</a>     <a id="1309" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1309" class="Bound">x</a> <a id="1311" class="Symbol">=</a> <a id="1313" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1309" class="Bound">x</a>
<a id="1315" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1327" class="Symbol">{</a><a id="1328" href="Ledger.Conway.Specification.Gov.Actions.html#961" class="InductiveConstructor">ChangePParams</a><a id="1341" class="Symbol">}</a>       <a id="1349" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1349" class="Bound">x</a> <a id="1351" class="Symbol">=</a> <a id="1353" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1349" class="Bound">x</a>
<a id="1355" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1367" class="Symbol">{</a><a id="1368" href="Ledger.Conway.Specification.Gov.Actions.html#999" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1386" class="Symbol">}</a>  <a id="1389" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1389" class="Bound">x</a> <a id="1391" class="Symbol">=</a> <a id="1393" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="1396" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a> <a id="1408" class="Symbol">{</a><a id="1409" href="Ledger.Conway.Specification.Gov.Actions.html#1037" class="InductiveConstructor">Info</a><a id="1413" class="Symbol">}</a>                <a id="1430" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1430" class="Bound">x</a> <a id="1432" class="Symbol">=</a> <a id="1434" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

<a id="fromNeedsHash"></a><a id="1438" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1452" class="Symbol">:</a> <a id="1454" class="Symbol">∀</a> <a id="1456" class="Symbol">{</a><a id="1457" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1457" class="Bound">action</a><a id="1463" class="Symbol">}</a> <a id="1465" class="Symbol">→</a> <a id="1467" href="Ledger.Conway.Specification.Gov.Actions.html#2268" class="Function">NeedsHash</a> <a id="1477" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1457" class="Bound">action</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="Ledger.Conway.Specification.Gov.Actions.html#568" class="Function">GovActionID</a>
<a id="1498" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1512" class="Symbol">{</a><a id="1513" href="Ledger.Conway.Specification.Gov.Actions.html#809" class="InductiveConstructor">NoConfidence</a><a id="1525" class="Symbol">}</a>        <a id="1534" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1534" class="Bound">x</a> <a id="1536" class="Symbol">=</a> <a id="1538" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1534" class="Bound">x</a>
<a id="1540" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1554" class="Symbol">{</a><a id="1555" href="Ledger.Conway.Specification.Gov.Actions.html#847" class="InductiveConstructor">UpdateCommittee</a><a id="1570" class="Symbol">}</a>     <a id="1576" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1576" class="Bound">x</a> <a id="1578" class="Symbol">=</a> <a id="1580" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1576" class="Bound">x</a>
<a id="1582" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1596" class="Symbol">{</a><a id="1597" href="Ledger.Conway.Specification.Gov.Actions.html#885" class="InductiveConstructor">NewConstitution</a><a id="1612" class="Symbol">}</a>     <a id="1618" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1618" class="Bound">x</a> <a id="1620" class="Symbol">=</a> <a id="1622" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1618" class="Bound">x</a>
<a id="1624" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1638" class="Symbol">{</a><a id="1639" href="Ledger.Conway.Specification.Gov.Actions.html#923" class="InductiveConstructor">TriggerHardFork</a><a id="1654" class="Symbol">}</a>     <a id="1660" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1660" class="Bound">x</a> <a id="1662" class="Symbol">=</a> <a id="1664" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1660" class="Bound">x</a>
<a id="1666" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1680" class="Symbol">{</a><a id="1681" href="Ledger.Conway.Specification.Gov.Actions.html#961" class="InductiveConstructor">ChangePParams</a><a id="1694" class="Symbol">}</a>       <a id="1702" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1702" class="Bound">x</a> <a id="1704" class="Symbol">=</a> <a id="1706" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1702" class="Bound">x</a>
<a id="1708" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1722" class="Symbol">{</a><a id="1723" href="Ledger.Conway.Specification.Gov.Actions.html#999" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1741" class="Symbol">}</a>  <a id="1744" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1744" class="Bound">x</a> <a id="1746" class="Symbol">=</a> <a id="1748" class="Number">0</a> <a id="1750" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1752" class="Number">0</a>
<a id="1754" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="1768" class="Symbol">{</a><a id="1769" href="Ledger.Conway.Specification.Gov.Actions.html#1037" class="InductiveConstructor">Info</a><a id="1773" class="Symbol">}</a>                <a id="1790" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1790" class="Bound">x</a> <a id="1792" class="Symbol">=</a> <a id="1794" class="Number">0</a> <a id="1796" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1798" class="Number">0</a>

<a id="1801" class="Comment">-- Then we define non-dependent versions of the types that use</a>
<a id="1864" class="Comment">-- NeedsHash.</a>

<a id="1879" class="Keyword">record</a> <a id="GovProposal&#39;"></a><a id="1886" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a> <a id="1899" class="Symbol">:</a> <a id="1901" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1906" class="Keyword">where</a>
  <a id="1914" class="Keyword">field</a>
    <a id="GovProposal&#39;.action"></a><a id="1924" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1924" class="Field">action</a>      <a id="1936" class="Symbol">:</a> <a id="1938" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovProposal&#39;.prevAction"></a><a id="1953" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1953" class="Field">prevAction</a>  <a id="1965" class="Symbol">:</a> <a id="1967" href="Ledger.Conway.Specification.Gov.Actions.html#568" class="Function">GovActionID</a>       <a id="1985" class="Comment">-- NeedsHash action</a>
    <a id="GovProposal&#39;.policy"></a><a id="2009" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2009" class="Field">policy</a>      <a id="2021" class="Symbol">:</a> <a id="2023" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2029" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
    <a id="GovProposal&#39;.deposit"></a><a id="2044" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2044" class="Field">deposit</a>     <a id="2056" class="Symbol">:</a> <a id="2058" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="GovProposal&#39;.returnAddr"></a><a id="2067" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2067" class="Field">returnAddr</a>  <a id="2079" class="Symbol">:</a> <a id="2081" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
    <a id="GovProposal&#39;.anchor"></a><a id="2093" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2093" class="Field">anchor</a>      <a id="2105" class="Symbol">:</a> <a id="2107" href="Ledger.Conway.Specification.Gov.Actions.html#707" class="Record">Anchor</a>

<a id="2115" class="Keyword">record</a> <a id="GovActionState&#39;"></a><a id="2122" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a> <a id="2138" class="Symbol">:</a> <a id="2140" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2145" class="Keyword">where</a>
  <a id="2153" class="Keyword">field</a>
    <a id="GovActionState&#39;.votes"></a><a id="2163" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2163" class="Field">votes</a>       <a id="2175" class="Symbol">:</a> <a id="2177" href="Ledger.Conway.Specification.Gov.Actions.html#591" class="Function">Voter</a> <a id="2183" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2185" href="Ledger.Conway.Specification.Gov.Actions.html#2954" class="Datatype">Vote</a>
    <a id="GovActionState&#39;.returnAddr"></a><a id="2194" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2194" class="Field">returnAddr</a>  <a id="2206" class="Symbol">:</a> <a id="2208" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
    <a id="GovActionState&#39;.expiresIn"></a><a id="2220" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2220" class="Field">expiresIn</a>   <a id="2232" class="Symbol">:</a> <a id="2234" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
    <a id="GovActionState&#39;.action"></a><a id="2244" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2244" class="Field">action</a>      <a id="2256" class="Symbol">:</a> <a id="2258" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovActionState&#39;.prevAction"></a><a id="2273" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2273" class="Field">prevAction</a>  <a id="2285" class="Symbol">:</a> <a id="2287" href="Ledger.Conway.Specification.Gov.Actions.html#568" class="Function">GovActionID</a>       <a id="2305" class="Comment">-- NeedsHash action</a>

<a id="2326" class="Comment">-- We can convert between the dependent and non-dependent versions</a>
<a id="2393" class="Comment">-- using to/fromNeedsHash.</a>

<a id="2421" class="Keyword">private</a>
  <a id="mkGovProposal&#39;"></a><a id="2431" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2431" class="Function">mkGovProposal&#39;</a> <a id="2446" class="Symbol">:</a> <a id="2448" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2460" href="Ledger.Conway.Specification.Gov.Actions.html#3150" class="Record">GovProposal</a> <a id="2472" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a>
  <a id="2487" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2431" class="Function">mkGovProposal&#39;</a> <a id="2502" class="Symbol">=</a> <a id="2504" class="Symbol">λ</a> <a id="2506" class="Keyword">where</a>
    <a id="2516" class="Symbol">.</a><a id="2517" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2522" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2522" class="Bound">p</a> <a id="2524" class="Symbol">→</a> <a id="2526" class="Keyword">let</a> <a id="2530" class="Keyword">module</a> <a id="p"></a><a id="2537" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2537" class="Module">p</a> <a id="2539" class="Symbol">=</a> <a id="2541" href="Ledger.Conway.Specification.Gov.Actions.html#3150" class="Module">GovProposal</a>  <a id="2554" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2522" class="Bound">p</a> <a id="2556" class="Keyword">in</a> <a id="2559" class="Keyword">record</a> <a id="2566" class="Symbol">{</a> <a id="2568" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2537" class="Module">p</a><a id="2569" class="Symbol">;</a> <a id="2571" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1924" class="Field">action</a> <a id="2578" class="Symbol">=</a> <a id="2580" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2583" href="Ledger.Conway.Specification.Gov.Actions.html#3187" class="Field">p.action</a>  <a id="2593" class="Symbol">;</a> <a id="2595" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1953" class="Field">prevAction</a> <a id="2606" class="Symbol">=</a> <a id="2608" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="2622" href="Ledger.Conway.Specification.Gov.Actions.html#3215" class="Field">p.prevAction</a> <a id="2635" class="Symbol">}</a>
    <a id="2641" class="Symbol">.</a><a id="2642" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2647" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2647" class="Bound">p</a> <a id="2649" class="Symbol">→</a> <a id="2651" class="Keyword">let</a> <a id="2655" class="Keyword">module</a> <a id="p"></a><a id="2662" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2662" class="Module">p</a> <a id="2664" class="Symbol">=</a> <a id="2666" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Module">GovProposal&#39;</a> <a id="2679" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2647" class="Bound">p</a> <a id="2681" class="Keyword">in</a> <a id="2684" class="Keyword">record</a> <a id="2691" class="Symbol">{</a> <a id="2693" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2662" class="Module">p</a><a id="2694" class="Symbol">;</a> <a id="2696" href="Ledger.Conway.Specification.Gov.Actions.html#3187" class="Field">action</a> <a id="2703" class="Symbol">=</a> <a id="2705" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2710" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1924" class="Field">p.action</a><a id="2718" class="Symbol">;</a> <a id="2720" href="Ledger.Conway.Specification.Gov.Actions.html#3215" class="Field">prevAction</a> <a id="2731" class="Symbol">=</a> <a id="2733" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a>   <a id="2747" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1953" class="Field">p.prevAction</a> <a id="2760" class="Symbol">}</a>

  <a id="mkGovActionState&#39;"></a><a id="2765" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2765" class="Function">mkGovActionState&#39;</a> <a id="2783" class="Symbol">:</a> <a id="2785" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2797" href="Ledger.Conway.Specification.Gov.Actions.html#3372" class="Record">GovActionState</a> <a id="2812" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a>
  <a id="2830" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2765" class="Function">mkGovActionState&#39;</a> <a id="2848" class="Symbol">=</a> <a id="2850" class="Symbol">λ</a> <a id="2852" class="Keyword">where</a>
    <a id="2862" class="Symbol">.</a><a id="2863" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2868" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2868" class="Bound">s</a> <a id="2870" class="Symbol">→</a> <a id="2872" class="Keyword">let</a> <a id="2876" class="Keyword">module</a> <a id="s"></a><a id="2883" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2883" class="Module">s</a> <a id="2885" class="Symbol">=</a> <a id="2887" href="Ledger.Conway.Specification.Gov.Actions.html#3372" class="Module">GovActionState</a>  <a id="2903" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2868" class="Bound">s</a> <a id="2905" class="Keyword">in</a> <a id="2908" class="Keyword">record</a><a id="2914" class="Symbol">{</a> <a id="2916" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2883" class="Module">s</a><a id="2917" class="Symbol">;</a> <a id="2919" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2244" class="Field">action</a> <a id="2926" class="Symbol">=</a> <a id="2928" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2931" href="Ledger.Conway.Specification.Gov.Actions.html#3493" class="Field">s.action</a>  <a id="2941" class="Symbol">;</a> <a id="2943" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2273" class="Field">prevAction</a> <a id="2954" class="Symbol">=</a> <a id="2956" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1438" class="Function">fromNeedsHash</a> <a id="2970" href="Ledger.Conway.Specification.Gov.Actions.html#3521" class="Field">s.prevAction</a> <a id="2983" class="Symbol">}</a>
    <a id="2989" class="Symbol">.</a><a id="2990" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2995" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2995" class="Bound">s</a> <a id="2997" class="Symbol">→</a> <a id="2999" class="Keyword">let</a> <a id="3003" class="Keyword">module</a> <a id="s"></a><a id="3010" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3010" class="Module">s</a> <a id="3012" class="Symbol">=</a> <a id="3014" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Module">GovActionState&#39;</a> <a id="3030" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2995" class="Bound">s</a> <a id="3032" class="Keyword">in</a> <a id="3035" class="Keyword">record</a><a id="3041" class="Symbol">{</a> <a id="3043" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3010" class="Module">s</a><a id="3044" class="Symbol">;</a> <a id="3046" href="Ledger.Conway.Specification.Gov.Actions.html#3493" class="Field">action</a> <a id="3053" class="Symbol">=</a> <a id="3055" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3060" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2244" class="Field">s.action</a><a id="3068" class="Symbol">;</a> <a id="3070" href="Ledger.Conway.Specification.Gov.Actions.html#3521" class="Field">prevAction</a> <a id="3081" class="Symbol">=</a> <a id="3083" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1097" class="Function">toNeedsHash</a>   <a id="3097" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2273" class="Field">s.prevAction</a> <a id="3110" class="Symbol">}</a>

<a id="3113" class="Comment">-- Auto-generated conversions for the non-dependent types</a>

<a id="3172" class="Keyword">instance</a>
  <a id="HsTy-GovProposal&#39;"></a><a id="3183" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3183" class="Function">HsTy-GovProposal&#39;</a> <a id="3201" class="Symbol">=</a> <a id="3203" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3214" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a> <a id="3227" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3229" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3238" class="String">&quot;GovProposal&quot;</a>
                                              <a id="3298" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3300" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3316" class="String">&quot;MkGovProposal&quot;</a>
                                              <a id="3378" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3380" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3392" class="String">&quot;gp&quot;</a>
  <a id="Conv-GovProposal&#39;"></a><a id="3399" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3399" class="Function">Conv-GovProposal&#39;</a> <a id="3417" class="Symbol">=</a> <a id="3419" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3431" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a>

  <a id="HsTy-GovActionState&#39;"></a><a id="3447" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3447" class="Function">HsTy-GovActionState&#39;</a> <a id="3468" class="Symbol">=</a> <a id="3470" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3481" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a> <a id="3497" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3499" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3508" class="String">&quot;GovActionState&quot;</a>
                                                    <a id="3577" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3579" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3595" class="String">&quot;MkGovActionState&quot;</a>
                                                    <a id="3666" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3668" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3680" class="String">&quot;gas&quot;</a>
  <a id="Conv-GovActionState&#39;"></a><a id="3688" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3688" class="Function">Conv-GovActionState&#39;</a> <a id="3709" class="Symbol">=</a> <a id="3711" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3723" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a>

<a id="3740" class="Comment">-- And finally we compose everything into conversions for the dependent types</a>

<a id="3819" class="Keyword">instance</a>
  <a id="HsTy-GovProposal"></a><a id="3830" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3830" class="Function">HsTy-GovProposal</a> <a id="3847" class="Symbol">=</a> <a id="3849" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3858" href="Ledger.Conway.Specification.Gov.Actions.html#3150" class="Record">GovProposal</a> <a id="3870" class="Symbol">(</a><a id="3871" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3878" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1886" class="Record">GovProposal&#39;</a><a id="3890" class="Symbol">)</a>
  <a id="Conv-GovProposal"></a><a id="3894" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3894" class="Function">Conv-GovProposal</a> <a id="3911" class="Symbol">=</a> <a id="3913" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2431" class="Function">mkGovProposal&#39;</a> <a id="3928" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="3930" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3399" class="Function">Conv-GovProposal&#39;</a>

  <a id="HsTy-GovActionState"></a><a id="3951" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3951" class="Function">HsTy-GovActionState</a> <a id="3971" class="Symbol">=</a> <a id="3973" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3982" href="Ledger.Conway.Specification.Gov.Actions.html#3372" class="Record">GovActionState</a> <a id="3997" class="Symbol">(</a><a id="3998" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4005" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2122" class="Record">GovActionState&#39;</a><a id="4020" class="Symbol">)</a>
  <a id="Conv-GovActionState"></a><a id="4024" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4024" class="Function">Conv-GovActionState</a> <a id="4044" class="Symbol">=</a> <a id="4046" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2765" class="Function">mkGovActionState&#39;</a> <a id="4064" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="4066" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3688" class="Function">Conv-GovActionState&#39;</a>

<a id="4088" class="Keyword">unquoteDecl</a> <a id="4100" class="Symbol">=</a> <a id="4102" class="Keyword">do</a>
  hsTypeAlias GovActionID
  hsTypeAlias GovState
  hsTypeAlias Voter

<a id="4175" class="Comment">-- Computational function</a>

<a id="gov-step"></a><a id="4202" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4202" class="Function">gov-step</a> <a id="4211" class="Symbol">:</a> <a id="4213" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4220" class="Symbol">(</a><a id="4221" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="4228" class="Symbol">→</a> <a id="4230" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="4239" class="Symbol">→</a> <a id="4241" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4246" class="Symbol">(</a><a id="4247" href="Ledger.Conway.Specification.Gov.Actions.html#3005" class="Record">GovVote</a> <a id="4255" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4257" href="Ledger.Conway.Specification.Gov.Actions.html#3150" class="Record">GovProposal</a><a id="4268" class="Symbol">)</a> <a id="4270" class="Symbol">→</a> <a id="4272" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="4290" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4297" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a><a id="4305" class="Symbol">)</a>
<a id="4307" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4202" class="Function">gov-step</a> <a id="4316" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4316" class="Bound">Γ</a> <a id="4318" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4318" class="Bound">govSt</a> <a id="4324" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4324" class="Bound">gvps</a> <a id="4329" class="Symbol">=</a> <a id="4331" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="4334" class="Symbol">(</a><a id="4335" href="Interface.ComputationalRelation.html#2976" class="Function">compute</a> <a id="4343" href="Ledger.Conway.Specification.Gov.Properties.html#7679" class="Function">Computational-GOVS</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Gov.html#861}{\htmlId{4364}{\htmlClass{Function}{\text{txid}}}}\, \\ \,\href{Ledger.Conway.Foreign.HSLedger.Gov.html#4512}{\htmlId{4371}{\htmlClass{Function}{\text{e&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#908}{\htmlId{4376}{\htmlClass{Function}{\text{pparams}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#934}{\htmlId{4386}{\htmlClass{Function}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#969}{\htmlId{4396}{\htmlClass{Function}{\text{enactState}}}}\, \\ \,\href{Foreign.Convertible.html#149}{\htmlId{4409}{\htmlClass{Field}{\text{to}}}}\, \,\href{Ledger.Conway.Conformance.Gov.html#998}{\htmlId{4412}{\htmlClass{Function}{\text{certState}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#1026}{\htmlId{4424}{\htmlClass{Function}{\text{rewardCreds}}}}\, \end{pmatrix}$</a> <a id="4438" class="Symbol">(</a><a id="4439" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4444" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4318" class="Bound">govSt</a><a id="4449" class="Symbol">)</a> <a id="4451" class="Symbol">(</a><a id="4452" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4457" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4324" class="Bound">gvps</a><a id="4461" class="Symbol">))</a>
  <a id="4466" class="Keyword">where</a> <a id="4472" class="Keyword">open</a> <a id="4477" href="Ledger.Conway.Conformance.Gov.html#829" class="Module">GovEnv</a> <a id="4484" class="Symbol">(</a><a id="4485" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4490" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4316" class="Bound">Γ</a><a id="4491" class="Symbol">)</a> <a id="4493" class="Keyword">renaming</a> <a id="4502" class="Symbol">(</a><a id="4503" href="Ledger.Conway.Conformance.Gov.html#884" class="Field">epoch</a> <a id="4509" class="Symbol">to</a> <a id="4512" class="Field">e&#39;</a><a id="4514" class="Symbol">)</a>

<a id="4517" class="Symbol">{-#</a> <a id="4521" class="Keyword">COMPILE</a> <a id="4529" class="Keyword">GHC</a> <a id="4533" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4202" class="Function">gov-step</a> <a id="4542" class="Pragma">as</a> <a id="4545" class="Pragma">govStep</a> <a id="4553" class="Symbol">#-}</a>
</pre></body></html>