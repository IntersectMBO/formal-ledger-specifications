<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Gov</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Gov.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="88" class="Symbol">)</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Ledger.Conway.Foreign.HSLedger.Gov.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Core</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Actions</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Ledger.Conway.Foreign.HSLedger.Cert.html" class="Module">Ledger.Conway.Foreign.HSLedger.Cert</a>

<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="495" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="554" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Ledger.Conway.Conformance.Gov.html" class="Module">Ledger.Conway.Conformance.Gov</a> <a id="609" href="Function.Base.html#4755" class="Function">it</a> <a id="612" href="Function.Base.html#4755" class="Function">it</a>
<a id="615" class="Keyword">import</a> <a id="622" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="654" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a> <a id="667" class="Symbol">as</a> <a id="L"></a><a id="670" href="Ledger.Conway.Foreign.HSLedger.Gov.html#670" class="Module">L</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Ledger.Conway.Specification.Gov.Properties.Computational.html" class="Module">Ledger.Conway.Specification.Gov.Properties.Computational</a> <a id="741" href="Function.Base.html#4755" class="Function">it</a>

<a id="745" class="Keyword">instance</a>

  <a id="HsTy-GovEnv"></a><a id="757" href="Ledger.Conway.Foreign.HSLedger.Gov.html#757" class="Function">HsTy-GovEnv</a> <a id="769" class="Symbol">=</a> <a id="771" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType</a> <a id="782" href="Ledger.Conway.Conformance.Gov.html#847" class="Record">GovEnv</a> <a id="789" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">⊣</a> <a id="791" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="807" class="String">&quot;MkGovEnv&quot;</a>
                                  <a id="852" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="854" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="866" class="String">&quot;ge&quot;</a>
  <a id="Conv-GovEnv"></a><a id="873" href="Ledger.Conway.Foreign.HSLedger.Gov.html#873" class="Function">Conv-GovEnv</a> <a id="885" class="Symbol">=</a> <a id="887" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="899" href="Ledger.Conway.Conformance.Gov.html#847" class="Record">GovEnv</a>

<a id="907" class="Comment">-- NeedsHash depends on a GovAction, so a little bit of manual work is</a>
<a id="978" class="Comment">-- required to get the types using it into Haskell.</a>

<a id="1031" class="Comment">-- First we define to/fromNeedsHash that replaces the ⊤ cases by a</a>
<a id="1098" class="Comment">-- dummy GovActionID.</a>

<a id="toNeedsHash"></a><a id="1121" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a> <a id="1133" class="Symbol">:</a> <a id="1135" class="Symbol">∀</a> <a id="1137" class="Symbol">{</a><a id="1138" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1138" class="Bound">action</a><a id="1144" class="Symbol">}</a> <a id="1146" class="Symbol">→</a> <a id="1148" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a> <a id="1160" class="Symbol">→</a> <a id="1162" href="Ledger.Conway.Specification.Gov.Actions.html#2874" class="Function">NeedsHash</a> <a id="1172" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1138" class="Bound">action</a>
<a id="1179" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a> <a id="1191" class="Symbol">{</a><a id="1192" href="Ledger.Conway.Specification.Gov.Actions.html#656" class="InductiveConstructor">NoConfidence</a><a id="1204" class="Symbol">}</a>        <a id="1213" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1213" class="Bound">x</a> <a id="1215" class="Symbol">=</a> <a id="1217" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1213" class="Bound">x</a>
<a id="1219" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a> <a id="1231" class="Symbol">{</a><a id="1232" href="Ledger.Conway.Specification.Gov.Actions.html#694" class="InductiveConstructor">UpdateCommittee</a><a id="1247" class="Symbol">}</a>     <a id="1253" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1253" class="Bound">x</a> <a id="1255" class="Symbol">=</a> <a id="1257" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1253" class="Bound">x</a>
<a id="1259" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a> <a id="1271" class="Symbol">{</a><a id="1272" href="Ledger.Conway.Specification.Gov.Actions.html#732" class="InductiveConstructor">NewConstitution</a><a id="1287" class="Symbol">}</a>     <a id="1293" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1293" class="Bound">x</a> <a id="1295" class="Symbol">=</a> <a id="1297" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1293" class="Bound">x</a>
<a id="1299" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a> <a id="1311" class="Symbol">{</a><a id="1312" href="Ledger.Conway.Specification.Gov.Actions.html#770" class="InductiveConstructor">TriggerHardFork</a><a id="1327" class="Symbol">}</a>     <a id="1333" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1333" class="Bound">x</a> <a id="1335" class="Symbol">=</a> <a id="1337" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1333" class="Bound">x</a>
<a id="1339" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a> <a id="1351" class="Symbol">{</a><a id="1352" href="Ledger.Conway.Specification.Gov.Actions.html#808" class="InductiveConstructor">ChangePParams</a><a id="1365" class="Symbol">}</a>       <a id="1373" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1373" class="Bound">x</a> <a id="1375" class="Symbol">=</a> <a id="1377" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1373" class="Bound">x</a>
<a id="1379" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a> <a id="1391" class="Symbol">{</a><a id="1392" href="Ledger.Conway.Specification.Gov.Actions.html#846" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1410" class="Symbol">}</a>  <a id="1413" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1413" class="Bound">x</a> <a id="1415" class="Symbol">=</a> <a id="1417" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="1420" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a> <a id="1432" class="Symbol">{</a><a id="1433" href="Ledger.Conway.Specification.Gov.Actions.html#884" class="InductiveConstructor">Info</a><a id="1437" class="Symbol">}</a>                <a id="1454" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1454" class="Bound">x</a> <a id="1456" class="Symbol">=</a> <a id="1458" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

<a id="fromNeedsHash"></a><a id="1462" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="1476" class="Symbol">:</a> <a id="1478" class="Symbol">∀</a> <a id="1480" class="Symbol">{</a><a id="1481" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1481" class="Bound">action</a><a id="1487" class="Symbol">}</a> <a id="1489" class="Symbol">→</a> <a id="1491" href="Ledger.Conway.Specification.Gov.Actions.html#2874" class="Function">NeedsHash</a> <a id="1501" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1481" class="Bound">action</a> <a id="1508" class="Symbol">→</a> <a id="1510" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a>
<a id="1522" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="1536" class="Symbol">{</a><a id="1537" href="Ledger.Conway.Specification.Gov.Actions.html#656" class="InductiveConstructor">NoConfidence</a><a id="1549" class="Symbol">}</a>        <a id="1558" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1558" class="Bound">x</a> <a id="1560" class="Symbol">=</a> <a id="1562" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1558" class="Bound">x</a>
<a id="1564" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="1578" class="Symbol">{</a><a id="1579" href="Ledger.Conway.Specification.Gov.Actions.html#694" class="InductiveConstructor">UpdateCommittee</a><a id="1594" class="Symbol">}</a>     <a id="1600" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1600" class="Bound">x</a> <a id="1602" class="Symbol">=</a> <a id="1604" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1600" class="Bound">x</a>
<a id="1606" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="1620" class="Symbol">{</a><a id="1621" href="Ledger.Conway.Specification.Gov.Actions.html#732" class="InductiveConstructor">NewConstitution</a><a id="1636" class="Symbol">}</a>     <a id="1642" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1642" class="Bound">x</a> <a id="1644" class="Symbol">=</a> <a id="1646" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1642" class="Bound">x</a>
<a id="1648" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="1662" class="Symbol">{</a><a id="1663" href="Ledger.Conway.Specification.Gov.Actions.html#770" class="InductiveConstructor">TriggerHardFork</a><a id="1678" class="Symbol">}</a>     <a id="1684" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1684" class="Bound">x</a> <a id="1686" class="Symbol">=</a> <a id="1688" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1684" class="Bound">x</a>
<a id="1690" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="1704" class="Symbol">{</a><a id="1705" href="Ledger.Conway.Specification.Gov.Actions.html#808" class="InductiveConstructor">ChangePParams</a><a id="1718" class="Symbol">}</a>       <a id="1726" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1726" class="Bound">x</a> <a id="1728" class="Symbol">=</a> <a id="1730" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1726" class="Bound">x</a>
<a id="1732" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="1746" class="Symbol">{</a><a id="1747" href="Ledger.Conway.Specification.Gov.Actions.html#846" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1765" class="Symbol">}</a>  <a id="1768" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1768" class="Bound">x</a> <a id="1770" class="Symbol">=</a> <a id="1772" class="Number">0</a> <a id="1774" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1776" class="Number">0</a>
<a id="1778" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="1792" class="Symbol">{</a><a id="1793" href="Ledger.Conway.Specification.Gov.Actions.html#884" class="InductiveConstructor">Info</a><a id="1797" class="Symbol">}</a>                <a id="1814" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1814" class="Bound">x</a> <a id="1816" class="Symbol">=</a> <a id="1818" class="Number">0</a> <a id="1820" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1822" class="Number">0</a>

<a id="1825" class="Comment">-- Then we define non-dependent versions of the types that use</a>
<a id="1888" class="Comment">-- NeedsHash.</a>

<a id="1903" class="Keyword">record</a> <a id="GovProposal&#39;"></a><a id="1910" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1910" class="Record">GovProposal&#39;</a> <a id="1923" class="Symbol">:</a> <a id="1925" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1930" class="Keyword">where</a>
  <a id="1938" class="Keyword">field</a>
    <a id="GovProposal&#39;.action"></a><a id="1948" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1948" class="Field">action</a>      <a id="1960" class="Symbol">:</a> <a id="1962" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovProposal&#39;.prevAction"></a><a id="1977" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1977" class="Field">prevAction</a>  <a id="1989" class="Symbol">:</a> <a id="1991" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a>       <a id="2009" class="Comment">-- NeedsHash action</a>
    <a id="GovProposal&#39;.policy"></a><a id="2033" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2033" class="Field">policy</a>      <a id="2045" class="Symbol">:</a> <a id="2047" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2053" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
    <a id="GovProposal&#39;.deposit"></a><a id="2068" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2068" class="Field">deposit</a>     <a id="2080" class="Symbol">:</a> <a id="2082" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="GovProposal&#39;.returnAddr"></a><a id="2091" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2091" class="Field">returnAddr</a>  <a id="2103" class="Symbol">:</a> <a id="2105" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a>
    <a id="GovProposal&#39;.anchor"></a><a id="2123" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2123" class="Field">anchor</a>      <a id="2135" class="Symbol">:</a> <a id="2137" href="Ledger.Conway.Specification.Gov.Actions.html#2218" class="Record">Anchor</a>

<a id="2145" class="Keyword">record</a> <a id="GovActionState&#39;"></a><a id="2152" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2152" class="Record">GovActionState&#39;</a> <a id="2168" class="Symbol">:</a> <a id="2170" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2175" class="Keyword">where</a>
  <a id="2183" class="Keyword">field</a>
    <a id="GovActionState&#39;.votes"></a><a id="2193" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2193" class="Field">votes</a>       <a id="2205" class="Symbol">:</a> <a id="2207" href="Ledger.Conway.Specification.Gov.Actions.html#2443" class="Record">GovVotes</a>
    <a id="GovActionState&#39;.returnAddr"></a><a id="2220" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2220" class="Field">returnAddr</a>  <a id="2232" class="Symbol">:</a> <a id="2234" href="Ledger.Core.Specification.Address.html#1313" class="Record">RewardAddress</a>
    <a id="GovActionState&#39;.expiresIn"></a><a id="2252" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2252" class="Field">expiresIn</a>   <a id="2264" class="Symbol">:</a> <a id="2266" href="Ledger.Core.Specification.Epoch.html#646" class="Function">Epoch</a>
    <a id="GovActionState&#39;.action"></a><a id="2276" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2276" class="Field">action</a>      <a id="2288" class="Symbol">:</a> <a id="2290" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovActionState&#39;.prevAction"></a><a id="2305" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2305" class="Field">prevAction</a>  <a id="2317" class="Symbol">:</a> <a id="2319" href="Ledger.Conway.Specification.Gov.Actions.html#1980" class="Function">GovActionID</a>       <a id="2337" class="Comment">-- NeedsHash action</a>

<a id="2358" class="Comment">-- We can convert between the dependent and non-dependent versions</a>
<a id="2425" class="Comment">-- using to/fromNeedsHash.</a>

<a id="2453" class="Keyword">private</a>
  <a id="mkGovProposal&#39;"></a><a id="2463" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2463" class="Function">mkGovProposal&#39;</a> <a id="2478" class="Symbol">:</a> <a id="2480" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2492" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Record">GovProposal</a> <a id="2504" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1910" class="Record">GovProposal&#39;</a>
  <a id="2519" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2463" class="Function">mkGovProposal&#39;</a> <a id="2534" class="Symbol">=</a> <a id="2536" class="Symbol">λ</a> <a id="2538" class="Keyword">where</a>
    <a id="2548" class="Symbol">.</a><a id="2549" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2554" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2554" class="Bound">p</a> <a id="2556" class="Symbol">→</a> <a id="2558" class="Keyword">let</a> <a id="2562" class="Keyword">module</a> <a id="p"></a><a id="2569" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2569" class="Module">p</a> <a id="2571" class="Symbol">=</a> <a id="2573" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Module">GovProposal</a>  <a id="2586" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2554" class="Bound">p</a> <a id="2588" class="Keyword">in</a> <a id="2591" class="Keyword">record</a> <a id="2598" class="Symbol">{</a> <a id="2600" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2569" class="Module">p</a><a id="2601" class="Symbol">;</a> <a id="2603" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1948" class="Field">action</a> <a id="2610" class="Symbol">=</a> <a id="2612" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2615" href="Ledger.Conway.Specification.Gov.Actions.html#3640" class="Field">p.action</a>  <a id="2625" class="Symbol">;</a> <a id="2627" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1977" class="Field">prevAction</a> <a id="2638" class="Symbol">=</a> <a id="2640" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="2654" href="Ledger.Conway.Specification.Gov.Actions.html#3668" class="Field">p.prevAction</a> <a id="2667" class="Symbol">}</a>
    <a id="2673" class="Symbol">.</a><a id="2674" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2679" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2679" class="Bound">p</a> <a id="2681" class="Symbol">→</a> <a id="2683" class="Keyword">let</a> <a id="2687" class="Keyword">module</a> <a id="p"></a><a id="2694" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2694" class="Module">p</a> <a id="2696" class="Symbol">=</a> <a id="2698" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1910" class="Module">GovProposal&#39;</a> <a id="2711" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2679" class="Bound">p</a> <a id="2713" class="Keyword">in</a> <a id="2716" class="Keyword">record</a> <a id="2723" class="Symbol">{</a> <a id="2725" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2694" class="Module">p</a><a id="2726" class="Symbol">;</a> <a id="2728" href="Ledger.Conway.Specification.Gov.Actions.html#3640" class="Field">action</a> <a id="2735" class="Symbol">=</a> <a id="2737" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2742" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1948" class="Field">p.action</a><a id="2750" class="Symbol">;</a> <a id="2752" href="Ledger.Conway.Specification.Gov.Actions.html#3668" class="Field">prevAction</a> <a id="2763" class="Symbol">=</a> <a id="2765" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a>   <a id="2779" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1977" class="Field">p.prevAction</a> <a id="2792" class="Symbol">}</a>

  <a id="mkGovActionState&#39;"></a><a id="2797" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2797" class="Function">mkGovActionState&#39;</a> <a id="2815" class="Symbol">:</a> <a id="2817" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2829" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Record">GovActionState</a> <a id="2844" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2152" class="Record">GovActionState&#39;</a>
  <a id="2862" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2797" class="Function">mkGovActionState&#39;</a> <a id="2880" class="Symbol">=</a> <a id="2882" class="Symbol">λ</a> <a id="2884" class="Keyword">where</a>
    <a id="2894" class="Symbol">.</a><a id="2895" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2900" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2900" class="Bound">s</a> <a id="2902" class="Symbol">→</a> <a id="2904" class="Keyword">let</a> <a id="2908" class="Keyword">module</a> <a id="s"></a><a id="2915" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2915" class="Module">s</a> <a id="2917" class="Symbol">=</a> <a id="2919" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Module">GovActionState</a>  <a id="2935" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2900" class="Bound">s</a> <a id="2937" class="Keyword">in</a> <a id="2940" class="Keyword">record</a><a id="2946" class="Symbol">{</a> <a id="2948" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2915" class="Module">s</a><a id="2949" class="Symbol">;</a> <a id="2951" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2276" class="Field">action</a> <a id="2958" class="Symbol">=</a> <a id="2960" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2963" href="Ledger.Conway.Specification.Gov.Actions.html#3945" class="Field">s.action</a>  <a id="2973" class="Symbol">;</a> <a id="2975" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2305" class="Field">prevAction</a> <a id="2986" class="Symbol">=</a> <a id="2988" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1462" class="Function">fromNeedsHash</a> <a id="3002" href="Ledger.Conway.Specification.Gov.Actions.html#3973" class="Field">s.prevAction</a> <a id="3015" class="Symbol">}</a>
    <a id="3021" class="Symbol">.</a><a id="3022" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3027" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3027" class="Bound">s</a> <a id="3029" class="Symbol">→</a> <a id="3031" class="Keyword">let</a> <a id="3035" class="Keyword">module</a> <a id="s"></a><a id="3042" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3042" class="Module">s</a> <a id="3044" class="Symbol">=</a> <a id="3046" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2152" class="Module">GovActionState&#39;</a> <a id="3062" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3027" class="Bound">s</a> <a id="3064" class="Keyword">in</a> <a id="3067" class="Keyword">record</a><a id="3073" class="Symbol">{</a> <a id="3075" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3042" class="Module">s</a><a id="3076" class="Symbol">;</a> <a id="3078" href="Ledger.Conway.Specification.Gov.Actions.html#3945" class="Field">action</a> <a id="3085" class="Symbol">=</a> <a id="3087" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3092" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2276" class="Field">s.action</a><a id="3100" class="Symbol">;</a> <a id="3102" href="Ledger.Conway.Specification.Gov.Actions.html#3973" class="Field">prevAction</a> <a id="3113" class="Symbol">=</a> <a id="3115" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1121" class="Function">toNeedsHash</a>   <a id="3129" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2305" class="Field">s.prevAction</a> <a id="3142" class="Symbol">}</a>

<a id="3145" class="Comment">-- Auto-generated conversions for the non-dependent types</a>

<a id="3204" class="Keyword">instance</a>
  <a id="HsTy-GovProposal&#39;"></a><a id="3215" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3215" class="Function">HsTy-GovProposal&#39;</a> <a id="3233" class="Symbol">=</a> <a id="3235" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType</a> <a id="3246" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1910" class="Record">GovProposal&#39;</a> <a id="3259" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">⊣</a> <a id="3261" href="Foreign.HaskellTypes.Deriving.html#3333" class="Function">withName</a> <a id="3270" class="String">&quot;GovProposal&quot;</a>
                                              <a id="3330" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3332" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="3348" class="String">&quot;MkGovProposal&quot;</a>
                                              <a id="3410" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3412" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="3424" class="String">&quot;gp&quot;</a>
  <a id="Conv-GovProposal&#39;"></a><a id="3431" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3431" class="Function">Conv-GovProposal&#39;</a> <a id="3449" class="Symbol">=</a> <a id="3451" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3463" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1910" class="Record">GovProposal&#39;</a>

  <a id="HsTy-GovActionState&#39;"></a><a id="3479" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3479" class="Function">HsTy-GovActionState&#39;</a> <a id="3500" class="Symbol">=</a> <a id="3502" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">autoHsType</a> <a id="3513" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2152" class="Record">GovActionState&#39;</a> <a id="3529" href="Foreign.HaskellTypes.Deriving.html#11936" class="Macro Operator">⊣</a> <a id="3531" href="Foreign.HaskellTypes.Deriving.html#3333" class="Function">withName</a> <a id="3540" class="String">&quot;GovActionState&quot;</a>
                                                    <a id="3609" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3611" href="Foreign.HaskellTypes.Deriving.html#3440" class="Function">withConstructor</a> <a id="3627" class="String">&quot;MkGovActionState&quot;</a>
                                                    <a id="3698" href="Foreign.HaskellTypes.Deriving.html#3899" class="Function Operator">•</a> <a id="3700" href="Foreign.HaskellTypes.Deriving.html#3615" class="Function">fieldPrefix</a> <a id="3712" class="String">&quot;gas&quot;</a>
  <a id="Conv-GovActionState&#39;"></a><a id="3720" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3720" class="Function">Conv-GovActionState&#39;</a> <a id="3741" class="Symbol">=</a> <a id="3743" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3755" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2152" class="Record">GovActionState&#39;</a>

<a id="3772" class="Comment">-- And finally we compose everything into conversions for the dependent types</a>

<a id="3851" class="Keyword">instance</a>
  <a id="HsTy-GovProposal"></a><a id="3862" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3862" class="Function">HsTy-GovProposal</a> <a id="3879" class="Symbol">=</a> <a id="3881" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3890" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Record">GovProposal</a> <a id="3902" class="Symbol">(</a><a id="3903" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3910" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1910" class="Record">GovProposal&#39;</a><a id="3922" class="Symbol">)</a>
  <a id="Conv-GovProposal"></a><a id="3926" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3926" class="Function">Conv-GovProposal</a> <a id="3943" class="Symbol">=</a> <a id="3945" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2463" class="Function">mkGovProposal&#39;</a> <a id="3960" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="3962" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3431" class="Function">Conv-GovProposal&#39;</a>

  <a id="HsTy-GovActionState"></a><a id="3983" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3983" class="Function">HsTy-GovActionState</a> <a id="4003" class="Symbol">=</a> <a id="4005" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="4014" href="Ledger.Conway.Specification.Gov.Actions.html#3822" class="Record">GovActionState</a> <a id="4029" class="Symbol">(</a><a id="4030" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4037" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2152" class="Record">GovActionState&#39;</a><a id="4052" class="Symbol">)</a>
  <a id="Conv-GovActionState"></a><a id="4056" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4056" class="Function">Conv-GovActionState</a> <a id="4076" class="Symbol">=</a> <a id="4078" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2797" class="Function">mkGovActionState&#39;</a> <a id="4096" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="4098" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3720" class="Function">Conv-GovActionState&#39;</a>

<a id="4120" class="Keyword">unquoteDecl</a> <a id="4132" class="Symbol">=</a> <a id="4134" class="Keyword">do</a>
  hsTypeAlias GovActionID
  hsTypeAlias GovState
  hsTypeAlias GovVoter&#39;

<a id="4211" class="Comment">-- Computational function</a>

<a id="gov-step"></a><a id="4238" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4238" class="Function">gov-step</a> <a id="4247" class="Symbol">:</a> <a id="4249" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4256" class="Symbol">(</a><a id="4257" href="Ledger.Conway.Conformance.Gov.html#847" class="Record">GovEnv</a> <a id="4264" class="Symbol">→</a> <a id="4266" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a> <a id="4275" class="Symbol">→</a> <a id="4277" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4282" class="Symbol">(</a><a id="4283" href="Ledger.Conway.Specification.Gov.Actions.html#2294" class="Record">GovVote</a> <a id="4291" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4293" href="Ledger.Conway.Specification.Gov.Actions.html#3603" class="Record">GovProposal</a><a id="4304" class="Symbol">)</a> <a id="4306" class="Symbol">→</a> <a id="4308" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="4326" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4333" href="Ledger.Conway.Specification.Gov.html#1401" class="Function">GovState</a><a id="4341" class="Symbol">)</a>
<a id="4343" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4238" class="Function">gov-step</a> <a id="4352" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4352" class="Bound">Γ</a> <a id="4354" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4354" class="Bound">govSt</a> <a id="4360" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4360" class="Bound">gvps</a> <a id="4365" class="Symbol">=</a> <a id="4367" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="4370" class="Symbol">(</a><a id="4371" href="Interface.ComputationalRelation.html#2981" class="Function">compute</a> <a id="4379" href="Ledger.Conway.Specification.Gov.Properties.Computational.html#7739" class="Function">Computational-GOVS</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Gov.html#879}{\htmlId{4400}{\htmlClass{Function}{\text{txid}}}}\, \\ \,\href{Ledger.Conway.Foreign.HSLedger.Gov.html#4548}{\htmlId{4407}{\htmlClass{Function}{\text{e&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#926}{\htmlId{4412}{\htmlClass{Function}{\text{pparams}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#952}{\htmlId{4422}{\htmlClass{Function}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#987}{\htmlId{4432}{\htmlClass{Function}{\text{enactState}}}}\, \\ \,\href{Foreign.Convertible.html#149}{\htmlId{4445}{\htmlClass{Field}{\text{to}}}}\, \,\href{Ledger.Conway.Conformance.Gov.html#1016}{\htmlId{4448}{\htmlClass{Function}{\text{certState}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#1044}{\htmlId{4460}{\htmlClass{Function}{\text{rewardCreds}}}}\, \end{pmatrix}$</a> <a id="4474" class="Symbol">(</a><a id="4475" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4480" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4354" class="Bound">govSt</a><a id="4485" class="Symbol">)</a> <a id="4487" class="Symbol">(</a><a id="4488" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4493" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4360" class="Bound">gvps</a><a id="4497" class="Symbol">))</a>
  <a id="4502" class="Keyword">where</a> <a id="4508" class="Keyword">open</a> <a id="4513" href="Ledger.Conway.Conformance.Gov.html#847" class="Module">GovEnv</a> <a id="4520" class="Symbol">(</a><a id="4521" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4526" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4352" class="Bound">Γ</a><a id="4527" class="Symbol">)</a> <a id="4529" class="Keyword">renaming</a> <a id="4538" class="Symbol">(</a><a id="4539" href="Ledger.Conway.Conformance.Gov.html#902" class="Field">epoch</a> <a id="4545" class="Symbol">to</a> <a id="4548" class="Field">e&#39;</a><a id="4550" class="Symbol">)</a>

<a id="4553" class="Symbol">{-#</a> <a id="4557" class="Keyword">COMPILE</a> <a id="4565" class="Keyword">GHC</a> <a id="4569" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4238" class="Function">gov-step</a> <a id="4578" class="Pragma">as</a> <a id="4581" class="Pragma">govStep</a> <a id="4589" class="Symbol">#-}</a>
</pre></body></html>