<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Gov</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Gov.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="88" class="Symbol">)</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Ledger.Conway.Foreign.HSLedger.Gov.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Core</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Foreign.HSLedger.GovernanceActions.html" class="Module">Ledger.Conway.Foreign.HSLedger.GovernanceActions</a>
<a id="408" class="Keyword">open</a> <a id="413" class="Keyword">import</a> <a id="420" href="Ledger.Conway.Foreign.HSLedger.Cert.html" class="Module">Ledger.Conway.Foreign.HSLedger.Cert</a>

<a id="457" class="Keyword">open</a> <a id="462" class="Keyword">import</a> <a id="469" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="501" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="514" class="Keyword">open</a> <a id="519" class="Keyword">import</a> <a id="526" href="Ledger.Enact.html" class="Module">Ledger.Enact</a> <a id="539" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="552" class="Keyword">open</a> <a id="557" class="Keyword">import</a> <a id="564" href="Ledger.Conway.Conformance.Gov.html" class="Module">Ledger.Conway.Conformance.Gov</a> <a id="594" href="Function.Base.html#4736" class="Function">it</a> <a id="597" href="Function.Base.html#4736" class="Function">it</a>
<a id="600" class="Keyword">import</a> <a id="607" href="Ledger.Gov.html" class="Module">Ledger.Gov</a> <a id="618" href="Function.Base.html#4736" class="Function">it</a> <a id="621" class="Symbol">as</a> <a id="L"></a><a id="624" href="Ledger.Conway.Foreign.HSLedger.Gov.html#624" class="Module">L</a>
<a id="626" class="Keyword">open</a> <a id="631" class="Keyword">import</a> <a id="638" href="Ledger.Gov.Properties.html" class="Module">Ledger.Gov.Properties</a> <a id="660" href="Function.Base.html#4736" class="Function">it</a>

<a id="664" class="Keyword">instance</a>

  <a id="HsTy-GovEnv"></a><a id="676" href="Ledger.Conway.Foreign.HSLedger.Gov.html#676" class="Function">HsTy-GovEnv</a> <a id="688" class="Symbol">=</a> <a id="690" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="701" href="Ledger.Conway.Conformance.Gov.html#703" class="Record">GovEnv</a> <a id="708" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="710" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="726" class="String">&quot;MkGovEnv&quot;</a>
                                  <a id="771" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="773" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="785" class="String">&quot;ge&quot;</a>
  <a id="Conv-GovEnv"></a><a id="792" href="Ledger.Conway.Foreign.HSLedger.Gov.html#792" class="Function">Conv-GovEnv</a> <a id="804" class="Symbol">=</a> <a id="806" href="Foreign.Convertible.Deriving.html#6819" class="Macro">autoConvert</a> <a id="818" href="Ledger.Conway.Conformance.Gov.html#703" class="Record">GovEnv</a>

<a id="826" class="Comment">-- NeedsHash depends on a GovAction, so a little bit of manual work is</a>
<a id="897" class="Comment">-- required to get the types using it into Haskell.</a>

<a id="950" class="Comment">-- First we define to/fromNeedsHash that replaces the ⊤ cases by a</a>
<a id="1017" class="Comment">-- dummy GovActionID.</a>

<a id="toNeedsHash"></a><a id="1040" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a> <a id="1052" class="Symbol">:</a> <a id="1054" class="Symbol">∀</a> <a id="1056" class="Symbol">{</a><a id="1057" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1057" class="Bound">action</a><a id="1063" class="Symbol">}</a> <a id="1065" class="Symbol">→</a> <a id="1067" href="Ledger.GovernanceActions.html#428" class="Function">GovActionID</a> <a id="1079" class="Symbol">→</a> <a id="1081" href="Ledger.GovernanceActions.html#1511" class="Function">NeedsHash</a> <a id="1091" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1057" class="Bound">action</a>
<a id="1098" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a> <a id="1110" class="Symbol">{</a><a id="1111" href="Ledger.GovernanceActions.html#744" class="InductiveConstructor">NoConfidence</a><a id="1123" class="Symbol">}</a>     <a id="1129" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1129" class="Bound">x</a> <a id="1131" class="Symbol">=</a> <a id="1133" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1129" class="Bound">x</a>
<a id="1135" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a> <a id="1147" class="Symbol">{</a><a id="1148" href="Ledger.GovernanceActions.html#779" class="InductiveConstructor">UpdateCommittee</a><a id="1163" class="Symbol">}</a>  <a id="1166" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1166" class="Bound">x</a> <a id="1168" class="Symbol">=</a> <a id="1170" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1166" class="Bound">x</a>
<a id="1172" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a> <a id="1184" class="Symbol">{</a><a id="1185" href="Ledger.GovernanceActions.html#814" class="InductiveConstructor">NewConstitution</a><a id="1200" class="Symbol">}</a>  <a id="1203" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1203" class="Bound">x</a> <a id="1205" class="Symbol">=</a> <a id="1207" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1203" class="Bound">x</a>
<a id="1209" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a> <a id="1221" class="Symbol">{</a><a id="1222" href="Ledger.GovernanceActions.html#849" class="InductiveConstructor">TriggerHF</a><a id="1231" class="Symbol">}</a>        <a id="1240" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1240" class="Bound">x</a> <a id="1242" class="Symbol">=</a> <a id="1244" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1240" class="Bound">x</a>
<a id="1246" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a> <a id="1258" class="Symbol">{</a><a id="1259" href="Ledger.GovernanceActions.html#884" class="InductiveConstructor">ChangePParams</a><a id="1272" class="Symbol">}</a>    <a id="1277" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1277" class="Bound">x</a> <a id="1279" class="Symbol">=</a> <a id="1281" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1277" class="Bound">x</a>
<a id="1283" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a> <a id="1295" class="Symbol">{</a><a id="1296" href="Ledger.GovernanceActions.html#919" class="InductiveConstructor">TreasuryWdrl</a><a id="1308" class="Symbol">}</a>     <a id="1314" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1314" class="Bound">x</a> <a id="1316" class="Symbol">=</a> <a id="1318" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="1321" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a> <a id="1333" class="Symbol">{</a><a id="1334" href="Ledger.GovernanceActions.html#954" class="InductiveConstructor">Info</a><a id="1338" class="Symbol">}</a>             <a id="1352" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1352" class="Bound">x</a> <a id="1354" class="Symbol">=</a> <a id="1356" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

<a id="fromNeedsHash"></a><a id="1360" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="1374" class="Symbol">:</a> <a id="1376" class="Symbol">∀</a> <a id="1378" class="Symbol">{</a><a id="1379" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1379" class="Bound">action</a><a id="1385" class="Symbol">}</a> <a id="1387" class="Symbol">→</a> <a id="1389" href="Ledger.GovernanceActions.html#1511" class="Function">NeedsHash</a> <a id="1399" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1379" class="Bound">action</a> <a id="1406" class="Symbol">→</a> <a id="1408" href="Ledger.GovernanceActions.html#428" class="Function">GovActionID</a>
<a id="1420" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="1434" class="Symbol">{</a><a id="1435" href="Ledger.GovernanceActions.html#744" class="InductiveConstructor">NoConfidence</a><a id="1447" class="Symbol">}</a>     <a id="1453" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1453" class="Bound">x</a> <a id="1455" class="Symbol">=</a> <a id="1457" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1453" class="Bound">x</a>
<a id="1459" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="1473" class="Symbol">{</a><a id="1474" href="Ledger.GovernanceActions.html#779" class="InductiveConstructor">UpdateCommittee</a><a id="1489" class="Symbol">}</a>  <a id="1492" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1492" class="Bound">x</a> <a id="1494" class="Symbol">=</a> <a id="1496" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1492" class="Bound">x</a>
<a id="1498" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="1512" class="Symbol">{</a><a id="1513" href="Ledger.GovernanceActions.html#814" class="InductiveConstructor">NewConstitution</a><a id="1528" class="Symbol">}</a>  <a id="1531" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1531" class="Bound">x</a> <a id="1533" class="Symbol">=</a> <a id="1535" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1531" class="Bound">x</a>
<a id="1537" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="1551" class="Symbol">{</a><a id="1552" href="Ledger.GovernanceActions.html#849" class="InductiveConstructor">TriggerHF</a><a id="1561" class="Symbol">}</a>        <a id="1570" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1570" class="Bound">x</a> <a id="1572" class="Symbol">=</a> <a id="1574" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1570" class="Bound">x</a>
<a id="1576" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="1590" class="Symbol">{</a><a id="1591" href="Ledger.GovernanceActions.html#884" class="InductiveConstructor">ChangePParams</a><a id="1604" class="Symbol">}</a>    <a id="1609" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1609" class="Bound">x</a> <a id="1611" class="Symbol">=</a> <a id="1613" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1609" class="Bound">x</a>
<a id="1615" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="1629" class="Symbol">{</a><a id="1630" href="Ledger.GovernanceActions.html#919" class="InductiveConstructor">TreasuryWdrl</a><a id="1642" class="Symbol">}</a>     <a id="1648" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1648" class="Bound">x</a> <a id="1650" class="Symbol">=</a> <a id="1652" class="Number">0</a> <a id="1654" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1656" class="Number">0</a>
<a id="1658" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="1672" class="Symbol">{</a><a id="1673" href="Ledger.GovernanceActions.html#954" class="InductiveConstructor">Info</a><a id="1677" class="Symbol">}</a>             <a id="1691" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1691" class="Bound">x</a> <a id="1693" class="Symbol">=</a> <a id="1695" class="Number">0</a> <a id="1697" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1699" class="Number">0</a>

<a id="1702" class="Comment">-- Then we define non-dependent versions of the types that use</a>
<a id="1765" class="Comment">-- NeedsHash.</a>

<a id="1780" class="Keyword">record</a> <a id="GovProposal&#39;"></a><a id="1787" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1787" class="Record">GovProposal&#39;</a> <a id="1800" class="Symbol">:</a> <a id="1802" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1807" class="Keyword">where</a>
  <a id="1815" class="Keyword">field</a>
    <a id="GovProposal&#39;.action"></a><a id="1825" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1825" class="Field">action</a>      <a id="1837" class="Symbol">:</a> <a id="1839" href="Ledger.Conway.Foreign.HSLedger.GovernanceActions.html#454" class="Datatype">GovAction&#39;</a>
    <a id="GovProposal&#39;.prevAction"></a><a id="1854" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1854" class="Field">prevAction</a>  <a id="1866" class="Symbol">:</a> <a id="1868" href="Ledger.GovernanceActions.html#428" class="Function">GovActionID</a>       <a id="1886" class="Comment">-- NeedsHash action</a>
    <a id="GovProposal&#39;.policy"></a><a id="1910" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1910" class="Field">policy</a>      <a id="1922" class="Symbol">:</a> <a id="1924" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1930" href="Ledger.Crypto.html#1166" class="Function">ScriptHash</a>
    <a id="GovProposal&#39;.deposit"></a><a id="1945" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1945" class="Field">deposit</a>     <a id="1957" class="Symbol">:</a> <a id="1959" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="GovProposal&#39;.returnAddr"></a><a id="1968" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1968" class="Field">returnAddr</a>  <a id="1980" class="Symbol">:</a> <a id="1982" href="Ledger.Address.html#1336" class="Record">RwdAddr</a>
    <a id="GovProposal&#39;.anchor"></a><a id="1994" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1994" class="Field">anchor</a>      <a id="2006" class="Symbol">:</a> <a id="2008" href="Ledger.GovernanceActions.html#642" class="Record">Anchor</a>

<a id="2016" class="Keyword">record</a> <a id="GovActionState&#39;"></a><a id="2023" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2023" class="Record">GovActionState&#39;</a> <a id="2039" class="Symbol">:</a> <a id="2041" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2046" class="Keyword">where</a>
  <a id="2054" class="Keyword">field</a>
    <a id="GovActionState&#39;.votes"></a><a id="2064" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2064" class="Field">votes</a>       <a id="2076" class="Symbol">:</a> <a id="2078" href="Ledger.GovernanceActions.html#392" class="Function">Voter</a> <a id="2084" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="2086" href="Ledger.GovernanceActions.html#2176" class="Datatype">Vote</a>
    <a id="GovActionState&#39;.returnAddr"></a><a id="2095" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2095" class="Field">returnAddr</a>  <a id="2107" class="Symbol">:</a> <a id="2109" href="Ledger.Address.html#1336" class="Record">RwdAddr</a>
    <a id="GovActionState&#39;.expiresIn"></a><a id="2121" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2121" class="Field">expiresIn</a>   <a id="2133" class="Symbol">:</a> <a id="2135" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a>
    <a id="GovActionState&#39;.action"></a><a id="2145" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2145" class="Field">action</a>      <a id="2157" class="Symbol">:</a> <a id="2159" href="Ledger.Conway.Foreign.HSLedger.GovernanceActions.html#454" class="Datatype">GovAction&#39;</a>
    <a id="GovActionState&#39;.prevAction"></a><a id="2174" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2174" class="Field">prevAction</a>  <a id="2186" class="Symbol">:</a> <a id="2188" href="Ledger.GovernanceActions.html#428" class="Function">GovActionID</a>       <a id="2206" class="Comment">-- NeedsHash action</a>

<a id="2227" class="Comment">-- We can convert between the dependent and non-dependent versions</a>
<a id="2294" class="Comment">-- using to/fromNeedsHash.</a>

<a id="2322" class="Keyword">private</a>
  <a id="mkGovProposal&#39;"></a><a id="2332" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2332" class="Function">mkGovProposal&#39;</a> <a id="2347" class="Symbol">:</a> <a id="2349" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2361" href="Ledger.GovernanceActions.html#2372" class="Record">GovProposal</a> <a id="2373" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1787" class="Record">GovProposal&#39;</a>
  <a id="2388" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2332" class="Function">mkGovProposal&#39;</a> <a id="2403" class="Symbol">=</a> <a id="2405" class="Symbol">λ</a> <a id="2407" class="Keyword">where</a>
    <a id="2417" class="Symbol">.</a><a id="2418" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2423" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2423" class="Bound">p</a> <a id="2425" class="Symbol">→</a> <a id="2427" class="Keyword">let</a> <a id="2431" class="Keyword">module</a> <a id="p"></a><a id="2438" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2438" class="Module">p</a> <a id="2440" class="Symbol">=</a> <a id="2442" href="Ledger.GovernanceActions.html#2372" class="Module">GovProposal</a>  <a id="2455" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2423" class="Bound">p</a> <a id="2457" class="Keyword">in</a> <a id="2460" class="Keyword">record</a> <a id="2467" class="Symbol">{</a> <a id="2469" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2438" class="Module">p</a><a id="2470" class="Symbol">;</a> <a id="2472" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1825" class="Field">action</a> <a id="2479" class="Symbol">=</a> <a id="2481" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2484" href="Ledger.GovernanceActions.html#2409" class="Field">p.action</a>  <a id="2494" class="Symbol">;</a> <a id="2496" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1854" class="Field">prevAction</a> <a id="2507" class="Symbol">=</a> <a id="2509" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="2523" href="Ledger.GovernanceActions.html#2437" class="Field">p.prevAction</a> <a id="2536" class="Symbol">}</a>
    <a id="2542" class="Symbol">.</a><a id="2543" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2548" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2548" class="Bound">p</a> <a id="2550" class="Symbol">→</a> <a id="2552" class="Keyword">let</a> <a id="2556" class="Keyword">module</a> <a id="p"></a><a id="2563" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2563" class="Module">p</a> <a id="2565" class="Symbol">=</a> <a id="2567" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1787" class="Module">GovProposal&#39;</a> <a id="2580" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2548" class="Bound">p</a> <a id="2582" class="Keyword">in</a> <a id="2585" class="Keyword">record</a> <a id="2592" class="Symbol">{</a> <a id="2594" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2563" class="Module">p</a><a id="2595" class="Symbol">;</a> <a id="2597" href="Ledger.GovernanceActions.html#2409" class="Field">action</a> <a id="2604" class="Symbol">=</a> <a id="2606" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2611" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1825" class="Field">p.action</a><a id="2619" class="Symbol">;</a> <a id="2621" href="Ledger.GovernanceActions.html#2437" class="Field">prevAction</a> <a id="2632" class="Symbol">=</a> <a id="2634" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a>   <a id="2648" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1854" class="Field">p.prevAction</a> <a id="2661" class="Symbol">}</a>

  <a id="mkGovActionState&#39;"></a><a id="2666" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2666" class="Function">mkGovActionState&#39;</a> <a id="2684" class="Symbol">:</a> <a id="2686" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2698" href="Ledger.GovernanceActions.html#2594" class="Record">GovActionState</a> <a id="2713" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2023" class="Record">GovActionState&#39;</a>
  <a id="2731" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2666" class="Function">mkGovActionState&#39;</a> <a id="2749" class="Symbol">=</a> <a id="2751" class="Symbol">λ</a> <a id="2753" class="Keyword">where</a>
    <a id="2763" class="Symbol">.</a><a id="2764" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2769" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2769" class="Bound">s</a> <a id="2771" class="Symbol">→</a> <a id="2773" class="Keyword">let</a> <a id="2777" class="Keyword">module</a> <a id="s"></a><a id="2784" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2784" class="Module">s</a> <a id="2786" class="Symbol">=</a> <a id="2788" href="Ledger.GovernanceActions.html#2594" class="Module">GovActionState</a>  <a id="2804" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2769" class="Bound">s</a> <a id="2806" class="Keyword">in</a> <a id="2809" class="Keyword">record</a><a id="2815" class="Symbol">{</a> <a id="2817" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2784" class="Module">s</a><a id="2818" class="Symbol">;</a> <a id="2820" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2145" class="Field">action</a> <a id="2827" class="Symbol">=</a> <a id="2829" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2832" href="Ledger.GovernanceActions.html#2715" class="Field">s.action</a>  <a id="2842" class="Symbol">;</a> <a id="2844" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2174" class="Field">prevAction</a> <a id="2855" class="Symbol">=</a> <a id="2857" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1360" class="Function">fromNeedsHash</a> <a id="2871" href="Ledger.GovernanceActions.html#2743" class="Field">s.prevAction</a> <a id="2884" class="Symbol">}</a>
    <a id="2890" class="Symbol">.</a><a id="2891" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2896" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2896" class="Bound">s</a> <a id="2898" class="Symbol">→</a> <a id="2900" class="Keyword">let</a> <a id="2904" class="Keyword">module</a> <a id="s"></a><a id="2911" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2911" class="Module">s</a> <a id="2913" class="Symbol">=</a> <a id="2915" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2023" class="Module">GovActionState&#39;</a> <a id="2931" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2896" class="Bound">s</a> <a id="2933" class="Keyword">in</a> <a id="2936" class="Keyword">record</a><a id="2942" class="Symbol">{</a> <a id="2944" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2911" class="Module">s</a><a id="2945" class="Symbol">;</a> <a id="2947" href="Ledger.GovernanceActions.html#2715" class="Field">action</a> <a id="2954" class="Symbol">=</a> <a id="2956" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2961" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2145" class="Field">s.action</a><a id="2969" class="Symbol">;</a> <a id="2971" href="Ledger.GovernanceActions.html#2743" class="Field">prevAction</a> <a id="2982" class="Symbol">=</a> <a id="2984" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1040" class="Function">toNeedsHash</a>   <a id="2998" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2174" class="Field">s.prevAction</a> <a id="3011" class="Symbol">}</a>

<a id="3014" class="Comment">-- Auto-generated conversions for the non-dependent types</a>

<a id="3073" class="Keyword">instance</a>
  <a id="HsTy-GovProposal&#39;"></a><a id="3084" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3084" class="Function">HsTy-GovProposal&#39;</a> <a id="3102" class="Symbol">=</a> <a id="3104" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3115" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1787" class="Record">GovProposal&#39;</a> <a id="3128" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3130" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3139" class="String">&quot;GovProposal&quot;</a>
                                              <a id="3199" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3201" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3217" class="String">&quot;MkGovProposal&quot;</a>
                                              <a id="3279" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3281" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3293" class="String">&quot;gp&quot;</a>
  <a id="Conv-GovProposal&#39;"></a><a id="3300" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3300" class="Function">Conv-GovProposal&#39;</a> <a id="3318" class="Symbol">=</a> <a id="3320" href="Foreign.Convertible.Deriving.html#6819" class="Macro">autoConvert</a> <a id="3332" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1787" class="Record">GovProposal&#39;</a>

  <a id="HsTy-GovActionState&#39;"></a><a id="3348" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3348" class="Function">HsTy-GovActionState&#39;</a> <a id="3369" class="Symbol">=</a> <a id="3371" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3382" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2023" class="Record">GovActionState&#39;</a> <a id="3398" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3400" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3409" class="String">&quot;GovActionState&quot;</a>
                                                    <a id="3478" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3480" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3496" class="String">&quot;MkGovActionState&quot;</a>
                                                    <a id="3567" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3569" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3581" class="String">&quot;gas&quot;</a>
  <a id="Conv-GovActionState&#39;"></a><a id="3589" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3589" class="Function">Conv-GovActionState&#39;</a> <a id="3610" class="Symbol">=</a> <a id="3612" href="Foreign.Convertible.Deriving.html#6819" class="Macro">autoConvert</a> <a id="3624" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2023" class="Record">GovActionState&#39;</a>

<a id="3641" class="Comment">-- And finally we compose everything into conversions for the dependent types</a>

<a id="3720" class="Keyword">instance</a>
  <a id="HsTy-GovProposal"></a><a id="3731" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3731" class="Function">HsTy-GovProposal</a> <a id="3748" class="Symbol">=</a> <a id="3750" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3759" href="Ledger.GovernanceActions.html#2372" class="Record">GovProposal</a> <a id="3771" class="Symbol">(</a><a id="3772" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3779" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1787" class="Record">GovProposal&#39;</a><a id="3791" class="Symbol">)</a>
  <a id="Conv-GovProposal"></a><a id="3795" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3795" class="Function">Conv-GovProposal</a> <a id="3812" class="Symbol">=</a> <a id="3814" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2332" class="Function">mkGovProposal&#39;</a> <a id="3829" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="3831" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3300" class="Function">Conv-GovProposal&#39;</a>

  <a id="HsTy-GovActionState"></a><a id="3852" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3852" class="Function">HsTy-GovActionState</a> <a id="3872" class="Symbol">=</a> <a id="3874" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3883" href="Ledger.GovernanceActions.html#2594" class="Record">GovActionState</a> <a id="3898" class="Symbol">(</a><a id="3899" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3906" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2023" class="Record">GovActionState&#39;</a><a id="3921" class="Symbol">)</a>
  <a id="Conv-GovActionState"></a><a id="3925" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3925" class="Function">Conv-GovActionState</a> <a id="3945" class="Symbol">=</a> <a id="3947" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2666" class="Function">mkGovActionState&#39;</a> <a id="3965" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="3967" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3589" class="Function">Conv-GovActionState&#39;</a>

<a id="3989" class="Keyword">unquoteDecl</a> <a id="4001" class="Symbol">=</a> <a id="4003" class="Keyword">do</a>
  hsTypeAlias GovActionID
  hsTypeAlias GovState
  hsTypeAlias Voter

<a id="4076" class="Comment">-- Computational function</a>

<a id="gov-step"></a><a id="4103" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4103" class="Function">gov-step</a> <a id="4112" class="Symbol">:</a> <a id="4114" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4121" class="Symbol">(</a><a id="4122" href="Ledger.Conway.Conformance.Gov.html#703" class="Record">GovEnv</a> <a id="4129" class="Symbol">→</a> <a id="4131" href="Ledger.Gov.html#1334" class="Function">GovState</a> <a id="4140" class="Symbol">→</a> <a id="4142" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4147" class="Symbol">(</a><a id="4148" href="Ledger.GovernanceActions.html#2227" class="Record">GovVote</a> <a id="4156" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4158" href="Ledger.GovernanceActions.html#2372" class="Record">GovProposal</a><a id="4169" class="Symbol">)</a> <a id="4171" class="Symbol">→</a> <a id="4173" href="Interface.ComputationalRelation.html#235" class="Datatype">ComputationResult</a> <a id="4191" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4198" href="Ledger.Gov.html#1334" class="Function">GovState</a><a id="4206" class="Symbol">)</a>
<a id="4208" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4103" class="Function">gov-step</a> <a id="4217" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4217" class="Bound">Γ</a> <a id="4219" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4219" class="Bound">govSt</a> <a id="4225" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4225" class="Bound">gvps</a> <a id="4230" class="Symbol">=</a> <a id="4232" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="4235" class="Symbol">(</a><a id="4236" href="Interface.ComputationalRelation.html#2976" class="Function">compute</a> <a id="4244" href="Ledger.Gov.Properties.html#7433" class="Function">Computational-GOVS</a> <a id="4263" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="4265" href="Ledger.Conway.Conformance.Gov.html#735" class="Function">txid</a> <a id="4270" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4272" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4413" class="Function">e&#39;</a> <a id="4275" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4277" href="Ledger.Conway.Conformance.Gov.html#782" class="Function">pparams</a> <a id="4285" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4287" href="Ledger.Conway.Conformance.Gov.html#808" class="Function">ppolicy</a> <a id="4295" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4297" href="Ledger.Conway.Conformance.Gov.html#843" class="Function">enactState</a> <a id="4308" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4310" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="4313" href="Ledger.Conway.Conformance.Gov.html#872" class="Function">certState</a> <a id="4323" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4325" href="Ledger.Conway.Conformance.Gov.html#900" class="Function">rewardCreds</a> <a id="4337" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a> <a id="4339" class="Symbol">(</a><a id="4340" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4345" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4219" class="Bound">govSt</a><a id="4350" class="Symbol">)</a> <a id="4352" class="Symbol">(</a><a id="4353" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4358" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4225" class="Bound">gvps</a><a id="4362" class="Symbol">))</a>
  <a id="4367" class="Keyword">where</a> <a id="4373" class="Keyword">open</a> <a id="4378" href="Ledger.Conway.Conformance.Gov.html#703" class="Module">GovEnv</a> <a id="4385" class="Symbol">(</a><a id="4386" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4391" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4217" class="Bound">Γ</a><a id="4392" class="Symbol">)</a> <a id="4394" class="Keyword">renaming</a> <a id="4403" class="Symbol">(</a><a id="4404" href="Ledger.Conway.Conformance.Gov.html#758" class="Field">epoch</a> <a id="4410" class="Symbol">to</a> <a id="4413" class="Field">e&#39;</a><a id="4415" class="Symbol">)</a>

<a id="4418" class="Symbol">{-#</a> <a id="4422" class="Keyword">COMPILE</a> <a id="4430" class="Keyword">GHC</a> <a id="4434" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4103" class="Function">gov-step</a> <a id="4443" class="Pragma">as</a> <a id="4446" class="Pragma">govStep</a> <a id="4454" class="Symbol">#-}</a>
</pre></body></html>