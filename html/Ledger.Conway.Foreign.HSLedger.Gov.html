<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Foreign.HSLedger.Gov</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css"><link rel="stylesheet" href="Agda.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js"></script><script src="AgdaKaTeX.js" defer=""></script></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Ledger.Conway.Foreign.HSLedger.Gov.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov</a> <a id="43" class="Keyword">where</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="77" class="Keyword">using</a> <a id="83" class="Symbol">(</a><a id="84" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="88" class="Symbol">)</a>

<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Ledger.Conway.Foreign.HSLedger.Address.html" class="Module">Ledger.Conway.Foreign.HSLedger.Address</a>
<a id="142" class="Keyword">open</a> <a id="147" class="Keyword">import</a> <a id="154" href="Ledger.Conway.Foreign.HSLedger.BaseTypes.html" class="Module">Ledger.Conway.Foreign.HSLedger.BaseTypes</a>
<a id="195" class="Keyword">open</a> <a id="200" class="Keyword">import</a> <a id="207" href="Ledger.Conway.Foreign.HSLedger.Enact.html" class="Module">Ledger.Conway.Foreign.HSLedger.Enact</a>
<a id="244" class="Keyword">open</a> <a id="249" class="Keyword">import</a> <a id="256" href="Ledger.Conway.Foreign.HSLedger.PParams.html" class="Module">Ledger.Conway.Foreign.HSLedger.PParams</a>
<a id="295" class="Keyword">open</a> <a id="300" class="Keyword">import</a> <a id="307" href="Ledger.Conway.Foreign.HSLedger.Gov.Core.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Core</a>
<a id="347" class="Keyword">open</a> <a id="352" class="Keyword">import</a> <a id="359" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html" class="Module">Ledger.Conway.Foreign.HSLedger.Gov.Actions</a>
<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Ledger.Conway.Foreign.HSLedger.Cert.html" class="Module">Ledger.Conway.Foreign.HSLedger.Cert</a>

<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="495" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="Ledger.Conway.Specification.Enact.html" class="Module">Ledger.Conway.Specification.Enact</a> <a id="554" href="Ledger.Conway.Specification.Transaction.html#2077" class="Function">govStructure</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Ledger.Conway.Conformance.Gov.html" class="Module">Ledger.Conway.Conformance.Gov</a> <a id="609" href="Function.Base.html#4755" class="Function">it</a> <a id="612" href="Function.Base.html#4755" class="Function">it</a>
<a id="615" class="Keyword">import</a> <a id="622" href="Ledger.Conway.Specification.Gov.html" class="Module">Ledger.Conway.Specification.Gov</a> <a id="654" href="Function.Base.html#4755" class="Function">it</a> <a id="657" class="Symbol">as</a> <a id="L"></a><a id="660" href="Ledger.Conway.Foreign.HSLedger.Gov.html#660" class="Module">L</a>
<a id="662" class="Keyword">open</a> <a id="667" class="Keyword">import</a> <a id="674" href="Ledger.Conway.Specification.Gov.Properties.Computational.html" class="Module">Ledger.Conway.Specification.Gov.Properties.Computational</a> <a id="731" href="Function.Base.html#4755" class="Function">it</a>

<a id="735" class="Keyword">instance</a>

  <a id="HsTy-GovEnv"></a><a id="747" href="Ledger.Conway.Foreign.HSLedger.Gov.html#747" class="Function">HsTy-GovEnv</a> <a id="759" class="Symbol">=</a> <a id="761" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="772" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="779" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="781" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="797" class="String">&quot;MkGovEnv&quot;</a>
                                  <a id="842" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="844" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="856" class="String">&quot;ge&quot;</a>
  <a id="Conv-GovEnv"></a><a id="863" href="Ledger.Conway.Foreign.HSLedger.Gov.html#863" class="Function">Conv-GovEnv</a> <a id="875" class="Symbol">=</a> <a id="877" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="889" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a>

<a id="897" class="Comment">-- NeedsHash depends on a GovAction, so a little bit of manual work is</a>
<a id="968" class="Comment">-- required to get the types using it into Haskell.</a>

<a id="1021" class="Comment">-- First we define to/fromNeedsHash that replaces the ⊤ cases by a</a>
<a id="1088" class="Comment">-- dummy GovActionID.</a>

<a id="toNeedsHash"></a><a id="1111" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1123" class="Symbol">:</a> <a id="1125" class="Symbol">∀</a> <a id="1127" class="Symbol">{</a><a id="1128" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1128" class="Bound">action</a><a id="1134" class="Symbol">}</a> <a id="1136" class="Symbol">→</a> <a id="1138" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a> <a id="1150" class="Symbol">→</a> <a id="1152" href="Ledger.Conway.Specification.Gov.Actions.html#2533" class="Function">NeedsHash</a> <a id="1162" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1128" class="Bound">action</a>
<a id="1169" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1181" class="Symbol">{</a><a id="1182" href="Ledger.Conway.Specification.Gov.Actions.html#997" class="InductiveConstructor">NoConfidence</a><a id="1194" class="Symbol">}</a>        <a id="1203" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1203" class="Bound">x</a> <a id="1205" class="Symbol">=</a> <a id="1207" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1203" class="Bound">x</a>
<a id="1209" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1221" class="Symbol">{</a><a id="1222" href="Ledger.Conway.Specification.Gov.Actions.html#1035" class="InductiveConstructor">UpdateCommittee</a><a id="1237" class="Symbol">}</a>     <a id="1243" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1243" class="Bound">x</a> <a id="1245" class="Symbol">=</a> <a id="1247" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1243" class="Bound">x</a>
<a id="1249" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1261" class="Symbol">{</a><a id="1262" href="Ledger.Conway.Specification.Gov.Actions.html#1073" class="InductiveConstructor">NewConstitution</a><a id="1277" class="Symbol">}</a>     <a id="1283" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1283" class="Bound">x</a> <a id="1285" class="Symbol">=</a> <a id="1287" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1283" class="Bound">x</a>
<a id="1289" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1301" class="Symbol">{</a><a id="1302" href="Ledger.Conway.Specification.Gov.Actions.html#1111" class="InductiveConstructor">TriggerHardFork</a><a id="1317" class="Symbol">}</a>     <a id="1323" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1323" class="Bound">x</a> <a id="1325" class="Symbol">=</a> <a id="1327" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1323" class="Bound">x</a>
<a id="1329" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1341" class="Symbol">{</a><a id="1342" href="Ledger.Conway.Specification.Gov.Actions.html#1149" class="InductiveConstructor">ChangePParams</a><a id="1355" class="Symbol">}</a>       <a id="1363" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1363" class="Bound">x</a> <a id="1365" class="Symbol">=</a> <a id="1367" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1363" class="Bound">x</a>
<a id="1369" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1381" class="Symbol">{</a><a id="1382" href="Ledger.Conway.Specification.Gov.Actions.html#1187" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1400" class="Symbol">}</a>  <a id="1403" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1403" class="Bound">x</a> <a id="1405" class="Symbol">=</a> <a id="1407" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>
<a id="1410" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a> <a id="1422" class="Symbol">{</a><a id="1423" href="Ledger.Conway.Specification.Gov.Actions.html#1225" class="InductiveConstructor">Info</a><a id="1427" class="Symbol">}</a>                <a id="1444" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1444" class="Bound">x</a> <a id="1446" class="Symbol">=</a> <a id="1448" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a>

<a id="fromNeedsHash"></a><a id="1452" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1466" class="Symbol">:</a> <a id="1468" class="Symbol">∀</a> <a id="1470" class="Symbol">{</a><a id="1471" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1471" class="Bound">action</a><a id="1477" class="Symbol">}</a> <a id="1479" class="Symbol">→</a> <a id="1481" href="Ledger.Conway.Specification.Gov.Actions.html#2533" class="Function">NeedsHash</a> <a id="1491" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1471" class="Bound">action</a> <a id="1498" class="Symbol">→</a> <a id="1500" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a>
<a id="1512" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1526" class="Symbol">{</a><a id="1527" href="Ledger.Conway.Specification.Gov.Actions.html#997" class="InductiveConstructor">NoConfidence</a><a id="1539" class="Symbol">}</a>        <a id="1548" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1548" class="Bound">x</a> <a id="1550" class="Symbol">=</a> <a id="1552" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1548" class="Bound">x</a>
<a id="1554" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1568" class="Symbol">{</a><a id="1569" href="Ledger.Conway.Specification.Gov.Actions.html#1035" class="InductiveConstructor">UpdateCommittee</a><a id="1584" class="Symbol">}</a>     <a id="1590" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1590" class="Bound">x</a> <a id="1592" class="Symbol">=</a> <a id="1594" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1590" class="Bound">x</a>
<a id="1596" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1610" class="Symbol">{</a><a id="1611" href="Ledger.Conway.Specification.Gov.Actions.html#1073" class="InductiveConstructor">NewConstitution</a><a id="1626" class="Symbol">}</a>     <a id="1632" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1632" class="Bound">x</a> <a id="1634" class="Symbol">=</a> <a id="1636" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1632" class="Bound">x</a>
<a id="1638" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1652" class="Symbol">{</a><a id="1653" href="Ledger.Conway.Specification.Gov.Actions.html#1111" class="InductiveConstructor">TriggerHardFork</a><a id="1668" class="Symbol">}</a>     <a id="1674" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1674" class="Bound">x</a> <a id="1676" class="Symbol">=</a> <a id="1678" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1674" class="Bound">x</a>
<a id="1680" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1694" class="Symbol">{</a><a id="1695" href="Ledger.Conway.Specification.Gov.Actions.html#1149" class="InductiveConstructor">ChangePParams</a><a id="1708" class="Symbol">}</a>       <a id="1716" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1716" class="Bound">x</a> <a id="1718" class="Symbol">=</a> <a id="1720" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1716" class="Bound">x</a>
<a id="1722" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1736" class="Symbol">{</a><a id="1737" href="Ledger.Conway.Specification.Gov.Actions.html#1187" class="InductiveConstructor">TreasuryWithdrawal</a><a id="1755" class="Symbol">}</a>  <a id="1758" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1758" class="Bound">x</a> <a id="1760" class="Symbol">=</a> <a id="1762" class="Number">0</a> <a id="1764" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1766" class="Number">0</a>
<a id="1768" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="1782" class="Symbol">{</a><a id="1783" href="Ledger.Conway.Specification.Gov.Actions.html#1225" class="InductiveConstructor">Info</a><a id="1787" class="Symbol">}</a>                <a id="1804" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1804" class="Bound">x</a> <a id="1806" class="Symbol">=</a> <a id="1808" class="Number">0</a> <a id="1810" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1812" class="Number">0</a>

<a id="1815" class="Comment">-- Then we define non-dependent versions of the types that use</a>
<a id="1878" class="Comment">-- NeedsHash.</a>

<a id="1893" class="Keyword">record</a> <a id="GovProposal&#39;"></a><a id="1900" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a> <a id="1913" class="Symbol">:</a> <a id="1915" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1920" class="Keyword">where</a>
  <a id="1928" class="Keyword">field</a>
    <a id="GovProposal&#39;.action"></a><a id="1938" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1938" class="Field">action</a>      <a id="1950" class="Symbol">:</a> <a id="1952" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovProposal&#39;.prevAction"></a><a id="1967" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1967" class="Field">prevAction</a>  <a id="1979" class="Symbol">:</a> <a id="1981" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a>       <a id="1999" class="Comment">-- NeedsHash action</a>
    <a id="GovProposal&#39;.policy"></a><a id="2023" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2023" class="Field">policy</a>      <a id="2035" class="Symbol">:</a> <a id="2037" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2043" href="Ledger.Core.Specification.Crypto.html#1242" class="Function">ScriptHash</a>
    <a id="GovProposal&#39;.deposit"></a><a id="2058" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2058" class="Field">deposit</a>     <a id="2070" class="Symbol">:</a> <a id="2072" href="Ledger.Prelude.Base.html#154" class="Function">Coin</a>
    <a id="GovProposal&#39;.returnAddr"></a><a id="2081" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2081" class="Field">returnAddr</a>  <a id="2093" class="Symbol">:</a> <a id="2095" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
    <a id="GovProposal&#39;.anchor"></a><a id="2107" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2107" class="Field">anchor</a>      <a id="2119" class="Symbol">:</a> <a id="2121" href="Ledger.Conway.Specification.Gov.Actions.html#895" class="Record">Anchor</a>

<a id="2129" class="Keyword">record</a> <a id="GovActionState&#39;"></a><a id="2136" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2136" class="Record">GovActionState&#39;</a> <a id="2152" class="Symbol">:</a> <a id="2154" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2159" class="Keyword">where</a>
  <a id="2167" class="Keyword">field</a>
    <a id="GovActionState&#39;.votes"></a><a id="2177" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2177" class="Field">votes</a>       <a id="2189" class="Symbol">:</a> <a id="2191" href="Ledger.Conway.Specification.Gov.Actions.html#3640" class="Record">GovVotes</a>
    <a id="GovActionState&#39;.returnAddr"></a><a id="2204" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2204" class="Field">returnAddr</a>  <a id="2216" class="Symbol">:</a> <a id="2218" href="Ledger.Core.Specification.Address.html#1324" class="Record">RwdAddr</a>
    <a id="GovActionState&#39;.expiresIn"></a><a id="2230" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2230" class="Field">expiresIn</a>   <a id="2242" class="Symbol">:</a> <a id="2244" href="Ledger.Core.Specification.Epoch.html#598" class="Function">Epoch</a>
    <a id="GovActionState&#39;.action"></a><a id="2254" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2254" class="Field">action</a>      <a id="2266" class="Symbol">:</a> <a id="2268" href="Ledger.Conway.Foreign.HSLedger.Gov.Actions.html#473" class="Datatype">GovAction&#39;</a>
    <a id="GovActionState&#39;.prevAction"></a><a id="2283" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2283" class="Field">prevAction</a>  <a id="2295" class="Symbol">:</a> <a id="2297" href="Ledger.Conway.Specification.Gov.Actions.html#798" class="Function">GovActionID</a>       <a id="2315" class="Comment">-- NeedsHash action</a>

<a id="2336" class="Comment">-- We can convert between the dependent and non-dependent versions</a>
<a id="2403" class="Comment">-- using to/fromNeedsHash.</a>

<a id="2431" class="Keyword">private</a>
  <a id="mkGovProposal&#39;"></a><a id="2441" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2441" class="Function">mkGovProposal&#39;</a> <a id="2456" class="Symbol">:</a> <a id="2458" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2470" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Record">GovProposal</a> <a id="2482" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a>
  <a id="2497" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2441" class="Function">mkGovProposal&#39;</a> <a id="2512" class="Symbol">=</a> <a id="2514" class="Symbol">λ</a> <a id="2516" class="Keyword">where</a>
    <a id="2526" class="Symbol">.</a><a id="2527" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2532" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2532" class="Bound">p</a> <a id="2534" class="Symbol">→</a> <a id="2536" class="Keyword">let</a> <a id="2540" class="Keyword">module</a> <a id="p"></a><a id="2547" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2547" class="Module">p</a> <a id="2549" class="Symbol">=</a> <a id="2551" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Module">GovProposal</a>  <a id="2564" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2532" class="Bound">p</a> <a id="2566" class="Keyword">in</a> <a id="2569" class="Keyword">record</a> <a id="2576" class="Symbol">{</a> <a id="2578" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2547" class="Module">p</a><a id="2579" class="Symbol">;</a> <a id="2581" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1938" class="Field">action</a> <a id="2588" class="Symbol">=</a> <a id="2590" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2593" href="Ledger.Conway.Specification.Gov.Actions.html#3455" class="Field">p.action</a>  <a id="2603" class="Symbol">;</a> <a id="2605" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1967" class="Field">prevAction</a> <a id="2616" class="Symbol">=</a> <a id="2618" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="2632" href="Ledger.Conway.Specification.Gov.Actions.html#3483" class="Field">p.prevAction</a> <a id="2645" class="Symbol">}</a>
    <a id="2651" class="Symbol">.</a><a id="2652" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2657" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2657" class="Bound">p</a> <a id="2659" class="Symbol">→</a> <a id="2661" class="Keyword">let</a> <a id="2665" class="Keyword">module</a> <a id="p"></a><a id="2672" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2672" class="Module">p</a> <a id="2674" class="Symbol">=</a> <a id="2676" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Module">GovProposal&#39;</a> <a id="2689" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2657" class="Bound">p</a> <a id="2691" class="Keyword">in</a> <a id="2694" class="Keyword">record</a> <a id="2701" class="Symbol">{</a> <a id="2703" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2672" class="Module">p</a><a id="2704" class="Symbol">;</a> <a id="2706" href="Ledger.Conway.Specification.Gov.Actions.html#3455" class="Field">action</a> <a id="2713" class="Symbol">=</a> <a id="2715" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="2720" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1938" class="Field">p.action</a><a id="2728" class="Symbol">;</a> <a id="2730" href="Ledger.Conway.Specification.Gov.Actions.html#3483" class="Field">prevAction</a> <a id="2741" class="Symbol">=</a> <a id="2743" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a>   <a id="2757" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1967" class="Field">p.prevAction</a> <a id="2770" class="Symbol">}</a>

  <a id="mkGovActionState&#39;"></a><a id="2775" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2775" class="Function">mkGovActionState&#39;</a> <a id="2793" class="Symbol">:</a> <a id="2795" href="Foreign.Convertible.html#103" class="Record">Convertible</a> <a id="2807" href="Ledger.Conway.Specification.Gov.Actions.html#3768" class="Record">GovActionState</a> <a id="2822" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2136" class="Record">GovActionState&#39;</a>
  <a id="2840" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2775" class="Function">mkGovActionState&#39;</a> <a id="2858" class="Symbol">=</a> <a id="2860" class="Symbol">λ</a> <a id="2862" class="Keyword">where</a>
    <a id="2872" class="Symbol">.</a><a id="2873" href="Foreign.Convertible.html#149" class="Field">to</a>   <a id="2878" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2878" class="Bound">s</a> <a id="2880" class="Symbol">→</a> <a id="2882" class="Keyword">let</a> <a id="2886" class="Keyword">module</a> <a id="s"></a><a id="2893" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2893" class="Module">s</a> <a id="2895" class="Symbol">=</a> <a id="2897" href="Ledger.Conway.Specification.Gov.Actions.html#3768" class="Module">GovActionState</a>  <a id="2913" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2878" class="Bound">s</a> <a id="2915" class="Keyword">in</a> <a id="2918" class="Keyword">record</a><a id="2924" class="Symbol">{</a> <a id="2926" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2893" class="Module">s</a><a id="2927" class="Symbol">;</a> <a id="2929" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2254" class="Field">action</a> <a id="2936" class="Symbol">=</a> <a id="2938" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="2941" href="Ledger.Conway.Specification.Gov.Actions.html#3885" class="Field">s.action</a>  <a id="2951" class="Symbol">;</a> <a id="2953" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2283" class="Field">prevAction</a> <a id="2964" class="Symbol">=</a> <a id="2966" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1452" class="Function">fromNeedsHash</a> <a id="2980" href="Ledger.Conway.Specification.Gov.Actions.html#3913" class="Field">s.prevAction</a> <a id="2993" class="Symbol">}</a>
    <a id="2999" class="Symbol">.</a><a id="3000" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3005" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3005" class="Bound">s</a> <a id="3007" class="Symbol">→</a> <a id="3009" class="Keyword">let</a> <a id="3013" class="Keyword">module</a> <a id="s"></a><a id="3020" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3020" class="Module">s</a> <a id="3022" class="Symbol">=</a> <a id="3024" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2136" class="Module">GovActionState&#39;</a> <a id="3040" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3005" class="Bound">s</a> <a id="3042" class="Keyword">in</a> <a id="3045" class="Keyword">record</a><a id="3051" class="Symbol">{</a> <a id="3053" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3020" class="Module">s</a><a id="3054" class="Symbol">;</a> <a id="3056" href="Ledger.Conway.Specification.Gov.Actions.html#3885" class="Field">action</a> <a id="3063" class="Symbol">=</a> <a id="3065" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="3070" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2254" class="Field">s.action</a><a id="3078" class="Symbol">;</a> <a id="3080" href="Ledger.Conway.Specification.Gov.Actions.html#3913" class="Field">prevAction</a> <a id="3091" class="Symbol">=</a> <a id="3093" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1111" class="Function">toNeedsHash</a>   <a id="3107" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2283" class="Field">s.prevAction</a> <a id="3120" class="Symbol">}</a>

<a id="3123" class="Comment">-- Auto-generated conversions for the non-dependent types</a>

<a id="3182" class="Keyword">instance</a>
  <a id="HsTy-GovProposal&#39;"></a><a id="3193" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3193" class="Function">HsTy-GovProposal&#39;</a> <a id="3211" class="Symbol">=</a> <a id="3213" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3224" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a> <a id="3237" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3239" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3248" class="String">&quot;GovProposal&quot;</a>
                                              <a id="3308" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3310" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3326" class="String">&quot;MkGovProposal&quot;</a>
                                              <a id="3388" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3390" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3402" class="String">&quot;gp&quot;</a>
  <a id="Conv-GovProposal&#39;"></a><a id="3409" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3409" class="Function">Conv-GovProposal&#39;</a> <a id="3427" class="Symbol">=</a> <a id="3429" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3441" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a>

  <a id="HsTy-GovActionState&#39;"></a><a id="3457" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3457" class="Function">HsTy-GovActionState&#39;</a> <a id="3478" class="Symbol">=</a> <a id="3480" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">autoHsType</a> <a id="3491" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2136" class="Record">GovActionState&#39;</a> <a id="3507" href="Foreign.HaskellTypes.Deriving.html#11530" class="Macro Operator">⊣</a> <a id="3509" href="Foreign.HaskellTypes.Deriving.html#3126" class="Function">withName</a> <a id="3518" class="String">&quot;GovActionState&quot;</a>
                                                    <a id="3587" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3589" href="Foreign.HaskellTypes.Deriving.html#3237" class="Function">withConstructor</a> <a id="3605" class="String">&quot;MkGovActionState&quot;</a>
                                                    <a id="3676" href="Foreign.HaskellTypes.Deriving.html#3523" class="Function Operator">•</a> <a id="3678" href="Foreign.HaskellTypes.Deriving.html#3419" class="Function">fieldPrefix</a> <a id="3690" class="String">&quot;gas&quot;</a>
  <a id="Conv-GovActionState&#39;"></a><a id="3698" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3698" class="Function">Conv-GovActionState&#39;</a> <a id="3719" class="Symbol">=</a> <a id="3721" href="Foreign.Convertible.Deriving.html#6814" class="Macro">autoConvert</a> <a id="3733" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2136" class="Record">GovActionState&#39;</a>

<a id="3750" class="Comment">-- And finally we compose everything into conversions for the dependent types</a>

<a id="3829" class="Keyword">instance</a>
  <a id="HsTy-GovProposal"></a><a id="3840" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3840" class="Function">HsTy-GovProposal</a> <a id="3857" class="Symbol">=</a> <a id="3859" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3868" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Record">GovProposal</a> <a id="3880" class="Symbol">(</a><a id="3881" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="3888" href="Ledger.Conway.Foreign.HSLedger.Gov.html#1900" class="Record">GovProposal&#39;</a><a id="3900" class="Symbol">)</a>
  <a id="Conv-GovProposal"></a><a id="3904" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3904" class="Function">Conv-GovProposal</a> <a id="3921" class="Symbol">=</a> <a id="3923" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2441" class="Function">mkGovProposal&#39;</a> <a id="3938" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="3940" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3409" class="Function">Conv-GovProposal&#39;</a>

  <a id="HsTy-GovActionState"></a><a id="3961" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3961" class="Function">HsTy-GovActionState</a> <a id="3981" class="Symbol">=</a> <a id="3983" href="Foreign.HaskellTypes.html#676" class="Function">MkHsType</a> <a id="3992" href="Ledger.Conway.Specification.Gov.Actions.html#3768" class="Record">GovActionState</a> <a id="4007" class="Symbol">(</a><a id="4008" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4015" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2136" class="Record">GovActionState&#39;</a><a id="4030" class="Symbol">)</a>
  <a id="Conv-GovActionState"></a><a id="4034" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4034" class="Function">Conv-GovActionState</a> <a id="4054" class="Symbol">=</a> <a id="4056" href="Ledger.Conway.Foreign.HSLedger.Gov.html#2775" class="Function">mkGovActionState&#39;</a> <a id="4074" href="Foreign.Convertible.html#959" class="Function Operator">⨾</a> <a id="4076" href="Ledger.Conway.Foreign.HSLedger.Gov.html#3698" class="Function">Conv-GovActionState&#39;</a>

<a id="4098" class="Keyword">unquoteDecl</a> <a id="4110" class="Symbol">=</a> <a id="4112" class="Keyword">do</a>
  hsTypeAlias GovActionID
  hsTypeAlias GovState
  hsTypeAlias GovVoter&#39;

<a id="4189" class="Comment">-- Computational function</a>

<a id="gov-step"></a><a id="4216" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4216" class="Function">gov-step</a> <a id="4225" class="Symbol">:</a> <a id="4227" href="Foreign.HaskellTypes.html#593" class="Function">HsType</a> <a id="4234" class="Symbol">(</a><a id="4235" href="Ledger.Conway.Conformance.Gov.html#829" class="Record">GovEnv</a> <a id="4242" class="Symbol">→</a> <a id="4244" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a> <a id="4253" class="Symbol">→</a> <a id="4255" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4260" class="Symbol">(</a><a id="4261" href="Ledger.Conway.Specification.Gov.Actions.html#3270" class="Record">GovVote</a> <a id="4269" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="4271" href="Ledger.Conway.Specification.Gov.Actions.html#3418" class="Record">GovProposal</a><a id="4282" class="Symbol">)</a> <a id="4284" class="Symbol">→</a> <a id="4286" href="Interface.ComputationalRelation.html#237" class="Datatype">ComputationResult</a> <a id="4304" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="4311" href="Ledger.Conway.Specification.Gov.html#1479" class="Function">GovState</a><a id="4319" class="Symbol">)</a>
<a id="4321" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4216" class="Function">gov-step</a> <a id="4330" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4330" class="Bound">Γ</a> <a id="4332" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4332" class="Bound">govSt</a> <a id="4338" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4338" class="Bound">gvps</a> <a id="4343" class="Symbol">=</a> <a id="4345" href="Foreign.Convertible.html#149" class="Field">to</a> <a id="4348" class="Symbol">(</a><a id="4349" href="Interface.ComputationalRelation.html#2981" class="Function">compute</a> <a id="4357" href="Ledger.Conway.Specification.Gov.Properties.Computational.html#7722" class="Function">Computational-GOVS</a> <a class="AgdaKaTeX">$\begin{pmatrix} \,\href{Ledger.Conway.Conformance.Gov.html#861}{\htmlId{4378}{\htmlClass{Function}{\text{txid}}}}\, \\ \,\href{Ledger.Conway.Foreign.HSLedger.Gov.html#4526}{\htmlId{4385}{\htmlClass{Function}{\text{e&#39;}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#908}{\htmlId{4390}{\htmlClass{Function}{\text{pparams}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#934}{\htmlId{4400}{\htmlClass{Function}{\text{ppolicy}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#969}{\htmlId{4410}{\htmlClass{Function}{\text{enactState}}}}\, \\ \,\href{Foreign.Convertible.html#149}{\htmlId{4423}{\htmlClass{Field}{\text{to}}}}\, \,\href{Ledger.Conway.Conformance.Gov.html#998}{\htmlId{4426}{\htmlClass{Function}{\text{certState}}}}\, \\ \,\href{Ledger.Conway.Conformance.Gov.html#1026}{\htmlId{4438}{\htmlClass{Function}{\text{rewardCreds}}}}\, \end{pmatrix}$</a> <a id="4452" class="Symbol">(</a><a id="4453" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4458" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4332" class="Bound">govSt</a><a id="4463" class="Symbol">)</a> <a id="4465" class="Symbol">(</a><a id="4466" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4471" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4338" class="Bound">gvps</a><a id="4475" class="Symbol">))</a>
  <a id="4480" class="Keyword">where</a> <a id="4486" class="Keyword">open</a> <a id="4491" href="Ledger.Conway.Conformance.Gov.html#829" class="Module">GovEnv</a> <a id="4498" class="Symbol">(</a><a id="4499" href="Foreign.Convertible.html#170" class="Field">from</a> <a id="4504" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4330" class="Bound">Γ</a><a id="4505" class="Symbol">)</a> <a id="4507" class="Keyword">renaming</a> <a id="4516" class="Symbol">(</a><a id="4517" href="Ledger.Conway.Conformance.Gov.html#884" class="Field">epoch</a> <a id="4523" class="Symbol">to</a> <a id="4526" class="Field">e&#39;</a><a id="4528" class="Symbol">)</a>

<a id="4531" class="Symbol">{-#</a> <a id="4535" class="Keyword">COMPILE</a> <a id="4543" class="Keyword">GHC</a> <a id="4547" href="Ledger.Conway.Foreign.HSLedger.Gov.html#4216" class="Function">gov-step</a> <a id="4556" class="Pragma">as</a> <a id="4559" class="Pragma">govStep</a> <a id="4567" class="Symbol">#-}</a>
</pre></body></html>