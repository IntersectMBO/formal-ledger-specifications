<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Properties</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Ledger.Abstract.html" class="Module">Ledger.Abstract</a>
<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a>

<a id="112" class="Keyword">module</a> <a id="119" href="Ledger.Properties.html" class="Module">Ledger.Properties</a>
  <a id="139" class="Symbol">(</a><a id="140" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="144" class="Symbol">:</a> <a id="146" class="Symbol">_)</a> <a id="149" class="Symbol">(</a><a id="150" class="Keyword">open</a> <a id="155" href="Ledger.Transaction.html#867" class="Module">TransactionStructure</a> <a id="176" href="Ledger.Properties.html#140" class="Bound">txs</a><a id="179" class="Symbol">)</a>
  <a id="183" class="Symbol">(</a><a id="184" href="Ledger.Properties.html#184" class="Bound">abs</a> <a id="188" class="Symbol">:</a> <a id="190" href="Ledger.Abstract.html#578" class="Record">AbstractFunctions</a> <a id="208" href="Ledger.Properties.html#140" class="Bound">txs</a><a id="211" class="Symbol">)</a> <a id="213" class="Symbol">(</a><a id="214" class="Keyword">open</a> <a id="219" href="Ledger.Abstract.html#578" class="Module">AbstractFunctions</a> <a id="237" href="Ledger.Properties.html#184" class="Bound">abs</a><a id="240" class="Symbol">)</a>
  <a id="244" class="Keyword">where</a>

<a id="251" class="Keyword">open</a> <a id="256" class="Keyword">import</a> <a id="263" href="Ledger.Chain.html" class="Module">Ledger.Chain</a> <a id="276" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="280" href="Ledger.Properties.html#184" class="Bound">abs</a>
<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="Ledger.Utxo.html" class="Module">Ledger.Utxo</a> <a id="308" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="312" href="Ledger.Properties.html#184" class="Bound">abs</a>
<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Ledger.Epoch.html" class="Module">Ledger.Epoch</a> <a id="341" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="345" href="Ledger.Properties.html#184" class="Bound">abs</a>
<a id="349" class="Keyword">open</a> <a id="354" class="Keyword">import</a> <a id="361" href="Ledger.Ledger.html" class="Module">Ledger.Ledger</a> <a id="375" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="379" href="Ledger.Properties.html#184" class="Bound">abs</a>
<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Ledger.Enact.html" class="Module">Ledger.Enact</a> <a id="408" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="421" class="Keyword">open</a> <a id="426" class="Keyword">import</a> <a id="433" href="Ledger.Certs.html" class="Module">Ledger.Certs</a> <a id="446" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Ledger.Gov.html" class="Module">Ledger.Gov</a> <a id="482" href="Ledger.Properties.html#140" class="Bound">txs</a>

<a id="isCredDeposit"></a><a id="487" href="Ledger.Properties.html#487" class="Function">isCredDeposit</a> <a id="501" class="Symbol">:</a> <a id="503" href="Ledger.Certs.html#286" class="Datatype">DepositPurpose</a> <a id="518" class="Symbol">→</a> <a id="520" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="525" href="Ledger.Properties.html#487" class="Function">isCredDeposit</a> <a id="539" class="Symbol">(</a><a id="540" href="Ledger.Certs.html#316" class="InductiveConstructor">CredentialDeposit</a> <a id="558" href="Ledger.Properties.html#558" class="Bound">x</a><a id="559" class="Symbol">)</a> <a id="561" class="Symbol">=</a> <a id="563" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="565" href="Ledger.Properties.html#487" class="CatchallClause Function">isCredDeposit</a><a id="578" class="CatchallClause"> </a><a id="579" class="CatchallClause Symbol">_</a> <a id="581" class="Symbol">=</a> <a id="583" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="586" class="Keyword">instance</a>
  <a id="isCredDeposit?"></a><a id="597" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="612" class="Symbol">:</a> <a id="614" href="Ledger.Properties.html#487" class="Function">isCredDeposit</a> <a id="628" href="Class.Decidable.Core.html#762" class="Function Operator">⁇¹</a>
  <a id="633" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="648" class="Symbol">{</a><a id="649" href="Ledger.Certs.html#316" class="InductiveConstructor">CredentialDeposit</a> <a id="667" href="Ledger.Properties.html#667" class="Bound">x</a><a id="668" class="Symbol">}</a> <a id="670" class="Symbol">=</a> <a id="672" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="674" class="Symbol">(</a><a id="675" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="679" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="681" class="Symbol">)</a>
  <a id="685" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="700" class="Symbol">{</a><a id="701" href="Ledger.Certs.html#369" class="InductiveConstructor">PoolDeposit</a> <a id="713" href="Ledger.Properties.html#713" class="Bound">x</a><a id="714" class="Symbol">}</a> <a id="716" class="Symbol">=</a> <a id="718" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="720" class="Symbol">(</a><a id="721" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="724" class="Symbol">λ</a> <a id="726" class="Symbol">())</a>
  <a id="732" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="747" class="Symbol">{</a><a id="748" href="Ledger.Certs.html#422" class="InductiveConstructor">DRepDeposit</a> <a id="760" href="Ledger.Properties.html#760" class="Bound">x</a><a id="761" class="Symbol">}</a> <a id="763" class="Symbol">=</a> <a id="765" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="767" class="Symbol">(</a><a id="768" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="771" class="Symbol">λ</a> <a id="773" class="Symbol">())</a>
  <a id="779" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="794" class="Symbol">{</a><a id="795" href="Ledger.Certs.html#475" class="InductiveConstructor">GovActionDeposit</a> <a id="812" href="Ledger.Properties.html#812" class="Bound">x</a><a id="813" class="Symbol">}</a> <a id="815" class="Symbol">=</a> <a id="817" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="819" class="Symbol">(</a><a id="820" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="823" class="Symbol">λ</a> <a id="825" class="Symbol">())</a>

<a id="isGADeposit"></a><a id="830" href="Ledger.Properties.html#830" class="Function">isGADeposit</a> <a id="842" class="Symbol">:</a> <a id="844" href="Ledger.Certs.html#286" class="Datatype">DepositPurpose</a> <a id="859" class="Symbol">→</a> <a id="861" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="866" href="Ledger.Properties.html#830" class="Function">isGADeposit</a> <a id="878" class="Symbol">(</a><a id="879" href="Ledger.Certs.html#475" class="InductiveConstructor">GovActionDeposit</a> <a id="896" href="Ledger.Properties.html#896" class="Bound">x</a><a id="897" class="Symbol">)</a> <a id="899" class="Symbol">=</a> <a id="901" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="903" href="Ledger.Properties.html#830" class="CatchallClause Function">isGADeposit</a><a id="914" class="CatchallClause"> </a><a id="915" class="CatchallClause Symbol">_</a> <a id="917" class="Symbol">=</a> <a id="919" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="922" class="Keyword">instance</a>
  <a id="isGADeposit?"></a><a id="933" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="946" class="Symbol">:</a> <a id="948" href="Ledger.Properties.html#830" class="Function">isGADeposit</a> <a id="960" href="Class.Decidable.Core.html#762" class="Function Operator">⁇¹</a>
  <a id="965" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="978" class="Symbol">{</a><a id="979" href="Ledger.Certs.html#316" class="InductiveConstructor">CredentialDeposit</a> <a id="997" href="Ledger.Properties.html#997" class="Bound">x</a><a id="998" class="Symbol">}</a> <a id="1000" class="Symbol">=</a> <a id="1002" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1004" class="Symbol">(</a><a id="1005" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1008" class="Symbol">λ</a> <a id="1010" class="Symbol">())</a>
  <a id="1016" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="1029" class="Symbol">{</a><a id="1030" href="Ledger.Certs.html#369" class="InductiveConstructor">PoolDeposit</a> <a id="1042" href="Ledger.Properties.html#1042" class="Bound">x</a><a id="1043" class="Symbol">}</a> <a id="1045" class="Symbol">=</a> <a id="1047" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1049" class="Symbol">(</a><a id="1050" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1053" class="Symbol">λ</a> <a id="1055" class="Symbol">())</a>
  <a id="1061" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="1074" class="Symbol">{</a><a id="1075" href="Ledger.Certs.html#422" class="InductiveConstructor">DRepDeposit</a> <a id="1087" href="Ledger.Properties.html#1087" class="Bound">x</a><a id="1088" class="Symbol">}</a> <a id="1090" class="Symbol">=</a> <a id="1092" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1094" class="Symbol">(</a><a id="1095" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1098" class="Symbol">λ</a> <a id="1100" class="Symbol">())</a>
  <a id="1106" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="1119" class="Symbol">{</a><a id="1120" href="Ledger.Certs.html#475" class="InductiveConstructor">GovActionDeposit</a> <a id="1137" href="Ledger.Properties.html#1137" class="Bound">x</a><a id="1138" class="Symbol">}</a> <a id="1140" class="Symbol">=</a> <a id="1142" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="1149" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="1151" class="Symbol">)</a>

<a id="getLState"></a><a id="1154" href="Ledger.Properties.html#1154" class="Function">getLState</a> <a id="1164" class="Symbol">:</a> <a id="1166" href="Ledger.Epoch.html#1330" class="Record">NewEpochState</a> <a id="1180" class="Symbol">→</a> <a id="1182" href="Ledger.Ledger.html#715" class="Record">LState</a>
<a id="1189" href="Ledger.Properties.html#1154" class="Function">getLState</a> <a id="1199" class="Symbol">=</a> <a id="1201" href="Ledger.Epoch.html#1244" class="Field">EpochState.ls</a> <a id="1215" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1217" href="Ledger.Epoch.html#1393" class="Field">NewEpochState.epochState</a>

<a id="getRewards"></a><a id="1243" href="Ledger.Properties.html#1243" class="Function">getRewards</a> <a id="1254" class="Symbol">:</a> <a id="1256" href="Ledger.Epoch.html#1330" class="Record">NewEpochState</a> <a id="1270" class="Symbol">→</a> <a id="1272" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="1283" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1285" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="1290" href="Ledger.Properties.html#1243" class="Function">getRewards</a> <a id="1301" class="Symbol">=</a> <a id="1303" href="Ledger.Certs.html#2531" class="Field">DState.rewards</a> <a id="1318" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1320" href="Ledger.Certs.html#2888" class="Field">CertState.dState</a> <a id="1337" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1339" href="Ledger.Ledger.html#827" class="Field">LState.certState</a> <a id="1356" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1358" href="Ledger.Properties.html#1154" class="Function">getLState</a>

<a id="allDReps"></a><a id="1369" href="Ledger.Properties.html#1369" class="Function">allDReps</a> <a id="1378" class="Symbol">:</a> <a id="1380" href="Ledger.Epoch.html#1330" class="Record">NewEpochState</a> <a id="1394" class="Symbol">→</a> <a id="1396" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="1407" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="1409" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a>
<a id="1415" href="Ledger.Properties.html#1369" class="Function">allDReps</a> <a id="1424" class="Symbol">=</a> <a id="1426" href="Ledger.Certs.html#2738" class="Field">GState.dreps</a> <a id="1439" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1441" href="Ledger.Certs.html#2928" class="Field">CertState.gState</a> <a id="1458" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1460" href="Ledger.Ledger.html#827" class="Field">LState.certState</a> <a id="1477" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1479" href="Ledger.Properties.html#1154" class="Function">getLState</a>

<a id="activeDReps"></a><a id="1490" href="Ledger.Properties.html#1490" class="Function">activeDReps</a> <a id="1502" class="Symbol">:</a> <a id="1504" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a> <a id="1510" class="Symbol">→</a> <a id="1512" href="Ledger.Epoch.html#1330" class="Record">NewEpochState</a> <a id="1526" class="Symbol">→</a> <a id="1528" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="1530" href="Ledger.Address.html#273" class="Datatype">Credential</a>
<a id="1541" href="Ledger.Properties.html#1490" class="Function">activeDReps</a> <a id="1553" href="Ledger.Properties.html#1553" class="Bound">currentEpoch</a> <a id="1566" href="Ledger.Properties.html#1566" class="Bound">s</a> <a id="1568" class="Symbol">=</a> <a id="1570" href="Class.IsSet.html#916" class="Function">dom</a> <a id="1574" class="Symbol">(</a><a id="1575" href="abstract-set-theory.FiniteSetTheory.html#2895" class="Function">filterᵐ</a> <a id="1583" class="Symbol">(λ</a> <a id="1586" class="Symbol">(_</a> <a id="1589" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1591" href="Ledger.Properties.html#1591" class="Bound">e</a><a id="1592" class="Symbol">)</a> <a id="1594" class="Symbol">→</a> <a id="1596" href="Ledger.Properties.html#1553" class="Bound">currentEpoch</a> <a id="1609" href="Class.HasOrder.Core.html#551" class="Field Operator">≤</a> <a id="1611" href="Ledger.Properties.html#1591" class="Bound">e</a><a id="1612" class="Symbol">)</a> <a id="1614" class="Symbol">(</a><a id="1615" href="Ledger.Properties.html#1369" class="Function">allDReps</a> <a id="1624" href="Ledger.Properties.html#1566" class="Bound">s</a><a id="1625" class="Symbol">))</a>

<a id="getGovState"></a><a id="1629" href="Ledger.Properties.html#1629" class="Function">getGovState</a> <a id="1641" class="Symbol">:</a> <a id="1643" href="Ledger.Epoch.html#1330" class="Record">NewEpochState</a> <a id="1657" class="Symbol">→</a> <a id="1659" href="Ledger.Gov.html#1218" class="Function">GovState</a>
<a id="1668" href="Ledger.Properties.html#1629" class="Function">getGovState</a> <a id="1680" class="Symbol">=</a> <a id="1682" href="Ledger.Ledger.html#801" class="Field">LState.govSt</a> <a id="1695" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1697" href="Ledger.Properties.html#1154" class="Function">getLState</a>

<a id="1708" class="Keyword">instance</a>
  <a id="1719" href="Ledger.Properties.html#1719" class="Function">_</a> <a id="1721" class="Symbol">:</a> <a id="1723" href="Class.IsSet.html#375" class="Record">IsSet</a> <a id="1729" href="Ledger.Chain.html#626" class="Record">Block</a> <a id="1735" href="Ledger.Transaction.html#3538" class="Record">Tx</a>
  <a id="1740" class="Symbol">_</a> <a id="1742" class="Symbol">=</a> <a id="1744" class="Keyword">record</a> <a id="1751" class="Symbol">{</a> <a id="1753" href="Class.IsSet.html#419" class="Field">toSet</a> <a id="1759" class="Symbol">=</a> <a id="1761" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1770" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1772" href="Ledger.Chain.html#657" class="Field">Block.ts</a> <a id="1781" class="Symbol">}</a>

  <a id="1786" href="Ledger.Properties.html#1786" class="Function">_</a> <a id="1788" class="Symbol">:</a> <a id="1790" href="Class.IsSet.html#375" class="Record">IsSet</a> <a id="1796" href="Ledger.Transaction.html#2584" class="Record">TxBody</a> <a id="1803" href="Ledger.GovernanceActions.html#1883" class="Record">GovProposal</a>
  <a id="1817" class="Symbol">_</a> <a id="1819" class="Symbol">=</a> <a id="1821" class="Keyword">record</a> <a id="1828" class="Symbol">{</a> <a id="1830" href="Class.IsSet.html#419" class="Field">toSet</a> <a id="1836" class="Symbol">=</a> <a id="1838" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1847" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1849" href="Ledger.Transaction.html#2916" class="Field">TxBody.txprop</a> <a id="1863" class="Symbol">}</a>

<a id="validBlockIn"></a><a id="1866" href="Ledger.Properties.html#1866" class="Function">validBlockIn</a> <a id="1879" class="Symbol">:</a> <a id="1881" href="Ledger.Chain.html#551" class="Record">ChainState</a> <a id="1892" class="Symbol">→</a> <a id="1894" href="Ledger.Chain.html#626" class="Record">Block</a> <a id="1900" class="Symbol">→</a> <a id="1902" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1907" href="Ledger.Properties.html#1866" class="Function">validBlockIn</a> <a id="1920" href="Ledger.Properties.html#1920" class="Bound">s</a> <a id="1922" href="Ledger.Properties.html#1922" class="Bound">b</a> <a id="1924" class="Symbol">=</a> <a id="1926" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="1929" href="Ledger.Properties.html#1929" class="Bound">s&#39;</a> <a id="1932" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="1934" class="Symbol">_</a> <a id="1936" href="Ledger.Chain.html#2636" class="Datatype Operator">⊢</a> <a id="1938" href="Ledger.Properties.html#1920" class="Bound">s</a> <a id="1940" href="Ledger.Chain.html#2636" class="Datatype Operator">⇀⦇</a> <a id="1943" href="Ledger.Properties.html#1922" class="Bound">b</a> <a id="1945" href="Ledger.Chain.html#2636" class="Datatype Operator">,CHAIN⦈</a> <a id="1953" href="Ledger.Properties.html#1929" class="Bound">s&#39;</a>

<a id="validBlock"></a><a id="1957" href="Ledger.Properties.html#1957" class="Function">validBlock</a> <a id="1968" class="Symbol">:</a> <a id="1970" href="Ledger.Chain.html#626" class="Record">Block</a> <a id="1976" class="Symbol">→</a> <a id="1978" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1983" href="Ledger.Properties.html#1957" class="Function">validBlock</a> <a id="1994" href="Ledger.Properties.html#1994" class="Bound">b</a> <a id="1996" class="Symbol">=</a> <a id="1998" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2001" href="Ledger.Properties.html#2001" class="Bound">s</a> <a id="2003" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2005" href="Ledger.Properties.html#1866" class="Function">validBlockIn</a> <a id="2018" href="Ledger.Properties.html#2001" class="Bound">s</a> <a id="2020" href="Ledger.Properties.html#1994" class="Bound">b</a>

<a id="2023" class="Comment">-- Transaction validity is complicated. In the truest sense, a</a>
<a id="2086" class="Comment">-- transaction is valid if it is part of a valid block,</a>
<a id="2142" class="Comment">-- i.e. `validTxIn₁`. However, a transaction can also be seen as valid</a>
<a id="2213" class="Comment">-- if it could be applied at a certain slot (with no knowledge of an</a>
<a id="2282" class="Comment">-- actual block). This is closer to how the mempool sees transaction</a>
<a id="2351" class="Comment">-- validity and is expressed by `validTxIn₂`.</a>

<a id="2398" class="Comment">-- Note that these two are not equivalent and in fact there is no</a>
<a id="2464" class="Comment">-- implication between the two in either direction. `2 =&gt; 1` would</a>
<a id="2531" class="Comment">-- require one to come up with a block, which we can&#39;t, but `1 =&gt; 2`</a>
<a id="2600" class="Comment">-- is also not true, since the transaction might depend on a previous</a>
<a id="2670" class="Comment">-- transaction in the same block. Maybe this means that `validTxIn₂`</a>
<a id="2739" class="Comment">-- should be changed so that it allows for applying a list of</a>
<a id="2801" class="Comment">-- transactions before the final transaction? However, the downside</a>
<a id="2869" class="Comment">-- then becomes that the transaction isn&#39;t applied to the given state</a>
<a id="2939" class="Comment">-- but to some intermediate one. Maybe we&#39;ll gain some insight on this</a>
<a id="3010" class="Comment">-- matter once we have proven more theorems.</a>

<a id="validTxIn₁"></a><a id="3056" href="Ledger.Properties.html#3056" class="Function">validTxIn₁</a> <a id="3067" class="Symbol">:</a> <a id="3069" href="Ledger.Chain.html#551" class="Record">ChainState</a> <a id="3080" class="Symbol">→</a> <a id="3082" href="Ledger.Transaction.html#3538" class="Record">Tx</a> <a id="3085" class="Symbol">→</a> <a id="3087" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3092" href="Ledger.Properties.html#3056" class="Function">validTxIn₁</a> <a id="3103" href="Ledger.Properties.html#3103" class="Bound">s</a> <a id="3105" href="Ledger.Properties.html#3105" class="Bound">tx</a> <a id="3108" class="Symbol">=</a> <a id="3110" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3113" href="Ledger.Properties.html#3113" class="Bound">b</a> <a id="3115" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3117" href="Ledger.Properties.html#3105" class="Bound">tx</a> <a id="3120" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="3122" href="Ledger.Properties.html#3113" class="Bound">b</a> <a id="3124" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3126" href="Ledger.Properties.html#1866" class="Function">validBlockIn</a> <a id="3139" href="Ledger.Properties.html#3103" class="Bound">s</a> <a id="3141" href="Ledger.Properties.html#3113" class="Bound">b</a>

<a id="3144" class="Keyword">module</a> <a id="3151" href="Ledger.Properties.html#3151" class="Module">_</a> <a id="3153" class="Symbol">(</a><a id="3154" href="Ledger.Properties.html#3154" class="Bound">s</a> <a id="3156" class="Symbol">:</a> <a id="3158" href="Ledger.Chain.html#551" class="Record">ChainState</a><a id="3168" class="Symbol">)</a> <a id="3170" class="Symbol">(</a><a id="3171" href="Ledger.Properties.html#3171" class="Bound">slot</a> <a id="3176" class="Symbol">:</a> <a id="3178" href="Ledger.Types.Epoch.html#552" class="Function">Slot</a><a id="3182" class="Symbol">)</a> <a id="3184" class="Keyword">where</a>

  <a id="3193" class="Keyword">open</a> <a id="3198" href="Ledger.Chain.html#551" class="Module">ChainState</a> <a id="3209" href="Ledger.Properties.html#3154" class="Bound">s</a><a id="3210" class="Symbol">;</a> <a id="3212" class="Keyword">open</a> <a id="3217" href="Ledger.Epoch.html#1330" class="Module">NewEpochState</a> <a id="3231" href="Ledger.Chain.html#587" class="Function">newEpochState</a>
  <a id="3247" class="Keyword">open</a> <a id="3252" href="Ledger.Epoch.html#1127" class="Module">EpochState</a> <a id="3263" href="Ledger.Epoch.html#1393" class="Function">epochState</a><a id="3273" class="Symbol">;</a> <a id="3275" class="Keyword">open</a> <a id="3280" href="Ledger.Enact.html#397" class="Module">EnactState</a> <a id="3291" href="Ledger.Epoch.html#1268" class="Function">es</a>

  <a id="3297" class="Keyword">private</a>
    <a id="3309" href="Ledger.Properties.html#3309" class="Function">ledgerEnv</a> <a id="3319" class="Symbol">=</a> <a id="3321" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="3323" href="Ledger.Properties.html#3171" class="Bound">slot</a> <a id="3328" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3330" href="Ledger.Enact.html#502" class="Function">constitution</a> <a id="3343" class="Symbol">.</a><a id="3344" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3350" class="Symbol">.</a><a id="3351" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3357" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3359" href="Ledger.Enact.html#607" class="Function">pparams</a> <a id="3367" class="Symbol">.</a><a id="3368" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3374" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3376" href="Ledger.Epoch.html#1268" class="Function">es</a> <a id="3379" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3381" href="Ledger.PParams.html#675" class="Field">Acnt.treasury</a> <a id="3395" href="Ledger.Epoch.html#1195" class="Function">acnt</a> <a id="3400" href="Class.To.html#102" class="Field Operator">⟧</a>

  <a id="3405" href="Ledger.Properties.html#3405" class="Function">validTxIn₂</a> <a id="3416" class="Symbol">:</a> <a id="3418" href="Ledger.Transaction.html#3538" class="Record">Tx</a> <a id="3421" class="Symbol">→</a> <a id="3423" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="3430" href="Ledger.Properties.html#3405" class="Function">validTxIn₂</a> <a id="3441" href="Ledger.Properties.html#3441" class="Bound">tx</a> <a id="3444" class="Symbol">=</a> <a id="3446" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3449" href="Ledger.Properties.html#3449" class="Bound">ls&#39;</a> <a id="3453" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3455" href="Ledger.Properties.html#3309" class="Function">ledgerEnv</a> <a id="3465" href="Ledger.Ledger.html#1873" class="Datatype Operator">⊢</a> <a id="3467" href="Ledger.Epoch.html#1244" class="Function">ls</a> <a id="3470" href="Ledger.Ledger.html#1873" class="Datatype Operator">⇀⦇</a> <a id="3473" href="Ledger.Properties.html#3441" class="Bound">tx</a> <a id="3476" href="Ledger.Ledger.html#1873" class="Datatype Operator">,LEDGER⦈</a> <a id="3485" href="Ledger.Properties.html#3449" class="Bound">ls&#39;</a>

<a id="validTx₁"></a><a id="3490" href="Ledger.Properties.html#3490" class="Function">validTx₁</a> <a id="3499" class="Symbol">:</a> <a id="3501" href="Ledger.Transaction.html#3538" class="Record">Tx</a> <a id="3504" class="Symbol">→</a> <a id="3506" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3511" href="Ledger.Properties.html#3490" class="Function">validTx₁</a> <a id="3520" href="Ledger.Properties.html#3520" class="Bound">tx</a> <a id="3523" class="Symbol">=</a> <a id="3525" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3528" href="Ledger.Properties.html#3528" class="Bound">s</a> <a id="3530" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3532" href="Ledger.Properties.html#3056" class="Function">validTxIn₁</a> <a id="3543" href="Ledger.Properties.html#3528" class="Bound">s</a> <a id="3545" href="Ledger.Properties.html#3520" class="Bound">tx</a>

<a id="ChainInvariant"></a><a id="3549" href="Ledger.Properties.html#3549" class="Function">ChainInvariant</a> <a id="3564" class="Symbol">:</a> <a id="3566" class="Symbol">∀</a> <a id="3568" class="Symbol">{</a><a id="3569" href="Ledger.Properties.html#3569" class="Bound">a</a><a id="3570" class="Symbol">}</a> <a id="3572" class="Symbol">→</a> <a id="3574" class="Symbol">(</a><a id="3575" href="Ledger.Chain.html#551" class="Record">ChainState</a> <a id="3586" class="Symbol">→</a> <a id="3588" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3593" href="Ledger.Properties.html#3569" class="Bound">a</a><a id="3594" class="Symbol">)</a> <a id="3596" class="Symbol">→</a> <a id="3598" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3603" href="Ledger.Properties.html#3569" class="Bound">a</a>
<a id="3605" href="Ledger.Properties.html#3549" class="Function">ChainInvariant</a> <a id="3620" href="Ledger.Properties.html#3620" class="Bound">P</a> <a id="3622" class="Symbol">=</a> <a id="3624" class="Symbol">∀</a> <a id="3626" href="Ledger.Properties.html#3626" class="Bound">b</a> <a id="3628" href="Ledger.Properties.html#3628" class="Bound">s</a> <a id="3630" href="Ledger.Properties.html#3630" class="Bound">s&#39;</a> <a id="3633" class="Symbol">→</a> <a id="3635" class="Symbol">_</a> <a id="3637" href="Ledger.Chain.html#2636" class="Datatype Operator">⊢</a> <a id="3639" href="Ledger.Properties.html#3628" class="Bound">s</a> <a id="3641" href="Ledger.Chain.html#2636" class="Datatype Operator">⇀⦇</a> <a id="3644" href="Ledger.Properties.html#3626" class="Bound">b</a> <a id="3646" href="Ledger.Chain.html#2636" class="Datatype Operator">,CHAIN⦈</a> <a id="3654" href="Ledger.Properties.html#3630" class="Bound">s&#39;</a> <a id="3657" class="Symbol">→</a> <a id="3659" href="Ledger.Properties.html#3620" class="Bound">P</a> <a id="3661" href="Ledger.Properties.html#3628" class="Bound">s</a> <a id="3663" class="Symbol">→</a> <a id="3665" href="Ledger.Properties.html#3620" class="Bound">P</a> <a id="3667" href="Ledger.Properties.html#3630" class="Bound">s&#39;</a>

<a id="3671" class="Keyword">module</a> <a id="3678" href="Ledger.Properties.html#3678" class="Module">_</a> <a id="3680" class="Symbol">(</a><a id="3681" href="Ledger.Properties.html#3681" class="Bound">s</a> <a id="3683" class="Symbol">:</a> <a id="3685" href="Ledger.Chain.html#551" class="Record">ChainState</a><a id="3695" class="Symbol">)</a> <a id="3697" class="Keyword">where</a>
  <a id="3705" class="Keyword">open</a> <a id="3710" href="Ledger.Chain.html#551" class="Module">ChainState</a> <a id="3721" href="Ledger.Properties.html#3681" class="Bound">s</a><a id="3722" class="Symbol">;</a> <a id="3724" class="Keyword">open</a> <a id="3729" href="Ledger.Epoch.html#1330" class="Module">NewEpochState</a> <a id="3743" href="Ledger.Chain.html#587" class="Field">newEpochState</a><a id="3756" class="Symbol">;</a> <a id="3758" class="Keyword">open</a> <a id="3763" href="Ledger.Epoch.html#1127" class="Module">EpochState</a> <a id="3774" href="Ledger.Epoch.html#1393" class="Function">epochState</a>
  <a id="3787" class="Keyword">open</a> <a id="3792" href="Ledger.Ledger.html#715" class="Module">LState</a> <a id="3799" href="Ledger.Epoch.html#1244" class="Function">ls</a>
  <a id="3804" class="Keyword">open</a> <a id="3809" href="Ledger.Enact.html#397" class="Module">EnactState</a> <a id="3820" href="Ledger.Epoch.html#1268" class="Function">es</a> <a id="3823" class="Keyword">renaming</a> <a id="3832" class="Symbol">(</a><a id="3833" href="Ledger.Enact.html#607" class="Field">pparams</a> <a id="3841" class="Symbol">to</a> <a id="3844" class="Field">pparams&#39;</a><a id="3852" class="Symbol">)</a>
  <a id="3856" class="Keyword">open</a> <a id="3861" href="Ledger.Certs.html#2825" class="Module">CertState</a> <a id="3871" href="Ledger.Ledger.html#827" class="Function">certState</a><a id="3880" class="Symbol">;</a> <a id="3882" class="Keyword">open</a> <a id="3887" href="Ledger.Certs.html#2393" class="Module">DState</a> <a id="3894" href="Ledger.Certs.html#2888" class="Function">dState</a>
  <a id="3903" href="Ledger.Properties.html#3903" class="Function">pparams</a> <a id="3911" class="Symbol">=</a> <a id="3913" href="Ledger.Properties.html#3844" class="Function">pparams&#39;</a> <a id="3922" class="Symbol">.</a><a id="3923" href="Data.Product.Base.html#636" class="Field">proj₁</a>
  <a id="3931" class="Keyword">open</a> <a id="3936" href="Ledger.PParams.html#1389" class="Module">PParams</a> <a id="3944" href="Ledger.Properties.html#3903" class="Function">pparams</a>
  <a id="3954" class="Keyword">open</a> <a id="3959" href="Ledger.Transaction.html#3538" class="Module">Tx</a><a id="3961" class="Symbol">;</a> <a id="3963" class="Keyword">open</a> <a id="3968" href="Ledger.Transaction.html#2584" class="Module">TxBody</a>

  <a id="3978" class="Comment">-- Transaction properties</a>

  <a id="4007" class="Keyword">module</a> <a id="4014" href="Ledger.Properties.html#4014" class="Module">_</a> <a id="4016" class="Symbol">{</a><a id="4017" href="Ledger.Properties.html#4017" class="Bound">slot</a><a id="4021" class="Symbol">}</a> <a id="4023" class="Symbol">{</a><a id="4024" href="Ledger.Properties.html#4024" class="Bound">tx</a><a id="4026" class="Symbol">}</a> <a id="4028" class="Symbol">(</a><a id="4029" class="Keyword">let</a> <a id="4033" href="Ledger.Properties.html#4033" class="Bound">txb</a> <a id="4037" class="Symbol">=</a> <a id="4039" href="Ledger.Transaction.html#3570" class="Field">body</a> <a id="4044" href="Ledger.Properties.html#4024" class="Bound">tx</a><a id="4046" class="Symbol">)</a> <a id="4048" class="Symbol">(</a><a id="4049" href="Ledger.Properties.html#4049" class="Bound">valid</a> <a id="4055" class="Symbol">:</a> <a id="4057" href="Ledger.Properties.html#3405" class="Function">validTxIn₂</a> <a id="4068" href="Ledger.Properties.html#3681" class="Bound">s</a> <a id="4070" href="Ledger.Properties.html#4017" class="Bound">slot</a> <a id="4075" href="Ledger.Properties.html#4024" class="Bound">tx</a><a id="4077" class="Symbol">)</a>
    <a id="4083" class="Symbol">(</a><a id="4084" href="Ledger.Properties.html#4084" class="Bound">indexedSum-∪⁺-hom</a> <a id="4102" class="Symbol">:</a> <a id="4104" class="Symbol">∀</a> <a id="4106" class="Symbol">{</a><a id="4107" href="Ledger.Properties.html#4107" class="Bound">A</a> <a id="4109" href="Ledger.Properties.html#4109" class="Bound">V</a> <a id="4111" class="Symbol">:</a> <a id="4113" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="4117" class="Symbol">}</a> <a id="4119" class="Symbol">⦃</a> <a id="4121" href="Ledger.Properties.html#4121" class="Bound">_</a> <a id="4123" class="Symbol">:</a> <a id="4125" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="4131" href="Ledger.Properties.html#4107" class="Bound">A</a> <a id="4133" class="Symbol">⦄</a> <a id="4135" class="Symbol">⦃</a> <a id="4137" href="Ledger.Properties.html#4137" class="Bound">_</a> <a id="4139" class="Symbol">:</a> <a id="4141" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="4147" href="Ledger.Properties.html#4109" class="Bound">V</a> <a id="4149" class="Symbol">⦄</a> <a id="4151" class="Symbol">⦃</a> <a id="4153" href="Ledger.Properties.html#4153" class="Bound">mon</a> <a id="4157" class="Symbol">:</a> <a id="4159" href="Class.CommutativeMonoid.Core.html#189" class="Record">CommutativeMonoid</a> <a id="4177" href="Level.html#521" class="Function">0ℓ</a> <a id="4180" href="Level.html#521" class="Function">0ℓ</a> <a id="4183" href="Ledger.Properties.html#4109" class="Bound">V</a> <a id="4185" class="Symbol">⦄</a>
      <a id="4193" class="Symbol">→</a> <a id="4195" class="Symbol">(</a><a id="4196" href="Ledger.Properties.html#4196" class="Bound">d₁</a> <a id="4199" href="Ledger.Properties.html#4199" class="Bound">d₂</a> <a id="4202" class="Symbol">:</a> <a id="4204" href="Ledger.Properties.html#4107" class="Bound">A</a> <a id="4206" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="4208" href="Ledger.Properties.html#4109" class="Bound">V</a><a id="4209" class="Symbol">)</a> <a id="4211" class="Symbol">→</a> <a id="4213" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4226" href="Function.Base.html#704" class="Function">id</a> <a id="4229" class="Symbol">(</a><a id="4230" href="Ledger.Properties.html#4196" class="Bound">d₁</a> <a id="4233" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="4236" href="Ledger.Properties.html#4199" class="Bound">d₂</a><a id="4238" class="Symbol">)</a> <a id="4240" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4242" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4255" href="Function.Base.html#704" class="Function">id</a> <a id="4258" href="Ledger.Properties.html#4196" class="Bound">d₁</a> <a id="4261" href="Class.Semigroup.Core.html#164" class="Field Operator">◇</a> <a id="4263" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4276" href="Function.Base.html#704" class="Function">id</a> <a id="4279" href="Ledger.Properties.html#4199" class="Bound">d₂</a><a id="4281" class="Symbol">)</a>
    <a id="4287" class="Symbol">(</a><a id="4288" href="Ledger.Properties.html#4288" class="Bound">indexedSum-⊆</a> <a id="4301" class="Symbol">:</a> <a id="4303" class="Symbol">∀</a> <a id="4305" class="Symbol">{</a><a id="4306" href="Ledger.Properties.html#4306" class="Bound">A</a> <a id="4308" class="Symbol">:</a> <a id="4310" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="4314" class="Symbol">}</a> <a id="4316" class="Symbol">⦃</a> <a id="4318" href="Ledger.Properties.html#4318" class="Bound">_</a> <a id="4320" class="Symbol">:</a> <a id="4322" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="4328" href="Ledger.Properties.html#4306" class="Bound">A</a> <a id="4330" class="Symbol">⦄</a> <a id="4332" class="Symbol">(</a><a id="4333" href="Ledger.Properties.html#4333" class="Bound">d</a> <a id="4335" href="Ledger.Properties.html#4335" class="Bound">d&#39;</a> <a id="4338" class="Symbol">:</a> <a id="4340" href="Ledger.Properties.html#4306" class="Bound">A</a> <a id="4342" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="4344" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="4345" class="Symbol">)</a> <a id="4347" class="Symbol">→</a> <a id="4349" href="Ledger.Properties.html#4333" class="Bound">d</a> <a id="4351" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a> <a id="4353" href="Interface.HasSubset.html#158" class="Field Operator">⊆</a> <a id="4355" href="Ledger.Properties.html#4335" class="Bound">d&#39;</a> <a id="4358" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a>
      <a id="4366" class="Symbol">→</a> <a id="4368" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4381" href="Function.Base.html#704" class="Function">id</a> <a id="4384" href="Ledger.Properties.html#4333" class="Bound">d</a> <a id="4386" href="Class.HasOrder.Core.html#551" class="Field Operator">≤</a> <a id="4388" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="4401" href="Function.Base.html#704" class="Function">id</a> <a id="4404" href="Ledger.Properties.html#4335" class="Bound">d&#39;</a><a id="4406" class="Symbol">)</a> <a id="4408" class="Comment">-- technically we could use an ordered monoid instead of ℕ</a>
    <a id="4471" class="Keyword">where</a>
    <a id="4481" class="Keyword">open</a> <a id="4486" class="Keyword">import</a> <a id="4493" href="Ledger.Utxow.html" class="Module">Ledger.Utxow</a> <a id="4506" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="4510" href="Ledger.Properties.html#184" class="Bound">abs</a>
    <a id="4518" class="Keyword">open</a> <a id="4523" class="Keyword">import</a> <a id="4530" href="Ledger.Utxo.Properties.html" class="Module">Ledger.Utxo.Properties</a> <a id="4553" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="4557" href="Ledger.Properties.html#184" class="Bound">abs</a>

    <a id="4566" href="Ledger.Properties.html#4566" class="Function">propose-minSpend</a> <a id="4583" class="Symbol">:</a> <a id="4585" href="Ledger.Utxo.Properties.html#27154" class="Function">noRefundCert</a> <a id="4598" class="Symbol">(</a><a id="4599" href="Ledger.Transaction.html#2818" class="Field">txcerts</a> <a id="4607" href="Ledger.Properties.html#4033" class="Bound">txb</a><a id="4610" class="Symbol">)</a>
      <a id="4618" class="Symbol">→</a> <a id="4620" href="Ledger.TokenAlgebra.html#812" class="Function">coin</a> <a id="4625" class="Symbol">(</a><a id="4626" href="Ledger.Utxo.html#11764" class="Function">consumed</a> <a id="4635" href="Ledger.Properties.html#3903" class="Function">pparams</a> <a id="4643" href="Ledger.Ledger.html#774" class="Function">utxoSt</a> <a id="4650" href="Ledger.Properties.html#4033" class="Bound">txb</a><a id="4653" class="Symbol">)</a> <a id="4655" href="Class.HasOrder.Core.html#727" class="Function Operator">≥</a> <a id="4657" href="Data.List.Base.html#5044" class="Function">length</a> <a id="4664" class="Symbol">(</a><a id="4665" href="Ledger.Transaction.html#2916" class="Field">txprop</a> <a id="4672" href="Ledger.Properties.html#4033" class="Bound">txb</a><a id="4675" class="Symbol">)</a> <a id="4677" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4679" href="Ledger.PParams.html#2915" class="Function">govActionDeposit</a>
    <a id="4700" href="Ledger.Properties.html#4566" class="Function">propose-minSpend</a> <a id="4717" href="Ledger.Properties.html#4717" class="Bound">noRef</a> <a id="4723" class="Symbol">=</a> <a id="4725" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4730" href="Ledger.Properties.html#4049" class="Bound">valid</a> <a id="4736" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4739" class="Symbol">λ</a> <a id="4741" class="Keyword">where</a>
      <a id="4753" class="Symbol">(_</a> <a id="4756" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4758" href="Ledger.Ledger.html#1935" class="InductiveConstructor">LEDGER-V</a> <a id="4767" class="Symbol">(_</a> <a id="4770" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4772" href="Ledger.Utxow.html#5380" class="InductiveConstructor">UTXOW⇒UTXO</a> <a id="4783" href="Ledger.Properties.html#4783" class="Bound">x</a> <a id="4785" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4787" class="Symbol">_</a> <a id="4789" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4791" class="Symbol">_))</a> <a id="4795" class="Symbol">→</a> <a id="4797" href="Ledger.Utxo.Properties.html#31447" class="Function">gmsc</a> <a id="4802" href="Ledger.Properties.html#4084" class="Bound">indexedSum-∪⁺-hom</a> <a id="4820" href="Ledger.Properties.html#4783" class="Bound">x</a> <a id="4822" href="Ledger.Properties.html#4717" class="Bound">noRef</a>
      <a id="4834" class="Symbol">(_</a> <a id="4837" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4839" href="Ledger.Ledger.html#2595" class="InductiveConstructor">LEDGER-I</a> <a id="4848" class="Symbol">(_</a> <a id="4851" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4853" href="Ledger.Utxow.html#5380" class="InductiveConstructor">UTXOW⇒UTXO</a> <a id="4864" href="Ledger.Properties.html#4864" class="Bound">x</a><a id="4865" class="Symbol">))</a>         <a id="4876" class="Symbol">→</a> <a id="4878" href="Ledger.Utxo.Properties.html#31447" class="Function">gmsc</a> <a id="4883" href="Ledger.Properties.html#4084" class="Bound">indexedSum-∪⁺-hom</a> <a id="4901" href="Ledger.Properties.html#4864" class="Bound">x</a> <a id="4903" href="Ledger.Properties.html#4717" class="Bound">noRef</a>

  <a id="4912" class="Comment">--   propose-ChangePP-hasGroup : ∀ {up prop}</a>
  <a id="4959" class="Comment">--     → prop ∈ txb → prop .GovProposal.action ≡ ChangePParams up → updateGroups up ≢ ∅</a>
  <a id="5049" class="Comment">--   propose-ChangePP-hasGroup = {!!}</a>

  <a id="5090" class="Comment">-- Block properties</a>

  <a id="5113" class="Keyword">module</a> <a id="5120" href="Ledger.Properties.html#5120" class="Module">_</a> <a id="5122" class="Symbol">{</a><a id="5123" href="Ledger.Properties.html#5123" class="Bound">b</a><a id="5124" class="Symbol">}</a> <a id="5126" class="Symbol">(</a><a id="5127" href="Ledger.Properties.html#5127" class="Bound">valid</a> <a id="5133" class="Symbol">:</a> <a id="5135" href="Ledger.Properties.html#1866" class="Function">validBlockIn</a> <a id="5148" href="Ledger.Properties.html#3681" class="Bound">s</a> <a id="5150" href="Ledger.Properties.html#5123" class="Bound">b</a><a id="5151" class="Symbol">)</a> <a id="5153" class="Symbol">(</a><a id="5154" class="Keyword">let</a> <a id="5158" class="Keyword">open</a> <a id="5163" href="Ledger.Chain.html#626" class="Module">Block</a> <a id="5169" href="Ledger.Properties.html#5123" class="Bound">b</a><a id="5170" class="Symbol">)</a> <a id="5172" class="Keyword">where</a>
    <a id="5182" href="Ledger.Properties.html#5182" class="Function">isNewEpochBlock</a> <a id="5198" class="Symbol">:</a> <a id="5200" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="5209" href="Ledger.Properties.html#5182" class="Function">isNewEpochBlock</a> <a id="5225" class="Symbol">=</a> <a id="5227" href="Ledger.Types.Epoch.html#688" class="Function">epoch</a> <a id="5233" href="Ledger.Chain.html#677" class="Function">slot</a> <a id="5238" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5240" href="Ledger.Types.Epoch.html#797" class="Function">sucᵉ</a> <a id="5245" href="Ledger.Epoch.html#1369" class="Function">lastEpoch</a>

    <a id="5260" href="Ledger.Properties.html#5260" class="Function">newChainState</a> <a id="5274" class="Symbol">:</a> <a id="5276" href="Ledger.Chain.html#551" class="Record">ChainState</a>
    <a id="5291" href="Ledger.Properties.html#5260" class="Function">newChainState</a> <a id="5305" class="Symbol">=</a> <a id="5307" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5313" href="Ledger.Properties.html#5127" class="Bound">valid</a>

    <a id="5324" href="Ledger.Properties.html#5324" class="Function">getEnactState</a> <a id="5338" class="Symbol">:</a> <a id="5340" href="Ledger.Chain.html#551" class="Record">ChainState</a> <a id="5351" class="Symbol">→</a> <a id="5353" href="Ledger.Enact.html#397" class="Record">EnactState</a>
    <a id="5368" href="Ledger.Properties.html#5324" class="Function">getEnactState</a> <a id="5382" class="Symbol">=</a> <a id="5384" href="Ledger.Epoch.html#1268" class="Field">EpochState.es</a> <a id="5398" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5400" href="Ledger.Epoch.html#1393" class="Field">NewEpochState.epochState</a> <a id="5425" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5427" href="Ledger.Chain.html#587" class="Field">ChainState.newEpochState</a>

    <a id="5457" class="Comment">-- enact-change⇒newEpoch : es ≢ getEnactState newChainState → isNewEpochBlock</a>
    <a id="5539" class="Comment">-- enact-change⇒newEpoch = {!!}</a>

  <a id="5574" class="Comment">-- Invariant properties</a>

  <a id="5601" href="Ledger.Properties.html#5601" class="Function">action-deposits≡actions-prop</a> <a id="5630" class="Symbol">:</a> <a id="5632" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5639" href="Ledger.Properties.html#5601" class="Function">action-deposits≡actions-prop</a> <a id="5668" class="Symbol">=</a> <a id="5670" href="abstract-set-theory.FiniteSetTheory.html#2813" class="Function">filterˢ</a> <a id="5678" href="Ledger.Properties.html#830" class="Function">isGADeposit</a> <a id="5690" class="Symbol">(</a><a id="5691" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5695" class="Symbol">(</a><a id="5696" href="Ledger.Utxo.html#2624" class="Field">UTxOState.deposits</a> <a id="5715" href="Ledger.Ledger.html#774" class="Function">utxoSt</a><a id="5721" class="Symbol">))</a>
    <a id="5728" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5730" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="5739" class="Symbol">(</a><a id="5740" href="Class.Functor.Core.html#263" class="Function">map</a> <a id="5744" class="Symbol">(λ</a> <a id="5747" class="Keyword">where</a> <a id="5753" class="Symbol">(</a><a id="5754" href="Ledger.Properties.html#5754" class="Bound">id</a> <a id="5757" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5759" class="Symbol">_)</a> <a id="5762" class="Symbol">→</a> <a id="5764" href="Ledger.Certs.html#475" class="InductiveConstructor">GovActionDeposit</a> <a id="5781" href="Ledger.Properties.html#5754" class="Bound">id</a><a id="5783" class="Symbol">)</a> <a id="5785" href="Ledger.Ledger.html#801" class="Function">govSt</a><a id="5790" class="Symbol">)</a>

  <a id="5795" href="Ledger.Properties.html#5795" class="Function">dom-rwds≡credDeposits</a> <a id="5817" class="Symbol">:</a> <a id="5819" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5826" href="Ledger.Properties.html#5795" class="Function">dom-rwds≡credDeposits</a> <a id="5848" class="Symbol">=</a> <a id="5850" href="abstract-set-theory.FiniteSetTheory.html#2813" class="Function">filterˢ</a> <a id="5858" href="Ledger.Properties.html#487" class="Function">isCredDeposit</a> <a id="5872" class="Symbol">(</a><a id="5873" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5877" class="Symbol">(</a><a id="5878" href="Ledger.Utxo.html#2624" class="Field">UTxOState.deposits</a> <a id="5897" href="Ledger.Ledger.html#774" class="Function">utxoSt</a><a id="5903" class="Symbol">))</a>
    <a id="5910" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5912" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5917" href="Ledger.Certs.html#316" class="InductiveConstructor">CredentialDeposit</a> <a id="5935" class="Symbol">(</a><a id="5936" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5940" href="Ledger.Certs.html#2531" class="Function">rewards</a><a id="5947" class="Symbol">)</a>

  <a id="5952" href="Ledger.Properties.html#5952" class="Function">pp-wellFormed</a> <a id="5966" class="Symbol">:</a> <a id="5968" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5975" href="Ledger.Properties.html#5952" class="Function">pp-wellFormed</a> <a id="5989" class="Symbol">=</a> <a id="5991" href="Ledger.PParams.html#3409" class="Function">paramsWellFormed</a> <a id="6008" href="Ledger.Properties.html#3903" class="Function">pparams</a>

<a id="6017" class="Comment">-- action-deposits≡actions-inv : ChainInvariant action-deposits≡actions-prop</a>
<a id="6094" class="Comment">-- action-deposits≡actions-inv = {!!}</a>

<a id="6133" class="Comment">-- dom-rwds≡credDeposits-inv : ChainInvariant dom-rwds≡credDeposits</a>
<a id="6201" class="Comment">-- dom-rwds≡credDeposits-inv = {!!}</a>

<a id="6238" class="Comment">-- pp-wellFormed-inv : ChainInvariant pp-wellFormed</a>
<a id="6290" class="Comment">-- pp-wellFormed-inv = {!!}</a>

<a id="6319" class="Comment">-- Epoch boundary properties</a>

<a id="6349" class="Comment">-- module _ {Γ es e es&#39;} (step : Γ ⊢ es ⇀⦇ e ,NEWEPOCH⦈ es&#39;) where</a>
<a id="6416" class="Comment">--   dom-rwds-const : dom (getRewards es) ≡ dom (getRewards es&#39;)</a>
<a id="6481" class="Comment">--   dom-rwds-const = {!!}</a>

<a id="6509" class="Comment">--   prop≡∅⇒activeDReps-const : getGovState es ≡ [] → activeDReps e es ≡ᵉ activeDReps (sucᵉ e) es&#39;</a>
<a id="6608" class="Comment">--   prop≡∅⇒activeDReps-const = {!!}</a>
</pre></body></html>