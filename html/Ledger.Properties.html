<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Properties</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Symbol">#-}</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="52" class="Keyword">open</a> <a id="57" class="Keyword">import</a> <a id="64" href="Ledger.Abstract.html" class="Module">Ledger.Abstract</a>
<a id="80" class="Keyword">open</a> <a id="85" class="Keyword">import</a> <a id="92" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a>

<a id="112" class="Keyword">module</a> <a id="119" href="Ledger.Properties.html" class="Module">Ledger.Properties</a>
  <a id="139" class="Symbol">(</a><a id="140" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="144" class="Symbol">:</a> <a id="146" class="Symbol">_)</a> <a id="149" class="Symbol">(</a><a id="150" class="Keyword">open</a> <a id="155" href="Ledger.Transaction.html#867" class="Module">TransactionStructure</a> <a id="176" href="Ledger.Properties.html#140" class="Bound">txs</a><a id="179" class="Symbol">)</a>
  <a id="183" class="Symbol">(</a><a id="184" href="Ledger.Properties.html#184" class="Bound">abs</a> <a id="188" class="Symbol">:</a> <a id="190" href="Ledger.Abstract.html#578" class="Record">AbstractFunctions</a> <a id="208" href="Ledger.Properties.html#140" class="Bound">txs</a><a id="211" class="Symbol">)</a> <a id="213" class="Symbol">(</a><a id="214" class="Keyword">open</a> <a id="219" href="Ledger.Abstract.html#578" class="Module">AbstractFunctions</a> <a id="237" href="Ledger.Properties.html#184" class="Bound">abs</a><a id="240" class="Symbol">)</a>
  <a id="244" class="Keyword">where</a>

<a id="251" class="Keyword">open</a> <a id="256" class="Keyword">import</a> <a id="263" href="Ledger.Chain.html" class="Module">Ledger.Chain</a> <a id="276" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="280" href="Ledger.Properties.html#184" class="Bound">abs</a>
<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="Ledger.Utxo.html" class="Module">Ledger.Utxo</a> <a id="308" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="312" href="Ledger.Properties.html#184" class="Bound">abs</a>
<a id="316" class="Keyword">open</a> <a id="321" class="Keyword">import</a> <a id="328" href="Ledger.Epoch.html" class="Module">Ledger.Epoch</a> <a id="341" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="345" href="Ledger.Properties.html#184" class="Bound">abs</a>
<a id="349" class="Keyword">open</a> <a id="354" class="Keyword">import</a> <a id="361" href="Ledger.Ledger.html" class="Module">Ledger.Ledger</a> <a id="375" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="379" href="Ledger.Properties.html#184" class="Bound">abs</a>
<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Ledger.Enact.html" class="Module">Ledger.Enact</a> <a id="408" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="421" class="Keyword">open</a> <a id="426" class="Keyword">import</a> <a id="433" href="Ledger.Certs.html" class="Module">Ledger.Certs</a> <a id="446" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Ledger.Gov.html" class="Module">Ledger.Gov</a> <a id="482" href="Ledger.Properties.html#140" class="Bound">txs</a>

<a id="isCredDeposit"></a><a id="487" href="Ledger.Properties.html#487" class="Function">isCredDeposit</a> <a id="501" class="Symbol">:</a> <a id="503" href="Ledger.Certs.html#332" class="Datatype">DepositPurpose</a> <a id="518" class="Symbol">→</a> <a id="520" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="525" href="Ledger.Properties.html#487" class="Function">isCredDeposit</a> <a id="539" class="Symbol">(</a><a id="540" href="Ledger.Certs.html#362" class="InductiveConstructor">CredentialDeposit</a> <a id="558" href="Ledger.Properties.html#558" class="Bound">x</a><a id="559" class="Symbol">)</a> <a id="561" class="Symbol">=</a> <a id="563" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="565" href="Ledger.Properties.html#487" class="CatchallClause Function">isCredDeposit</a><a id="578" class="CatchallClause"> </a><a id="579" class="CatchallClause Symbol">_</a> <a id="581" class="Symbol">=</a> <a id="583" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="586" class="Keyword">instance</a>
  <a id="isCredDeposit?"></a><a id="597" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="612" class="Symbol">:</a> <a id="614" href="Ledger.Properties.html#487" class="Function">isCredDeposit</a> <a id="628" href="Class.Decidable.Core.html#762" class="Function Operator">⁇¹</a>
  <a id="633" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="648" class="Symbol">{</a><a id="649" href="Ledger.Certs.html#362" class="InductiveConstructor">CredentialDeposit</a> <a id="667" href="Ledger.Properties.html#667" class="Bound">x</a><a id="668" class="Symbol">}</a> <a id="670" class="Symbol">=</a> <a id="672" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="674" class="Symbol">(</a><a id="675" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="679" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="681" class="Symbol">)</a>
  <a id="685" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="700" class="Symbol">{</a><a id="701" href="Ledger.Certs.html#415" class="InductiveConstructor">PoolDeposit</a> <a id="713" href="Ledger.Properties.html#713" class="Bound">x</a><a id="714" class="Symbol">}</a> <a id="716" class="Symbol">=</a> <a id="718" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="720" class="Symbol">(</a><a id="721" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="724" class="Symbol">λ</a> <a id="726" class="Symbol">())</a>
  <a id="732" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="747" class="Symbol">{</a><a id="748" href="Ledger.Certs.html#468" class="InductiveConstructor">DRepDeposit</a> <a id="760" href="Ledger.Properties.html#760" class="Bound">x</a><a id="761" class="Symbol">}</a> <a id="763" class="Symbol">=</a> <a id="765" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="767" class="Symbol">(</a><a id="768" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="771" class="Symbol">λ</a> <a id="773" class="Symbol">())</a>
  <a id="779" href="Ledger.Properties.html#597" class="Function">isCredDeposit?</a> <a id="794" class="Symbol">{</a><a id="795" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="812" href="Ledger.Properties.html#812" class="Bound">x</a><a id="813" class="Symbol">}</a> <a id="815" class="Symbol">=</a> <a id="817" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="819" class="Symbol">(</a><a id="820" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="823" class="Symbol">λ</a> <a id="825" class="Symbol">())</a>

<a id="isGADeposit"></a><a id="830" href="Ledger.Properties.html#830" class="Function">isGADeposit</a> <a id="842" class="Symbol">:</a> <a id="844" href="Ledger.Certs.html#332" class="Datatype">DepositPurpose</a> <a id="859" class="Symbol">→</a> <a id="861" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="866" href="Ledger.Properties.html#830" class="Function">isGADeposit</a> <a id="878" class="Symbol">(</a><a id="879" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="896" href="Ledger.Properties.html#896" class="Bound">x</a><a id="897" class="Symbol">)</a> <a id="899" class="Symbol">=</a> <a id="901" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="903" href="Ledger.Properties.html#830" class="CatchallClause Function">isGADeposit</a><a id="914" class="CatchallClause"> </a><a id="915" class="CatchallClause Symbol">_</a> <a id="917" class="Symbol">=</a> <a id="919" href="Data.Empty.html#914" class="Function">⊥</a>

<a id="922" class="Keyword">instance</a>
  <a id="isGADeposit?"></a><a id="933" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="946" class="Symbol">:</a> <a id="948" href="Ledger.Properties.html#830" class="Function">isGADeposit</a> <a id="960" href="Class.Decidable.Core.html#762" class="Function Operator">⁇¹</a>
  <a id="965" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="978" class="Symbol">{</a><a id="979" href="Ledger.Certs.html#362" class="InductiveConstructor">CredentialDeposit</a> <a id="997" href="Ledger.Properties.html#997" class="Bound">x</a><a id="998" class="Symbol">}</a> <a id="1000" class="Symbol">=</a> <a id="1002" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1004" class="Symbol">(</a><a id="1005" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1008" class="Symbol">λ</a> <a id="1010" class="Symbol">())</a>
  <a id="1016" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="1029" class="Symbol">{</a><a id="1030" href="Ledger.Certs.html#415" class="InductiveConstructor">PoolDeposit</a> <a id="1042" href="Ledger.Properties.html#1042" class="Bound">x</a><a id="1043" class="Symbol">}</a> <a id="1045" class="Symbol">=</a> <a id="1047" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1049" class="Symbol">(</a><a id="1050" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1053" class="Symbol">λ</a> <a id="1055" class="Symbol">())</a>
  <a id="1061" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="1074" class="Symbol">{</a><a id="1075" href="Ledger.Certs.html#468" class="InductiveConstructor">DRepDeposit</a> <a id="1087" href="Ledger.Properties.html#1087" class="Bound">x</a><a id="1088" class="Symbol">}</a> <a id="1090" class="Symbol">=</a> <a id="1092" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1094" class="Symbol">(</a><a id="1095" href="Relation.Nullary.Decidable.Core.html#2031" class="InductiveConstructor">no</a> <a id="1098" class="Symbol">λ</a> <a id="1100" class="Symbol">())</a>
  <a id="1106" href="Ledger.Properties.html#933" class="Function">isGADeposit?</a> <a id="1119" class="Symbol">{</a><a id="1120" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="1137" href="Ledger.Properties.html#1137" class="Bound">x</a><a id="1138" class="Symbol">}</a> <a id="1140" class="Symbol">=</a> <a id="1142" href="Class.Decidable.Core.html#253" class="InductiveConstructor Operator">⁇</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Relation.Nullary.Decidable.Core.html#1994" class="InductiveConstructor">yes</a> <a id="1149" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="1151" class="Symbol">)</a>

<a id="activeDReps"></a><a id="1154" href="Ledger.Properties.html#1154" class="Function">activeDReps</a> <a id="1166" class="Symbol">:</a> <a id="1168" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a> <a id="1174" class="Symbol">→</a> <a id="1176" href="Ledger.Epoch.html#1878" class="Record">NewEpochState</a> <a id="1190" class="Symbol">→</a> <a id="1192" href="abstract-set-theory.FiniteSetTheory.html#488" class="Function Operator">ℙ</a> <a id="1194" href="Ledger.Address.html#273" class="Datatype">Credential</a>
<a id="1205" href="Ledger.Properties.html#1154" class="Function">activeDReps</a> <a id="1217" href="Ledger.Properties.html#1217" class="Bound">currentEpoch</a> <a id="1230" href="Ledger.Properties.html#1230" class="Bound">s</a> <a id="1232" class="Symbol">=</a> <a id="1234" href="Class.IsSet.html#916" class="Function">dom</a> <a id="1238" class="Symbol">(</a><a id="1239" href="abstract-set-theory.FiniteSetTheory.html#2895" class="Function">filterᵐ</a> <a id="1247" class="Symbol">(λ</a> <a id="1250" class="Symbol">(_</a> <a id="1253" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1255" href="Ledger.Properties.html#1255" class="Bound">e</a><a id="1256" class="Symbol">)</a> <a id="1258" class="Symbol">→</a> <a id="1260" href="Ledger.Properties.html#1217" class="Bound">currentEpoch</a> <a id="1273" href="Class.HasOrder.Core.html#608" class="Field Operator">≤</a> <a id="1275" href="Ledger.Properties.html#1255" class="Bound">e</a><a id="1276" class="Symbol">)</a> <a id="1278" class="Symbol">(</a><a id="1279" href="Ledger.Certs.html#955" class="Field">DRepsOf</a> <a id="1287" href="Ledger.Properties.html#1230" class="Bound">s</a><a id="1288" class="Symbol">))</a>

<a id="1292" class="Keyword">instance</a>
  <a id="1303" href="Ledger.Properties.html#1303" class="Function">_</a> <a id="1305" class="Symbol">:</a> <a id="1307" href="Class.IsSet.html#375" class="Record">IsSet</a> <a id="1313" href="Ledger.Chain.html#626" class="Record">Block</a> <a id="1319" href="Ledger.Transaction.html#4234" class="Record">Tx</a>
  <a id="1324" class="Symbol">_</a> <a id="1326" class="Symbol">=</a> <a id="1328" class="Keyword">record</a> <a id="1335" class="Symbol">{</a> <a id="1337" href="Class.IsSet.html#419" class="Field">toSet</a> <a id="1343" class="Symbol">=</a> <a id="1345" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1354" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1356" href="Ledger.Chain.html#657" class="Field">Block.ts</a> <a id="1365" class="Symbol">}</a>

  <a id="1370" href="Ledger.Properties.html#1370" class="Function">_</a> <a id="1372" class="Symbol">:</a> <a id="1374" href="Class.IsSet.html#375" class="Record">IsSet</a> <a id="1380" href="Ledger.Transaction.html#2691" class="Record">TxBody</a> <a id="1387" href="Ledger.GovernanceActions.html#2372" class="Record">GovProposal</a>
  <a id="1401" class="Symbol">_</a> <a id="1403" class="Symbol">=</a> <a id="1405" class="Keyword">record</a> <a id="1412" class="Symbol">{</a> <a id="1414" href="Class.IsSet.html#419" class="Field">toSet</a> <a id="1420" class="Symbol">=</a> <a id="1422" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="1431" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1433" href="Ledger.Transaction.html#3023" class="Field">TxBody.txprop</a> <a id="1447" class="Symbol">}</a>

<a id="validBlockIn"></a><a id="1450" href="Ledger.Properties.html#1450" class="Function">validBlockIn</a> <a id="1463" class="Symbol">:</a> <a id="1465" href="Ledger.Chain.html#551" class="Record">ChainState</a> <a id="1476" class="Symbol">→</a> <a id="1478" href="Ledger.Chain.html#626" class="Record">Block</a> <a id="1484" class="Symbol">→</a> <a id="1486" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1491" href="Ledger.Properties.html#1450" class="Function">validBlockIn</a> <a id="1504" href="Ledger.Properties.html#1504" class="Bound">s</a> <a id="1506" href="Ledger.Properties.html#1506" class="Bound">b</a> <a id="1508" class="Symbol">=</a> <a id="1510" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="1513" href="Ledger.Properties.html#1513" class="Bound">s&#39;</a> <a id="1516" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="1518" class="Symbol">_</a> <a id="1520" href="Ledger.Chain.html#3662" class="Datatype Operator">⊢</a> <a id="1522" href="Ledger.Properties.html#1504" class="Bound">s</a> <a id="1524" href="Ledger.Chain.html#3662" class="Datatype Operator">⇀⦇</a> <a id="1527" href="Ledger.Properties.html#1506" class="Bound">b</a> <a id="1529" href="Ledger.Chain.html#3662" class="Datatype Operator">,CHAIN⦈</a> <a id="1537" href="Ledger.Properties.html#1513" class="Bound">s&#39;</a>

<a id="validBlock"></a><a id="1541" href="Ledger.Properties.html#1541" class="Function">validBlock</a> <a id="1552" class="Symbol">:</a> <a id="1554" href="Ledger.Chain.html#626" class="Record">Block</a> <a id="1560" class="Symbol">→</a> <a id="1562" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="1567" href="Ledger.Properties.html#1541" class="Function">validBlock</a> <a id="1578" href="Ledger.Properties.html#1578" class="Bound">b</a> <a id="1580" class="Symbol">=</a> <a id="1582" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="1585" href="Ledger.Properties.html#1585" class="Bound">s</a> <a id="1587" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="1589" href="Ledger.Properties.html#1450" class="Function">validBlockIn</a> <a id="1602" href="Ledger.Properties.html#1585" class="Bound">s</a> <a id="1604" href="Ledger.Properties.html#1578" class="Bound">b</a>

<a id="1607" class="Comment">-- Transaction validity is complicated. In the truest sense, a</a>
<a id="1670" class="Comment">-- transaction is valid if it is part of a valid block,</a>
<a id="1726" class="Comment">-- i.e. `validTxIn₁`. However, a transaction can also be seen as valid</a>
<a id="1797" class="Comment">-- if it could be applied at a certain slot (with no knowledge of an</a>
<a id="1866" class="Comment">-- actual block). This is closer to how the mempool sees transaction</a>
<a id="1935" class="Comment">-- validity and is expressed by `validTxIn₂`.</a>

<a id="1982" class="Comment">-- Note that these two are not equivalent and in fact there is no</a>
<a id="2048" class="Comment">-- implication between the two in either direction. `2 =&gt; 1` would</a>
<a id="2115" class="Comment">-- require one to come up with a block, which we can&#39;t, but `1 =&gt; 2`</a>
<a id="2184" class="Comment">-- is also not true, since the transaction might depend on a previous</a>
<a id="2254" class="Comment">-- transaction in the same block. Maybe this means that `validTxIn₂`</a>
<a id="2323" class="Comment">-- should be changed so that it allows for applying a list of</a>
<a id="2385" class="Comment">-- transactions before the final transaction? However, the downside</a>
<a id="2453" class="Comment">-- then becomes that the transaction isn&#39;t applied to the given state</a>
<a id="2523" class="Comment">-- but to some intermediate one. Maybe we&#39;ll gain some insight on this</a>
<a id="2594" class="Comment">-- matter once we have proven more theorems.</a>

<a id="validTxIn₁"></a><a id="2640" href="Ledger.Properties.html#2640" class="Function">validTxIn₁</a> <a id="2651" class="Symbol">:</a> <a id="2653" href="Ledger.Chain.html#551" class="Record">ChainState</a> <a id="2664" class="Symbol">→</a> <a id="2666" href="Ledger.Transaction.html#4234" class="Record">Tx</a> <a id="2669" class="Symbol">→</a> <a id="2671" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="2676" href="Ledger.Properties.html#2640" class="Function">validTxIn₁</a> <a id="2687" href="Ledger.Properties.html#2687" class="Bound">s</a> <a id="2689" href="Ledger.Properties.html#2689" class="Bound">tx</a> <a id="2692" class="Symbol">=</a> <a id="2694" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="2697" href="Ledger.Properties.html#2697" class="Bound">b</a> <a id="2699" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="2701" href="Ledger.Properties.html#2689" class="Bound">tx</a> <a id="2704" href="Class.IsSet.html#458" class="Function Operator">∈</a> <a id="2706" href="Ledger.Properties.html#2697" class="Bound">b</a> <a id="2708" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2710" href="Ledger.Properties.html#1450" class="Function">validBlockIn</a> <a id="2723" href="Ledger.Properties.html#2687" class="Bound">s</a> <a id="2725" href="Ledger.Properties.html#2697" class="Bound">b</a>

<a id="2728" class="Keyword">module</a> <a id="2735" href="Ledger.Properties.html#2735" class="Module">_</a> <a id="2737" class="Symbol">(</a><a id="2738" href="Ledger.Properties.html#2738" class="Bound">s</a> <a id="2740" class="Symbol">:</a> <a id="2742" href="Ledger.Chain.html#551" class="Record">ChainState</a><a id="2752" class="Symbol">)</a> <a id="2754" class="Symbol">(</a><a id="2755" href="Ledger.Properties.html#2755" class="Bound">slot</a> <a id="2760" class="Symbol">:</a> <a id="2762" href="Ledger.Types.Epoch.html#552" class="Function">Slot</a><a id="2766" class="Symbol">)</a> <a id="2768" class="Keyword">where</a>

  <a id="2777" class="Keyword">open</a> <a id="2782" href="Ledger.Chain.html#551" class="Module">ChainState</a> <a id="2793" href="Ledger.Properties.html#2738" class="Bound">s</a><a id="2794" class="Symbol">;</a> <a id="2796" class="Keyword">open</a> <a id="2801" href="Ledger.Epoch.html#1878" class="Module">NewEpochState</a> <a id="2815" href="Ledger.Chain.html#587" class="Function">newEpochState</a>
  <a id="2831" class="Keyword">open</a> <a id="2836" href="Ledger.Epoch.html#1098" class="Module">EpochState</a> <a id="2847" href="Ledger.Epoch.html#1941" class="Function">epochState</a><a id="2857" class="Symbol">;</a> <a id="2859" class="Keyword">open</a> <a id="2864" href="Ledger.Enact.html#397" class="Module">EnactState</a> <a id="2875" href="Ledger.Epoch.html#1239" class="Function">es</a>

  <a id="2881" class="Keyword">private</a>
    <a id="2893" href="Ledger.Properties.html#2893" class="Function">ledgerEnv</a> <a id="2903" class="Symbol">=</a> <a id="2905" href="Ledger.Prelude.html#2291" class="Function Operator">⟦</a> <a id="2907" href="Ledger.Properties.html#2755" class="Bound">slot</a> <a id="2912" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2914" href="Ledger.Prelude.html#2393" class="Function Operator">∣</a> <a id="2916" href="Ledger.Enact.html#502" class="Function">constitution</a> <a id="2929" href="Ledger.Prelude.html#2393" class="Function Operator">∣</a> <a id="2931" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2933" href="Ledger.Prelude.html#2393" class="Function Operator">∣</a> <a id="2935" href="Ledger.Enact.html#607" class="Function">pparams</a> <a id="2943" href="Ledger.Prelude.html#2393" class="Function Operator">∣</a> <a id="2945" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2947" href="Ledger.Epoch.html#1239" class="Function">es</a> <a id="2950" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2952" href="Ledger.PParams.html#729" class="Field">Acnt.treasury</a> <a id="2966" href="Ledger.Epoch.html#1166" class="Function">acnt</a> <a id="2971" href="Ledger.Prelude.html#2291" class="Function Operator">⟧</a>

  <a id="2976" href="Ledger.Properties.html#2976" class="Function">validTxIn₂</a> <a id="2987" class="Symbol">:</a> <a id="2989" href="Ledger.Transaction.html#4234" class="Record">Tx</a> <a id="2992" class="Symbol">→</a> <a id="2994" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="3001" href="Ledger.Properties.html#2976" class="Function">validTxIn₂</a> <a id="3012" href="Ledger.Properties.html#3012" class="Bound">tx</a> <a id="3015" class="Symbol">=</a> <a id="3017" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3020" href="Ledger.Properties.html#3020" class="Bound">ls&#39;</a> <a id="3024" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3026" href="Ledger.Properties.html#2893" class="Function">ledgerEnv</a> <a id="3036" href="Ledger.Ledger.html#2581" class="Datatype Operator">⊢</a> <a id="3038" href="Ledger.Epoch.html#1215" class="Function">ls</a> <a id="3041" href="Ledger.Ledger.html#2581" class="Datatype Operator">⇀⦇</a> <a id="3044" href="Ledger.Properties.html#3012" class="Bound">tx</a> <a id="3047" href="Ledger.Ledger.html#2581" class="Datatype Operator">,LEDGER⦈</a> <a id="3056" href="Ledger.Properties.html#3020" class="Bound">ls&#39;</a>

<a id="validTx₁"></a><a id="3061" href="Ledger.Properties.html#3061" class="Function">validTx₁</a> <a id="3070" class="Symbol">:</a> <a id="3072" href="Ledger.Transaction.html#4234" class="Record">Tx</a> <a id="3075" class="Symbol">→</a> <a id="3077" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="3082" href="Ledger.Properties.html#3061" class="Function">validTx₁</a> <a id="3091" href="Ledger.Properties.html#3091" class="Bound">tx</a> <a id="3094" class="Symbol">=</a> <a id="3096" href="Data.Product.Base.html#1371" class="Function">∃[</a> <a id="3099" href="Ledger.Properties.html#3099" class="Bound">s</a> <a id="3101" href="Data.Product.Base.html#1371" class="Function">]</a> <a id="3103" href="Ledger.Properties.html#2640" class="Function">validTxIn₁</a> <a id="3114" href="Ledger.Properties.html#3099" class="Bound">s</a> <a id="3116" href="Ledger.Properties.html#3091" class="Bound">tx</a>

<a id="ChainInvariant"></a><a id="3120" href="Ledger.Properties.html#3120" class="Function">ChainInvariant</a> <a id="3135" class="Symbol">:</a> <a id="3137" class="Symbol">∀</a> <a id="3139" class="Symbol">{</a><a id="3140" href="Ledger.Properties.html#3140" class="Bound">a</a><a id="3141" class="Symbol">}</a> <a id="3143" class="Symbol">→</a> <a id="3145" class="Symbol">(</a><a id="3146" href="Ledger.Chain.html#551" class="Record">ChainState</a> <a id="3157" class="Symbol">→</a> <a id="3159" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3164" href="Ledger.Properties.html#3140" class="Bound">a</a><a id="3165" class="Symbol">)</a> <a id="3167" class="Symbol">→</a> <a id="3169" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3174" href="Ledger.Properties.html#3140" class="Bound">a</a>
<a id="3176" href="Ledger.Properties.html#3120" class="Function">ChainInvariant</a> <a id="3191" href="Ledger.Properties.html#3191" class="Bound">P</a> <a id="3193" class="Symbol">=</a> <a id="3195" class="Symbol">∀</a> <a id="3197" href="Ledger.Properties.html#3197" class="Bound">b</a> <a id="3199" href="Ledger.Properties.html#3199" class="Bound">s</a> <a id="3201" href="Ledger.Properties.html#3201" class="Bound">s&#39;</a> <a id="3204" class="Symbol">→</a> <a id="3206" class="Symbol">_</a> <a id="3208" href="Ledger.Chain.html#3662" class="Datatype Operator">⊢</a> <a id="3210" href="Ledger.Properties.html#3199" class="Bound">s</a> <a id="3212" href="Ledger.Chain.html#3662" class="Datatype Operator">⇀⦇</a> <a id="3215" href="Ledger.Properties.html#3197" class="Bound">b</a> <a id="3217" href="Ledger.Chain.html#3662" class="Datatype Operator">,CHAIN⦈</a> <a id="3225" href="Ledger.Properties.html#3201" class="Bound">s&#39;</a> <a id="3228" class="Symbol">→</a> <a id="3230" href="Ledger.Properties.html#3191" class="Bound">P</a> <a id="3232" href="Ledger.Properties.html#3199" class="Bound">s</a> <a id="3234" class="Symbol">→</a> <a id="3236" href="Ledger.Properties.html#3191" class="Bound">P</a> <a id="3238" href="Ledger.Properties.html#3201" class="Bound">s&#39;</a>

<a id="3242" class="Keyword">module</a> <a id="3249" href="Ledger.Properties.html#3249" class="Module">_</a> <a id="3251" class="Symbol">(</a><a id="3252" href="Ledger.Properties.html#3252" class="Bound">s</a> <a id="3254" class="Symbol">:</a> <a id="3256" href="Ledger.Chain.html#551" class="Record">ChainState</a><a id="3266" class="Symbol">)</a> <a id="3268" class="Keyword">where</a>
  <a id="3276" class="Keyword">open</a> <a id="3281" href="Ledger.Chain.html#551" class="Module">ChainState</a> <a id="3292" href="Ledger.Properties.html#3252" class="Bound">s</a><a id="3293" class="Symbol">;</a> <a id="3295" class="Keyword">open</a> <a id="3300" href="Ledger.Epoch.html#1878" class="Module">NewEpochState</a> <a id="3314" href="Ledger.Chain.html#587" class="Field">newEpochState</a><a id="3327" class="Symbol">;</a> <a id="3329" class="Keyword">open</a> <a id="3334" href="Ledger.Epoch.html#1098" class="Module">EpochState</a> <a id="3345" href="Ledger.Epoch.html#1941" class="Function">epochState</a>
  <a id="3358" class="Keyword">open</a> <a id="3363" href="Ledger.Ledger.html#809" class="Module">LState</a> <a id="3370" href="Ledger.Epoch.html#1215" class="Function">ls</a>
  <a id="3375" class="Keyword">open</a> <a id="3380" href="Ledger.Enact.html#397" class="Module">EnactState</a> <a id="3391" href="Ledger.Epoch.html#1239" class="Function">es</a> <a id="3394" class="Keyword">renaming</a> <a id="3403" class="Symbol">(</a><a id="3404" href="Ledger.Enact.html#607" class="Field">pparams</a> <a id="3412" class="Symbol">to</a> <a id="3415" class="Field">pparams&#39;</a><a id="3423" class="Symbol">)</a>
  <a id="3427" class="Keyword">open</a> <a id="3432" href="Ledger.Certs.html#3897" class="Module">CertState</a> <a id="3442" href="Ledger.Ledger.html#921" class="Function">certState</a><a id="3451" class="Symbol">;</a> <a id="3453" class="Keyword">open</a> <a id="3458" href="Ledger.Certs.html#2963" class="Module">DState</a> <a id="3465" href="Ledger.Certs.html#3960" class="Function">dState</a>
  <a id="3474" href="Ledger.Properties.html#3474" class="Function">pparams</a> <a id="3482" class="Symbol">=</a> <a id="3484" href="Ledger.Prelude.html#2393" class="Function Operator">∣</a> <a id="3486" href="Ledger.Properties.html#3415" class="Function">pparams&#39;</a> <a id="3495" href="Ledger.Prelude.html#2393" class="Function Operator">∣</a>
  <a id="3499" class="Keyword">open</a> <a id="3504" href="Ledger.PParams.html#1570" class="Module">PParams</a> <a id="3512" href="Ledger.Properties.html#3474" class="Function">pparams</a>
  <a id="3522" class="Keyword">open</a> <a id="3527" href="Ledger.Transaction.html#4234" class="Module">Tx</a><a id="3529" class="Symbol">;</a> <a id="3531" class="Keyword">open</a> <a id="3536" href="Ledger.Transaction.html#2691" class="Module">TxBody</a>

  <a id="3546" class="Comment">-- Transaction properties</a>

  <a id="3575" class="Keyword">module</a> <a id="3582" href="Ledger.Properties.html#3582" class="Module">_</a> <a id="3584" class="Symbol">{</a><a id="3585" href="Ledger.Properties.html#3585" class="Bound">slot</a><a id="3589" class="Symbol">}</a> <a id="3591" class="Symbol">{</a><a id="3592" href="Ledger.Properties.html#3592" class="Bound">tx</a><a id="3594" class="Symbol">}</a> <a id="3596" class="Symbol">(</a><a id="3597" class="Keyword">let</a> <a id="3601" href="Ledger.Properties.html#3601" class="Bound">txb</a> <a id="3605" class="Symbol">=</a> <a id="3607" href="Ledger.Transaction.html#4266" class="Field">body</a> <a id="3612" href="Ledger.Properties.html#3592" class="Bound">tx</a><a id="3614" class="Symbol">)</a> <a id="3616" class="Symbol">(</a><a id="3617" href="Ledger.Properties.html#3617" class="Bound">valid</a> <a id="3623" class="Symbol">:</a> <a id="3625" href="Ledger.Properties.html#2976" class="Function">validTxIn₂</a> <a id="3636" href="Ledger.Properties.html#3252" class="Bound">s</a> <a id="3638" href="Ledger.Properties.html#3585" class="Bound">slot</a> <a id="3643" href="Ledger.Properties.html#3592" class="Bound">tx</a><a id="3645" class="Symbol">)</a>
    <a id="3651" class="Symbol">(</a><a id="3652" href="Ledger.Properties.html#3652" class="Bound">indexedSum-∪⁺-hom</a> <a id="3670" class="Symbol">:</a> <a id="3672" class="Symbol">∀</a> <a id="3674" class="Symbol">{</a><a id="3675" href="Ledger.Properties.html#3675" class="Bound">A</a> <a id="3677" href="Ledger.Properties.html#3677" class="Bound">V</a> <a id="3679" class="Symbol">:</a> <a id="3681" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="3685" class="Symbol">}</a> <a id="3687" class="Symbol">⦃</a> <a id="3689" href="Ledger.Properties.html#3689" class="Bound">_</a> <a id="3691" class="Symbol">:</a> <a id="3693" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="3699" href="Ledger.Properties.html#3675" class="Bound">A</a> <a id="3701" class="Symbol">⦄</a> <a id="3703" class="Symbol">⦃</a> <a id="3705" href="Ledger.Properties.html#3705" class="Bound">_</a> <a id="3707" class="Symbol">:</a> <a id="3709" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="3715" href="Ledger.Properties.html#3677" class="Bound">V</a> <a id="3717" class="Symbol">⦄</a> <a id="3719" class="Symbol">⦃</a> <a id="3721" href="Ledger.Properties.html#3721" class="Bound">mon</a> <a id="3725" class="Symbol">:</a> <a id="3727" href="Class.CommutativeMonoid.Core.html#191" class="Record">CommutativeMonoid</a> <a id="3745" href="Level.html#521" class="Function">0ℓ</a> <a id="3748" href="Level.html#521" class="Function">0ℓ</a> <a id="3751" href="Ledger.Properties.html#3677" class="Bound">V</a> <a id="3753" class="Symbol">⦄</a>
      <a id="3761" class="Symbol">→</a> <a id="3763" class="Symbol">(</a><a id="3764" href="Ledger.Properties.html#3764" class="Bound">d₁</a> <a id="3767" href="Ledger.Properties.html#3767" class="Bound">d₂</a> <a id="3770" class="Symbol">:</a> <a id="3772" href="Ledger.Properties.html#3675" class="Bound">A</a> <a id="3774" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3776" href="Ledger.Properties.html#3677" class="Bound">V</a><a id="3777" class="Symbol">)</a> <a id="3779" class="Symbol">→</a> <a id="3781" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="3794" href="Function.Base.html#704" class="Function">id</a> <a id="3797" class="Symbol">(</a><a id="3798" href="Ledger.Properties.html#3764" class="Bound">d₁</a> <a id="3801" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="3804" href="Ledger.Properties.html#3767" class="Bound">d₂</a><a id="3806" class="Symbol">)</a> <a id="3808" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3810" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="3823" href="Function.Base.html#704" class="Function">id</a> <a id="3826" href="Ledger.Properties.html#3764" class="Bound">d₁</a> <a id="3829" href="Class.Semigroup.Core.html#173" class="Field Operator">◇</a> <a id="3831" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="3844" href="Function.Base.html#704" class="Function">id</a> <a id="3847" href="Ledger.Properties.html#3767" class="Bound">d₂</a><a id="3849" class="Symbol">)</a>
    <a id="3855" class="Symbol">(</a><a id="3856" href="Ledger.Properties.html#3856" class="Bound">indexedSum-⊆</a> <a id="3869" class="Symbol">:</a> <a id="3871" class="Symbol">∀</a> <a id="3873" class="Symbol">{</a><a id="3874" href="Ledger.Properties.html#3874" class="Bound">A</a> <a id="3876" class="Symbol">:</a> <a id="3878" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="3882" class="Symbol">}</a> <a id="3884" class="Symbol">⦃</a> <a id="3886" href="Ledger.Properties.html#3886" class="Bound">_</a> <a id="3888" class="Symbol">:</a> <a id="3890" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="3896" href="Ledger.Properties.html#3874" class="Bound">A</a> <a id="3898" class="Symbol">⦄</a> <a id="3900" class="Symbol">(</a><a id="3901" href="Ledger.Properties.html#3901" class="Bound">d</a> <a id="3903" href="Ledger.Properties.html#3903" class="Bound">d&#39;</a> <a id="3906" class="Symbol">:</a> <a id="3908" href="Ledger.Properties.html#3874" class="Bound">A</a> <a id="3910" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3912" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="3913" class="Symbol">)</a> <a id="3915" class="Symbol">→</a> <a id="3917" href="Ledger.Properties.html#3901" class="Bound">d</a> <a id="3919" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a> <a id="3921" href="Interface.HasSubset.html#158" class="Field Operator">⊆</a> <a id="3923" href="Ledger.Properties.html#3903" class="Bound">d&#39;</a> <a id="3926" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a>
      <a id="3934" class="Symbol">→</a> <a id="3936" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="3949" href="Function.Base.html#704" class="Function">id</a> <a id="3952" href="Ledger.Properties.html#3901" class="Bound">d</a> <a id="3954" href="Class.HasOrder.Core.html#608" class="Field Operator">≤</a> <a id="3956" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">indexedSumᵛ&#39;</a> <a id="3969" href="Function.Base.html#704" class="Function">id</a> <a id="3972" href="Ledger.Properties.html#3903" class="Bound">d&#39;</a><a id="3974" class="Symbol">)</a> <a id="3976" class="Comment">-- technically we could use an ordered monoid instead of ℕ</a>
    <a id="4039" class="Keyword">where</a>
    <a id="4049" class="Keyword">open</a> <a id="4054" class="Keyword">import</a> <a id="4061" href="Ledger.Utxow.html" class="Module">Ledger.Utxow</a> <a id="4074" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="4078" href="Ledger.Properties.html#184" class="Bound">abs</a>
    <a id="4086" class="Keyword">open</a> <a id="4091" class="Keyword">import</a> <a id="4098" href="Ledger.Utxo.Properties.html" class="Module">Ledger.Utxo.Properties</a> <a id="4121" href="Ledger.Properties.html#140" class="Bound">txs</a> <a id="4125" href="Ledger.Properties.html#184" class="Bound">abs</a>

    <a id="4134" href="Ledger.Properties.html#4134" class="Function">propose-minSpend</a> <a id="4151" class="Symbol">:</a> <a id="4153" href="Ledger.Utxo.Properties.html#27065" class="Function">noRefundCert</a> <a id="4166" class="Symbol">(</a><a id="4167" href="Ledger.Transaction.html#2925" class="Field">txcerts</a> <a id="4175" href="Ledger.Properties.html#3601" class="Bound">txb</a><a id="4178" class="Symbol">)</a>
      <a id="4186" class="Symbol">→</a> <a id="4188" href="Ledger.TokenAlgebra.html#812" class="Function">coin</a> <a id="4193" class="Symbol">(</a><a id="4194" href="Ledger.Utxo.html#12146" class="Function">consumed</a> <a id="4203" href="Ledger.Properties.html#3474" class="Function">pparams</a> <a id="4211" href="Ledger.Ledger.html#868" class="Function">utxoSt</a> <a id="4218" href="Ledger.Properties.html#3601" class="Bound">txb</a><a id="4221" class="Symbol">)</a> <a id="4223" href="Class.HasOrder.Core.html#822" class="Function Operator">≥</a> <a id="4225" href="Data.List.Base.html#5044" class="Function">length</a> <a id="4232" class="Symbol">(</a><a id="4233" href="Ledger.Transaction.html#3023" class="Field">txprop</a> <a id="4240" href="Ledger.Properties.html#3601" class="Bound">txb</a><a id="4243" class="Symbol">)</a> <a id="4245" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">*</a> <a id="4247" href="Ledger.PParams.html#3236" class="Function">govActionDeposit</a>
    <a id="4268" href="Ledger.Properties.html#4134" class="Function">propose-minSpend</a> <a id="4285" href="Ledger.Properties.html#4285" class="Bound">noRef</a> <a id="4291" class="Symbol">=</a> <a id="4293" href="Function.Base.html#4042" class="Function Operator">case</a> <a id="4298" href="Ledger.Properties.html#3617" class="Bound">valid</a> <a id="4304" href="Function.Base.html#4042" class="Function Operator">of</a> <a id="4307" class="Symbol">λ</a> <a id="4309" class="Keyword">where</a>
      <a id="4321" class="Symbol">(_</a> <a id="4324" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4326" href="Ledger.Ledger.html#2643" class="InductiveConstructor">LEDGER-V</a> <a id="4335" class="Symbol">(_</a> <a id="4338" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4340" href="Ledger.Utxow.html#5375" class="InductiveConstructor">UTXOW⇒UTXO</a> <a id="4351" href="Ledger.Properties.html#4351" class="Bound">x</a> <a id="4353" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4355" class="Symbol">_</a> <a id="4357" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4359" class="Symbol">_))</a> <a id="4363" class="Symbol">→</a> <a id="4365" href="Ledger.Utxo.Properties.html#31266" class="Function">gmsc</a> <a id="4370" href="Ledger.Properties.html#3652" class="Bound">indexedSum-∪⁺-hom</a> <a id="4388" href="Ledger.Properties.html#4351" class="Bound">x</a> <a id="4390" href="Ledger.Properties.html#4285" class="Bound">noRef</a>
      <a id="4402" class="Symbol">(_</a> <a id="4405" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4407" href="Ledger.Ledger.html#3303" class="InductiveConstructor">LEDGER-I</a> <a id="4416" class="Symbol">(_</a> <a id="4419" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4421" href="Ledger.Utxow.html#5375" class="InductiveConstructor">UTXOW⇒UTXO</a> <a id="4432" href="Ledger.Properties.html#4432" class="Bound">x</a><a id="4433" class="Symbol">))</a>         <a id="4444" class="Symbol">→</a> <a id="4446" href="Ledger.Utxo.Properties.html#31266" class="Function">gmsc</a> <a id="4451" href="Ledger.Properties.html#3652" class="Bound">indexedSum-∪⁺-hom</a> <a id="4469" href="Ledger.Properties.html#4432" class="Bound">x</a> <a id="4471" href="Ledger.Properties.html#4285" class="Bound">noRef</a>

  <a id="4480" class="Comment">--   propose-ChangePP-hasGroup : ∀ {up prop}</a>
  <a id="4527" class="Comment">--     → prop ∈ txb → prop .GovProposal.action ≡ ChangePParams up → updateGroups up ≢ ∅</a>
  <a id="4617" class="Comment">--   propose-ChangePP-hasGroup = {!!}</a>

  <a id="4658" class="Comment">-- Block properties</a>

  <a id="4681" class="Keyword">module</a> <a id="4688" href="Ledger.Properties.html#4688" class="Module">_</a> <a id="4690" class="Symbol">{</a><a id="4691" href="Ledger.Properties.html#4691" class="Bound">b</a><a id="4692" class="Symbol">}</a> <a id="4694" class="Symbol">(</a><a id="4695" href="Ledger.Properties.html#4695" class="Bound">valid</a> <a id="4701" class="Symbol">:</a> <a id="4703" href="Ledger.Properties.html#1450" class="Function">validBlockIn</a> <a id="4716" href="Ledger.Properties.html#3252" class="Bound">s</a> <a id="4718" href="Ledger.Properties.html#4691" class="Bound">b</a><a id="4719" class="Symbol">)</a> <a id="4721" class="Symbol">(</a><a id="4722" class="Keyword">let</a> <a id="4726" class="Keyword">open</a> <a id="4731" href="Ledger.Chain.html#626" class="Module">Block</a> <a id="4737" href="Ledger.Properties.html#4691" class="Bound">b</a><a id="4738" class="Symbol">)</a> <a id="4740" class="Keyword">where</a>
    <a id="4750" href="Ledger.Properties.html#4750" class="Function">isNewEpochBlock</a> <a id="4766" class="Symbol">:</a> <a id="4768" href="Agda.Primitive.html#388" class="Primitive">Type</a>
    <a id="4777" href="Ledger.Properties.html#4750" class="Function">isNewEpochBlock</a> <a id="4793" class="Symbol">=</a> <a id="4795" href="Ledger.Types.Epoch.html#688" class="Function">epoch</a> <a id="4801" href="Ledger.Chain.html#677" class="Function">slot</a> <a id="4806" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4808" href="Ledger.Types.Epoch.html#797" class="Function">sucᵉ</a> <a id="4813" href="Ledger.Epoch.html#1917" class="Function">lastEpoch</a>

    <a id="4828" href="Ledger.Properties.html#4828" class="Function">newChainState</a> <a id="4842" class="Symbol">:</a> <a id="4844" href="Ledger.Chain.html#551" class="Record">ChainState</a>
    <a id="4859" href="Ledger.Properties.html#4828" class="Function">newChainState</a> <a id="4873" class="Symbol">=</a> <a id="4875" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="4881" href="Ledger.Properties.html#4695" class="Bound">valid</a>

    <a id="4892" class="Comment">-- enact-change⇒newEpoch : es ≢ getEnactState newChainState → isNewEpochBlock</a>
    <a id="4974" class="Comment">-- enact-change⇒newEpoch = {!!}</a>

  <a id="5009" class="Comment">-- Invariant properties</a>

  <a id="5036" href="Ledger.Properties.html#5036" class="Function">action-deposits≡actions-prop</a> <a id="5065" class="Symbol">:</a> <a id="5067" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5074" href="Ledger.Properties.html#5036" class="Function">action-deposits≡actions-prop</a> <a id="5103" class="Symbol">=</a> <a id="5105" href="abstract-set-theory.FiniteSetTheory.html#2813" class="Function">filterˢ</a> <a id="5113" href="Ledger.Properties.html#830" class="Function">isGADeposit</a> <a id="5125" class="Symbol">(</a><a id="5126" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5130" class="Symbol">(</a><a id="5131" href="Ledger.Utxo.html#2669" class="Field">UTxOState.deposits</a> <a id="5150" href="Ledger.Ledger.html#868" class="Function">utxoSt</a><a id="5156" class="Symbol">))</a>
    <a id="5163" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5165" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="5174" class="Symbol">(</a><a id="5175" href="Class.Functor.Core.html#272" class="Function">map</a> <a id="5179" class="Symbol">(λ</a> <a id="5182" class="Keyword">where</a> <a id="5188" class="Symbol">(</a><a id="5189" href="Ledger.Properties.html#5189" class="Bound">id</a> <a id="5192" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5194" class="Symbol">_)</a> <a id="5197" class="Symbol">→</a> <a id="5199" href="Ledger.Certs.html#521" class="InductiveConstructor">GovActionDeposit</a> <a id="5216" href="Ledger.Properties.html#5189" class="Bound">id</a><a id="5218" class="Symbol">)</a> <a id="5220" href="Ledger.Ledger.html#895" class="Function">govSt</a><a id="5225" class="Symbol">)</a>

  <a id="5230" href="Ledger.Properties.html#5230" class="Function">dom-rwds≡credDeposits</a> <a id="5252" class="Symbol">:</a> <a id="5254" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5261" href="Ledger.Properties.html#5230" class="Function">dom-rwds≡credDeposits</a> <a id="5283" class="Symbol">=</a> <a id="5285" href="abstract-set-theory.FiniteSetTheory.html#2813" class="Function">filterˢ</a> <a id="5293" href="Ledger.Properties.html#487" class="Function">isCredDeposit</a> <a id="5307" class="Symbol">(</a><a id="5308" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5312" class="Symbol">(</a><a id="5313" href="Ledger.Utxo.html#2669" class="Field">UTxOState.deposits</a> <a id="5332" href="Ledger.Ledger.html#868" class="Function">utxoSt</a><a id="5338" class="Symbol">))</a>
    <a id="5345" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5347" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5352" href="Ledger.Certs.html#362" class="InductiveConstructor">CredentialDeposit</a> <a id="5370" class="Symbol">(</a><a id="5371" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5375" href="Ledger.Certs.html#3101" class="Function">rewards</a><a id="5382" class="Symbol">)</a>

  <a id="5387" href="Ledger.Properties.html#5387" class="Function">pp-wellFormed</a> <a id="5401" class="Symbol">:</a> <a id="5403" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="5410" href="Ledger.Properties.html#5387" class="Function">pp-wellFormed</a> <a id="5424" class="Symbol">=</a> <a id="5426" href="Ledger.PParams.html#3973" class="Function">paramsWellFormed</a> <a id="5443" href="Ledger.Properties.html#3474" class="Function">pparams</a>

<a id="5452" class="Comment">-- action-deposits≡actions-inv : ChainInvariant action-deposits≡actions-prop</a>
<a id="5529" class="Comment">-- action-deposits≡actions-inv = {!!}</a>

<a id="5568" class="Comment">-- dom-rwds≡credDeposits-inv : ChainInvariant dom-rwds≡credDeposits</a>
<a id="5636" class="Comment">-- dom-rwds≡credDeposits-inv = {!!}</a>

<a id="5673" class="Comment">-- pp-wellFormed-inv : ChainInvariant pp-wellFormed</a>
<a id="5725" class="Comment">-- pp-wellFormed-inv = {!!}</a>

<a id="5754" class="Comment">-- Epoch boundary properties</a>

<a id="5784" class="Comment">-- module _ {Γ es e es&#39;} (step : Γ ⊢ es ⇀⦇ e ,NEWEPOCH⦈ es&#39;) where</a>
<a id="5851" class="Comment">--   dom-rwds-const : dom (getRewards es) ≡ dom (getRewards es&#39;)</a>
<a id="5916" class="Comment">--   dom-rwds-const = {!!}</a>

<a id="5944" class="Comment">--   prop≡∅⇒activeDReps-const : getGovState es ≡ [] → activeDReps e es ≡ᵉ activeDReps (sucᵉ e) es&#39;</a>
<a id="6043" class="Comment">--   prop≡∅⇒activeDReps-const = {!!}</a>
</pre></body></html>