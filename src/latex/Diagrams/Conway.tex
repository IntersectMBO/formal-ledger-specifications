\begin{figure}[h!]
  \centering
  \begin{tikzpicture} [
    every node/.style={draw, shape=ellipse, minimum size=6mm, inner sep=2pt},
    every edge/.style={draw, ->, >=Latex, semithick},
    dotted edge/.style={draw, ->, >=Latex, dotted, semithick},
    every loop/.style={looseness=5}
  ]

  % LEVEL 0 (TOP)
  \node (CHAIN) {\small CHAIN};

  % LEVEL -1
  \node (NEWEPOCH) [below left=2cm and 0mm of CHAIN] {\small NEWEPOCH};
  \node (LEDGERS) [below right=2cm and 0mm of CHAIN] {\small LEDGERS};

  % LEVEL -2
  \node (EPOCH) [below=of NEWEPOCH] {\small EPOCH};
  \node (LEDGER) [below=of LEDGERS] {\small LEDGER};

  % LEVEL -3
  \node (ENACT) [below left=of EPOCH] {\small ENACT};
  \node (RATIFY) [below right=of EPOCH] {\small RATIFY};
  \node (SNAP) [below=of EPOCH] {\small SNAP};
  \node (CERTS) [below right=1.5cm and 0mm of LEDGER] {\small CERTS};
  \node (UTXOW) [below left=1.5cm and 0mm of LEDGER] {\small UTXOW};
  \node (GOV) [below=of LEDGER] {\small GOV};

  % LEVEL -4
  \node (CERT) [below=of CERTS] {\small CERT};
  \node (UTXO) [below=of UTXOW] {\small UTXO};

  % LEVEL -5
  \node (DELEG) [below left=of CERT] {\small DELEG};
  \node (POOL) [below right=of CERT] {\small POOL};
  \node (GOVCERT) [below=of CERT] {\small GOVCERT};
  \node (UTXOS) [below=of UTXO] {\small UTXOS};

  % Edges (Sub-rule relationships)
  \draw
  (CHAIN)    edge                   (NEWEPOCH)
  (CHAIN)    edge                   (LEDGERS)
  (NEWEPOCH) edge                   (EPOCH)
  (LEDGERS)  edge                   (LEDGER)
  (EPOCH)    edge                   (ENACT)
  (EPOCH)    edge                   (RATIFY)
  (EPOCH)    edge                   (SNAP)
  (LEDGER)   edge                   (UTXOW)
  (LEDGER)   edge                   (GOV)
  (LEDGER)   edge                   (CERTS)
  (CERTS)    edge                   (CERT)
  (CERT)     edge                   (DELEG)
  (CERT)     edge                   (POOL)
  (CERT)     edge                   (GOVCERT)
  (UTXOW)    edge                   (UTXO)
  (UTXO)     edge                   (UTXOS);

  % Dependencies (Dotted edges)
  \draw[dotted edge]
  (ENACT)    edge [bend left]       (EPOCH)
  (RATIFY)   edge [bend right]      (EPOCH)
  (SNAP)     edge [bend right]      (EPOCH)
  (UTXOS)    edge [bend left]       (UTXO)
  (CERTS)    edge [bend right]      (LEDGER);

  \end{tikzpicture}
  \caption{State transition systems of the latest blockchain ledger version.
  Each node represents a transition rule, with \textbf{solid arrows} indicating
  sub-rule inclusion (i.e., the source rule applies the target rule as part of its
  definition). \textbf{Dotted arrows} represent dependencies where the target rule’s
  output is used in the source rule’s input, state, or environment. Recursive rules
  such as LEDGERS and CERTS apply their sub-rules repeatedly over lists of transactions
  or certificates.}
  \label{fig:new-ledger-diagram}
\end{figure}
