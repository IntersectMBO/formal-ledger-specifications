<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Assumption</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Comment">--------------------------------------------------------------------------------</a>
<a id="117" class="Comment">-- assumption: try to solve the goal with one of the available assumptions</a>
<a id="192" class="Comment">--------------------------------------------------------------------------------</a>

<a id="274" class="Keyword">module</a> <a id="281" href="Tactic.Assumption.html" class="Module">Tactic.Assumption</a> <a id="299" class="Keyword">where</a>

<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="MetaPrelude.html" class="Module">MetaPrelude</a>
<a id="330" class="Keyword">open</a> <a id="335" class="Keyword">import</a> <a id="342" href="Meta.html" class="Module">Meta</a>

<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="374" class="Keyword">open</a> <a id="379" class="Keyword">import</a> <a id="386" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="398" class="Keyword">open</a> <a id="403" class="Keyword">import</a> <a id="410" href="Class.MonadError.Instances.html" class="Module">Class.MonadError.Instances</a>
<a id="437" class="Keyword">open</a> <a id="442" class="Keyword">import</a> <a id="449" href="Class.MonadReader.Instances.html" class="Module">Class.MonadReader.Instances</a>
<a id="477" class="Keyword">open</a> <a id="482" class="Keyword">import</a> <a id="489" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>

<a id="514" class="Keyword">open</a> <a id="519" class="Keyword">import</a> <a id="526" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="544" class="Keyword">open</a> <a id="549" class="Keyword">import</a> <a id="556" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="573" class="Keyword">open</a> <a id="578" class="Keyword">import</a> <a id="585" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>

<a id="607" class="Keyword">instance</a>
  <a id="618" href="Tactic.Assumption.html#618" class="Function">_</a> <a id="620" class="Symbol">=</a> <a id="622" href="Class.Monad.Core.html#610" class="Function">Functor-M</a>

<a id="solve"></a><a id="633" href="Tactic.Assumption.html#633" class="Function">solve</a> <a id="639" class="Symbol">:</a> <a id="641" class="Symbol">⦃</a> <a id="643" href="Class.MonadTC.html#618" class="Record">TCOptions</a> <a id="653" class="Symbol">⦄</a> <a id="655" class="Symbol">→</a> <a id="657" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="662" class="Symbol">→</a> <a id="664" href="Reflection.Tactic.html#489" class="Function">Tactic</a>
<a id="671" href="Tactic.Assumption.html#633" class="Function">solve</a> <a id="677" href="Tactic.Assumption.html#677" class="Bound">t</a> <a id="679" class="Symbol">=</a> <a id="681" href="Reflection.Tactic.html#837" class="Function">initTac</a> <a id="689" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="691" href="Class.MonadTC.html#2434" class="Field">runSpeculative</a> <a id="706" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="708" class="Keyword">do</a>
  <a id="713" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="718" href="Tactic.Assumption.html#718" class="Bound">goal</a> <a id="723" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="725" href="Class.MonadReader.html#390" class="Function">reader</a> <a id="732" href="Class.MonadTC.html#1024" class="Field">TCEnv.goal</a>
    <a id="747" class="Keyword">where</a> <a id="753" class="CatchallClause Symbol">_</a> <a id="755" class="Symbol">→</a> <a id="757" href="Class.MonadTC.html#8767" class="Function">error1</a> <a id="764" class="String">&quot;solve: Goal is not a term!&quot;</a>
  <a id="795" href="Tactic.Assumption.html#795" class="Bound">metas</a> <a id="801" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="803" href="Reflection.Utils.html#1206" class="Function">findMetas</a> <a id="813" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="817" href="Class.MonadTC.html#1787" class="Field">checkType</a> <a id="827" href="Tactic.Assumption.html#677" class="Bound">t</a> <a id="829" href="Tactic.Assumption.html#718" class="Bound">goal</a>
  <a id="836" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="839" href="Data.List.Base.html#4742" class="Function">null</a> <a id="844" href="Tactic.Assumption.html#795" class="Bound">metas</a>
    <a id="854" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="859" class="Symbol">(</a><a id="860" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,</a> <a id="863" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a><a id="867" class="Symbol">)</a>  <a id="870" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="874" href="Class.MonadTC.html#1649" class="Field">unify</a> <a id="880" href="Tactic.Assumption.html#718" class="Bound">goal</a> <a id="885" href="Tactic.Assumption.html#677" class="Bound">t</a>
    <a id="891" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="896" class="Symbol">(</a><a id="897" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,</a> <a id="900" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a><a id="905" class="Symbol">)</a> <a id="907" href="Class.Functor.Core.html#233" class="Field Operator">&lt;$&gt;</a> <a id="911" href="Class.MonadTC.html#8767" class="Function">error1</a> <a id="918" class="String">&quot;Unsolved metavariables remaining!&quot;</a>

<a id="assumption&#39;"></a><a id="955" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a> <a id="967" class="Symbol">:</a> <a id="969" href="Reflection.Tactic.html#534" class="Function">ITactic</a>
<a id="977" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a> <a id="989" class="Symbol">=</a> <a id="991" href="Reflection.Utils.TCI.html#5945" class="Function">inDebugPath</a> <a id="1003" class="String">&quot;assumption&quot;</a> <a id="1016" class="Keyword">do</a>
  <a id="1021" href="Tactic.Assumption.html#1021" class="Bound">c</a> <a id="1023" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="1025" href="Class.MonadTC.html#8073" class="Function">getContext</a>
  <a id="1038" href="Data.List.Base.html#4437" class="Function">foldl</a> <a id="1044" class="Symbol">(λ</a> <a id="1047" href="Tactic.Assumption.html#1047" class="Bound">x</a> <a id="1049" href="Tactic.Assumption.html#1049" class="Bound">k</a> <a id="1051" class="Symbol">→</a> <a id="1053" class="Keyword">do</a>
    <a id="1060" href="Class.MonadError.html#363" class="Field">catch</a> <a id="1066" class="Symbol">(</a><a id="1067" href="Class.MonadTC.html#10517" class="Function">unifyWithGoal</a> <a id="1081" class="Symbol">(</a><a id="1082" href="Reflection.Syntax.html#1433" class="InductiveConstructor">♯</a> <a id="1084" href="Tactic.Assumption.html#1049" class="Bound">k</a><a id="1085" class="Symbol">)</a> <a id="1087" href="Class.Monad.Core.html#324" class="Function Operator">&gt;&gt;</a> <a id="1090" href="Class.MonadTC.html#5769" class="Function">debugLog</a> <a id="1099" class="Symbol">(</a><a id="1100" class="String">&quot;Success with: &quot;</a> <a id="1117" href="Reflection.Debug.html#1014" class="Function Operator">∷ᵈ</a> <a id="1120" href="Reflection.Syntax.html#1433" class="InductiveConstructor">♯</a> <a id="1122" href="Tactic.Assumption.html#1049" class="Bound">k</a> <a id="1124" href="Reflection.Debug.html#1014" class="Function Operator">∷ᵈ</a> <a id="1127" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1129" class="Symbol">))</a> <a id="1132" class="Symbol">(λ</a> <a id="1135" href="Tactic.Assumption.html#1135" class="Bound">_</a> <a id="1137" class="Symbol">→</a> <a id="1139" href="Tactic.Assumption.html#1047" class="Bound">x</a><a id="1140" class="Symbol">))</a>
    <a id="1147" class="Symbol">(</a><a id="1148" href="Class.MonadTC.html#8914" class="Function">logAndError1</a> <a id="1161" class="String">&quot;No valid assumption!&quot;</a><a id="1183" class="Symbol">)</a> <a id="1185" class="Symbol">(</a><a id="1186" href="Data.List.Base.html#6899" class="Function">downFrom</a> <a id="1195" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1197" href="Data.List.Base.html#5083" class="Function">length</a> <a id="1204" href="Tactic.Assumption.html#1021" class="Bound">c</a><a id="1205" class="Symbol">)</a>

<a id="1208" class="Keyword">module</a> <a id="1215" href="Tactic.Assumption.html#1215" class="Module">_</a> <a id="1217" class="Symbol">⦃</a> <a id="1219" href="Tactic.Assumption.html#1219" class="Bound">_</a> <a id="1221" class="Symbol">:</a> <a id="1223" href="Class.MonadTC.html#618" class="Record">TCOptions</a> <a id="1233" class="Symbol">⦄</a> <a id="1235" class="Keyword">where</a>
  <a id="1243" class="Keyword">macro</a>
    <a id="1253" href="Tactic.Assumption.html#1253" class="Function">assumption</a> <a id="1264" class="Symbol">=</a> <a id="1266" href="Reflection.Tactic.html#837" class="Function">initTac</a> <a id="1274" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a>
    <a id="1290" href="Tactic.Assumption.html#1290" class="Function">assumptionOpts</a> <a id="1305" class="Symbol">=</a> <a id="1307" href="Reflection.Tactic.html#676" class="Function">initTacOpts</a> <a id="1319" href="Tactic.Assumption.html#955" class="Function">assumption&#39;</a>

<a id="1332" class="Keyword">private</a>
  <a id="1342" class="Keyword">open</a> <a id="1347" class="Keyword">import</a> <a id="1354" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>
  <a id="1372" class="Keyword">module</a> <a id="Test"></a><a id="1379" href="Tactic.Assumption.html#1379" class="Module">Test</a> <a id="1384" class="Keyword">where</a>
    <a id="Test.test₁"></a><a id="1394" href="Tactic.Assumption.html#1394" class="Function">test₁</a> <a id="1400" class="Symbol">:</a> <a id="1402" class="Symbol">{</a><a id="1403" href="Tactic.Assumption.html#1403" class="Bound">A</a> <a id="1405" href="Tactic.Assumption.html#1405" class="Bound">B</a> <a id="1407" class="Symbol">:</a> <a id="1409" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1412" class="Symbol">}</a> <a id="1414" class="Symbol">→</a> <a id="1416" href="Tactic.Assumption.html#1403" class="Bound">A</a> <a id="1418" class="Symbol">→</a> <a id="1420" href="Tactic.Assumption.html#1405" class="Bound">B</a> <a id="1422" class="Symbol">→</a> <a id="1424" href="Tactic.Assumption.html#1403" class="Bound">A</a>
    <a id="1430" href="Tactic.Assumption.html#1394" class="Function">test₁</a> <a id="1436" href="Tactic.Assumption.html#1436" class="Bound">a</a> <a id="1438" href="Tactic.Assumption.html#1438" class="Bound">b</a> <a id="1440" class="Symbol">=</a> <a id="1442" href="Tactic.Assumption.html#1253" class="Macro">assumption</a>
    
    <a id="Test.test₂"></a><a id="1462" href="Tactic.Assumption.html#1462" class="Function">test₂</a> <a id="1468" class="Symbol">:</a> <a id="1470" class="Symbol">{</a><a id="1471" href="Tactic.Assumption.html#1471" class="Bound">A</a> <a id="1473" href="Tactic.Assumption.html#1473" class="Bound">B</a> <a id="1475" class="Symbol">:</a> <a id="1477" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1480" class="Symbol">}</a> <a id="1482" class="Symbol">→</a> <a id="1484" href="Tactic.Assumption.html#1471" class="Bound">A</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="Tactic.Assumption.html#1473" class="Bound">B</a> <a id="1490" class="Symbol">→</a> <a id="1492" href="Tactic.Assumption.html#1473" class="Bound">B</a>
    <a id="1498" href="Tactic.Assumption.html#1462" class="Function">test₂</a> <a id="1504" href="Tactic.Assumption.html#1504" class="Bound">a</a> <a id="1506" href="Tactic.Assumption.html#1506" class="Bound">b</a> <a id="1508" class="Symbol">=</a> <a id="1510" href="Tactic.Assumption.html#1253" class="Macro">assumption</a>
</pre></body></html>