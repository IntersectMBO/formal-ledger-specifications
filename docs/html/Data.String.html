<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.String</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Strings</a>
<a id="117" class="Comment">------------------------------------------------------------------------</a>

<a id="191" class="Symbol">{-#</a> <a id="195" class="Keyword">OPTIONS</a> <a id="203" class="Pragma">--cubical-compatible</a> <a id="224" class="Pragma">--safe</a> <a id="231" class="Symbol">#-}</a>

<a id="236" class="Keyword">module</a> <a id="243" href="Data.String.html" class="Module">Data.String</a> <a id="255" class="Keyword">where</a>

<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> <a id="289" class="Keyword">using</a> <a id="295" class="Symbol">(</a><a id="296" href="Data.Bool.Base.html#1505" class="Function Operator">if_then_else_</a><a id="309" class="Symbol">)</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.Char.html" class="Module">Data.Char</a> <a id="333" class="Symbol">as</a> <a id="336" class="Module">Char</a> <a id="341" class="Keyword">using</a> <a id="347" class="Symbol">(</a><a id="348" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a><a id="352" class="Symbol">)</a>
<a id="354" class="Keyword">open</a> <a id="359" class="Keyword">import</a> <a id="366" href="Function.Base.html" class="Module">Function.Base</a> <a id="380" class="Keyword">using</a> <a id="386" class="Symbol">(</a><a id="387" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="390" class="Symbol">;</a> <a id="392" href="Function.Base.html#1974" class="Function Operator">_$_</a><a id="395" class="Symbol">)</a>
<a id="397" class="Keyword">open</a> <a id="402" class="Keyword">import</a> <a id="409" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="423" class="Symbol">as</a> <a id="426" class="Module">ℕ</a> <a id="428" class="Keyword">using</a> <a id="434" class="Symbol">(</a><a id="435" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="436" class="Symbol">)</a>
<a id="438" class="Keyword">import</a> <a id="445" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="465" class="Symbol">as</a> <a id="468" class="Module">ℕₚ</a>
<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="498" class="Symbol">as</a> <a id="501" class="Module">List</a> <a id="506" class="Keyword">using</a> <a id="512" class="Symbol">(</a><a id="513" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="517" class="Symbol">)</a>
<a id="519" class="Keyword">open</a> <a id="524" class="Keyword">import</a> <a id="531" href="Data.List.Extrema.html" class="Module">Data.List.Extrema</a> <a id="549" href="Data.Nat.Properties.html#7413" class="Function">ℕₚ.≤-totalOrder</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="591" class="Symbol">as</a> <a id="594" class="Module">Vec</a> <a id="598" class="Keyword">using</a> <a id="604" class="Symbol">(</a><a id="605" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a><a id="608" class="Symbol">)</a>
<a id="610" class="Keyword">open</a> <a id="615" class="Keyword">import</a> <a id="622" href="Data.Char.Base.html" class="Module">Data.Char.Base</a> <a id="637" class="Symbol">as</a> <a id="640" class="Module">Char</a> <a id="645" class="Keyword">using</a> <a id="651" class="Symbol">(</a><a id="652" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a><a id="656" class="Symbol">)</a>
<a id="658" class="Keyword">import</a> <a id="665" href="Data.Char.Properties.html" class="Module">Data.Char.Properties</a> <a id="686" class="Symbol">as</a> <a id="689" class="Module">Char</a> <a id="694" class="Keyword">using</a> <a id="700" class="Symbol">(</a><a id="701" href="Data.Char.Properties.html#2071" class="Function Operator">_≟_</a><a id="704" class="Symbol">)</a>
<a id="706" class="Keyword">open</a> <a id="711" class="Keyword">import</a> <a id="718" href="Relation.Nullary.Decidable.Core.html" class="Module">Relation.Nullary.Decidable.Core</a> <a id="750" class="Keyword">using</a> <a id="756" class="Symbol">(</a><a id="757" href="Relation.Nullary.Decidable.Core.html#1551" class="Field">does</a><a id="761" class="Symbol">)</a>

<a id="764" class="Keyword">open</a> <a id="769" class="Keyword">import</a> <a id="776" href="Data.List.Membership.DecPropositional.html" class="Module">Data.List.Membership.DecPropositional</a> <a id="814" href="Data.Char.Properties.html#2071" class="Function Operator">Char._≟_</a>


<a id="825" class="Comment">------------------------------------------------------------------------</a>
<a id="898" class="Comment">-- Re-export contents of base, and decidability of equality</a>

<a id="959" class="Keyword">open</a> <a id="964" class="Keyword">import</a> <a id="971" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="988" class="Keyword">public</a>
<a id="995" class="Keyword">open</a> <a id="1000" class="Keyword">import</a> <a id="1007" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="1030" class="Keyword">using</a> <a id="1036" class="Symbol">(</a><a id="1037" href="Data.String.Properties.html#2036" class="Function Operator">_≈?_</a><a id="1041" class="Symbol">;</a> <a id="1043" href="Data.String.Properties.html#2717" class="Function Operator">_≟_</a><a id="1046" class="Symbol">;</a> <a id="1048" href="Data.String.Properties.html#3003" class="Function Operator">_&lt;?_</a><a id="1052" class="Symbol">;</a> <a id="1054" href="Data.String.Properties.html#4782" class="Function Operator">_==_</a><a id="1058" class="Symbol">)</a> <a id="1060" class="Keyword">public</a>

<a id="1068" class="Comment">------------------------------------------------------------------------</a>
<a id="1141" class="Comment">-- Conversion functions</a>

<a id="toVec"></a><a id="1166" href="Data.String.html#1166" class="Function">toVec</a> <a id="1172" class="Symbol">:</a> <a id="1174" class="Symbol">(</a><a id="1175" href="Data.String.html#1175" class="Bound">s</a> <a id="1177" class="Symbol">:</a> <a id="1179" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1185" class="Symbol">)</a> <a id="1187" class="Symbol">→</a> <a id="1189" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="1193" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="1198" class="Symbol">(</a><a id="1199" href="Data.String.Base.html#2468" class="Function">length</a> <a id="1206" href="Data.String.html#1175" class="Bound">s</a><a id="1207" class="Symbol">)</a>
<a id="1209" href="Data.String.html#1166" class="Function">toVec</a> <a id="1215" href="Data.String.html#1215" class="Bound">s</a> <a id="1217" class="Symbol">=</a> <a id="1219" href="Data.Vec.Base.html#8509" class="Function">Vec.fromList</a> <a id="1232" class="Symbol">(</a><a id="1233" href="Data.String.Base.html#1537" class="Primitive">toList</a> <a id="1240" href="Data.String.html#1215" class="Bound">s</a><a id="1241" class="Symbol">)</a>

<a id="fromVec"></a><a id="1244" href="Data.String.html#1244" class="Function">fromVec</a> <a id="1252" class="Symbol">:</a> <a id="1254" class="Symbol">∀</a> <a id="1256" class="Symbol">{</a><a id="1257" href="Data.String.html#1257" class="Bound">n</a><a id="1258" class="Symbol">}</a> <a id="1260" class="Symbol">→</a> <a id="1262" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="1266" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="1271" href="Data.String.html#1257" class="Bound">n</a> <a id="1273" class="Symbol">→</a> <a id="1275" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1282" href="Data.String.html#1244" class="Function">fromVec</a> <a id="1290" class="Symbol">=</a> <a id="1292" href="Data.String.Base.html#1570" class="Primitive">fromList</a> <a id="1301" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1303" href="Data.Vec.Base.html#8415" class="Function">Vec.toList</a>


<a id="1316" class="Comment">-- enclose string with parens if it contains a space character</a>
<a id="parensIfSpace"></a><a id="1379" href="Data.String.html#1379" class="Function">parensIfSpace</a> <a id="1393" class="Symbol">:</a> <a id="1395" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1402" class="Symbol">→</a> <a id="1404" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1411" href="Data.String.html#1379" class="Function">parensIfSpace</a> <a id="1425" href="Data.String.html#1425" class="Bound">s</a> <a id="1427" class="Symbol">=</a> <a id="1429" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="1432" href="Relation.Nullary.Decidable.Core.html#1551" class="Field">does</a> <a id="1437" class="Symbol">(</a><a id="1438" class="String">&#39; &#39;</a> <a id="1442" href="Data.List.Membership.DecSetoid.html#882" class="Function Operator">∈?</a> <a id="1445" href="Data.String.Base.html#1537" class="Primitive">toList</a> <a id="1452" href="Data.String.html#1425" class="Bound">s</a><a id="1453" class="Symbol">)</a> <a id="1455" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="1460" href="Data.String.Base.html#2864" class="Function">parens</a> <a id="1467" href="Data.String.html#1425" class="Bound">s</a> <a id="1469" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="1474" href="Data.String.html#1425" class="Bound">s</a>


<a id="1478" class="Comment">------------------------------------------------------------------------</a>
<a id="1551" class="Comment">-- Rectangle</a>

<a id="1565" class="Comment">-- Build a rectangular column by:</a>
<a id="1599" class="Comment">-- Given a vector of cells and a padding function for each one</a>
<a id="1662" class="Comment">-- Compute the max of the widths, and pad the strings accordingly.</a>

<a id="rectangle"></a><a id="1730" href="Data.String.html#1730" class="Function">rectangle</a> <a id="1740" class="Symbol">:</a> <a id="1742" class="Symbol">∀</a> <a id="1744" class="Symbol">{</a><a id="1745" href="Data.String.html#1745" class="Bound">n</a><a id="1746" class="Symbol">}</a> <a id="1748" class="Symbol">→</a> <a id="1750" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="1754" class="Symbol">(</a><a id="1755" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1757" class="Symbol">→</a> <a id="1759" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1766" class="Symbol">→</a> <a id="1768" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="1774" class="Symbol">)</a> <a id="1776" href="Data.String.html#1745" class="Bound">n</a> <a id="1778" class="Symbol">→</a>
            <a id="1792" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="1796" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1803" href="Data.String.html#1745" class="Bound">n</a> <a id="1805" class="Symbol">→</a> <a id="1807" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="1811" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1818" href="Data.String.html#1745" class="Bound">n</a>
<a id="1820" href="Data.String.html#1730" class="Function">rectangle</a> <a id="1830" href="Data.String.html#1830" class="Bound">pads</a> <a id="1835" href="Data.String.html#1835" class="Bound">cells</a> <a id="1841" class="Symbol">=</a> <a id="1843" href="Data.Vec.Base.html#3737" class="Function">Vec.zipWith</a> <a id="1855" class="Symbol">(λ</a> <a id="1858" href="Data.String.html#1858" class="Bound">p</a> <a id="1860" href="Data.String.html#1860" class="Bound">c</a> <a id="1862" class="Symbol">→</a> <a id="1864" href="Data.String.html#1858" class="Bound">p</a> <a id="1866" href="Data.String.html#1940" class="Function">width</a> <a id="1872" href="Data.String.html#1860" class="Bound">c</a><a id="1873" class="Symbol">)</a> <a id="1875" href="Data.String.html#1830" class="Bound">pads</a> <a id="1880" href="Data.String.html#1835" class="Bound">cells</a> <a id="1886" class="Keyword">where</a>

  <a id="1895" href="Data.String.html#1895" class="Function">sizes</a> <a id="1901" class="Symbol">=</a> <a id="1903" href="Data.List.Base.html#1631" class="Function">List.map</a> <a id="1912" href="Data.String.Base.html#2468" class="Function">length</a> <a id="1919" class="Symbol">(</a><a id="1920" href="Data.Vec.Base.html#8415" class="Function">Vec.toList</a> <a id="1931" href="Data.String.html#1835" class="Bound">cells</a><a id="1936" class="Symbol">)</a>
  <a id="1940" href="Data.String.html#1940" class="Function">width</a> <a id="1946" class="Symbol">=</a> <a id="1948" href="Data.List.Extrema.html#1941" class="Function">max</a> <a id="1952" class="Number">0</a> <a id="1954" href="Data.String.html#1895" class="Function">sizes</a>

<a id="1961" class="Comment">-- Special cases for left, center, and right alignment</a>

<a id="rectangleˡ"></a><a id="2017" href="Data.String.html#2017" class="Function">rectangleˡ</a> <a id="2028" class="Symbol">:</a> <a id="2030" class="Symbol">∀</a> <a id="2032" class="Symbol">{</a><a id="2033" href="Data.String.html#2033" class="Bound">n</a><a id="2034" class="Symbol">}</a> <a id="2036" class="Symbol">→</a> <a id="2038" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2043" class="Symbol">→</a> <a id="2045" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="2049" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2056" href="Data.String.html#2033" class="Bound">n</a> <a id="2058" class="Symbol">→</a> <a id="2060" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="2064" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2071" href="Data.String.html#2033" class="Bound">n</a>
<a id="2073" href="Data.String.html#2017" class="Function">rectangleˡ</a> <a id="2084" href="Data.String.html#2084" class="Bound">c</a> <a id="2086" class="Symbol">=</a> <a id="2088" href="Data.String.html#1730" class="Function">rectangle</a> <a id="2098" class="Symbol">(</a><a id="2099" href="Data.Vec.Base.html#6509" class="Function">Vec.replicate</a> <a id="2113" class="Symbol">_</a> <a id="2115" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2117" href="Data.String.Base.html#3596" class="Function">padLeft</a> <a id="2125" href="Data.String.html#2084" class="Bound">c</a><a id="2126" class="Symbol">)</a>

<a id="rectangleʳ"></a><a id="2129" href="Data.String.html#2129" class="Function">rectangleʳ</a> <a id="2140" class="Symbol">:</a> <a id="2142" class="Symbol">∀</a> <a id="2144" class="Symbol">{</a><a id="2145" href="Data.String.html#2145" class="Bound">n</a><a id="2146" class="Symbol">}</a> <a id="2148" class="Symbol">→</a> <a id="2150" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2155" class="Symbol">→</a> <a id="2157" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="2161" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2168" href="Data.String.html#2145" class="Bound">n</a> <a id="2170" class="Symbol">→</a> <a id="2172" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="2176" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2183" href="Data.String.html#2145" class="Bound">n</a>
<a id="2185" href="Data.String.html#2129" class="Function">rectangleʳ</a> <a id="2196" href="Data.String.html#2196" class="Bound">c</a> <a id="2198" class="Symbol">=</a> <a id="2200" href="Data.String.html#1730" class="Function">rectangle</a> <a id="2210" class="Symbol">(</a><a id="2211" href="Data.Vec.Base.html#6509" class="Function">Vec.replicate</a> <a id="2225" class="Symbol">_</a> <a id="2227" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2229" href="Data.String.Base.html#3715" class="Function">padRight</a> <a id="2238" href="Data.String.html#2196" class="Bound">c</a><a id="2239" class="Symbol">)</a>

<a id="rectangleᶜ"></a><a id="2242" href="Data.String.html#2242" class="Function">rectangleᶜ</a> <a id="2253" class="Symbol">:</a> <a id="2255" class="Symbol">∀</a> <a id="2257" class="Symbol">{</a><a id="2258" href="Data.String.html#2258" class="Bound">n</a><a id="2259" class="Symbol">}</a> <a id="2261" class="Symbol">→</a> <a id="2263" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2268" class="Symbol">→</a> <a id="2270" href="Agda.Builtin.Char.html#238" class="Postulate">Char</a> <a id="2275" class="Symbol">→</a> <a id="2277" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="2281" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2288" href="Data.String.html#2258" class="Bound">n</a> <a id="2290" class="Symbol">→</a> <a id="2292" href="Data.Vec.Base.html#1111" class="Datatype">Vec</a> <a id="2296" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="2303" href="Data.String.html#2258" class="Bound">n</a>
<a id="2305" href="Data.String.html#2242" class="Function">rectangleᶜ</a> <a id="2316" href="Data.String.html#2316" class="Bound">cₗ</a> <a id="2319" href="Data.String.html#2319" class="Bound">cᵣ</a> <a id="2322" class="Symbol">=</a> <a id="2324" href="Data.String.html#1730" class="Function">rectangle</a> <a id="2334" class="Symbol">(</a><a id="2335" href="Data.Vec.Base.html#6509" class="Function">Vec.replicate</a> <a id="2349" class="Symbol">_</a> <a id="2351" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2353" href="Data.String.Base.html#3836" class="Function">padBoth</a> <a id="2361" href="Data.String.html#2316" class="Bound">cₗ</a> <a id="2364" href="Data.String.html#2319" class="Bound">cᵣ</a><a id="2366" class="Symbol">)</a>
</pre></body></html>