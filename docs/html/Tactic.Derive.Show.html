<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.Show</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Deriving show.</a>

<a id="20" class="Symbol">{-#</a> <a id="24" class="Keyword">OPTIONS</a> <a id="32" class="Pragma">-v</a> <a id="35" class="Pragma">allTactics:100</a> <a id="50" class="Symbol">#-}</a>
<a id="54" class="Symbol">{-#</a> <a id="58" class="Keyword">OPTIONS</a> <a id="66" class="Pragma">--safe</a> <a id="73" class="Symbol">#-}</a>
<a id="77" class="Keyword">module</a> <a id="84" href="Tactic.Derive.Show.html" class="Module">Tactic.Derive.Show</a> <a id="103" class="Keyword">where</a>

<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="MetaPrelude.html" class="Module">MetaPrelude</a>
<a id="134" class="Keyword">open</a> <a id="139" class="Keyword">import</a> <a id="146" href="Meta.html" class="Module">Meta</a>

<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="188" class="Keyword">using</a> <a id="194" class="Symbol">(</a><a id="195" href="Agda.Builtin.Reflection.html#621" class="Primitive">primShowQName</a><a id="208" class="Symbol">)</a>

<a id="211" class="Keyword">import</a> <a id="218" href="Data.List.html" class="Module">Data.List</a> <a id="228" class="Symbol">as</a> <a id="231" class="Module">L</a>
<a id="233" class="Keyword">import</a> <a id="240" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="259" class="Symbol">as</a> <a id="262" class="Module">NE</a>
<a id="265" class="Keyword">import</a> <a id="272" href="Reflection.html" class="Module">Reflection</a> <a id="283" class="Symbol">as</a> <a id="286" class="Module">R</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Data.String.html" class="Module">Data.String</a> <a id="312" class="Keyword">using</a> <a id="318" class="Symbol">(</a><a id="319" href="Data.String.Base.html#1591" class="Primitive">fromList</a><a id="327" class="Symbol">;</a> <a id="329" href="Data.String.Base.html#1558" class="Primitive">toList</a><a id="335" class="Symbol">)</a> <a id="337" class="Keyword">renaming</a> <a id="346" class="Symbol">(</a><a id="347" href="Data.String.Base.html#2425" class="Function Operator">_++_</a> <a id="352" class="Symbol">to</a> <a id="355" class="Function Operator">_++S_</a><a id="360" class="Symbol">)</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="392" class="Keyword">open</a> <a id="397" class="Keyword">import</a> <a id="404" href="Relation.Nullary.Negation.html" class="Module">Relation.Nullary.Negation</a>
<a id="430" class="Keyword">open</a> <a id="435" class="Keyword">import</a> <a id="442" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="470" class="Keyword">open</a> <a id="475" class="Keyword">import</a> <a id="482" href="Class.DecEq.html" class="Module">Class.DecEq</a>
<a id="494" class="Keyword">open</a> <a id="499" class="Keyword">import</a> <a id="506" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="520" class="Keyword">open</a> <a id="525" class="Keyword">import</a> <a id="532" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="556" class="Keyword">open</a> <a id="561" class="Keyword">import</a> <a id="568" href="Class.Show.Core.html" class="Module">Class.Show.Core</a>
<a id="584" class="Keyword">open</a> <a id="589" class="Keyword">import</a> <a id="596" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="615" class="Keyword">open</a> <a id="620" class="Keyword">import</a> <a id="627" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="648" class="Keyword">open</a> <a id="653" class="Keyword">import</a> <a id="660" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="674" class="Symbol">(</a><a id="675" class="Keyword">quote</a> <a id="681" href="Class.Show.Core.html#116" class="Record">Show</a><a id="685" class="Symbol">)</a> <a id="687" class="Symbol">(</a><a id="688" class="Keyword">quote</a> <a id="694" href="Class.Show.Core.html#178" class="Field">show</a><a id="698" class="Symbol">)</a>

<a id="701" class="Keyword">instance</a>
  <a id="712" href="Tactic.Derive.Show.html#712" class="Function">_</a> <a id="714" class="Symbol">=</a> <a id="716" href="Tactic.ClauseBuilder.html#10692" class="Function">ContextMonad-MonadTC</a>

<a id="738" class="Keyword">open</a> <a id="743" href="Tactic.ClauseBuilder.html#10922" class="Module">ClauseExprM</a>

<a id="sLit"></a><a id="756" href="Tactic.Derive.Show.html#756" class="Function">sLit</a> <a id="761" class="Symbol">=</a> <a id="763" href="Agda.Builtin.Reflection.html#5509" class="InductiveConstructor">Term.lit</a> <a id="772" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="774" href="Agda.Builtin.Reflection.html#4555" class="InductiveConstructor">Agda.Builtin.Reflection.Literal.string</a>

<a id="showName"></a><a id="814" href="Tactic.Derive.Show.html#814" class="Function">showName</a> <a id="823" class="Symbol">:</a> <a id="825" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="830" class="Symbol">→</a> <a id="832" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="839" href="Tactic.Derive.Show.html#814" class="Function">showName</a> <a id="848" href="Tactic.Derive.Show.html#848" class="Bound">n</a> <a id="850" class="Symbol">=</a> <a id="852" class="Keyword">let</a> <a id="856" href="Tactic.Derive.Show.html#856" class="Bound">n&#39;</a> <a id="859" class="Symbol">=</a> <a id="861" href="Reflection.AST.Show.html#1581" class="Primitive">R.showName</a> <a id="872" href="Tactic.Derive.Show.html#848" class="Bound">n</a> <a id="874" class="Keyword">in</a> <a id="877" href="Tactic.Derive.Show.html#909" class="Function">dropModulePrefix</a> <a id="894" href="Tactic.Derive.Show.html#856" class="Bound">n&#39;</a>
  <a id="899" class="Keyword">where</a>
    <a id="909" href="Tactic.Derive.Show.html#909" class="Function">dropModulePrefix</a> <a id="926" class="Symbol">:</a> <a id="928" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="935" class="Symbol">→</a> <a id="937" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
    <a id="948" href="Tactic.Derive.Show.html#909" class="Function">dropModulePrefix</a> <a id="965" href="Tactic.Derive.Show.html#965" class="Bound">s</a> <a id="967" class="Symbol">=</a> <a id="969" href="Data.String.Base.html#1591" class="Primitive">fromList</a> <a id="978" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="980" href="Data.List.Base.html#7225" class="Function">reverse</a> <a id="988" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="990" href="Data.List.Base.html#10175" class="Function">takeWhile</a> <a id="1000" class="Symbol">(</a><a id="1001" href="Relation.Nullary.Decidable.Core.html#3011" class="Function">¬?</a> <a id="1004" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1006" class="Symbol">(</a><a id="1007" class="String">&#39;.&#39;</a> <a id="1011" href="Class.DecEq.Core.html#159" class="Field Operator">≟_</a><a id="1013" class="Symbol">))</a> <a id="1016" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1018" href="Data.List.Base.html#7225" class="Function">reverse</a> <a id="1026" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1028" href="Data.String.Base.html#1558" class="Primitive">toList</a> <a id="1035" href="Tactic.Derive.Show.html#965" class="Bound">s</a>

<a id="wrapWithPars"></a><a id="1038" href="Tactic.Derive.Show.html#1038" class="Function">wrapWithPars</a> <a id="1051" class="Symbol">:</a> <a id="1053" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="1060" class="Symbol">→</a> <a id="1062" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1069" href="Tactic.Derive.Show.html#1038" class="Function">wrapWithPars</a> <a id="1082" href="Tactic.Derive.Show.html#1082" class="Bound">s</a> <a id="1084" class="Symbol">=</a> <a id="1086" class="String">&quot;(&quot;</a> <a id="1090" href="Tactic.Derive.Show.html#355" class="Function Operator">++S</a> <a id="1094" href="Tactic.Derive.Show.html#1082" class="Bound">s</a> <a id="1096" href="Tactic.Derive.Show.html#355" class="Function Operator">++S</a> <a id="1100" class="String">&quot;)&quot;</a>

<a id="genPars"></a><a id="1105" href="Tactic.Derive.Show.html#1105" class="Function">genPars</a> <a id="1113" class="Symbol">:</a> <a id="1115" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1120" class="Symbol">→</a> <a id="1122" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="1127" href="Tactic.Derive.Show.html#1105" class="Function">genPars</a> <a id="1135" href="Tactic.Derive.Show.html#1135" class="Bound">t</a> <a id="1137" class="Symbol">=</a> <a id="1139" class="Keyword">quote</a> <a id="1145" href="Tactic.Derive.Show.html#1038" class="Function">wrapWithPars</a> <a id="1158" href="Reflection.Syntax.html#2923" class="InductiveConstructor Operator">∙⟦</a> <a id="1161" href="Tactic.Derive.Show.html#1135" class="Bound">t</a> <a id="1163" href="Reflection.Syntax.html#2923" class="InductiveConstructor Operator">⟧</a>

<a id="1166" class="Keyword">module</a> <a id="1173" href="Tactic.Derive.Show.html#1173" class="Module">_</a> <a id="1175" class="Symbol">(</a><a id="1176" href="Tactic.Derive.Show.html#1176" class="Bound">transName</a> <a id="1186" class="Symbol">:</a> <a id="1188" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1193" class="Symbol">→</a> <a id="1195" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1201" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="1205" class="Symbol">)</a> <a id="1207" class="Keyword">where</a>
  <a id="1215" href="Tactic.Derive.Show.html#1215" class="Function">showFromTerm</a> <a id="1228" class="Symbol">:</a> <a id="1230" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1235" class="Symbol">→</a> <a id="1237" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1242" class="Symbol">→</a> <a id="1244" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="1251" href="Tactic.Derive.Show.html#1215" class="Function">showFromTerm</a> <a id="1264" class="Symbol">(</a><a id="1265" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1269" href="Tactic.Derive.Show.html#1269" class="Bound">n</a> <a id="1271" class="Symbol">_)</a> <a id="1274" href="Tactic.Derive.Show.html#1274" class="Bound">t</a> <a id="1276" class="Keyword">with</a> <a id="1281" href="Tactic.Derive.Show.html#1176" class="Bound">transName</a> <a id="1291" href="Tactic.Derive.Show.html#1269" class="Bound">n</a>
  <a id="1295" class="Symbol">...</a> <a id="1299" class="Symbol">|</a> <a id="1301" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1306" href="Tactic.Derive.Show.html#1306" class="Bound">n&#39;</a>    <a id="1312" class="Symbol">=</a> <a id="1314" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1318" class="Symbol">(</a><a id="1319" class="Keyword">quote</a> <a id="1325" href="Class.Show.Core.html#178" class="Field">show</a><a id="1329" class="Symbol">)</a> <a id="1331" class="Symbol">(</a><a id="1332" href="Reflection.AST.Argument.html#1453" class="InductiveConstructor">iArg</a> <a id="1337" class="Symbol">(</a><a id="1338" href="Tactic.Derive.Show.html#1306" class="Bound">n&#39;</a> <a id="1341" href="Reflection.Syntax.html#2899" class="InductiveConstructor Operator">∙</a><a id="1342" class="Symbol">)</a> <a id="1344" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1346" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="1351" class="Bound">t</a> <a id="1353" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1355" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1357" class="Symbol">)</a>
  <a id="1361" class="Symbol">...</a> <a id="1365" class="Symbol">|</a> <a id="1367" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>    <a id="1378" class="Symbol">=</a> <a id="1380" class="Keyword">quote</a> <a id="1386" href="Class.Show.Core.html#178" class="Field">show</a> <a id="1391" href="Reflection.Syntax.html#2923" class="InductiveConstructor Operator">∙⟦</a> <a id="1394" class="Bound">t</a> <a id="1396" href="Reflection.Syntax.html#2923" class="InductiveConstructor Operator">⟧</a>
  <a id="1400" href="Tactic.Derive.Show.html#1215" class="CatchallClause Function">showFromTerm</a><a id="1412" class="CatchallClause"> </a><a id="1413" class="CatchallClause Symbol">_</a><a id="1414" class="CatchallClause"> </a><a id="1415" href="Tactic.Derive.Show.html#1415" class="CatchallClause Bound">t</a> <a id="1417" class="Symbol">=</a> <a id="1419" class="Keyword">quote</a> <a id="1425" href="Class.Show.Core.html#178" class="Field">show</a> <a id="1430" href="Reflection.Syntax.html#2923" class="InductiveConstructor Operator">∙⟦</a> <a id="1433" href="Tactic.Derive.Show.html#1415" class="Bound">t</a> <a id="1435" href="Reflection.Syntax.html#2923" class="InductiveConstructor Operator">⟧</a>

  <a id="1440" href="Tactic.Derive.Show.html#1440" class="Function">genShow</a> <a id="1448" class="Symbol">:</a> <a id="1450" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1455" class="Symbol">→</a> <a id="1457" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1462" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1467" class="Symbol">→</a> <a id="1469" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="1476" href="Tactic.Derive.Show.html#1440" class="Function">genShow</a> <a id="1484" href="Tactic.Derive.Show.html#1484" class="Bound">n</a> <a id="1486" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="1489" class="Symbol">=</a> <a id="1491" href="Tactic.Derive.Show.html#756" class="Function">sLit</a> <a id="1496" class="Symbol">(</a><a id="1497" href="Tactic.Derive.Show.html#814" class="Function">showName</a> <a id="1506" href="Tactic.Derive.Show.html#1484" class="Bound">n</a><a id="1507" class="Symbol">)</a>
  <a id="1511" href="Tactic.Derive.Show.html#1440" class="Function">genShow</a> <a id="1519" href="Tactic.Derive.Show.html#1519" class="Bound">n</a> <a id="1521" class="Symbol">(</a><a id="1522" href="Tactic.Derive.Show.html#1522" class="Bound">x</a> <a id="1524" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1526" href="Tactic.Derive.Show.html#1526" class="Bound">l</a><a id="1527" class="Symbol">)</a> <a id="1529" class="Symbol">=</a> <a id="1531" class="Keyword">quote</a> <a id="1537" href="Data.String.Base.html#3151" class="Function Operator">_&lt;+&gt;_</a> <a id="1543" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">∙⟦</a> <a id="1546" href="Tactic.Derive.Show.html#1440" class="Function">genShow</a> <a id="1554" href="Tactic.Derive.Show.html#1519" class="Bound">n</a> <a id="1556" href="Tactic.Derive.Show.html#1526" class="Bound">l</a> <a id="1558" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">∣</a> <a id="1560" href="Tactic.Derive.Show.html#1105" class="Function">genPars</a> <a id="1568" href="Tactic.Derive.Show.html#1522" class="Bound">x</a> <a id="1570" href="Reflection.Syntax.html#2963" class="InductiveConstructor Operator">⟧</a>

  <a id="1575" href="Tactic.Derive.Show.html#1575" class="Function">patternToClause</a> <a id="1591" class="Symbol">:</a> <a id="1593" href="Tactic.ClauseBuilder.html#1277" class="Function">SinglePattern</a> <a id="1607" class="Symbol">→</a> <a id="1609" href="Data.List.NonEmpty.Base.html#1229" class="Record">NE.List⁺</a> <a id="1618" href="Tactic.ClauseBuilder.html#1277" class="Function">SinglePattern</a> <a id="1632" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1634" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="1637" class="Symbol">(</a><a id="1638" href="Tactic.ClauseBuilder.html#5769" class="Datatype">ClauseExpr</a> <a id="1649" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="1651" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1657" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="1661" class="Symbol">)</a>
  <a id="1665" href="Tactic.Derive.Show.html#1575" class="Function">patternToClause</a> <a id="1681" href="Tactic.Derive.Show.html#1681" class="Bound">p</a><a id="1682" class="Symbol">@(</a><a id="1684" href="Tactic.Derive.Show.html#1684" class="Bound">l</a> <a id="1686" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1688" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="1692" class="Symbol">_</a> <a id="1694" class="Symbol">(</a><a id="1695" href="Agda.Builtin.Reflection.html#5814" class="InductiveConstructor">Pattern.con</a> <a id="1707" href="Tactic.Derive.Show.html#1707" class="Bound">n</a> <a id="1709" class="Symbol">_))</a> <a id="1713" class="Symbol">=</a> <a id="1715" href="Data.List.NonEmpty.Base.html#1491" class="Function Operator">NE.[</a> <a id="1720" href="Tactic.Derive.Show.html#1681" class="Bound">p</a> <a id="1722" href="Data.List.NonEmpty.Base.html#1491" class="Function Operator">]</a> <a id="1724" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1726" href="Tactic.ClauseBuilder.html#12864" class="Function">finishMatch</a> <a id="1738" class="Keyword">do</a>
    <a id="1745" href="Tactic.Derive.Show.html#1745" class="Bound">typeList</a> <a id="1754" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="1756" href="Class.Traversable.Core.html#288" class="Function">traverse</a> <a id="1765" class="Symbol">⦃</a> <a id="1767" href="Class.Functor.Instances.html#436" class="Function">Functor-List</a> <a id="1780" class="Symbol">⦄</a> <a id="1782" class="Symbol">(λ</a> <a id="1785" href="Tactic.Derive.Show.html#1785" class="Bound">t</a> <a id="1787" class="Symbol">→</a> <a id="1789" class="Keyword">do</a> <a id="1792" href="Tactic.Derive.Show.html#1792" class="Bound">T</a> <a id="1794" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="1796" href="Class.MonadTC.html#1750" class="Field">inferType</a> <a id="1806" href="Tactic.Derive.Show.html#1785" class="Bound">t</a><a id="1807" class="Symbol">;</a> <a id="1809" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="1816" class="Symbol">(</a><a id="1817" href="Tactic.Derive.Show.html#1792" class="Bound">T</a> <a id="1819" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1821" href="Tactic.Derive.Show.html#1785" class="Bound">t</a><a id="1822" class="Symbol">))</a> <a id="1825" class="Symbol">(</a><a id="1826" href="Data.List.Base.html#6320" class="Function">applyDownFrom</a> <a id="1840" href="Reflection.Syntax.html#1452" class="InductiveConstructor">♯</a> <a id="1842" class="Symbol">(</a><a id="1843" href="Data.List.Base.html#5044" class="Function">length</a> <a id="1850" href="Tactic.Derive.Show.html#1684" class="Bound">l</a><a id="1851" class="Symbol">))</a>
    <a id="1858" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="1865" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1867" href="Tactic.Derive.Show.html#1440" class="Function">genShow</a> <a id="1875" href="Tactic.Derive.Show.html#1707" class="Bound">n</a> <a id="1877" class="Symbol">(</a><a id="1878" href="Data.List.Base.html#1634" class="Function">L.map</a> <a id="1884" class="Symbol">(</a><a id="1885" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="1893" href="Tactic.Derive.Show.html#1215" class="Function">showFromTerm</a><a id="1905" class="Symbol">)</a> <a id="1907" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1909" href="Data.List.Base.html#7225" class="Function">reverse</a> <a id="1917" href="Tactic.Derive.Show.html#1745" class="Bound">typeList</a><a id="1925" class="Symbol">)</a>
  <a id="1929" href="Tactic.Derive.Show.html#1575" class="CatchallClause Function">patternToClause</a><a id="1944" class="CatchallClause"> </a><a id="1945" href="Tactic.Derive.Show.html#1945" class="CatchallClause Bound">p</a> <a id="1947" class="Symbol">=</a> <a id="1949" href="Data.List.NonEmpty.Base.html#1491" class="Function Operator">NE.[</a> <a id="1954" href="Tactic.Derive.Show.html#1945" class="Bound">p</a> <a id="1956" href="Data.List.NonEmpty.Base.html#1491" class="Function Operator">]</a> <a id="1958" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1960" href="Class.MonadTC.html#8771" class="Function">error1</a> <a id="1967" class="String">&quot;Error: not a con!&quot;</a>

<a id="1988" class="Keyword">module</a> <a id="1995" href="Tactic.Derive.Show.html#1995" class="Module">_</a> <a id="1997" class="Symbol">⦃</a> <a id="1999" href="Tactic.Derive.Show.html#1999" class="Bound">_</a> <a id="2001" class="Symbol">:</a> <a id="2003" href="Class.MonadTC.html#618" class="Record">TCOptions</a> <a id="2013" class="Symbol">⦄</a> <a id="2015" class="Keyword">where</a>
  <a id="2023" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a> <a id="2035" class="Symbol">:</a> <a id="2037" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2042" class="Symbol">(</a><a id="2043" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="2048" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="2050" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="2054" class="Symbol">)</a> <a id="2056" class="Symbol">→</a> <a id="2058" href="Reflection.Tactic.html#512" class="Function">UnquoteDecl</a>
  <a id="2072" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a> <a id="2084" class="Symbol">=</a> <a id="2086" href="Tactic.Derive.html#4944" class="Function">derive-Class</a> <a id="2099" class="Number">0</a> <a id="2101" class="Symbol">(λ</a> <a id="2104" href="Tactic.Derive.Show.html#2104" class="Bound">transName</a> <a id="2114" class="Symbol">→</a> <a id="2116" href="Data.List.Base.html#1634" class="Function">L.map</a> <a id="2122" class="Symbol">(</a><a id="2123" href="Tactic.Derive.Show.html#1575" class="Function">patternToClause</a> <a id="2139" href="Tactic.Derive.Show.html#2104" class="Bound">transName</a><a id="2148" class="Symbol">))</a>

<a id="2152" class="Keyword">private</a>
  <a id="2162" class="Keyword">open</a> <a id="2167" class="Keyword">import</a> <a id="2174" href="Tactic.Derive.TestTypes.html" class="Module">Tactic.Derive.TestTypes</a>
  <a id="2200" class="Keyword">import</a> <a id="2207" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
  <a id="2223" class="Keyword">open</a> <a id="2228" class="Keyword">import</a> <a id="2235" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

  <a id="2254" class="Keyword">unquoteDecl</a> <a id="Show-Bool"></a><a id="2266" href="Tactic.Derive.Show.html#2266" class="Function">Show-Bool</a> <a id="Show-ℤ"></a><a id="2276" href="Tactic.Derive.Show.html#2276" class="Function">Show-ℤ</a> <a id="Show-List"></a><a id="2283" href="Tactic.Derive.Show.html#2283" class="Function">Show-List</a> <a id="Show-Maybe"></a><a id="2293" href="Tactic.Derive.Show.html#2293" class="Function">Show-Maybe</a> <a id="Show-ℕ"></a><a id="2304" href="Tactic.Derive.Show.html#2304" class="Function">Show-ℕ</a> <a id="Show-Sign"></a><a id="2311" href="Tactic.Derive.Show.html#2311" class="Function">Show-Sign</a> <a id="Show-⊤"></a><a id="2321" href="Tactic.Derive.Show.html#2321" class="Function">Show-⊤</a> <a id="2328" class="Symbol">=</a> <a id="2330" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a> <a id="2342" class="Symbol">((</a><a id="2344" class="Keyword">quote</a> <a id="2350" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="2355" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2357" href="Tactic.Derive.Show.html#2266" class="Function">Show-Bool</a><a id="2366" class="Symbol">)</a> <a id="2368" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2370" class="Symbol">(</a><a id="2371" class="Keyword">quote</a> <a id="2377" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a> <a id="2379" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2381" href="Tactic.Derive.Show.html#2276" class="Function">Show-ℤ</a><a id="2387" class="Symbol">)</a> <a id="2389" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2391" class="Symbol">(</a><a id="2392" class="Keyword">quote</a> <a id="2398" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2403" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2405" href="Tactic.Derive.Show.html#2283" class="Function">Show-List</a><a id="2414" class="Symbol">)</a> <a id="2416" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2418" class="Symbol">(</a><a id="2419" class="Keyword">quote</a> <a id="2425" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2431" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2433" href="Tactic.Derive.Show.html#2293" class="Function">Show-Maybe</a><a id="2443" class="Symbol">)</a> <a id="2445" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2447" class="Symbol">(</a><a id="2448" class="Keyword">quote</a> <a id="2454" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2456" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2458" href="Tactic.Derive.Show.html#2304" class="Function">Show-ℕ</a><a id="2464" class="Symbol">)</a> <a id="2466" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2468" class="Symbol">(</a><a id="2469" class="Keyword">quote</a> <a id="2475" href="Data.Sign.Base.html#523" class="Datatype">Sign</a> <a id="2480" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2482" href="Tactic.Derive.Show.html#2311" class="Function">Show-Sign</a><a id="2491" class="Symbol">)</a> <a id="2493" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2495" class="Symbol">(</a><a id="2496" class="Keyword">quote</a> <a id="2502" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="2504" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2506" href="Tactic.Derive.Show.html#2321" class="Function">Show-⊤</a><a id="2512" class="Symbol">)</a> <a id="2514" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2516" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2518" class="Symbol">)</a>

  <a id="2523" class="Keyword">unquoteDecl</a> <a id="Show-Fin"></a><a id="2535" href="Tactic.Derive.Show.html#2535" class="Function">Show-Fin</a> <a id="2544" class="Symbol">=</a> <a id="2546" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a> <a id="2558" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="2560" class="Symbol">(</a><a id="2561" class="Keyword">quote</a> <a id="2567" href="Data.Fin.Base.html#1159" class="Datatype">Fin</a> <a id="2571" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2573" href="Tactic.Derive.Show.html#2535" class="Function">Show-Fin</a><a id="2581" class="Symbol">)</a> <a id="2583" href="Data.List.Base.html#5205" class="Function Operator">]</a>
  <a id="2587" class="Keyword">unquoteDecl</a> <a id="Show-Vec"></a><a id="2599" href="Tactic.Derive.Show.html#2599" class="Function">Show-Vec</a> <a id="2608" class="Symbol">=</a> <a id="2610" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a> <a id="2622" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="2624" class="Symbol">(</a><a id="2625" class="Keyword">quote</a> <a id="2631" href="Data.Vec.Base.html#1119" class="Datatype">Vec</a> <a id="2635" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2637" href="Tactic.Derive.Show.html#2599" class="Function">Show-Vec</a><a id="2645" class="Symbol">)</a> <a id="2647" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="2652" class="Keyword">unquoteDecl</a> <a id="Show-These"></a><a id="2664" href="Tactic.Derive.Show.html#2664" class="Function">Show-These</a> <a id="2675" class="Symbol">=</a> <a id="2677" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a> <a id="2689" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="2691" class="Symbol">(</a><a id="2692" class="Keyword">quote</a> <a id="2698" href="Data.These.Base.html#537" class="Datatype">These</a> <a id="2704" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2706" href="Tactic.Derive.Show.html#2664" class="Function">Show-These</a><a id="2716" class="Symbol">)</a> <a id="2718" href="Data.List.Base.html#5205" class="Function Operator">]</a>
  <a id="2722" class="Keyword">unquoteDecl</a> <a id="Show-⊎"></a><a id="2734" href="Tactic.Derive.Show.html#2734" class="Function">Show-⊎</a> <a id="2741" class="Symbol">=</a> <a id="2743" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a> <a id="2755" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="2757" class="Symbol">(</a><a id="2758" class="Keyword">quote</a> <a id="2764" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a> <a id="2768" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2770" href="Tactic.Derive.Show.html#2734" class="Function">Show-⊎</a><a id="2776" class="Symbol">)</a> <a id="2778" href="Data.List.Base.html#5205" class="Function Operator">]</a>

  <a id="2783" class="Keyword">unquoteDecl</a> <a id="Show-E1"></a><a id="2795" href="Tactic.Derive.Show.html#2795" class="Function">Show-E1</a> <a id="Show-E2"></a><a id="2803" href="Tactic.Derive.Show.html#2803" class="Function">Show-E2</a> <a id="Show-E3"></a><a id="2811" href="Tactic.Derive.Show.html#2811" class="Function">Show-E3</a> <a id="2819" class="Symbol">=</a> <a id="2821" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a>
    <a id="2837" class="Symbol">((</a><a id="2839" class="Keyword">quote</a> <a id="2845" href="Tactic.Derive.TestTypes.html#197" class="Datatype">E1</a> <a id="2848" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2850" href="Tactic.Derive.Show.html#2795" class="Function">Show-E1</a><a id="2857" class="Symbol">)</a> <a id="2859" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2861" class="Symbol">(</a><a id="2862" class="Keyword">quote</a> <a id="2868" href="Tactic.Derive.TestTypes.html#302" class="Datatype">E2</a> <a id="2871" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2873" href="Tactic.Derive.Show.html#2803" class="Function">Show-E2</a><a id="2880" class="Symbol">)</a> <a id="2882" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2884" class="Symbol">(</a><a id="2885" class="Keyword">quote</a> <a id="2891" href="Tactic.Derive.TestTypes.html#380" class="Datatype">E3</a> <a id="2894" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2896" href="Tactic.Derive.Show.html#2811" class="Function">Show-E3</a><a id="2903" class="Symbol">)</a> <a id="2905" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2907" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2909" class="Symbol">)</a>

  <a id="2914" class="Comment">-- unquoteDecl Show-E4 = derive-Show [ (quote E4 , Show-E4) ]</a>

  <a id="2979" class="Keyword">unquoteDecl</a> <a id="Show-R1"></a><a id="2991" href="Tactic.Derive.Show.html#2991" class="Function">Show-R1</a> <a id="Show-R2"></a><a id="2999" href="Tactic.Derive.Show.html#2999" class="Function">Show-R2</a> <a id="3007" class="Symbol">=</a> <a id="3009" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a>
    <a id="3025" class="Symbol">((</a><a id="3027" class="Keyword">quote</a> <a id="3033" href="Tactic.Derive.TestTypes.html#590" class="Record">R1</a> <a id="3036" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3038" href="Tactic.Derive.Show.html#2991" class="Function">Show-R1</a><a id="3045" class="Symbol">)</a> <a id="3047" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3049" class="Symbol">(</a><a id="3050" class="Keyword">quote</a> <a id="3056" href="Tactic.Derive.TestTypes.html#651" class="Record">R2</a> <a id="3059" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3061" href="Tactic.Derive.Show.html#2999" class="Function">Show-R2</a><a id="3068" class="Symbol">)</a> <a id="3070" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3072" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3074" class="Symbol">)</a>

  <a id="3079" class="Keyword">unquoteDecl</a> <a id="Show-M₁"></a><a id="3091" href="Tactic.Derive.Show.html#3091" class="Function">Show-M₁</a> <a id="Show-M₂"></a><a id="3099" href="Tactic.Derive.Show.html#3099" class="Function">Show-M₂</a> <a id="3107" class="Symbol">=</a> <a id="3109" href="Tactic.Derive.Show.html#2023" class="Function">derive-Show</a> <a id="3121" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3123" class="Symbol">(</a><a id="3124" class="Keyword">quote</a> <a id="3130" href="Tactic.Derive.TestTypes.html#798" class="Datatype">M₁</a> <a id="3133" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3135" href="Tactic.Derive.Show.html#3091" class="Function">Show-M₁</a><a id="3142" class="Symbol">)</a> <a id="3144" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3146" class="Symbol">(</a><a id="3147" class="Keyword">quote</a> <a id="3153" href="Tactic.Derive.TestTypes.html#812" class="Datatype">M₂</a> <a id="3156" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3158" href="Tactic.Derive.Show.html#3099" class="Function">Show-M₂</a><a id="3165" class="Symbol">)</a> <a id="3167" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3169" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="3175" class="Comment">-- Expected: Show-Product Show-Term</a>
</pre></body></html>