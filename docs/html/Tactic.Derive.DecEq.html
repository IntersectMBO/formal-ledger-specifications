<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Tactic.Derive.DecEq</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- Deriving decidable equality. This works in several cases that use</a>
<a id="70" class="Comment">-- mutual recursion, examples are at the bottom.</a>
<a id="119" class="Comment">--</a>
<a id="122" class="Comment">-- TODO: This breaks with:</a>
<a id="149" class="Comment">-- - dependent records, e.g. Product</a>
<a id="186" class="Comment">-- - anything listed in Tactic.Derive</a>
<a id="224" class="Comment">-- - maybe more</a>

<a id="241" class="Symbol">{-#</a> <a id="245" class="Keyword">OPTIONS</a> <a id="253" class="Pragma">-v</a> <a id="256" class="Pragma">allTactics:100</a> <a id="271" class="Symbol">#-}</a>
<a id="275" class="Symbol">{-#</a> <a id="279" class="Keyword">OPTIONS</a> <a id="287" class="Pragma">--safe</a> <a id="294" class="Symbol">#-}</a>
<a id="298" class="Keyword">module</a> <a id="305" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a> <a id="325" class="Keyword">where</a>

<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="MetaPrelude.html" class="Module">MetaPrelude</a>
<a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Meta.html" class="Module">Meta</a>

<a id="374" class="Keyword">import</a> <a id="381" href="Data.List.html" class="Module">Data.List</a> <a id="391" class="Symbol">as</a> <a id="394" class="Module">L</a>
<a id="396" class="Keyword">import</a> <a id="403" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="422" class="Symbol">as</a> <a id="425" class="Module">NE</a>

<a id="429" class="Keyword">open</a> <a id="434" class="Keyword">import</a> <a id="441" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="458" class="Keyword">open</a> <a id="463" class="Keyword">import</a> <a id="470" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>

<a id="498" class="Keyword">open</a> <a id="503" class="Keyword">import</a> <a id="510" href="Reflection.Tactic.html" class="Module">Reflection.Tactic</a>
<a id="528" class="Keyword">open</a> <a id="533" class="Keyword">import</a> <a id="540" href="Reflection.AST.Term.html" class="Module">Reflection.AST.Term</a> <a id="560" class="Keyword">using</a> <a id="566" class="Symbol">(</a><a id="567" href="Reflection.AST.Term.html#5711" class="Function Operator">_≟-Pattern_</a><a id="578" class="Symbol">)</a>
<a id="580" class="Keyword">open</a> <a id="585" class="Keyword">import</a> <a id="592" href="Reflection.Utils.html" class="Module">Reflection.Utils</a>
<a id="609" class="Keyword">open</a> <a id="614" class="Keyword">import</a> <a id="621" href="Reflection.Utils.TCI.html" class="Module">Reflection.Utils.TCI</a>

<a id="643" class="Keyword">open</a> <a id="648" class="Keyword">import</a> <a id="655" href="Class.DecEq.Core.html" class="Module">Class.DecEq.Core</a>
<a id="672" class="Keyword">open</a> <a id="677" class="Keyword">import</a> <a id="684" href="Class.Functor.html" class="Module">Class.Functor</a>
<a id="698" class="Keyword">open</a> <a id="703" class="Keyword">import</a> <a id="710" href="Class.Monad.html" class="Module">Class.Monad</a>
<a id="722" class="Keyword">open</a> <a id="727" class="Keyword">import</a> <a id="734" href="Class.MonadTC.Instances.html" class="Module">Class.MonadTC.Instances</a>
<a id="758" class="Keyword">open</a> <a id="763" class="Keyword">import</a> <a id="770" href="Class.Traversable.html" class="Module">Class.Traversable</a>

<a id="789" class="Keyword">open</a> <a id="794" class="Keyword">import</a> <a id="801" href="Tactic.ClauseBuilder.html" class="Module">Tactic.ClauseBuilder</a>
<a id="822" class="Keyword">open</a> <a id="827" class="Keyword">import</a> <a id="834" href="Tactic.Derive.html" class="Module">Tactic.Derive</a> <a id="848" class="Symbol">(</a><a id="849" class="Keyword">quote</a> <a id="855" href="Class.DecEq.Core.html#117" class="Record">DecEq</a><a id="860" class="Symbol">)</a> <a id="862" class="Symbol">(</a><a id="863" class="Keyword">quote</a> <a id="869" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a><a id="872" class="Symbol">)</a>

<a id="875" class="Keyword">instance</a>
  <a id="886" href="Tactic.Derive.DecEq.html#886" class="Function">_</a> <a id="888" class="Symbol">=</a> <a id="890" href="Tactic.ClauseBuilder.html#10692" class="Function">ContextMonad-MonadTC</a>

<a id="912" class="Keyword">open</a> <a id="917" href="Tactic.ClauseBuilder.html#10922" class="Module">ClauseExprM</a>

<a id="`yes"></a><a id="930" href="Tactic.Derive.DecEq.html#930" class="Function">`yes</a> <a id="`no"></a><a id="935" href="Tactic.Derive.DecEq.html#935" class="Function">`no</a> <a id="939" class="Symbol">:</a> <a id="941" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="946" class="Symbol">→</a> <a id="948" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
<a id="953" href="Tactic.Derive.DecEq.html#930" class="Function">`yes</a> <a id="958" href="Tactic.Derive.DecEq.html#958" class="Bound">x</a> <a id="960" class="Symbol">=</a> <a id="962" class="Keyword">quote</a> <a id="968" href="Relation.Nullary.Decidable.Core.html#1529" class="InductiveConstructor Operator">_because_</a> <a id="978" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">◆⟦</a> <a id="981" class="Keyword">quote</a> <a id="987" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>  <a id="993" href="Reflection.Syntax.html#3143" class="InductiveConstructor Operator">◆</a> <a id="995" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">∣</a> <a id="997" class="Keyword">quote</a> <a id="1003" href="Relation.Nullary.Reflects.html#982" class="InductiveConstructor">ofʸ</a> <a id="1007" href="Reflection.Syntax.html#3167" class="InductiveConstructor Operator">◆⟦</a> <a id="1010" href="Tactic.Derive.DecEq.html#958" class="Bound">x</a> <a id="1012" href="Reflection.Syntax.html#3167" class="InductiveConstructor Operator">⟧</a> <a id="1014" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">⟧</a>
<a id="1016" href="Tactic.Derive.DecEq.html#935" class="Function">`no</a>  <a id="1021" href="Tactic.Derive.DecEq.html#1021" class="Bound">x</a> <a id="1023" class="Symbol">=</a> <a id="1025" class="Keyword">quote</a> <a id="1031" href="Relation.Nullary.Decidable.Core.html#1529" class="InductiveConstructor Operator">_because_</a> <a id="1041" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">◆⟦</a> <a id="1044" class="Keyword">quote</a> <a id="1050" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="1056" href="Reflection.Syntax.html#3143" class="InductiveConstructor Operator">◆</a> <a id="1058" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">∣</a> <a id="1060" class="Keyword">quote</a> <a id="1066" href="Relation.Nullary.Reflects.html#1019" class="InductiveConstructor">ofⁿ</a> <a id="1070" href="Reflection.Syntax.html#3167" class="InductiveConstructor Operator">◆⟦</a> <a id="1073" href="Tactic.Derive.DecEq.html#1021" class="Bound">x</a> <a id="1075" href="Reflection.Syntax.html#3167" class="InductiveConstructor Operator">⟧</a> <a id="1077" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">⟧</a>

<a id="1080" class="Comment">-- We take the Dec P argument first to improve type checking performance.</a>
<a id="1154" class="Comment">-- It&#39;s easy to infer the type of P from this argument and we need to know</a>
<a id="1229" class="Comment">-- P to be able to check the pattern lambda generated for the P → Q direction</a>
<a id="1307" class="Comment">-- of the isomorphism. Having the isomorphism first would cause the type checker</a>
<a id="1388" class="Comment">-- to go back and forth between the pattern lambda and the Dec P argument,</a>
<a id="1463" class="Comment">-- inferring just enough of the type of make progress on the lambda.</a>
<a id="map&#39;"></a><a id="1532" href="Tactic.Derive.DecEq.html#1532" class="Function">map&#39;</a> <a id="1537" class="Symbol">:</a> <a id="1539" class="Symbol">∀</a> <a id="1541" class="Symbol">{</a><a id="1542" href="Tactic.Derive.DecEq.html#1542" class="Bound">p</a> <a id="1544" href="Tactic.Derive.DecEq.html#1544" class="Bound">q</a><a id="1545" class="Symbol">}</a> <a id="1547" class="Symbol">{</a><a id="1548" href="Tactic.Derive.DecEq.html#1548" class="Bound">P</a> <a id="1550" class="Symbol">:</a> <a id="1552" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1556" href="Tactic.Derive.DecEq.html#1542" class="Bound">p</a><a id="1557" class="Symbol">}</a> <a id="1559" class="Symbol">{</a><a id="1560" href="Tactic.Derive.DecEq.html#1560" class="Bound">Q</a> <a id="1562" class="Symbol">:</a> <a id="1564" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1568" href="Tactic.Derive.DecEq.html#1544" class="Bound">q</a><a id="1569" class="Symbol">}</a> <a id="1571" class="Symbol">→</a> <a id="1573" href="Relation.Nullary.Decidable.Core.html#1485" class="Record">Dec</a> <a id="1577" href="Tactic.Derive.DecEq.html#1548" class="Bound">P</a> <a id="1579" class="Symbol">→</a> <a id="1581" href="Tactic.Derive.DecEq.html#1548" class="Bound">P</a> <a id="1583" href="Function.Bundles.html#12039" class="Function Operator">⇔</a> <a id="1585" href="Tactic.Derive.DecEq.html#1560" class="Bound">Q</a> <a id="1587" class="Symbol">→</a> <a id="1589" href="Relation.Nullary.Decidable.Core.html#1485" class="Record">Dec</a> <a id="1593" href="Tactic.Derive.DecEq.html#1560" class="Bound">Q</a>
<a id="1595" href="Tactic.Derive.DecEq.html#1532" class="Function">map&#39;</a> <a id="1600" href="Tactic.Derive.DecEq.html#1600" class="Bound">d</a> <a id="1602" class="Keyword">record</a> <a id="1609" class="Symbol">{</a> <a id="1611" href="Function.Bundles.html#4810" class="Field">to</a> <a id="1614" class="Symbol">=</a> <a id="1616" href="Tactic.Derive.DecEq.html#1616" class="Bound">to</a> <a id="1619" class="Symbol">;</a> <a id="1621" href="Function.Bundles.html#4834" class="Field">from</a> <a id="1626" class="Symbol">=</a> <a id="1628" href="Tactic.Derive.DecEq.html#1628" class="Bound">from</a> <a id="1633" class="Symbol">}</a> <a id="1635" class="Symbol">=</a> <a id="1637" href="Relation.Nullary.Decidable.Core.html#4901" class="Function">map′</a> <a id="1642" href="Tactic.Derive.DecEq.html#1616" class="Bound">to</a> <a id="1645" href="Tactic.Derive.DecEq.html#1628" class="Bound">from</a> <a id="1650" href="Tactic.Derive.DecEq.html#1600" class="Bound">d</a>

<a id="1653" class="Keyword">module</a> <a id="1660" href="Tactic.Derive.DecEq.html#1660" class="Module">_</a> <a id="1662" class="Symbol">(</a><a id="1663" href="Tactic.Derive.DecEq.html#1663" class="Bound">transName</a> <a id="1673" class="Symbol">:</a> <a id="1675" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="1680" class="Symbol">→</a> <a id="1682" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1688" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="1692" class="Symbol">)</a> <a id="1694" class="Keyword">where</a>

  <a id="1703" href="Tactic.Derive.DecEq.html#1703" class="Function">eqFromTerm</a> <a id="1714" class="Symbol">:</a> <a id="1716" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1721" class="Symbol">→</a> <a id="1723" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1728" class="Symbol">→</a> <a id="1730" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1735" class="Symbol">→</a> <a id="1737" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="1744" href="Tactic.Derive.DecEq.html#1703" class="Function">eqFromTerm</a> <a id="1755" class="Symbol">(</a><a id="1756" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1760" href="Tactic.Derive.DecEq.html#1760" class="Bound">n</a> <a id="1762" class="Symbol">_)</a> <a id="1765" href="Tactic.Derive.DecEq.html#1765" class="Bound">t</a> <a id="1767" href="Tactic.Derive.DecEq.html#1767" class="Bound">t&#39;</a> <a id="1770" class="Keyword">with</a> <a id="1775" href="Tactic.Derive.DecEq.html#1663" class="Bound">transName</a> <a id="1785" href="Tactic.Derive.DecEq.html#1760" class="Bound">n</a>
  <a id="1789" class="Symbol">...</a> <a id="1793" class="Symbol">|</a> <a id="1795" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1800" href="Tactic.Derive.DecEq.html#1800" class="Bound">n&#39;</a>     <a id="1807" class="Symbol">=</a> <a id="1809" href="Agda.Builtin.Reflection.html#5251" class="InductiveConstructor">def</a> <a id="1813" class="Symbol">(</a><a id="1814" class="Keyword">quote</a> <a id="1820" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a><a id="1823" class="Symbol">)</a> <a id="1825" class="Symbol">(</a><a id="1826" href="Reflection.AST.Argument.html#1453" class="InductiveConstructor">iArg</a> <a id="1831" class="Symbol">(</a><a id="1832" href="Tactic.Derive.DecEq.html#1800" class="Bound">n&#39;</a> <a id="1835" href="Reflection.Syntax.html#2880" class="InductiveConstructor Operator">∙</a><a id="1836" class="Symbol">)</a> <a id="1838" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1840" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="1845" class="Bound">t</a> <a id="1847" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1849" href="Reflection.AST.Argument.html#1329" class="InductiveConstructor">vArg</a> <a id="1854" class="Bound">t&#39;</a> <a id="1857" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1859" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1861" class="Symbol">)</a>
  <a id="1865" class="Symbol">...</a> <a id="1869" class="Symbol">|</a> <a id="1871" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>     <a id="1883" class="Symbol">=</a> <a id="1885" class="Keyword">quote</a> <a id="1891" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a> <a id="1895" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∙⟦</a> <a id="1898" class="Bound">t</a> <a id="1900" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∣</a> <a id="1902" class="Bound">t&#39;</a> <a id="1905" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">⟧</a>
  <a id="1909" href="Tactic.Derive.DecEq.html#1703" class="CatchallClause Function">eqFromTerm</a><a id="1919" class="CatchallClause"> </a><a id="1920" class="CatchallClause Symbol">_</a><a id="1921" class="CatchallClause"> </a><a id="1922" href="Tactic.Derive.DecEq.html#1922" class="CatchallClause Bound">t</a><a id="1923" class="CatchallClause"> </a><a id="1924" href="Tactic.Derive.DecEq.html#1924" class="CatchallClause Bound">t&#39;</a> <a id="1927" class="Symbol">=</a> <a id="1929" class="Keyword">quote</a> <a id="1935" href="Class.DecEq.Core.html#159" class="Field Operator">_≟_</a> <a id="1939" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∙⟦</a> <a id="1942" href="Tactic.Derive.DecEq.html#1922" class="Bound">t</a> <a id="1944" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∣</a> <a id="1946" href="Tactic.Derive.DecEq.html#1924" class="Bound">t&#39;</a> <a id="1949" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">⟧</a>

  <a id="1954" href="Tactic.Derive.DecEq.html#1954" class="Function">toDecEqName</a> <a id="1966" class="Symbol">:</a> <a id="1968" href="Tactic.ClauseBuilder.html#1277" class="Function">SinglePattern</a> <a id="1982" class="Symbol">→</a> <a id="1984" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1989" class="Symbol">(</a><a id="1990" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="1995" class="Symbol">→</a> <a id="1997" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2002" class="Symbol">→</a> <a id="2004" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2008" class="Symbol">)</a>
  <a id="2012" href="Tactic.Derive.DecEq.html#1954" class="Function">toDecEqName</a> <a id="2024" class="Symbol">(</a><a id="2025" href="Tactic.Derive.DecEq.html#2025" class="Bound">l</a> <a id="2027" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2029" class="Symbol">_)</a> <a id="2032" class="Symbol">=</a> <a id="2034" href="Data.List.Base.html#1631" class="Function">L.map</a> <a id="2040" class="Symbol">(λ</a> <a id="2043" class="Keyword">where</a> <a id="2049" class="Symbol">(_</a> <a id="2052" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2054" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="2058" class="Symbol">_</a> <a id="2060" href="Tactic.Derive.DecEq.html#2060" class="Bound">t</a><a id="2061" class="Symbol">)</a> <a id="2063" class="Symbol">→</a> <a id="2065" href="Tactic.Derive.DecEq.html#1703" class="Function">eqFromTerm</a> <a id="2076" href="Tactic.Derive.DecEq.html#2060" class="Bound">t</a><a id="2077" class="Symbol">)</a> <a id="2079" href="Tactic.Derive.DecEq.html#2025" class="Bound">l</a>

  <a id="2084" class="Comment">-- on the diagonal we have one pattern, outside we don&#39;t care</a>
  <a id="2148" class="Comment">-- assume that the types in the pattern are properly normalized</a>
  <a id="2214" href="Tactic.Derive.DecEq.html#2214" class="Function">mapDiag</a> <a id="2222" class="Symbol">:</a> <a id="2224" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2230" href="Tactic.ClauseBuilder.html#1277" class="Function">SinglePattern</a> <a id="2244" class="Symbol">→</a> <a id="2246" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="2249" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
  <a id="2256" href="Tactic.Derive.DecEq.html#2214" class="Function">mapDiag</a> <a id="2264" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>          <a id="2281" class="Symbol">=</a> <a id="2283" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="2290" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2292" href="Tactic.Derive.DecEq.html#935" class="Function">`no</a> <a id="2296" href="Reflection.Syntax.html#2465" class="InductiveConstructor Operator">`λ⦅</a> <a id="2300" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="2302" class="Symbol">(</a><a id="2303" class="String">&quot;&quot;</a> <a id="2306" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2308" href="Reflection.Syntax.html#1361" class="InductiveConstructor">vArg?</a><a id="2313" class="Symbol">)</a> <a id="2315" href="Data.List.Base.html#5244" class="Function Operator">]</a> <a id="2317" href="Reflection.Syntax.html#2465" class="InductiveConstructor Operator">⦆∅</a>
  <a id="2322" href="Tactic.Derive.DecEq.html#2214" class="Function">mapDiag</a> <a id="2330" class="Symbol">(</a><a id="2331" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2336" href="Tactic.Derive.DecEq.html#2336" class="Bound">p</a><a id="2337" class="Symbol">@(</a><a id="2339" href="Tactic.Derive.DecEq.html#2339" class="Bound">l</a> <a id="2341" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2343" class="Symbol">_))</a> <a id="2347" class="Symbol">=</a> <a id="2349" class="Keyword">let</a> <a id="2353" href="Tactic.Derive.DecEq.html#2353" class="Bound">k</a> <a id="2355" class="Symbol">=</a> <a id="2357" href="Data.List.Base.html#5083" class="Function">length</a> <a id="2364" href="Tactic.Derive.DecEq.html#2339" class="Bound">l</a> <a id="2366" class="Keyword">in</a> <a id="2369" class="Keyword">do</a>
    <a id="2376" href="Tactic.Derive.DecEq.html#2376" class="Bound">typeList</a> <a id="2385" href="Class.Monad.Core.html#290" class="Field Operator">←</a> <a id="2387" href="Class.Traversable.Core.html#288" class="Function">traverse</a> <a id="2396" class="Symbol">⦃</a> <a id="2398" href="Class.Functor.Instances.html#436" class="Function">Functor-List</a> <a id="2411" class="Symbol">⦄</a> <a id="2413" href="Class.MonadTC.html#1750" class="Field">inferType</a> <a id="2423" class="Symbol">(</a><a id="2424" href="Data.List.Base.html#6491" class="Function">applyDownFrom</a> <a id="2438" href="Reflection.Syntax.html#1433" class="InductiveConstructor">♯</a> <a id="2440" class="Symbol">(</a><a id="2441" href="Data.List.Base.html#5083" class="Function">length</a> <a id="2448" href="Tactic.Derive.DecEq.html#2339" class="Bound">l</a><a id="2449" class="Symbol">))</a>
    <a id="2456" href="Class.Monad.Core.html#269" class="Field">return</a> <a id="2463" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="2465" class="Keyword">quote</a> <a id="2471" href="Tactic.Derive.DecEq.html#1532" class="Function">map&#39;</a> <a id="2476" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∙⟦</a> <a id="2479" href="Tactic.Derive.DecEq.html#2546" class="Function">genPf</a> <a id="2485" href="Tactic.Derive.DecEq.html#2353" class="Bound">k</a> <a id="2487" class="Symbol">(</a><a id="2488" href="Data.List.Base.html#1631" class="Function">L.map</a> <a id="2494" href="Tactic.Derive.DecEq.html#1703" class="Function">eqFromTerm</a> <a id="2505" href="Tactic.Derive.DecEq.html#2376" class="Bound">typeList</a><a id="2513" class="Symbol">)</a> <a id="2515" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∣</a> <a id="2517" href="Tactic.Derive.DecEq.html#2785" class="Function">genEquiv</a> <a id="2526" href="Tactic.Derive.DecEq.html#2353" class="Bound">k</a> <a id="2528" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">⟧</a>
    <a id="2534" class="Keyword">where</a>
      <a id="2546" href="Tactic.Derive.DecEq.html#2546" class="Function">genPf</a> <a id="2552" class="Symbol">:</a> <a id="2554" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2556" class="Symbol">→</a> <a id="2558" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2563" class="Symbol">(</a><a id="2564" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2569" class="Symbol">→</a> <a id="2571" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a> <a id="2576" class="Symbol">→</a> <a id="2578" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="2582" class="Symbol">)</a> <a id="2584" class="Symbol">→</a> <a id="2586" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="2597" href="Tactic.Derive.DecEq.html#2546" class="Function">genPf</a> <a id="2603" href="Tactic.Derive.DecEq.html#2603" class="Bound">k</a> <a id="2605" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>      <a id="2613" class="Symbol">=</a> <a id="2615" href="Tactic.Derive.DecEq.html#930" class="Function">`yes</a> <a id="2620" class="Symbol">(</a><a id="2621" class="Keyword">quote</a> <a id="2627" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2630" href="Reflection.Syntax.html#3143" class="InductiveConstructor Operator">◆</a><a id="2631" class="Symbol">)</a>
      <a id="2639" href="Tactic.Derive.DecEq.html#2546" class="Function">genPf</a> <a id="2645" href="Tactic.Derive.DecEq.html#2645" class="Bound">k</a> <a id="2647" class="Symbol">(</a><a id="2648" href="Tactic.Derive.DecEq.html#2648" class="Bound">n</a> <a id="2650" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2652" href="Tactic.Derive.DecEq.html#2652" class="Bound">l</a><a id="2653" class="Symbol">)</a> <a id="2655" class="Symbol">=</a> <a id="2657" class="Keyword">quote</a> <a id="2663" href="Relation.Nullary.Decidable.Core.html#2609" class="Function Operator">_×-dec_</a> <a id="2671" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∙⟦</a> <a id="2674" href="Tactic.Derive.DecEq.html#2546" class="Function">genPf</a> <a id="2680" href="Tactic.Derive.DecEq.html#2645" class="Bound">k</a> <a id="2682" href="Tactic.Derive.DecEq.html#2652" class="Bound">l</a> <a id="2684" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∣</a> <a id="2686" href="Tactic.Derive.DecEq.html#2648" class="Bound">n</a> <a id="2688" class="Symbol">(</a><a id="2689" href="Reflection.Syntax.html#1433" class="InductiveConstructor">♯</a> <a id="2691" class="Symbol">(</a><a id="2692" href="Data.List.Base.html#5083" class="Function">length</a> <a id="2699" href="Tactic.Derive.DecEq.html#2652" class="Bound">l</a><a id="2700" class="Symbol">))</a> <a id="2703" class="Symbol">(</a><a id="2704" href="Reflection.Syntax.html#1433" class="InductiveConstructor">♯</a> <a id="2706" class="Symbol">(</a><a id="2707" href="Data.List.Base.html#5083" class="Function">length</a> <a id="2714" href="Tactic.Derive.DecEq.html#2652" class="Bound">l</a> <a id="2716" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="2718" href="Tactic.Derive.DecEq.html#2645" class="Bound">k</a><a id="2719" class="Symbol">))</a> <a id="2722" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">⟧</a>

      <a id="2731" class="Comment">-- c x1 .. xn ≡ c y1 .. yn ⇔ x1 ≡ y1 .. xn ≡ yn</a>
      <a id="2785" href="Tactic.Derive.DecEq.html#2785" class="Function">genEquiv</a> <a id="2794" class="Symbol">:</a> <a id="2796" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2798" class="Symbol">→</a> <a id="2800" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
      <a id="2811" href="Tactic.Derive.DecEq.html#2785" class="Function">genEquiv</a> <a id="2820" href="Tactic.Derive.DecEq.html#2820" class="Bound">n</a> <a id="2822" class="Symbol">=</a> <a id="2824" class="Keyword">quote</a> <a id="2830" href="Function.Bundles.html#13138" class="Function">mk⇔</a> <a id="2834" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∙⟦</a> <a id="2837" href="Reflection.Syntax.html#2552" class="InductiveConstructor Operator">`λ⟦</a> <a id="2841" href="Tactic.Derive.DecEq.html#2932" class="Function">reflPattern</a> <a id="2853" href="Tactic.Derive.DecEq.html#2820" class="Bound">n</a> <a id="2855" href="Reflection.Syntax.html#2552" class="InductiveConstructor Operator">⇒</a> <a id="2857" class="Keyword">quote</a> <a id="2863" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2868" href="Reflection.Syntax.html#3143" class="InductiveConstructor Operator">◆</a> <a id="2870" href="Reflection.Syntax.html#2552" class="InductiveConstructor Operator">⟧</a> <a id="2872" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">∣</a> <a id="2874" href="Reflection.Syntax.html#2552" class="InductiveConstructor Operator">`λ⟦</a> <a id="2878" class="Keyword">quote</a> <a id="2884" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="2889" href="Reflection.Syntax.html#3261" class="InductiveConstructor Operator">◇</a> <a id="2891" href="Reflection.Syntax.html#2552" class="InductiveConstructor Operator">⇒</a> <a id="2893" href="Tactic.Derive.DecEq.html#3088" class="Function">reflTerm</a> <a id="2902" href="Tactic.Derive.DecEq.html#2820" class="Bound">n</a> <a id="2904" href="Reflection.Syntax.html#2552" class="InductiveConstructor Operator">⟧</a> <a id="2906" href="Reflection.Syntax.html#2944" class="InductiveConstructor Operator">⟧</a>
        <a id="2916" class="Keyword">where</a>
          <a id="2932" href="Tactic.Derive.DecEq.html#2932" class="Function">reflPattern</a> <a id="2944" class="Symbol">:</a> <a id="2946" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="2948" class="Symbol">→</a> <a id="2950" href="Agda.Builtin.Reflection.html#5031" class="Datatype">Pattern</a>
          <a id="2968" href="Tactic.Derive.DecEq.html#2932" class="Function">reflPattern</a> <a id="2980" class="Number">0</a>       <a id="2988" class="Symbol">=</a> <a id="2990" class="Keyword">quote</a> <a id="2996" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="2999" href="Reflection.Syntax.html#3261" class="InductiveConstructor Operator">◇</a>
          <a id="3011" href="Tactic.Derive.DecEq.html#2932" class="Function">reflPattern</a> <a id="3023" class="Symbol">(</a><a id="3024" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3028" href="Tactic.Derive.DecEq.html#3028" class="Bound">n</a><a id="3029" class="Symbol">)</a> <a id="3031" class="Symbol">=</a> <a id="3033" class="Keyword">quote</a> <a id="3039" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="3043" href="Reflection.Syntax.html#3341" class="InductiveConstructor Operator">◇⟦</a> <a id="3046" href="Tactic.Derive.DecEq.html#2932" class="Function">reflPattern</a> <a id="3058" href="Tactic.Derive.DecEq.html#3028" class="Bound">n</a> <a id="3060" href="Reflection.Syntax.html#3341" class="InductiveConstructor Operator">∣</a> <a id="3062" class="Keyword">quote</a> <a id="3068" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3073" href="Reflection.Syntax.html#3261" class="InductiveConstructor Operator">◇</a> <a id="3075" href="Reflection.Syntax.html#3341" class="InductiveConstructor Operator">⟧</a>

          <a id="3088" href="Tactic.Derive.DecEq.html#3088" class="Function">reflTerm</a> <a id="3097" class="Symbol">:</a> <a id="3099" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="3101" class="Symbol">→</a> <a id="3103" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a>
          <a id="3118" href="Tactic.Derive.DecEq.html#3088" class="Function">reflTerm</a> <a id="3127" class="Number">0</a>       <a id="3135" class="Symbol">=</a> <a id="3137" class="Keyword">quote</a> <a id="3143" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="3146" href="Reflection.Syntax.html#3143" class="InductiveConstructor Operator">◆</a>
          <a id="3158" href="Tactic.Derive.DecEq.html#3088" class="Function">reflTerm</a> <a id="3167" class="Symbol">(</a><a id="3168" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3172" href="Tactic.Derive.DecEq.html#3172" class="Bound">n</a><a id="3173" class="Symbol">)</a> <a id="3175" class="Symbol">=</a> <a id="3177" class="Keyword">quote</a> <a id="3183" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="3187" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">◆⟦</a> <a id="3190" href="Tactic.Derive.DecEq.html#3088" class="Function">reflTerm</a> <a id="3199" href="Tactic.Derive.DecEq.html#3172" class="Bound">n</a> <a id="3201" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">∣</a> <a id="3203" class="Keyword">quote</a> <a id="3209" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="3214" href="Reflection.Syntax.html#3143" class="InductiveConstructor Operator">◆</a> <a id="3216" href="Reflection.Syntax.html#3207" class="InductiveConstructor Operator">⟧</a>

  <a id="3221" href="Tactic.Derive.DecEq.html#3221" class="Function">toMapDiag</a> <a id="3231" class="Symbol">:</a> <a id="3233" href="Tactic.ClauseBuilder.html#1277" class="Function">SinglePattern</a> <a id="3247" class="Symbol">→</a> <a id="3249" href="Tactic.ClauseBuilder.html#1277" class="Function">SinglePattern</a> <a id="3263" class="Symbol">→</a> <a id="3265" href="Data.List.NonEmpty.Base.html#1229" class="Record">NE.List⁺</a> <a id="3274" href="Tactic.ClauseBuilder.html#1277" class="Function">SinglePattern</a> <a id="3288" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3290" href="Reflection.TCI.html#616" class="Function">TC</a> <a id="3293" class="Symbol">(</a><a id="3294" href="Tactic.ClauseBuilder.html#5769" class="Datatype">ClauseExpr</a> <a id="3305" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3307" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3313" href="Agda.Builtin.Reflection.html#4993" class="Datatype">Term</a><a id="3317" class="Symbol">)</a>
  <a id="3321" href="Tactic.Derive.DecEq.html#3221" class="Function">toMapDiag</a> <a id="3331" href="Tactic.Derive.DecEq.html#3331" class="Bound">p</a><a id="3332" class="Symbol">@(_</a> <a id="3336" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3338" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3342" class="Symbol">_</a> <a id="3344" href="Tactic.Derive.DecEq.html#3344" class="Bound">p₁</a><a id="3346" class="Symbol">)</a> <a id="3348" href="Tactic.Derive.DecEq.html#3348" class="Bound">p&#39;</a><a id="3350" class="Symbol">@(_</a> <a id="3354" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3356" href="Agda.Builtin.Reflection.html#3732" class="InductiveConstructor">arg</a> <a id="3360" class="Symbol">_</a> <a id="3362" href="Tactic.Derive.DecEq.html#3362" class="Bound">p₂</a><a id="3364" class="Symbol">)</a> <a id="3366" class="Symbol">=</a>
    <a id="3372" class="Symbol">(</a><a id="3373" href="Tactic.Derive.DecEq.html#3331" class="Bound">p</a> <a id="3375" href="Data.List.NonEmpty.Base.html#1275" class="InductiveConstructor Operator">NE.∷</a> <a id="3380" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="3382" href="Tactic.Derive.DecEq.html#3348" class="Bound">p&#39;</a> <a id="3385" href="Data.List.Base.html#5244" class="Function Operator">]</a> <a id="3387" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3389" href="Tactic.ClauseBuilder.html#12864" class="Function">finishMatch</a> <a id="3401" class="Symbol">(</a><a id="3402" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="3405" href="Relation.Nullary.Decidable.Core.html#3623" class="Function Operator">⌊</a> <a id="3407" href="Tactic.Derive.DecEq.html#3344" class="Bound">p₁</a> <a id="3410" href="Reflection.AST.Term.html#5711" class="Function Operator">≟-Pattern</a> <a id="3420" href="Tactic.Derive.DecEq.html#3362" class="Bound">p₂</a> <a id="3423" href="Relation.Nullary.Decidable.Core.html#3623" class="Function Operator">⌋</a> <a id="3425" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="3430" href="Tactic.Derive.DecEq.html#2214" class="Function">mapDiag</a> <a id="3438" class="Symbol">(</a><a id="3439" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="3444" href="Tactic.Derive.DecEq.html#3331" class="Bound">p</a><a id="3445" class="Symbol">)</a> <a id="3447" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="3452" href="Tactic.Derive.DecEq.html#2214" class="Function">mapDiag</a> <a id="3460" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="3467" class="Symbol">))</a>

<a id="3471" class="Keyword">module</a> <a id="3478" href="Tactic.Derive.DecEq.html#3478" class="Module">_</a> <a id="3480" class="Symbol">⦃</a> <a id="3482" href="Tactic.Derive.DecEq.html#3482" class="Bound">_</a> <a id="3484" class="Symbol">:</a> <a id="3486" href="Class.MonadTC.html#618" class="Record">TCOptions</a> <a id="3496" class="Symbol">⦄</a> <a id="3498" class="Keyword">where</a>
  <a id="3506" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="3519" class="Symbol">:</a> <a id="3521" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="3526" class="Symbol">(</a><a id="3527" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a> <a id="3532" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3534" href="Agda.Builtin.Reflection.html#488" class="Postulate">Name</a><a id="3538" class="Symbol">)</a> <a id="3540" class="Symbol">→</a> <a id="3542" href="Reflection.Tactic.html#512" class="Function">UnquoteDecl</a>
  <a id="3556" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="3569" class="Symbol">=</a> <a id="3571" href="Tactic.Derive.html#4944" class="Function">derive-Class</a> <a id="3584" class="Number">0</a> <a id="3586" class="Symbol">(λ</a> <a id="3589" href="Tactic.Derive.DecEq.html#3589" class="Bound">transName</a> <a id="3599" href="Tactic.Derive.DecEq.html#3599" class="Bound">ps</a> <a id="3602" class="Symbol">→</a> <a id="3604" href="Data.List.Base.html#2352" class="Function">cartesianProductWith</a> <a id="3625" class="Symbol">(</a><a id="3626" href="Tactic.Derive.DecEq.html#3221" class="Function">toMapDiag</a> <a id="3636" href="Tactic.Derive.DecEq.html#3589" class="Bound">transName</a><a id="3645" class="Symbol">)</a> <a id="3647" href="Tactic.Derive.DecEq.html#3599" class="Bound">ps</a> <a id="3650" href="Tactic.Derive.DecEq.html#3599" class="Bound">ps</a><a id="3652" class="Symbol">)</a>

<a id="3655" class="Keyword">private</a>
  <a id="3665" class="Keyword">open</a> <a id="3670" class="Keyword">import</a> <a id="3677" href="Tactic.Derive.TestTypes.html" class="Module">Tactic.Derive.TestTypes</a>
  <a id="3703" class="Keyword">open</a> <a id="3708" class="Keyword">import</a> <a id="3715" href="Tactic.Defaults.html" class="Module">Tactic.Defaults</a>

  <a id="3734" class="Keyword">unquoteDecl</a> <a id="DecEq-These"></a><a id="3746" href="Tactic.Derive.DecEq.html#3746" class="Function">DecEq-These</a> <a id="3758" class="Symbol">=</a> <a id="3760" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="3773" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="3775" class="Symbol">(</a><a id="3776" class="Keyword">quote</a> <a id="3782" href="Data.These.Base.html#537" class="Datatype">These</a> <a id="3788" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3790" href="Tactic.Derive.DecEq.html#3746" class="Function">DecEq-These</a><a id="3801" class="Symbol">)</a> <a id="3803" href="Data.List.Base.html#5244" class="Function Operator">]</a>

  <a id="3808" class="Keyword">unquoteDecl</a> <a id="DecEq-⊎"></a><a id="3820" href="Tactic.Derive.DecEq.html#3820" class="Function">DecEq-⊎</a> <a id="3828" class="Symbol">=</a> <a id="3830" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="3843" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="3845" class="Symbol">(</a><a id="3846" class="Keyword">quote</a> <a id="3852" href="Data.Sum.Base.html#625" class="Datatype Operator">_⊎_</a> <a id="3856" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3858" href="Tactic.Derive.DecEq.html#3820" class="Function">DecEq-⊎</a><a id="3865" class="Symbol">)</a> <a id="3867" href="Data.List.Base.html#5244" class="Function Operator">]</a>

  <a id="3872" class="Keyword">unquoteDecl</a> <a id="DecEq-Bool"></a><a id="3884" href="Tactic.Derive.DecEq.html#3884" class="Function">DecEq-Bool</a> <a id="DecEq-ℤ"></a><a id="3895" href="Tactic.Derive.DecEq.html#3895" class="Function">DecEq-ℤ</a> <a id="DecEq-List"></a><a id="3903" href="Tactic.Derive.DecEq.html#3903" class="Function">DecEq-List</a> <a id="DecEq-Maybe"></a><a id="3914" href="Tactic.Derive.DecEq.html#3914" class="Function">DecEq-Maybe</a> <a id="DecEq-ℕ"></a><a id="3926" href="Tactic.Derive.DecEq.html#3926" class="Function">DecEq-ℕ</a> <a id="DecEq-Sign"></a><a id="3934" href="Tactic.Derive.DecEq.html#3934" class="Function">DecEq-Sign</a> <a id="DecEq-⊤"></a><a id="3945" href="Tactic.Derive.DecEq.html#3945" class="Function">DecEq-⊤</a> <a id="3953" class="Symbol">=</a> <a id="3955" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="3968" class="Symbol">((</a><a id="3970" class="Keyword">quote</a> <a id="3976" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a> <a id="3981" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3983" href="Tactic.Derive.DecEq.html#3884" class="Function">DecEq-Bool</a><a id="3993" class="Symbol">)</a> <a id="3995" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3997" class="Symbol">(</a><a id="3998" class="Keyword">quote</a> <a id="4004" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a> <a id="4006" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4008" href="Tactic.Derive.DecEq.html#3895" class="Function">DecEq-ℤ</a><a id="4015" class="Symbol">)</a> <a id="4017" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4019" class="Symbol">(</a><a id="4020" class="Keyword">quote</a> <a id="4026" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4031" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4033" href="Tactic.Derive.DecEq.html#3903" class="Function">DecEq-List</a><a id="4043" class="Symbol">)</a> <a id="4045" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4047" class="Symbol">(</a><a id="4048" class="Keyword">quote</a> <a id="4054" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4060" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4062" href="Tactic.Derive.DecEq.html#3914" class="Function">DecEq-Maybe</a><a id="4073" class="Symbol">)</a> <a id="4075" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4077" class="Symbol">(</a><a id="4078" class="Keyword">quote</a> <a id="4084" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="4086" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4088" href="Tactic.Derive.DecEq.html#3926" class="Function">DecEq-ℕ</a><a id="4095" class="Symbol">)</a> <a id="4097" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4099" class="Symbol">(</a><a id="4100" class="Keyword">quote</a> <a id="4106" href="Data.Sign.Base.html#523" class="Datatype">Sign</a> <a id="4111" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4113" href="Tactic.Derive.DecEq.html#3934" class="Function">DecEq-Sign</a><a id="4123" class="Symbol">)</a> <a id="4125" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4127" class="Symbol">(</a><a id="4128" class="Keyword">quote</a> <a id="4134" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="4136" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4138" href="Tactic.Derive.DecEq.html#3945" class="Function">DecEq-⊤</a><a id="4145" class="Symbol">)</a> <a id="4147" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4149" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4151" class="Symbol">)</a>

  <a id="4156" class="Keyword">unquoteDecl</a> <a id="DecEq-Fin"></a><a id="4168" href="Tactic.Derive.DecEq.html#4168" class="Function">DecEq-Fin</a> <a id="4178" class="Symbol">=</a> <a id="4180" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="4193" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="4195" class="Symbol">(</a><a id="4196" class="Keyword">quote</a> <a id="4202" href="Data.Fin.Base.html#1154" class="Datatype">Fin</a> <a id="4206" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4208" href="Tactic.Derive.DecEq.html#4168" class="Function">DecEq-Fin</a><a id="4217" class="Symbol">)</a> <a id="4219" href="Data.List.Base.html#5244" class="Function Operator">]</a>

  <a id="4224" class="Comment">-- this doesn&#39;t work since the clause builder machinery doesn&#39;t deal</a>
  <a id="4295" class="Comment">-- with absurd patterns yet</a>

  <a id="4326" class="Comment">--unquoteDecl DecEq-Vec = derive-DecEq [ (quote Vec , DecEq-Vec) ]</a>

  <a id="4396" class="Keyword">unquoteDecl</a> <a id="DecEq-E1"></a><a id="4408" href="Tactic.Derive.DecEq.html#4408" class="Function">DecEq-E1</a> <a id="4417" class="Symbol">=</a> <a id="4419" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="4432" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="4434" class="Symbol">(</a><a id="4435" class="Keyword">quote</a> <a id="4441" href="Tactic.Derive.TestTypes.html#197" class="Datatype">E1</a> <a id="4444" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4446" href="Tactic.Derive.DecEq.html#4408" class="Function">DecEq-E1</a><a id="4454" class="Symbol">)</a> <a id="4456" href="Data.List.Base.html#5244" class="Function Operator">]</a>
  <a id="4460" class="Keyword">unquoteDecl</a> <a id="DecEq-E2"></a><a id="4472" href="Tactic.Derive.DecEq.html#4472" class="Function">DecEq-E2</a> <a id="4481" class="Symbol">=</a> <a id="4483" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="4496" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="4498" class="Symbol">(</a><a id="4499" class="Keyword">quote</a> <a id="4505" href="Tactic.Derive.TestTypes.html#302" class="Datatype">E2</a> <a id="4508" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4510" href="Tactic.Derive.DecEq.html#4472" class="Function">DecEq-E2</a><a id="4518" class="Symbol">)</a> <a id="4520" href="Data.List.Base.html#5244" class="Function Operator">]</a>

  <a id="4525" class="Comment">-- this uses mutual recursion with List E3</a>
  <a id="4570" class="Keyword">unquoteDecl</a> <a id="DecEq-E3"></a><a id="4582" href="Tactic.Derive.DecEq.html#4582" class="Function">DecEq-E3</a> <a id="4591" class="Symbol">=</a> <a id="4593" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="4606" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="4608" class="Symbol">(</a><a id="4609" class="Keyword">quote</a> <a id="4615" href="Tactic.Derive.TestTypes.html#380" class="Datatype">E3</a> <a id="4618" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4620" href="Tactic.Derive.DecEq.html#4582" class="Function">DecEq-E3</a><a id="4628" class="Symbol">)</a> <a id="4630" href="Data.List.Base.html#5244" class="Function Operator">]</a>
  <a id="4634" class="Comment">-- unquoteDecl DecEq-E4 = derive-DecEq [ (quote E4 , DecEq-E4) ]</a>

  <a id="4702" class="Keyword">unquoteDecl</a> <a id="DecEq-R1"></a><a id="4714" href="Tactic.Derive.DecEq.html#4714" class="Function">DecEq-R1</a> <a id="4723" class="Symbol">=</a> <a id="4725" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="4738" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="4740" class="Symbol">(</a><a id="4741" class="Keyword">quote</a> <a id="4747" href="Tactic.Derive.TestTypes.html#590" class="Record">R1</a> <a id="4750" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4752" href="Tactic.Derive.DecEq.html#4714" class="Function">DecEq-R1</a><a id="4760" class="Symbol">)</a> <a id="4762" href="Data.List.Base.html#5244" class="Function Operator">]</a>
  <a id="4766" class="Keyword">unquoteDecl</a> <a id="DecEq-R2"></a><a id="4778" href="Tactic.Derive.DecEq.html#4778" class="Function">DecEq-R2</a> <a id="4787" class="Symbol">=</a> <a id="4789" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="4802" href="Data.List.Base.html#5244" class="Function Operator">[</a> <a id="4804" class="Symbol">(</a><a id="4805" class="Keyword">quote</a> <a id="4811" href="Tactic.Derive.TestTypes.html#651" class="Record">R2</a> <a id="4814" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4816" href="Tactic.Derive.DecEq.html#4778" class="Function">DecEq-R2</a><a id="4824" class="Symbol">)</a> <a id="4826" href="Data.List.Base.html#5244" class="Function Operator">]</a>

  <a id="4831" class="Keyword">unquoteDecl</a> <a id="DecEq-M₁"></a><a id="4843" href="Tactic.Derive.DecEq.html#4843" class="Function">DecEq-M₁</a> <a id="DecEq-M₂"></a><a id="4852" href="Tactic.Derive.DecEq.html#4852" class="Function">DecEq-M₂</a> <a id="4861" class="Symbol">=</a> <a id="4863" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="4876" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="4878" class="Symbol">(</a><a id="4879" class="Keyword">quote</a> <a id="4885" href="Tactic.Derive.TestTypes.html#798" class="Datatype">M₁</a> <a id="4888" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4890" href="Tactic.Derive.DecEq.html#4843" class="Function">DecEq-M₁</a><a id="4898" class="Symbol">)</a> <a id="4900" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4902" class="Symbol">(</a><a id="4903" class="Keyword">quote</a> <a id="4909" href="Tactic.Derive.TestTypes.html#812" class="Datatype">M₂</a> <a id="4912" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4914" href="Tactic.Derive.DecEq.html#4852" class="Function">DecEq-M₂</a><a id="4922" class="Symbol">)</a> <a id="4924" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4926" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>

  <a id="4932" class="Comment">-- Expected: DecEq-Term DecEq-Product</a>
</pre></body></html>