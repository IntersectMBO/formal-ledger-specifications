<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Conway.Conformance.Epoch</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda">
<a id="2" class="Symbol">{-#</a> <a id="6" class="Keyword">OPTIONS</a> <a id="14" class="Pragma">--safe</a> <a id="21" class="Symbol">#-}</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="58" class="Keyword">using</a> <a id="64" class="Symbol">(</a><a id="65" href="Data.Nat.Properties.html#17056" class="Function">+-0-monoid</a><a id="75" class="Symbol">;</a> <a id="77" href="Data.Nat.Properties.html#17135" class="Function">+-0-commutativeMonoid</a><a id="98" class="Symbol">)</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Data.List.html" class="Module">Data.List</a> <a id="122" class="Keyword">using</a> <a id="128" class="Symbol">(</a><a id="129" href="Data.List.Base.html#10687" class="Function">filter</a><a id="135" class="Symbol">)</a>
<a id="137" class="Keyword">import</a> <a id="144" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="157" class="Symbol">as</a> <a id="160" class="Module">ℤ</a>
<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="Data.Integer.Ext.html" class="Module">Data.Integer.Ext</a>

<a id="192" class="Keyword">open</a> <a id="197" class="Keyword">import</a> <a id="204" href="Agda.Builtin.FromNat.html" class="Module">Agda.Builtin.FromNat</a>

<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a>
<a id="253" class="Keyword">open</a> <a id="258" class="Keyword">import</a> <a id="265" href="Ledger.Abstract.html" class="Module">Ledger.Abstract</a>
<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a>

<a id="313" class="Keyword">module</a> <a id="320" href="Ledger.Conway.Conformance.Epoch.html" class="Module">Ledger.Conway.Conformance.Epoch</a>
  <a id="354" class="Symbol">(</a><a id="355" href="Ledger.Conway.Conformance.Epoch.html#355" class="Bound">txs</a> <a id="359" class="Symbol">:</a> <a id="361" class="Symbol">_)</a> <a id="364" class="Symbol">(</a><a id="365" class="Keyword">open</a> <a id="370" href="Ledger.Transaction.html#867" class="Module">TransactionStructure</a> <a id="391" href="Ledger.Conway.Conformance.Epoch.html#355" class="Bound">txs</a><a id="394" class="Symbol">)</a>
  <a id="398" class="Symbol">(</a><a id="399" href="Ledger.Conway.Conformance.Epoch.html#399" class="Bound">abs</a> <a id="403" class="Symbol">:</a> <a id="405" href="Ledger.Abstract.html#578" class="Record">AbstractFunctions</a> <a id="423" href="Ledger.Conway.Conformance.Epoch.html#355" class="Bound">txs</a><a id="426" class="Symbol">)</a> <a id="428" class="Symbol">(</a><a id="429" class="Keyword">open</a> <a id="434" href="Ledger.Abstract.html#578" class="Module">AbstractFunctions</a> <a id="452" href="Ledger.Conway.Conformance.Epoch.html#399" class="Bound">abs</a><a id="455" class="Symbol">)</a>
  <a id="459" class="Keyword">where</a>

<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Ledger.Gov.html" class="Module">Ledger.Gov</a> <a id="489" href="Ledger.Conway.Conformance.Epoch.html#355" class="Bound">txs</a>
<a id="493" class="Keyword">open</a> <a id="498" class="Keyword">import</a> <a id="505" href="Ledger.Enact.html" class="Module">Ledger.Enact</a> <a id="518" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>
<a id="531" class="Keyword">open</a> <a id="536" class="Keyword">import</a> <a id="543" href="Ledger.Conway.Conformance.Ledger.html" class="Module">Ledger.Conway.Conformance.Ledger</a> <a id="576" href="Ledger.Conway.Conformance.Epoch.html#355" class="Bound">txs</a> <a id="580" href="Ledger.Conway.Conformance.Epoch.html#399" class="Bound">abs</a>
<a id="584" class="Keyword">open</a> <a id="589" class="Keyword">import</a> <a id="596" href="Ledger.Ratify.html" class="Module">Ledger.Ratify</a> <a id="610" href="Ledger.Conway.Conformance.Epoch.html#355" class="Bound">txs</a>
<a id="614" class="Keyword">open</a> <a id="619" class="Keyword">import</a> <a id="626" href="Ledger.Conway.Conformance.Utxo.html" class="Module">Ledger.Conway.Conformance.Utxo</a> <a id="657" href="Ledger.Conway.Conformance.Epoch.html#355" class="Bound">txs</a> <a id="661" href="Ledger.Conway.Conformance.Epoch.html#399" class="Bound">abs</a>
<a id="665" class="Keyword">open</a> <a id="670" class="Keyword">import</a> <a id="677" href="Ledger.Conway.Conformance.Certs.html" class="Module">Ledger.Conway.Conformance.Certs</a> <a id="709" href="Ledger.Transaction.html#1809" class="Function">govStructure</a>

<a id="723" class="Keyword">record</a> <a id="RewardUpdate"></a><a id="730" href="Ledger.Conway.Conformance.Epoch.html#730" class="Record">RewardUpdate</a> <a id="743" class="Symbol">:</a> <a id="745" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="749" class="Keyword">where</a>
  <a id="757" class="Keyword">constructor</a> <a id="⟦_,_,_,_⟧ʳᵘ"></a><a id="769" href="Ledger.Conway.Conformance.Epoch.html#769" class="InductiveConstructor Operator">⟦_,_,_,_⟧ʳᵘ</a>
  <a id="783" class="Keyword">field</a>
    <a id="RewardUpdate.Δt"></a><a id="793" href="Ledger.Conway.Conformance.Epoch.html#793" class="Field">Δt</a> <a id="RewardUpdate.Δr"></a><a id="796" href="Ledger.Conway.Conformance.Epoch.html#796" class="Field">Δr</a> <a id="RewardUpdate.Δf"></a><a id="799" href="Ledger.Conway.Conformance.Epoch.html#799" class="Field">Δf</a> <a id="802" class="Symbol">:</a> <a id="804" href="Agda.Builtin.Int.html#245" class="Datatype">ℤ</a>
    <a id="RewardUpdate.rs"></a><a id="810" href="Ledger.Conway.Conformance.Epoch.html#810" class="Field">rs</a> <a id="813" class="Symbol">:</a> <a id="815" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="826" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="828" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

<a id="834" class="Keyword">record</a> <a id="Snapshot"></a><a id="841" href="Ledger.Conway.Conformance.Epoch.html#841" class="Record">Snapshot</a> <a id="850" class="Symbol">:</a> <a id="852" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="856" class="Keyword">where</a>
  <a id="864" class="Keyword">field</a>
    <a id="Snapshot.stake"></a><a id="874" href="Ledger.Conway.Conformance.Epoch.html#874" class="Field">stake</a>        <a id="887" class="Symbol">:</a> <a id="889" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="900" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="902" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
    <a id="Snapshot.delegations"></a><a id="911" href="Ledger.Conway.Conformance.Epoch.html#911" class="Field">delegations</a>  <a id="924" class="Symbol">:</a> <a id="926" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="937" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="939" href="Ledger.Crypto.html#1310" class="Function">KeyHash</a>
    <a id="951" class="Comment">-- poolParameters : KeyHash ⇀ PoolParam</a>

<a id="992" class="Keyword">record</a> <a id="Snapshots"></a><a id="999" href="Ledger.Conway.Conformance.Epoch.html#999" class="Record">Snapshots</a> <a id="1009" class="Symbol">:</a> <a id="1011" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1015" class="Keyword">where</a>
  <a id="1023" class="Keyword">field</a>
    <a id="Snapshots.mark"></a><a id="1033" href="Ledger.Conway.Conformance.Epoch.html#1033" class="Field">mark</a> <a id="Snapshots.set"></a><a id="1038" href="Ledger.Conway.Conformance.Epoch.html#1038" class="Field">set</a> <a id="Snapshots.go"></a><a id="1042" href="Ledger.Conway.Conformance.Epoch.html#1042" class="Field">go</a>  <a id="1046" class="Symbol">:</a> <a id="1048" href="Ledger.Conway.Conformance.Epoch.html#841" class="Record">Snapshot</a>
    <a id="Snapshots.feeSS"></a><a id="1061" href="Ledger.Conway.Conformance.Epoch.html#1061" class="Field">feeSS</a>        <a id="1074" class="Symbol">:</a> <a id="1076" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>

<a id="1082" class="Keyword">record</a> <a id="EpochState"></a><a id="1089" href="Ledger.Conway.Conformance.Epoch.html#1089" class="Record">EpochState</a> <a id="1100" class="Symbol">:</a> <a id="1102" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1107" class="Keyword">where</a>
  <a id="1115" class="Keyword">constructor</a> <a id="⟦_,_,_,_,_⟧ᵉ&#39;"></a><a id="1127" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">⟦_,_,_,_,_⟧ᵉ&#39;</a>
  <a id="1143" class="Keyword">field</a>
    <a id="EpochState.acnt"></a><a id="1153" href="Ledger.Conway.Conformance.Epoch.html#1153" class="Field">acnt</a>       <a id="1164" class="Symbol">:</a> <a id="1166" href="Ledger.PParams.html#620" class="Record">Acnt</a>
    <a id="EpochState.ss"></a><a id="1175" href="Ledger.Conway.Conformance.Epoch.html#1175" class="Field">ss</a>         <a id="1186" class="Symbol">:</a> <a id="1188" href="Ledger.Conway.Conformance.Epoch.html#999" class="Record">Snapshots</a>
    <a id="EpochState.ls"></a><a id="1202" href="Ledger.Conway.Conformance.Epoch.html#1202" class="Field">ls</a>         <a id="1213" class="Symbol">:</a> <a id="1215" href="Ledger.Conway.Conformance.Ledger.html#690" class="Record">LState</a>
    <a id="EpochState.es"></a><a id="1226" href="Ledger.Conway.Conformance.Epoch.html#1226" class="Field">es</a>         <a id="1237" class="Symbol">:</a> <a id="1239" href="Ledger.Enact.html#397" class="Record">EnactState</a>
    <a id="EpochState.fut"></a><a id="1254" href="Ledger.Conway.Conformance.Epoch.html#1254" class="Field">fut</a>        <a id="1265" class="Symbol">:</a> <a id="1267" href="Ledger.Ratify.html#3241" class="Record">RatifyState</a>

<a id="1280" class="Keyword">record</a> <a id="NewEpochState"></a><a id="1287" href="Ledger.Conway.Conformance.Epoch.html#1287" class="Record">NewEpochState</a> <a id="1301" class="Symbol">:</a> <a id="1303" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1308" class="Keyword">where</a>
  <a id="1316" class="Keyword">field</a>
    <a id="NewEpochState.lastEpoch"></a><a id="1326" href="Ledger.Conway.Conformance.Epoch.html#1326" class="Field">lastEpoch</a>   <a id="1338" class="Symbol">:</a> <a id="1340" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a>
    <a id="NewEpochState.epochState"></a><a id="1350" href="Ledger.Conway.Conformance.Epoch.html#1350" class="Field">epochState</a>  <a id="1362" class="Symbol">:</a> <a id="1364" href="Ledger.Conway.Conformance.Epoch.html#1089" class="Record">EpochState</a>
    <a id="NewEpochState.ru"></a><a id="1379" href="Ledger.Conway.Conformance.Epoch.html#1379" class="Field">ru</a>          <a id="1391" class="Symbol">:</a> <a id="1393" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1399" href="Ledger.Conway.Conformance.Epoch.html#730" class="Record">RewardUpdate</a>

<a id="1413" class="Keyword">instance</a>
  <a id="1424" class="Keyword">unquoteDecl</a> <a id="To-RewardUpdate"></a><a id="1436" href="Ledger.Conway.Conformance.Epoch.html#1436" class="Function">To-RewardUpdate</a> <a id="To-Snapshot"></a><a id="1452" href="Ledger.Conway.Conformance.Epoch.html#1452" class="Function">To-Snapshot</a> <a id="To-Snapshots"></a><a id="1464" href="Ledger.Conway.Conformance.Epoch.html#1464" class="Function">To-Snapshots</a> <a id="To-EpochState"></a><a id="1477" href="Ledger.Conway.Conformance.Epoch.html#1477" class="Function">To-EpochState</a> <a id="To-NewEpochState"></a><a id="1491" href="Ledger.Conway.Conformance.Epoch.html#1491" class="Function">To-NewEpochState</a> <a id="1508" class="Symbol">=</a> <a id="1510" href="Class.To.html#2693" class="Function">derive-To</a>
    <a id="1524" class="Symbol">(</a>   <a id="1528" class="Symbol">(</a><a id="1529" class="Keyword">quote</a> <a id="1535" href="Ledger.Conway.Conformance.Epoch.html#730" class="Record">RewardUpdate</a>   <a id="1550" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1552" href="Ledger.Conway.Conformance.Epoch.html#1436" class="Function">To-RewardUpdate</a><a id="1567" class="Symbol">)</a>
    <a id="1573" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1577" class="Symbol">(</a><a id="1578" class="Keyword">quote</a> <a id="1584" href="Ledger.Conway.Conformance.Epoch.html#841" class="Record">Snapshot</a>       <a id="1599" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1601" href="Ledger.Conway.Conformance.Epoch.html#1452" class="Function">To-Snapshot</a><a id="1612" class="Symbol">)</a>
    <a id="1618" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1622" class="Symbol">(</a><a id="1623" class="Keyword">quote</a> <a id="1629" href="Ledger.Conway.Conformance.Epoch.html#999" class="Record">Snapshots</a>      <a id="1644" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1646" href="Ledger.Conway.Conformance.Epoch.html#1464" class="Function">To-Snapshots</a><a id="1658" class="Symbol">)</a>
    <a id="1664" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>   <a id="1668" class="Symbol">(</a><a id="1669" class="Keyword">quote</a> <a id="1675" href="Ledger.Conway.Conformance.Epoch.html#1089" class="Record">EpochState</a>     <a id="1690" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1692" href="Ledger.Conway.Conformance.Epoch.html#1477" class="Function">To-EpochState</a><a id="1705" class="Symbol">)</a>
    <a id="1711" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1713" href="Data.List.Base.html#5205" class="Function Operator">[</a> <a id="1715" class="Symbol">(</a><a id="1716" class="Keyword">quote</a> <a id="1722" href="Ledger.Conway.Conformance.Epoch.html#1287" class="Record">NewEpochState</a>  <a id="1737" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1739" href="Ledger.Conway.Conformance.Epoch.html#1491" class="Function">To-NewEpochState</a><a id="1755" class="Symbol">)</a><a id="1756" href="Data.List.Base.html#5205" class="Function Operator">]</a><a id="1757" class="Symbol">)</a>

<a id="1760" class="Keyword">instance</a> <a id="1769" href="Ledger.Conway.Conformance.Epoch.html#1769" class="Function">_</a> <a id="1771" class="Symbol">=</a> <a id="1773" href="Data.Nat.Properties.html#17056" class="Function">+-0-monoid</a><a id="1783" class="Symbol">;</a> <a id="1785" href="Ledger.Conway.Conformance.Epoch.html#1785" class="Function">_</a> <a id="1787" class="Symbol">=</a> <a id="1789" href="Data.Nat.Properties.html#17135" class="Function">+-0-commutativeMonoid</a>

<a id="toRwdAddr"></a><a id="1812" href="Ledger.Conway.Conformance.Epoch.html#1812" class="Function">toRwdAddr</a> <a id="1822" class="Symbol">:</a> <a id="1824" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="1835" class="Symbol">→</a> <a id="1837" href="Ledger.Address.html#1211" class="Record">RwdAddr</a>
<a id="1845" href="Ledger.Conway.Conformance.Epoch.html#1812" class="Function">toRwdAddr</a> <a id="1855" href="Ledger.Conway.Conformance.Epoch.html#1855" class="Bound">x</a> <a id="1857" class="Symbol">=</a> <a id="1859" class="Keyword">record</a> <a id="1866" class="Symbol">{</a> <a id="1868" href="Ledger.Address.html#1240" class="Field">net</a> <a id="1872" class="Symbol">=</a> <a id="1874" href="Ledger.Types.Epoch.html#2154" class="Function">NetworkId</a> <a id="1884" class="Symbol">;</a> <a id="1886" href="Ledger.Address.html#1265" class="Field">stake</a> <a id="1892" class="Symbol">=</a> <a id="1894" href="Ledger.Conway.Conformance.Epoch.html#1855" class="Bound">x</a> <a id="1896" class="Symbol">}</a>

<a id="getStakeCred"></a><a id="1899" href="Ledger.Conway.Conformance.Epoch.html#1899" class="Function">getStakeCred</a> <a id="1912" class="Symbol">:</a> <a id="1914" href="Ledger.Transaction.html#2334" class="Function">TxOut</a> <a id="1920" class="Symbol">→</a> <a id="1922" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="1928" href="Ledger.Address.html#273" class="Datatype">Credential</a>
<a id="1939" href="Ledger.Conway.Conformance.Epoch.html#1899" class="Function">getStakeCred</a> <a id="1952" class="Symbol">(</a><a id="1953" href="Ledger.Conway.Conformance.Epoch.html#1953" class="Bound">a</a> <a id="1955" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1957" class="Symbol">_</a> <a id="1959" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1961" class="Symbol">_</a> <a id="1963" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1965" class="Symbol">_)</a> <a id="1968" class="Symbol">=</a> <a id="1970" href="Ledger.Address.html#1832" class="Function">stakeCred</a> <a id="1980" href="Ledger.Conway.Conformance.Epoch.html#1953" class="Bound">a</a>

<a id="1983" class="Keyword">open</a> <a id="1988" href="Ledger.Address.html#1211" class="Module">RwdAddr</a> <a id="1996" class="Keyword">using</a> <a id="2002" class="Symbol">(</a><a id="2003" href="Ledger.Address.html#1265" class="Field">stake</a><a id="2008" class="Symbol">)</a>
<a id="2010" class="Keyword">open</a> <a id="2015" href="Ledger.GovernanceActions.html#2096" class="Module">GovActionState</a> <a id="2030" class="Keyword">using</a> <a id="2036" class="Symbol">(</a><a id="2037" href="Ledger.GovernanceActions.html#2167" class="Field">returnAddr</a><a id="2047" class="Symbol">)</a>

<a id="applyRUpd"></a><a id="2050" href="Ledger.Conway.Conformance.Epoch.html#2050" class="Function">applyRUpd</a> <a id="2060" class="Symbol">:</a> <a id="2062" href="Ledger.Conway.Conformance.Epoch.html#730" class="Record">RewardUpdate</a> <a id="2075" class="Symbol">→</a> <a id="2077" href="Ledger.Conway.Conformance.Epoch.html#1089" class="Record">EpochState</a> <a id="2088" class="Symbol">→</a> <a id="2090" href="Ledger.Conway.Conformance.Epoch.html#1089" class="Record">EpochState</a>
<a id="2101" href="Ledger.Conway.Conformance.Epoch.html#2050" class="Function">applyRUpd</a> <a id="2111" href="Ledger.Conway.Conformance.Epoch.html#769" class="InductiveConstructor Operator">⟦</a> <a id="2113" href="Ledger.Conway.Conformance.Epoch.html#2113" class="Bound">Δt</a> <a id="2116" href="Ledger.Conway.Conformance.Epoch.html#769" class="InductiveConstructor Operator">,</a> <a id="2118" href="Ledger.Conway.Conformance.Epoch.html#2118" class="Bound">Δr</a> <a id="2121" href="Ledger.Conway.Conformance.Epoch.html#769" class="InductiveConstructor Operator">,</a> <a id="2123" href="Ledger.Conway.Conformance.Epoch.html#2123" class="Bound">Δf</a> <a id="2126" href="Ledger.Conway.Conformance.Epoch.html#769" class="InductiveConstructor Operator">,</a> <a id="2128" href="Ledger.Conway.Conformance.Epoch.html#2128" class="Bound">rs</a> <a id="2131" href="Ledger.Conway.Conformance.Epoch.html#769" class="InductiveConstructor Operator">⟧ʳᵘ</a>
  <a id="2137" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">⟦</a> <a id="2139" href="Ledger.PParams.html#654" class="InductiveConstructor Operator">⟦</a> <a id="2141" href="Ledger.Conway.Conformance.Epoch.html#2141" class="Bound">treasury</a> <a id="2150" href="Ledger.PParams.html#654" class="InductiveConstructor Operator">,</a> <a id="2152" href="Ledger.Conway.Conformance.Epoch.html#2152" class="Bound">reserves</a> <a id="2161" href="Ledger.PParams.html#654" class="InductiveConstructor Operator">⟧ᵃ</a>
  <a id="2166" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">,</a> <a id="2168" href="Ledger.Conway.Conformance.Epoch.html#2168" class="Bound">ss</a>
  <a id="2173" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">,</a> <a id="2175" href="Ledger.Conway.Conformance.Ledger.html#724" class="InductiveConstructor Operator">⟦</a> <a id="2177" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">⟦</a> <a id="2179" href="Ledger.Conway.Conformance.Epoch.html#2179" class="Bound">utxo</a> <a id="2184" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">,</a> <a id="2186" href="Ledger.Conway.Conformance.Epoch.html#2186" class="Bound">fees</a> <a id="2191" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">,</a> <a id="2193" href="Ledger.Conway.Conformance.Epoch.html#2193" class="Bound">deposits</a> <a id="2202" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">,</a> <a id="2204" href="Ledger.Conway.Conformance.Epoch.html#2204" class="Bound">donations</a> <a id="2214" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">⟧ᵘ</a>
    <a id="2221" href="Ledger.Conway.Conformance.Ledger.html#724" class="InductiveConstructor Operator">,</a> <a id="2223" href="Ledger.Conway.Conformance.Epoch.html#2223" class="Bound">govSt</a>
    <a id="2233" href="Ledger.Conway.Conformance.Ledger.html#724" class="InductiveConstructor Operator">,</a> <a id="2235" href="Ledger.Conway.Conformance.Certs.html#956" class="InductiveConstructor Operator">⟦</a> <a id="2237" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">⟦</a> <a id="2239" href="Ledger.Conway.Conformance.Epoch.html#2239" class="Bound">voteDelegs</a> <a id="2250" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2252" href="Ledger.Conway.Conformance.Epoch.html#2252" class="Bound">stakeDelegs</a> <a id="2264" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2266" href="Ledger.Conway.Conformance.Epoch.html#2266" class="Bound">rewards</a> <a id="2274" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2276" href="Ledger.Conway.Conformance.Epoch.html#2276" class="Bound">dDeposits</a> <a id="2286" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">⟧ᵈ</a> <a id="2289" href="Ledger.Conway.Conformance.Certs.html#956" class="InductiveConstructor Operator">,</a> <a id="2291" href="Ledger.Conway.Conformance.Epoch.html#2291" class="Bound">pState</a> <a id="2298" href="Ledger.Conway.Conformance.Certs.html#956" class="InductiveConstructor Operator">,</a> <a id="2300" href="Ledger.Conway.Conformance.Epoch.html#2300" class="Bound">gState</a> <a id="2307" href="Ledger.Conway.Conformance.Certs.html#956" class="InductiveConstructor Operator">⟧ᶜˢ</a> <a id="2311" href="Ledger.Conway.Conformance.Ledger.html#724" class="InductiveConstructor Operator">⟧ˡ</a>
  <a id="2316" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">,</a> <a id="2318" href="Ledger.Conway.Conformance.Epoch.html#2318" class="Bound">es</a>
  <a id="2323" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">,</a> <a id="2325" href="Ledger.Conway.Conformance.Epoch.html#2325" class="Bound">fut</a>
  <a id="2331" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">⟧ᵉ&#39;</a> <a id="2335" class="Symbol">=</a>
  <a id="2339" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">⟦</a> <a id="2341" href="Ledger.PParams.html#654" class="InductiveConstructor Operator">⟦</a> <a id="2343" href="Data.Integer.Ext.html#349" class="Function">posPart</a> <a id="2351" class="Symbol">(</a><a id="2352" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">ℤ.+</a> <a id="2356" href="Ledger.Conway.Conformance.Epoch.html#2141" class="Bound">treasury</a> <a id="2365" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="2369" href="Ledger.Conway.Conformance.Epoch.html#2113" class="Bound">Δt</a> <a id="2372" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="2376" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">ℤ.+</a> <a id="2380" href="Ledger.Conway.Conformance.Epoch.html#2708" class="Function">unregRU&#39;</a><a id="2388" class="Symbol">)</a>
    <a id="2394" href="Ledger.PParams.html#654" class="InductiveConstructor Operator">,</a> <a id="2396" href="Data.Integer.Ext.html#349" class="Function">posPart</a> <a id="2404" class="Symbol">(</a><a id="2405" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">ℤ.+</a> <a id="2409" href="Ledger.Conway.Conformance.Epoch.html#2152" class="Bound">reserves</a> <a id="2418" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="2422" href="Ledger.Conway.Conformance.Epoch.html#2118" class="Bound">Δr</a><a id="2424" class="Symbol">)</a> <a id="2426" href="Ledger.PParams.html#654" class="InductiveConstructor Operator">⟧ᵃ</a>
  <a id="2431" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">,</a> <a id="2433" href="Ledger.Conway.Conformance.Epoch.html#2168" class="Bound">ss</a>
  <a id="2438" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">,</a> <a id="2440" href="Ledger.Conway.Conformance.Ledger.html#724" class="InductiveConstructor Operator">⟦</a> <a id="2442" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">⟦</a> <a id="2444" href="Ledger.Conway.Conformance.Epoch.html#2179" class="Bound">utxo</a> <a id="2449" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">,</a> <a id="2451" href="Data.Integer.Ext.html#349" class="Function">posPart</a> <a id="2459" class="Symbol">(</a><a id="2460" href="Agda.Builtin.Int.html#263" class="InductiveConstructor Operator">ℤ.+</a> <a id="2464" href="Ledger.Conway.Conformance.Epoch.html#2186" class="Bound">fees</a> <a id="2469" href="Data.Integer.Base.html#5064" class="Function Operator">ℤ.+</a> <a id="2473" href="Ledger.Conway.Conformance.Epoch.html#2123" class="Bound">Δf</a><a id="2475" class="Symbol">)</a> <a id="2477" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">,</a> <a id="2479" href="Ledger.Conway.Conformance.Epoch.html#2193" class="Bound">deposits</a> <a id="2488" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">,</a> <a id="2490" href="Ledger.Conway.Conformance.Epoch.html#2204" class="Bound">donations</a> <a id="2500" href="Ledger.Utxo.html#2555" class="InductiveConstructor Operator">⟧ᵘ</a>
    <a id="2507" href="Ledger.Conway.Conformance.Ledger.html#724" class="InductiveConstructor Operator">,</a> <a id="2509" href="Ledger.Conway.Conformance.Epoch.html#2223" class="Bound">govSt</a>
    <a id="2519" href="Ledger.Conway.Conformance.Ledger.html#724" class="InductiveConstructor Operator">,</a> <a id="2521" href="Ledger.Conway.Conformance.Certs.html#956" class="InductiveConstructor Operator">⟦</a> <a id="2523" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">⟦</a> <a id="2525" href="Ledger.Conway.Conformance.Epoch.html#2239" class="Bound">voteDelegs</a> <a id="2536" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2538" href="Ledger.Conway.Conformance.Epoch.html#2252" class="Bound">stakeDelegs</a> <a id="2550" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2552" href="Ledger.Conway.Conformance.Epoch.html#2266" class="Bound">rewards</a> <a id="2560" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="2563" href="Ledger.Conway.Conformance.Epoch.html#2640" class="Function">regRU</a> <a id="2569" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2571" href="Ledger.Conway.Conformance.Epoch.html#2276" class="Bound">dDeposits</a> <a id="2581" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">⟧ᵈ</a> <a id="2584" href="Ledger.Conway.Conformance.Certs.html#956" class="InductiveConstructor Operator">,</a> <a id="2586" href="Ledger.Conway.Conformance.Epoch.html#2291" class="Bound">pState</a> <a id="2593" href="Ledger.Conway.Conformance.Certs.html#956" class="InductiveConstructor Operator">,</a> <a id="2595" href="Ledger.Conway.Conformance.Epoch.html#2300" class="Bound">gState</a> <a id="2602" href="Ledger.Conway.Conformance.Certs.html#956" class="InductiveConstructor Operator">⟧ᶜˢ</a> <a id="2606" href="Ledger.Conway.Conformance.Ledger.html#724" class="InductiveConstructor Operator">⟧ˡ</a>
  <a id="2611" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">,</a> <a id="2613" href="Ledger.Conway.Conformance.Epoch.html#2318" class="Bound">es</a>
  <a id="2618" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">,</a> <a id="2620" href="Ledger.Conway.Conformance.Epoch.html#2325" class="Bound">fut</a> <a id="2624" href="Ledger.Conway.Conformance.Epoch.html#1127" class="InductiveConstructor Operator">⟧ᵉ&#39;</a>
  <a id="2630" class="Keyword">where</a>
    <a id="2640" href="Ledger.Conway.Conformance.Epoch.html#2640" class="Function">regRU</a>     <a id="2650" class="Symbol">=</a> <a id="2652" href="Ledger.Conway.Conformance.Epoch.html#2128" class="Bound">rs</a> <a id="2655" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="2657" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2661" href="Ledger.Conway.Conformance.Epoch.html#2266" class="Bound">rewards</a>
    <a id="2673" href="Ledger.Conway.Conformance.Epoch.html#2673" class="Function">unregRU</a>   <a id="2683" class="Symbol">=</a> <a id="2685" href="Ledger.Conway.Conformance.Epoch.html#2128" class="Bound">rs</a> <a id="2688" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="2690" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2694" href="Ledger.Conway.Conformance.Epoch.html#2266" class="Bound">rewards</a> <a id="2702" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a>
    <a id="2708" href="Ledger.Conway.Conformance.Epoch.html#2708" class="Function">unregRU&#39;</a>  <a id="2718" class="Symbol">=</a> <a id="2720" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="2723" href="Ledger.Conway.Conformance.Epoch.html#2723" class="Bound">x</a> <a id="2725" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="2727" href="Ledger.Conway.Conformance.Epoch.html#2673" class="Function">unregRU</a> <a id="2735" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="2737" href="Ledger.Conway.Conformance.Epoch.html#2723" class="Bound">x</a>

<a id="stakeDistr"></a><a id="2740" href="Ledger.Conway.Conformance.Epoch.html#2740" class="Function">stakeDistr</a> <a id="2751" class="Symbol">:</a> <a id="2753" href="Ledger.Transaction.html#2402" class="Function">UTxO</a> <a id="2758" class="Symbol">→</a> <a id="2760" href="Ledger.Conway.Conformance.Certs.html#546" class="Record">DState</a> <a id="2767" class="Symbol">→</a> <a id="2769" href="Ledger.Certs.html#2574" class="Record">PState</a> <a id="2776" class="Symbol">→</a> <a id="2778" href="Ledger.Conway.Conformance.Epoch.html#841" class="Record">Snapshot</a>
<a id="2787" href="Ledger.Conway.Conformance.Epoch.html#2740" class="Function">stakeDistr</a> <a id="2798" href="Ledger.Conway.Conformance.Epoch.html#2798" class="Bound">utxo</a> <a id="2803" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">⟦</a> <a id="2805" class="Symbol">_</a> <a id="2807" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2809" href="Ledger.Conway.Conformance.Epoch.html#2809" class="Bound">stakeDelegs</a> <a id="2821" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2823" href="Ledger.Conway.Conformance.Epoch.html#2823" class="Bound">rewards</a> <a id="2831" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">,</a> <a id="2833" class="Symbol">_</a> <a id="2835" href="Ledger.Conway.Conformance.Certs.html#580" class="InductiveConstructor Operator">⟧ᵈ</a> <a id="2838" href="Ledger.Conway.Conformance.Epoch.html#2838" class="Bound">pState</a> <a id="2845" class="Symbol">=</a> <a id="2847" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="2849" href="Axiom.Set.Map.Dec.html#1932" class="Function">aggregate₊</a> <a id="2860" class="Symbol">(</a><a id="2861" href="Ledger.Conway.Conformance.Epoch.html#2998" class="Function">stakeRelation</a> <a id="2875" href="abstract-set-theory.FiniteSetTheory.html#2767" class="Function Operator">ᶠˢ</a><a id="2877" class="Symbol">)</a> <a id="2879" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2881" href="Ledger.Conway.Conformance.Epoch.html#2809" class="Bound">stakeDelegs</a> <a id="2893" href="Class.To.html#102" class="Field Operator">⟧</a>
  <a id="2897" class="Keyword">where</a>
    <a id="2907" href="Ledger.Conway.Conformance.Epoch.html#2907" class="Function">m</a> <a id="2909" class="Symbol">=</a> <a id="2911" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="2916" class="Symbol">(λ</a> <a id="2919" href="Ledger.Conway.Conformance.Epoch.html#2919" class="Bound">a</a> <a id="2921" class="Symbol">→</a> <a id="2923" class="Symbol">(</a><a id="2924" href="Ledger.Conway.Conformance.Epoch.html#2919" class="Bound">a</a> <a id="2926" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2928" href="Ledger.Utxo.html#3117" class="Function">cbalance</a> <a id="2937" class="Symbol">(</a><a id="2938" href="Ledger.Conway.Conformance.Epoch.html#2798" class="Bound">utxo</a> <a id="2943" href="abstract-set-theory.FiniteSetTheory.html#3088" class="Function Operator">∣^&#39;</a> <a id="2947" class="Symbol">λ</a> <a id="2949" href="Ledger.Conway.Conformance.Epoch.html#2949" class="Bound">i</a> <a id="2951" class="Symbol">→</a> <a id="2953" href="Ledger.Conway.Conformance.Epoch.html#1899" class="Function">getStakeCred</a> <a id="2966" href="Ledger.Conway.Conformance.Epoch.html#2949" class="Bound">i</a> <a id="2968" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2970" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2975" href="Ledger.Conway.Conformance.Epoch.html#2919" class="Bound">a</a><a id="2976" class="Symbol">)))</a> <a id="2980" class="Symbol">(</a><a id="2981" href="Class.IsSet.html#916" class="Function">dom</a> <a id="2985" href="Ledger.Conway.Conformance.Epoch.html#2823" class="Bound">rewards</a><a id="2992" class="Symbol">)</a>
    <a id="2998" href="Ledger.Conway.Conformance.Epoch.html#2998" class="Function">stakeRelation</a> <a id="3012" class="Symbol">=</a> <a id="3014" href="Ledger.Conway.Conformance.Epoch.html#2907" class="Function">m</a> <a id="3016" href="Axiom.Set.html#8952" class="Function Operator">∪</a> <a id="3018" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3024" href="Ledger.Conway.Conformance.Epoch.html#2823" class="Bound">rewards</a>

<a id="gaDepositStake"></a><a id="3033" href="Ledger.Conway.Conformance.Epoch.html#3033" class="Function">gaDepositStake</a> <a id="3048" class="Symbol">:</a> <a id="3050" href="Ledger.Gov.html#1218" class="Function">GovState</a> <a id="3059" class="Symbol">→</a> <a id="3061" href="Ledger.Certs.html#527" class="Function">Deposits</a> <a id="3070" class="Symbol">→</a> <a id="3072" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="3083" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3085" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
<a id="3090" href="Ledger.Conway.Conformance.Epoch.html#3033" class="Function">gaDepositStake</a> <a id="3105" href="Ledger.Conway.Conformance.Epoch.html#3105" class="Bound">govSt</a> <a id="3111" href="Ledger.Conway.Conformance.Epoch.html#3111" class="Bound">ds</a> <a id="3114" class="Symbol">=</a> <a id="3116" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a>
  <a id="3130" class="Symbol">(</a><a id="3131" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3136" class="Symbol">(λ</a> <a id="3139" class="Symbol">(</a><a id="3140" href="Ledger.Conway.Conformance.Epoch.html#3140" class="Bound">gaid</a> <a id="3145" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3147" href="Ledger.Conway.Conformance.Epoch.html#3147" class="Bound">addr</a><a id="3151" class="Symbol">)</a> <a id="3153" class="Symbol">→</a> <a id="3155" class="Symbol">(</a><a id="3156" href="Ledger.Conway.Conformance.Epoch.html#3140" class="Bound">gaid</a> <a id="3161" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3163" href="Ledger.Conway.Conformance.Epoch.html#3147" class="Bound">addr</a><a id="3167" class="Symbol">)</a> <a id="3169" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3171" href="Ledger.Address.html#1265" class="Field">stake</a> <a id="3177" href="Ledger.Conway.Conformance.Epoch.html#3147" class="Bound">addr</a><a id="3181" class="Symbol">)</a> <a id="3183" href="Ledger.Conway.Conformance.Epoch.html#3281" class="Function">govSt&#39;</a><a id="3189" class="Symbol">)</a>
  <a id="3193" class="Symbol">(</a><a id="3194" href="Axiom.Set.Map.html#10460" class="Function">mapFromPartialFun</a> <a id="3212" class="Symbol">(λ</a> <a id="3215" class="Symbol">(</a><a id="3216" href="Ledger.Conway.Conformance.Epoch.html#3216" class="Bound">gaid</a> <a id="3221" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3223" class="Symbol">_)</a> <a id="3226" class="Symbol">→</a> <a id="3228" href="Axiom.Set.Map.html#13670" class="Function">lookupᵐ?</a> <a id="3237" href="Ledger.Conway.Conformance.Epoch.html#3111" class="Bound">ds</a> <a id="3240" class="Symbol">(</a><a id="3241" href="Ledger.Certs.html#475" class="InductiveConstructor">GovActionDeposit</a> <a id="3258" href="Ledger.Conway.Conformance.Epoch.html#3216" class="Bound">gaid</a><a id="3262" class="Symbol">))</a> <a id="3265" href="Ledger.Conway.Conformance.Epoch.html#3281" class="Function">govSt&#39;</a><a id="3271" class="Symbol">)</a>
  <a id="3275" class="Keyword">where</a> <a id="3281" href="Ledger.Conway.Conformance.Epoch.html#3281" class="Function">govSt&#39;</a> <a id="3288" class="Symbol">=</a> <a id="3290" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="3295" class="Symbol">(</a><a id="3296" href="Class.Bifunctor.html#1143" class="Function">map₂</a> <a id="3301" href="Ledger.GovernanceActions.html#2167" class="Field">returnAddr</a><a id="3311" class="Symbol">)</a> <a id="3313" class="Symbol">(</a><a id="3314" href="Axiom.Set.html#5718" class="Function">fromList</a> <a id="3323" href="Ledger.Conway.Conformance.Epoch.html#3105" class="Bound">govSt</a><a id="3328" class="Symbol">)</a>


<a id="3332" class="Keyword">opaque</a>

  <a id="mkStakeDistrs"></a><a id="3342" href="Ledger.Conway.Conformance.Epoch.html#3342" class="Function">mkStakeDistrs</a> <a id="3356" class="Symbol">:</a> <a id="3358" href="Ledger.Conway.Conformance.Epoch.html#841" class="Record">Snapshot</a> <a id="3367" class="Symbol">→</a> <a id="3369" href="Ledger.Gov.html#1218" class="Function">GovState</a> <a id="3378" class="Symbol">→</a> <a id="3380" href="Ledger.Certs.html#527" class="Function">Deposits</a> <a id="3389" class="Symbol">→</a> <a id="3391" class="Symbol">(</a><a id="3392" href="Ledger.Address.html#273" class="Datatype">Credential</a> <a id="3403" href="abstract-set-theory.FiniteSetTheory.html#633" class="Function Operator">⇀</a> <a id="3405" href="Ledger.GovernanceActions.html#458" class="Datatype">VDeleg</a><a id="3411" class="Symbol">)</a> <a id="3413" class="Symbol">→</a> <a id="3415" href="Ledger.Ratify.html#2876" class="Record">StakeDistrs</a>
  <a id="3429" href="Ledger.Conway.Conformance.Epoch.html#3342" class="Function">mkStakeDistrs</a> <a id="3443" href="Ledger.Conway.Conformance.Epoch.html#3443" class="Bound">ss</a> <a id="3446" href="Ledger.Conway.Conformance.Epoch.html#3446" class="Bound">govSt</a> <a id="3452" href="Ledger.Conway.Conformance.Epoch.html#3452" class="Bound">ds</a> <a id="3455" href="Ledger.Conway.Conformance.Epoch.html#3455" class="Bound">delegations</a> <a id="3467" class="Symbol">.</a><a id="3468" href="Ledger.Ratify.html#2913" class="Field">StakeDistrs.stakeDistr</a> <a id="3491" class="Symbol">=</a>
    <a id="3497" href="abstract-set-theory.FiniteSetTheory.html#3599" class="Function">aggregateBy</a> <a id="3509" class="Symbol">(</a><a id="3510" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3516" href="Ledger.Conway.Conformance.Epoch.html#3455" class="Bound">delegations</a><a id="3527" class="Symbol">)</a> <a id="3529" class="Symbol">(</a><a id="3530" href="Ledger.Conway.Conformance.Epoch.html#874" class="Field">Snapshot.stake</a> <a id="3545" href="Ledger.Conway.Conformance.Epoch.html#3443" class="Bound">ss</a> <a id="3548" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="3551" href="Ledger.Conway.Conformance.Epoch.html#3033" class="Function">gaDepositStake</a> <a id="3566" href="Ledger.Conway.Conformance.Epoch.html#3446" class="Bound">govSt</a> <a id="3572" href="Ledger.Conway.Conformance.Epoch.html#3452" class="Bound">ds</a><a id="3574" class="Symbol">)</a>

<a id="3577" class="Keyword">private</a> <a id="3585" class="Keyword">variable</a>
  <a id="3596" href="Ledger.Conway.Conformance.Epoch.html#3596" class="Generalizable">nes</a> <a id="3600" href="Ledger.Conway.Conformance.Epoch.html#3600" class="Generalizable">nes&#39;</a> <a id="3605" class="Symbol">:</a> <a id="3607" href="Ledger.Conway.Conformance.Epoch.html#1287" class="Record">NewEpochState</a>
  <a id="3623" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="3625" href="Ledger.Conway.Conformance.Epoch.html#3625" class="Generalizable">lastEpoch</a> <a id="3635" class="Symbol">:</a> <a id="3637" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a>
  <a id="3645" href="Ledger.Conway.Conformance.Epoch.html#3645" class="Generalizable">fut</a> <a id="3649" href="Ledger.Conway.Conformance.Epoch.html#3649" class="Generalizable">fut&#39;</a> <a id="3654" class="Symbol">:</a> <a id="3656" href="Ledger.Ratify.html#3241" class="Record">RatifyState</a>
  <a id="3670" href="Ledger.Conway.Conformance.Epoch.html#3670" class="Generalizable">eps</a> <a id="3674" href="Ledger.Conway.Conformance.Epoch.html#3674" class="Generalizable">eps&#39;</a> <a id="3679" href="Ledger.Conway.Conformance.Epoch.html#3679" class="Generalizable">eps&#39;&#39;</a> <a id="3685" class="Symbol">:</a> <a id="3687" href="Ledger.Conway.Conformance.Epoch.html#1089" class="Record">EpochState</a>
  <a id="3700" href="Ledger.Conway.Conformance.Epoch.html#3700" class="Generalizable">ls</a> <a id="3703" class="Symbol">:</a> <a id="3705" href="Ledger.Conway.Conformance.Ledger.html#690" class="Record">LState</a>
  <a id="3714" href="Ledger.Conway.Conformance.Epoch.html#3714" class="Generalizable">acnt</a> <a id="3719" class="Symbol">:</a> <a id="3721" href="Ledger.PParams.html#620" class="Record">Acnt</a>
  <a id="3728" href="Ledger.Conway.Conformance.Epoch.html#3728" class="Generalizable">es₀</a> <a id="3732" class="Symbol">:</a> <a id="3734" href="Ledger.Enact.html#397" class="Record">EnactState</a>
  <a id="3747" href="Ledger.Conway.Conformance.Epoch.html#3747" class="Generalizable">mark</a> <a id="3752" href="Ledger.Conway.Conformance.Epoch.html#3752" class="Generalizable">set</a> <a id="3756" href="Ledger.Conway.Conformance.Epoch.html#3756" class="Generalizable">go</a> <a id="3759" class="Symbol">:</a> <a id="3761" href="Ledger.Conway.Conformance.Epoch.html#841" class="Record">Snapshot</a>
  <a id="3772" href="Ledger.Conway.Conformance.Epoch.html#3772" class="Generalizable">feeSS</a> <a id="3778" class="Symbol">:</a> <a id="3780" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="3787" href="Ledger.Conway.Conformance.Epoch.html#3787" class="Generalizable">lstate</a> <a id="3794" class="Symbol">:</a> <a id="3796" href="Ledger.Conway.Conformance.Ledger.html#690" class="Record">LState</a>
  <a id="3805" href="Ledger.Conway.Conformance.Epoch.html#3805" class="Generalizable">ss</a> <a id="3808" href="Ledger.Conway.Conformance.Epoch.html#3808" class="Generalizable">ss&#39;</a> <a id="3812" class="Symbol">:</a> <a id="3814" href="Ledger.Conway.Conformance.Epoch.html#999" class="Record">Snapshots</a>
  <a id="3826" href="Ledger.Conway.Conformance.Epoch.html#3826" class="Generalizable">ru</a> <a id="3829" class="Symbol">:</a> <a id="3831" href="Ledger.Conway.Conformance.Epoch.html#730" class="Record">RewardUpdate</a>
  <a id="3846" href="Ledger.Conway.Conformance.Epoch.html#3846" class="Generalizable">mru</a> <a id="3850" class="Symbol">:</a> <a id="3852" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3858" href="Ledger.Conway.Conformance.Epoch.html#730" class="Record">RewardUpdate</a>
  <a id="3873" href="Ledger.Conway.Conformance.Epoch.html#3873" class="Generalizable">certState&#39;</a> <a id="3884" class="Symbol">:</a> <a id="3886" href="Ledger.Conway.Conformance.Certs.html#919" class="Record">CertState</a>

<a id="3897" class="Keyword">data</a> <a id="_⊢_⇀⦇_,SNAP⦈_"></a><a id="3902" href="Ledger.Conway.Conformance.Epoch.html#3902" class="Datatype Operator">_⊢_⇀⦇_,SNAP⦈_</a> <a id="3916" class="Symbol">:</a> <a id="3918" href="Ledger.Conway.Conformance.Ledger.html#690" class="Record">LState</a> <a id="3925" class="Symbol">→</a> <a id="3927" href="Ledger.Conway.Conformance.Epoch.html#999" class="Record">Snapshots</a> <a id="3937" class="Symbol">→</a> <a id="3939" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="3941" class="Symbol">→</a> <a id="3943" href="Ledger.Conway.Conformance.Epoch.html#999" class="Record">Snapshots</a> <a id="3953" class="Symbol">→</a> <a id="3955" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="3960" class="Keyword">where</a>
  <a id="_⊢_⇀⦇_,SNAP⦈_.SNAP"></a><a id="3968" href="Ledger.Conway.Conformance.Epoch.html#3968" class="InductiveConstructor">SNAP</a> <a id="3973" class="Symbol">:</a> <a id="3975" class="Keyword">let</a> <a id="3979" class="Keyword">open</a> <a id="3984" href="Ledger.Conway.Conformance.Ledger.html#690" class="Module">LState</a> <a id="3991" href="Ledger.Conway.Conformance.Epoch.html#3787" class="Generalizable">lstate</a><a id="3997" class="Symbol">;</a> <a id="3999" class="Keyword">open</a> <a id="4004" href="Ledger.Utxo.html#2516" class="Module">UTxOState</a> <a id="4014" href="Ledger.Conway.Conformance.Ledger.html#745" class="Function">utxoSt</a><a id="4020" class="Symbol">;</a> <a id="4022" class="Keyword">open</a> <a id="4027" href="Ledger.Conway.Conformance.Certs.html#919" class="Module">CertState</a> <a id="4037" href="Ledger.Conway.Conformance.Ledger.html#798" class="Function">certState</a>
             <a id="4060" href="Ledger.Conway.Conformance.Epoch.html#4060" class="Bound">stake</a> <a id="4066" class="Symbol">=</a> <a id="4068" href="Ledger.Conway.Conformance.Epoch.html#2740" class="Function">stakeDistr</a> <a id="4079" href="Ledger.Utxo.html#2580" class="Function">utxo</a> <a id="4084" href="Ledger.Conway.Conformance.Certs.html#978" class="Function">dState</a> <a id="4091" href="Ledger.Conway.Conformance.Certs.html#998" class="Function">pState</a>
    <a id="4102" class="Keyword">in</a>
    <a id="4109" href="Ledger.Conway.Conformance.Epoch.html#3787" class="Generalizable">lstate</a> <a id="4116" href="Ledger.Conway.Conformance.Epoch.html#3902" class="Datatype Operator">⊢</a> <a id="4118" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="4120" href="Ledger.Conway.Conformance.Epoch.html#3747" class="Generalizable">mark</a> <a id="4125" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4127" href="Ledger.Conway.Conformance.Epoch.html#3752" class="Generalizable">set</a> <a id="4131" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4133" href="Ledger.Conway.Conformance.Epoch.html#3756" class="Generalizable">go</a> <a id="4136" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4138" href="Ledger.Conway.Conformance.Epoch.html#3772" class="Generalizable">feeSS</a> <a id="4144" href="Class.To.html#102" class="Field Operator">⟧</a> <a id="4146" href="Ledger.Conway.Conformance.Epoch.html#3902" class="Datatype Operator">⇀⦇</a> <a id="4149" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="4152" href="Ledger.Conway.Conformance.Epoch.html#3902" class="Datatype Operator">,SNAP⦈</a> <a id="4159" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="4161" href="Ledger.Conway.Conformance.Epoch.html#4060" class="Bound">stake</a> <a id="4167" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4169" href="Ledger.Conway.Conformance.Epoch.html#3747" class="Generalizable">mark</a> <a id="4174" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4176" href="Ledger.Conway.Conformance.Epoch.html#3752" class="Generalizable">set</a> <a id="4180" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4182" href="Ledger.Utxo.html#2602" class="Function">fees</a> <a id="4187" href="Class.To.html#102" class="Field Operator">⟧</a>

<a id="4190" class="Keyword">data</a> <a id="_⊢_⇀⦇_,EPOCH⦈_"></a><a id="4195" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">_⊢_⇀⦇_,EPOCH⦈_</a> <a id="4210" class="Symbol">:</a> <a id="4212" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="4214" class="Symbol">→</a> <a id="4216" href="Ledger.Conway.Conformance.Epoch.html#1089" class="Record">EpochState</a> <a id="4227" class="Symbol">→</a> <a id="4229" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a> <a id="4235" class="Symbol">→</a> <a id="4237" href="Ledger.Conway.Conformance.Epoch.html#1089" class="Record">EpochState</a> <a id="4248" class="Symbol">→</a> <a id="4250" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4255" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,EPOCH⦈_.EPOCH"></a><a id="4264" href="Ledger.Conway.Conformance.Epoch.html#4264" class="InductiveConstructor">EPOCH</a> <a id="4270" class="Symbol">:</a> <a id="4272" class="Keyword">let</a>
      <a id="4282" class="Keyword">open</a> <a id="4287" href="Ledger.Conway.Conformance.Ledger.html#690" class="Module">LState</a> <a id="4294" href="Ledger.Conway.Conformance.Epoch.html#3700" class="Generalizable">ls</a>
      <a id="4303" class="Keyword">open</a> <a id="4308" href="Ledger.Conway.Conformance.Certs.html#919" class="Module">CertState</a> <a id="4318" href="Ledger.Conway.Conformance.Ledger.html#798" class="Function">certState</a>
      <a id="4334" class="Keyword">open</a> <a id="4339" href="Ledger.Ratify.html#3241" class="Module">RatifyState</a> <a id="4351" href="Ledger.Conway.Conformance.Epoch.html#3645" class="Generalizable">fut</a>
      <a id="4361" class="Keyword">open</a> <a id="4366" href="Ledger.Utxo.html#2516" class="Module">UTxOState</a>
      <a id="4382" class="Keyword">open</a> <a id="4387" href="Ledger.Certs.html#2574" class="Module">PState</a><a id="4393" class="Symbol">;</a> <a id="4395" class="Keyword">open</a> <a id="4400" href="Ledger.Conway.Conformance.Certs.html#546" class="Module">DState</a><a id="4406" class="Symbol">;</a> <a id="4408" class="Keyword">open</a> <a id="4413" href="Ledger.Conway.Conformance.Certs.html#751" class="Module">GState</a>
      <a id="4426" class="Keyword">open</a> <a id="4431" href="Ledger.PParams.html#620" class="Module">Acnt</a><a id="4435" class="Symbol">;</a> <a id="4437" class="Keyword">open</a> <a id="4442" href="Ledger.Enact.html#397" class="Module">EnactState</a><a id="4452" class="Symbol">;</a> <a id="4454" class="Keyword">open</a> <a id="4459" href="Ledger.GovernanceActions.html#2096" class="Module">GovActionState</a>


      <a id="4482" href="Ledger.Conway.Conformance.Epoch.html#4482" class="Bound">removedGovActions</a> <a id="4500" class="Symbol">=</a> <a id="4502" href="Function.Base.html#1638" class="Function">flip</a> <a id="4507" href="Axiom.Set.html#7022" class="Function">concatMapˢ</a> <a id="4518" href="Ledger.Ratify.html#3311" class="Function">removed</a> <a id="4526" class="Symbol">λ</a> <a id="4528" class="Symbol">(</a><a id="4529" href="Ledger.Conway.Conformance.Epoch.html#4529" class="Bound">gaid</a> <a id="4534" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4536" href="Ledger.Conway.Conformance.Epoch.html#4536" class="Bound">gaSt</a><a id="4540" class="Symbol">)</a> <a id="4542" class="Symbol">→</a>
        <a id="4552" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4557" class="Symbol">(</a><a id="4558" href="Ledger.GovernanceActions.html#2167" class="Field">returnAddr</a> <a id="4569" href="Ledger.Conway.Conformance.Epoch.html#4536" class="Bound">gaSt</a> <a id="4574" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,_</a><a id="4576" class="Symbol">)</a> <a id="4578" class="Symbol">((</a><a id="4580" href="Ledger.Conway.Conformance.Ledger.html#745" class="Function">utxoSt</a> <a id="4587" class="Symbol">.</a><a id="4588" href="Ledger.Utxo.html#2624" class="Field">deposits</a> <a id="4597" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="4599" href="Class.HasSingleton.html#288" class="Field Operator">❴</a> <a id="4601" href="Ledger.Certs.html#475" class="InductiveConstructor">GovActionDeposit</a> <a id="4618" href="Ledger.Conway.Conformance.Epoch.html#4529" class="Bound">gaid</a> <a id="4623" href="Class.HasSingleton.html#288" class="Field Operator">❵</a><a id="4624" class="Symbol">)</a> <a id="4626" href="Axiom.Set.Map.html#2293" class="Function Operator">ˢ</a><a id="4627" class="Symbol">)</a>
      <a id="4635" href="Ledger.Conway.Conformance.Epoch.html#4635" class="Bound">govActionReturns</a> <a id="4652" class="Symbol">=</a> <a id="4654" href="Axiom.Set.Map.Dec.html#1932" class="Function">aggregate₊</a> <a id="4665" class="Symbol">(</a><a id="4666" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="4671" class="Symbol">(λ</a> <a id="4674" class="Symbol">(</a><a id="4675" href="Ledger.Conway.Conformance.Epoch.html#4675" class="Bound">a</a> <a id="4677" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4679" class="Symbol">_</a> <a id="4681" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4683" href="Ledger.Conway.Conformance.Epoch.html#4683" class="Bound">d</a><a id="4684" class="Symbol">)</a> <a id="4686" class="Symbol">→</a> <a id="4688" href="Ledger.Conway.Conformance.Epoch.html#4675" class="Bound">a</a> <a id="4690" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4692" href="Ledger.Conway.Conformance.Epoch.html#4683" class="Bound">d</a><a id="4693" class="Symbol">)</a> <a id="4695" href="Ledger.Conway.Conformance.Epoch.html#4482" class="Bound">removedGovActions</a> <a id="4713" href="abstract-set-theory.FiniteSetTheory.html#2767" class="Function Operator">ᶠˢ</a><a id="4715" class="Symbol">)</a>

      <a id="4724" href="Ledger.Conway.Conformance.Epoch.html#4724" class="Bound">trWithdrawals</a>   <a id="4740" class="Symbol">=</a> <a id="4742" href="Ledger.Ratify.html#3278" class="Function">es</a> <a id="4745" class="Symbol">.</a><a id="4746" href="Ledger.Enact.html#649" class="Field">withdrawals</a>
      <a id="4764" href="Ledger.Conway.Conformance.Epoch.html#4764" class="Bound">totWithdrawals</a>  <a id="4780" class="Symbol">=</a> <a id="4782" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">∑[</a> <a id="4785" href="Ledger.Conway.Conformance.Epoch.html#4785" class="Bound">x</a> <a id="4787" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">←</a> <a id="4789" href="Ledger.Conway.Conformance.Epoch.html#4724" class="Bound">trWithdrawals</a> <a id="4803" href="abstract-set-theory.FiniteSetTheory.html#3166" class="Function">]</a> <a id="4805" href="Ledger.Conway.Conformance.Epoch.html#4785" class="Bound">x</a>

      <a id="4814" href="Ledger.Conway.Conformance.Epoch.html#4814" class="Bound">es</a>         <a id="4825" class="Symbol">=</a> <a id="4827" class="Keyword">record</a> <a id="4834" href="Ledger.Ratify.html#3278" class="Function">es</a> <a id="4837" class="Symbol">{</a> <a id="4839" href="Ledger.Enact.html#649" class="Field">withdrawals</a> <a id="4851" class="Symbol">=</a> <a id="4853" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="4855" class="Symbol">}</a>
      <a id="4863" href="Ledger.Conway.Conformance.Epoch.html#4863" class="Bound">retired</a>    <a id="4874" class="Symbol">=</a> <a id="4876" class="Symbol">(</a><a id="4877" href="Ledger.Conway.Conformance.Certs.html#998" class="Function">pState</a> <a id="4884" class="Symbol">.</a><a id="4885" href="Ledger.Certs.html#2643" class="Field">retiring</a><a id="4893" class="Symbol">)</a> <a id="4895" href="Axiom.Set.Map.html#14230" class="Function Operator">⁻¹</a> <a id="4898" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a>
      <a id="4906" href="Ledger.Conway.Conformance.Epoch.html#4906" class="Bound">payout</a>     <a id="4917" class="Symbol">=</a> <a id="4919" href="Ledger.Conway.Conformance.Epoch.html#4635" class="Bound">govActionReturns</a> <a id="4936" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="4939" href="Ledger.Conway.Conformance.Epoch.html#4724" class="Bound">trWithdrawals</a>
      <a id="4959" href="Ledger.Conway.Conformance.Epoch.html#4959" class="Bound">refunds</a>    <a id="4970" class="Symbol">=</a> <a id="4972" href="Axiom.Set.Map.html#13791" class="Function">pullbackMap</a> <a id="4984" href="Ledger.Conway.Conformance.Epoch.html#4906" class="Bound">payout</a> <a id="4991" href="Ledger.Conway.Conformance.Epoch.html#1812" class="Function">toRwdAddr</a> <a id="5001" class="Symbol">(</a><a id="5002" href="Class.IsSet.html#916" class="Function">dom</a> <a id="5006" class="Symbol">(</a><a id="5007" href="Ledger.Conway.Conformance.Certs.html#978" class="Function">dState</a> <a id="5014" class="Symbol">.</a><a id="5015" href="Ledger.Conway.Conformance.Certs.html#682" class="Field">rewards</a><a id="5022" class="Symbol">))</a>
      <a id="5031" href="Ledger.Conway.Conformance.Epoch.html#5031" class="Bound">unclaimed</a>  <a id="5042" class="Symbol">=</a> <a id="5044" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="5052" href="Ledger.Conway.Conformance.Epoch.html#4906" class="Bound">payout</a> <a id="5059" href="Interface.HasSubtract.html#209" class="Field Operator">-</a> <a id="5061" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="5069" href="Ledger.Conway.Conformance.Epoch.html#4959" class="Bound">refunds</a>
      <a id="5083" href="Ledger.Conway.Conformance.Epoch.html#5083" class="Bound">vDeposits</a>  <a id="5094" class="Symbol">=</a> <a id="5096" href="Ledger.Conway.Conformance.Certs.html#1018" class="Function">gState</a> <a id="5103" class="Symbol">.</a><a id="5104" href="Ledger.Conway.Conformance.Certs.html#889" class="Field">deposits</a>

      <a id="5120" href="Ledger.Conway.Conformance.Epoch.html#5120" class="Bound">govSt&#39;</a> <a id="5127" class="Symbol">=</a> <a id="5129" href="Data.List.Base.html#10687" class="Function">filter</a> <a id="5136" class="Symbol">(λ</a> <a id="5139" href="Ledger.Conway.Conformance.Epoch.html#5139" class="Bound">x</a> <a id="5141" class="Symbol">→</a> <a id="5143" href="Class.Decidable.Core.html#461" class="Function Operator">¿</a> <a id="5145" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5151" href="Ledger.Conway.Conformance.Epoch.html#5139" class="Bound">x</a> <a id="5153" href="Class.IsSet.html#462" class="Function Operator">∉</a> <a id="5155" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5160" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5166" href="Ledger.Ratify.html#3311" class="Function">removed</a> <a id="5174" href="Class.Decidable.Core.html#461" class="Function Operator">¿</a><a id="5175" class="Symbol">)</a> <a id="5177" href="Ledger.Conway.Conformance.Ledger.html#772" class="Function">govSt</a>

      <a id="5190" href="Ledger.Conway.Conformance.Epoch.html#5190" class="Bound">dState&#39;</a> <a id="5198" class="Symbol">:</a> <a id="5200" href="Ledger.Conway.Conformance.Certs.html#546" class="Record">DState</a>
      <a id="5213" href="Ledger.Conway.Conformance.Epoch.html#5190" class="Bound">dState&#39;</a> <a id="5221" class="Symbol">=</a> <a id="5223" class="Keyword">record</a> <a id="5230" href="Ledger.Conway.Conformance.Certs.html#978" class="Function">dState</a> <a id="5237" class="Symbol">{</a> <a id="5239" href="Ledger.Conway.Conformance.Certs.html#682" class="Field">rewards</a> <a id="5247" class="Symbol">=</a> <a id="5249" href="Ledger.Conway.Conformance.Certs.html#978" class="Function">dState</a> <a id="5256" class="Symbol">.</a><a id="5257" href="Ledger.Conway.Conformance.Certs.html#682" class="Field">rewards</a> <a id="5265" href="Axiom.Set.Map.Dec.html#1854" class="Function Operator">∪⁺</a> <a id="5268" href="Ledger.Conway.Conformance.Epoch.html#4959" class="Bound">refunds</a> <a id="5276" class="Symbol">}</a>

      <a id="5285" href="Ledger.Conway.Conformance.Epoch.html#5285" class="Bound">pState&#39;</a> <a id="5293" class="Symbol">:</a> <a id="5295" href="Ledger.Certs.html#2574" class="Record">PState</a>
      <a id="5308" href="Ledger.Conway.Conformance.Epoch.html#5285" class="Bound">pState&#39;</a> <a id="5316" class="Symbol">=</a> <a id="5318" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="5320" class="Symbol">(</a><a id="5321" href="Ledger.Conway.Conformance.Certs.html#998" class="Function">pState</a> <a id="5328" class="Symbol">.</a><a id="5329" href="Ledger.Certs.html#2606" class="Field">pools</a><a id="5334" class="Symbol">)</a> <a id="5336" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="5338" href="Ledger.Conway.Conformance.Epoch.html#4863" class="Bound">retired</a> <a id="5346" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="5348" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5350" class="Symbol">(</a><a id="5351" href="Ledger.Conway.Conformance.Certs.html#998" class="Function">pState</a> <a id="5358" class="Symbol">.</a><a id="5359" href="Ledger.Certs.html#2643" class="Field">retiring</a><a id="5367" class="Symbol">)</a> <a id="5369" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="5371" href="Ledger.Conway.Conformance.Epoch.html#4863" class="Bound">retired</a> <a id="5379" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="5381" href="Class.To.html#102" class="Field Operator">⟧</a>

      <a id="5390" href="Ledger.Conway.Conformance.Epoch.html#5390" class="Bound">gState&#39;</a> <a id="5398" class="Symbol">:</a> <a id="5400" href="Ledger.Conway.Conformance.Certs.html#751" class="Record">GState</a>
      <a id="5413" href="Ledger.Conway.Conformance.Epoch.html#5390" class="Bound">gState&#39;</a> <a id="5421" class="Symbol">=</a> <a id="5423" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="5425" class="Symbol">(</a><a id="5426" href="Class.ToBool.html#534" class="Function Operator">if</a> <a id="5429" href="Data.List.Base.html#4703" class="Function">null</a> <a id="5434" href="Ledger.Conway.Conformance.Epoch.html#5120" class="Bound">govSt&#39;</a> <a id="5441" href="Class.ToBool.html#534" class="Function Operator">then</a> <a id="5446" href="Axiom.Set.Map.html#6068" class="Function">mapValues</a> <a id="5456" class="Symbol">(</a><a id="5457" class="Number">1</a> <a id="5459" href="Class.HasAdd.Core.html#136" class="Field Operator">+_</a><a id="5461" class="Symbol">)</a> <a id="5463" class="Symbol">(</a><a id="5464" href="Ledger.Conway.Conformance.Certs.html#1018" class="Function">gState</a> <a id="5471" class="Symbol">.</a><a id="5472" href="Ledger.Conway.Conformance.Certs.html#806" class="Field">dreps</a><a id="5477" class="Symbol">)</a> <a id="5479" href="Class.ToBool.html#534" class="Function Operator">else</a> <a id="5484" class="Symbol">(</a><a id="5485" href="Ledger.Conway.Conformance.Certs.html#1018" class="Function">gState</a> <a id="5492" class="Symbol">.</a><a id="5493" href="Ledger.Conway.Conformance.Certs.html#806" class="Field">dreps</a><a id="5498" class="Symbol">))</a>
                <a id="5517" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5519" class="Symbol">(</a><a id="5520" href="Ledger.Conway.Conformance.Certs.html#1018" class="Function">gState</a> <a id="5527" class="Symbol">.</a><a id="5528" href="Ledger.Conway.Conformance.Certs.html#842" class="Field">ccHotKeys</a><a id="5537" class="Symbol">)</a> <a id="5539" href="Axiom.Set.Map.html#10678" class="Function Operator">∣</a> <a id="5541" href="Ledger.Enact.html#788" class="Function">ccCreds</a> <a id="5549" class="Symbol">(</a><a id="5550" href="Ledger.Conway.Conformance.Epoch.html#4814" class="Bound">es</a> <a id="5553" class="Symbol">.</a><a id="5554" href="Ledger.Enact.html#433" class="Field">cc</a><a id="5556" class="Symbol">)</a>
                <a id="5574" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5576" href="Ledger.Conway.Conformance.Epoch.html#5083" class="Bound">vDeposits</a>
                <a id="5602" href="Class.To.html#102" class="Field Operator">⟧</a>

      <a id="5611" href="Ledger.Conway.Conformance.Epoch.html#5611" class="Bound">certState&#39;</a> <a id="5622" class="Symbol">:</a> <a id="5624" href="Ledger.Conway.Conformance.Certs.html#919" class="Record">CertState</a>
      <a id="5640" href="Ledger.Conway.Conformance.Epoch.html#5611" class="Bound">certState&#39;</a> <a id="5651" class="Symbol">=</a> <a id="5653" class="Keyword">record</a> <a id="5660" class="Symbol">{</a> <a id="5662" href="Ledger.Conway.Conformance.Certs.html#978" class="Field">dState</a> <a id="5669" class="Symbol">=</a> <a id="5671" href="Ledger.Conway.Conformance.Epoch.html#5190" class="Bound">dState&#39;</a> <a id="5679" class="Symbol">;</a> <a id="5681" href="Ledger.Conway.Conformance.Certs.html#998" class="Field">pState</a> <a id="5688" class="Symbol">=</a> <a id="5690" href="Ledger.Conway.Conformance.Epoch.html#5285" class="Bound">pState&#39;</a> <a id="5698" class="Symbol">;</a> <a id="5700" href="Ledger.Conway.Conformance.Certs.html#1018" class="Field">gState</a> <a id="5707" class="Symbol">=</a> <a id="5709" href="Ledger.Conway.Conformance.Epoch.html#5390" class="Bound">gState&#39;</a> <a id="5717" class="Symbol">}</a>

      <a id="5726" href="Ledger.Conway.Conformance.Epoch.html#5726" class="Bound">utxoSt&#39;</a> <a id="5734" class="Symbol">=</a> <a id="5736" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="5738" href="Ledger.Conway.Conformance.Ledger.html#745" class="Function">utxoSt</a> <a id="5745" class="Symbol">.</a><a id="5746" href="Ledger.Utxo.html#2580" class="Field">utxo</a> <a id="5751" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5753" href="Ledger.Conway.Conformance.Ledger.html#745" class="Function">utxoSt</a> <a id="5760" class="Symbol">.</a><a id="5761" href="Ledger.Utxo.html#2602" class="Field">fees</a> <a id="5766" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5768" href="Ledger.Conway.Conformance.Ledger.html#745" class="Function">utxoSt</a> <a id="5775" class="Symbol">.</a><a id="5776" href="Ledger.Utxo.html#2624" class="Field">deposits</a> <a id="5785" href="Axiom.Set.Map.html#10748" class="Function Operator">∣</a> <a id="5787" href="abstract-set-theory.FiniteSetTheory.html#519" class="Function">mapˢ</a> <a id="5792" class="Symbol">(</a><a id="5793" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="5799" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5801" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="5806" class="Symbol">)</a> <a id="5808" href="Ledger.Conway.Conformance.Epoch.html#4482" class="Bound">removedGovActions</a> <a id="5826" href="Axiom.Set.Map.html#10748" class="Function Operator">ᶜ</a> <a id="5828" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5830" class="Number">0</a> <a id="5832" href="Class.To.html#102" class="Field Operator">⟧</a>

      <a id="5841" href="Ledger.Conway.Conformance.Epoch.html#5841" class="Bound">acnt&#39;</a> <a id="5847" class="Symbol">=</a> <a id="5849" class="Keyword">record</a> <a id="5856" href="Ledger.Conway.Conformance.Epoch.html#3714" class="Generalizable">acnt</a>
        <a id="5869" class="Symbol">{</a> <a id="5871" href="Ledger.PParams.html#675" class="Field">treasury</a>  <a id="5881" class="Symbol">=</a> <a id="5883" href="Ledger.Conway.Conformance.Epoch.html#3714" class="Generalizable">acnt</a> <a id="5888" class="Symbol">.</a><a id="5889" href="Ledger.PParams.html#675" class="Field">treasury</a> <a id="5898" href="Data.Nat.Base.html#4456" class="Primitive Operator">∸</a> <a id="5900" href="Ledger.Conway.Conformance.Epoch.html#4764" class="Bound">totWithdrawals</a> <a id="5915" href="Class.HasAdd.Core.html#136" class="Field Operator">+</a> <a id="5917" href="Ledger.Conway.Conformance.Ledger.html#745" class="Function">utxoSt</a> <a id="5924" class="Symbol">.</a><a id="5925" href="Ledger.Utxo.html#2650" class="Field">donations</a> <a id="5935" href="Class.HasAdd.Core.html#136" class="Field Operator">+</a> <a id="5937" href="Ledger.Conway.Conformance.Epoch.html#5031" class="Bound">unclaimed</a> <a id="5947" class="Symbol">}</a>
    <a id="5953" class="Keyword">in</a>
    <a id="5960" class="Keyword">record</a> <a id="5967" class="Symbol">{</a> <a id="5969" href="Ledger.Ratify.html#3016" class="Field">currentEpoch</a> <a id="5982" class="Symbol">=</a> <a id="5984" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a>
           <a id="5997" class="Symbol">;</a> <a id="5999" href="Ledger.Ratify.html#2984" class="Field">stakeDistrs</a> <a id="6011" class="Symbol">=</a> <a id="6013" href="Ledger.Conway.Conformance.Epoch.html#3342" class="Function">mkStakeDistrs</a>  <a id="6028" class="Symbol">(</a><a id="6029" href="Ledger.Conway.Conformance.Epoch.html#1033" class="Field">Snapshots.mark</a> <a id="6044" href="Ledger.Conway.Conformance.Epoch.html#3808" class="Generalizable">ss&#39;</a><a id="6047" class="Symbol">)</a> <a id="6049" href="Ledger.Conway.Conformance.Epoch.html#5120" class="Bound">govSt&#39;</a>
                                          <a id="6098" class="Symbol">(</a><a id="6099" href="Ledger.Conway.Conformance.Epoch.html#5726" class="Bound">utxoSt&#39;</a> <a id="6107" class="Symbol">.</a><a id="6108" href="Ledger.Utxo.html#2624" class="Field">deposits</a><a id="6116" class="Symbol">)</a> <a id="6118" class="Symbol">(</a><a id="6119" href="Ledger.Conway.Conformance.Certs.html#603" class="Field">voteDelegs</a> <a id="6130" href="Ledger.Conway.Conformance.Certs.html#978" class="Function">dState</a><a id="6136" class="Symbol">)</a>
           <a id="6149" class="Symbol">;</a> <a id="6151" href="Ledger.Ratify.html#3131" class="Field">treasury</a> <a id="6160" class="Symbol">=</a> <a id="6162" href="Ledger.Conway.Conformance.Epoch.html#3714" class="Generalizable">acnt</a> <a id="6167" class="Symbol">.</a><a id="6168" href="Ledger.PParams.html#675" class="Field">treasury</a> <a id="6177" class="Symbol">;</a> <a id="6179" href="Ledger.Conway.Conformance.Epoch.html#6179" class="Module">GState</a> <a id="6186" href="Ledger.Conway.Conformance.Certs.html#1018" class="Function">gState</a>
           <a id="6204" class="Symbol">;</a> <a id="6206" href="Ledger.Ratify.html#3156" class="Field">pools</a> <a id="6212" class="Symbol">=</a> <a id="6214" href="Ledger.Conway.Conformance.Certs.html#998" class="Function">pState</a> <a id="6221" class="Symbol">.</a><a id="6222" href="Ledger.Certs.html#2606" class="Field">pools</a> <a id="6228" class="Symbol">;</a> <a id="6230" href="Ledger.Ratify.html#3197" class="Field">delegatees</a> <a id="6241" class="Symbol">=</a> <a id="6243" href="Ledger.Conway.Conformance.Certs.html#978" class="Function">dState</a> <a id="6250" class="Symbol">.</a><a id="6251" href="Ledger.Conway.Conformance.Certs.html#603" class="Field">voteDelegs</a> <a id="6262" class="Symbol">}</a>
        <a id="6272" href="Ledger.Ratify.html#11866" class="Function Operator">⊢</a> <a id="6274" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="6276" href="Ledger.Conway.Conformance.Epoch.html#4814" class="Bound">es</a> <a id="6279" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6281" href="Class.HasEmptySet.html#287" class="Field">∅</a> <a id="6283" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6285" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a> <a id="6291" href="Class.To.html#102" class="Field Operator">⟧</a> <a id="6293" href="Ledger.Ratify.html#11866" class="Function Operator">⇀⦇</a> <a id="6296" href="Ledger.Conway.Conformance.Epoch.html#5120" class="Bound">govSt&#39;</a> <a id="6303" href="Ledger.Ratify.html#11866" class="Function Operator">,RATIFIES⦈</a> <a id="6314" href="Ledger.Conway.Conformance.Epoch.html#3649" class="Generalizable">fut&#39;</a>
      <a id="6325" class="Symbol">→</a> <a id="6327" href="Ledger.Conway.Conformance.Epoch.html#3700" class="Generalizable">ls</a> <a id="6330" href="Ledger.Conway.Conformance.Epoch.html#3902" class="Datatype Operator">⊢</a> <a id="6332" href="Ledger.Conway.Conformance.Epoch.html#3805" class="Generalizable">ss</a> <a id="6335" href="Ledger.Conway.Conformance.Epoch.html#3902" class="Datatype Operator">⇀⦇</a> <a id="6338" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="6341" href="Ledger.Conway.Conformance.Epoch.html#3902" class="Datatype Operator">,SNAP⦈</a> <a id="6348" href="Ledger.Conway.Conformance.Epoch.html#3808" class="Generalizable">ss&#39;</a>
    <a id="6356" href="Interface.STS.html#350" class="Function Operator">────────────────────────────────</a>
    <a id="6393" class="Symbol">_</a> <a id="6395" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">⊢</a> <a id="6397" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="6399" href="Ledger.Conway.Conformance.Epoch.html#3714" class="Generalizable">acnt</a> <a id="6404" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6406" href="Ledger.Conway.Conformance.Epoch.html#3805" class="Generalizable">ss</a> <a id="6409" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6411" href="Ledger.Conway.Conformance.Epoch.html#3700" class="Generalizable">ls</a> <a id="6414" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6416" href="Ledger.Conway.Conformance.Epoch.html#3728" class="Generalizable">es₀</a> <a id="6420" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6422" href="Ledger.Conway.Conformance.Epoch.html#3645" class="Generalizable">fut</a> <a id="6426" href="Class.To.html#102" class="Field Operator">⟧</a> <a id="6428" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">⇀⦇</a> <a id="6431" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="6433" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">,EPOCH⦈</a>
        <a id="6449" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="6451" href="Ledger.Conway.Conformance.Epoch.html#5841" class="Bound">acnt&#39;</a> <a id="6457" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6459" href="Ledger.Conway.Conformance.Epoch.html#3808" class="Generalizable">ss&#39;</a> <a id="6463" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6465" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="6467" href="Ledger.Conway.Conformance.Epoch.html#5726" class="Bound">utxoSt&#39;</a> <a id="6475" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6477" href="Ledger.Conway.Conformance.Epoch.html#5120" class="Bound">govSt&#39;</a> <a id="6484" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6486" href="Ledger.Conway.Conformance.Epoch.html#5611" class="Bound">certState&#39;</a> <a id="6497" href="Class.To.html#102" class="Field Operator">⟧</a> <a id="6499" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6501" href="Ledger.Conway.Conformance.Epoch.html#4814" class="Bound">es</a> <a id="6504" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6506" href="Ledger.Conway.Conformance.Epoch.html#3649" class="Generalizable">fut&#39;</a> <a id="6511" href="Class.To.html#102" class="Field Operator">⟧</a>

<a id="6514" class="Keyword">data</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_"></a><a id="6522" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">_⊢_⇀⦇_,NEWEPOCH⦈_</a> <a id="6540" class="Symbol">:</a> <a id="6542" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a> <a id="6544" class="Symbol">→</a> <a id="6546" href="Ledger.Conway.Conformance.Epoch.html#1287" class="Record">NewEpochState</a> <a id="6560" class="Symbol">→</a> <a id="6562" href="Ledger.Types.Epoch.html#476" class="Function">Epoch</a> <a id="6568" class="Symbol">→</a> <a id="6570" href="Ledger.Conway.Conformance.Epoch.html#1287" class="Record">NewEpochState</a> <a id="6584" class="Symbol">→</a> <a id="6586" href="Agda.Primitive.html#388" class="Primitive">Type</a>

  <a id="6594" class="Keyword">where</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-New"></a><a id="6603" href="Ledger.Conway.Conformance.Epoch.html#6603" class="InductiveConstructor">NEWEPOCH-New</a> <a id="6616" class="Symbol">:</a> <a id="6618" class="Keyword">let</a>
      <a id="6628" href="Ledger.Conway.Conformance.Epoch.html#6628" class="Bound">eps&#39;</a> <a id="6633" class="Symbol">=</a> <a id="6635" href="Ledger.Conway.Conformance.Epoch.html#2050" class="Function">applyRUpd</a> <a id="6645" href="Ledger.Conway.Conformance.Epoch.html#3826" class="Generalizable">ru</a> <a id="6648" href="Ledger.Conway.Conformance.Epoch.html#3670" class="Generalizable">eps</a>
    <a id="6656" class="Keyword">in</a>
    <a id="6663" href="Interface.STS.html#105" class="Function Operator">∙</a> <a id="6665" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="6667" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6669" href="Ledger.Conway.Conformance.Epoch.html#3625" class="Generalizable">lastEpoch</a> <a id="6679" href="Class.HasAdd.Core.html#136" class="Field Operator">+</a> <a id="6681" class="Number">1</a>
    <a id="6687" href="Interface.STS.html#131" class="Function Operator">∙</a> <a id="6689" class="Symbol">_</a> <a id="6691" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">⊢</a> <a id="6693" href="Ledger.Conway.Conformance.Epoch.html#6628" class="Bound">eps&#39;</a> <a id="6698" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">⇀⦇</a> <a id="6701" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="6703" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">,EPOCH⦈</a> <a id="6711" href="Ledger.Conway.Conformance.Epoch.html#3679" class="Generalizable">eps&#39;&#39;</a>
      <a id="6723" href="Interface.STS.html#350" class="Function Operator">────────────────────────────────</a>
      <a id="6762" class="Symbol">_</a> <a id="6764" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">⊢</a> <a id="6766" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="6768" href="Ledger.Conway.Conformance.Epoch.html#3625" class="Generalizable">lastEpoch</a> <a id="6778" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6780" href="Ledger.Conway.Conformance.Epoch.html#3670" class="Generalizable">eps</a> <a id="6784" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6786" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6791" href="Ledger.Conway.Conformance.Epoch.html#3826" class="Generalizable">ru</a> <a id="6794" href="Class.To.html#102" class="Field Operator">⟧</a> <a id="6796" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">⇀⦇</a> <a id="6799" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="6801" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="6812" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="6814" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="6816" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6818" href="Ledger.Conway.Conformance.Epoch.html#3679" class="Generalizable">eps&#39;&#39;</a> <a id="6824" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6826" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="6834" href="Class.To.html#102" class="Field Operator">⟧</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-Not-New"></a><a id="6839" href="Ledger.Conway.Conformance.Epoch.html#6839" class="InductiveConstructor">NEWEPOCH-Not-New</a> <a id="6856" class="Symbol">:</a>
    <a id="6862" href="Interface.STS.html#105" class="Function Operator">∙</a> <a id="6864" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="6866" href="Relation.Binary.PropositionalEquality.Core.html#858" class="Function Operator">≢</a> <a id="6868" href="Ledger.Conway.Conformance.Epoch.html#3625" class="Generalizable">lastEpoch</a> <a id="6878" href="Class.HasAdd.Core.html#136" class="Field Operator">+</a> <a id="6880" class="Number">1</a>
      <a id="6888" href="Interface.STS.html#350" class="Function Operator">────────────────────────────────</a>
      <a id="6927" class="Symbol">_</a> <a id="6929" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">⊢</a> <a id="6931" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="6933" href="Ledger.Conway.Conformance.Epoch.html#3625" class="Generalizable">lastEpoch</a> <a id="6943" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6945" href="Ledger.Conway.Conformance.Epoch.html#3670" class="Generalizable">eps</a> <a id="6949" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6951" href="Ledger.Conway.Conformance.Epoch.html#3846" class="Generalizable">mru</a> <a id="6955" href="Class.To.html#102" class="Field Operator">⟧</a> <a id="6957" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">⇀⦇</a> <a id="6960" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="6962" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="6973" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="6975" href="Ledger.Conway.Conformance.Epoch.html#3625" class="Generalizable">lastEpoch</a> <a id="6985" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6987" href="Ledger.Conway.Conformance.Epoch.html#3670" class="Generalizable">eps</a> <a id="6991" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6993" href="Ledger.Conway.Conformance.Epoch.html#3846" class="Generalizable">mru</a> <a id="6997" href="Class.To.html#102" class="Field Operator">⟧</a>

  <a id="_⊢_⇀⦇_,NEWEPOCH⦈_.NEWEPOCH-No-Reward-Update"></a><a id="7002" href="Ledger.Conway.Conformance.Epoch.html#7002" class="InductiveConstructor">NEWEPOCH-No-Reward-Update</a> <a id="7028" class="Symbol">:</a>
    <a id="7034" href="Interface.STS.html#105" class="Function Operator">∙</a> <a id="7036" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="7038" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7040" href="Ledger.Conway.Conformance.Epoch.html#3625" class="Generalizable">lastEpoch</a> <a id="7050" href="Class.HasAdd.Core.html#136" class="Field Operator">+</a> <a id="7052" class="Number">1</a>
    <a id="7058" href="Interface.STS.html#131" class="Function Operator">∙</a> <a id="7060" class="Symbol">_</a> <a id="7062" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">⊢</a> <a id="7064" href="Ledger.Conway.Conformance.Epoch.html#3670" class="Generalizable">eps</a> <a id="7068" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">⇀⦇</a> <a id="7071" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="7073" href="Ledger.Conway.Conformance.Epoch.html#4195" class="Datatype Operator">,EPOCH⦈</a> <a id="7081" href="Ledger.Conway.Conformance.Epoch.html#3674" class="Generalizable">eps&#39;</a>
      <a id="7092" href="Interface.STS.html#350" class="Function Operator">────────────────────────────────</a>
      <a id="7131" class="Symbol">_</a> <a id="7133" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">⊢</a> <a id="7135" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="7137" href="Ledger.Conway.Conformance.Epoch.html#3625" class="Generalizable">lastEpoch</a> <a id="7147" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7149" href="Ledger.Conway.Conformance.Epoch.html#3670" class="Generalizable">eps</a> <a id="7153" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7155" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="7163" href="Class.To.html#102" class="Field Operator">⟧</a> <a id="7165" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">⇀⦇</a> <a id="7168" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="7170" href="Ledger.Conway.Conformance.Epoch.html#6522" class="Datatype Operator">,NEWEPOCH⦈</a> <a id="7181" href="Class.To.html#102" class="Field Operator">⟦</a> <a id="7183" href="Ledger.Conway.Conformance.Epoch.html#3623" class="Generalizable">e</a> <a id="7185" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7187" href="Ledger.Conway.Conformance.Epoch.html#3674" class="Generalizable">eps&#39;</a> <a id="7192" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="7194" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="7202" href="Class.To.html#102" class="Field Operator">⟧</a>
</pre></body></html>