<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Crypto</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{Cryptographic Primitives}
</a><a id="36" class="Markup">\begin{code}[hide]</a>
<a id="55" class="Symbol">{-#</a> <a id="59" class="Keyword">OPTIONS</a> <a id="67" class="Pragma">--safe</a> <a id="74" class="Symbol">#-}</a>
<a id="78" class="Keyword">module</a> <a id="85" href="Ledger.Crypto.html" class="Module">Ledger.Crypto</a> <a id="99" class="Keyword">where</a>

<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="133" class="Keyword">hiding</a> <a id="140" class="Symbol">(</a><a id="141" href="Data.Bool.Base.html#1348" class="Function">T</a><a id="142" class="Symbol">)</a>

<a id="145" class="Keyword">record</a> <a id="isHashableSet"></a><a id="152" href="Ledger.Crypto.html#152" class="Record">isHashableSet</a> <a id="166" class="Symbol">(</a><a id="167" href="Ledger.Crypto.html#167" class="Bound">T</a> <a id="169" class="Symbol">:</a> <a id="171" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="175" class="Symbol">)</a> <a id="177" class="Symbol">:</a> <a id="179" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="185" class="Keyword">where</a>
  <a id="193" class="Keyword">constructor</a> <a id="mkIsHashableSet"></a><a id="205" href="Ledger.Crypto.html#205" class="InductiveConstructor">mkIsHashableSet</a>
  <a id="223" class="Keyword">field</a> <a id="isHashableSet.THash"></a><a id="229" href="Ledger.Crypto.html#229" class="Field">THash</a> <a id="235" class="Symbol">:</a> <a id="237" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="250" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-THash"></a><a id="252" href="Ledger.Crypto.html#252" class="Field">DecEq-THash</a> <a id="264" class="Symbol">⦄</a> <a id="266" class="Symbol">:</a> <a id="268" href="Class.DecEq.Core.html#117" class="Record">DecEq</a>      <a id="279" href="Ledger.Crypto.html#229" class="Field">THash</a>
        <a id="293" class="Symbol">⦃</a> <a id="isHashableSet.DecEq-T"></a><a id="295" href="Ledger.Crypto.html#295" class="Field">DecEq-T</a>     <a id="307" class="Symbol">⦄</a> <a id="309" class="Symbol">:</a> <a id="311" href="Class.DecEq.Core.html#117" class="Record">DecEq</a>    <a id="320" href="Ledger.Crypto.html#167" class="Bound">T</a>
        <a id="330" class="Symbol">⦃</a> <a id="isHashableSet.T-Hashable"></a><a id="332" href="Ledger.Crypto.html#332" class="Field">T-Hashable</a>  <a id="344" class="Symbol">⦄</a> <a id="346" class="Symbol">:</a> <a id="348" href="Interface.Hashable.html#209" class="Record">Hashable</a> <a id="357" href="Ledger.Crypto.html#167" class="Bound">T</a> <a id="359" href="Ledger.Crypto.html#229" class="Field">THash</a>
<a id="365" class="Keyword">open</a> <a id="370" href="Ledger.Crypto.html#152" class="Module">isHashableSet</a>

<a id="385" class="Keyword">record</a> <a id="HashableSet"></a><a id="392" href="Ledger.Crypto.html#392" class="Record">HashableSet</a> <a id="404" class="Symbol">:</a> <a id="406" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="412" class="Keyword">where</a>
  <a id="420" class="Keyword">constructor</a> <a id="mkHashableSet"></a><a id="432" href="Ledger.Crypto.html#432" class="InductiveConstructor">mkHashableSet</a>
  <a id="448" class="Keyword">field</a> <a id="HashableSet.T"></a><a id="454" href="Ledger.Crypto.html#454" class="Field">T</a> <a id="456" class="Symbol">:</a> <a id="458" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="462" class="Symbol">;</a> <a id="464" class="Symbol">⦃</a> <a id="HashableSet.T-isHashable"></a><a id="466" href="Ledger.Crypto.html#466" class="Field">T-isHashable</a> <a id="479" class="Symbol">⦄</a> <a id="481" class="Symbol">:</a> <a id="483" href="Ledger.Crypto.html#152" class="Record">isHashableSet</a> <a id="497" href="Ledger.Crypto.html#454" class="Field">T</a>
  <a id="501" class="Keyword">open</a> <a id="506" href="Ledger.Crypto.html#152" class="Module">isHashableSet</a> <a id="520" href="Ledger.Crypto.html#466" class="Field">T-isHashable</a> <a id="533" class="Keyword">public</a>

<a id="541" class="Keyword">record</a> <a id="PKKScheme"></a><a id="548" href="Ledger.Crypto.html#548" class="Record">PKKScheme</a> <a id="558" class="Symbol">:</a> <a id="560" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="566" class="Keyword">where</a>
  <a id="574" class="Keyword">field</a>
<a id="580" class="Markup">\end{code}</a><a id="590" class="Background">
We rely on a public key signing scheme for verification of spending.
\begin{figure*}[h]
\emph{Types \&amp; functions}
</a><a id="705" class="Markup">\begin{code}</a>
        <a id="PKKScheme.SKey"></a><a id="726" href="Ledger.Crypto.html#726" class="Field">SKey</a> <a id="PKKScheme.VKey"></a><a id="731" href="Ledger.Crypto.html#731" class="Field">VKey</a> <a id="PKKScheme.Sig"></a><a id="736" href="Ledger.Crypto.html#736" class="Field">Sig</a> <a id="PKKScheme.Ser"></a><a id="740" href="Ledger.Crypto.html#740" class="Field">Ser</a>  <a id="745" class="Symbol">:</a> <a id="747" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="PKKScheme.isKeyPair"></a><a id="760" href="Ledger.Crypto.html#760" class="Field">isKeyPair</a>          <a id="779" class="Symbol">:</a> <a id="781" href="Ledger.Crypto.html#726" class="Field">SKey</a> <a id="786" class="Symbol">→</a> <a id="788" href="Ledger.Crypto.html#731" class="Field">VKey</a> <a id="793" class="Symbol">→</a> <a id="795" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="PKKScheme.isSigned"></a><a id="808" href="Ledger.Crypto.html#808" class="Field">isSigned</a>           <a id="827" class="Symbol">:</a> <a id="829" href="Ledger.Crypto.html#731" class="Field">VKey</a> <a id="834" class="Symbol">→</a> <a id="836" href="Ledger.Crypto.html#740" class="Field">Ser</a> <a id="840" class="Symbol">→</a> <a id="842" href="Ledger.Crypto.html#736" class="Field">Sig</a> <a id="846" class="Symbol">→</a> <a id="848" href="Agda.Primitive.html#388" class="Primitive">Type</a>
        <a id="PKKScheme.sign"></a><a id="861" href="Ledger.Crypto.html#861" class="Field">sign</a>               <a id="880" class="Symbol">:</a> <a id="882" href="Ledger.Crypto.html#726" class="Field">SKey</a> <a id="887" class="Symbol">→</a> <a id="889" href="Ledger.Crypto.html#740" class="Field">Ser</a> <a id="893" class="Symbol">→</a> <a id="895" href="Ledger.Crypto.html#736" class="Field">Sig</a>

  <a id="PKKScheme.KeyPair"></a><a id="902" href="Ledger.Crypto.html#902" class="Function">KeyPair</a> <a id="910" class="Symbol">=</a> <a id="912" href="Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="915" href="Ledger.Crypto.html#915" class="Bound">sk</a> <a id="918" href="Data.Product.Base.html#1244" class="Function">∈</a> <a id="920" href="Ledger.Crypto.html#726" class="Field">SKey</a> <a id="925" href="Data.Product.Base.html#1244" class="Function">]</a> <a id="927" href="Data.Product.Base.html#1244" class="Function">Σ[</a> <a id="930" href="Ledger.Crypto.html#930" class="Bound">vk</a> <a id="933" href="Data.Product.Base.html#1244" class="Function">∈</a> <a id="935" href="Ledger.Crypto.html#731" class="Field">VKey</a> <a id="940" href="Data.Product.Base.html#1244" class="Function">]</a> <a id="942" href="Ledger.Crypto.html#760" class="Field">isKeyPair</a> <a id="952" href="Ledger.Crypto.html#915" class="Bound">sk</a> <a id="955" href="Ledger.Crypto.html#930" class="Bound">vk</a>
<a id="958" class="Markup">\end{code}</a><a id="968" class="Background">
\emph{Property of signatures}
</a><a id="999" class="Markup">\begin{code}[hide]</a>
  <a id="1020" class="Keyword">field</a> <a id="1026" class="Symbol">⦃</a> <a id="PKKScheme.Dec-isSigned"></a><a id="1028" href="Ledger.Crypto.html#1028" class="Field">Dec-isSigned</a> <a id="1041" class="Symbol">⦄</a> <a id="1043" class="Symbol">:</a> <a id="1045" href="Ledger.Crypto.html#808" class="Field">isSigned</a> <a id="1054" href="Class.Decidable.Core.html#784" class="Function Operator">⁇³</a>
        <a id="PKKScheme.isSigned-correct"></a><a id="1065" href="Ledger.Crypto.html#1065" class="Field">isSigned-correct</a> <a id="1082" class="Symbol">:</a>
<a id="1084" class="Markup">\end{code}</a><a id="1094" class="Background">
</a><a id="1095" class="Markup">\begin{code}</a>
          <a id="1118" class="Symbol">(</a><a id="1119" href="Ledger.Crypto.html#1119" class="Bound">(</a><a id="1120" href="Ledger.Crypto.html#1120" class="Bound">sk</a> <a id="1123" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1125" href="Ledger.Crypto.html#1125" class="Bound">vk</a> <a id="1128" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1130" href="Ledger.Crypto.html#1119" class="Bound">_)</a> <a id="1133" class="Symbol">:</a> <a id="1135" href="Ledger.Crypto.html#902" class="Function">KeyPair</a><a id="1142" class="Symbol">)</a> <a id="1144" class="Symbol">(</a><a id="1145" href="Ledger.Crypto.html#1145" class="Bound">d</a> <a id="1147" class="Symbol">:</a> <a id="1149" href="Ledger.Crypto.html#740" class="Field">Ser</a><a id="1152" class="Symbol">)</a> <a id="1154" class="Symbol">(</a><a id="1155" href="Ledger.Crypto.html#1155" class="Bound">σ</a> <a id="1157" class="Symbol">:</a> <a id="1159" href="Ledger.Crypto.html#736" class="Field">Sig</a><a id="1162" class="Symbol">)</a> <a id="1164" class="Symbol">→</a> <a id="1166" href="Ledger.Crypto.html#861" class="Field">sign</a> <a id="1171" href="Ledger.Crypto.html#1120" class="Bound">sk</a> <a id="1174" href="Ledger.Crypto.html#1145" class="Bound">d</a> <a id="1176" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1178" href="Ledger.Crypto.html#1155" class="Bound">σ</a> <a id="1180" class="Symbol">→</a> <a id="1182" href="Ledger.Crypto.html#808" class="Field">isSigned</a> <a id="1191" href="Ledger.Crypto.html#1125" class="Bound">vk</a> <a id="1194" href="Ledger.Crypto.html#1145" class="Bound">d</a> <a id="1196" href="Ledger.Crypto.html#1155" class="Bound">σ</a>
<a id="1198" class="Markup">\end{code}</a><a id="1208" class="Background">
\caption{Definitions for the public key signature scheme}
\label{fig:defs:crypto}
\end{figure*}
</a><a id="1305" class="Markup">\begin{code}[hide]</a>
        <a id="1332" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Sig"></a><a id="1334" href="Ledger.Crypto.html#1334" class="Field">DecEq-Sig</a>  <a id="1345" class="Symbol">⦄</a> <a id="1347" class="Symbol">:</a> <a id="1349" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1355" href="Ledger.Crypto.html#736" class="Field">Sig</a>
        <a id="1367" class="Symbol">⦃</a> <a id="PKKScheme.DecEq-Ser"></a><a id="1369" href="Ledger.Crypto.html#1369" class="Field">DecEq-Ser</a>  <a id="1380" class="Symbol">⦄</a> <a id="1382" class="Symbol">:</a> <a id="1384" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1390" href="Ledger.Crypto.html#740" class="Field">Ser</a>

<a id="1395" class="Keyword">record</a> <a id="Crypto"></a><a id="1402" href="Ledger.Crypto.html#1402" class="Record">Crypto</a> <a id="1409" class="Symbol">:</a> <a id="1411" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="1417" class="Keyword">where</a>
  <a id="1425" class="Keyword">field</a> <a id="Crypto.pkk"></a><a id="1431" href="Ledger.Crypto.html#1431" class="Field">pkk</a> <a id="1435" class="Symbol">:</a> <a id="1437" href="Ledger.Crypto.html#548" class="Record">PKKScheme</a>

  <a id="1450" class="Keyword">open</a> <a id="1455" href="Ledger.Crypto.html#548" class="Module">PKKScheme</a> <a id="1465" href="Ledger.Crypto.html#1431" class="Field">pkk</a> <a id="1469" class="Keyword">public</a>

  <a id="1479" class="Keyword">field</a> <a id="1485" class="Symbol">⦃</a> <a id="Crypto.khs"></a><a id="1487" href="Ledger.Crypto.html#1487" class="Field">khs</a> <a id="1491" class="Symbol">⦄</a>    <a id="1496" class="Symbol">:</a> <a id="1498" href="Ledger.Crypto.html#152" class="Record">isHashableSet</a> <a id="1512" href="Ledger.Crypto.html#731" class="Function">VKey</a>
        <a id="Crypto.ScriptHash"></a><a id="1525" href="Ledger.Crypto.html#1525" class="Field">ScriptHash</a> <a id="1536" class="Symbol">:</a> <a id="1538" href="Agda.Primitive.html#388" class="Primitive">Type</a><a id="1542" class="Symbol">;</a> <a id="1544" class="Symbol">⦃</a> <a id="Crypto.DecEq-ScriptHash"></a><a id="1546" href="Ledger.Crypto.html#1546" class="Field">DecEq-ScriptHash</a> <a id="1563" class="Symbol">⦄</a> <a id="1565" class="Symbol">:</a> <a id="1567" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="1573" href="Ledger.Crypto.html#1525" class="Field">ScriptHash</a>

  <a id="1587" class="Keyword">open</a> <a id="1592" href="Ledger.Crypto.html#152" class="Module">isHashableSet</a> <a id="1606" href="Ledger.Crypto.html#1487" class="Field">khs</a> <a id="1610" class="Keyword">renaming</a> <a id="1619" class="Symbol">(</a><a id="1620" href="Ledger.Crypto.html#229" class="Field">THash</a> <a id="1626" class="Symbol">to</a> <a id="1629" class="Field">KeyHash</a><a id="1636" class="Symbol">)</a> <a id="1638" class="Keyword">hiding</a> <a id="1645" class="Symbol">(</a><a id="1646" href="Ledger.Crypto.html#295" class="Field">DecEq-T</a><a id="1653" class="Symbol">)</a> <a id="1655" class="Keyword">public</a>

<a id="1663" class="Comment">-- TODO: KES and VRF</a>
<a id="1684" class="Markup">\end{code}</a><a id="1694" class="Background">
</a></pre></body></html>