<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Ledger.Transaction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Background">\section{Transactions}
\label{sec:transactions}

</a><a id="50" class="Markup">\begin{code}[hide]</a>
<a id="69" class="Symbol">{-#</a> <a id="73" class="Keyword">OPTIONS</a> <a id="81" class="Pragma">--safe</a> <a id="88" class="Symbol">#-}</a>
<a id="92" class="Comment">--------------------------------------------------------------------------------</a>
<a id="173" class="Comment">-- NOTE: Everything in this module is part of TransactionStructure</a>
<a id="240" class="Comment">--------------------------------------------------------------------------------</a>
<a id="321" class="Keyword">module</a> <a id="328" href="Ledger.Transaction.html" class="Module">Ledger.Transaction</a> <a id="347" class="Keyword">where</a>

<a id="354" class="Keyword">import</a> <a id="361" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="377" class="Symbol">as</a> <a id="380" class="Module">M</a>

<a id="383" class="Keyword">open</a> <a id="388" class="Keyword">import</a> <a id="395" href="Ledger.Prelude.html" class="Module">Ledger.Prelude</a> <a id="410" class="Keyword">renaming</a> <a id="419" class="Symbol">(</a><a id="420" href="Ledger.Set.Theory.html#2813" class="Function">filterᵐ</a> <a id="428" class="Symbol">to</a> <a id="431" class="Function">filter</a><a id="437" class="Symbol">)</a>

<a id="440" class="Keyword">open</a> <a id="445" class="Keyword">import</a> <a id="452" href="Ledger.Crypto.html" class="Module">Ledger.Crypto</a>
<a id="466" class="Keyword">open</a> <a id="471" class="Keyword">import</a> <a id="478" href="Ledger.Types.Epoch.html" class="Module">Ledger.Types.Epoch</a>
<a id="497" class="Keyword">open</a> <a id="502" class="Keyword">import</a> <a id="509" href="Ledger.Types.GovStructure.html" class="Module">Ledger.Types.GovStructure</a>
<a id="535" class="Keyword">import</a> <a id="542" href="Ledger.PParams.html" class="Module">Ledger.PParams</a>
<a id="557" class="Keyword">import</a> <a id="564" href="Ledger.Script.html" class="Module">Ledger.Script</a>
<a id="578" class="Keyword">import</a> <a id="585" href="Ledger.GovernanceActions.html" class="Module">Ledger.GovernanceActions</a>
<a id="610" class="Keyword">import</a> <a id="617" href="Ledger.Certs.html" class="Module">Ledger.Certs</a>
<a id="630" class="Keyword">import</a> <a id="637" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a>
<a id="657" class="Keyword">import</a> <a id="664" href="Ledger.Address.html" class="Module">Ledger.Address</a>


<a id="681" class="Keyword">open</a> <a id="686" class="Keyword">import</a> <a id="693" href="Tactic.Derive.DecEq.html" class="Module">Tactic.Derive.DecEq</a>
<a id="713" class="Keyword">open</a> <a id="718" class="Keyword">import</a> <a id="725" href="MyDebugOptions.html" class="Module">MyDebugOptions</a>
<a id="740" class="Keyword">open</a> <a id="745" class="Keyword">import</a> <a id="752" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="779" class="Keyword">using</a> <a id="785" class="Symbol">(</a><a id="786" href="Relation.Nullary.Decidable.Core.html#3623" class="Function Operator">⌊_⌋</a><a id="789" class="Symbol">)</a>

<a id="792" class="Keyword">data</a> <a id="Tag"></a><a id="797" href="Ledger.Transaction.html#797" class="Datatype">Tag</a> <a id="801" class="Symbol">:</a> <a id="803" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="808" class="Keyword">where</a>
  <a id="Tag.Spend"></a><a id="816" href="Ledger.Transaction.html#816" class="InductiveConstructor">Spend</a> <a id="Tag.Mint"></a><a id="822" href="Ledger.Transaction.html#822" class="InductiveConstructor">Mint</a> <a id="Tag.Cert"></a><a id="827" href="Ledger.Transaction.html#827" class="InductiveConstructor">Cert</a> <a id="Tag.Rewrd"></a><a id="832" href="Ledger.Transaction.html#832" class="InductiveConstructor">Rewrd</a> <a id="Tag.Vote"></a><a id="838" href="Ledger.Transaction.html#838" class="InductiveConstructor">Vote</a> <a id="Tag.Propose"></a><a id="843" href="Ledger.Transaction.html#843" class="InductiveConstructor">Propose</a> <a id="851" class="Symbol">:</a> <a id="853" href="Ledger.Transaction.html#797" class="Datatype">Tag</a>
<a id="857" class="Keyword">unquoteDecl</a> <a id="DecEq-Tag"></a><a id="869" href="Ledger.Transaction.html#869" class="Function">DecEq-Tag</a> <a id="879" class="Symbol">=</a> <a id="881" href="Tactic.Derive.DecEq.html#3506" class="Function">derive-DecEq</a> <a id="894" class="Symbol">((</a><a id="896" class="Keyword">quote</a> <a id="902" href="Ledger.Transaction.html#797" class="Datatype">Tag</a> <a id="906" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="908" href="Ledger.Transaction.html#869" class="Function">DecEq-Tag</a><a id="917" class="Symbol">)</a> <a id="919" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="921" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="923" class="Symbol">)</a>

<a id="926" class="Keyword">record</a> <a id="TransactionStructure"></a><a id="933" href="Ledger.Transaction.html#933" class="Record">TransactionStructure</a> <a id="954" class="Symbol">:</a> <a id="956" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="962" class="Keyword">where</a>
  <a id="970" class="Keyword">field</a>
<a id="976" class="Markup">\end{code}</a><a id="986" class="Background">

Transactions are defined in Figure~\ref{fig:defs:transactions}. A
transaction is made up of a transaction body, a collection of
witnesses and some optional auxiliary data.
\begin{NoConway}
Some key ingredients in the transaction body are:
\begin{itemize}
  \item A set \txins of transaction inputs, each of which identifies an output from a previous transaction.
    A transaction input consists of a transaction id and an index to uniquely identify the output.
  \item An indexed collection \txouts of transaction outputs.
    The \TxOut type is an address paired with a coin value.
  \item A transaction fee. This value will be added to the fee pot.
  \item The size \txsize and the hash \txid of the serialized form of the transaction that was included in the block.
\end{itemize}
\end{NoConway}
\begin{Conway}
Ingredients of the transaction body introduced in the Conway era are the following:
\begin{itemize}
  \item \txvote, the list of votes for goverance actions;
  \item \txprop, the list of governance proposals;
  \item \txdonation, the treasury donation amount;
  \item \curTreasury, the current value of the treasury.
  \item \txsize and \txid, the size and hash of the serialized form of the transaction that was included in the block.
\end{itemize}
\end{Conway}

\begin{figure*}[h]
\emph{Abstract types}
\begin{AgdaMultiCode}
</a><a id="2329" class="Markup">\begin{code}</a>
        <a id="TransactionStructure.Ix"></a><a id="2350" href="Ledger.Transaction.html#2350" class="Field">Ix</a> <a id="TransactionStructure.TxId"></a><a id="2353" href="Ledger.Transaction.html#2353" class="Field">TxId</a> <a id="TransactionStructure.AuxiliaryData"></a><a id="2358" href="Ledger.Transaction.html#2358" class="Field">AuxiliaryData</a> <a id="2372" class="Symbol">:</a> <a id="2374" href="Agda.Primitive.html#388" class="Primitive">Type</a>
<a id="2379" class="Markup">\end{code}</a><a id="2389" class="Background">
</a><a id="2390" class="Markup">\begin{code}[hide]</a>
        <a id="2417" class="Symbol">⦃</a> <a id="TransactionStructure.DecEq-Ix"></a><a id="2419" href="Ledger.Transaction.html#2419" class="Field">DecEq-Ix</a>   <a id="2430" class="Symbol">⦄</a> <a id="2432" class="Symbol">:</a> <a id="2434" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="2440" href="Ledger.Transaction.html#2350" class="Field">Ix</a>
        <a id="2451" class="Symbol">⦃</a> <a id="TransactionStructure.DecEq-TxId"></a><a id="2453" href="Ledger.Transaction.html#2453" class="Field">DecEq-TxId</a> <a id="2464" class="Symbol">⦄</a> <a id="2466" class="Symbol">:</a> <a id="2468" href="Class.DecEq.Core.html#117" class="Record">DecEq</a> <a id="2474" href="Ledger.Transaction.html#2353" class="Field">TxId</a>
        <a id="TransactionStructure.adHashingScheme"></a><a id="2487" href="Ledger.Transaction.html#2487" class="Field">adHashingScheme</a> <a id="2503" class="Symbol">:</a> <a id="2505" href="Ledger.Crypto.html#152" class="Record">isHashableSet</a> <a id="2519" href="Ledger.Transaction.html#2358" class="Field">AuxiliaryData</a>
  <a id="2535" class="Keyword">open</a> <a id="2540" href="Ledger.Crypto.html#152" class="Module">isHashableSet</a> <a id="2554" href="Ledger.Transaction.html#2487" class="Field">adHashingScheme</a> <a id="2570" class="Keyword">renaming</a> <a id="2579" class="Symbol">(</a><a id="2580" href="Ledger.Crypto.html#229" class="Field">THash</a> <a id="2586" class="Symbol">to</a> <a id="2589" class="Field">ADHash</a><a id="2595" class="Symbol">)</a> <a id="2597" class="Keyword">public</a>

  <a id="2607" class="Keyword">field</a> <a id="TransactionStructure.globalConstants"></a><a id="2613" href="Ledger.Transaction.html#2613" class="Field">globalConstants</a> <a id="2629" class="Symbol">:</a> <a id="2631" class="Symbol">_</a>
  <a id="2635" class="Keyword">open</a> <a id="2640" href="Ledger.Types.Epoch.html#1666" class="Module">GlobalConstants</a> <a id="2656" href="Ledger.Transaction.html#2613" class="Field">globalConstants</a> <a id="2672" class="Keyword">public</a>

  <a id="2682" class="Keyword">field</a> <a id="TransactionStructure.crypto"></a><a id="2688" href="Ledger.Transaction.html#2688" class="Field">crypto</a> <a id="2695" class="Symbol">:</a> <a id="2697" class="Symbol">_</a>
  <a id="2701" class="Keyword">open</a> <a id="2706" href="Ledger.Crypto.html#1402" class="Module">Crypto</a> <a id="2713" href="Ledger.Transaction.html#2688" class="Field">crypto</a> <a id="2720" class="Keyword">public</a>
  <a id="2729" class="Keyword">open</a> <a id="2734" href="Ledger.TokenAlgebra.html" class="Module">Ledger.TokenAlgebra</a> <a id="2754" href="Ledger.Crypto.html#1525" class="Function">ScriptHash</a> <a id="2765" class="Keyword">public</a>
  <a id="2774" class="Keyword">open</a> <a id="2779" href="Ledger.Address.html" class="Module">Ledger.Address</a> <a id="2794" href="Ledger.Types.Epoch.html#1705" class="Function">Network</a> <a id="2802" href="Ledger.Crypto.html#1629" class="Function">KeyHash</a> <a id="2810" href="Ledger.Crypto.html#1525" class="Function">ScriptHash</a> <a id="2821" class="Symbol">⦃</a> <a id="2823" href="Function.Base.html#4736" class="Function">it</a> <a id="2826" class="Symbol">⦄</a> <a id="2828" class="Symbol">⦃</a> <a id="2830" href="Function.Base.html#4736" class="Function">it</a> <a id="2833" class="Symbol">⦄</a> <a id="2835" class="Symbol">⦃</a> <a id="2837" href="Function.Base.html#4736" class="Function">it</a> <a id="2840" class="Symbol">⦄</a> <a id="2842" class="Keyword">public</a>

  <a id="2852" class="Keyword">field</a> <a id="TransactionStructure.epochStructure"></a><a id="2858" href="Ledger.Transaction.html#2858" class="Field">epochStructure</a> <a id="2873" class="Symbol">:</a> <a id="2875" class="Symbol">_</a>
  <a id="2879" class="Keyword">open</a> <a id="2884" href="Ledger.Types.Epoch.html#267" class="Module">EpochStructure</a> <a id="2899" href="Ledger.Transaction.html#2858" class="Field">epochStructure</a> <a id="2914" class="Keyword">public</a>
  <a id="2923" class="Keyword">open</a> <a id="2928" href="Ledger.Script.html" class="Module">Ledger.Script</a> <a id="2942" href="Ledger.Transaction.html#2688" class="Field">crypto</a> <a id="2949" href="Ledger.Transaction.html#2858" class="Field">epochStructure</a> <a id="2964" class="Keyword">public</a>

  <a id="2974" class="Keyword">field</a> <a id="TransactionStructure.scriptStructure"></a><a id="2980" href="Ledger.Transaction.html#2980" class="Field">scriptStructure</a> <a id="2996" class="Symbol">:</a> <a id="2998" class="Symbol">_</a>
  <a id="3002" class="Keyword">open</a> <a id="3007" href="Ledger.Script.html#5546" class="Module">ScriptStructure</a> <a id="3023" href="Ledger.Transaction.html#2980" class="Field">scriptStructure</a> <a id="3039" class="Keyword">public</a>
  <a id="3048" class="Keyword">open</a> <a id="3053" href="Ledger.PParams.html" class="Module">Ledger.PParams</a> <a id="3068" href="Ledger.Transaction.html#2688" class="Field">crypto</a> <a id="3075" href="Ledger.Transaction.html#2858" class="Field">epochStructure</a> <a id="3090" href="Ledger.Transaction.html#2980" class="Field">scriptStructure</a> <a id="3106" class="Keyword">public</a>

  <a id="3116" class="Keyword">field</a> <a id="TransactionStructure.govParams"></a><a id="3122" href="Ledger.Transaction.html#3122" class="Field">govParams</a> <a id="3132" class="Symbol">:</a> <a id="3134" class="Symbol">_</a>
  <a id="3138" class="Keyword">open</a> <a id="3143" href="Ledger.PParams.html#15283" class="Module">GovParams</a> <a id="3153" href="Ledger.Transaction.html#3122" class="Field">govParams</a> <a id="3163" class="Keyword">public</a>

  <a id="3173" class="Keyword">field</a> <a id="TransactionStructure.tokenAlgebra"></a><a id="3179" href="Ledger.Transaction.html#3179" class="Field">tokenAlgebra</a> <a id="3192" class="Symbol">:</a> <a id="3194" href="Ledger.TokenAlgebra.html#723" class="Record">TokenAlgebra</a>
  <a id="3209" class="Keyword">open</a> <a id="3214" href="Ledger.TokenAlgebra.html#723" class="Module">TokenAlgebra</a> <a id="3227" href="Ledger.Transaction.html#3179" class="Field">tokenAlgebra</a> <a id="3240" class="Keyword">public</a>

  <a id="3250" class="Keyword">field</a> <a id="TransactionStructure.txidBytes"></a><a id="3256" href="Ledger.Transaction.html#3256" class="Field">txidBytes</a> <a id="3266" class="Symbol">:</a> <a id="3268" href="Ledger.Transaction.html#2353" class="Field">TxId</a> <a id="3273" class="Symbol">→</a> <a id="3275" href="Ledger.Crypto.html#740" class="Function">Ser</a>
        <a id="TransactionStructure.networkId"></a><a id="3287" href="Ledger.Transaction.html#3287" class="Field">networkId</a> <a id="3297" class="Symbol">:</a> <a id="3299" href="Ledger.Types.Epoch.html#1705" class="Function">Network</a>

  <a id="TransactionStructure.govStructure"></a><a id="3310" href="Ledger.Transaction.html#3310" class="Function">govStructure</a> <a id="3323" class="Symbol">:</a> <a id="3325" href="Ledger.Types.GovStructure.html#235" class="Record">GovStructure</a>
  <a id="3340" href="Ledger.Transaction.html#3310" class="Function">govStructure</a> <a id="3353" class="Symbol">=</a> <a id="3355" class="Keyword">record</a>
    <a id="3366" class="Comment">-- TODO: figure out what to do with the hash</a>
    <a id="3415" class="Symbol">{</a> <a id="3417" href="Ledger.Types.GovStructure.html#270" class="Field">TxId</a> <a id="3422" class="Symbol">=</a> <a id="3424" href="Ledger.Transaction.html#2353" class="Field">TxId</a><a id="3428" class="Symbol">;</a> <a id="3430" href="Ledger.Types.GovStructure.html#275" class="Field">DocHash</a> <a id="3438" class="Symbol">=</a> <a id="3440" href="Ledger.Transaction.html#2589" class="Function">ADHash</a>
    <a id="3451" class="Symbol">;</a> <a id="3453" href="Ledger.Types.GovStructure.html#335" class="Field">crypto</a> <a id="3460" class="Symbol">=</a> <a id="3462" href="Ledger.Transaction.html#2688" class="Field">crypto</a>
    <a id="3473" class="Symbol">;</a> <a id="3475" href="Ledger.Types.GovStructure.html#383" class="Field">epochStructure</a> <a id="3490" class="Symbol">=</a> <a id="3492" href="Ledger.Transaction.html#2858" class="Field">epochStructure</a>
    <a id="3511" class="Symbol">;</a> <a id="3513" href="Ledger.Types.GovStructure.html#455" class="Field">scriptStructure</a> <a id="3529" class="Symbol">=</a> <a id="3531" href="Ledger.Transaction.html#2980" class="Field">scriptStructure</a>
    <a id="3551" class="Symbol">;</a> <a id="3553" href="Ledger.Types.GovStructure.html#634" class="Field">govParams</a> <a id="3563" class="Symbol">=</a> <a id="3565" href="Ledger.Transaction.html#3122" class="Field">govParams</a>
    <a id="3579" class="Symbol">;</a> <a id="3581" href="Ledger.Types.GovStructure.html#699" class="Field">globalConstants</a> <a id="3597" class="Symbol">=</a> <a id="3599" href="Ledger.Transaction.html#2613" class="Field">globalConstants</a>
    <a id="3619" class="Symbol">}</a>

  <a id="3624" class="Keyword">open</a> <a id="3629" href="Ledger.GovernanceActions.html" class="Module">Ledger.GovernanceActions</a> <a id="3654" href="Ledger.Transaction.html#3310" class="Function">govStructure</a> <a id="3667" class="Keyword">hiding</a> <a id="3674" class="Symbol">(</a><a id="3675" href="Ledger.GovernanceActions.html#8237" class="Datatype">Vote</a><a id="3679" class="Symbol">;</a> <a id="3681" href="Ledger.GovernanceActions.html#8257" class="InductiveConstructor">yes</a><a id="3684" class="Symbol">;</a> <a id="3686" href="Ledger.GovernanceActions.html#8261" class="InductiveConstructor">no</a><a id="3688" class="Symbol">;</a> <a id="3690" href="Ledger.GovernanceActions.html#8264" class="InductiveConstructor">abstain</a><a id="3697" class="Symbol">)</a> <a id="3699" class="Keyword">public</a>
  <a id="3708" class="Keyword">open</a> <a id="3713" href="Ledger.Certs.html" class="Module">Ledger.Certs</a>             <a id="3738" href="Ledger.Transaction.html#3310" class="Function">govStructure</a> <a id="3751" class="Keyword">public</a>
<a id="3758" class="Markup">\end{code}</a><a id="3768" class="Background">
\begin{NoConway}
\emph{Derived types}
</a><a id="3807" class="Markup">\begin{code}</a>
  <a id="TransactionStructure.TxIn"></a><a id="3822" href="Ledger.Transaction.html#3822" class="Function">TxIn</a>     <a id="3831" class="Symbol">=</a> <a id="3833" href="Ledger.Transaction.html#2353" class="Field">TxId</a> <a id="3838" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3840" href="Ledger.Transaction.html#2350" class="Field">Ix</a>
  <a id="TransactionStructure.TxOut"></a><a id="3845" href="Ledger.Transaction.html#3845" class="Function">TxOut</a>    <a id="3854" class="Symbol">=</a> <a id="3856" href="Ledger.Address.html#2070" class="Function">Addr</a> <a id="3861" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3863" href="Ledger.TokenAlgebra.html#816" class="Function">Value</a> <a id="3869" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3871" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3877" class="Symbol">(</a><a id="3878" href="Ledger.Script.html#1714" class="Function">Datum</a> <a id="3884" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="3886" href="Ledger.Script.html#1667" class="Function">DataHash</a><a id="3894" class="Symbol">)</a> <a id="3896" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3898" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="3904" href="Ledger.Script.html#6019" class="Function">Script</a>
  <a id="TransactionStructure.UTxO"></a><a id="3913" href="Ledger.Transaction.html#3913" class="Function">UTxO</a>     <a id="3922" class="Symbol">=</a> <a id="3924" href="Ledger.Transaction.html#3822" class="Function">TxIn</a> <a id="3929" href="Ledger.Set.Theory.html#1515" class="Function Operator">⇀</a> <a id="3931" href="Ledger.Transaction.html#3845" class="Function">TxOut</a>
  <a id="TransactionStructure.Wdrl"></a><a id="3939" href="Ledger.Transaction.html#3939" class="Function">Wdrl</a>     <a id="3948" class="Symbol">=</a> <a id="3950" href="Ledger.Address.html#1583" class="Record">RwdAddr</a> <a id="3958" href="Ledger.Set.Theory.html#1515" class="Function Operator">⇀</a> <a id="3960" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
  <a id="TransactionStructure.RdmrPtr"></a><a id="3967" href="Ledger.Transaction.html#3967" class="Function">RdmrPtr</a>  <a id="3976" class="Symbol">=</a> <a id="3978" href="Ledger.Transaction.html#797" class="Datatype">Tag</a> <a id="3982" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="3984" href="Ledger.Transaction.html#2350" class="Field">Ix</a>

  <a id="TransactionStructure.ProposedPPUpdates"></a><a id="3990" href="Ledger.Transaction.html#3990" class="Function">ProposedPPUpdates</a>  <a id="4009" class="Symbol">=</a> <a id="4011" href="Ledger.Crypto.html#1629" class="Function">KeyHash</a> <a id="4019" href="Ledger.Set.Theory.html#1515" class="Function Operator">⇀</a> <a id="4021" href="Ledger.PParams.html#15381" class="Function">PParamsUpdate</a>
  <a id="TransactionStructure.Update"></a><a id="4037" href="Ledger.Transaction.html#4037" class="Function">Update</a>             <a id="4056" class="Symbol">=</a> <a id="4058" href="Ledger.Transaction.html#3990" class="Function">ProposedPPUpdates</a> <a id="4076" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4078" href="Ledger.Types.Epoch.html#335" class="Function">Epoch</a>
<a id="4084" class="Markup">\end{code}</a><a id="4094" class="Background">
\end{NoConway}
\emph{Transaction types}
</a><a id="4135" class="Markup">\begin{code}</a>
  <a id="4150" class="Keyword">record</a> <a id="TransactionStructure.TxBody"></a><a id="4157" href="Ledger.Transaction.html#4157" class="Record">TxBody</a> <a id="4164" class="Symbol">:</a> <a id="4166" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4171" class="Keyword">where</a>
<a id="4177" class="Markup">\end{code}</a><a id="4187" class="Background">
</a><a id="4188" class="Markup">\begin{code}[hide]</a>
    <a id="4211" class="Keyword">field</a>
<a id="4217" class="Markup">\end{code}</a><a id="4227" class="Background">
</a><a id="4228" class="Markup">\begin{code}</a>
      <a id="4247" href="Ledger.Transaction.html#4247" class="Field">txins</a>          <a id="4262" class="Symbol">:</a> <a id="4264" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="4266" href="Ledger.Transaction.html#3822" class="Function">TxIn</a>
      <a id="4277" href="Ledger.Transaction.html#4277" class="Field">refInputs</a>      <a id="4292" class="Symbol">:</a> <a id="4294" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="4296" href="Ledger.Transaction.html#3822" class="Function">TxIn</a>
      <a id="4307" href="Ledger.Transaction.html#4307" class="Field">txouts</a>         <a id="4322" class="Symbol">:</a> <a id="4324" href="Ledger.Transaction.html#2350" class="Field">Ix</a> <a id="4327" href="Ledger.Set.Theory.html#1515" class="Function Operator">⇀</a> <a id="4329" href="Ledger.Transaction.html#3845" class="Function">TxOut</a>
      <a id="4341" href="Ledger.Transaction.html#4341" class="Field">txfee</a>          <a id="4356" class="Symbol">:</a> <a id="4358" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
      <a id="4369" href="Ledger.Transaction.html#4369" class="Field">mint</a>           <a id="4384" class="Symbol">:</a> <a id="4386" href="Ledger.TokenAlgebra.html#816" class="Function">Value</a>
      <a id="4398" href="Ledger.Transaction.html#4398" class="Field">txvldt</a>         <a id="4413" class="Symbol">:</a> <a id="4415" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4421" href="Ledger.Types.Epoch.html#382" class="Function">Slot</a> <a id="4426" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="4428" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4434" href="Ledger.Types.Epoch.html#382" class="Function">Slot</a>
      <a id="4445" href="Ledger.Transaction.html#4445" class="Field">txcerts</a>        <a id="4460" class="Symbol">:</a> <a id="4462" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4467" href="Ledger.Certs.html#1056" class="Datatype">DCert</a>
      <a id="4479" href="Ledger.Transaction.html#4479" class="Field">txwdrls</a>        <a id="4494" class="Symbol">:</a> <a id="4496" href="Ledger.Transaction.html#3939" class="Function">Wdrl</a>
      <a id="4507" href="Ledger.Transaction.html#4507" class="Field">txvote</a>         <a id="4522" class="Symbol">:</a> <a id="4524" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4529" href="Ledger.GovernanceActions.html#8288" class="Record">GovVote</a>
      <a id="4543" href="Ledger.Transaction.html#4543" class="Field">txprop</a>         <a id="4558" class="Symbol">:</a> <a id="4560" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="4565" href="Ledger.GovernanceActions.html#8487" class="Record">GovProposal</a>
      <a id="4583" href="Ledger.Transaction.html#4583" class="Field">txdonation</a>     <a id="4598" class="Symbol">:</a> <a id="4600" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
      <a id="4611" href="Ledger.Transaction.html#4611" class="Field">txup</a>           <a id="4626" class="Symbol">:</a> <a id="4628" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4634" href="Ledger.Transaction.html#4037" class="Function">Update</a>
      <a id="4647" href="Ledger.Transaction.html#4647" class="Field">txADhash</a>       <a id="4662" class="Symbol">:</a> <a id="4664" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4670" href="Ledger.Transaction.html#2589" class="Function">ADHash</a>
      <a id="4683" href="Ledger.Transaction.html#4683" class="Field">txNetworkId</a>    <a id="4698" class="Symbol">:</a> <a id="4700" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4706" href="Ledger.Types.Epoch.html#1705" class="Function">Network</a>
      <a id="4720" href="Ledger.Transaction.html#4720" class="Field">curTreasury</a>    <a id="4735" class="Symbol">:</a> <a id="4737" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4743" href="Ledger.Prelude.Base.html#81" class="Function">Coin</a>
      <a id="4754" href="Ledger.Transaction.html#4754" class="Field">txsize</a>         <a id="4769" class="Symbol">:</a> <a id="4771" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
      <a id="4779" href="Ledger.Transaction.html#4779" class="Field">txid</a>           <a id="4794" class="Symbol">:</a> <a id="4796" href="Ledger.Transaction.html#2353" class="Field">TxId</a>
      <a id="4807" href="Ledger.Transaction.html#4807" class="Field">collateral</a>     <a id="4822" class="Symbol">:</a> <a id="4824" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="4826" href="Ledger.Transaction.html#3822" class="Function">TxIn</a>
      <a id="4837" href="Ledger.Transaction.html#4837" class="Field">reqSigHash</a>     <a id="4852" class="Symbol">:</a> <a id="4854" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="4856" href="Ledger.Crypto.html#1629" class="Function">KeyHash</a>
      <a id="4870" href="Ledger.Transaction.html#4870" class="Field">scriptIntHash</a>  <a id="4885" class="Symbol">:</a> <a id="4887" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="4893" href="Ledger.Crypto.html#1525" class="Function">ScriptHash</a>
<a id="4904" class="Markup">\end{code}</a><a id="4914" class="Background">
\begin{NoConway}
</a><a id="4932" class="Markup">\begin{code}</a>
  <a id="4947" class="Keyword">record</a> <a id="TransactionStructure.TxWitnesses"></a><a id="4954" href="Ledger.Transaction.html#4954" class="Record">TxWitnesses</a> <a id="4966" class="Symbol">:</a> <a id="4968" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="4973" class="Keyword">where</a>
<a id="4979" class="Markup">\end{code}</a><a id="4989" class="Background">
</a><a id="4990" class="Markup">\begin{code}[hide]</a>
    <a id="5013" class="Keyword">field</a>
<a id="5019" class="Markup">\end{code}</a><a id="5029" class="Background">
</a><a id="5030" class="Markup">\begin{code}</a>
      <a id="5049" href="Ledger.Transaction.html#5049" class="Field">vkSigs</a>   <a id="5058" class="Symbol">:</a> <a id="5060" href="Ledger.Crypto.html#731" class="Function">VKey</a> <a id="5065" href="Ledger.Set.Theory.html#1515" class="Function Operator">⇀</a> <a id="5067" href="Ledger.Crypto.html#736" class="Function">Sig</a>
      <a id="5077" href="Ledger.Transaction.html#5077" class="Field">scripts</a>  <a id="5086" class="Symbol">:</a> <a id="5088" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="5090" href="Ledger.Script.html#6019" class="Function">Script</a>
      <a id="5103" href="Ledger.Transaction.html#5103" class="Field">txdats</a>   <a id="5112" class="Symbol">:</a> <a id="5114" href="Ledger.Script.html#1667" class="Function">DataHash</a> <a id="5123" href="Ledger.Set.Theory.html#1515" class="Function Operator">⇀</a> <a id="5125" href="Ledger.Script.html#1714" class="Function">Datum</a>
      <a id="5137" href="Ledger.Transaction.html#5137" class="Field">txrdmrs</a>  <a id="5146" class="Symbol">:</a> <a id="5148" href="Ledger.Transaction.html#3967" class="Function">RdmrPtr</a>  <a id="5157" href="Ledger.Set.Theory.html#1515" class="Function Operator">⇀</a> <a id="5159" href="Ledger.Script.html#1732" class="Function">Redeemer</a> <a id="5168" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5170" href="Ledger.Script.html#1096" class="Function">ExUnits</a>

    <a id="TransactionStructure.TxWitnesses.scriptsP1"></a><a id="5183" href="Ledger.Transaction.html#5183" class="Function">scriptsP1</a> <a id="5193" class="Symbol">:</a> <a id="5195" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="5197" href="Ledger.Script.html#720" class="Function">P1Script</a>
    <a id="5210" href="Ledger.Transaction.html#5183" class="Function">scriptsP1</a> <a id="5220" class="Symbol">=</a> <a id="5222" href="Axiom.Set.html#7518" class="Function">mapPartial</a> <a id="5233" href="Data.Sum.html#973" class="Function">isInj₁</a> <a id="5240" href="Ledger.Transaction.html#5077" class="Field">scripts</a>

  <a id="5251" class="Keyword">record</a> <a id="TransactionStructure.Tx"></a><a id="5258" href="Ledger.Transaction.html#5258" class="Record">Tx</a> <a id="5261" class="Symbol">:</a> <a id="5263" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="5268" class="Keyword">where</a>
<a id="5274" class="Markup">\end{code}</a><a id="5284" class="Background">
</a><a id="5285" class="Markup">\begin{code}[hide]</a>
    <a id="5308" class="Keyword">field</a>
<a id="5314" class="Markup">\end{code}</a><a id="5324" class="Background">
</a><a id="5325" class="Markup">\begin{code}</a>
      <a id="5344" href="Ledger.Transaction.html#5344" class="Field">body</a>     <a id="5353" class="Symbol">:</a> <a id="5355" href="Ledger.Transaction.html#4157" class="Record">TxBody</a>
      <a id="5368" href="Ledger.Transaction.html#5368" class="Field">wits</a>     <a id="5377" class="Symbol">:</a> <a id="5379" href="Ledger.Transaction.html#4954" class="Record">TxWitnesses</a>
      <a id="5397" href="Ledger.Transaction.html#5397" class="Field">isValid</a>  <a id="5406" class="Symbol">:</a> <a id="5408" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
      <a id="5419" href="Ledger.Transaction.html#5419" class="Field">txAD</a>     <a id="5428" class="Symbol">:</a> <a id="5430" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5436" href="Ledger.Transaction.html#2358" class="Field">AuxiliaryData</a>
<a id="5450" class="Markup">\end{code}</a><a id="5460" class="Background">
\end{NoConway}
\end{AgdaMultiCode}
\caption{Transactions and related types}
\label{fig:defs:transactions}
\end{figure*}

\begin{NoConway}
\begin{figure*}[h]
\begin{AgdaMultiCode}
</a><a id="5640" class="Markup">\begin{code}</a>
  <a id="TransactionStructure.getValue"></a><a id="5655" href="Ledger.Transaction.html#5655" class="Function">getValue</a> <a id="5664" class="Symbol">:</a> <a id="5666" href="Ledger.Transaction.html#3845" class="Function">TxOut</a> <a id="5672" class="Symbol">→</a> <a id="5674" href="Ledger.TokenAlgebra.html#816" class="Function">Value</a>
  <a id="5682" href="Ledger.Transaction.html#5655" class="Function">getValue</a> <a id="5691" class="Symbol">(_</a> <a id="5694" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5696" href="Ledger.Transaction.html#5696" class="Bound">v</a> <a id="5698" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5700" class="Symbol">_)</a> <a id="5703" class="Symbol">=</a> <a id="5705" href="Ledger.Transaction.html#5696" class="Bound">v</a>

  <a id="TransactionStructure.TxOutʰ"></a><a id="5710" href="Ledger.Transaction.html#5710" class="Function">TxOutʰ</a> <a id="5717" class="Symbol">=</a> <a id="5719" href="Ledger.Address.html#2070" class="Function">Addr</a> <a id="5724" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5726" href="Ledger.TokenAlgebra.html#816" class="Function">Value</a> <a id="5732" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5734" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5740" class="Symbol">(</a><a id="5741" href="Ledger.Script.html#1714" class="Function">Datum</a> <a id="5747" href="Data.Sum.Base.html#625" class="Datatype Operator">⊎</a> <a id="5749" href="Ledger.Script.html#1667" class="Function">DataHash</a><a id="5757" class="Symbol">)</a> <a id="5759" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="5761" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="5767" href="Ledger.Crypto.html#1525" class="Function">ScriptHash</a>

  <a id="TransactionStructure.txOutHash"></a><a id="5781" href="Ledger.Transaction.html#5781" class="Function">txOutHash</a> <a id="5791" class="Symbol">:</a> <a id="5793" href="Ledger.Transaction.html#3845" class="Function">TxOut</a> <a id="5799" class="Symbol">→</a> <a id="5801" href="Ledger.Transaction.html#5710" class="Function">TxOutʰ</a>
  <a id="5810" href="Ledger.Transaction.html#5781" class="Function">txOutHash</a> <a id="5820" class="Symbol">(</a><a id="5821" href="Ledger.Transaction.html#5821" class="Bound">a</a> <a id="5823" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5825" href="Ledger.Transaction.html#5825" class="Bound">v</a> <a id="5827" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5829" href="Ledger.Transaction.html#5829" class="Bound">d</a> <a id="5831" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5833" href="Ledger.Transaction.html#5833" class="Bound">s</a><a id="5834" class="Symbol">)</a> <a id="5836" class="Symbol">=</a> <a id="5838" href="Ledger.Transaction.html#5821" class="Bound">a</a> <a id="5840" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5842" class="Symbol">(</a><a id="5843" href="Ledger.Transaction.html#5825" class="Bound">v</a> <a id="5845" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5847" class="Symbol">(</a><a id="5848" href="Ledger.Transaction.html#5829" class="Bound">d</a> <a id="5850" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5852" href="Data.Maybe.Base.html#2049" class="Function">M.map</a> <a id="5858" href="Interface.Hashable.html#256" class="Field">hash</a> <a id="5863" href="Ledger.Transaction.html#5833" class="Bound">s</a><a id="5864" class="Symbol">))</a>

  <a id="TransactionStructure.getValueʰ"></a><a id="5870" href="Ledger.Transaction.html#5870" class="Function">getValueʰ</a> <a id="5880" class="Symbol">:</a> <a id="5882" href="Ledger.Transaction.html#5710" class="Function">TxOutʰ</a> <a id="5889" class="Symbol">→</a> <a id="5891" href="Ledger.TokenAlgebra.html#816" class="Function">Value</a>
  <a id="5899" href="Ledger.Transaction.html#5870" class="Function">getValueʰ</a> <a id="5909" class="Symbol">(_</a> <a id="5912" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5914" href="Ledger.Transaction.html#5914" class="Bound">v</a> <a id="5916" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5918" class="Symbol">_)</a> <a id="5921" class="Symbol">=</a> <a id="5923" href="Ledger.Transaction.html#5914" class="Bound">v</a>

  <a id="TransactionStructure.txinsVKey"></a><a id="5928" href="Ledger.Transaction.html#5928" class="Function">txinsVKey</a> <a id="5938" class="Symbol">:</a> <a id="5940" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="5942" href="Ledger.Transaction.html#3822" class="Function">TxIn</a> <a id="5947" class="Symbol">→</a> <a id="5949" href="Ledger.Transaction.html#3913" class="Function">UTxO</a> <a id="5954" class="Symbol">→</a> <a id="5956" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="5958" href="Ledger.Transaction.html#3822" class="Function">TxIn</a>
  <a id="5965" href="Ledger.Transaction.html#5928" class="Function">txinsVKey</a> <a id="5975" href="Ledger.Transaction.html#5975" class="Bound">txins</a> <a id="5981" href="Ledger.Transaction.html#5981" class="Bound">utxo</a> <a id="5986" class="Symbol">=</a> <a id="5988" href="Ledger.Transaction.html#5975" class="Bound">txins</a> <a id="5994" href="Axiom.Set.html#9005" class="Function Operator">∩</a> <a id="5996" href="Interface.IsSet.html#934" class="Function">dom</a> <a id="6000" class="Symbol">(</a><a id="6001" href="Ledger.Transaction.html#5981" class="Bound">utxo</a> <a id="6006" href="Ledger.Set.Theory.html#3006" class="Function Operator">∣^&#39;</a> <a id="6010" class="Symbol">(</a><a id="6011" href="Ledger.Address.html#2407" class="Function">isVKeyAddr</a> <a id="6022" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="6024" href="Data.Product.Base.html#636" class="Field">proj₁</a><a id="6029" class="Symbol">))</a>

  <a id="TransactionStructure.scriptOuts"></a><a id="6035" href="Ledger.Transaction.html#6035" class="Function">scriptOuts</a> <a id="6046" class="Symbol">:</a> <a id="6048" href="Ledger.Transaction.html#3913" class="Function">UTxO</a> <a id="6053" class="Symbol">→</a> <a id="6055" href="Ledger.Transaction.html#3913" class="Function">UTxO</a>
  <a id="6062" href="Ledger.Transaction.html#6035" class="Function">scriptOuts</a> <a id="6073" href="Ledger.Transaction.html#6073" class="Bound">utxo</a> <a id="6078" class="Symbol">=</a> <a id="6080" href="Ledger.Transaction.html#431" class="Function">filter</a> <a id="6087" class="Symbol">(λ</a> <a id="6090" class="Symbol">(_</a> <a id="6093" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6095" href="Ledger.Transaction.html#6095" class="Bound">addr</a> <a id="6100" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6102" class="Symbol">_)</a> <a id="6105" class="Symbol">→</a> <a id="6107" href="Ledger.Address.html#2435" class="Function">isScriptAddr</a> <a id="6120" href="Ledger.Transaction.html#6095" class="Bound">addr</a><a id="6124" class="Symbol">)</a> <a id="6126" href="Ledger.Transaction.html#6073" class="Bound">utxo</a>

  <a id="TransactionStructure.txinsScript"></a><a id="6134" href="Ledger.Transaction.html#6134" class="Function">txinsScript</a> <a id="6146" class="Symbol">:</a> <a id="6148" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="6150" href="Ledger.Transaction.html#3822" class="Function">TxIn</a> <a id="6155" class="Symbol">→</a> <a id="6157" href="Ledger.Transaction.html#3913" class="Function">UTxO</a> <a id="6162" class="Symbol">→</a> <a id="6164" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="6166" href="Ledger.Transaction.html#3822" class="Function">TxIn</a>
  <a id="6173" href="Ledger.Transaction.html#6134" class="Function">txinsScript</a> <a id="6185" href="Ledger.Transaction.html#6185" class="Bound">txins</a> <a id="6191" href="Ledger.Transaction.html#6191" class="Bound">utxo</a> <a id="6196" class="Symbol">=</a> <a id="6198" href="Ledger.Transaction.html#6185" class="Bound">txins</a> <a id="6204" href="Axiom.Set.html#9005" class="Function Operator">∩</a> <a id="6206" href="Interface.IsSet.html#934" class="Function">dom</a> <a id="6210" class="Symbol">(</a><a id="6211" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="6217" class="Symbol">(</a><a id="6218" href="Ledger.Transaction.html#6035" class="Function">scriptOuts</a> <a id="6229" href="Ledger.Transaction.html#6191" class="Bound">utxo</a><a id="6233" class="Symbol">))</a>

  <a id="TransactionStructure.refScripts"></a><a id="6239" href="Ledger.Transaction.html#6239" class="Function">refScripts</a> <a id="6250" class="Symbol">:</a> <a id="6252" href="Ledger.Transaction.html#5258" class="Record">Tx</a> <a id="6255" class="Symbol">→</a> <a id="6257" href="Ledger.Transaction.html#3913" class="Function">UTxO</a> <a id="6262" class="Symbol">→</a> <a id="6264" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="6266" href="Ledger.Script.html#6019" class="Function">Script</a>
  <a id="6275" href="Ledger.Transaction.html#6239" class="Function">refScripts</a> <a id="6286" href="Ledger.Transaction.html#6286" class="Bound">tx</a> <a id="6289" href="Ledger.Transaction.html#6289" class="Bound">utxo</a> <a id="6294" class="Symbol">=</a>
    <a id="6300" href="Axiom.Set.html#7518" class="Function">mapPartial</a> <a id="6311" class="Symbol">(</a><a id="6312" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="6318" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="6320" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="6326" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="6328" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="6333" class="Symbol">)</a> <a id="6335" class="Symbol">(</a><a id="6336" href="Interface.IsSet.html#977" class="Function">range</a> <a id="6342" class="Symbol">(</a><a id="6343" href="Ledger.Transaction.html#6289" class="Bound">utxo</a> <a id="6348" href="Axiom.Set.Map.html#10107" class="Function Operator">∣</a> <a id="6350" class="Symbol">(</a><a id="6351" href="Ledger.Transaction.html#4247" class="Function">txins</a> <a id="6357" href="Axiom.Set.html#8665" class="Function Operator">∪</a> <a id="6359" href="Ledger.Transaction.html#4277" class="Function">refInputs</a><a id="6368" class="Symbol">)))</a>
    <a id="6376" class="Keyword">where</a> <a id="6382" class="Keyword">open</a> <a id="6387" href="Ledger.Transaction.html#5258" class="Module">Tx</a><a id="6389" class="Symbol">;</a> <a id="6391" class="Keyword">open</a> <a id="6396" href="Ledger.Transaction.html#4157" class="Module">TxBody</a> <a id="6403" class="Symbol">(</a><a id="6404" href="Ledger.Transaction.html#6286" class="Bound">tx</a> <a id="6407" class="Symbol">.</a><a id="6408" href="Ledger.Transaction.html#5344" class="Field">body</a><a id="6412" class="Symbol">)</a>

  <a id="TransactionStructure.txscripts"></a><a id="6417" href="Ledger.Transaction.html#6417" class="Function">txscripts</a> <a id="6427" class="Symbol">:</a> <a id="6429" href="Ledger.Transaction.html#5258" class="Record">Tx</a> <a id="6432" class="Symbol">→</a> <a id="6434" href="Ledger.Transaction.html#3913" class="Function">UTxO</a> <a id="6439" class="Symbol">→</a> <a id="6441" href="Ledger.Set.Theory.html#382" class="Function Operator">ℙ</a> <a id="6443" href="Ledger.Script.html#6019" class="Function">Script</a>
  <a id="6452" href="Ledger.Transaction.html#6417" class="Function">txscripts</a> <a id="6462" href="Ledger.Transaction.html#6462" class="Bound">tx</a> <a id="6465" href="Ledger.Transaction.html#6465" class="Bound">utxo</a> <a id="6470" class="Symbol">=</a> <a id="6472" href="Ledger.Transaction.html#5077" class="Field">scripts</a> <a id="6480" class="Symbol">(</a><a id="6481" href="Ledger.Transaction.html#6462" class="Bound">tx</a> <a id="6484" class="Symbol">.</a><a id="6485" href="Ledger.Transaction.html#5368" class="Field">wits</a><a id="6489" class="Symbol">)</a> <a id="6491" href="Axiom.Set.html#8665" class="Function Operator">∪</a> <a id="6493" href="Ledger.Transaction.html#6239" class="Function">refScripts</a> <a id="6504" href="Ledger.Transaction.html#6462" class="Bound">tx</a> <a id="6507" href="Ledger.Transaction.html#6465" class="Bound">utxo</a>
    <a id="6516" class="Keyword">where</a> <a id="6522" class="Keyword">open</a> <a id="6527" href="Ledger.Transaction.html#5258" class="Module">Tx</a><a id="6529" class="Symbol">;</a> <a id="6531" class="Keyword">open</a> <a id="6536" href="Ledger.Transaction.html#4954" class="Module">TxWitnesses</a>

  <a id="TransactionStructure.lookupScriptHash"></a><a id="6551" href="Ledger.Transaction.html#6551" class="Function">lookupScriptHash</a> <a id="6568" class="Symbol">:</a> <a id="6570" href="Ledger.Crypto.html#1525" class="Function">ScriptHash</a> <a id="6581" class="Symbol">→</a> <a id="6583" href="Ledger.Transaction.html#5258" class="Record">Tx</a> <a id="6586" class="Symbol">→</a> <a id="6588" href="Ledger.Transaction.html#3913" class="Function">UTxO</a> <a id="6593" class="Symbol">→</a> <a id="6595" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="6601" href="Ledger.Script.html#6019" class="Function">Script</a>
  <a id="6610" href="Ledger.Transaction.html#6551" class="Function">lookupScriptHash</a> <a id="6627" href="Ledger.Transaction.html#6627" class="Bound">sh</a> <a id="6630" href="Ledger.Transaction.html#6630" class="Bound">tx</a> <a id="6633" href="Ledger.Transaction.html#6633" class="Bound">utxo</a> <a id="6638" class="Symbol">=</a>
    <a id="6644" href="Interface.ToBool.html#287" class="Function Operator">if</a> <a id="6647" href="Ledger.Transaction.html#6627" class="Bound">sh</a> <a id="6650" href="Interface.IsSet.html#476" class="Function Operator">∈</a> <a id="6652" href="Ledger.Set.Theory.html#413" class="Function">mapˢ</a> <a id="6657" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="6663" class="Symbol">(</a><a id="6664" href="Ledger.Transaction.html#6733" class="Function">m</a> <a id="6666" href="Axiom.Set.Map.html#2282" class="Function Operator">ˢ</a><a id="6667" class="Symbol">)</a> <a id="6669" href="Interface.ToBool.html#287" class="Function Operator">then</a>
      <a id="6680" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6685" class="Symbol">(</a><a id="6686" href="Axiom.Set.Map.html#12498" class="Function">lookupᵐ</a> <a id="6694" href="Ledger.Transaction.html#6733" class="Function">m</a> <a id="6696" href="Ledger.Transaction.html#6627" class="Bound">sh</a><a id="6698" class="Symbol">)</a>
    <a id="6704" href="Interface.ToBool.html#287" class="Function Operator">else</a>
      <a id="6715" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
    <a id="6727" class="Keyword">where</a> <a id="6733" href="Ledger.Transaction.html#6733" class="Function">m</a> <a id="6735" class="Symbol">=</a> <a id="6737" href="Ledger.Set.HashMap.html#295" class="Function">setToHashMap</a> <a id="6750" class="Symbol">(</a><a id="6751" href="Ledger.Transaction.html#6417" class="Function">txscripts</a> <a id="6761" href="Ledger.Transaction.html#6630" class="Bound">tx</a> <a id="6764" href="Ledger.Transaction.html#6633" class="Bound">utxo</a><a id="6768" class="Symbol">)</a>
<a id="6770" class="Markup">\end{code}</a><a id="6780" class="Background">
\end{AgdaMultiCode}
\caption{Functions related to transactions}
\label{fig:defs:transaction-funs}
\end{figure*}
\end{NoConway}

</a><a id="6909" class="Markup">\begin{code}[hide]</a>
  <a id="TransactionStructure.isP2Script"></a><a id="6930" href="Ledger.Transaction.html#6930" class="Function">isP2Script</a> <a id="6941" class="Symbol">:</a> <a id="6943" href="Ledger.Script.html#6019" class="Function">Script</a> <a id="6950" class="Symbol">→</a> <a id="6952" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
  <a id="6959" href="Ledger.Transaction.html#6930" class="Function">isP2Script</a> <a id="6970" class="Symbol">=</a> <a id="6972" href="Data.Maybe.Base.html#1110" class="Function">is-just</a> <a id="6980" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="6982" href="Data.Sum.html#1056" class="Function">isInj₂</a>

  <a id="6992" class="Keyword">instance</a>
    <a id="TransactionStructure.HasCoin-TxOut"></a><a id="7005" href="Ledger.Transaction.html#7005" class="Function">HasCoin-TxOut</a> <a id="7019" class="Symbol">:</a> <a id="7021" href="Ledger.Interface.HasCoin.html#124" class="Record">HasCoin</a> <a id="7029" href="Ledger.Transaction.html#3845" class="Function">TxOut</a>
    <a id="7039" href="Ledger.Transaction.html#7005" class="Function">HasCoin-TxOut</a> <a id="7053" class="Symbol">.</a><a id="7054" href="Ledger.Interface.HasCoin.html#172" class="Field">getCoin</a> <a id="7062" class="Symbol">=</a> <a id="7064" href="Ledger.TokenAlgebra.html#1233" class="Function">coin</a> <a id="7069" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="7071" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="7077" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="7079" href="Data.Product.Base.html#650" class="Field">proj₂</a>

<a id="7086" class="Markup">\end{code}</a><a id="7096" class="Background">
</a></pre></body></html>